<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="韩乔落">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
        
        
        
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://jelasin.github.io/2025/02/01/shell编程与工程管理/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Linux shell 编程运维用到多一些，开发不是很常用，能看懂就行。 参考文献 ： 《Linux shell编程 第三版》 《Linux shell核心编程指南》 https:&#x2F;&#x2F;www.runoob.com&#x2F;linux&#x2F;linux-shell-variable.html 基本知识 $0 : 脚本名称； $1-$2-&gt;$... : 脚本的第一，二，…个参数； $*或者$@ : 脚本的全部">
<meta property="og:type" content="article">
<meta property="og:title" content="Shell编程与工程管理">
<meta property="og:url" content="https://jelasin.github.io/2025/02/01/Shell%E7%BC%96%E7%A8%8B%E4%B8%8E%E5%B7%A5%E7%A8%8B%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="Jelasin">
<meta property="og:description" content="Linux shell 编程运维用到多一些，开发不是很常用，能看懂就行。 参考文献 ： 《Linux shell编程 第三版》 《Linux shell核心编程指南》 https:&#x2F;&#x2F;www.runoob.com&#x2F;linux&#x2F;linux-shell-variable.html 基本知识 $0 : 脚本名称； $1-$2-&gt;$... : 脚本的第一，二，…个参数； $*或者$@ : 脚本的全部">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-02-01T07:11:31.000Z">
<meta property="article:modified_time" content="2025-03-27T08:53:44.077Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
    
    
        <!-- Google tag (gtag.js) -->
        <script src="https://www.googletagmanager.com/gtag/js?id=G-3333333333"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-3333333333');
        </script>
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/favicon.ico" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/favicon.ico">
    <!--- Page Info-->
    
    <title>
        
            Shell编程与工程管理 | Jelasin
        
    </title>

    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/Chillax/chillax.css">

    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/css/build/tailwind.css">
    

    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/GeistMono/geist-mono.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/Geist/geist.css">
    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"jelasin.github.io","root":"/","language":"en","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":false,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":true,"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":"Noto Sans SC","url":"https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap"},"english":{"enable":false,"family":"Farsan","url":"https://fonts.googleapis.com/css2?family=Farsan&display=swap"},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","enable":true,"site_pv":false,"site_uv":false,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":true,"google_analytics":{"enable":true,"id":"G-3333333333"}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"“会当身由己，婉转入江湖”","subtitle":{"text":["Loading..."],"hitokoto":{"enable":true,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":null,"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Links":{"icon":"fa-regular fa-link","submenus":{"看雪":"https://bbs.kanxue.com/homepage-958172.htm","吾爱破解":"https://www.52pojie.cn/home.php?mod=space&uid=2101606&do=thread&view=me&from=space","中国诗歌网":"https://www.zgshige.com/c/2022-04-13/21151100.shtml"}}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":{"Essays":{"path":"/essays","icon":"fa-regular fa-comment"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"},"AI":{"path":"/AI","icon":"fa-brands fa-python"},"IOT":{"path":"/IOT","icon":"fas fa-network-wired"},"CTF":{"path":"/CTF","icon":"fa-solid fa-snowflake"},"Web":{"path":"/Web","icon":"fa-solid fa-shield"},"Linux":{"path":"/Linux","icon":"fa-brands fa-linux"},"Android":{"path":"/Android","icon":"fa-brands fa-android"},"Windows":{"path":"/Windows","icon":"fa-brands fa-windows"}}},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":4},"tags":{"enable":true,"limit":4}},"footerStart":"2023/9/20 11:45:14"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/fontawesome.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/brands.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/solid.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/regular.min.css">
    
    
    
    
<meta name="generator" content="Hexo 6.3.0"></head>



<body>
	<div class="progress-bar-container">
	
	<span class="scroll-progress-bar"></span>
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
                <a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/">
                    <img src="/images/favicon.ico" class="w-full h-full rounded-sm">
                </a>
            
            <a class="logo-title" href="/">
                
                Jelasin
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    ARCHIVES
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-link fa-fw"></i>
                                    LINKS
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://bbs.kanxue.com/homepage-958172.htm">
                                                    看雪
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://www.52pojie.cn/home.php?mod=space&uid=2101606&do=thread&view=me&from=space">
                                                    吾爱破解
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://www.zgshige.com/c/2022-04-13/21151100.shtml">
                                                    中国诗歌网
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                ARCHIVES
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-Links"
                        >
                            <span>
                                LINKS
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-Links">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://bbs.kanxue.com/homepage-958172.htm">看雪</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://www.52pojie.cn/home.php?mod=space&uid=2101606&do=thread&view=me&from=space">吾爱破解</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://www.zgshige.com/c/2022-04-13/21151100.shtml">中国诗歌网</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            

            
            
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/essays"
                        >
                            <span>Essays</span>
                            <i class="fa-regular fa-comment fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/categories"
                        >
                            <span>Categories</span>
                            <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/AI"
                        >
                            <span>AI</span>
                            <i class="fa-brands fa-python fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/IOT"
                        >
                            <span>IOT</span>
                            <i class="fas fa-network-wired fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/CTF"
                        >
                            <span>CTF</span>
                            <i class="fa-solid fa-snowflake fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/Web"
                        >
                            <span>Web</span>
                            <i class="fa-solid fa-shield fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/Linux"
                        >
                            <span>Linux</span>
                            <i class="fa-brands fa-linux fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/Android"
                        >
                            <span>Android</span>
                            <i class="fa-brands fa-android fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/Windows"
                        >
                            <span>Windows</span>
                            <i class="fa-brands fa-windows fa-sm fa-fw"></i>
                        </a>
                    </li>
                
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">40</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">18</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">138</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">Shell编程与工程管理</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/touxiang.jpg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">韩乔落</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-02-01 15:11:31</span>
        <span class="mobile">2025-02-01 15:11:31</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-03-27 16:53:44</span>
            <span class="mobile">2025-03-27 16:53:44</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h1 id="Linux-shell-编程"><a href="#Linux-shell-编程" class="headerlink" title="Linux shell 编程"></a>Linux shell 编程</h1><p>运维用到多一些，开发不是很常用，能看懂就行。</p>
<p><strong>参考文献 ：</strong></p>
<p>《Linux shell编程 第三版》</p>
<p>《Linux shell核心编程指南》</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-shell-variable.html" >https://www.runoob.com/linux/linux-shell-variable.html<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<h2 id="基本知识"><a href="#基本知识" class="headerlink" title="基本知识"></a>基本知识</h2><ul>
<li><strong><code>$0</code></strong> : 脚本名称；</li>
<li><strong><code>$1-$2-&gt;$...</code></strong> : 脚本的第一，二，…个参数；</li>
<li><strong><code>$*</code>或者<code>$@</code></strong> : 脚本的全部参数；</li>
<li><ul>
<li>相同点：都是引用所有参数。</li>
<li>不同点：只有在双引号中体现出来。假设在脚本运行时写了三个参数 1、2、3，则 “ * “ 等价于 “1 2 3”（传递了一个参数），而 “@” 等价于 “1” “2” “3”（传递了三个参数）。</li>
</ul>
</li>
<li><strong><code>$$</code></strong> ： 脚本进程号；</li>
<li><strong><code>$#</code></strong> : 脚本参数个数；</li>
<li><strong><code>$?</code></strong> : 上一条指令返回结果；</li>
<li><strong><code>$-</code></strong> : 显示Shell使用的当前选项，与<a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-comm-set.html" >set命令<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>功能相同。</li>
<li><strong><code>$!</code></strong> : 后台运行的最后一个进程的ID号。</li>
<li><strong><code>#!</code></strong> : 一个约定的标记，它告诉系统这个脚本需要什么解释器来执行，即使用哪一种 Shell。</li>
<li>函数与命令的执行结果可以作为条件语句使用。要注意的是，和 C 语言不同，shell 语言中 0 代表 true，0 以外的值代表 false。</li>
</ul>
<h2 id="变量定义"><a href="#变量定义" class="headerlink" title="变量定义"></a>变量定义</h2><p>**字符串变量: ** 在 Shell中，变量通常被视为字符串。你可以使用单引号 ‘ 或双引号 “ 来定义字符串，例如：</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">my_string=<span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line">my_string=<span class="string">&quot;Hello, World!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取字符串长度 </span></span><br><span class="line"><span class="comment"># 变量为字符串时，$&#123;#string&#125; 等价于 $&#123;#string[0]&#125;:</span></span><br><span class="line">string=<span class="string">&quot;abcd&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#string&#125;</span>   		<span class="comment"># 输出 4</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#string[0]&#125;</span>   	<span class="comment"># 输出 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取子字符串</span></span><br><span class="line"><span class="comment"># 实例从字符串第 2 个字符开始截取 4 个字符：</span></span><br><span class="line">string=<span class="string">&quot;runoob is a great site&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;string:1:4&#125;</span> <span class="comment"># 输出 unoo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找子字符串 </span></span><br><span class="line"><span class="comment"># 查找字符 i 或 o 的位置(哪个字母先出现就计算哪个)：</span></span><br><span class="line">string=<span class="string">&quot;runoob is a great site&quot;</span></span><br><span class="line"><span class="built_in">echo</span> `<span class="built_in">expr</span> index <span class="string">&quot;<span class="variable">$string</span>&quot;</span> io`  <span class="comment"># 输出 4</span></span><br></pre></td></tr></table></figure></div>

<p><strong>整数变量</strong>： 在一些Shell中，你可以使用 <strong>declare</strong> 或 <strong>typeset</strong> 命令来声明整数变量。</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">declare</span> -i my_integer</span><br></pre></td></tr></table></figure></div>

<p><strong>数组变量：</strong> Shell 也支持数组，允许你在一个变量中存储多个值。</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">my_array=(1 2 3 4 5)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取得数组元素的个数</span></span><br><span class="line">length=<span class="variable">$&#123;#array_name[@]&#125;</span></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">length=<span class="variable">$&#123;#array_name[*]&#125;</span></span><br><span class="line"><span class="comment"># 取得数组单个元素的长度</span></span><br><span class="line">length=<span class="variable">$&#123;#array_name[n]&#125;</span></span><br></pre></td></tr></table></figure></div>

<p><strong>关联数组：</strong></p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">declare</span> -A associative_array</span><br><span class="line">associative_array[<span class="string">&quot;name&quot;</span>]=<span class="string">&quot;John&quot;</span></span><br><span class="line">associative_array[<span class="string">&quot;age&quot;</span>]=30</span><br></pre></td></tr></table></figure></div>

<p><strong>只读变量</strong></p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">readonly</span> Url=<span class="string">&quot;https://jelasin.github.io&quot;</span></span><br></pre></td></tr></table></figure></div>

<p><strong>删除变量</strong></p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">unset</span> variable_name</span><br></pre></td></tr></table></figure></div>

<h2 id="功能语句"><a href="#功能语句" class="headerlink" title="功能语句"></a>功能语句</h2><h3 id="echo"><a href="#echo" class="headerlink" title="echo"></a>echo</h3><p>Shell 的 echo 指令与 PHP 的 echo 指令类似，都是用于字符串的输出。命令格式：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo string</span><br></pre></td></tr></table></figure></div>

<p>您可以使用echo实现更复杂的输出格式控制。</p>
<p><strong>显示普通字符串:</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;It is a test&quot;</span><br></pre></td></tr></table></figure></div>

<p>这里的双引号完全可以省略，以下命令与上面实例效果一致：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo It is a test</span><br></pre></td></tr></table></figure></div>

<p><strong>显示转义字符</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;\&quot;It is a test\&quot;&quot;</span><br></pre></td></tr></table></figure></div>

<p>结果将是:</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;It is a test&quot;</span><br></pre></td></tr></table></figure></div>

<p>同样，双引号也可以省略</p>
<p><strong>显示变量</strong></p>
<p>read 命令从标准输入中读取一行,并把输入行的每个字段的值指定给 shell 变量</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">read name </span><br><span class="line">echo &quot;$name It is a test&quot;</span><br></pre></td></tr></table></figure></div>

<p>以上代码保存为 test.sh，name 接收标准输入的变量，结果将是: </p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# sh test.sh</span><br><span class="line">OK                     #标准输入</span><br><span class="line">OK It is a test        #输出</span><br></pre></td></tr></table></figure></div>

<p><strong>显示换行</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo -e &quot;OK! \n&quot; # -e 开启转义</span><br><span class="line">echo &quot;It is a test&quot;</span><br></pre></td></tr></table></figure></div>

<p>输出结果：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">OK!</span><br><span class="line"></span><br><span class="line">It is a test</span><br></pre></td></tr></table></figure></div>

<p><strong>显示不换行</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">echo -e &quot;OK! \c&quot; # -e 开启转义 \c 不换行</span><br><span class="line">echo &quot;It is a test&quot;</span><br><span class="line"># 或者 </span><br><span class="line">echo -n &quot;It is a test&quot;</span><br></pre></td></tr></table></figure></div>

<p>输出结果：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OK! It is a test</span><br></pre></td></tr></table></figure></div>

<p><strong>显示结果定向至文件</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;It is a test&quot; &gt; myfile</span><br></pre></td></tr></table></figure></div>

<p><strong>原样输出字符串，不进行转义或取变量(用单引号)</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;$name\&quot;&#x27;</span><br></pre></td></tr></table></figure></div>

<p>输出结果：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$name\&quot;</span><br></pre></td></tr></table></figure></div>

<p><strong>显示命令执行结果</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo `date`</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><strong>注意：</strong> 这里使用的是反引号 &#96;, 而不是单引号 ‘。</p>
</blockquote>
<p>结果将显示当前日期</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Thu Jul 24 10:08:46 CST 2014</span><br></pre></td></tr></table></figure></div>

<h3 id="print-printf"><a href="#print-printf" class="headerlink" title="print&#x2F;printf"></a>print&#x2F;printf</h3><p>printf 命令模仿 C 程序库（library）里的 printf() 程序。</p>
<p>printf 由 POSIX 标准所定义，因此使用 printf 的脚本比使用 echo 移植性好。</p>
<p>printf 使用引用文本或空格分隔的参数，外面可以在 <strong>printf</strong> 中使用格式化字符串，还可以制定字符串的宽度、左右对齐方式等。默认的 printf 不会像 echo 自动添加换行符，我们可以手动添加 \n。</p>
<p>printf 命令的语法：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">printf  format-string  [arguments...]</span><br></pre></td></tr></table></figure></div>

<p><strong>参数说明：</strong></p>
<ul>
<li><strong>format-string:</strong> 一个格式字符串，它包含普通文本和格式说明符。</li>
<li><strong>arguments:</strong> 用于填充格式说明符的参数列表。。</li>
</ul>
<p>格式说明符由 % 字符开始，后跟一个或多个字符，用于指定输出的格式。常用的格式说明符包括：</p>
<ul>
<li><code>%s</code>：字符串</li>
<li><code>%d</code>：十进制整数</li>
<li><code>%f</code>：浮点数</li>
<li><code>%c</code>：字符</li>
<li><code>%x</code>：十六进制数</li>
<li><code>%o</code>：八进制数</li>
<li><code>%b</code>：二进制数</li>
<li><code>%e</code>：科学计数法表示的浮点数</li>
</ul>
<p><strong>print和printf的异同点</strong></p>
<ol>
<li><strong>自动换行与否</strong>:</li>
</ol>
<ul>
<li><code>print</code> 命令会在输出内容后自动换行，即每打印一个输出项，行尾都会添加换行符<a class="link"   target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/140325415839771325.html" >1<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35696312/article/details/88169556" >2<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>。</li>
<li>而 <code>printf</code> 命令，则不会自动换行，用户需要在格式字符串中手动指定换行符（例如使用 <code>\n</code>）<a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-shell-printf.html" >5<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>。</li>
</ul>
<ol start="2">
<li><strong>输出格式</strong>:</li>
</ol>
<ul>
<li><code>printf</code> 允许进行格式化输出，可以控制输出的格式，例如指定字段宽度、精度、数据类型等。这使得 <code>printf</code> 更加灵活，适合于复杂的输出需求<a class="link"   target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/140325415839771325.html" >1<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a><a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-shell-printf.html" >5<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>。</li>
<li>相比之下，<code>print</code> 则是按照默认分隔符打印变量或常量，输出相对简单，不支持格式化<a class="link"   target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/140325415839771325.html" >1<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>。</li>
</ul>
<ol start="3">
<li><strong>使用场景</strong>:</li>
</ol>
<ul>
<li>通常，<code>printf</code> 更接近于 C 语言中的 <code>printf</code> 函数，适用于需要格式化的输出场景，能够提供更好的控制和清晰度<a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-shell-printf.html" >5<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>。</li>
<li><code>print</code> 更适合于简单的输出任务，不需要复杂的格式化处理时使用。</li>
</ul>
<p>选择使用 <code>print</code> 还是 <code>printf</code> 主要取决于输出的复杂性和格式化需求。</p>
<h3 id="read"><a href="#read" class="headerlink" title="read"></a>read</h3><p>在 Linux shell 编程中，<code>read</code> 命令是一个非常重要的内置命令，具有以下几个关键特点和用法：</p>
<ol>
<li><p><strong>功能</strong>:</p>
<ul>
<li><code>read</code> 命令用于从标准输入（通常是键盘）读取一行数据，并可以将其赋值给一个或多个变量。这使得 <code>read</code> 特别适用于数据处理和交互式程序。</li>
</ul>
</li>
<li><p><strong>基本用法</strong>:</p>
<ul>
<li><code>read</code> 可以通过该命令读取用户的输入，通常在脚本中用于获取用户输入的数值或文本。用户输入后，数据将被存储到指定的变量中。</li>
</ul>
</li>
<li><p><strong>读取文件的能力</strong>:</p>
<ul>
<li>除了从标准输入读取数据外，<code>read</code> 还可以用来读取文件中的数据。通过重定向或管道，可以将文件的每一行传递给 <code>read</code> 命令。例如，可以使用 <code>cat</code> 命令并通过管道将文件内容传输给 <code>read</code>。</li>
</ul>
</li>
<li><p><strong>语法选项</strong>:</p>
<ul>
<li><p><strong>read</strong></p>
<p>命令有多种参数选项，包括：</p>
<ul>
<li><code>-p</code>：定义提示符，用于在读取之前显示给用户。</li>
<li><code>-t</code>：设置超时时间，若在指定时间内未输入则 <code>read</code> 会退出。</li>
<li><code>-d</code>：定义分隔符，以控制输入数据的结束。</li>
<li><code>-s</code>：静默读取。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>退出状态</strong>:</p>
<ul>
<li>当 <code>read</code> 命令读取时，如果没有可读的行，它将以非零状态退出。这在脚本中可以通过检查退出状态来判断输入的有效性。</li>
</ul>
</li>
</ol>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">read</span> -t 5 -p <span class="string">&quot;请在5秒内输入一些内容: &quot;</span> input; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;你输入了: <span class="variable">$input</span>&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;超时了，你没有输入任何内容&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入你的密码: &quot;</span> -s password</span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;密码已读取（但不会显示）&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<ul>
<li><strong>避免在脚本中直接读取密码</strong>：虽然<code>read</code>命令的<code>-s</code>选项允许你静默地读取密码，但通常更好的做法是使用工具（如<code>expect</code>）来安全地处理密码。</li>
<li><strong>确保输入验证</strong>：在使用<code>read</code>命令读取用户输入时，始终确保对输入进行验证，以防止潜在的安全风险或脚本错误。</li>
<li><strong>使用<code>-r</code>选项来避免转义字符</strong>：如果你希望按原样读取输入（包括任何转义字符），请记得使用<code>-r</code>选项。</li>
<li><strong>在脚本中提供清晰的提示</strong>：使用<code>-p</code>选项为用户提供清晰的输入提示，以提高脚本的可用性。</li>
<li><strong>处理超时和错误</strong>：当使用<code>-t</code>选项设置超时时，确保你的脚本能够优雅地处理超时和错误情况。</li>
</ul>
<h3 id="test"><a href="#test" class="headerlink" title="test"></a>test</h3><p>在 Linux shell 编程中，<code>test</code> 是一个用于评估条件表达式的命令，常用于脚本中的条件判断。<code>test</code> 的功能非常强大，它可以用来比较数字、字符串、文件属性等。以下是对 <code>test</code> 的详细解释，包括它的用法和一些例子。</p>
<p><strong>基本语法</strong></p>
<p><code>test</code> 的基本语法如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span> expression</span><br></pre></td></tr></table></figure></div>
<p>或者可以使用简洁的方括号表示法：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ expression ]</span><br></pre></td></tr></table></figure></div>
<p>在使用方括号时，必须在方括号和表达式之间留有空格。</p>
<p><strong>数字比较</strong></p>
<p><code>test</code> 命令提供了一组用于数字比较的操作符：</p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>-eq</code></td>
<td>等于</td>
</tr>
<tr>
<td><code>-ne</code></td>
<td>不等于</td>
</tr>
<tr>
<td><code>-lt</code></td>
<td>小于</td>
</tr>
<tr>
<td><code>-le</code></td>
<td>小于或等于</td>
</tr>
<tr>
<td><code>-gt</code></td>
<td>大于</td>
</tr>
<tr>
<td><code>-ge</code></td>
<td>大于或等于</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a=5</span><br><span class="line">b=10</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> <span class="variable">$a</span> -lt <span class="variable">$b</span>; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$a</span> is less than <span class="variable">$b</span>&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>
<p>或者</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -lt <span class="variable">$b</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$a</span> is less than <span class="variable">$b</span>&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<p><strong>字符串比较</strong></p>
<p><code>test</code> 命令也支持字符串比较：</p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>=</code></td>
<td>等于</td>
</tr>
<tr>
<td><code>!=</code></td>
<td>不等于</td>
</tr>
<tr>
<td><code>-z</code></td>
<td>字符串长度为零</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>字符串长度非零</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">str1=<span class="string">&quot;hello&quot;</span></span><br><span class="line">str2=<span class="string">&quot;world&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$str1</span>&quot;</span> != <span class="string">&quot;<span class="variable">$str2</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$str1</span> is not equal to <span class="variable">$str2</span>&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<p><strong>文件测试</strong></p>
<p><code>test</code> 命令可以用来检查文件的属性，例如：</p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>-e</code></td>
<td>文件存在</td>
</tr>
<tr>
<td><code>-f</code></td>
<td>是否为常规文件</td>
</tr>
<tr>
<td><code>-d</code></td>
<td>是否为目录</td>
</tr>
<tr>
<td><code>-r</code></td>
<td>是否可读</td>
</tr>
<tr>
<td><code>-w</code></td>
<td>是否可写</td>
</tr>
<tr>
<td><code>-x</code></td>
<td>是否可执行</td>
</tr>
</tbody></table>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">file=<span class="string">&quot;/path/to/file&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -e <span class="string">&quot;<span class="variable">$file</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file</span> exists&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file</span> does not exist&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<p><strong>布尔逻辑</strong></p>
<p><code>test</code> 支持逻辑运算符，可以将条件组合在一起：</p>
<ul>
<li><code>-a</code>：与操作（逻辑与）</li>
<li><code>-o</code>：或操作（逻辑或）</li>
</ul>
<p>在使用方括号时，可以使用双括号来更清晰地表示逻辑操作：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ -f <span class="string">&quot;<span class="variable">$file</span>&quot;</span> -a -r <span class="string">&quot;<span class="variable">$file</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file</span> exists and is readable&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<p><strong>退出状态</strong></p>
<p><code>test</code> 的退出状态码很重要：</p>
<ul>
<li>返回 0 表示条件为真。</li>
<li>返回非零状态码表示条件为假。</li>
</ul>
<p>可以用 <code>$?</code> 来获取上一个命令的退出状态，例如：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span> -e <span class="string">&quot;<span class="variable">$file</span>&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ $? -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file</span> exists&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<h3 id="expr"><a href="#expr" class="headerlink" title="expr"></a>expr</h3><p>在 Linux shell 编程中，<code>expr</code> 是一个用于计算表达式的命令。它支持算术运算、逻辑运算和字符串操作。</p>
<p><strong>基本功能</strong></p>
<ul>
<li><p><strong>算术计算</strong>: <code>expr</code> 可以执行基本的算术运算，包括加法、减法、乘法、除法和取余。例如：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">expr</span> 5 + 3  <span class="comment"># 结果是 8</span></span><br><span class="line"><span class="built_in">expr</span> 10 - 2  <span class="comment"># 结果是 8</span></span><br><span class="line"><span class="built_in">expr</span> 4 \* 2  <span class="comment"># 结果是 8（乘法需要使用反斜杠转义）</span></span><br><span class="line"><span class="built_in">expr</span> 9 / 3  <span class="comment"># 结果是 3</span></span><br><span class="line"><span class="built_in">expr</span> 5 % 2  <span class="comment"># 结果是 1</span></span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>字符串操作</strong></p>
<ul>
<li><code>expr</code> 还可以用于字符串操作，如字符串长度和子串提取：<ul>
<li><strong>长度</strong>: 获取字符串的长度<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">expr</span> length <span class="string">&quot;hello&quot;</span>  <span class="comment"># 结果是 5</span></span><br></pre></td></tr></table></figure></div></li>
<li><strong>子串提取</strong>: 提取字符串中的子串<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">expr</span> substr <span class="string">&quot;hello&quot;</span> 2 3  <span class="comment"># 从第二个字符开始提取3个字符，结果是 &quot;ell&quot;</span></span><br></pre></td></tr></table></figure></div></li>
</ul>
</li>
</ul>
<p><strong>比较操作</strong></p>
<ul>
<li><code>expr</code> 还可以做数值比较，返回 1（真）或 0（假）：<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">expr</span> 5 = 5      <span class="comment"># 结果是 1</span></span><br><span class="line"><span class="built_in">expr</span> 5 != 3     <span class="comment"># 结果是 1</span></span><br><span class="line"><span class="built_in">expr</span> 5 \&gt; 3     <span class="comment"># 结果是 1</span></span><br><span class="line"><span class="built_in">expr</span> 3 \&lt; 5     <span class="comment"># 结果是 1</span></span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>逻辑运算</strong></p>
<ul>
<li><code>expr</code> 支持逻辑运算符，例如并且（<code>&amp;</code>）和或者（<code>|</code>）：<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">expr</span> 1 \&amp; 1     <span class="comment"># 结果是 1</span></span><br><span class="line"><span class="built_in">expr</span> 1 \| 0     <span class="comment"># 结果是 1</span></span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>注意事项</strong></p>
<ul>
<li>在使用 <code>expr</code> 时，建议使用反斜杠（<code>\</code>）对某些符号（如 <code>*</code>、<code>&amp;</code>、<code>|</code>）进行转义，因为它们在 shell 中有特殊含义。</li>
<li>在现代脚本中，许多功能可以用更强大的工具（如 <code>bc</code>、<code>awk</code> 或者 bash 内置的算术扩展 <code>$(( ... ))</code>）来替代，<code>expr</code> 的使用相对较少。</li>
</ul>
<p><strong>示例</strong></p>
<p>一个简单的示例，计算两个数的和并输出：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a=5</span><br><span class="line">b=10</span><br><span class="line"><span class="built_in">sum</span>=$(<span class="built_in">expr</span> <span class="variable">$a</span> + <span class="variable">$b</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Sum is: <span class="variable">$sum</span>&quot;</span>  <span class="comment"># 输出: Sum is: 15</span></span><br></pre></td></tr></table></figure></div>

<p>总之，<code>expr</code> 是一个功能强大的工具，适用于在 shell 脚本中进行简单的数学计算和字符串处理。然而，随着编程的复杂性增加，程序员往往会选择更现代及灵活的工具来完成复杂的任务。</p>
<h3 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h3><p>在 Linux shell 编程中，<code>sed</code>（stream editor）是一个非常强大的流编辑器，它用于对文本进行基本的转换和处理。它可以直接从标准输入读取数据，或者处理文件中的内容，支持正则表达式及各种替换、删除、插入等操作。以下是对 <code>sed</code> 的详解：</p>
<p><strong>基本功能</strong></p>
<ul>
<li><p><strong>文本替换</strong>:<br><code>sed</code> 最常用的功能是替换文本。基本语法为 <code>s/pattern/replacement/</code>，表示将匹配 <code>pattern</code> 的部分替换为 <code>replacement</code>。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/old-text/new-text/&#x27;</span> filename</span><br></pre></td></tr></table></figure></div>
<p>该命令会将文件中的第一个 <code>old-text</code> 替换为 <code>new-text</code>。</p>
</li>
<li><p><strong>全局替换</strong>:<br>如果需要在一行中替换所有匹配的文本，可以使用 <code>g</code> 选项：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/old-text/new-text/g&#x27;</span> filename</span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>删除操作</strong></p>
<ul>
<li><strong>删除行</strong>:<br>使用 <code>d</code> 命令可以删除匹配特定模式的行：<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;/pattern/d&#x27;</span> filename</span><br></pre></td></tr></table></figure></div>
该命令会删除文件中所有匹配 <code>pattern</code> 的行。</li>
</ul>
<p><strong>插入和追加文本</strong></p>
<ul>
<li><p><strong>插入文本</strong>:<br>使用 <code>i</code> 命令可以在匹配行的前面插入文本：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;/pattern/i text-to-insert&#x27;</span> filename</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>追加文本</strong>:<br>使用 <code>a</code> 命令可以在匹配行的后面追加文本：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;/pattern/a text-to-append&#x27;</span> filename</span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>选择行</strong></p>
<ul>
<li><strong>打印特定行</strong>:<br>使用 <code>p</code> 命令可以打印匹配特定模式的行：<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -n <span class="string">&#x27;/pattern/p&#x27;</span> filename</span><br></pre></td></tr></table></figure></div>
<code>-n</code> 选项用于禁止默认输出，只有显式指定的行会被输出。</li>
</ul>
<p><strong>使用正则表达式</strong></p>
<ul>
<li><code>sed</code> 支持使用基本和扩展正则表达式进行模式匹配，这使得复杂的文本处理成为可能。</li>
</ul>
<p><strong>处理多个命令</strong></p>
<ul>
<li>可以使用 <code>-e</code> 选项来指定多个 <code>sed</code> 命令：<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -e <span class="string">&#x27;s/old-text/new-text/&#x27;</span> -e <span class="string">&#x27;/pattern/d&#x27;</span> filename</span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>备份与修改文件</strong></p>
<ul>
<li>使用 <code>-i</code> 选项可以直接修改文件，并可选择创建备份：<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i.bak <span class="string">&#x27;s/old-text/new-text/g&#x27;</span> filename  <span class="comment"># 备份为 filename.bak</span></span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>示例</strong></p>
<p>一个简单示例，替换文件中的所有 <code>hello</code> 为 <code>world</code>，并打印输出：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/hello/world/g&#x27;</span> input.txt</span><br></pre></td></tr></table></figure></div>

<h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><p>在 Linux shell 编程中，<code>awk</code> 是一种强大的文本处理工具，用于扫描和处理文本文件，特别擅长处理结构化数据（如 CSV 或其他分隔符分隔的数据）。它的名称来源于其三位创始人的姓氏（Alfred Aho, Peter Weinberger 和 Brian Kernighan）。以下是 <code>awk</code> 的详解：</p>
<p><strong>基本功能</strong></p>
<ul>
<li><p><strong>字段分隔</strong>:<br>默认情况下，<code>awk</code> 将每一行视为一个记录（record），并按空格或制表符分隔每个字段（field）。可以使用 <code>FS</code> 变量自定义字段分隔符，例如：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F <span class="string">&#x27;,&#x27;</span> <span class="string">&#x27;&#123;print $1&#125;&#x27;</span> filename  <span class="comment"># 使用逗号作为分隔符</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>打印字段</strong>:<br><code>awk</code> 使用 <code>$</code> 符号引用每一行的字段。<code>$1</code> 表示第一字段，<code>$2</code> 表示第二字段，以此类推。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;print $1, $2&#125;&#x27;</span> filename  <span class="comment"># 打印每行的第一个和第二个字段</span></span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>条件处理</strong></p>
<ul>
<li><p><strong>使用条件进行筛选</strong>:<br>可以在 <code>awk</code> 中使用条件语句进行行选择。例如，打印第二字段大于 100 的行：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;$2 &gt; 100&#x27;</span> filename</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>结合打印与条件</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;$2 &gt; 100 &#123;print $1, $2&#125;&#x27;</span> filename  <span class="comment"># 只打印第二字段大于100的第一和第二字段</span></span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>计算与聚合</strong></p>
<ul>
<li><p><strong>算术运算</strong>:<br><code>awk</code> 允许进行算术运算：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;sum += $2&#125; END &#123;print sum&#125;&#x27;</span> filename  <span class="comment"># 计算第二字段的总和</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>平均值计算</strong>:<br>计算某字段的平均值：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;sum += $2; count++&#125; END &#123;print sum/count&#125;&#x27;</span> filename</span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>模式与动作</strong></p>
<ul>
<li><code>awk</code> 中的基本语法是 <code>pattern &#123; action &#125;</code>。当输入行匹配模式时，就执行相应的动作。</li>
</ul>
<p><strong>内置变量</strong></p>
<ul>
<li><code>awk</code> 提供了一些内置变量，如：<ul>
<li><code>NR</code>：当前记录的行号。</li>
<li><code>NF</code>：当前记录的字段数量。</li>
<li><code>$0</code>：当前记录的整行内容。</li>
</ul>
</li>
</ul>
<p>例如：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;print NR, NF, $0&#125;&#x27;</span> filename  <span class="comment"># 打印行号、字段数和整行内容</span></span><br></pre></td></tr></table></figure></div>

<p><strong>使用函数</strong></p>
<ul>
<li><code>awk</code> 具有许多内置函数，如字符串处理、数学计算等。例如，使用 <code>length</code> 函数获取字符串长度：<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;print length($1)&#125;&#x27;</span> filename  <span class="comment"># 打印每行第一个字段的长度</span></span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>脚本方式</strong></p>
<ul>
<li><code>awk</code> 可以在命令行中使用，也可以写成脚本文件。例如：<div class="code-container" data-rel="Awk"><figure class="iseeu highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># myscript.awk</span></span><br><span class="line">&#123;</span><br><span class="line">  print <span class="variable">$1</span>, <span class="variable">$2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
执行方式：<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -f myscript.awk filename</span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>示例</strong></p>
<p>简单示例，计算文件中第二列的和：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;sum += $2&#125; END &#123;print sum&#125;&#x27;</span> filename</span><br></pre></td></tr></table></figure></div>

<h3 id="I-O-重定向"><a href="#I-O-重定向" class="headerlink" title="I&#x2F;O 重定向"></a>I&#x2F;O 重定向</h3><p>大多数 UNIX 系统命令从你的终端接受输入并将所产生的输出发送回到您的终端。一个命令通常从一个叫标准输入的地方读取输入，默认情况下，这恰好是你的终端。同样，一个命令通常将其输出写入到标准输出，默认情况下，这也是你的终端。</p>
<p>重定向命令列表如下：</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>command &gt; file</td>
<td>将输出重定向到 file。</td>
</tr>
<tr>
<td>command &lt; file</td>
<td>将输入重定向到 file。</td>
</tr>
<tr>
<td>command &gt;&gt; file</td>
<td>将输出以追加的方式重定向到 file。</td>
</tr>
<tr>
<td>n &gt; file</td>
<td>将文件描述符为 n 的文件重定向到 file。</td>
</tr>
<tr>
<td>n &gt;&gt; file</td>
<td>将文件描述符为 n 的文件以追加的方式重定向到 file。</td>
</tr>
<tr>
<td>n &gt;&amp; m</td>
<td>将输出文件 m 和 n 合并。</td>
</tr>
<tr>
<td>n &lt;&amp; m</td>
<td>将输入文件 m 和 n 合并。</td>
</tr>
<tr>
<td>&lt;&lt; tag</td>
<td>将开始标记 tag 和结束标记 tag 之间的内容作为输入。</td>
</tr>
</tbody></table>
<blockquote>
<p>需要注意的是文件描述符 0 通常是标准输入（STDIN），1 是标准输出（STDOUT），2 是标准错误输出（STDERR）。</p>
</blockquote>
<h2 id="控制语句"><a href="#控制语句" class="headerlink" title="控制语句"></a>控制语句</h2><h3 id="if"><a href="#if" class="headerlink" title="if"></a>if</h3><p><code>if</code> 语句用于根据条件执行代码块。基本语法如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition ]; <span class="keyword">then</span></span><br><span class="line">    <span class="comment"># commands if condition is true</span></span><br><span class="line"><span class="keyword">elif</span> [ another_condition ]; <span class="keyword">then</span></span><br><span class="line">    <span class="comment"># commands if another condition is true</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="comment"># commands if all conditions are false</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<p><strong>示例</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="variable">$age</span> -ge 18 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Adult&quot;</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$age</span> -ge 13 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Teenager&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Child&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<h3 id="while"><a href="#while" class="headerlink" title="while"></a>while</h3><p><code>while</code> 语句在条件为真时重复执行代码块。基本语法如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> [ condition ]; <span class="keyword">do</span></span><br><span class="line">    <span class="comment"># commands to be executed</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></div>

<p><strong>示例</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">count=1</span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$count</span> -le 5 ]; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Count is <span class="variable">$count</span>&quot;</span></span><br><span class="line">    ((count++))</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></div>

<h3 id="for"><a href="#for" class="headerlink" title="for"></a>for</h3><p><code>for</code> 语句用于遍历列表中的每个元素。基本语法如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> variable <span class="keyword">in</span> list; <span class="keyword">do</span></span><br><span class="line">    <span class="comment"># commands to be executed</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></div>

<p><strong>示例</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> fruit <span class="keyword">in</span> apple banana cherry; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;I like <span class="variable">$fruit</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></div>

<p>也可以使用 C 样式的 <code>for</code> 循环：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (( i=<span class="number">1</span>; i&lt;=<span class="number">5</span>; i++ )); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Number <span class="variable">$i</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></div>

<h3 id="case"><a href="#case" class="headerlink" title="case"></a>case</h3><p><code>case</code> 语句用于根据变量的值匹配多个模式。基本语法如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> variable <span class="keyword">in</span></span><br><span class="line">    pattern1)</span><br><span class="line">        <span class="comment"># commands for pattern1</span></span><br><span class="line">        ;;</span><br><span class="line">    pattern2)</span><br><span class="line">        <span class="comment"># commands for pattern2</span></span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">        <span class="comment"># commands for unmatched patterns</span></span><br><span class="line">        ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure></div>

<p><strong>示例</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="variable">$day</span> <span class="keyword">in</span></span><br><span class="line">    1)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Monday&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">    2)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Tuesday&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">    3)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Wednesday&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Other day&quot;</span></span><br><span class="line">        ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure></div>

<h3 id="until"><a href="#until" class="headerlink" title="until"></a>until</h3><p><code>until</code> 语句与 <code>while</code> 相反，它在条件为假时重复执行代码块。基本语法如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">until</span> [ condition ]; <span class="keyword">do</span></span><br><span class="line">    <span class="comment"># commands to be executed</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></div>

<p><strong>示例</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">count=1</span><br><span class="line"><span class="keyword">until</span> [ <span class="variable">$count</span> -gt 5 ]; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Count is <span class="variable">$count</span>&quot;</span></span><br><span class="line">    ((count++))</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></div>

<h3 id="select"><a href="#select" class="headerlink" title="select"></a>select</h3><p><code>select</code> 语句用于生成菜单，让用户选择。基本语法如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> variable <span class="keyword">in</span> list; <span class="keyword">do</span></span><br><span class="line">    <span class="comment"># commands to be executed</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></div>

<p><strong>示例</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> color <span class="keyword">in</span> red green blue; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;You selected <span class="variable">$color</span>&quot;</span></span><br><span class="line">    <span class="built_in">break</span>  <span class="comment"># 使用 break 退出 select 循环</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></div>

<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>在 Linux shell 编程中，函数是一种将一组命令封装在一起的机制，允许你在脚本中重复调用这些命令。使用函数可以使脚本更结构化、可读性更强，并且可以避免代码重复。以下是对 Shell 函数的详解，包括定义、调用、参数、返回值和作用域等内容。</p>
<h3 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a><strong>定义函数</strong></h3><p>在 Bash 中，定义函数的基本语法如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">function_name</span></span> () &#123;</span><br><span class="line">    <span class="comment"># commands to be executed</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>或者使用 <code>function</code> 关键字：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> function_name &#123;</span><br><span class="line">    <span class="comment"># commands to be executed</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="函数示例"><a href="#函数示例" class="headerlink" title="函数示例"></a><strong>函数示例</strong></h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">greet</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Hello, <span class="variable">$1</span>!&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">greet <span class="string">&quot;Alice&quot;</span>  <span class="comment"># 输出: Hello, Alice!</span></span><br></pre></td></tr></table></figure></div>

<h3 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a><strong>函数参数</strong></h3><p>在函数内部，可以使用 <code>$1</code>、<code>$2</code> 等来访问传递给函数的参数。<code>$1</code> 代表第一个参数，<code>$2</code> 代表第二个参数，以此类推。<code>$@</code> 和 <code>$*</code> 用于访问所有参数。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">add</span></span>() &#123;</span><br><span class="line">    <span class="built_in">sum</span>=$(( <span class="variable">$1</span> + <span class="variable">$2</span> ))</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Sum is: <span class="variable">$sum</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add 3 5  <span class="comment"># 输出: Sum is: 8</span></span><br></pre></td></tr></table></figure></div>

<h3 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a><strong>返回值</strong></h3><p>函数的返回值使用<code>return</code>命令，通常返回值是一个整数，范围从 0 到 255。也可以通过 <code>echo</code> 命令返回输出。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">multiply</span></span>() &#123;</span><br><span class="line">    <span class="built_in">return</span> $(( <span class="variable">$1</span> * <span class="variable">$2</span> ))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">multiply 4 5</span><br><span class="line">result=$?</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Return value is: <span class="variable">$result</span>&quot;</span>  <span class="comment"># 输出: Return value is: 20</span></span><br></pre></td></tr></table></figure></div>

<p>通过 <code>echo</code> 返回输出的示例：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">get_date</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="subst">$(date)</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">current_date=$(get_date)  <span class="comment"># 通过命令替换获取当前日期</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Current date is: <span class="variable">$current_date</span>&quot;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="本地变量与全局变量"><a href="#本地变量与全局变量" class="headerlink" title="本地变量与全局变量"></a><strong>本地变量与全局变量</strong></h3><ul>
<li><strong>全局变量</strong>：在函数外部定义的变量在函数内部也是可访问的。</li>
<li><strong>局部变量</strong>：使用 <code>local</code> 关键字定义的变量只在该函数内部可见。</li>
</ul>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">counter=0</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">increment</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> counter=5  <span class="comment"># 局部变量</span></span><br><span class="line">    ((counter++))</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Counter inside function: <span class="variable">$counter</span>&quot;</span>  <span class="comment"># 输出: Counter inside function: 5</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">increment</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Counter outside function: <span class="variable">$counter</span>&quot;</span>  <span class="comment"># 输出: Counter outside function: 0</span></span><br></pre></td></tr></table></figure></div>

<h3 id="函数的调用"><a href="#函数的调用" class="headerlink" title="函数的调用"></a><strong>函数的调用</strong></h3><p>函数可以在定义后随时调用。可以在脚本的任何位置调用已定义的函数。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">say_hello</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Hello!&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">say_hello  <span class="comment"># 输出: Hello!</span></span><br></pre></td></tr></table></figure></div>

<h3 id="函数的作用域"><a href="#函数的作用域" class="headerlink" title="函数的作用域"></a><strong>函数的作用域</strong></h3><p>函数的作用域通常存在以下几种情况：</p>
<ul>
<li>在同一脚本中的任意位置都可以调用已经定义的函数。</li>
<li>如果在当前 shell 中定义的函数，也可以在子 shell 中调用，但局部变量不被共享。</li>
</ul>
<h3 id="递归函数"><a href="#递归函数" class="headerlink" title="递归函数"></a><strong>递归函数</strong></h3><p>函数也可以调用自身，形成递归。这在某些算法（如计算阶乘）中非常有用。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">factorial</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$1</span> -le 1 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> 1</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> $(( <span class="variable">$1</span> * $(factorial $(( <span class="variable">$1</span> - <span class="number">1</span> )) ) ))</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">result=$(factorial 5)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Factorial of 5 is: <span class="variable">$result</span>&quot;</span>  <span class="comment"># 输出: Factorial of 5 is: 120</span></span><br></pre></td></tr></table></figure></div>

<h3 id="函数的文档和帮助"><a href="#函数的文档和帮助" class="headerlink" title="函数的文档和帮助"></a><strong>函数的文档和帮助</strong></h3><p>为了使脚本更易于维护，可以在函数内部添加注释，或者使用 <code>help</code> 命令输出帮助信息。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">my_function</span></span>() &#123;</span><br><span class="line">    <span class="comment"># This function does something</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Doing something&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">help</span> my_function</span><br></pre></td></tr></table></figure></div>

<h2 id="shell-扩展"><a href="#shell-扩展" class="headerlink" title="shell 扩展"></a>shell 扩展</h2><h3 id="shell-中各种括号"><a href="#shell-中各种括号" class="headerlink" title="shell 中各种括号"></a>shell 中各种括号</h3><p><strong>单小括号 ()</strong></p>
<ul>
<li><strong>命令组</strong>。括号中的命令将会新开一个子shell顺序执行，所以括号中的变量不能够被脚本余下的部分使用。括号中多个命令之间用分号隔开，最后一个命令可以没有分号，各命令和括号之间不必有空格。</li>
<li><strong>命令替换</strong>。等同于<code>cmd</code>，shell扫描一遍命令行，发现了<code>$(cmd)</code>结构，便将<code>$(cmd)</code>中的cmd执行一次，得到其标准输出，再将此输出放到原来命令。有些shell不支持，如tcsh。</li>
<li><strong>用于初始化数组</strong>。如：array&#x3D;(a b c d)</li>
</ul>
<p><strong>双小括号 (( ))</strong></p>
<ul>
<li>整数扩展。这种扩展计算是整数型的计算，不支持浮点型。((exp))结构扩展并计算一个算术表达式的值，如果表达式的结果为0，那么返回的退出状态码为1，或者 是”假”，而一个非零值的表达式所返回的退出状态码将为0，或者是”true”。若是逻辑判断，表达式exp为真则为1,假则为0。</li>
<li>只要括号中的运算符、表达式符合C语言运算规则，都可用在<code>$((exp))</code>中，甚至是三目运算符。作不同进位(如二进制、八进制、十六进制)运算时，输出结果全都自动转化成了十进制。如：<code>echo $((16#5f))</code> 结果为95 (16进位转十进制)</li>
<li>单纯用 <code>(( ))</code> 也可重定义变量值，比如 <code>a=5; ((a++)) </code>可将 <code>$a</code> 重定义为 <code>6</code></li>
<li>常用于算术运算比较，双括号中的变量可以不使用<code>$</code>符号前缀。括号内支持多个表达式用逗号分开。  只要括号中的表达式符合C语言运算规则,比如可以直接使用<code>for((i=0;i&lt;5;i++))</code>, 如果不使用双括号, 则为 for i in  `seq 0 4` 或者<code>for i in &#123;0..4&#125;</code>。再如可以直接使用<code>if (($i&lt;5))</code>, 如果不使用双括号, 则为<code>if [ $i  -lt 5 ]</code>。</li>
</ul>
<p><strong>单中括号 []</strong></p>
<ul>
<li>bash  的内部命令，[和test是等同的。如果我们不用绝对路径指明，通常我们用的都是bash自带的命令。if&#x2F;test结构中的左中括号是调用test的命令标识，右中括号是关闭条件判断的。这个命令把它的参数作为比较表达式或者作为文件测试，并且根据比较的结果来返回一个退出状态码。if&#x2F;test结构中并不是必须右中括号，但是新版的Bash中要求必须这样。</li>
<li>Test和[]中可用的比较运算符只有&#x3D;&#x3D;和!&#x3D;，两者都是用于字符串比较的，不可用于整数比较，整数比较只能使用-eq，-gt这种形式。无论是字符串比较还是整数比较都不支持大于号小于号。如果实在想用，对于字符串比较可以使用转义形式，如果比较”ab”和”bc”：[ ab &lt; bc ]，结果为真，也就是返回状态为0。[ ]中的逻辑与和逻辑或使用-a 和-o 表示。</li>
<li>字符范围。用作正则表达式的一部分，描述一个匹配的字符范围。作为test用途的中括号内不能使用正则。</li>
<li>在一个array 结构的上下文中，中括号用来引用数组中每个元素的编号。</li>
</ul>
<p><strong>双中括号[[ ]]</strong></p>
<ul>
<li>[[是 bash 程序语言的关键字。并不是一个命令，[[ ]] 结构比[ ]结构更加通用。在[[和]]之间所有的字符都不会发生文件名扩展或者单词分割，但是会发生参数扩展和命令替换。</li>
<li>支持字符串的模式匹配，使用&#x3D;~操作符时甚至支持shell的正则表达式。字符串比较时可以把右边的作为一个模式，而不仅仅是一个字符串，比如[[ hello &#x3D;&#x3D; hell? ]]，结果为真。[[ ]] 中匹配字符串或通配符，不需要引号。</li>
<li>使用[[ … ]]条件判断结构，而不是[ …  ]，能够防止脚本中的许多逻辑错误。比如，&amp;&amp;、||、&lt;和&gt; 操作符能够正常存在于[[  ]]条件判断结构中，但是如果出现在[ ]结构中的话，会报错。比如可以直接使用<code>if [[ $a != 1 &amp;&amp; $a != 2  ]]</code>, 如果不适用双括号, 则为<code>if [ $a -ne 1] &amp;&amp; [ $a != 2 ]</code>或者<code>if [ $a -ne 1 -a  $a != 2 ]</code>。</li>
<li>bash 把双中括号中的表达式看作一个单独的元素，并返回一个退出状态码。。</li>
</ul>
<h3 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h3><p>在 Linux shell 编程中，文件包含是一种将一个脚本文件的内容嵌入到另一个脚本中的方法。这有助于代码的重用和模块化。这样可以更容易地维护和组织代码，尤其是在处理大型脚本时。</p>
<h4 id="包含文件的基本方法"><a href="#包含文件的基本方法" class="headerlink" title="包含文件的基本方法"></a>包含文件的基本方法</h4><p>在 Bash 中，有两种主要的方法来包含文件的内容：<code>source</code> 命令和点命令（<code>.</code>）。</p>
<p><strong>source 命令</strong></p>
<p><code>source</code> 命令用于在当前 shell 环境中执行指定文件中的命令。其基本语法如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> filename</span><br></pre></td></tr></table></figure></div>

<p><strong>点命令</strong></p>
<p>也可以使用一个点（<code>.</code>）来包含文件，效果等同于 <code>source</code> 命令。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. filename</span><br></pre></td></tr></table></figure></div>

<p><em>示例</em></p>
<p>假设我们有一个包含函数的文件 <code>my_functions.sh</code>：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my_functions.sh</span></span><br><span class="line"><span class="function"><span class="title">greet</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Hello, <span class="variable">$1</span>!&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">farewell</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Goodbye, <span class="variable">$1</span>!&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>我们可以在另一个脚本 <code>main.sh</code> 中包含这个文件，并使用这些函数：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># main.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 包含自定义函数文件</span></span><br><span class="line"><span class="built_in">source</span> my_functions.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用函数</span></span><br><span class="line">greet <span class="string">&quot;Alice&quot;</span></span><br><span class="line">farewell <span class="string">&quot;Bob&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>当你运行 <code>main.sh</code> 时，输出将是：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello, Alice!</span><br><span class="line">Goodbye, Bob!</span><br></pre></td></tr></table></figure></div>

<p><strong>条件包含</strong></p>
<p>有时，您可能希望仅在某个条件下包含某个文件。这可以使用 <code>if</code> 语句结合 <code>[ -f filename ]</code> 来实现，以确保文件存在。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ -f <span class="string">&quot;my_functions.sh&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">source</span> my_functions.sh</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<h4 id="变量的作用域"><a href="#变量的作用域" class="headerlink" title="变量的作用域"></a><strong>变量的作用域</strong></h4><p>通过 <code>source</code> 或点命令包含的文件中的变量将保留在当前的 shell 环境中。这意味着，您可以在包含的脚本中定义变量，并在主脚本中访问这些变量。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my_variables.sh</span></span><br><span class="line">my_var=<span class="string">&quot;Hello, World!&quot;</span></span><br></pre></td></tr></table></figure></div>

<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># main.sh</span></span><br><span class="line"><span class="built_in">source</span> my_variables.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$my_var</span>  <span class="comment"># 输出: Hello, World!</span></span><br></pre></td></tr></table></figure></div>

<h4 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a><strong>错误处理</strong></h4><p>如果您尝试包含一个不存在的文件，<code>source</code> 命令将不会抛出错误，但上面的代码将继续执行。这可能会导致难以跟踪的错误。您可以在包含文件之前检查文件是否存在。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ -f <span class="string">&quot;my_functions.sh&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">source</span> my_functions.sh</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Error: my_functions.sh not found.&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<h1 id="项目构建工具"><a href="#项目构建工具" class="headerlink" title="项目构建工具"></a>项目构建工具</h1><p>项目构建时很重要但也相对简单的一步，无论使用哪款构建工具，都能使用<code>AGI</code>都能很轻松的写出他们的构建脚本，但我们还是要学会他们的语言和优劣，以便在<code>AGI</code>出现幻觉时解决这些问题，学习一些知识时比如QT，也离不开这些工具。</p>
<h2 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h2><p><code>Makefile</code>只适用于一些中小型项目，它的代码可读性非常差，前期学起来很麻烦。在构建速度上，比不上<code>CMake</code>这些现代构建工具(虽然<code>CMake</code>也要先生成<code>Makefile</code>, 但在生成前做了很多优化和检查，但<code>CMake</code>只适合<code>C/C++</code>)，建议使用<code>CMake</code>或<code>SCons</code>这种现代构建工具，老项目，想继续维护的可以选择性的使用新构建工具。这里之所以讲<code>Makefile</code>完全是因为他是前朝遗老，很多经典，老的<code>Unix/Linux</code>项目使用它进行构建。</p>
<p><strong>参考链接</strong></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://liaoxuefeng.com/books/makefile/makefile-basic/index.html" >https://liaoxuefeng.com/books/makefile/makefile-basic/index.html<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="http://makefiletutorial.foofun.cn/" >http://makefiletutorial.foofun.cn/<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.gnu.org/software/make/" >https://www.gnu.org/software/make/<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p><strong>安装</strong></p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install build-essential make gcc g++ clang</span><br></pre></td></tr></table></figure></div>

<p>在Linux环境下，当我们输入<code>make</code>命令时，它就在当前目录查找一个名为<code>Makefile</code>的文件，然后，根据这个文件定义的规则，自动化地执行任意命令，包括编译命令。</p>
<h3 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h3><p><code>Makefile</code>由若干条规则（Rule）构成，每一条规则指出一个目标文件（Target），若干依赖文件（prerequisites），以及生成目标文件的命令。</p>
<p>Makefile由一组 <em>rules</em> 组成。 rule通常如下所示：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">targets: prerequisites</span><br><span class="line">	command</span><br><span class="line">	command</span><br><span class="line">	command</span><br></pre></td></tr></table></figure></div>

<ul>
<li><em>targets</em> （目标） 是文件名，用空格分隔。 通常，每个rule只有一个。</li>
<li><em>commands</em> （命令） 是通常用于创建目标的一系列步骤。 这些 <em>需要以制表符</em> 开头，不可以是空格。</li>
<li><em>prerequisites</em>（先决条件） 也是文件名，用空格分隔。 在运行目标的命令之前，这些文件需要存在。 这些也称为 <em>dependencies</em>（依赖项）</li>
</ul>
<hr>
<p>例如，要生成<code>m.txt</code>，依赖<code>a.txt</code>与<code>b.txt</code>，规则如下：</p>
<p>我们举个例子：在当前目录下，有3个文本文件：<code>a.txt</code>，<code>b.txt</code>和<code>c.txt</code>。</p>
<p>现在，我们要合并<code>a.txt</code>与<code>b.txt</code>，生成中间文件<code>m.txt</code>，再用中间文件<code>m.txt</code>与<code>c.txt</code>合并，生成最终的目标文件<code>x.txt</code>，整个逻辑如下图所示：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">┌─────┐ ┌─────┐ ┌─────┐</span><br><span class="line">│a.txt│ │b.txt│ │c.txt│</span><br><span class="line">└─────┘ └─────┘ └─────┘</span><br><span class="line">   │       │       │</span><br><span class="line">   └───┬───┘       │</span><br><span class="line">       │           │</span><br><span class="line">       ▼           │</span><br><span class="line">    ┌─────┐        │</span><br><span class="line">    │m.txt│        │</span><br><span class="line">    └─────┘        │</span><br><span class="line">       │           │</span><br><span class="line">       └─────┬─────┘</span><br><span class="line">             │</span><br><span class="line">             ▼</span><br><span class="line">          ┌─────┐</span><br><span class="line">          │x.txt│</span><br><span class="line">          └─────┘</span><br></pre></td></tr></table></figure></div>

<p>根据上述逻辑，我们来编写<code>Makefile</code>。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 目标文件: 依赖文件1 依赖文件2</span></span><br><span class="line"><span class="section">m.txt: a.txt b.txt</span></span><br><span class="line">	cat a.txt b.txt &gt; m.txt</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p><strong>注意：Makefile的规则中，命令必须以Tab开头，不能是空格。</strong></p>
</blockquote>
<p>一条规则的格式为<code>目标文件: 依赖文件1 依赖文件2 ...</code>，紧接着，以Tab开头的是命令，用来生成目标文件。上述第一条规则使用<code>cat</code>命令合并了<code>a.txt</code>与<code>b.txt</code>，并写入到<code>m.txt</code>，第二条规则。用什么方式生成目标文件<code>make</code>并不关心，因为命令完全是我们自己写的，可以是编译命令，也可以是<code>cp</code>、<code>mv</code>等任何命令。</p>
<p>以<code>#</code>开头的是注释，会被<code>make</code>命令忽略。</p>
<p>然后我们运行 <code>make m.txt</code>。 只要<code>m.txt</code>文件不存在，命令就会运行。 如果 <code>m.txt</code> 已存在，则不会运行任何命令。</p>
<p>需要注意的是，我所说的<code>m.txt</code>既是一个目标，也是一个文件。 那是因为两者直接绑在一起。 通常，当目标运行时(也就是运行目标的命令时)，这些命令将创建一个与目标同名的文件(也就是 <code>cat a.txt b.txt &gt; m.txt</code>)。</p>
<p><code>make</code>使用文件的创建和修改时间来判断是否应该更新一个目标文件。</p>
<hr>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">x.txt: m.txt c.txt</span></span><br><span class="line">	cat m.txt c.txt &gt; x.txt</span><br><span class="line"></span><br><span class="line"><span class="section">m.txt: a.txt b.txt</span></span><br><span class="line">	cat a.txt b.txt &gt; m.txt</span><br></pre></td></tr></table></figure></div>

<p>当我们执行<code>make</code>时，由于没有将目标作为参数提供给<code>make</code>命令，因此会运行第一个目标，也就是创建<code>x.txt</code>，但是由于<code>x.txt</code>依赖的文件<code>m.txt</code>不存在（另一个依赖<code>c.txt</code>已存在），故需要先执行规则<code>m.txt</code>创建出<code>m.txt</code>文件，再执行规则<code>x.txt</code>。执行完成后，当前目录下生成了两个文件<code>m.txt</code>和<code>x.txt</code>。</p>
<p><code>Makefile</code>定义了一系列规则，每个规则在满足依赖文件的前提下执行命令，就能创建出一个目标文件。把默认执行的规则放第一条，其他规则的顺序是无关紧要的，因为<code>make</code>执行时自动判断依赖。此外，<code>make</code>会打印出执行的每一条命令，便于我们观察执行顺序以便调试。</p>
<h3 id="伪目标"><a href="#伪目标" class="headerlink" title="伪目标"></a>伪目标</h3><p><code>clean</code>通常用作删除其他目标的输出的目标，但它在make中并不是一个专有的词。 你可以在此运行 <code>make</code> 和 <code>make clean</code> 来创建和删除 <code>some_file</code>。</p>
<p>请注意，<code>clean</code>在这里做了两件新的事情：</p>
<ul>
<li>它不是第一个目标 (默认目标)，也不是先决条件。 这意味着除非显式调用<code>make clean</code>，否则它永远不会运行</li>
<li>它不是一个文件名。 如果你碰巧有一个名为 <code>“clean”</code> 的文件，则此目标将无法运行，这不是我们想要的。</li>
</ul>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">some_file: </span></span><br><span class="line">	touch some_file</span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -f some_file</span><br></pre></td></tr></table></figure></div>

<p>将 <code>.PHONY</code> 添加到目标将防止Make将phony（假）目标与文件名混淆。 在此示例中，如果创建了文件 “clean”，则仍将运行 make clean。 从技术上讲，我应该在每个带有<code>all</code>或<code>clean</code>的示例中使用它。 此外，”phony” 目标通常具有很少是文件名的名称，实际上，许多人忽略了它。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">some_file:</span></span><br><span class="line">	touch some_file</span><br><span class="line">	touch clean</span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -f some_file</span><br><span class="line">	rm -f clean</span><br></pre></td></tr></table></figure></div>

<p>大型项目通常会提供<code>clean</code>、<code>install</code>这些约定俗成的伪目标名称，方便用户快速执行特定任务。</p>
<p>一般来说，并不需要用<code>.PHONY</code>标识<code>clean</code>等约定俗成的伪目标名称，除非有人故意搞破坏，手动创建名字叫<code>clean</code>的文件。</p>
<h3 id="命令和执行"><a href="#命令和执行" class="headerlink" title="命令和执行"></a>命令和执行</h3><p><strong>命令回显&#x2F;静默</strong></p>
<p>在命令之前添加 <code>@</code> 以阻止其打印<br>你还可以运行带有<code>-s</code>的make命令，等同于在每行前面添加一个<code>@</code></p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">all: </span></span><br><span class="line">	@echo <span class="string">&quot;This make line will not be printed&quot;</span></span><br><span class="line">	echo <span class="string">&quot;But this will&quot;</span></span><br></pre></td></tr></table></figure></div>

<p><strong>命令执行</strong></p>
<p>每个命令都在一个新的shell中运行(或者至少效果是这样的)</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">all: </span></span><br><span class="line">	cd ..</span><br><span class="line">	<span class="comment"># 上面的cd不会影响该行，因为每个命令都有效地在新的shell中运行</span></span><br><span class="line">	echo `pwd`</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 此cd命令会影响下一个命令，因为它们在同一行上</span></span><br><span class="line">	cd ..;echo `pwd`</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 同上</span></span><br><span class="line">	cd ..; \</span><br><span class="line">	echo `pwd`</span><br></pre></td></tr></table></figure></div>

<p><strong>默认Shell</strong></p>
<p>默认Shell是 ‘&#x2F;bin&#x2F;sh’。你可以通过更改变量SHELL来更改此设置:</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SHELL=/bin/bash</span><br><span class="line"></span><br><span class="line"><span class="section">cool:</span></span><br><span class="line">	echo <span class="string">&quot;Hello from bash&quot;</span></span><br></pre></td></tr></table></figure></div>

<p><strong><code>-k</code>、<code>-i</code>、<code>-</code>错误处理</strong></p>
<p>在运行时添加 <code>-k</code>，即使面对错误也要继续运行。 如果你想一次查看Make的所有错误，这将非常有用。<br>在命令前添加 <code>-</code> 以抑制错误<br>添加<code>-i</code>以使每个命令都会发生这种情况。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">one:</span></span><br><span class="line">	<span class="comment"># 此错误将被打印但被忽略，并且make将继续运行</span></span><br><span class="line">	-false</span><br><span class="line">	touch one</span><br></pre></td></tr></table></figure></div>

<p><strong>中断或杀死Make</strong></p>
<p>备注：如果你对make按下<code>ctrl+c</code>，它将删除它刚刚创建的较新的目标。</p>
<p><strong>Make的递归使用</strong></p>
<p>要递归调用makefile，请使用特殊的 <code>$(MAKE)</code> 而不是 <code>make</code>，因为这样它才能为你传递make标志，并且本身不会受到它们的影响。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">new_contents = <span class="string">&quot;hello:\n\ttouch inside_file&quot;</span></span><br><span class="line"><span class="section">all:</span></span><br><span class="line">	mkdir -p subdir</span><br><span class="line">	printf <span class="variable">$(new_contents)</span> | sed -e &#x27;s/^ //&#x27; &gt; subdir/makefile</span><br><span class="line">	cd subdir &amp;&amp; <span class="variable">$(MAKE)</span></span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -rf subdir</span><br></pre></td></tr></table></figure></div>

<p><strong>使用export进行递归make</strong></p>
<p>export指令采用一个变量，并使sub-make命令可以访问它。 在本例中，导出了<code>cooly</code>，以便subdir中的Makefile可以使用它。</p>
<p>注意: export具有与sh相同的语法，但它们不相关 (尽管在功能上相似)</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">new_contents = <span class="string">&quot;hello:\n\techo \$<span class="variable">$(cooly)</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line">	mkdir -p subdir</span><br><span class="line">	printf <span class="variable">$(new_contents)</span> | sed -e &#x27;s/^ //&#x27; &gt; subdir/makefile</span><br><span class="line">	@echo <span class="string">&quot;---MAKEFILE CONTENTS---&quot;</span></span><br><span class="line">	@cd subdir &amp;&amp; cat makefile</span><br><span class="line">	@echo <span class="string">&quot;---END MAKEFILE CONTENTS---&quot;</span></span><br><span class="line">	cd subdir &amp;&amp; <span class="variable">$(MAKE)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 请注意，变量和导出。 它们在全局范围内被设置/影响。</span></span><br><span class="line">cooly = <span class="string">&quot;The subdirectory can see me!&quot;</span></span><br><span class="line"><span class="keyword">export</span> cooly</span><br><span class="line"><span class="comment"># 这将使上面的行无效: 取消导出cooly</span></span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -rf subdir</span><br></pre></td></tr></table></figure></div>

<p>你需要导出变量，以便让它们也在shell中运行。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">one=this will only work locally</span><br><span class="line"><span class="keyword">export</span> two=we can run subcommands with this</span><br><span class="line"></span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	@echo <span class="variable">$(one)</span></span><br><span class="line">	@echo $$one</span><br><span class="line">	@echo <span class="variable">$(two)</span></span><br><span class="line">	@echo $$two</span><br></pre></td></tr></table></figure></div>

<p><code>.EXPORT_ALL_VARIABLES</code> 为你导出所有变量。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">.EXPORT_ALL_VARIABLES:</span></span><br><span class="line">new_contents = <span class="string">&quot;hello:\n\techo \$<span class="variable">$(cooly)</span>&quot;</span></span><br><span class="line"></span><br><span class="line">cooly = <span class="string">&quot;The subdirectory can see me!&quot;</span></span><br><span class="line"><span class="comment"># 这将使上面一行无效：取消导出cooly</span></span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line">	mkdir -p subdir</span><br><span class="line">	printf <span class="variable">$(new_contents)</span> | sed -e &#x27;s/^ //&#x27; &gt; subdir/makefile</span><br><span class="line">	@echo <span class="string">&quot;---MAKEFILE CONTENTS---&quot;</span></span><br><span class="line">	@cd subdir &amp;&amp; cat makefile</span><br><span class="line">	@echo <span class="string">&quot;---END MAKEFILE CONTENTS---&quot;</span></span><br><span class="line">	cd subdir &amp;&amp; <span class="variable">$(MAKE)</span></span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -rf subdir</span><br></pre></td></tr></table></figure></div>

<p><strong>make的参数</strong></p>
<p>有一个很好的可以从Make运行的 <a class="link"   target="_blank" rel="noopener" href="http://www.gnu.org/software/make/manual/make.html#Options-Summary" >options<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 列表。 查看 <code>--dry-run</code>，<code>--touch</code>，<code>--old-file</code>。</p>
<p>你可以有多个目标来make，例如 <code>make clean run test</code>，运行<code>clean</code>，然后<code>run</code>，然后<code>test</code>。</p>
<h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p><strong>all目标</strong></p>
<p>要制作多个目标，而你想让所有目标都运行？ 你可以制作一个<code>all</code>目标。 由于这是列出的第一个规则，因此如果调用 <code>make</code> 而未指定目标，则默认情况下它将运行。</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">all: one two three</span><br><span class="line"></span><br><span class="line">one:</span><br><span class="line">	touch one</span><br><span class="line">two:</span><br><span class="line">	touch two</span><br><span class="line">three:</span><br><span class="line">	touch three</span><br><span class="line"></span><br><span class="line">clean:</span><br><span class="line">	rm -f one two three</span><br></pre></td></tr></table></figure></div>

<p><strong>多目标</strong></p>
<p>当一个规则有多个目标时，将为每个目标运行命令。 <code>$@</code> 是包含目标名称的自动变量。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">all: f1.o f2.o</span></span><br><span class="line"></span><br><span class="line">f1.o f2.o:</span><br><span class="line">	echo <span class="variable">$@</span></span><br><span class="line"><span class="comment"># 相当于：</span></span><br><span class="line"><span class="comment"># f1.o:</span></span><br><span class="line"><span class="comment">#	 echo f1.o</span></span><br><span class="line"><span class="comment"># f2.o:</span></span><br><span class="line"><span class="comment">#	 echo f2.o</span></span><br></pre></td></tr></table></figure></div>

<h3 id="自动变量和通配符"><a href="#自动变量和通配符" class="headerlink" title="自动变量和通配符"></a>自动变量和通配符</h3><p><strong><code>*</code> 通配符</strong></p>
<p><code>*</code> 和 <code>%</code> 在 Make中都被称为通配符，但它们的含义完全不同。 <code>*</code>会在你的文件系统中搜索匹配的文件名。 我建议你始终将其包装在<code>wildcard</code> 函数中，因为否则你可能会陷入下面描述的常见陷阱。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打印出每个.c文件的文件信息</span></span><br><span class="line"><span class="section">print: $(wildcard *.c)</span></span><br><span class="line">	ls -la  <span class="variable">$?</span></span><br></pre></td></tr></table></figure></div>

<p><code>“*” </code>可以在目标，先决条件或 <code>wildcard</code> 函数中使用。</p>
<p>危险：<code>*</code>不能在变量定义中直接使用</p>
<p>危险: 当 <code>*</code> 不匹配任何文件时，它将维持原样 (除非在<code>wildcard</code> 函数中运行)</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">thing_wrong := *.o <span class="comment"># 不要这样做！‘*’不会展开</span></span><br><span class="line">thing_right := <span class="variable">$(<span class="built_in">wildcard</span> *.o)</span></span><br><span class="line"></span><br><span class="line"><span class="section">all: one two three four</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 失败，因为$(thing_wrong)是字符串“*.o”</span></span><br><span class="line"><span class="section">one: <span class="variable">$(thing_wrong)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果没有与此模式匹配的文件，则保持为 *.o :(</span></span><br><span class="line"><span class="section">two: *.o </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如你所料！在这种情况下，它什么也不做。</span></span><br><span class="line"><span class="section">three: <span class="variable">$(thing_right)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 与规则three相同</span></span><br><span class="line"><span class="section">four: $(wildcard *.o)</span></span><br></pre></td></tr></table></figure></div>

<p><strong><code>%</code> 通配符</strong></p>
<p><code>%</code>确实很有用，但由于它可以在多种情况下使用，所以有点令人困惑。</p>
<ul>
<li>在“匹配”模式下使用时，匹配字符串中的一个或多个字符。 这种匹配被称为词干（stem）。</li>
<li>在“替换”模式下使用时，它会获取匹配的词干，并替换字符串中的词干。</li>
<li><code>%</code> 最常用于规则定义和某些特定函数中。</li>
</ul>
<p><strong>自动变量</strong></p>
<p>有很多个 <a class="link"   target="_blank" rel="noopener" href="https://www.gnu.org/software/make/manual/html_node/Automatic-Variables.html" >自动变量<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> ，但通常只有几个出现：</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">hey: one two</span></span><br><span class="line">	<span class="comment"># 输出 “hey”，因为这是目标名称</span></span><br><span class="line">	echo <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 输出比目标更新的所有先决条件</span></span><br><span class="line">	echo <span class="variable">$?</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 输出所有先决条件</span></span><br><span class="line">	echo <span class="variable">$^</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 表示第一个依赖文件，也就是这里的 $^ 的第一个元素。</span></span><br><span class="line">	echo <span class="variable">$&lt;</span></span><br><span class="line">	</span><br><span class="line">	touch hey</span><br><span class="line"></span><br><span class="line"><span class="section">one:</span></span><br><span class="line">	touch one</span><br><span class="line"></span><br><span class="line"><span class="section">two:</span></span><br><span class="line">	touch two</span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -f hey one two</span><br></pre></td></tr></table></figure></div>

<h3 id="其它规则"><a href="#其它规则" class="headerlink" title="其它规则"></a>其它规则</h3><p><strong>隐式规则</strong></p>
<p>Make偏爱c编译。 而每次它出现这种偏爱的时候，事情就会变得混乱。 也许Make中最令人困惑的部分是Make的魔术&#x2F;自动规则（<code>magic/automatic rules</code>）。 Make会调用这些“隐含的”规则。 我个人不同意这个设计决定，也不建议使用它们，但是它们经常被使用，因此很有用。 以下是隐含规则的列表：</p>
<ul>
<li>编译C程序: 从 <code>n.c</code> 自动生成 <code>n.o</code>，命令形式为 <code>$(CC) -c $(CPPFLAGS) $(CFLAGS)</code></li>
<li>编译C++程序：<code>n.o</code>由<code>n.cc</code>或<code>n.cpp</code>自动生成，命令形式为<code>$(CXX) -c $(CPPFLAGS) $(CXXFLAGS)</code></li>
<li>链接单个目标文件: 自动从<code>n.o</code>构造<code>n</code>， 通过运行命令<code>$(CC) $(LDFLAGS) n.o $(LOADLIBES) $(LDLIBS)</code></li>
</ul>
<p>隐式规则使用的重要变量包括：</p>
<ul>
<li><code>CC</code>: 编译C程序的程序；默认<code>cc</code></li>
<li><code>CXX</code>: 编译C++程序的程序; 默认 <code>g++</code></li>
<li><code>CFLAGS</code>: 要提供给C编译器的额外标志</li>
<li><code>CXXFLAGS</code>: 给C++编译器的额外标志</li>
<li><code>CPPFLAGS</code>: 要提供给C预处理器的额外标志</li>
<li><code>LDFLAGS</code>: 当编译器应该调用链接器时，会给他们额外的标志</li>
</ul>
<p>让我们看看我们现在如何构建一个C程序，而无需明确地告诉制造如何进行编译:</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CC = gcc <span class="comment"># 隐式规则标志</span></span><br><span class="line">CFLAGS = -g <span class="comment"># 隐式规则的标志。打开调试信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 隐式规则 #1：blah是通过C链接器隐式规则构建的</span></span><br><span class="line"><span class="comment"># 隐式规则 #2: blah.o是通过C编译隐式规则构建的，因为blah.c存在</span></span><br><span class="line"><span class="section">blah: blah.o</span></span><br><span class="line"></span><br><span class="line"><span class="section">blah.c:</span></span><br><span class="line">	echo <span class="string">&quot;int main() &#123; return 0; &#125;&quot;</span> &gt; blah.c</span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -f blah*</span><br></pre></td></tr></table></figure></div>

<p><strong>静态模式规则</strong></p>
<p>静态模式规则是在Makefile中减少编写量的另一种方式，但我会说更有用，并且 “魔术” 技巧更少。 它们的语法如下：</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">targets...: target-pattern: prereq-patterns ...</span></span><br><span class="line">   commands</span><br></pre></td></tr></table></figure></div>

<p>本质是给定的 <code>target</code> 与 <code>target-pattern</code> 匹配 (通过 <code>%</code> 通配符)。 任何匹配的东西都被称为 <em>词干</em>。 然后将词干替换为 “prereq-pattern”，以生成目标的prereq。</p>
<p>一个典型的用例是将<code>.c</code>文件编译成<code>.o</code>文件。 这里是手动方式:</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">objects = foo.o bar.o all.o</span><br><span class="line"><span class="section">all: <span class="variable">$(objects)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这些文件通过上面隐式规则进行编译</span></span><br><span class="line"><span class="section">foo.o: foo.c</span></span><br><span class="line"><span class="section">bar.o: bar.c</span></span><br><span class="line"><span class="section">all.o: all.c</span></span><br><span class="line"></span><br><span class="line"><span class="section">all.c:</span></span><br><span class="line">	echo <span class="string">&quot;int main() &#123; return 0; &#125;&quot;</span> &gt; all.c</span><br><span class="line"></span><br><span class="line"><span class="section">%.c:</span></span><br><span class="line">	touch <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -f *.c *.o all</span><br></pre></td></tr></table></figure></div>

<p>这是使用静态模式规则的更高效的方式:</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">objects = foo.o bar.o all.o</span><br><span class="line"><span class="section">all: <span class="variable">$(objects)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这些文件通过隐式规则进行编译</span></span><br><span class="line"><span class="comment"># 语法 - targets ...: target-pattern: prereq-patterns ...</span></span><br><span class="line"><span class="comment"># 在第一个目标foo.o的情况下，目标模式与foo.o匹配，并将“词干”设置为“foo”。</span></span><br><span class="line"><span class="comment"># 然后用该词干替换prereq模式中的 “%”</span></span><br><span class="line"><span class="variable">$(objects)</span>: %.o: %.c</span><br><span class="line"></span><br><span class="line"><span class="section">all.c:</span></span><br><span class="line">	echo <span class="string">&quot;int main() &#123; return 0; &#125;&quot;</span> &gt; all.c</span><br><span class="line"></span><br><span class="line"><span class="section">%.c:</span></span><br><span class="line">	touch <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -f *.c *.o all</span><br></pre></td></tr></table></figure></div>

<p><strong>静态模式规则和过滤器</strong></p>
<p>当我稍后介绍函数时，我将预示你可以使用它们来做什么。 <code>filter</code> 过滤器函数可以在静态模式规则中使用，以匹配正确的文件。 在本例中，我编造了<code>.raw</code>和<code>.result</code>扩展名。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">obj_files = foo.result bar.o lose.o</span><br><span class="line">src_files = foo.raw bar.c lose.c</span><br><span class="line"></span><br><span class="line"><span class="section">all: <span class="variable">$(obj_files)</span></span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">filter</span> %.o,<span class="variable">$(obj_files)</span>)</span>: %.o: %.c</span><br><span class="line">	echo <span class="string">&quot;target: <span class="variable">$@</span> prereq: <span class="variable">$&lt;</span>&quot;</span></span><br><span class="line"><span class="variable">$(<span class="built_in">filter</span> %.result,<span class="variable">$(obj_files)</span>)</span>: %.result: %.raw</span><br><span class="line">	echo <span class="string">&quot;target: <span class="variable">$@</span> prereq: <span class="variable">$&lt;</span>&quot;</span> </span><br><span class="line"></span><br><span class="line">%.c %.raw:</span><br><span class="line">	touch <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -f <span class="variable">$(src_files)</span></span><br></pre></td></tr></table></figure></div>

<p><strong>模式规则</strong></p>
<p>模式规则经常被使用，但非常令人困惑。你可以从两个方面来看待它们：</p>
<ul>
<li>定义自己的隐含规则的方法</li>
<li>静态模式规则的更简单形式</li>
</ul>
<p>让我们首先从一个例子开始:</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义将每个.c文件编译为.o文件的模式规则</span></span><br><span class="line">%.o : %.c</span><br><span class="line">		<span class="variable">$(CC)</span> -c <span class="variable">$(CFLAGS)</span> <span class="variable">$(CPPFLAGS)</span> <span class="variable">$&lt;</span> -o <span class="variable">$@</span></span><br></pre></td></tr></table></figure></div>

<p>模式规则在目标中包含<code>%</code>。 此 <code>%</code> 匹配任何非空字符串，其他字符匹配自己。 模式规则先决条件中的<code>%</code>代表与目标中的<code>%</code>匹配的同一词干。</p>
<p>这里是另一个例子:</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义一个在先决条件中没有模式的模式规则。</span></span><br><span class="line"><span class="comment"># 这只会在需要时创建空的.c文件。</span></span><br><span class="line"><span class="section">%.c:</span></span><br><span class="line">   touch <span class="variable">$@</span></span><br></pre></td></tr></table></figure></div>

<p><strong>双冒号规则</strong></p>
<p>很少使用双冒号规则，但用它允许为同一目标定义多个规则。 如果这些规则是单冒号，则会打印一条警告，并且只运行这里的第二组命令。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">all: blah</span></span><br><span class="line"></span><br><span class="line"><span class="section">blah::</span></span><br><span class="line">	echo <span class="string">&quot;hello&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">blah::</span></span><br><span class="line">	echo <span class="string">&quot;hello again&quot;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p><strong>类型和修饰</strong></p>
<p>有两种类型的变量：</p>
<ul>
<li>递归 (使用 <code>=</code>) - 在<em>使用命令</em>时才会查找变量，而不在<em>定义命令</em>时查找变量。</li>
<li>简单展开 (使用 <code>:=</code>) - 就像普通的命令式编程一样 – 只有到目前为止定义的变量才会得到展开</li>
</ul>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 递归变量。这将能在下面打印出 “later”</span></span><br><span class="line">one = one $&#123;later_variable&#125;</span><br><span class="line"><span class="comment"># 简单展开变量。这无法在下面打印出 “later”</span></span><br><span class="line">two := two $&#123;later_variable&#125;</span><br><span class="line"></span><br><span class="line">later_variable = later</span><br><span class="line"></span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	echo <span class="variable">$(one)</span></span><br><span class="line">	echo <span class="variable">$(two)</span></span><br></pre></td></tr></table></figure></div>

<p>简单的说展开(使用<code>:=</code>)允许你追加到一个变量。 递归定义可能会给出无限循环错误。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">one = hello</span><br><span class="line"><span class="comment"># one被定义为一个简单展开变量(:=)，因此可以处理追加</span></span><br><span class="line">one := $&#123;one&#125; there</span><br><span class="line"></span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	echo <span class="variable">$(one)</span></span><br></pre></td></tr></table></figure></div>

<p><code>?=</code> 仅设置尚未设置的变量</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">one = hello</span><br><span class="line">one ?= will not be set</span><br><span class="line">two ?= will be set</span><br><span class="line"></span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	echo <span class="variable">$(one)</span></span><br><span class="line">	echo <span class="variable">$(two)</span></span><br></pre></td></tr></table></figure></div>

<p>行尾的空格不会被去掉，但行首的空格会被去掉。 要使用单个空格制作变量，请使用 <code>$(nullstring)</code></p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">with_spaces = hello   <span class="comment"># with_spaces在 &quot;hello&quot; 之后有很多空格</span></span><br><span class="line">after = <span class="variable">$(with_spaces)</span>there</span><br><span class="line"></span><br><span class="line">nullstring =</span><br><span class="line">space = <span class="variable">$(nullstring)</span> <span class="comment"># 构造一个单个空格变量。</span></span><br><span class="line"></span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	echo <span class="string">&quot;<span class="variable">$(after)</span>&quot;</span></span><br><span class="line">	echo start<span class="string">&quot;<span class="variable">$(space)</span>&quot;</span>end</span><br></pre></td></tr></table></figure></div>

<p>未定义的变量实际上是空字符串！</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">all: </span></span><br><span class="line">	<span class="comment"># 未定义的变量只是空字符串!</span></span><br><span class="line">	echo <span class="variable">$(nowhere)</span></span><br></pre></td></tr></table></figure></div>

<p>使用 <code>+=</code> 追加</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">foo := start</span><br><span class="line">foo += more</span><br><span class="line"></span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	echo <span class="variable">$(foo)</span></span><br></pre></td></tr></table></figure></div>

<p>字符串替换也是一种真正常见且有用的修改变量的方法。 另请查看 <a class="link"   target="_blank" rel="noopener" href="https://www.gnu.org/software/make/manual/html_node/Text-Functions.html#Text-Functions" >Text Functions<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 和 <a class="link"   target="_blank" rel="noopener" href="https://www.gnu.org/software/make/manual/html_node/File-Name-Functions.html#File-Name-Functions" >Filename Functions<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 。</p>
<p><strong>命令行参数和覆盖</strong></p>
<p>你可以使用<code>override</code>覆盖来自命令行的变量。 在这里，我们用 <code>make option_one=hi</code> 运行 make</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 覆盖命令行参数</span></span><br><span class="line"><span class="keyword">override</span> option_one = did_override</span><br><span class="line"><span class="comment"># 未覆盖的命令行参数</span></span><br><span class="line">option_two = not_override</span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	echo <span class="variable">$(option_one)</span></span><br><span class="line">	echo <span class="variable">$(option_two)</span></span><br></pre></td></tr></table></figure></div>

<p><strong>命令列表和define</strong></p>
<p>“define”实际上只是一个命令列表。 它与函数无关。 请注意，这与命令之间的分号有点不同，因为每个命令都在单独的shell中运行，如预期的那样。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">one = <span class="keyword">export</span> blah=<span class="string">&quot;I was set!&quot;</span>; echo $$blah</span><br><span class="line"></span><br><span class="line"><span class="keyword">define</span> two</span><br><span class="line"><span class="keyword">export</span> blah=set</span><br><span class="line">echo $$blah</span><br><span class="line"><span class="keyword">endef</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># one和two是不同的。</span></span><br><span class="line"></span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	@echo <span class="string">&quot;这会打印 &#x27;I was set&#x27;&quot;</span></span><br><span class="line">	@<span class="variable">$(one)</span></span><br><span class="line">	@echo <span class="string">&quot;这不会打印 &#x27;I was set&#x27; 因为每个command都在单独的shell中运行&quot;</span></span><br><span class="line">	@<span class="variable">$(two)</span></span><br></pre></td></tr></table></figure></div>

<p><strong>目标特定变量</strong></p>
<p>可以为特定目标中赋值变量</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">all: one = cool</span></span><br><span class="line"></span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	echo one is defined: <span class="variable">$(one)</span></span><br><span class="line"></span><br><span class="line"><span class="section">other:</span></span><br><span class="line">	echo one is nothing: <span class="variable">$(one)</span></span><br></pre></td></tr></table></figure></div>

<p><strong>模式特定变量</strong></p>
<p>你可以为特定目标模式中分配变量</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">%.c: one = cool</span></span><br><span class="line"></span><br><span class="line"><span class="section">blah.c: </span></span><br><span class="line">	echo one is defined: <span class="variable">$(one)</span></span><br><span class="line"></span><br><span class="line"><span class="section">other:</span></span><br><span class="line">	echo one is nothing: <span class="variable">$(one)</span></span><br></pre></td></tr></table></figure></div>

<h3 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h3><p><strong>条件if&#x2F;else</strong></p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">foo = ok</span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(foo)</span>, ok)</span><br><span class="line">	echo <span class="string">&quot;foo equals ok&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	echo <span class="string">&quot;nope&quot;</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure></div>

<p><strong>检查变量是否为空</strong></p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nullstring =</span><br><span class="line">foo = <span class="variable">$(nullstring)</span> <span class="comment"># 行尾; 这里有一个空格</span></span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(<span class="built_in">strip</span> <span class="variable">$(foo)</span>)</span>,)</span><br><span class="line">	echo <span class="string">&quot;foo is empty after being stripped&quot;</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(nullstring)</span>,)</span><br><span class="line">	echo <span class="string">&quot;nullstring doesn&#x27;t even have spaces&quot;</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure></div>

<p><strong>检查是否定义了变量</strong></p>
<p>ifdef不展开变量引用；它只查看是否定义了某些内容</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">bar =</span><br><span class="line">foo = <span class="variable">$(bar)</span></span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line"><span class="keyword">ifdef</span> foo</span><br><span class="line">	echo <span class="string">&quot;foo is defined&quot;</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="keyword">ifndef</span> bar</span><br><span class="line">	echo <span class="string">&quot;but bar is not&quot;</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure></div>

<p><strong>$(makeflags)</strong></p>
<p>此示例向你展示了如何使用 <code>findstring</code> 和 <code>MAKEFLAGS</code> 测试make标志。 使用<code>make -i</code>运行此示例，以查看它打印出echo语句。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bar =</span><br><span class="line">foo = <span class="variable">$(bar)</span></span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line"><span class="comment"># 搜索 “-i” 标志。 MAKEFLAGS只是一个单一字符的列表，每个标志一个字符。 所以在这种情况下寻找 “i”。</span></span><br><span class="line"><span class="keyword">ifneq</span> (,<span class="variable">$(<span class="built_in">findstring</span> i, <span class="variable">$(MAKEFLAGS)</span>)</span>)</span><br><span class="line">	echo <span class="string">&quot;i was passed to MAKEFLAGS&quot;</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure></div>

<h3 id="函数-1"><a href="#函数-1" class="headerlink" title="函数"></a>函数</h3><p><strong>首个函数</strong></p>
<p><em>函数</em>主要用于文本处理。 用 <code>$(fn, arguments)</code> 或 <code>$&#123;fn, arguments&#125;</code> 调用函数。 你可以使用 <a class="link"   target="_blank" rel="noopener" href="https://www.gnu.org/software/make/manual/html_node/Call-Function.html#Call-Function" >call<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 内置函数来创建自己的代码。 Make有相当数量的 <a class="link"   target="_blank" rel="noopener" href="https://www.gnu.org/software/make/manual/html_node/Functions.html" >内置函数<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bar := $&#123;subst not, totally, <span class="string">&quot;I am not superman&quot;</span>&#125;</span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	@echo <span class="variable">$(bar)</span></span><br></pre></td></tr></table></figure></div>

<p>如果要使用变量替换空格或逗号</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">comma := ,</span><br><span class="line">empty:=</span><br><span class="line">space := <span class="variable">$(empty)</span> <span class="variable">$(empty)</span></span><br><span class="line">foo := a b c</span><br><span class="line">bar := <span class="variable">$(<span class="built_in">subst</span> <span class="variable">$(space)</span>,<span class="variable">$(comma)</span>,<span class="variable">$(foo)</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	@echo <span class="variable">$(bar)</span></span><br></pre></td></tr></table></figure></div>

<p>第一个参数后不要包含空格。 否则这将被视为字符串的一部分。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">comma := ,</span><br><span class="line">empty:=</span><br><span class="line">space := <span class="variable">$(empty)</span> <span class="variable">$(empty)</span></span><br><span class="line">foo := a b c</span><br><span class="line">bar := <span class="variable">$(<span class="built_in">subst</span> <span class="variable">$(space)</span>, <span class="variable">$(comma)</span> , <span class="variable">$(foo)</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="section">all: </span></span><br><span class="line">	<span class="comment">#输出为 &quot;, a , b , c&quot;。 注意引入的空格</span></span><br><span class="line">	@echo <span class="variable">$(bar)</span></span><br></pre></td></tr></table></figure></div>

<p><strong>字符串替换</strong></p>
<p><code>$(patsubst pattern,replacement,text)</code>执行以下操作：</p>
<p>“在与pattern匹配的text中查找空格分隔的单词，并将其替换为replacement。 在这里，模式可以包含充当通配符的‘%’，匹配单词中任意数量的任何字符。 如果替换还包含 ‘%’，则将 ‘%’ 替换为与模式中的 ‘%’ 匹配的文本。 只有模式和替换中的第一个‘%’会以这种方式处理；任何后续的‘%’都不会改变。” (<a class="link"   target="_blank" rel="noopener" href="https://www.gnu.org/software/make/manual/html_node/Text-Functions.html#Text-Functions" >GNU docs<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>)</p>
<p>替换引用 <code>$(text:pattern=replacement)</code> 是这方面的简写。</p>
<p>还有一个只替换后缀的简写：<code>$(text:suffix=replacement)</code>。 这里不使用 <code>%</code> 通配符。</p>
<p>注意：不要为此简写添加额外的空格。 它将被视为搜索或替换术语。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">foo := a.o b.o l.a c.o</span><br><span class="line">one := <span class="variable">$(<span class="built_in">patsubst</span> %.o,%.c,<span class="variable">$(foo)</span>)</span></span><br><span class="line"><span class="comment"># 这是上述内容的简写</span></span><br><span class="line">two := $(foo:%.o=%.c)</span><br><span class="line"><span class="comment"># 这是仅后缀的简写，也等同于上述。</span></span><br><span class="line">three := $(foo:.o=.c)</span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line">	echo <span class="variable">$(one)</span></span><br><span class="line">	echo <span class="variable">$(two)</span></span><br><span class="line">	echo <span class="variable">$(three)</span></span><br></pre></td></tr></table></figure></div>

<p><strong>foreach函数</strong></p>
<p>foreach函数如下所示: <code>$(foreach var,list,text)</code>。 它将一个单词列表(由空格分隔)转换为另一个列表。 <code>var</code>被设置为list中每个单词，同时<code>text</code>是针对每一个单词的展开。<br>这里在每个单词后附加了一个感叹号:</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">foo := who are you</span><br><span class="line"><span class="comment"># 对于foo中的每个“word”，输出相同的单词，并在后面加一个感叹号</span></span><br><span class="line">bar := <span class="variable">$(<span class="built_in">foreach</span> wrd,<span class="variable">$(foo)</span>,<span class="variable">$(wrd)</span>!)</span></span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line">	<span class="comment"># 输出是 &quot;who! are! you!&quot;</span></span><br><span class="line">	@echo <span class="variable">$(bar)</span></span><br></pre></td></tr></table></figure></div>

<p><strong>if函数</strong></p>
<p><code>if</code>检查第一个参数是否为非空。如果是，则运行第二个参数，否则运行第三个参数。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">foo := <span class="variable">$(<span class="built_in">if</span> this-is-not-empty,then!,else!)</span></span><br><span class="line">empty :=</span><br><span class="line">bar := <span class="variable">$(<span class="built_in">if</span> <span class="variable">$(empty)</span>,then!,else!)</span></span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line">	@echo <span class="variable">$(foo)</span></span><br><span class="line">	@echo <span class="variable">$(bar)</span></span><br></pre></td></tr></table></figure></div>

<p><strong>调用函数</strong></p>
<p>Make支持创建基本函数。 你只需创建一个变量即可定义函数，但需要使用<code>$(0)</code>、<code>$(1)</code>等参数。 然后，你使用特殊的 ‘call’ 函数调用该函数。 语法为<code>$(call variable,param,param)</code>。 <code>$(0)</code> 是变量，而 <code>$(1)</code>，<code>$(2)</code>… 等是参数。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sweet_new_fn = Variable Name: $(0) First: $(1) Second: $(2) Empty Variable: $(3)</span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line">	<span class="comment"># 输出 “Variable Name：sweet_new_fn First: go Second: tigers Empty Variable：”</span></span><br><span class="line">	@echo <span class="variable">$(<span class="built_in">call</span> sweet_new_fn, go, tigers)</span></span><br></pre></td></tr></table></figure></div>

<p><strong>shell函数</strong></p>
<p>shell - 这调用shell，但它用空格替换换行符!</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">all: </span></span><br><span class="line">	@echo <span class="variable">$(<span class="built_in">shell</span> ls -la)</span> <span class="comment"># 很难看，因为换行不见了！</span></span><br></pre></td></tr></table></figure></div>

<h3 id="其他特性"><a href="#其他特性" class="headerlink" title="其他特性"></a>其他特性</h3><p><strong>包含Makefiles</strong></p>
<p>include指令告诉make读取一个或多个其他多个makefiles。 一行makefile中makefile，看起来像这样:</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> filenames...</span><br></pre></td></tr></table></figure></div>

<p>当你使用诸如 <code>-M</code> 之类的编译器标志基于源创建Makefiles时，这特别有用。 例如，如果某些c文件包含头文件，则该头文件将被添加到由GCC编写的Makefile中。 我在 <a class="link"   target="_blank" rel="noopener" href="http://makefiletutorial.foofun.cn/#makefile-Cookbook" >Makefile Cookbook<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 中有更多探讨</p>
<p><strong>vpath指令</strong></p>
<p>使用vpath指定一些先决条件的存在位置。 格式为<code>vpath &lt;pattern&gt; &lt;directories, space/colon separated&gt;</code><br><code>&lt;pattern&gt;</code> 可以有一个 <code>%</code>，它匹配任何零个或多个字符。<br>你还可以使用变量VPATH在全局范围内执行此操作</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">vpath</span> %.h ../headers ../other-directory</span><br><span class="line"></span><br><span class="line"><span class="section">some_binary: ../headers blah.h</span></span><br><span class="line">	touch some_binary</span><br><span class="line"></span><br><span class="line"><span class="section">../headers:</span></span><br><span class="line">	mkdir ../headers</span><br><span class="line"></span><br><span class="line"><span class="section">blah.h:</span></span><br><span class="line">	touch ../headers/blah.h</span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -rf ../headers</span><br><span class="line">	rm -f some_binary</span><br></pre></td></tr></table></figure></div>

<p><strong>多行</strong></p>
<p>反斜杠(“&quot;)字符使我们能够在命令太长时使用多行</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">some_file: </span></span><br><span class="line">	echo This line is too long, so \</span><br><span class="line">		it is broken up into multiple lines</span><br></pre></td></tr></table></figure></div>

<p><strong>.phony</strong></p>
<p>将 <code>.PHONY</code> 添加到目标将防止Make将phony（假）目标与文件名混淆。 在此示例中，如果创建了文件 “clean”，则仍将运行 make clean。 从技术上讲，我应该在每个带有<code>all</code>或<code>clean</code>的示例中使用它，但我没有保持clean示例。 此外，”phony” 目标通常具有很少是文件名的名称，实际上，许多人忽略了它。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">some_file:</span></span><br><span class="line">	touch some_file</span><br><span class="line">	touch clean</span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -f some_file</span><br><span class="line">	rm -f clean</span><br></pre></td></tr></table></figure></div>

<p><strong>.delete_on_error</strong></p>
<p>如果命令返回非零退出状态，则make工具将停止运行规则(并将传播回先决条件)。<br>如果规则以这种方式失败，则 <code>DELETE_ON_ERROR</code> 将删除规则的目标。 这将发生在所有目标上，而不仅仅是它之前的那个PHONY目标。 最好始终使用它是一个好主意，即使make出于历史原因没有默认使用这个策略。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">.DELETE_ON_ERROR:</span></span><br><span class="line"><span class="section">all: one two</span></span><br><span class="line"></span><br><span class="line"><span class="section">one:</span></span><br><span class="line">	touch one</span><br><span class="line">	false</span><br><span class="line"></span><br><span class="line"><span class="section">two:</span></span><br><span class="line">	touch two</span><br><span class="line">	false</span><br></pre></td></tr></table></figure></div>

<hr>
<p><strong>示例</strong></p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 感谢Job Vranish (https://spin.atomicobject.com/2016/08/26/makefile-c-projects/)</span></span><br><span class="line">TARGET_EXEC := final_program</span><br><span class="line"></span><br><span class="line">BUILD_DIR := ./build</span><br><span class="line">SRC_DIRS := ./src</span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到我们要编译的所有C和C++文件</span></span><br><span class="line"><span class="comment"># 请注意 * 表达式两边的单引号。 否则Make会在那里错误地展开。</span></span><br><span class="line">SRCS := <span class="variable">$(<span class="built_in">shell</span> find <span class="variable">$(SRC_DIRS)</span> -name &#x27;*.cpp&#x27; -<span class="built_in">or</span> -name &#x27;*.c&#x27; -<span class="built_in">or</span> -name &#x27;*.s&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 每个C/C++文件的字符串替换。</span></span><br><span class="line"><span class="comment"># 例如，hello.cpp变成./build/hello.cpp.o</span></span><br><span class="line">OBJS := $(SRCS:%=<span class="variable">$(BUILD_DIR)</span>/%.o)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串替换(不带%的后缀版本)。</span></span><br><span class="line"><span class="comment">#例如，./build/hello.cpp.o变成./build/hello.cpp.d</span></span><br><span class="line">DEPS := $(OBJS:.o=.d)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ./src中的每个文件夹将需要传递给GCC，以便它可以找到头文件</span></span><br><span class="line">INC_DIRS := <span class="variable">$(<span class="built_in">shell</span> find <span class="variable">$(SRC_DIRS)</span> -type d)</span></span><br><span class="line"><span class="comment"># 为INC_DIRS添加前缀。所以moduleA会变成-ImoduleA。GCC会理解-I标志</span></span><br><span class="line">INC_FLAGS := <span class="variable">$(<span class="built_in">addprefix</span> -I,<span class="variable">$(INC_DIRS)</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -MMD和-MP标志一起为我们生成Makefiles！</span></span><br><span class="line"><span class="comment"># 这些文件将有.d而不是.o作为输出。</span></span><br><span class="line">CPPFLAGS := <span class="variable">$(INC_FLAGS)</span> -MMD -MP</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最后一个构建步骤。</span></span><br><span class="line"><span class="variable">$(BUILD_DIR)</span>/<span class="variable">$(TARGET_EXEC)</span>: <span class="variable">$(OBJS)</span></span><br><span class="line">	<span class="variable">$(CC)</span> <span class="variable">$(OBJS)</span> -o <span class="variable">$@</span> <span class="variable">$(LDFLAGS)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># C源代码的构建步骤</span></span><br><span class="line"><span class="variable">$(BUILD_DIR)</span>/%.c.o: %.c</span><br><span class="line">	mkdir -p <span class="variable">$(<span class="built_in">dir</span> <span class="variable">$@</span>)</span></span><br><span class="line">	<span class="variable">$(CC)</span> <span class="variable">$(CPPFLAGS)</span> <span class="variable">$(CFLAGS)</span> -c <span class="variable">$&lt;</span> -o <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># C++源代码构建步骤</span></span><br><span class="line"><span class="variable">$(BUILD_DIR)</span>/%.cpp.o: %.cpp</span><br><span class="line">	mkdir -p <span class="variable">$(<span class="built_in">dir</span> <span class="variable">$@</span>)</span></span><br><span class="line">	<span class="variable">$(CXX)</span> <span class="variable">$(CPPFLAGS)</span> <span class="variable">$(CXXFLAGS)</span> -c <span class="variable">$&lt;</span> -o <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -r <span class="variable">$(BUILD_DIR)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 包含.d makefiles。 </span></span><br><span class="line"><span class="comment"># 前面的 - 抑制缺少makefile的错误。 </span></span><br><span class="line"><span class="comment"># 最初，所有的.d文件都将丢失，我们不希望出现这些错误。</span></span><br><span class="line"><span class="keyword">-include</span> <span class="variable">$(DEPS)</span></span><br></pre></td></tr></table></figure></div>

<h3 id="多文件目录管理"><a href="#多文件目录管理" class="headerlink" title="多文件目录管理"></a>多文件目录管理</h3><p>在主Makefile中，我们可以这样定义一个递归构建规则：</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">all:</span></span><br><span class="line">    <span class="variable">$(MAKE)</span> -C src</span><br><span class="line">    <span class="variable">$(MAKE)</span> -C lib</span><br></pre></td></tr></table></figure></div>

<p>在上述示例中，<code>$(MAKE) -C src</code>表示调用src目录下的Makefile构建目标；<code>$(MAKE) -C lib</code>表示调用lib目录下的Makefile构建目标。</p>
<p><strong>自动查找子目录</strong></p>
<p>我们可以通过<code>wildcard</code>和<code>foreach</code>来自动查找所有子目录，并自动生成子目录规则。示例如下：</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SUBDIRS := <span class="variable">$(<span class="built_in">wildcard</span> */)</span></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$(<span class="built_in">patsubst</span> %/, %/Makefile, <span class="variable">$(SUBDIRS)</span>)</span></span><br></pre></td></tr></table></figure></div>

<p>在上述示例中，<code>wildcard */</code>会查找所有的子目录；<code>patsubst %/, %/Makefile, $(SUBDIRS)</code>会自动生成所有子目录对应的<code>Makefile</code>路径。</p>
<p><strong>export</strong></p>
<p>我们可以通过 <code>export</code> 导出变量供子目录使用。</p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CC := gcc</span><br><span class="line"><span class="keyword">export</span> CC</span><br></pre></td></tr></table></figure></div>

<p><strong>include</strong></p>
<p>在Makefile使用include关键字可以把别的Makefile包含进来，这很像C语言的<code>#include</code>，被包含的文件会原模原样的放在当前文件的包含位置。 比如命令</p>
<div class="code-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include file.dep</span><br></pre></td></tr></table></figure></div>

<p>即把file.dep文件在当前Makefile文件中展开，亦即把file.dep文件的内容包含进当前Makefile文件</p>
<blockquote>
<p> 在 include前面可以有一些空字符，但是绝不能是[Tab]键开始。</p>
</blockquote>
<h3 id="常用模板"><a href="#常用模板" class="headerlink" title="常用模板"></a>常用模板</h3><p><strong>主Makefile</strong></p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">CC := gcc</span><br><span class="line">INCLUDE_DIR := -I ../<span class="keyword">include</span></span><br><span class="line">OBJ_DIR := $&#123;shell pwd&#125;/obj</span><br><span class="line">BIN_DIR := $&#123;shell pwd&#125;/bin</span><br><span class="line">SUB_DIR := main fun global obj </span><br><span class="line">TARGET := my_exec</span><br><span class="line"></span><br><span class="line"><span class="comment">#导出为全局变量，给其他文件使用</span></span><br><span class="line"><span class="keyword">export</span> CC INCLUDE_DIR BIN_DIR OBJ_DIR SUB_DIR TARGET </span><br><span class="line"></span><br><span class="line"><span class="section">all:<span class="variable">$(SUB_DIR)</span></span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(SUB_DIR)</span> : MK_BIN</span><br><span class="line">        make -C <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">MK_BIN: </span></span><br><span class="line">        mkdir -p <span class="variable">$(BIN_DIR)</span></span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">        rm -rf ./bin ./obj/*.o</span><br><span class="line"></span><br><span class="line"><span class="section">install:</span></span><br><span class="line">        sudo cp  <span class="variable">$(BIN_DIR)</span>/<span class="variable">$(TARGET)</span> /usr/bin</span><br><span class="line"></span><br><span class="line"><span class="section">uninstall:</span></span><br><span class="line">        sudo rm -rf /usr/bin/<span class="variable">$(TARGET)</span></span><br></pre></td></tr></table></figure></div>

<p><strong>fun、global、main文件夹使用同样的Makefile文件</strong></p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取当前目录先的.c文件信息</span></span><br><span class="line">SRC=<span class="variable">$(<span class="built_in">wildcard</span> *.c)</span></span><br><span class="line"><span class="comment">#准备把把当前目录下的.c替换为.o文件</span></span><br><span class="line">OBJ=<span class="variable">$(<span class="built_in">patsubst</span> %c,%o,<span class="variable">$(SRC)</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="section">all:<span class="variable">$(OBJ)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Makfile的静态模式 : </span></span><br><span class="line"><span class="comment"># main.o : main.c </span></span><br><span class="line"><span class="comment">#      gcc -I ../include/ -c $^ -o ^@</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="variable">$(OBJ)</span> : %.o:%.c</span><br><span class="line">        <span class="variable">$(CC)</span> <span class="variable">$(INCLUDE_DIR)</span> -c <span class="variable">$^</span> -o <span class="variable">$(OBJ_DIR)</span>/<span class="variable">$@</span></span><br><span class="line">  </span><br></pre></td></tr></table></figure></div>

<p><strong>obj目录</strong></p>
<div class="code-container" data-rel="Makefile"><figure class="iseeu highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(BIN_DIR)</span>/<span class="variable">$(TARGET)</span> : <span class="variable">$(<span class="built_in">wildcard</span> *.o)</span></span><br><span class="line">        <span class="variable">$(CC)</span> <span class="variable">$(INCLUDE_DIR)</span> <span class="variable">$^</span> -o <span class="variable">$@</span></span><br></pre></td></tr></table></figure></div>

<h2 id="Kbuild-Kconfig"><a href="#Kbuild-Kconfig" class="headerlink" title="Kbuild&#x2F;Kconfig"></a>Kbuild&#x2F;Kconfig</h2><h2 id="CMake"><a href="#CMake" class="headerlink" title="CMake"></a>CMake</h2><p>虽然<code>CMake</code>是基于<code>Makefile</code>的，但是相较于 <code>Makefile</code>，<code>CMake</code>更适用于大型项目，并且更易于维护，构建速度，可读性也比<code>Makefile</code>好很多(虽然<code>CMake</code>也要先生成<code>Makefile</code>, 但在生成前做了很多优化和检查)。<code>Makefile</code>适用于一些中小型项目。</p>
<p>在 <code>linux</code> 平台下使用 <code>CMake</code> 生成 <code>Makefile</code> 并编译的流程如下：</p>
<ol>
<li>写 <code>CMake</code> 配置文件 <code>CMakeLists.txt</code>。</li>
<li>执行命令 <code>cmake PATH</code> 或者 <code>ccmake</code></li>
</ol>
<p><code> PATH</code> 生成 Makefile（<code>ccmake</code> 和 <code>cmake</code> 的区别在于前者提供了一个交互式的界面）。其中， <code>PATH</code> 是 <code>CMakeLists.txt</code> 所在的目录。</p>
<p>也可以使用 <code>make</code> 命令进行编译。</p>
<blockquote>
<p><strong>注意：</strong>虽然 CMake 支持大写、小写和混合大小写的命令，但首选小写命令，本教程将始终使用小写命令。</p>
</blockquote>
<p><strong>参考链接</strong></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://cmake.com.cn/cmake/help/latest/guide/tutorial/A%20Basic%20Starting%20Point.html" >https://cmake.com.cn/cmake/help/latest/guide/tutorial/A%20Basic%20Starting%20Point.html<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<h3 id="单个源文件"><a href="#单个源文件" class="headerlink" title="单个源文件"></a>单个源文件</h3><p>最基本的 CMake 项目是从单个源代码文件构建的可执行文件。对于这样的简单项目，仅需要一个包含三个命令的 <code>CMakeLists.txt</code> 文件。</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the project name</span></span><br><span class="line"><span class="keyword">project</span>(tutorial)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add the executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(tutorial tutorial.cpp)</span><br></pre></td></tr></table></figure></div>

<p>任何项目的顶级 CMakeLists.txt 必须首先使用 <a target="_blank" rel="noopener" href="https://cmake.com.cn/cmake/help/latest/command/cmake_minimum_required.html#command:cmake_minimum_required"><code>cmake_minimum_required()</code></a> 命令指定 CMake 的最低版本。这将建立策略设置并确保以下 CMake 函数与兼容版本的 CMake 一起运行。</p>
<p>要启动项目，我们使用 <a target="_blank" rel="noopener" href="https://cmake.com.cn/cmake/help/latest/command/project.html#command:project"><code>project()</code></a> 命令设置项目名称。此调用对于每个项目都是必需的，并且应在 <a target="_blank" rel="noopener" href="https://cmake.com.cn/cmake/help/latest/command/cmake_minimum_required.html#command:cmake_minimum_required"><code>cmake_minimum_required()</code></a> 之后立即调用。正如我们稍后将看到的那样，此命令还可用于指定其他项目级信息，例如语言或版本号。</p>
<p>最后，<a target="_blank" rel="noopener" href="https://cmake.com.cn/cmake/help/latest/command/add_executable.html#command:add_executable"><code>add_executable()</code></a> 命令告诉 CMake 使用指定的源代码文件创建可执行文件。</p>
<h3 id="构建，编译和运行"><a href="#构建，编译和运行" class="headerlink" title="构建，编译和运行"></a>构建，编译和运行</h3><p>推荐使用外部构建，把生成文件和项目文件分开来构建，内部构建会破坏原有代码结构。</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -----------------------------------------------</span></span><br><span class="line">➜  <span class="built_in">mkdir</span> build</span><br><span class="line">➜  <span class="built_in">cd</span> build</span><br><span class="line"><span class="comment"># 构建系统是需要指定 CMakeLists.txt 所在路径，此时在 build 目录下，所以用 .. 表示 CMakeLists.txt 在上一级目录。</span></span><br><span class="line">➜  cmake ..</span><br><span class="line"><span class="comment"># 此时在 build 目录下会生成 Makefile 文件，然后调用编译器来实际编译和链接项目：</span></span><br><span class="line">➜  cmake --build .</span><br><span class="line"><span class="comment"># --build 指定编译生成的文件存放目录，其中就包括可执行文件，. 表示存放到当前目录，</span></span><br><span class="line"><span class="comment"># 在 build 目录下生成了一个 Tutorial.exe 可执行文件</span></span><br><span class="line"><span class="comment"># -----------------------------------------------</span></span><br><span class="line">➜  process tree</span><br><span class="line">.</span><br><span class="line">├── build</span><br><span class="line">│   ├── CMakeCache.txt</span><br><span class="line">│   ├── CMakeFiles</span><br><span class="line">│   │   ├── 3.31.2</span><br><span class="line">│   │   │   ├── CMakeCCompiler.cmake</span><br><span class="line">│   │   │   ├── CMakeCXXCompiler.cmake</span><br><span class="line">│   │   │   ├── CMakeDetermineCompilerABI_C.bin</span><br><span class="line">│   │   │   ├── CMakeDetermineCompilerABI_CXX.bin</span><br><span class="line">│   │   │   ├── CMakeSystem.cmake</span><br><span class="line">│   │   │   ├── CompilerIdC</span><br><span class="line">│   │   │   │   ├── a.out</span><br><span class="line">│   │   │   │   ├── CMakeCCompilerId.c</span><br><span class="line">│   │   │   │   └── tmp</span><br><span class="line">│   │   │   └── CompilerIdCXX</span><br><span class="line">│   │   │       ├── a.out</span><br><span class="line">│   │   │       ├── CMakeCXXCompilerId.cpp</span><br><span class="line">│   │   │       └── tmp</span><br><span class="line">│   │   ├── cmake.check_cache</span><br><span class="line">│   │   ├── CMakeConfigureLog.yaml</span><br><span class="line">│   │   ├── CMakeDirectoryInformation.cmake</span><br><span class="line">│   │   ├── CMakeScratch</span><br><span class="line">│   │   ├── Makefile2</span><br><span class="line">│   │   ├── Makefile.cmake</span><br><span class="line">│   │   ├── pkgRedirects</span><br><span class="line">│   │   ├── progress.marks</span><br><span class="line">│   │   ├── TargetDirectories.txt</span><br><span class="line">│   │   └── tutorial.dir</span><br><span class="line">│   │       ├── build.make</span><br><span class="line">│   │       ├── cmake_clean.cmake</span><br><span class="line">│   │       ├── compiler_depend.make</span><br><span class="line">│   │       ├── compiler_depend.ts</span><br><span class="line">│   │       ├── DependInfo.cmake</span><br><span class="line">│   │       ├── depend.make</span><br><span class="line">│   │       ├── flags.make</span><br><span class="line">│   │       ├── link.txt</span><br><span class="line">│   │       ├── progress.make</span><br><span class="line">│   │       ├── tutorial.cpp.o</span><br><span class="line">│   │       └── tutorial.cpp.o.d</span><br><span class="line">│   ├── cmake_install.cmake</span><br><span class="line">│   ├── Makefile</span><br><span class="line">│   └── tutorial</span><br><span class="line">├── CMakeLists.txt</span><br><span class="line">└── tutorial.cpp</span><br><span class="line"></span><br><span class="line">10 directories, 33 files</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>Windows 下，CMake 默认使用微软的 MSVC 作为编译器，想使用 MinGW 编译器，可以通过 <code>-G</code> 参数来进行指定，只有第一次构建项目时需要指定。</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake -G <span class="string">&quot;MinGW Makefiles&quot;</span> ..</span><br></pre></td></tr></table></figure></div>
</blockquote>
<h3 id="优化-CMakeLists-txt-文件"><a href="#优化-CMakeLists-txt-文件" class="headerlink" title="优化 CMakeLists.txt 文件"></a>优化 CMakeLists.txt 文件</h3><p><strong>set 与 PROJECT_NAME</strong></p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.15</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the project name</span></span><br><span class="line"><span class="keyword">project</span>(Tutorial)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span>(SRC_LIST tutorial.cpp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add the executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> <span class="variable">$&#123;SRC_LIST&#125;</span>)</span><br></pre></td></tr></table></figure></div>

<p>指定了项目名后，后面可能会有多个地方用到这个项目名，如果更改了这个名字，就要改多个地方，比较麻烦，那么可以使用 <code>PROJECT_NAME</code> 来表示项目名。</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> tutorial.cpp)</span><br></pre></td></tr></table></figure></div>

<p>生成可执行文件需要指定相关的源文件，如果有多个，那么就用空格隔开，比如：</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> a.cpp b.cpp c.cpp)</span><br></pre></td></tr></table></figure></div>

<p>我们也可以用一个变量来表示这多个源文件：</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(SRC_LIST a.cpp b.cpp c.cpp)</span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> <span class="variable">$&#123;SRC_LIST&#125;</span>)</span><br></pre></td></tr></table></figure></div>

<p><code>set</code> 命令指定 SRC_LIST 变量来表示多个源文件，用 <code>$&#123;var_name&#125;</code> 获取变量的值。</p>
<hr>
<p><strong>添加版本号和配置头文件</strong></p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.15</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 project 命令设置项目名称和版本号。</span></span><br><span class="line"><span class="keyword">project</span>(Tutorial VERSION <span class="number">1.0</span>.<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span>(SRC_LIST tutorial.cpp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add the executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> <span class="variable">$&#123;SRC_LIST&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置头文件将版本号传递给源代码</span></span><br><span class="line"><span class="keyword">configure_file</span>(TutorialConfig.h.in TutorialConfig.h)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加自动搜索路径</span></span><br><span class="line"><span class="keyword">target_include_directories</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PUBLIC <span class="variable">$&#123;PROJECT_BINARY_DIR&#125;</span>)</span><br></pre></td></tr></table></figure></div>

<p>由于 <code>TutorialConfig.h</code> 文件这里被设置为自动写入 <code>build</code> 目录，因此需要将该目录添加到搜索头文件的路径列表中，也可以修改为写到其它目录。</p>
<p><code>PROJECT_BINARY_DIR</code> 表示当前工程的二进制路径，即编译产物会存放到该路径，此时<code>PROJECT_BINARY_DIR</code> 就是 build 所在路径。</p>
<p>手动创建 <code>TutorialConfig.h.in</code> 文件，包含以下内容：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// the configured options and settings for Tutorial</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Tutorial_VERSION_MAJOR @PROJECT_VERSION_MAJOR@</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Tutorial_VERSION_MINOR @PROJECT_VERSION_MINOR@</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Tutorial_VERSION_PATCH @PROJECT_VERSION_PATCH@</span></span><br></pre></td></tr></table></figure></div>

<p>当使用 <code>CMake</code> 构建项目后，会在 <code>build</code> 中生成一个  <code>TutorialConfig.h</code> 文件，内容如下：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// the configured options and settings for Tutorial</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Tutorial_VERSION_MAJOR 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Tutorial_VERSION_MINOR 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Tutorial_VERSION_PATCH 2</span></span><br></pre></td></tr></table></figure></div>

<p>下一步在 <code>tutorial.cpp</code> 包含头文件 <code>TutorialConfig.h</code>，最后通过以下代码打印出可执行文件的名称和版本号。</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (argc &lt; <span class="number">2</span>) &#123;</span><br><span class="line">  <span class="comment">// report version</span></span><br><span class="line">  std::cout &lt;&lt; argv[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; Version &quot;</span> &lt;&lt; Tutorial_VERSION_MAJOR &lt;&lt; <span class="string">&quot;.&quot;</span></span><br><span class="line">            &lt;&lt; Tutorial_VERSION_MINOR &lt;&lt; std::endl;</span><br><span class="line">  std::cout &lt;&lt; <span class="string">&quot;Usage: &quot;</span> &lt;&lt; argv[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; number&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><strong>添加编译时间戳</strong></p>
<p>有时候我们需要知道编译时的时间戳，并在程序运行时打印出来。那就需要在 <code>CMakeLists.txt</code> 中添加如下这句：</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">string</span>(TIMESTAMP COMPILE_TIME %Y%m%d-%H%M%S)</span><br></pre></td></tr></table></figure></div>

<p>这表示将时间戳已指定格式保存到 COMPILE_TIME 变量中。</p>
<p>然后修改上面的 <code>TutorialConfig.h.in</code> 文件：</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// the configured options <span class="keyword">and</span> settings for Tutorial</span><br><span class="line"><span class="comment">#define Tutorial_VERSION_MAJOR @PROJECT_VERSION_MAJOR@</span></span><br><span class="line"><span class="comment">#define Tutorial_VERSION_MINOR @PROJECT_VERSION_MINOR@</span></span><br><span class="line"><span class="comment">#define Tutorial_VERSION_PATCH @PROJECT_VERSION_PATCH@</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TIMESTAMP @COMPILE_TIME@</span></span><br></pre></td></tr></table></figure></div>

<p>在构建项目后，<code>TutorialConfig.h</code> 文件就会自动增加一句：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> TIMESTAMP 20230220-203532</span></span><br></pre></td></tr></table></figure></div>

<p>这样就可以在源码中打印出 <code>TIMESTAMP</code> 的值了。</p>
<blockquote>
<p>也可以直接通过 <code>__TIMESTAMP__</code> 变量打印时间戳。</p>
</blockquote>
<p><strong>指定 C&#x2F;C++ 标准</strong></p>
<p>我们可以在CMake代码中设置正确的标志，以启动对特定C&#x2F;C++标准的支持。最简单的是使用<code>CMAKE_CXX_STANDARD</code>变量。</p>
<p><strong>注意：要在<code>add_executable</code>之前，添加对<code>CMAKE_CXX_STANDARD</code>的声明。</strong></p>
<p>脚本中<code>set</code>是将普通变量、缓存变量或者环境变量设置为指定的值。</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#启动对C++14标准的支持</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">14</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显式要求指明支持C++标准</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD_REQUIRED <span class="keyword">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动对C11标准的支持</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_C_STANDARD <span class="number">11</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显式要求指明支持C标准</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_C_STANDARD_REQUIRED <span class="keyword">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置可执行程序</span></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> <span class="variable">$&#123;SRC_LIST&#125;</span>)</span><br></pre></td></tr></table></figure></div>

<h3 id="添加库"><a href="#添加库" class="headerlink" title="添加库"></a>添加库</h3><p>现在我们将向项目中添加一个库，这个库包含计算数字平方根的实现，可执行文件使用这个库，而不是编译器提供的标准平方根函数。</p>
<p>我们把库放在名为 MathFunctions 的子目录中。此目录包含头文件 MathFunctions.h 和源文件 mysqrt.cpp。源文件有一个名为 mysqrt 的函数，它提供了与编译器的 sqrt 函数类似的功能，MathFunctions.h 则是该函数的声明。</p>
<p>在 MathFunctions 目录下创建一个 CMakeLists.txt 文件，并添加以下一行：</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MathFunctions/CMakeLists.txt</span></span><br><span class="line"><span class="keyword">add_library</span>(MathFunctions mysqrt.cpp)</span><br></pre></td></tr></table></figure></div>

<p>表示添加一个叫 <code>MathFunctions</code> 的库文件。</p>
<p>CMake 中的 target 有可执行文件和库文件，分别使用 <code>add_executable</code> 和 <code>add_library</code> 命令生成，除了指定生成的可执行文件名&#x2F;库文件名，还需要指定相关的源文件。</p>
<p>此时文件结构为：</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Demo/</span><br><span class="line">    build/</span><br><span class="line">    MathFunctions/</span><br><span class="line">        CMakeLists.txt</span><br><span class="line">        MathFunctions.h</span><br><span class="line">        mysqrt.cpp</span><br><span class="line">    CMakeLists.txt</span><br><span class="line">    tutorial.cpp</span><br><span class="line">    TutorialConfig.h.in</span><br></pre></td></tr></table></figure></div>

<p>为了使用 <code>MathFunctions</code>  这个库，我们将在顶级 CMakeLists.txt 文件中添加一个 <code>add_subdirectory(MathFunctions)</code> 命令指定库所在子目录，该子目录下应包含 CMakeLists.txt 文件和代码文件。</p>
<p>可执行文件要使用库文件，需要能够找到库文件和对应的头文件，可以分别通过 <code>target_link_libraries</code> 和 <code>target_include_directories</code> 来指定。</p>
<p>使用 <code>target_link_libraries</code> 将新的库文件添加到可执行文件中，使用 <code>target_include_directories</code> 将 MathFunctions 添加为头文件目录，添加到 Tutorial 目标上，以便 mysqrt.h 可以被找到。</p>
<p>顶级 <code>CMakeLists.txt</code> 的最后几行如下所示：</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># add the MathFunctions library</span></span><br><span class="line"><span class="keyword">add_subdirectory</span>(MathFunctions)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add the executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> tutorial.cpp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PUBLIC MathFunctions)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add the binary tree to the search path for include files</span></span><br><span class="line"><span class="comment"># so that we will find TutorialConfig.h</span></span><br><span class="line"><span class="keyword">target_include_directories</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PUBLIC</span><br><span class="line">                           <span class="variable">$&#123;PROJECT_BINARY_DIR&#125;</span></span><br><span class="line">                           <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/MathFunctions</span><br><span class="line">                           )</span><br></pre></td></tr></table></figure></div>

<p><code>MathFunctions</code> 库就算添加完成了，接下来就是在主函数使用该库中的函数，先在 tutorial.cpp 文件中添加头文件：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MathFunctions.h&quot;</span></span></span><br></pre></td></tr></table></figure></div>

<p>然后使用 <code>mysqrt</code> 函数即可：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> outputValue = <span class="built_in">mysqrt</span>(inputValue);</span><br></pre></td></tr></table></figure></div>

<h3 id="将库设置为可选项"><a href="#将库设置为可选项" class="headerlink" title="将库设置为可选项"></a>将库设置为可选项</h3><p>现在将 MathFunctions 库设为可选的，虽然对于本教程来说，没有必要这样做，但对于较大的项目来说，这种情况很常见。</p>
<p>第一步是向顶级 <code>CMakeLists.txt</code> 文件添加一个选项。</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">option</span>(USE_MYMATH <span class="string">&quot;Use tutorial provided math implementation&quot;</span> <span class="keyword">ON</span>)</span><br></pre></td></tr></table></figure></div>

<p><code>option</code> 表示提供用户可以选择的选项。命令格式为：<code>option(&lt;variable&gt; &quot;description [initial value])</code>。</p>
<p><code>USE_MYMATH</code> 这个选项缺省值为 ON，用户可以更改这个值。此设置将存储在缓存中，以便用户不需要在每次构建项目时设置该值。</p>
<p>下一个更改是使 MathFunctions 库的构建和链接成为条件。于是创建一个 if 语句，该语句检查选项 <code>USE_MYMATH</code> 的值。</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(USE_MYMATH)</span><br><span class="line">  <span class="keyword">add_subdirectory</span>(MathFunctions)</span><br><span class="line">  <span class="keyword">list</span>(APPEND EXTRA_LIBS MathFunctions)</span><br><span class="line">  <span class="keyword">list</span>(APPEND EXTRA_INCLUDES <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/MathFunctions)</span><br><span class="line"><span class="keyword">endif</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># add the executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> tutorial.cpp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PUBLIC <span class="variable">$&#123;EXTRA_LIBS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add the binary tree to the search path for include files</span></span><br><span class="line"><span class="comment"># so that we will find TutorialConfig.h</span></span><br><span class="line"><span class="keyword">target_include_directories</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PUBLIC</span><br><span class="line">                           <span class="variable">$&#123;PROJECT_BINARY_DIR&#125;</span></span><br><span class="line">                           <span class="variable">$&#123;EXTRA_INCLUDES&#125;</span></span><br><span class="line">                           )</span><br></pre></td></tr></table></figure></div>

<p>在 if 块中，有 <code>add_subdirectory</code> 命令和 <code>list</code> 命令，<code>APPEND</code>表示将元素<code>MathFunctions</code>追加到列表<code>EXTRA_LIBS</code>中，将元素 <code>$&#123;PROJECT_SOURCE_DIR&#125;/MathFunctions</code> 追加到列表<code>EXTRA_INCLUDES</code>中。<code>EXTRA_LIBS</code> 存储 MathFunctions 库，<code>EXTRA_INCLUDES</code> 存储 MathFunctions 头文件。</p>
<p>变量<code>EXTRA_LIBS</code>用来保存需要链接到可执行程序的可选库，变量<code>EXTRA_INCLUDES</code>用来保存可选的头文件搜索路径。这是处理可选组件的经典方法，我将在下一步介绍现代方法。</p>
<p>接下来对源代码的进行修改。首先，在 tutorial.cpp 中包含 MathFunctions.h 头文件：</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ifdef USE_MYMATH</span></span><br><span class="line">    <span class="comment">#include &quot;MathFunctions.h&quot;</span></span><br><span class="line"><span class="comment">#endif</span></span><br></pre></td></tr></table></figure></div>

<p>然后，还在 tutorial.cpp 中，使用 <code>USE_MYMATH</code> 选择使用哪个平方根函数：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> USE_MYMATH</span></span><br><span class="line">  <span class="type">const</span> <span class="type">double</span> outputValue = <span class="built_in">mysqrt</span>(inputValue);</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">  <span class="type">const</span> <span class="type">double</span> outputValue = <span class="built_in">sqrt</span>(inputValue);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure></div>

<p>因为源代码使用了 <code>USE_MYMATH</code> 宏，可以用下面的行添加到 tutorialconfig.h.in 文档中：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TutorialConfig.h.in</span></span><br><span class="line"><span class="meta">#cmakedefine USE_MYMATH</span></span><br></pre></td></tr></table></figure></div>

<p>现在使用 cmake 命令构建项目，并运行生成的 Tutorial 可执行文件。</p>
<div class="code-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">build&gt; cmake -G&quot;MinGW Makefiles&quot; ..</span><br><span class="line">build&gt; cmake --build .</span><br><span class="line">build&gt; Tutorial.exe 8</span><br><span class="line">Computing sqrt of 8 to be 4.5</span><br><span class="line">Computing sqrt of 8 to be 3.13889</span><br><span class="line">Computing sqrt of 8 to be 2.84378</span><br><span class="line">Computing sqrt of 8 to be 2.82847</span><br><span class="line">Computing sqrt of 8 to be 2.82843</span><br><span class="line">Computing sqrt of 8 to be 2.82843</span><br><span class="line">Computing sqrt of 8 to be 2.82843</span><br><span class="line">Computing sqrt of 8 to be 2.82843</span><br><span class="line">Computing sqrt of 8 to be 2.82843</span><br><span class="line">Computing sqrt of 8 to be 2.82843</span><br><span class="line">The square root of 8 is 2.82843</span><br></pre></td></tr></table></figure></div>

<p>默认调用 <code>mysqrt</code> 函数，也可以在构建项目时指定 <code>USE_MYMATH</code> 的值为 OFF：</p>
<div class="code-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; cmake -DUSE_MYMATH=OFF ..</span><br><span class="line">&gt; cmake --build .</span><br></pre></td></tr></table></figure></div>

<p>此时会调用自带的 <code>sqrt</code> 函数。</p>
<h3 id="添加库的使用要求"><a href="#添加库的使用要求" class="headerlink" title="添加库的使用要求"></a>添加库的使用要求</h3><p>使用要求会对库或可执行程序的链接、头文件包含命令行提供了更好的控制，也使 CMake 中目标的传递目标属性更加可控。利用使用要求的主要命令是：</p>
<ul>
<li><code>target_compile_definitions()</code></li>
<li><code>target_compile_options()</code></li>
<li><code>target_include_directories()</code></li>
<li><code>target_link_libraries()</code></li>
</ul>
<p>现在重构一下之前中的代码，使用更加现代的 CMake 方法来包含 MathFunctions 库的头文件。</p>
<p>首先声明，链接 MathFunctions 库的任何可执行文件&#x2F;库文件都需要包含 MathFunctions 目录作为头文件路径，而 MathFunctions 本身不需要包含，这被称为 <code>INTERFACE</code> 使用要求。</p>
<p><code>INTERFACE</code>是指消费者需要、但生产者不需要的那些东西。在<code>MathFunctions/CMakeLists.txt</code> 最后添加：</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MathFunctions/CMakeLists.txt</span></span><br><span class="line"><span class="keyword">target_include_directories</span>(MathFunctions</span><br><span class="line">          INTERFACE <span class="variable">$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;</span></span><br><span class="line">          )</span><br></pre></td></tr></table></figure></div>

<p><code>CMAKE_CURRENT_SOURCE_DIR</code> 表示 MathFunctions 库所在目录。</p>
<p>现在我们已经为 <code>MathFunctions</code> 指定了使用要求 <code>INTERFACE</code>，那么可以从顶级 <code>CMakeLists.txt</code> 中删除<code>EXTRA_INCLUDES</code>变量的相关使用：</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(USE_MYMATH)</span><br><span class="line">  <span class="keyword">add_subdirectory</span>(MathFunctions)</span><br><span class="line">  <span class="keyword">list</span>(APPEND EXTRA_LIBS MathFunctions)</span><br><span class="line">  <span class="keyword">list</span>(APPEND EXTRA_INCLUDES <span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/MathFunctions)   <span class="comment"># 删除此行</span></span><br><span class="line"><span class="keyword">endif</span>()</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># add the binary tree to the search path for include files</span></span><br><span class="line"><span class="comment"># so that we will find TutorialConfig.h</span></span><br><span class="line"><span class="keyword">target_include_directories</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PUBLIC</span><br><span class="line">                           <span class="variable">$&#123;PROJECT_BINARY_DIR&#125;</span></span><br><span class="line">                           <span class="variable">$&#123;EXTRA_INCLUDES&#125;</span>   <span class="comment"># 删除此行</span></span><br><span class="line">                           )</span><br></pre></td></tr></table></figure></div>

<p>现在只要是链接了 MathFunctions 库，就会自动包含 MathFunctions 所在目录的头文件，简洁而优雅。</p>
<p>这里补充两个知识点：</p>
<p>1、使用要求除了 <code>INTERFACE</code>，还有<code>PRIVATE</code> 和 <code>PUBLIC</code>。<code>INTERFACE</code>表示消费者需要生产者不需要，<code>PRIVATE</code>表示消费者不需要生产者需要，<code>PUBLIC</code> 表示消费者和生产者都需要。</p>
<p>2、这里使用 <code>add_library</code> 命令生成的 MathFunctions 库其实是静态链接库。</p>
<h3 id="build-目录介绍"><a href="#build-目录介绍" class="headerlink" title="build 目录介绍"></a>build 目录介绍</h3><p>在文本中，我都是创建了一个 build 用来存放 cmake 构建和编译的产物，这里简单说下里面有些什么东西。</p>
<div class="code-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">build/</span><br><span class="line">    CMakeCache.txt</span><br><span class="line">    CMakeFiles/</span><br><span class="line">    cmake_install.cmake</span><br><span class="line">    Makefile</span><br><span class="line">    Tutorial.exe</span><br><span class="line">    TutorialConfig.h</span><br><span class="line">    MathFunctions/</span><br></pre></td></tr></table></figure></div>

<p>其中 <code>Makefile</code> 是 cmake 根据顶级 CMakeLists.txt 生成的构建文件，通过该文件可以对整个项目进行编译。</p>
<p><code>Tutorial.exe</code> 就是生成的可执行文件，通过该文件运行程序。</p>
<p><code>TutorialConfig.h</code> 是用于配置信息的头文件，是 cmake 根据 <code>TutorialConfig.h.in</code> 文件自动生成的。</p>
<p>还有个 MathFunctions 文件夹：</p>
<div class="code-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MathFunctions/</span><br><span class="line">    CMakeFiles/</span><br><span class="line">    cmake_install.cmake</span><br><span class="line">    Makefile</span><br><span class="line">    libMathFunctions.a</span><br></pre></td></tr></table></figure></div>

<p>其中 <code>Makefile</code> 是 cmake 根据 MathFunctions 目录下的 CMakeLists.txt 生成的构建文件。</p>
<p><code>libMathFunctions.a</code> 则是 MathFunctions 静态链接库，可执行文件会通过这个库调用 <code>mysqrt</code> 函数。</p>
<h3 id="安装和测试"><a href="#安装和测试" class="headerlink" title="安装和测试"></a>安装和测试</h3><p>CMake 也可以指定安装规则，以及添加测试。这两个功能分别可以通过在产生 Makefile 后使用 <code>make install</code> 和 <code>make test</code> 来执行。在以前的 GNU Makefile 里，你可能需要为此编写 <code>install</code> 和 <code>test</code> 两个伪目标和相应的规则，但在 CMake 里，这样的工作同样只需要简单的调用几条命令。</p>
<h3 id="定制安装规则"><a href="#定制安装规则" class="headerlink" title="定制安装规则"></a><strong>定制安装规则</strong></h3><p>首先先在 math&#x2F;CMakeLists.txt 文件里添加下面两行：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 指定 MathFunctions 库的安装路径</span><br><span class="line"><span class="built_in">install</span> (TARGETS MathFunctions DESTINATION bin)</span><br><span class="line"><span class="built_in">install</span> (FILES MathFunctions.h DESTINATION include)</span><br></pre></td></tr></table></figure></div>

<p>指明 MathFunctions 库的安装路径。之后同样修改根目录的 CMakeLists 文件，在末尾添加下面几行：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 指定安装路径</span><br><span class="line"><span class="built_in">install</span> (TARGETS Demo DESTINATION bin)</span><br><span class="line"><span class="built_in">install</span> (FILES <span class="string">&quot;$&#123;PROJECT_BINARY_DIR&#125;/config.h&quot;</span></span><br><span class="line">         DESTINATION include)</span><br></pre></td></tr></table></figure></div>

<p>通过上面的定制，生成的 Demo 文件和 MathFunctions 函数库 libMathFunctions.o 文件将会被复制到 <code>/usr/local/bin</code> 中，而 MathFunctions.h 和生成的 config.h 文件则会被复制到 <code>/usr/local/include</code> 中。我们可以验证一下（顺带一提的是，这里的 <code>/usr/local/</code> 是默认安装到的根目录，可以通过修改 <code>CMAKE_INSTALL_PREFIX</code> 变量的值来指定这些文件应该拷贝到哪个根目录）：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[ehome@xman Demo5]$ sudo make install</span><br><span class="line">[ <span class="number">50</span>%] Built target MathFunctions</span><br><span class="line">[<span class="number">100</span>%] Built target Demo</span><br><span class="line">Install the project...</span><br><span class="line">-- Install configuration: <span class="string">&quot;&quot;</span></span><br><span class="line">-- Installing: /usr/local/bin/Demo</span><br><span class="line">-- Installing: /usr/local/include/config.h</span><br><span class="line">-- Installing: /usr/local/bin/libMathFunctions.a</span><br><span class="line">-- Up-to-date: /usr/local/include/MathFunctions.h</span><br><span class="line">[ehome@xman Demo5]$ ls /usr/local/bin</span><br><span class="line">Demo  libMathFunctions.a</span><br><span class="line">[ehome@xman Demo5]$ ls /usr/local/include</span><br><span class="line">config.h  MathFunctions.h</span><br></pre></td></tr></table></figure></div>

<h3 id="为工程添加测试"><a href="#为工程添加测试" class="headerlink" title="为工程添加测试"></a><strong>为工程添加测试</strong></h3><p>添加测试同样很简单。CMake 提供了一个称为 CTest 的测试工具。我们要做的只是在项目根目录的 CMakeLists 文件中调用一系列的 <code>add_test</code> 命令。</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启用测试</span></span><br><span class="line"><span class="keyword">enable_testing</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试程序是否成功运行</span></span><br><span class="line"><span class="keyword">add_test</span> (test_run Demo <span class="number">5</span> <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试帮助信息是否可以正常提示</span></span><br><span class="line"><span class="keyword">add_test</span> (test_usage Demo)</span><br><span class="line"><span class="keyword">set_tests_properties</span> (test_usage</span><br><span class="line">  PROPERTIES PASS_REGULAR_EXPRESSION <span class="string">&quot;Usage: .* base exponent&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试 5 的平方</span></span><br><span class="line"><span class="keyword">add_test</span> (test_5_2 Demo <span class="number">5</span> <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set_tests_properties</span> (test_5_2</span><br><span class="line"> PROPERTIES PASS_REGULAR_EXPRESSION <span class="string">&quot;is 25&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试 10 的 5 次方</span></span><br><span class="line"><span class="keyword">add_test</span> (test_10_5 Demo <span class="number">10</span> <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set_tests_properties</span> (test_10_5</span><br><span class="line"> PROPERTIES PASS_REGULAR_EXPRESSION <span class="string">&quot;is 100000&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试 2 的 10 次方</span></span><br><span class="line"><span class="keyword">add_test</span> (test_2_10 Demo <span class="number">2</span> <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set_tests_properties</span> (test_2_10</span><br><span class="line"> PROPERTIES PASS_REGULAR_EXPRESSION <span class="string">&quot;is 1024&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<p>上面的代码包含了四个测试。第一个测试 <code>test_run</code> 用来测试程序是否成功运行并返回 0 值。剩下的三个测试分别用来测试 5 的 平方、10 的 5 次方、2 的 10 次方是否都能得到正确的结果。其中 <code>PASS_REGULAR_EXPRESSION</code> 用来测试输出是否包含后面跟着的字符串。让我们看看测试的结果：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[ehome@xman Demo5]$ make test</span><br><span class="line">Running tests...</span><br><span class="line">Test project /home/ehome/Documents/programming/C/power/Demo5</span><br><span class="line">    Start <span class="number">1</span>: test_run</span><br><span class="line"><span class="number">1</span>/<span class="number">4</span> Test #<span class="number">1</span>: test_run .........................   Passed    <span class="number">0.00</span> sec</span><br><span class="line">    Start <span class="number">2</span>: test_5_2</span><br><span class="line"><span class="number">2</span>/<span class="number">4</span> Test #<span class="number">2</span>: test_5_2 .........................   Passed    <span class="number">0.00</span> sec</span><br><span class="line">    Start <span class="number">3</span>: test_10_5</span><br><span class="line"><span class="number">3</span>/<span class="number">4</span> Test #<span class="number">3</span>: test_10_5 ........................   Passed    <span class="number">0.00</span> sec</span><br><span class="line">    Start <span class="number">4</span>: test_2_10</span><br><span class="line"><span class="number">4</span>/<span class="number">4</span> Test #<span class="number">4</span>: test_2_10 ........................   Passed    <span class="number">0.00</span> sec</span><br><span class="line"></span><br><span class="line"><span class="number">100</span>% tests passed, <span class="number">0</span> tests failed out of <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="function">Total Test <span class="title">time</span> <span class="params">(real)</span> </span>=   <span class="number">0.01</span> sec</span><br></pre></td></tr></table></figure></div>

<p>如果要测试更多的输入数据，像上面那样一个个写测试用例未免太繁琐。这时可以通过编写宏来实现：</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义一个宏，用来简化测试工作</span></span><br><span class="line"><span class="keyword">macro</span> (do_test arg1 arg2 result)</span><br><span class="line">  <span class="keyword">add_test</span> (test_<span class="variable">$&#123;arg1&#125;</span>_<span class="variable">$&#123;arg2&#125;</span> Demo <span class="variable">$&#123;arg1&#125;</span> <span class="variable">$&#123;arg2&#125;</span>)</span><br><span class="line">  <span class="keyword">set_tests_properties</span> (test_<span class="variable">$&#123;arg1&#125;</span>_<span class="variable">$&#123;arg2&#125;</span></span><br><span class="line">    PROPERTIES PASS_REGULAR_EXPRESSION <span class="variable">$&#123;result&#125;</span>)</span><br><span class="line"><span class="keyword">endmacro</span> (do_test)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 使用该宏进行一系列的数据测试</span></span><br><span class="line">do_test (<span class="number">5</span> <span class="number">2</span> <span class="string">&quot;is 25&quot;</span>)</span><br><span class="line">do_test (<span class="number">10</span> <span class="number">5</span> <span class="string">&quot;is 100000&quot;</span>)</span><br><span class="line">do_test (<span class="number">2</span> <span class="number">10</span> <span class="string">&quot;is 1024&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<p>关于 CTest 的更详细的用法可以通过 <code>man 1 ctest</code> 参考 CTest 的文档。</p>
<h3 id="生成安装包"><a href="#生成安装包" class="headerlink" title="生成安装包"></a>生成安装包</h3><p>本节将学习如何配置生成各种平台上的安装包，包括二进制安装包和源码安装包。为了完成这个任务，我们需要用到 CPack ，它同样也是由 CMake 提供的一个工具，专门用于打包。首先在顶层的 CMakeLists.txt 文件尾部添加下面几行：</p>
<div class="code-container" data-rel="Cmake"><figure class="iseeu highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 构建一个 CPack 安装包</span></span><br><span class="line"><span class="keyword">include</span> (InstallRequiredSystemLibraries)</span><br><span class="line"><span class="keyword">set</span> (CPACK_RESOURCE_FILE_LICENSE</span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;/License.txt&quot;</span>)</span><br><span class="line"><span class="keyword">set</span> (CPACK_PACKAGE_VERSION_MAJOR <span class="string">&quot;$&#123;Demo_VERSION_MAJOR&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">set</span> (CPACK_PACKAGE_VERSION_MINOR <span class="string">&quot;$&#123;Demo_VERSION_MINOR&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">include</span> (CPack)</span><br></pre></td></tr></table></figure></div>

<p>上面的代码做了以下几个工作：</p>
<ol>
<li>导入 InstallRequiredSystemLibraries 模块，以便之后导入 CPack 模块；</li>
<li>设置一些 CPack 相关变量，包括版权信息和版本信息，其中版本信息用了上一节定义的版本号；</li>
<li>导入 CPack 模块。</li>
</ol>
<p>接下来的工作是像往常一样构建工程，并执行 <code>cpack</code> 命令。</p>
<ul>
<li>生成二进制安装包：</li>
</ul>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpack -C CPackConfig.cmake</span><br></pre></td></tr></table></figure></div>

<ul>
<li>生成源码安装包</li>
</ul>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpack -C CPackSourceConfig.cmake</span><br></pre></td></tr></table></figure></div>

<p>我们可以试一下。在生成项目后，执行 <code>cpack -C CPackConfig.cmake</code> 命令：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[ehome@xman Demo8]$ cpack -C CPackSourceConfig.cmake</span><br><span class="line">CPack: Create package <span class="keyword">using</span> STGZ</span><br><span class="line">CPack: Install projects</span><br><span class="line">CPack: - Run preinstall target <span class="keyword">for</span>: Demo8</span><br><span class="line">CPack: - Install project: Demo8</span><br><span class="line">CPack: Create package</span><br><span class="line">CPack: - package: /home/ehome/Documents/programming/C/power/Demo8/Demo8<span class="number">-1.0</span><span class="number">.1</span>-Linux.sh generated.</span><br><span class="line">CPack: Create package <span class="keyword">using</span> TGZ</span><br><span class="line">CPack: Install projects</span><br><span class="line">CPack: - Run preinstall target <span class="keyword">for</span>: Demo8</span><br><span class="line">CPack: - Install project: Demo8</span><br><span class="line">CPack: Create package</span><br><span class="line">CPack: - package: /home/ehome/Documents/programming/C/power/Demo8/Demo8<span class="number">-1.0</span><span class="number">.1</span>-Linux.tar.gz generated.</span><br><span class="line">CPack: Create package <span class="keyword">using</span> TZ</span><br><span class="line">CPack: Install projects</span><br><span class="line">CPack: - Run preinstall target <span class="keyword">for</span>: Demo8</span><br><span class="line">CPack: - Install project: Demo8</span><br><span class="line">CPack: Create package</span><br><span class="line">CPack: - package: /home/ehome/Documents/programming/C/power/Demo8/Demo8<span class="number">-1.0</span><span class="number">.1</span>-Linux.tar.Z generated.</span><br></pre></td></tr></table></figure></div>

<p>此时会在该目录下创建 3 个不同格式的二进制包文件：</p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ehome@xman Demo8]$ ls Demo8-*</span><br><span class="line">Demo8<span class="number">-1.0</span><span class="number">.1</span>-Linux.sh  Demo8<span class="number">-1.0</span><span class="number">.1</span>-Linux.tar.gz  Demo8<span class="number">-1.0</span><span class="number">.1</span>-Linux.tar.Z</span><br></pre></td></tr></table></figure></div>

<p>这 3 个二进制包文件所包含的内容是完全相同的。我们可以执行其中一个。此时会出现一个由 CPack 自动生成的交互式安装界面：</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[ehome@xman Demo8]$ sh Demo8-1.0.1-Linux.sh </span><br><span class="line">Demo8 Installer Version: 1.0.1, Copyright (c) Humanity</span><br><span class="line">This is a self-extracting archive.</span><br><span class="line">The archive will be extracted to: /home/ehome/Documents/programming/C/power/Demo8</span><br><span class="line"></span><br><span class="line">If you want to stop extracting, please press &lt;ctrl-C&gt;.</span><br><span class="line">The MIT License (MIT)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2013 Joseph Pan(http://hahack.com)</span><br><span class="line"></span><br><span class="line">Permission is hereby granted, free of charge, to any person obtaining a copy of</span><br><span class="line">this software and associated documentation files (the <span class="string">&quot;Software&quot;</span>), to deal <span class="keyword">in</span></span><br><span class="line">the Software without restriction, including without limitation the rights to</span><br><span class="line">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of</span><br><span class="line">the Software, and to permit persons to whom the Software is furnished to <span class="keyword">do</span> so,</span><br><span class="line">subject to the following conditions:</span><br><span class="line"></span><br><span class="line">The above copyright notice and this permission notice shall be included <span class="keyword">in</span> all</span><br><span class="line">copies or substantial portions of the Software.</span><br><span class="line"></span><br><span class="line">THE SOFTWARE IS PROVIDED <span class="string">&quot;AS IS&quot;</span>, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span><br><span class="line">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS</span><br><span class="line">FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR</span><br><span class="line">COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER</span><br><span class="line">IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN</span><br><span class="line">CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Do you accept the license? [yN]: </span><br><span class="line">y</span><br><span class="line">By default the Demo8 will be installed <span class="keyword">in</span>:</span><br><span class="line">  <span class="string">&quot;/home/ehome/Documents/programming/C/power/Demo8/Demo8-1.0.1-Linux&quot;</span></span><br><span class="line">Do you want to include the subdirectory Demo8-1.0.1-Linux?</span><br><span class="line">Saying no will install <span class="keyword">in</span>: <span class="string">&quot;/home/ehome/Documents/programming/C/power/Demo8&quot;</span> [Yn]: </span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">Using target directory: /home/ehome/Documents/programming/C/power/Demo8/Demo8-1.0.1-Linux</span><br><span class="line">Extracting, please <span class="built_in">wait</span>...</span><br><span class="line"></span><br><span class="line">Unpacking finished successfully</span><br></pre></td></tr></table></figure></div>

<p>完成后提示安装到了 Demo8-1.0.1-Linux 子目录中，我们可以进去执行该程序：</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[ehome@xman Demo8]$ ./Demo8-1.0.1-Linux/bin/Demo 5 2</span><br><span class="line">Now we use our own Math library. </span><br><span class="line">5 ^ 2 is 25</span><br></pre></td></tr></table></figure></div>

<p>关于 CPack 的更详细的用法可以通过 <code>man 1 cpack</code> 参考 CPack 的文档。</p>
<h1 id="版本控制工具"><a href="#版本控制工具" class="headerlink" title="版本控制工具"></a>版本控制工具</h1><h2 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h2><p><a class="link"   target="_blank" rel="noopener" href="https://selierlin.github.io/git-recipes/#/" >参考链接-1<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> <a class="link"   target="_blank" rel="noopener" href="https://liaoxuefeng.com/books/git/introduction/index.html" >参考链接-2<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>Git是一个分布式版本控制系统，广泛用于软件开发中以跟踪和管理代码的变更。以下是一个基本的Git教程，帮助你入门Git的使用。</p>
<h3 id="安装Git"><a href="#安装Git" class="headerlink" title="安装Git"></a>安装Git</h3><ol>
<li><strong>Windows</strong>: 可以从<a class="link"   target="_blank" rel="noopener" href="https://git-scm.com/" >Git官网<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>下载Git Bash。</li>
<li><strong>macOS</strong>: 使用Homebrew安装：<code>brew install git</code></li>
<li><strong>Linux</strong>: 使用包管理器安装，例如在Ubuntu上：<code>sudo apt-get install git</code></li>
</ol>
<h3 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h3><p>安装完成后，进行一些基本配置：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;Your Name&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;you@example.com&quot;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h3><ol>
<li><p><strong>初始化一个新的Git仓库</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>克隆一个现有的仓库</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> &lt;repository-url&gt;</span><br></pre></td></tr></table></figure></div></li>
</ol>
<h3 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h3><ol>
<li><p><strong>查看状态</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>添加文件到暂存区</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add &lt;file1&gt; &lt;file2&gt;</span><br></pre></td></tr></table></figure></div>

<p>或者添加所有更改：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>提交更改</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">&quot;Commit message&quot;</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>查看提交历史</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span></span><br></pre></td></tr></table></figure></div></li>
</ol>
<h3 id="分支管理"><a href="#分支管理" class="headerlink" title="分支管理"></a>分支管理</h3><ol>
<li><p><strong>查看分支</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>创建新分支</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch &lt;new-branch-name&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>切换分支</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout &lt;branch-name&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>创建并切换到新分支</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b &lt;new-branch-name&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>合并分支</strong>:</p>
<p>切换到目标分支（如<code>main</code>），然后合并：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout main</span><br><span class="line">git merge &lt;branch-name&gt;</span><br></pre></td></tr></table></figure></div></li>
</ol>
<h3 id="远程操作"><a href="#远程操作" class="headerlink" title="远程操作"></a>远程操作</h3><ol>
<li><p><strong>查看远程仓库</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote -v</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>添加远程仓库</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin &lt;repository-url&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>推送到远程仓库</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin &lt;branch-name&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>拉取远程更改</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin &lt;branch-name&gt;</span><br></pre></td></tr></table></figure></div></li>
</ol>
<h3 id="撤销更改"><a href="#撤销更改" class="headerlink" title="撤销更改"></a>撤销更改</h3><ol>
<li><p><strong>撤销工作区中的更改</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -- &lt;file&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>撤销已暂存的更改</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset HEAD &lt;file&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>回滚到之前的提交</strong>:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard &lt;commit-id&gt;</span><br></pre></td></tr></table></figure></div></li>
</ol>
<h3 id="高级功能"><a href="#高级功能" class="headerlink" title="高级功能"></a>高级功能</h3><ul>
<li><strong>分支管理和协作</strong>: 了解如何在团队中使用分支进行协作。</li>
<li><strong>Git标签</strong>: 用于标记重要的提交，如发布版本。</li>
<li><strong>Git Rebase</strong>: 用于整理提交历史，保持提交历史的整洁。</li>
</ul>
<h3 id="学习资源"><a href="#学习资源" class="headerlink" title="学习资源"></a>学习资源</h3><ul>
<li><strong>Pro Git</strong>: 一本免费的电子书，详细介绍了Git的所有功能。</li>
<li><strong>Git官方文档</strong>: 提供了Git命令的详细解释和使用示例。</li>
<li><strong>在线教程</strong>: 如GitHub提供的<a class="link"   target="_blank" rel="noopener" href="https://guides.github.com/introduction/git-handbook/" >Git学习路径<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>。</li>
</ul>
<p>通过学习和实践这些基本操作，你将能够有效地使用Git来管理你的项目代码。随着经验的积累，可以探索更多高级功能，如Git Hooks、Submodules、Rebasing等。</p>
<h2 id="Repo"><a href="#Repo" class="headerlink" title="Repo"></a>Repo</h2>
		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> Shell编程与工程管理</li>
        <li><strong>Author:</strong> 韩乔落</li>
        <li><strong>Created at
                :</strong> 2025-02-01 15:11:31</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2025-03-27 16:53:44
            </li>
        
        <li>
            <strong>Link:</strong> https://jelasin.github.io/2025/02/01/Shell编程与工程管理/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

		</div>
		

		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2025/02/06/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">计算机网络</span>
						<span class="post-nav-item">Prev posts</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2025/01/23/BPF%E5%AD%A6%E4%B9%A0/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">BPF学习</span>
						<span class="post-nav-item">Next posts</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
		<div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
			<div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        Comments
    </div>
    

        
            
    <div id="giscus-container"></div>
    <script data-swup-reload-script defer>
        async function loadGiscus() {
            const giscusConfig = {
                'src': 'https://giscus.app/client.js',
                'data-repo': 'jelasin/jelasin.github.io',
                'data-repo-id': 'R_kgDOKVydDA',
                'data-category': 'Announcements',
                'data-category-id': 'DIC_kwDOKVydDM4CZe2W',
                'data-mapping': 'pathname',
                'data-strict': '0',
                'data-reactions-enabled': '1',
                'data-emit-metadata': '1',
                'data-theme': 'preferred_color_scheme',
                'data-lang': 'zh-CN',
                'data-input-position': 'bottom',
                'data-loading': 'not-lazy',
                'crossorigin': 'anonymous',
                'async': true
            }
            const giscusScript = document.createElement('script');
            for (const key in giscusConfig) {
                giscusScript.setAttribute(key, giscusConfig[key]);
            }
            document.getElementById('giscus-container').appendChild(giscusScript);
        }
        if ('true') {
            let loadGiscusTimeout = setTimeout(() => {
                loadGiscus();
                clearTimeout(loadGiscusTimeout);
            }, 1000);
        } else {
            document.addEventListener('DOMContentLoaded', loadGiscus);
        }
    </script>


        
        
    
</div>

		</div>
		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">On this page</div>
		<div class="page-title">Shell编程与工程管理</div>
		<ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Linux-shell-%E7%BC%96%E7%A8%8B"><span class="nav-text">Linux shell 编程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86"><span class="nav-text">基本知识</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89"><span class="nav-text">变量定义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E8%AF%AD%E5%8F%A5"><span class="nav-text">功能语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#echo"><span class="nav-text">echo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#print-printf"><span class="nav-text">print&#x2F;printf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#read"><span class="nav-text">read</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#test"><span class="nav-text">test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#expr"><span class="nav-text">expr</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sed"><span class="nav-text">sed</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#awk"><span class="nav-text">awk</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-O-%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-text">I&#x2F;O 重定向</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5"><span class="nav-text">控制语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#if"><span class="nav-text">if</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#while"><span class="nav-text">while</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#for"><span class="nav-text">for</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#case"><span class="nav-text">case</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#until"><span class="nav-text">until</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#select"><span class="nav-text">select</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="nav-text">定义函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E7%A4%BA%E4%BE%8B"><span class="nav-text">函数示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="nav-text">函数参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-text">返回值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E5%8F%98%E9%87%8F%E4%B8%8E%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="nav-text">本地变量与全局变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E8%B0%83%E7%94%A8"><span class="nav-text">函数的调用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-text">函数的作用域</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%92%E5%BD%92%E5%87%BD%E6%95%B0"><span class="nav-text">递归函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E6%96%87%E6%A1%A3%E5%92%8C%E5%B8%AE%E5%8A%A9"><span class="nav-text">函数的文档和帮助</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#shell-%E6%89%A9%E5%B1%95"><span class="nav-text">shell 扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#shell-%E4%B8%AD%E5%90%84%E7%A7%8D%E6%8B%AC%E5%8F%B7"><span class="nav-text">shell 中各种括号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="nav-text">文件包含</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7"><span class="nav-text">项目构建工具</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Makefile"><span class="nav-text">Makefile</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%84%E5%88%99"><span class="nav-text">规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%AA%E7%9B%AE%E6%A0%87"><span class="nav-text">伪目标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E5%92%8C%E6%89%A7%E8%A1%8C"><span class="nav-text">命令和执行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E6%A0%87"><span class="nav-text">目标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E5%8F%98%E9%87%8F%E5%92%8C%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="nav-text">自动变量和通配符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E5%AE%83%E8%A7%84%E5%88%99"><span class="nav-text">其它规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8F"><span class="nav-text">变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6"><span class="nav-text">条件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0-1"><span class="nav-text">函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E7%89%B9%E6%80%A7"><span class="nav-text">其他特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E7%AE%A1%E7%90%86"><span class="nav-text">多文件目录管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E6%A8%A1%E6%9D%BF"><span class="nav-text">常用模板</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Kbuild-Kconfig"><span class="nav-text">Kbuild&#x2F;Kconfig</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CMake"><span class="nav-text">CMake</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E4%B8%AA%E6%BA%90%E6%96%87%E4%BB%B6"><span class="nav-text">单个源文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%EF%BC%8C%E7%BC%96%E8%AF%91%E5%92%8C%E8%BF%90%E8%A1%8C"><span class="nav-text">构建，编译和运行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%8C%96-CMakeLists-txt-%E6%96%87%E4%BB%B6"><span class="nav-text">优化 CMakeLists.txt 文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E5%BA%93"><span class="nav-text">添加库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%86%E5%BA%93%E8%AE%BE%E7%BD%AE%E4%B8%BA%E5%8F%AF%E9%80%89%E9%A1%B9"><span class="nav-text">将库设置为可选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8%E8%A6%81%E6%B1%82"><span class="nav-text">添加库的使用要求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#build-%E7%9B%AE%E5%BD%95%E4%BB%8B%E7%BB%8D"><span class="nav-text">build 目录介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E5%92%8C%E6%B5%8B%E8%AF%95"><span class="nav-text">安装和测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E5%88%B6%E5%AE%89%E8%A3%85%E8%A7%84%E5%88%99"><span class="nav-text">定制安装规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E5%B7%A5%E7%A8%8B%E6%B7%BB%E5%8A%A0%E6%B5%8B%E8%AF%95"><span class="nav-text">为工程添加测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%AE%89%E8%A3%85%E5%8C%85"><span class="nav-text">生成安装包</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%B7%A5%E5%85%B7"><span class="nav-text">版本控制工具</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Git"><span class="nav-text">Git</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Git"><span class="nav-text">安装Git</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE"><span class="nav-text">基本配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E4%BB%93%E5%BA%93"><span class="nav-text">创建仓库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-text">基本操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86"><span class="nav-text">分支管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9C%E7%A8%8B%E6%93%8D%E4%BD%9C"><span class="nav-text">远程操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%92%A4%E9%94%80%E6%9B%B4%E6%94%B9"><span class="nav-text">撤销更改</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E5%8A%9F%E8%83%BD"><span class="nav-text">高级功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90"><span class="nav-text">学习资源</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Repo"><span class="nav-text">Repo</span></a></li></ol></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
            <div class="customize-info my-1">关山初度尘未洗，策马扬鞭再奋蹄。</div>
        
        <div class="text-center">
            &copy;
            
              <span>2023</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-circle-info fa-beat-fade" style="--fa-beat-fade-opacity: 0.67; --fa-beat-fade-scale: 1.075;" ></i>&nbsp;&nbsp;<a href="/">韩乔落</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        138 posts in total
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
		<li class="go-comment">
			<i class="fa-regular fa-comments"></i>
		</li>
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>


<script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/Swup.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupSlideTheme.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupScriptsPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupProgressPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupScrollPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupPreloadPlugin.min.js" ></script>
<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	<script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/imageViewer.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/utils.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/main.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/navbarShrink.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/scrollTopBottom.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/lightDarkSwitch.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/categoryList.js" ></script>


    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/localSearch.js" ></script>



    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/codeBlock.js" ></script>



    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/lazyload.js" ></script>



    <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/runtime.js" ></script>
    <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/odometer.min.js" ></script>
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/assets/odometer-theme-minimal.css">



  <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/Typed.min.js" ></script>
  <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/plugins/typed.js" ></script>







    <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/anime.min.js" ></script>




    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/tocToggle.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/toc.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/plugins/tabs.js" data-swup-reload-script></script>


<script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/moment-with-locales.min.js" data-swup-reload-script></script>
<script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/essays.js" data-swup-reload-script></script>




	
</body>

</html>