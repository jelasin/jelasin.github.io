<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="韩乔落">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
        
        
        
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://jelasin.github.io/2023/10/25/车联网安全专题/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="前言后面想开源一个智能汽车安全的学习项目，用 Qt 整车模拟(这个有点难)或者汽车零部件模拟(大概率做这个)，即使需要用到硬件也不会非常贵，以便降低车联网安全学习门槛，帮助后来者学习。本篇讲一些入门知识，了解一下车联网安全的整体架构。本文带大家整体入门车联网安全，后续每个分支会做详细的研究。 基础篇网联汽车联网的车(Connected Car):又称网联汽车，即这些车具有网络连接功能，通常还具有W">
<meta property="og:type" content="article">
<meta property="og:title" content="车联网安全专题">
<meta property="og:url" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/index.html">
<meta property="og:site_name" content="Jelasin">
<meta property="og:description" content="前言后面想开源一个智能汽车安全的学习项目，用 Qt 整车模拟(这个有点难)或者汽车零部件模拟(大概率做这个)，即使需要用到硬件也不会非常贵，以便降低车联网安全学习门槛，帮助后来者学习。本篇讲一些入门知识，了解一下车联网安全的整体架构。本文带大家整体入门车联网安全，后续每个分支会做详细的研究。 基础篇网联汽车联网的车(Connected Car):又称网联汽车，即这些车具有网络连接功能，通常还具有W">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240408212123676.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/594_01.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240408212017249.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/v2x.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240311200214724.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240311214105472.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409192625239.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409193419913.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409194348314.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409194404044.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409194108490.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409194141591.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/614_02.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/630_01.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/631_01.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/631_02.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240423145323815.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240423145357844.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/632_02.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240408212657494.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409181918206.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409181954734.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/595_01.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/596_01.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/596_02.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/597_01.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/597_02.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/599_01.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/599_02.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/599_03.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/600_01.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331142815558.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/463990_GFK2CVP2Z4FK66X.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153256531.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153310496.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153331432.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153351432.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153405231.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153231209.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331154019747.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331154209820.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331154310248.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331154358016.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331185355072.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331193947062.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/607_01.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/609_01.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/609_02.jpg">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/f4xo4980f5.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/bu7tn39qb3.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/fwp8mkt3cu.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/7hwmq6zlnd.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/4ie6pezxot.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/hu51i7fqty.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/7f5kwghitc.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/e9jazcja12.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240320200538213.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240322141442922.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240322141806604.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240321151824810.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240321160059927.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240321161352222.png">
<meta property="og:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240416210758021.png">
<meta property="article:published_time" content="2023-10-25T07:48:36.000Z">
<meta property="article:modified_time" content="2024-12-13T09:46:47.723Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="智能汽车安全">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jelasin.github.io/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240408212123676.png">
    
    
        <!-- Google tag (gtag.js) -->
        <script src="https://www.googletagmanager.com/gtag/js?id=G-3333333333"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-3333333333');
        </script>
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/favicon.ico" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/favicon.ico">
    <!--- Page Info-->
    
    <title>
        
            车联网安全专题 | Jelasin
        
    </title>

    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/Chillax/chillax.css">

    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/css/build/tailwind.css">
    

    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/GeistMono/geist-mono.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/Geist/geist.css">
    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"jelasin.github.io","root":"/","language":"en","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":false,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":true,"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":"Noto Sans SC","url":"https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap"},"english":{"enable":false,"family":"Farsan","url":"https://fonts.googleapis.com/css2?family=Farsan&display=swap"},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","enable":true,"site_pv":false,"site_uv":false,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":true,"google_analytics":{"enable":true,"id":"G-3333333333"}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"“会当身由己，婉转入江湖”","subtitle":{"text":["Loading..."],"hitokoto":{"enable":true,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":null,"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Links":{"icon":"fa-regular fa-link","submenus":{"看雪":"https://bbs.kanxue.com/homepage-958172.htm","吾爱破解":"https://www.52pojie.cn/home.php?mod=space&uid=2101606&do=thread&view=me&from=space","中国诗歌网":"https://www.zgshige.com/c/2022-04-13/21151100.shtml"}}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":{"Essays":{"path":"/essays","icon":"fa-regular fa-comment"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"},"AI":{"path":"/AI","icon":"fa-brands fa-python"},"IOT":{"path":"/IOT","icon":"fas fa-network-wired"},"CTF":{"path":"/CTF","icon":"fa-solid fa-snowflake"},"Web":{"path":"/Web","icon":"fa-solid fa-shield"},"Linux":{"path":"/Linux","icon":"fa-brands fa-linux"},"Android":{"path":"/Android","icon":"fa-brands fa-android"},"Windows":{"path":"/Windows","icon":"fa-brands fa-windows"}}},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":4},"tags":{"enable":true,"limit":4}},"footerStart":"2023/9/20 11:45:14"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/fontawesome.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/brands.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/solid.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/regular.min.css">
    
    
    
    
<meta name="generator" content="Hexo 6.3.0"></head>



<body>
	<div class="progress-bar-container">
	
	<span class="scroll-progress-bar"></span>
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
                <a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/">
                    <img src="/images/favicon.ico" class="w-full h-full rounded-sm">
                </a>
            
            <a class="logo-title" href="/">
                
                Jelasin
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    ARCHIVES
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-link fa-fw"></i>
                                    LINKS
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://bbs.kanxue.com/homepage-958172.htm">
                                                    看雪
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://www.52pojie.cn/home.php?mod=space&uid=2101606&do=thread&view=me&from=space">
                                                    吾爱破解
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://www.zgshige.com/c/2022-04-13/21151100.shtml">
                                                    中国诗歌网
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                ARCHIVES
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-Links"
                        >
                            <span>
                                LINKS
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-Links">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://bbs.kanxue.com/homepage-958172.htm">看雪</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://www.52pojie.cn/home.php?mod=space&uid=2101606&do=thread&view=me&from=space">吾爱破解</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://www.zgshige.com/c/2022-04-13/21151100.shtml">中国诗歌网</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            

            
            
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/essays"
                        >
                            <span>Essays</span>
                            <i class="fa-regular fa-comment fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/categories"
                        >
                            <span>Categories</span>
                            <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/AI"
                        >
                            <span>AI</span>
                            <i class="fa-brands fa-python fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/IOT"
                        >
                            <span>IOT</span>
                            <i class="fas fa-network-wired fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/CTF"
                        >
                            <span>CTF</span>
                            <i class="fa-solid fa-snowflake fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/Web"
                        >
                            <span>Web</span>
                            <i class="fa-solid fa-shield fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/Linux"
                        >
                            <span>Linux</span>
                            <i class="fa-brands fa-linux fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/Android"
                        >
                            <span>Android</span>
                            <i class="fa-brands fa-android fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/Windows"
                        >
                            <span>Windows</span>
                            <i class="fa-brands fa-windows fa-sm fa-fw"></i>
                        </a>
                    </li>
                
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">41</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">19</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">61</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">车联网安全专题</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/touxiang.jpg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">韩乔落</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2023-10-25 15:48:36</span>
        <span class="mobile">2023-10-25 15:48:36</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-12-13 17:46:47</span>
            <span class="mobile">2024-12-13 17:46:47</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/Car/">Car</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E6%99%BA%E8%83%BD%E6%B1%BD%E8%BD%A6%E5%AE%89%E5%85%A8/">智能汽车安全</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>后面想开源一个智能汽车安全的学习项目，用 Qt 整车模拟(这个有点难)或者汽车零部件模拟(大概率做这个)，即使需要用到硬件也不会非常贵，以便降低车联网安全学习门槛，帮助后来者学习。本篇讲一些入门知识，了解一下车联网安全的整体架构。本文带大家整体入门车联网安全，后续每个分支会做详细的研究。</p>
<h1 id="基础篇"><a href="#基础篇" class="headerlink" title="基础篇"></a>基础篇</h1><h2 id="网联汽车"><a href="#网联汽车" class="headerlink" title="网联汽车"></a>网联汽车</h2><p>联网的车(Connected Car):又称网联汽车，即这些车具有网络连接功能，通常还具有Wi-Fi热点功能用于和其他设备分享车载网络连接。具有网络连接功能的汽车通常还会扩展出其他功能来充分利用网络连接带来的优势，例如<strong>车祸自动报警求救、远程控制、远程升级[Over the Air(OTA)Update]、安全预警</strong>等。车联网表示车辆接入网络，这个网络不仅包含传统的互联网，还拓展了新的领域——**V2X(Vehicle To Anything)**。V2X是无人驾驶的关键技术，行驶中的车辆通过V2X技术与外界不间断地进行通信，感知周边环境的变化，对不同的行车环境作出响应，以保障行车的舒适度与安全性。</p>
<p>车联网包含<strong>智能化和网联化</strong>两大技术路径，协同实现“信息感知”和“决策控制”功能。</p>
<p><strong>（1）智能化：</strong>依赖高级辅助驾驶系统ADAS，采用车载传感器与汽车自动控制系统相结合的方法实现汽车的自动巡航（ACC）、自动泊车（APS）及自动紧急刹车（AEB）等一系列功能。目前，新上市的车辆大多具有自动紧急刹车系统（AEB）和车道保持辅助系统（LKA），并能实现人车互联。</p>
<p><strong>（2）网联化：</strong>依靠搭载车联网V2X通信系统，进一步实现车-人、车-车、车-路、车-云的信息交换，实现汽车行驶的安全性、提高道路通向效率等，并最终实现无人驾驶。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240408212123676.png"
                      alt="image-20240408212123676"
                ></p>
<p>现阶段处于车联网阶段的早期，V2X在特殊场景中得到应用，现在提到更多的是智能网联汽车。智能网联汽车还不具备完整的车路协同能力，属于单车智能。智能网联汽车具有丰富的信息娱乐系统，支持远程控制车辆等功能。智能网联汽车的明显特征是支持OTA（Over The Air，空中下载技术）。汽车通过OTA拥有了更多的可能性，通过OTA可以给车辆添加新功能、修复软件中存在的缺陷等。但随着汽车智能化的程度不断加深，信息安全问题也日益凸显。车联网广义上仍然可以按照物联网设备划分为<strong>“云-管-端”</strong>架构。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/594_01.jpg"
                      alt="594_01"
                ></p>
<p>（1）<strong>“云”</strong>指的是车联网后端服务，由车企或内容服务商为车载终端提供服务的云端合集。云端提供的服务包括OTA、远程终端、信息娱乐、导航等。车联网云端的安全与其他领域的云端安全并无太大差异。云端依旧存在信息泄露、远程命令执行、SQL注入等威胁。</p>
<p>（2）<strong>“管”</strong>指的是云端与终端之间数据传输的管道，在车联网中专有网络与公共网络并存。敏感性较低的数据采用公共网络传输，敏感程度较高的数据（如车辆控制）采用专有网络传输。数据传输格式部分采用专有标准协议，如电动汽车与管理系统之间的通信协议采用GB&#x2F;T 32960.3—2016《电动汽车远程服务与管理系统技术规范第3部分：通讯协议及数据格式》中的通信协议及数据格式、道路运输车辆采用JT&#x2F;T 808—2019《道路运输车辆卫星定位系统终端通讯协议及数据格式》，与云端通信。此外，在车联网行业中广泛存在自定义的协议。在管道中，主要研究对象是通信协议，通信协议需要保障数据机密性，防止数据泄露或被篡改。</p>
<p>（3）<strong>“端”</strong>指的是车联网靠近消费者的终端设备，不仅仅是车辆本身，还有充电桩、车载单元(On Board Unit, OBU)、路测单元(Road Side Unit, RSU)等终端。</p>
<h2 id="V2X通信"><a href="#V2X通信" class="headerlink" title="V2X通信"></a><a class="link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/517666633" >V2X通信<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></h2><p>V2X(Vehicle to X)通信：表示车与X通信，X可以是车(Vehicle)、路(Road)或者其他相关基础设施，相应地也就有了V2V(Vehicle to Vehicle,车与车通信)、V2I(Vehicle to Infrastructure,车与基础设施如道路、服务器等通信)、V2P(Vehicleto Pedestrian,汽车与行人通信)等概念。V2X的典型应用有左转辅助、紧急刹车提示、闯红灯警告、过弯速度警告、施工路段提醒、实时天气信息提醒等。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240408212017249.png"
                      alt="image-20240408212017249"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/v2x.jpg"
                      alt="v2x"
                ></p>
<h2 id="高级辅助驾驶系统（ADAS）"><a href="#高级辅助驾驶系统（ADAS）" class="headerlink" title="高级辅助驾驶系统（ADAS）"></a><a class="link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/166184067" >高级辅助驾驶系统（ADAS）<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></h2><p>高级辅助驾驶系统(ADAS,Advanced Driver Assistance System):ADAS是在驾驶过程中辅助驾驶员的系统，它的功能包括安全告警功能、自适应控制功能、信息提示功能等，可在通过传感器检测到可能的危险时对驾驶员发出告警或者接管汽车某些控制功能（比如紧急刹车功能），以及根据环境自动对汽车的某些功能进行控制，比如根据环境亮度自动调节车灯亮度、自适应巡航控制、盲点警告、自动变道等。<br>ADAS技术通常依赖于各种传感器和通信技术，例如依赖雷达或者摄像头检测与前车的距离，依赖V2V获取附近车辆信息，依赖摄像头检测车道等。根据《道路车辆先进驾驶辅助系统（ADAS）术语及定义要求》，ADAS可以分为信息辅助与控制辅助两大类别。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240311200214724.png"
                      alt="image-20240311200214724"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240311214105472.png"
                      alt="image-20240311214105472"
                ></p>
<h2 id="TBOX"><a href="#TBOX" class="headerlink" title="TBOX"></a><a class="link"   target="_blank" rel="noopener" href="http://delikely.eu.org/2021/08/15/TBOX-Main-Function/" >TBOX<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></h2><p>TBOX是智能网联汽车上用于联网的重要模块，又名T盒、车载无线终端等，国外一般称之为TCU（Telematics Control Unit，远程信息控制单元）。上端与TSP(Telematics Service Provider)服务器相连，下端通过CAN总线等与汽车其他模块相连。国内的TBOX需要满足GB&#x2F;T 32960—2016系列标准对新能源汽车的监控要求，并提供远程控制、车辆故障诊断、OTA升级、网络共享、蓝牙钥匙、载荷分析等功能。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409192625239.png"
                      alt="image-20240409192625239"
                ></p>
<p><strong>TBOX</strong>通常是一个黑色的盒子，由于需要和其他部件相连，因此对外的接口较多，大体上可以分为3种：<strong>天线、通信接口以及电源</strong>。天线有蜂窝网络天线、Wi-Fi天线、GNSS天线、FM广播天线、蓝牙天线等。接口有USB、Ethernet、CAN、UART等。对外的接口有一定的外观特征，如天线一般采用FAKRA连接器，USB一般使用HSD连接器。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409193419913.png"
                      alt="image-20240409193419913"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409194348314.png"
                      alt="image-20240409194348314"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409194404044.png"
                      alt="image-20240409194404044"
                ></p>
<p><strong>FAKRA连接器</strong>用于射频模拟&#x2F;数字信号的同轴连接系统，支持高达6 GHz数据传输频率。2000年，以德国车厂为首的车厂，共同推出了一种汽车专用的音响与天线规格接头，后来推广至具有射频特性传输信号的功能，如视频、导航、蜂窝网络、Wi-Fi、摄像头、V2X等。FAKRA一般采用同轴电缆，单线单芯。不同颜色的连接器外形存在差异，使用场景也有所不同，例如蓝色用于GNSS、紫色用于蜂窝网络等。通过这种特性，人们能够根据颜色和外观的差异快速判断接口用途。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409194108490.png"
                      alt="image-20240409194108490"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409194141591.png"
                      alt="image-20240409194141591"
                ></p>
<p><strong>高速数据(High-Speed Data, HSD)接口</strong>专为汽车市场设计，支持高达6GHz的数据传输频率，支持USB、LVDS、Ethernet等协议的传输，适用于信息娱乐模块和显示装置等应用。HSD连接器型号较多，单腔HSD一般采用4芯。HSD连接器通常与Fakra、Mini-Fakra配合使用。</p>
<p>拆开TBOX会发现，里面使用的芯片并不多，结构相对简单。一般采用两种方案，区别在于通信模组是否具备SoC的功能。第一种是SoC与通信模组分离的方案，SoC本身不具备通信功能，需要通过通信模组与外部通信。这种方案以前使用得较多，现在更多的是采用集成方案。第二种是集成方案，将SoC和通信模组的功能封装到一起。采用这种方式的芯片有移远通信的EC20、慧翰微电子的FLC-MCM630、华为的巴龙MH 5000等。</p>
<p>在SIM卡方面，大部分TBOX采用eSIM卡，也有部分使用普通可插拔的SIM卡。除此之外，一般TBOX上还有一个MCU模块，MCU的功能比较单一，主要负责与CAN总线进行通信。</p>
<p><strong>T-BOX的使用</strong></p>
<p>对TBOX的基本认识是从盒子上的标签开始的，从标签可以得到供应商、硬件版本、CMIIT ID（无线电发射设备型号核准代码）、FCC ID、IMEI、ICCID、进网许可证等信息。还可以根据CMIIT ID&#x2F;FCC ID查询更多的信息。从这些信息中可以形成对TBOX的初步认识，为后续分析奠定基础。标签的样式各不相同，提供的信息也有多有少。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/614_02.jpg"
                      alt="614_02"
                ></p>
<p>图中有两个标签，左边的是TBOX的基本信息，右边的是进网许可证。从这两个标签中可以看出，这是奔驰汽车上的一个TBOX，制造商为Harman，型号为HERMES 1.5 CN。通信方面，这个TBOX支持蓝牙、Wi-Fi、蜂窝网络。标签中有蓝牙标志意味着支持蓝牙通信。标签中给出了WLAN-MAC：746FF7091E2E。这意味着支持Wi-Fi，根据MAC地址通过组织唯一标识符查询到模块的供应商为启基科技股份有限公司。另外，如果Wi-Fi隐藏了SSID，可以通过标签上的MAC地址找到对应的SSID。根据右边的进网许可证也能获取一些设备信息，作为左侧标签的补充。在中华人民共和国工业和信息化部网站中，查询进网许可证编号“17-B884-171643”。</p>
<h2 id="车机"><a href="#车机" class="headerlink" title="车机"></a>车机</h2><p>车机一般采用分离式结构，显示屏与主机分离。采用分离式结构有利于拓展显示，顺应当下汽车智能化的浪潮，越来越多的车企为新推车型配备更大更多的屏幕。有的车型甚至会用到3块及以上的屏幕，通过视觉冲击满足消费者对智能汽车的追求。车机上的多屏幕显示与电脑多屏幕显示有所差异，大多不是简单的分屏显示，每一个屏幕都是通过虚拟技术生成的，使用较多的车载虚拟化方案有QNX Hypervisor、COQOS Hypervisor、ACRN等。</p>
<p>主机方面一般采用SoC（System on Chip，片上系统）与MCU搭配使用，SoC负责提供信息娱乐，而与车身总线的交互一般由MCU实现。MCU具备一路或多路CAN总线，车机对空调、车窗的控制通过MCU传递给CAN总线，对应的部件执行相应的操作。接口一般有USB接口、收音机天线接口、导航定位天线接口、多组CAN接口、扬声器接口、A2B车载音频接口、调试串口等。</p>
<p>车机中SoC一般采用虚拟化技术将系统分割为多个独立的子系统，底层一般使用AGL(Automotive Grade Linux)或QNX系统。AGL是Linux基金会维护的开源车载操作系统，采用Linux内核，通过开源技术栈加快汽车制造商、供应商以及科技公司的开发进程。AGL划分为应用层、应用框架层、服务层以及操作系统层。AGL通过对服务进行抽象，提供便捷易用的接口。QNX是由Blackberry公司推出的分布式实时操作系统，与AGL的开源方式不同，QNX采用闭源方式，使用前需要得到Blackberry公司的授权。蔚来汽车ES8搭载的NIO OS便是基于QNX开发的。</p>
<p>车机是一个相对封闭的系统，用户的自由度相对较低，默认状态下不能任意安装第三方应用。车机底层操作系统负责与MCU之间的通信，通过MCU间接接入车身总线。底层操作系统还为人机交互的信息娱乐系统提供运行环境，通过虚拟化技术运行Android操作系统。由于Android系统生态完整、应用丰富，国内多数车机采用Android作为人机交互系统。车企通过深度定制车机操作系统建立自己的生态，如吉利汽车的GKUI、比亚迪的DiLink等。</p>
<h2 id="充电桩"><a href="#充电桩" class="headerlink" title="充电桩"></a>充电桩</h2><p><strong>充电桩结构</strong></p>
<p>充电桩按充电方式可以分为直流充电桩、交流充电桩。直流充电桩是固定安装在电动汽车外，与交流电网相连，为电动汽车动力电池提供直流电源的供电装置。交流充电桩是固定在电动汽车外，为电动汽车供能的装置，但不具备充电功能，需要连接车载充电机才能为电动汽车充电。直流充电桩的充电效率比交流充电桩的充电效率高，使用更加广泛，下文提到的充电桩均表示直流充电桩。不同充电桩的外形和结构有差异，下面以国家电网的“A型一体充电机”为例，讲解充电桩的结构。</p>
<p>充电桩由TCU（Tariff and Control Unit，计费控制单元）、充电主控模块、功率控制模块、开关电源、散热系统、充电枪、液晶显示屏等部分组成。TCU如图11-31所示，外围接口丰富，集成串口、CAN、工业以太网、SIM卡槽、音频、LVDS等接口，并支持北斗定位、蜂窝通信等功能，可实现充电桩人机交互、计费计量、支付、数据加解密、控制充电设备、与车联网平台通信等功能。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/630_01.jpg"
                      alt="630_01"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/631_01.jpg"
                      alt="631_01"
                ></p>
<p>TCU是充电桩的核心，也是我们研究的主要对象。从图11-32中可以了解TCU的数据外围交互。TCU配备两个外插式标准SIM卡槽，充电桩主要通过蜂窝网络与车联网平台相连。</p>
<p>人机交互方面，TCU通过LVDS或并口连接支持触屏操作的液晶显示器，用户通过显示屏与充电桩交互完成充电过程，同时也可以通过显示器配置和维护充电桩。可选的充电付费方式很多，包括扫描二维码、刷卡、输入个人账号等。读卡器与TCU采用RS232通信。在电量计费时，使用多功能电表进行电量测算，TCU通过RS485与电表通信并读取消耗的电量值。TCU与充电设备控制器通过CAN总线进行通信，通信协议为BMS。调试接口方面，TCU提供了丰富的调试接口，如RS232、RJ45、UART等。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/631_02.jpg"
                      alt="631_02"
                ></p>
<p>了解TCU的组成结构之后，还需要知道充电插头的定义。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240423145323815.png"
                      alt="image-20240423145323815"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240423145357844.png"
                      alt="image-20240423145357844"
                ></p>
<p>充电桩与电动汽车之间采用CAN总线通信，CAN_H位于充电插头的S+，CAN_L位于充电插头的S-。</p>
<p><strong>充电协议</strong></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/632_02.jpg"
                      alt="632_02"
                ></p>
<p>电动汽车充电机与电池管理系统(Battery Management System, BMS)之间的通信基于CAN协议，通信数率为250kbit&#x2F;s，使用29bit标识符的CAN拓展帧，通信地址固定，任何手段都不能改变，充电机地址为86(56H)，BMS地址为244(F4)。每个CAN数据帧包含一个单一的协议数据单元(Protocol Data Unit, PDU)。协议数据单元由七部分组成，分别是优先权、保留位、数据页、PDU格式、PDU特定格式、源地址和数据域。</p>
<p>第一行表示数据位，第二行表示数据说明，第三行表示位数，数据格式说明如下。</p>
<ul>
<li>P为优先权，从最高0到最低7。</li>
<li>R为保留位，留作今后开发使用，本标准中为0。</li>
<li>DP为数据页，用来选择参数组描述的辅助页，本标准中为0。</li>
<li>PF为PDU格式，用来确定PDU的格式，以及数据域对应的参数组编号。</li>
<li>PS为PDU特定格式，PS的值取决于PDU格式，在本标准中PS的值为目标地址。</li>
<li>SA为源地址，发送此报文的源地址。</li>
<li>DATA为数据域，若给定参数组数据长度≤8字节，按单帧传输。若给定参数组数据长度为9～1785字节，数据传输需多个CAN数据帧,通过传输协议功能的连接管理能力来建立和关闭多包参数组的通信。</li>
</ul>
<p>整个充电过程包括6个阶段：物理连接、低压辅助上电、充电握手阶段、充电参数配置阶段、充电阶段和充电结束阶段。更多内容详见GB&#x2F;T 27930—2015《电动汽车非车载传导式充电机与电池管理系统之间的通信协议》。</p>
<h2 id="IVI"><a href="#IVI" class="headerlink" title="IVI"></a>IVI</h2><p><a class="link"   target="_blank" rel="noopener" href="https://xz.aliyun.com/t/12988?time__1311=mqmhqI2YGKGNDQtiQGkIYDtG8Sj8avD&alichlgref=https://cn.bing.com/" >参考链接<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>IVI（In-Vehicle Infotainment）是指安装在汽车中的信息娱乐系统。它是集成了多种功能和服务的电子设备，旨在提供丰富的娱乐、信息和通信体验。其实对于这个除了IVI之外还有很多名字，比如</p>
<ul>
<li>Head Unit (HU): Head Unit是指车辆中心控制单元，它是车机系统的主要组成部分。Head Unit通常位于车辆的仪表板上，集成了多媒体功能、导航系统和控制界面。</li>
<li>Infotainment System: Infotainment系统是指整合了信息和娱乐功能的车载系统。它提供了音频、视频、导航、通信等功能，旨在为驾驶员和乘客提供全面的娱乐和信息体验。</li>
<li>中控屏 </li>
<li>……</li>
</ul>
<h2 id="ECU"><a href="#ECU" class="headerlink" title="ECU"></a>ECU</h2><p><a class="link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/414243718" >参考链接<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>汽车互联互通的快速发展为新功能和创新的商业模式提供了许多机会。与此同时，汽车网络受到黑客攻击的可能性也在增加。此类攻击威胁到车辆的功能安全(Safety)，并可能造成经济损失。AutoSAR标准为运行在ECU上的软件定义了基本的软件功能和接口，确保车辆在出厂时就具备必要的安全防护和检测能力。现代车辆E&#x2F;E架构不断发展,但总体来看，无论E&#x2F;E架构如何发展，ECU还是可以简单的划分为两大类型：</p>
<ol>
<li>CP(Classic Platform):计算能力、存储空间大小、网络带宽等都通常十分有限，而实时性要求又很高，这类ECU通常要求部署轻量级的安全措施，重点解决运行在ECU上的软件和网络报文的完整性和真实性。</li>
<li>AP(Adaptive  Platform):各类资源相对丰富。可以提供更多的资源给Security，因此可以部署一些入侵检测特性以及整车安全管理类的特性。未来E&#x2F;E架构越来越走向融合的道路，整车的核心功能会集中在少量的高性能计算芯片中，有的文献中成为汽车计算机(Vehicle Computer),我们仍然归类为AP类。</li>
</ol>
<h2 id="CAN"><a href="#CAN" class="headerlink" title="CAN"></a>CAN</h2><p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/lzw508170827/article/details/102866360" >参考链接<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>CAN是车辆网络通信中最常用的协议之一。然而，原始的CAN协议没有内置的安全机制，因此现代车辆通常使用CAN协议的安全扩展，如CAN-FD  (CAN with Flexible Data-Rate) 和CAN-XCP (CAN with Extended Calibration  Protocol) 来增加安全性。</p>
<p><strong>CAN协议的特点包括：</strong></p>
<p>可靠性：CAN使用冗余机制和错误检测与纠正技术，确保通信的可靠性。它具有错误检测和错误响应机制，可以检测和处理通信中的错误。</p>
<p>实时性：CAN协议设计用于实时控制应用，具有高效的消息传输机制和低延迟特性。</p>
<p>简单性：CAN协议相对简单，易于实现和部署。它使用广播通信和基于标识符的消息过滤机制。</p>
<p>然而，原始的CAN协议存在一些安全性挑战，如缺乏身份验证和加密机制，容易受到欺骗和中间人攻击。为了提高CAN协议的安全性，现代车辆通常使用CAN的安全扩展协议，如CAN-FD（CAN with Flexible Data-Rate）和CAN-XCP（CAN with Extended Calibration  Protocol）。这些扩展协议提供了额外的安全特性，如消息认证、数据完整性保护和加密。</p>
<p><strong>安全风险：</strong></p>
<ul>
<li>CAN总线攻击：黑客可能通过篡改或伪造CAN消息来影响车辆的正常运行，如操纵刹车系统或引擎控制。</li>
<li>数据注入：黑客可能注入虚假的CAN消息，导致车辆系统做出错误的决策或操作。</li>
</ul>
<p><strong>实际案例：</strong></p>
<ul>
<li>Jeep漏洞（2015年）：黑客成功利用CAN总线上的漏洞，远程控制了一辆Jeep车辆，包括刹车和方向盘等功能。</li>
<li>Tesla Model S攻击（2016年）：黑客通过CAN总线入侵了特斯拉Model S，实现了远程控制车辆的各种功能。</li>
</ul>
<h2 id="LIN"><a href="#LIN" class="headerlink" title="LIN"></a>LIN</h2><p>LIN 总线协议用于车辆中低速数据传输，如门控、照明和仪表板等。LIN本身并没有提供强大的安全性，因此在需要更高安全级别的应用中，可以结合其他安全通信协议使用。</p>
<p><strong>LIN协议的特点包括：</strong></p>
<p>成本效益：由于LIN协议的较低速率和简单性，它在成本上更具有竞争力。它适用于车辆中的简单控制和监测任务。</p>
<p>简单性：LIN协议相对简单，易于实现和部署。它使用主-从架构，其中一个主节点控制多个从节点。</p>
<p>然而，与CAN相比，LIN协议在安全性方面的功能有限。它没有内置的加密和身份验证机制，因此在需要更高安全级别的应用中，可以结合其他安全通信协议使用，如CAN-FD和LIN的安全扩展。</p>
<p>综上所述，CAN和LIN是车辆通信中常见的协议。CAN主要用于高速、实时控制的通信，而LIN主要用于低速、简单控制的通信。为了提高安全性，现代车辆通常采用CAN和LIN的安全扩展协议，以增加安全特性和保护通信免受攻击。</p>
<p><strong>安全风险：</strong></p>
<ul>
<li>欺骗攻击：黑客可能冒充合法的LIN设备，与车辆中的LIN网络进行通信并执行恶意操作。</li>
<li>窃听攻击：黑客可能窃听车辆中的LIN通信，获取敏感信息，如车辆控制指令或传感器数据。</li>
</ul>
<p><strong>实际案例：</strong></p>
<ul>
<li>BMW i3攻击（2018年）：黑客通过LIN总线入侵了一辆BMW i3电动汽车，成功控制了车辆的门锁和车窗等功能。</li>
<li>福特Focus攻击（2019年）：黑客通过LIN总线攻击了福特Focus车辆的车窗控制系统，成功实现了远程开启和关闭车窗。</li>
</ul>
<h2 id="MOST"><a href="#MOST" class="headerlink" title="MOST"></a>MOST</h2><p>MOST (Media Oriented System Transport) 面向媒体的系统传输总线，MOST 是汽车业合作的成果，而不具备正式的标准。它是一种专门针对车内使用而开发的、服务于多媒体应用的数据总线技术。MOST 表示“多媒体传输系统”。</p>
<p><strong>MOST总线工作原理</strong></p>
<p>MOST  总线利用光脉冲传输数据，采用环形结构，在环形总线内只能朝着一个方向传输数据。MOST 总线的传输技术近似于公众交换式电话网络（ Public  Switched Telephone Network；PSTN），有着数据信道（Data Channel）与控制信道（Control  Channel）的设计定义，控制信道即用来设定如何使用与收发数据信道。一旦设定完成， 资料就会持续地从发送处流向接收处，  过程中不用再有进一步的封包处理程序， 将运作机制如此设计，  最适合用于实时性音讯、视讯串流传输。MOST在制订上完全合乎ISO&#x2F;OSI的7层数据通讯协议参考模型，而在网线连接上MOST采用环状 拓朴，  不过在更具严苛要求的传控应用上， MOST也允许改采星状（ 亦称放射状）  或双环状的连接组态，此外每套MOST传控网络允许最多达64个的装置（节点）连接。</p>
<p>基于MOST总线的车载音频娱乐系统原理图MOST总线专门用于满足要求严格的车载环境。这种新的基于光纤的网络能够支持24.8Mbps的数据速率，与以前的铜缆相比具有减轻重量和减小电磁干扰(EMI)的优势。同时，MOST也支持随插随用机制。</p>
<h2 id="FlexRay"><a href="#FlexRay" class="headerlink" title="FlexRay"></a>FlexRay</h2><p>FlexRay是一种高速车辆网络通信协议，用于高带宽和实时性要求较高的系统，如刹车、转向和悬挂控制。FlexRay提供了一些安全机制，例如消息认证和数据完整性保护。</p>
<p><strong>FlexRay协议的特点包括：</strong></p>
<p>高带宽和灵活性：FlexRay支持高达10 Mbps的通信速率，能够满足车辆系统中对大量数据传输的需求。它还提供了灵活的网络配置选项，允许多种通信拓扑结构。</p>
<p>实时性：FlexRay使用时间分隔多路访问 (Time Division Multiple Access, TDMA) 技术，通过将通信周期划分为固定的时间槽，实现严格的实时通信。这对于需要高精度和可靠性的车辆控制系统至关重要。</p>
<p>安全性：FlexRay提供了消息认证和数据完整性保护的机制，以保护通信数据的安全性。它使用消息认证码 (MAC) 和数据签名等技术来验证消息的真实性和完整性。</p>
<p><strong>安全风险：</strong></p>
<ul>
<li>消息干扰：黑客可能干扰FlexRay消息传输，导致通信错误或消息丢失，影响车辆的实时性和可靠性。</li>
<li>信息窃取：黑客可能窃取FlexRay通信中的敏感信息，如自动驾驶系统的指令或传感器数据。</li>
</ul>
<p><strong>实际案例：</strong></p>
<ul>
<li>福特Escape漏洞（2013年）：黑客通过FlexRay总线入侵了福特Escape车辆，成功控制了车辆的刹车和加速等功能。</li>
<li>捷豹路虎漏洞（2016年）：黑客利用FlexRay总线的漏洞入侵了捷豹路虎车辆，成功控制了车辆的转向和刹车等功能。</li>
</ul>
<h2 id="Ethernet："><a href="#Ethernet：" class="headerlink" title="Ethernet："></a>Ethernet：</h2><p>以太网在车辆领域的应用越来越普遍，特别是用于高带宽的数据传输和车辆内部的通信。为了增强安全性，车辆中使用的以太网通常采用了安全扩展，如Ethernet AVB (Audio Video Bridging) 和 TSN (Time-Sensitive Networking)。</p>
<p><strong>Ethernet协议的特点包括：</strong></p>
<p>Ethernet AVB (Audio Video Bridging)：Ethernet  AVB是一组用于音频和视频传输的标准，旨在提供严格的实时性和同步性。它具有流量调度和时钟同步机制，以确保高质量的音视频传输，并为车载娱乐和车载通信系统提供更好的用户体验。</p>
<p>TSN (Time-Sensitive Networking)：TSN是一组扩展以太网标准，旨在满足对实时性和可靠性要求较高的应用的需求。它提供了严格的时间同步和流量调度机制，支持车辆中对高实时性通信的要求，如自动驾驶和高级驾驶辅助系统。</p>
<p><strong>安全风险：</strong></p>
<ul>
<li>网络入侵：黑客可能通过网络入侵车辆的以太网系统，获取未经授权的访问权限，并对车辆进行恶意操作或数据窃取。</li>
<li>远程攻击：黑客可能通过远程连接到车辆的以太网系统，利用系统漏洞或弱点来入侵车辆并控制其功能。</li>
</ul>
<p><strong>实际案例：</strong></p>
<ul>
<li>远程攻击特斯拉（2016年）：黑客通过特斯拉车辆的以太网接口入侵了车辆，成功控制了车辆的门锁、仪表盘和行驶系统等功能。</li>
<li>远程攻击大众汽车（2019年）：黑客通过大众汽车的以太网接口入侵了车辆，成功控制了车辆的中央控制单元和仪表盘等功能。</li>
</ul>
<h2 id="ASec"><a href="#ASec" class="headerlink" title="ASec"></a>ASec</h2><p>ASec是一套在汽车以太网中实施安全性的标准和协议。它包括对消息认证、数据完整性、访问控制和安全密钥管理的支持。</p>
<p><strong>Auto motive Ethernet Security （ASec）协议的特点包括：</strong></p>
<p>消息认证和完整性保护：ASec提供了对消息的认证和数据完整性保护的机制。它使用加密算法和数字签名来确保消息的真实性和完整性，防止消息被篡改或伪造。</p>
<p>访问控制：ASec定义了访问控制机制，以确保只有经过授权的设备和实体可以访问车辆的以太网系统。它可以基于身份验证、访问权限和角色分配等策略进行访问控制。</p>
<p>安全密钥管理：ASec提供了安全密钥的生成、分发和管理机制，以确保密钥的机密性和安全性。密钥管理是实施安全通信的重要组成部分，用于加密和解密通信数据。</p>
<p><strong>安全风险：</strong></p>
<ul>
<li>密钥破解：黑客可能尝试破解ASec协议中使用的加密密钥，以获取对车辆通信的未经授权的访问权限。</li>
<li>信息篡改：黑客可能篡改ASec协议中的安全认证和完整性保护机制，以修改或伪造车辆通信中的消息。</li>
</ul>
<p><strong>实际案例：</strong></p>
<ul>
<li>车辆远程入侵攻击（2019年）：黑客通过ASec协议的漏洞，成功远程入侵了车辆的以太网系统，获取了车辆的敏感信息和控制权。</li>
</ul>
<h2 id="GW"><a href="#GW" class="headerlink" title="GW"></a>GW</h2><p><a class="link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/149567659" >参考链接<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>汽车网关(Automotive Gateway)  可以简单形象地理解为翻译官，作为整车网络的数据交互枢纽，是整车电子电气构架中的核心部件，使数据在车辆内部的多个网络(CAN、LIN、MOST、FlexRay等)  中安全可靠得进行传输是其核心功能。网关作为汽车网络系统的核心控制装置，负责协调不同结构特征的CAN总线网络和其他数据网络之间的协议转换、数据交换、故障诊断等工作。整车电子电气构架可以基于网关而更加优化，网关也可以提高整车拓扑结构的可扩展性和整车的安全性，整车网络数据的保密性也可以得到加强。</p>
<h2 id="BMS"><a href="#BMS" class="headerlink" title="BMS"></a>BMS</h2><p><a class="link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/149932069" >参考链接<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>BMS电池管理系统（BATTERY MANAGEMENT SYSTEM）俗称电池保姆或电池管家，主要就是为了智能化管理及维护各个电池单元，防止电池出现过充电和过放电，延长电池的使用寿命，监控电池的状态。</p>
<p>BMS电池管理系统单元包括BMS电池管理系统、控制模组、显示模组、无线通信模组、电气设备、用于为电气设备供电的电池组以及用于采集电池组的电池信息的采集模组，BMS电池管理系统通过通信接口分别与无线通信模组及显示模组连接，所述采集模组的输出端与BMS电池管理系统的输入端连接，所述BMS电池管理系统的输出端与控制模组的输入端连接，所述控制模组分别与电池组及电气设备连接，BMS电池管理系统通过无线通信模块与Server服务器端连接。</p>
<h2 id="车联网攻击面"><a href="#车联网攻击面" class="headerlink" title="车联网攻击面"></a>车联网攻击面</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240408212657494.png"
                      alt="image-20240408212657494"
                ></p>
<h2 id="车联网合规要求"><a href="#车联网合规要求" class="headerlink" title="车联网合规要求"></a>车联网合规要求</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409181918206.png"
                      alt="image-20240409181918206"
                ></p>
<h2 id="车联网安全面检测"><a href="#车联网安全面检测" class="headerlink" title="车联网安全面检测"></a>车联网安全面检测</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240409181954734.png"
                      alt="image-20240409181954734"
                ></p>
<h1 id="竞赛篇"><a href="#竞赛篇" class="headerlink" title="竞赛篇"></a>竞赛篇</h1><h1 id="线上赛"><a href="#线上赛" class="headerlink" title="线上赛"></a>线上赛</h1><p>车联网竞赛的赛制和内容也在不断发生着变化，常见的分项赛有云平台夺旗赛、车载信息娱乐系统漏洞挖掘、总线逆向破解等。车联网安全竞赛相对于当下应接不暇的CTF赛事还是比较少的，也有一些赛事连续举办多年，如世界智能驾驶挑战赛、汽车安全与召回技术论坛上举办的车联网安全攻防挑战赛等。</p>
<p>随着汽车电气系统日趋复杂，传统电气系统的点对点通信方式已无法满足通信需要，汽车总线便应运而生。在现代的汽车构造中有多种总线，不同的总线对应不同的使用场景。</p>
<ul>
<li><p><strong>LIN</strong></p>
<p>**LIN（Local Interconnect Network，局域互连网络)**是一种低成本的串行通信网络，是对汽车多路网络的补充。LIN总线的最高传输速率为20kbit&#x2F;s，主要用于对速度不敏感、对带宽要求不太高的子系统，如车窗、灯光、电动座椅等。</p>
</li>
<li><p><strong>CAN</strong></p>
<p><strong>CAN（Controller Area Network，控制器局域网络）</strong>是一种应用于实时环境的串行通信网络，是汽车中使用最为广泛的总线网络，主要用于车身控制，提供电子控制单元与启停系统、驻车辅助系统与电子驻车制动器传感器之间的通信等。CAN总线的最高传输速率为1Mbit&#x2F;s，协议本身能够保障数据的完整性与实时性。由于标准CAN总线携带的数据量较少，随着汽车网络传输的数据量不断攀升，在CAN的基础上衍生出了CAN-FD(CAN with Flexible Data rate)。CAN-FD与CAN相比，数据传输速率更大、有效数据场更长。车载以太网是一种基于以太网的专门用于汽车领域的通信技术，主要用于故障诊断、车载信息娱乐系统和高带宽传感器的连接。</p>
</li>
<li><p><strong>车载以太网</strong></p>
<p><strong>车载以太网</strong>是一种基于以太网的专门用于汽车领域的通信技术，主要用于故障诊断、车载信息娱乐系统和高带宽传感器的连接。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zataji/article/details/124230831"><strong>FlexRay</strong></a></p>
<p>由于CAN总线通信方式不能满足新兴的驾驶辅助功能，如ABS防抱死系统、ASR驱动防滑系统、ESP电子稳定系统等涉及汽车主动，被动领域的高要求辅助功能，需要更多的交互节点，更高的传输带宽，对汽车通信系统的可靠性、安全性、实时性提出更高的要求；</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.autoee.cn/article/179.html"><strong>MOST</strong></a></p>
<p><strong>MOST（Media Oriented Systems Transport）</strong>，是一种面向多媒体数据传输的总线。上个世纪 90 年代，MOST 是由 ABB 等一众著名整车厂共同研制而成用来传输车载多媒体数据的总线，并制定了相关的标准和协议，现由 Mircochip 维护管理。根据 MOST 总线的来源可以看出，MOST 总线生来就是为车载多媒体数据服务的，而以太网则不同，以太网则是先制定相关的传输协议，不针对特定应用。</p>
<p>另外，从技术上来讲，以太网的终端设备基本都是非同期的，发送也是自由的；而 MOST 是时钟完全同期的，都是主设备过来的，发送时月票式的，带宽有保证。而同样作为汽车四大总线之二的 CAN 和 LIN 由于传输带宽的原因，也不便用于多媒体数据的传输。</p>
<p>所以，综合背景下，MOST 就诞生了并广泛应用于车载多媒体数据的传输。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhuwade/article/details/122753796"><strong>A2B</strong></a></p>
<p><strong>Analog Devices Inc. A2B®（汽车音频总线）</strong>是一款高带宽、双向、数字音频总线，为音频设计提供更简单、更方便的解决方案。A2B能够用一条双线UTP（非屏蔽双绞线 Unshielded Twisted  Pair）电缆传输I2S&#x2F;TDM&#x2F;PDM数据和I2C控制信息以及时钟和电源，节点间距离最长15米，整个菊花链最长40米。A2B可用作其自己的网络，具有嵌入式子网络，或者搭配其他较长距离协议用作端点传输总线。单个A2B网络中所有节点上的时钟均同步。系统中每个节点同时接收麦克风和串行音频数据。</p>
</li>
</ul>
<h2 id="CAN总线协议-1-讲"><a href="#CAN总线协议-1-讲" class="headerlink" title="CAN总线协议 1 讲"></a>CAN总线协议 1 讲</h2><p>CAN协议的国际标准为ISO 11898，通信速率为5kbit&#x2F;s～1Mbit&#x2F;s。CAN报文由帧起始、仲裁段、控制段、数据、CRC校验段、帧结束组成，CAN ID位于仲裁段，标准帧的ID长度为11bit，拓展帧的ID长度为29bit，无论在标准帧还是在拓展帧中，数据的长度都是8字节。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/595_01.jpg"
                      alt="595_01"
                ></p>
<p>CAN协议有两种帧结构——标准帧和拓展帧。ID长度为11bit的是标准帧，ID长度为29bit的是拓展帧。在比赛中以标准帧为主，拓展帧使用得相对较少。如果是刚接触总线协议分析的人，只需要知道CAN数据帧由ID、DLC（Data Length Code，数据长度）、数据域三部分组成。ID表示报文的优先级；DLC表示数据的有效长度，取值范围是1～8；数据域表示所需传输的数据。其他部分由CAN协议的电气层负责，不需要我们关注。</p>
<p>CAN ID的值越小，消息的优先级别越高。CAN报文按照ID的范围划分为应用报文、网络管理报文、开发报文、诊断报文。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/596_01.jpg"
                      alt="596_01"
                ></p>
<h2 id="ISO-TP协议-1-讲"><a href="#ISO-TP协议-1-讲" class="headerlink" title="ISO-TP协议 1 讲"></a>ISO-TP协议 1 讲</h2><p>了解CAN报文的结构后，先来看一段CAN报文。下面是一道汽车总线分析的题目，使用candump获取CAN报文，我们需要从中找到隐藏的flag。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/596_02.jpg"
                      alt="596_02"
                ></p>
<p>这是一道比较基础的CAN报文分析题。报文的结构依次为接口名称、CAN ID、DLC以及数据。报文内容较短，从整体上看，CAN ID有131、08F、0A5、0D9、0F3、098、19A、16A、09A、0EF、113、199，不难发现ID为19A的消息最多。我们提取ID为19A的报文。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/597_01.jpg"
                      alt="597_01"
                ></p>
<p>仔细观察数据的第一个字节分别是10、21、22、23、24，看起来似乎有一定的规律。其实，这是ISO 15765标准第二部分（通常称之为ISO-TP协议）网络层服务中定义的协议数据单元。ISO-TP协议中定义了4种数据帧：单帧、首帧、连续帧以及流控帧。</p>
<ul>
<li>单帧：<strong>数据域第一个字节的高四位的十六进制值为0时</strong>，代表这是单帧数据。第一个字节的低四位代表数据长度。</li>
<li>首帧：在多帧传输中，<strong>数据域第一个字节的高四位的十六进制值为1时</strong>，代表这是多帧数据传输的第一帧，数据域第一个字节的低四位与第二个字节代表数据帧的长度。</li>
<li>连续帧：用于传输多帧传输中拆分的CAN消息，作为首帧的后序帧。数据域第一个字节的高四位的值为2，第一个字节的低四位为连续帧的编号。<strong>编号从1开始，达到15时，在下一个连续帧中重置为0</strong>。</li>
<li>流控帧：用于调节连续帧发送的速率。<strong>流控帧数据域第一个字节的高四位为3。</strong></li>
</ul>
<p>再来看CAN ID为19A的报文。第一条报文，数据域第一个字节的高四位为1，表明这是多帧数据传输的首帧。再看数据长度为0x01A(26)字节。接着往后看，后面4条报文数据域的高四位都是2，说明这些是多帧数据传输中的连续帧。通过分析CAN报文可知，CAN ID 19A在传输多帧数据，现在我们把数据提取出来，得到如下的数据。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/597_02.jpg"
                      alt="597_02"
                ></p>
<p>将其转化为ASC II字符可以得到flag——“flag{welcome_and_have_fun}”。</p>
<h2 id="SAE-J1979协议-1-讲"><a href="#SAE-J1979协议-1-讲" class="headerlink" title="SAE J1979协议 1 讲"></a>SAE J1979协议 1 讲</h2><p>通过上面的题目我们了解了CAN的上层协议ISO-TP，下面再来看涉及更高层协议的题目，如读取车架号、车速等车辆的基本信息，这类题考查的是对SAE J1979协议的掌握程度。</p>
<p>SAE J1979《汽车诊断技术规范》属于应用层协议，网络层和传输层采用ISO-TP。SAE J1979对应的国际标准为ISO 15031-5。SAE J1979标准中定义了10种模式，汽车制造商并不需要支持所有的模式，每个制造商也可以自行定义模式，这10种模式如下。</p>
<ul>
<li><p><strong>模式01：请求动力系诊断数据</strong></p>
<p>识别动力系统信息并在诊断设备上显示车辆数据、车辆状态等信息，如发动机转速、温度、车速、档位、电池电压、油量、油耗、总里程、本次里程等。</p>
</li>
<li><p><strong>模式02：请求冻结帧数据</strong></p>
<p>和模式01中的数据相同，冻结帧数据是在故障发生和故障码被定义时存储的，用于反映故障发生时的环境信息，便于分析故障并处理。</p>
</li>
<li><p><strong>模式03：请求排放相关的诊断故障码</strong></p>
<p>获取与排放相关的故障码，故障码定义见ISO 15031-6。通过请求当前的故障码，了解车辆发生的故障，再根据产生的原因进行维修。</p>
</li>
<li><p><strong>模式04：清除&#x2F;复位与排放相关的诊断信息</strong></p>
<p>车辆发生故障后产生故障码，维修后需要清除故障码和冻结帧数据。</p>
</li>
<li><p><strong>模式05：请求氧传感器检测结果</strong></p>
<p>该模式显示氧传感器检测页面和收集到的关于氧传感器的测试结果。</p>
</li>
<li><p><strong>模式06：请求指定检测系统的测试结果</strong><br>除氧传感器外还需要检测其他系统，如催化剂系统、蒸发系统等。车辆制造商通过自定义参数获取指定的监控系统的测试结果。</p>
</li>
<li><p><strong>模式07：请求排放相关的未决故障码</strong></p>
<p>一次驾驶循环后，需要连续监测系统的未决故障码以判断是否需要维修。维修技术人员以此来确认是否已经正确维修且清除了故障码。</p>
</li>
<li><p><strong>模式08：请求组件&#x2F;系统的控制操作</strong></p>
<p>这个模式用于外部设备控制车载组件、系统，具体功能由车辆制造商指定。</p>
</li>
<li><p><strong>模式09：请求车辆信息</strong></p>
<p>获取车辆信息，该信息包括存储在车辆发动机控制单元中的车辆的标定信息，如车厂、型号、品牌、车架号、发动机号等。</p>
</li>
<li><p><strong>模式0A：请求排放相关的永久故障码</strong></p>
<p>获取与排放相关的故障码，这类故障码一旦产生就不能清除或改写。</p>
</li>
</ul>
<p>硬件连接方面，读取车辆基本信息的入口是 **OBD-II(On Board Diagnostics-Ⅱ)**接口。部分比赛使用模拟器模拟OBD-Ⅱ接口的CAN总线，向接口发送指定的数据获取需要的数据。在整车上，按法规要求需要预留OBD-Ⅱ接口。OBD-Ⅱ接口用于故障诊断，接口一般位于方向盘下方。诊断故障的方式很多，如CAN总线诊断、K线诊断等。当前主流的诊断方式是CAN总线诊断。CAN总线使用差分信号，需要用到两根线缆CAN_H和CAN_L。CAN_H位于OBD-Ⅱ的第6个接口，CAN_L位于OBD-Ⅱ的第14个接口。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/599_01.jpg"
                      alt="599_01"
                ></p>
<blockquote>
<p>车辆OBD接口，连接车辆ECU行车电脑的接口,检修车辆时把设备解码仪插在此接口，进行扫描车辆是否有故障及故障代码，以后的车联网都是基于此口加以研发的。</p>
<p><strong>什么是OBD</strong></p>
<p>OBD全称：On Board Diagnostics， 翻译成中文是：车载自动诊断系统“OBD Ⅱ”是“on Board Diagnositics  Ⅱ”。为使汽车排放和驱动性相关故障的诊断标准化，从1996年开始，凡在美国销售的全部新车，其诊断仪器、故障编码和检修步骤必须相似，即符合OBD  Ⅱ程序规定。作为驱动性和排放诊断基础，OBD Ⅱ系统将得到越来越广泛的实施。</p>
<p><strong>OBDII的作用</strong></p>
<p>OBD Ⅱ程序使得汽车故障诊断简单而统一，维修人员不需专门学习每一个厂家的新系统。</p>
<p>【1】随时检测零部件和系统的故障，保证汽车在使用寿命中的排放不超过OBD法规的要求</p>
<p>【2】检测到相关排放故障时，OBD系统可以用仪表板上的MIL灯进行报警。</p>
<p>【3】故障车辆能够得到及时修理，减少车辆排放。</p>
<p>【4】OBD系统有助于技师迅速诊断，对症修理，降低维修成本。</p>
<p>【1】、【3】、【8】、【11】、【12】、【13】厂家自定义</p>
<p>【2】SAE J1850 总线+ 【10】SAE J1850 总线﹣</p>
<p>【4】车身地 【5】信号地</p>
<p>【6】CAN-H 【14】CAN-L</p>
<p>【7】K-Line 【15】L-Line</p>
<p>【16】常电源</p>
<p><strong>故障码标准</strong></p>
<p>SAE J2010规定了一个5位标准故障代码，第1位是字母，后面4位是数字。</p>
<ol>
<li>首位字母表示设置故障码的系统。当前分配的字母有4个：“P”代表动力系统，“B”代表车身，“C”代表底盘，“u”代表未定义的系统。</li>
<li>第2位字符是0、1、2或3，意义如下：0-SAE(美国汽车工程师协会)定义的通用故障码：1-汽车厂家定义的扩展故障码；2或3-随系统字符(P，B，C或U)的不同而不同。动力系统故障码(P)的2或3由SAE留作将来使用；车身或底盘故障码的2为厂家保留，车身或底盘故障码的3由SAE保留。</li>
<li>第3位字符表示出故障的系统：1-燃油或空气计量故障；2-燃油或空气计量故障；3-点火故障或发动机缺火；4-辅助排放控制系统故障；5-汽车或怠速控制系统故障；6-电脑或输出电路故障。7-变速器控制系统；8-变速器控制系统。</li>
<li>最后两位字符表示触发故障码的条件。不同的传感器、执行器和电路分配了不同区段的数字，区段中较小的数字表示通用故障，即通用故障码；较大的数字表示扩展码，提供了更具体的信息，如电压低或高，响应慢，或信号超出范围。</li>
</ol>
</blockquote>
<p>常见的CAN通信速率有两种，一种是速度为500kbit&#x2F;s的高速CAN，用于控制ECU、ABS等；另一种是速度为125kbit&#x2F;s的低速CAN，用于控制仪表、防盗等。OBD-Ⅱ上诊断CAN的速率一般为500kbit&#x2F;s。</p>
<p>与OBD-Ⅱ上的CAN总线进行通信需要使用CAN总线分析仪（通常简称为CAN卡）。电脑连接CAN卡之后，可以接收和发送CAN报文。现在我们获取车辆的VIN码（Vehicle Identification Number，车架号）。获取车架号属于请求车辆信息，消息的长度为0x02，所属模式为09。在模式09中，获取车架号的信息类型编号为02。数据的长度没有超过0x07，使用单帧传输即可。使用SocketCAN发送以下消息获取车架号。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/599_02.jpg"
                      alt="599_02"
                ></p>
<p>车架号的长度为17个字符，采用多帧传输，返回的数据如下。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/599_03.jpg"
                      alt="599_03"
                ></p>
<p>首先解析多帧传输的数据，数据的长度为0x014。0x49表示对模式0x09的肯定响应，0x02表示后面的数据是车架号，接下来的31 47 31 4A 43 35 34 34 34 52 3732 35 32 33 36 37是车架号，转换为ASC II码后得到了17位的车架号<code>1G1JC5444R7252367</code>。</p>
<h2 id="UDS协议-1-讲"><a href="#UDS协议-1-讲" class="headerlink" title="UDS协议 1 讲"></a>UDS协议 1 讲</h2><p><strong>UDS（Unified Diagnostic Services，统一诊断服务）</strong>是诊断服务的规范化标准，位于OSI模型的应用层，它可以在多种总线（如CAN、LIN、以太网）上实现。在CAN总线实现的UDS诊断被称为<strong>UDSonCAN</strong>。</p>
<p>UDS中定义了一系列服务，包含六大类，一共26种。<strong>每种服务采用SID（Service IDentifier，服务标识符）进行标识</strong>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/600_01.jpg"
                      alt="600_01"
                ></p>
<p>UDS是一种交互式协议，采用<strong>请求应答模式</strong>。如果是肯定的响应，**回复[SID+0x40]<strong>；如果是否定的响应，回复</strong>7F SID以及一个字节的错误码(NRC)**。</p>
<h2 id="赛题：WDB-2020-Teslaaaaa"><a href="#赛题：WDB-2020-Teslaaaaa" class="headerlink" title="赛题：WDB_2020_Teslaaaaa"></a>赛题：WDB_2020_Teslaaaaa</h2><h3 id="总览"><a href="#总览" class="headerlink" title="总览"></a>总览</h3><p>有了ISO-TP和的UDS的基础知识后，我们再来看2020年网鼎杯的一道题目。此题出自青龙组，划归在MISC类别下，题目名称为Teslaaaaa，提示参考ISO 15765-2标准和ISO 14229-1标准。</p>
<p>下载<a class="link"   target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-259472.htm" >附件<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>后，解压得到一个名为<code>ecu_can_log.asc</code>的文件。ASC（ASCII Log File，文本日志文件）是Vector定义的用于记录总线日志的文件格式。ASC文件以文本形式记录汽车总线的数据流量，具备一定的可读性。可以使用开源工具Savvy CAN解析日志文件。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331142815558.png"
                      alt="image-20240331142815558"
                ></p>
<p>除了日志文件外，还有一张提示图片，从图片上可以看到正在使用电脑对ECU（Electronic Control Unit，电子控制单元）刷写固件，ECU芯片上标有ARM，表明处理器的架构为ARM。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/463990_GFK2CVP2Z4FK66X.png"
                      alt="463990_GFK2CVP2Z4FK66X"
                ></p>
<p>现在来看一下日志中的报文信息，从帧过滤中可以看到，日志文件中的CAN ID一共有3个，分别0x730、0x7B0以及0x7DF。分析报文信息，发现日志记录了ECU固件的刷写过程。下面详细分析日志中记录的刷写过程，把标记为“UDS Tester”的CAN卡简称为Tester。</p>
<h3 id="过程分析"><a href="#过程分析" class="headerlink" title="过程分析"></a>过程分析</h3><p>第一步，10 02诊断会话控制，请求进入编程会话。Tester发送请求进入编程会话，得到ECU的肯定应答。</p>
<blockquote>
<p>0x10  -&gt; 诊断会话控制</p>
<p>0x50 -&gt; 0x10(SID) + 0x40 -&gt; 肯定应答。</p>
</blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153256531.png"
                      alt="image-20240331153256531"
                ></p>
<p>第二步，27 05安全访问，请求种子。27服务是UDS的安全访问服务，05子功能表示请求安全校验种子。ECU收到请求种子的消息，返回种子0x1122334。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153310496.png"
                      alt="image-20240331153310496"
                ></p>
<p>第三步，27 06安全访问，发送密钥。使用第二步拿到种子 0x11223344，经过双方约定的算法计算得到密钥 EE DD CC BB，并通过27服务的06子功能发送密钥给ECU。ECU收到后与自己计算的密钥进行对比，如果相同则通过验证。从ECU的肯定应答中通过安全校验。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153331432.png"
                      alt="image-20240331153331432"
                ></p>
<p>第四步，31例程控制，请求擦除Flash。Tester给ECU发送了多帧数据 <code>31 01 FF 00 44 08 00 00 00 00 00 20 00</code>，0x44表示后面的地址和地址字宽都是4字节，后续表示Flash擦除的起始地址为0x08000000，大小为0x00002000字节。这两个地址在逆向分析时会用到。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153351432.png"
                      alt="image-20240331153351432"
                ></p>
<p>第五步，34 例程控制，请求下载。多帧数据 <code>34 00 44 08 00 00 00 00 00 20 00</code> 表示请求下载ECU固件到地址0x08000000处，大小为0x00002000字节。ECU回复肯定应答接收了下载请求。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153405231.png"
                      alt="image-20240331153405231"
                ></p>
<p>第六步，36 数据传输。传输数据的长度为0x00002000，每次多帧传输的数据量为0x80(0x82-0x02)，整个下载过程需要传输0x40(0x2000÷0x80)次。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331153231209.png"
                      alt="image-20240331153231209"
                ></p>
<p>第七步，37 01请求退出传输。Tester发送37服务，表示数据传输完成。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331154019747.png"
                      alt="image-20240331154019747"
                ></p>
<p>第八步，31 01 DF FF例程控制，厂商自定义功能。UDS标准中从0x0200到0xDFFF区间的RID（Routine IDentifier，例程标识符）保留给车企自定义使用。当前消息的RID为0xDFFF，属于车企定义功能，虽然不清楚具体用途，但也不影响解出此题。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331154209820.png"
                      alt="image-20240331154209820"
                ></p>
<p>第九步，31 01 FF 01例程控制，检查编程依赖。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331154310248.png"
                      alt="image-20240331154310248"
                ></p>
<p>第十步，11 01 ECU复位，请求重启ECU。ECU刷写完成之后，重启ECU，使新固件生效。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331154358016.png"
                      alt="image-20240331154358016"
                ></p>
<p>对整个通信过程进行分析后，发现可以划分为5个阶段。</p>
<ul>
<li>Tester向ECU请求进入编程会话。</li>
<li>进行安全验证，验证Tester的合法性。</li>
<li>请求数据下载，并传输固件所需的刷写参数。</li>
<li>Tester传输长度为0x2000的数据到ECU中，并刷写到地址0x08000000～0x08002000中。</li>
<li>重启ECU，刷入的新固件后生效。</li>
</ul>
<h3 id="数据提取"><a href="#数据提取" class="headerlink" title="数据提取"></a>数据提取</h3><div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">frame_len = <span class="number">0</span></span><br><span class="line">frame_data = <span class="string">&quot;&quot;</span></span><br><span class="line">handled_len = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;ecu_can_log.asc&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file.readlines():</span><br><span class="line">        data = re.findall(<span class="string">r&quot;730             Tx   d 8 10 (..) 36 .. (.. .. .. ..)&quot;</span>, line)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data):</span><br><span class="line">            <span class="comment"># print(data)</span></span><br><span class="line">            frame_len = <span class="built_in">int</span>(data[<span class="number">0</span>][<span class="number">0</span>], <span class="number">16</span>)</span><br><span class="line">            handled_len = <span class="number">6</span></span><br><span class="line">            frame_data += data[<span class="number">0</span>][<span class="number">1</span>] + <span class="string">&quot; &quot;</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        data = re.findall(<span class="string">r&quot;730             Tx   d 8 2(.) (.. .. .. .. .. .. ..)&quot;</span>, line)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data) <span class="keyword">and</span> frame_data:</span><br><span class="line">            <span class="comment"># print(data)</span></span><br><span class="line">            left_len = frame_len - handled_len</span><br><span class="line">            <span class="keyword">if</span> left_len &gt; <span class="number">7</span>:</span><br><span class="line">                frame_data += data[<span class="number">0</span>][<span class="number">1</span>] + <span class="string">&quot; &quot;</span></span><br><span class="line">                handled_len += <span class="number">7</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                frame_data += data[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>:left_len*-<span class="number">1</span>] + <span class="string">&quot; &quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.bin&quot;</span>, <span class="string">&quot;wb+&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="built_in">bytes</span>.fromhex(frame_data.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>)))</span><br></pre></td></tr></table></figure></div>

<h3 id="逆向分析"><a href="#逆向分析" class="headerlink" title="逆向分析"></a>逆向分析</h3><p>使用 <code>IDA</code> 加载文件，架构选择ARM小端序，通过符号引用找到关键函数。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331185355072.png"
                      alt="image-20240331185355072"
                ></p>
<div class="code-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __noreturn <span class="title">sub_8000290</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// r0</span></span><br><span class="line">  _BYTE v1[<span class="number">48</span>]; <span class="comment">// [sp+0h] [bp-30h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v0 = <span class="built_in">sub_800123E</span>(v1, <span class="number">48</span>);</span><br><span class="line">  <span class="built_in">sub_800033C</span>(v0);</span><br><span class="line">  <span class="built_in">sub_8000430</span>(<span class="number">1073821696</span>, <span class="string">&quot;Welcome challenger!\r\n&quot;</span>);</span><br><span class="line">  <span class="built_in">sub_8000430</span>(<span class="number">1073821696</span>, <span class="string">&quot;The flag is:\r\n&quot;</span>);</span><br><span class="line">  <span class="built_in">sub_8000168</span>(v1);</span><br><span class="line">  <span class="built_in">sub_8000430</span>(<span class="number">1073821696</span>, v1);</span><br><span class="line">  <span class="built_in">sub_8000430</span>(<span class="number">1073821696</span>, <span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">sub_8000168</span><span class="params">(_BYTE *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">char</span> v3[<span class="number">52</span>]; <span class="comment">// [sp+4h] [bp-34h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">sub_800120C</span>(v3, <span class="string">&quot;flag&#123;canoecr7-zd9h-1emi-or8m-f8vm2od81nfk&#125;&quot;</span>, <span class="number">44</span>);</span><br><span class="line">  <span class="built_in">sub_8001256</span>(a1, v3);</span><br><span class="line">  a1 += <span class="number">5</span>;</span><br><span class="line">  a1[<span class="number">2</span>] -= <span class="number">0xD</span>;</span><br><span class="line">  a1[<span class="number">11</span>] -= <span class="number">5</span>;</span><br><span class="line">  a1[<span class="number">15</span>] -= <span class="number">0x2C</span>;</span><br><span class="line">  a1[<span class="number">3</span>] -= <span class="number">0xB</span>;</span><br><span class="line">  a1[<span class="number">5</span>] -= <span class="number">0x30</span>;</span><br><span class="line">  a1[<span class="number">7</span>] += <span class="number">0x2B</span>;</span><br><span class="line">  a1[<span class="number">28</span>] += <span class="number">0x32</span>;</span><br><span class="line">  a1[<span class="number">31</span>] += <span class="number">0x2E</span>;</span><br><span class="line">  a1[<span class="number">19</span>] -= <span class="number">0xD</span>;</span><br><span class="line">  a1[<span class="number">20</span>] -= <span class="number">0x42</span>;</span><br><span class="line">  a1[<span class="number">1</span>] += <span class="number">3</span>;</span><br><span class="line">  a1[<span class="number">29</span>] -= <span class="number">0x37</span>;</span><br><span class="line">  a1[<span class="number">24</span>] -= <span class="number">0x33</span>;</span><br><span class="line">  a1[<span class="number">9</span>] -= <span class="number">0x17</span>;</span><br><span class="line">  a1[<span class="number">25</span>] -= <span class="number">6</span>;</span><br><span class="line">  a1[<span class="number">27</span>] -= <span class="number">0x3C</span>;</span><br><span class="line">  a1[<span class="number">4</span>] -= <span class="number">0x34</span>;</span><br><span class="line">  a1[<span class="number">6</span>] -= <span class="number">0xE</span>;</span><br><span class="line">  a1[<span class="number">30</span>] -= <span class="number">0x34</span>;</span><br><span class="line">  a1[<span class="number">22</span>] -= <span class="number">0x3A</span>;</span><br><span class="line">  a1[<span class="number">12</span>] -= <span class="number">0x30</span>;</span><br><span class="line">  a1[<span class="number">16</span>] -= <span class="number">0x38</span>;</span><br><span class="line">  a1[<span class="number">34</span>] -= <span class="number">0x35</span>;</span><br><span class="line">  *a1 -= <span class="number">0x30</span>;</span><br><span class="line">  a1[<span class="number">14</span>] += <span class="number">3</span>;</span><br><span class="line">  a1[<span class="number">17</span>] -= <span class="number">5</span>;</span><br><span class="line">  a1[<span class="number">33</span>] -= <span class="number">0x37</span>;</span><br><span class="line">  a1[<span class="number">35</span>] -= <span class="number">0x38</span>;</span><br><span class="line">  a1[<span class="number">10</span>] -= <span class="number">2</span>;</span><br><span class="line">  a1[<span class="number">26</span>] -= <span class="number">0x43</span>;</span><br><span class="line">  result = (<span class="type">unsigned</span> __int8)a1[<span class="number">21</span>] - <span class="number">6</span>;</span><br><span class="line">  a1[<span class="number">21</span>] = result;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>这个函数给出了flag，对原始flag进行了简单的加密。</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">temp=<span class="string">&quot;canoecr7-zd9h-1emi-or8m-f8vm2od81nfk&quot;</span></span><br><span class="line">v1=[]</span><br><span class="line">j=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> temp:</span><br><span class="line">    v1.append(<span class="built_in">ord</span>(i))</span><br><span class="line">    j+=<span class="number">1</span></span><br><span class="line">v1[<span class="number">2</span>] -= <span class="number">13</span></span><br><span class="line">v1[<span class="number">11</span>] -= <span class="number">5</span></span><br><span class="line">v1[<span class="number">15</span>] -= <span class="number">44</span></span><br><span class="line">v1[<span class="number">3</span>] -= <span class="number">11</span></span><br><span class="line">v1[<span class="number">5</span>] -= <span class="number">48</span></span><br><span class="line">v1[<span class="number">7</span>] += <span class="number">43</span></span><br><span class="line">v1[<span class="number">28</span>] += <span class="number">50</span></span><br><span class="line">v1[<span class="number">31</span>] += <span class="number">46</span></span><br><span class="line">v1[<span class="number">19</span>] -= <span class="number">13</span></span><br><span class="line">v1[<span class="number">20</span>] -= <span class="number">66</span></span><br><span class="line">v1[<span class="number">1</span>] += <span class="number">3</span></span><br><span class="line">v1[<span class="number">29</span>] -= <span class="number">55</span></span><br><span class="line">v1[<span class="number">24</span>] -= <span class="number">51</span></span><br><span class="line">v1[<span class="number">9</span>] -= <span class="number">23</span></span><br><span class="line">v1[<span class="number">25</span>] -= <span class="number">6</span></span><br><span class="line">v1[<span class="number">27</span>] -= <span class="number">60</span></span><br><span class="line">v1[<span class="number">4</span>] -= <span class="number">52</span></span><br><span class="line">v1[<span class="number">6</span>] -= <span class="number">14</span></span><br><span class="line">v1[<span class="number">30</span>] -= <span class="number">52</span></span><br><span class="line">v1[<span class="number">22</span>] -= <span class="number">58</span></span><br><span class="line">v1[<span class="number">12</span>] -= <span class="number">48</span></span><br><span class="line">v1[<span class="number">16</span>] -= <span class="number">56</span></span><br><span class="line">v1[<span class="number">34</span>] -= <span class="number">53</span></span><br><span class="line">v1[<span class="number">0</span>]-= <span class="number">48</span></span><br><span class="line">v1[<span class="number">14</span>] += <span class="number">3</span></span><br><span class="line">v1[<span class="number">17</span>] -= <span class="number">5</span></span><br><span class="line">v1[<span class="number">33</span>] -= <span class="number">55</span></span><br><span class="line">v1[<span class="number">35</span>] -= <span class="number">56</span></span><br><span class="line">v1[<span class="number">10</span>] -= <span class="number">2</span></span><br><span class="line">v1[<span class="number">26</span>] -= <span class="number">67</span></span><br><span class="line">flag=<span class="string">&quot;flag&#123;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v1:</span><br><span class="line">    flag+=<span class="built_in">chr</span>(i)</span><br><span class="line">flag+=<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240331193947062.png"
                      alt="image-20240331193947062"
                ></p>
<h2 id="CAN总线协议-2-讲"><a href="#CAN总线协议-2-讲" class="headerlink" title="CAN总线协议 2 讲"></a>CAN总线协议 2 讲</h2><h3 id="CAN-总线仲裁"><a href="#CAN-总线仲裁" class="headerlink" title="CAN 总线仲裁"></a>CAN 总线仲裁</h3><p>以CVVD首届车联网漏洞挖掘大赛一道题为例。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/607_01.jpg"
                      alt="607_01"
                ></p>
<p><strong>题目：</strong>汽车某一CAN网段上有3个ECU，分别是ECU1、ECU2、ECU3，各个ECU发出去的报文ID如上图所示，如果这3个ECU同时发出报文，请写出此时CAN网段上的报文ID，用十六进制表示。</p>
<p><strong>CAN 总线仲裁原理</strong></p>
<p>首先要了解CAN总线仲裁的原理，即CAN报文的优先级是通过对ID的仲裁来确定的。根据CAN协议的物理层我们知道，如果总线上同时出现显性电平和隐性电平，总线的状态会被置为显性电平，CAN正是利用这个特性进行仲裁的。对于CAN来说，0为显性，1为隐性。对不同的ID进行仲裁时，ID数值越小，优先级越高。</p>
<p>图中可以看到3个ECU发出去的报文ID，首先将ECU发出的信号转化为便于理解的ID。CAN ID的长度为11字节，属于标准帧的ID。ECU1发出的ID为1011000 1111(0x58F)，ECU2发出的ID为101 0011 0111(0x537)，ECU3发出的ID为101 0101 0011(0x553)。然后依据CAN总线仲裁机制（ID越小，优先级越高）得到CAN网段上的报文ID。3个CAN ID中，0x537最小，于是得到结果flag{0x537}</p>
<h2 id="ECU-回复响应码"><a href="#ECU-回复响应码" class="headerlink" title="ECU 回复响应码"></a>ECU 回复响应码</h2><p>此题也来自CVVD首届车联网漏洞挖掘大赛，主要考查对UDS协议的理解。</p>
<p><strong>题目：</strong>ECU不支持27服务的响应代码是多少？</p>
<p>27服务是UDS中定义的安全访问服务(Security Access)，通过种子与密钥的方式为ECU提供保护机制。本题考查第一阶段，对27服务请求访问的否定响应应答。通过查询UDS标准，在否定响应码定义和数值表中找到了服务不支持的值0x11，即得到flag{0x11}</p>
<h2 id="ISO-SAE-21434"><a href="#ISO-SAE-21434" class="headerlink" title="ISO&#x2F;SAE 21434"></a>ISO&#x2F;SAE 21434</h2><p><strong>题目：</strong>对于ISO&#x2F;SAE 21434中的工作产出、集成和验证报告，是下列哪一节的产出内容？</p>
<p>A.验证阶段 B.运维阶段 C.生产阶段 D.产品开发阶段</p>
<p>ISO&#x2F;SAE 21434《道路车辆-网络安全工程》标准是基于SAE J3061《信息物理汽车系统网络安全指南》制定的针对车辆生命周期的标准，主要从风险评估管理、产品开发、运行&#x2F;维护、流程审核等4个方面保障汽车信息安全工程工作，目标是使设计、生产、测试的产品具备一定的信息安全防护能力。</p>
<p>ISO&#x2F;SAE 21434标准基于V模型的总体思路，覆盖了汽车电子研发和制造相关领域的核心开发活动过程，主要涵盖安全管理、基于项目的网络安全管理、持续的网络安全活动、相关风险评估方法以及道路车辆概念验证阶段、产品开发阶段和开发完成后阶段的网络安全。</p>
<p>ISO&#x2F;SAE 21434中产品开发阶段包括系统、硬件和软件开发，集成与验证位于该标准的10.4.2节，此节属于产品开发阶段，于是得到flag{D}。</p>
<h2 id="WP29-R155和R156"><a href="#WP29-R155和R156" class="headerlink" title="WP29 R155和R156"></a>WP29 R155和R156</h2><p><strong>题目：</strong>WP29颁布法规中对未授权用户能够获取车辆系统权限给出的应对措施的编号是什么？</p>
<p>WP29的全称为联合国世界车辆法规协调论坛，2020年6月，WP29通过了R155法规和R156法规。R155主要分为网络安全管理体系认证（CSMS认证）和车辆型式审批两部分。CSMS认证主要审查原始设备制造商是否建立了涵盖汽车全生命周期的网络安全相关体系，以确保汽车全生命周期都有对应的流程和措施。车辆型式审批则是确保原始设备制造商开发的汽车网络安全架构及防护方案在进行审查认证时满足基本要求。R156主要从流程体系与技术需求上对软件更新提出要求。流程体系方面的要求是建立软件更新管理体系(SUMS)，主要由软件更新一般流程要求、软件更新记录存储要求及软件更新的安全流程要求三部分构成。技术需求包括通用软件更新要求及OTA附加要求。R155和R156法规于2021年1月起生效。</p>
<p>我国也在积极推进车联网法律法规的建设。2020年11月，国家市场监督管理总局发出了《关于进一步加强汽车远程升级(OTA)技术召回监管的通知》，首次提出了OTA召回的概念，要求车企在实施OTA召回计划时，向国家市场监督管理总局备案。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/609_01.jpg"
                      alt="609_01"
                ></p>
<p>根据WP29 R155标准中的附录表格，可知对未授权用户能够获取车辆系统权限给出的应对措施的编号是M9，那么flag就是flag{M9}。</p>
<h1 id="线下实车漏洞挖掘"><a href="#线下实车漏洞挖掘" class="headerlink" title="线下实车漏洞挖掘"></a>线下实车漏洞挖掘</h1><p>在车联网安全竞赛的线下决赛中，一般会有对实车的漏洞挖掘。时间较短，只有短短的数小时时间，若没有指定车型漏洞的积累，短时间内很难挖掘到优质漏洞。实车漏洞挖掘主要集中于CAN总线（OBD-Ⅱ接口）、车机以及TBOX等。</p>
<h2 id="CAN总线漏洞挖掘"><a href="#CAN总线漏洞挖掘" class="headerlink" title="CAN总线漏洞挖掘"></a>CAN总线漏洞挖掘</h2><p>比赛中CAN总线的接口一般为OBD-Ⅱ。需要提前准备OBD-Ⅱ公头开口线、一分二转接线延长线、CAN通信卡以及汽车诊断仪等。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/609_02.jpg"
                      alt="609_02"
                ></p>
<p>常见的题目包括信息读取、功能指令逆向等。信息读取指的是向CAN总线发送诊断报文，获取ECU的特定信息，如确定车内ECU的数量，并列出ECU的诊断响应ID。发送诊断报文开始拓展会话诊断控制，如图所示。ECU收到之后回复肯定响应(50 03)，回应的CAN ID就是此题需要的诊断响应ID。</p>
<p>功能指令逆向指的是对鸣嗽叭、车门、车窗等功能的CAN报文逆向。在没有进行CAN网络隔离的车辆中，由于CAN报文广播的特征，在OBD-Ⅱ接口处可以监听所有的CAN报文。以对鸣喇叭指令的逆向为例，首先使用CAN通信卡监听OBD-Ⅱ接口的CAN消息，然后按下汽车喇叭的控制开关使汽车鸣喇叭，接着分析这段CAN报文，找出其中的鸣喇叭报文。接收到的报文往往比较多，可以通过一些技巧来缩小分析范围。首先统计相同报文出现的次数，去掉重复的报文。然后按照功能操作（如按喇叭）的频次过滤出可能的报文。最后通过折半查找等方法重放报文，找到可以让车辆鸣喇叭的报文。</p>
<h2 id="车机漏洞挖掘"><a href="#车机漏洞挖掘" class="headerlink" title="车机漏洞挖掘"></a>车机漏洞挖掘</h2><p>由于时间限制，现场实车的车机漏洞挖掘测试往往不会太深入。在参赛之前，需要做好收集情报工作。例如，预测比赛使用的汽车品牌及车型，比赛一般使用国产电动汽车，车型一般是最近推出的，下面介绍如何确定参赛用车的品牌。</p>
<p>站在主办方的角度，测试某车企的车辆需要拿到相应的授权，一般为了方便沟通，通常会与本地的车企合作。例如：比赛在重庆举办，使用长安汽车的概率就比较高；在北京比赛，使用北汽旗下的车辆的可能性就比较高。除此之外，还可以根据赛事的合作伙伴来推测，赛事合作伙伴中的车企极有可能是参赛用车的提供方。</p>
<p>知道汽车品牌后，需要分析车型，某些赛事在参赛之前会用车衣遮挡车辆，并用赛事标签遮挡车辆Logo。这也难不倒善于信息收集的安全研究员，首先观察车的外形轮廓，确定车辆是轿车还是SUV，然后再通过其他信息判断具体车型。</p>
<p>知道车型后，需要在互联网上搜索工程模式、任意应用安装等信息，从中找到接入车机的入口，包括ADB调试接口、USB任意应用安装等。ADB调试接口一般使用USB TYPE-A双公头线，线材需要赛前提前准备。此外U盘、Wi-Fi网卡、SDR设备也是必备的。</p>
<p>收集到情报后，在比赛现场的实车上实践。根据掌握到的信息，扩大影响范围，找到更多的漏洞。以下是一些常见的漏洞点。</p>
<p><strong>(1)工程模式</strong></p>
<p>工程模式是厂商隐藏的高级功能，用于调试维护车机。部分车型可从工程模式中打开调试接口、导出日志等。如果工程模式没有使用密码等保护机制，我们很容易进入工程模式，那么这也是一个具有较高威胁系数的安全威胁。在工程模式中导出日志到U盘中，分析导出的日志中是否包含敏感信息，如用户通讯录、进程信息、TSP平台信息等。</p>
<p><strong>(2)流量分析</strong></p>
<p>首先搭建Wi-Fi热点让车机连接，然后使用Wireshark抓包，最后分析明文传输的流量信息，从中寻找敏感信息和漏洞。依据流量信息，向上分析发现TSP平台的漏洞，如管理后台弱口令、MQTT未授权访问等；向下分析发现车机端的漏洞，如任意应用安装等。</p>
<p>接入车辆提供的Wi-Fi热点，扫描端口挖掘服务漏洞。多数车型的热点是由车机共享的，但也有少部分是由TBOX发出的。通过技巧可以区分热点是由车机还是TBOX发出的，扫描53(DNS)端口，如果DNS端口开放，那么此热点极有可能是TBOX发出的。</p>
<p><strong>(3)系统漏洞挖掘</strong></p>
<p>拿到车机的权限后需要进行进一步的漏洞挖掘。可以测试的点包括命令注入、敏感信息检索（如私钥、云存储token等）、用户权限提升、分析车辆控制逻辑实现远程控制效果等。实车自由漏洞挖掘比拼的是相同时间内发现的漏洞数量和质量。比赛中团队的协作很重要，合理搭配队伍并提前分工，各自发挥特长，分别挖掘车联网中存在的漏洞。</p>
<p>一般而言，精通CTF竞赛的选手对车联网安全不太了解，无法解答与车联网高度相关的题目；对于车联网安全研究员来说，一般从事于车联网漏洞挖掘、安全合规测试等工作，参与的CTF比赛较少。通过合理搭配CTF选手和车联网安全研究员，往往能够获得更好的成绩。</p>
<h1 id="实战篇"><a href="#实战篇" class="headerlink" title="实战篇"></a>实战篇</h1><p>通过竞赛了解一定的基础概念以后再来看实战篇。</p>
<h1 id="CAN通信总线安全"><a href="#CAN通信总线安全" class="headerlink" title="CAN通信总线安全"></a>CAN通信总线安全</h1><h2 id="CAN总线协议-3-讲"><a href="#CAN总线协议-3-讲" class="headerlink" title="CAN总线协议 3 讲"></a>CAN总线协议 3 讲</h2><p>CAN 是控制器局域网络（Controller Area Network）的简称，是实现汽车所有或部分部件之间通信的中枢神经系统，由以研发和生产汽车电子产品著称的德国 BOSCH 公司开发并最终成为国际标准（ISO 11898），是国际上应用最广泛的现场总线之一。在使用 CAN 作为车内通信系统之前，汽车制造商使用的是点对点布线系统，当汽车内部电子单元越来越多时，这种布线系统会显得特别庞大且维护成本太高，后来通过使用 CAN 代替来解决这个问题。</p>
<p>简单来说，CAN 可以让汽车上的各个电子单元相互通信、共享数据，提出 CAN 的主要原因是它允许多个 ECU（Electronic Control Unit，电子控制单元）共用一根导线进行通信。在一辆现代汽车中存在多达 70 个 ECU，例如：发动机控制单元、安全气囊、变速箱、齿轮单元、防抱死制动系统（ABS）、信息娱乐系统、气候控制系统、车窗、车门等部件，为了让这些单元之间能够相互通信，点对点布线会显得特别庞大。试想一下，每一个组件都连接到其它全部组件，对于后期故障诊断和排除来说是相当糟糕的，但是有了 CAN 就可以用单线代替，每个元件之间的通信就简单了许多。CAN总线通常采用屏蔽或非屏蔽的双绞线，总线接口能在极其恶劣的环境下工作。根据ISO 11898的标准建议，即使双绞线中有一根断路，总线都必须能继续工作。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/f4xo4980f5.png"
                      alt="f4xo4980f5"
                ></p>
<p>CAN 总线可以被认为是一个嘈杂、拥挤、慢速版的以太网局域网，只是流量是 UDP 而不是 TCP。值得注意的是，并不是所有的汽车控制系统都使用 CAN，而且 CAN 不仅仅是汽车系统中使用的通信协议，还可能有其它协议，如蓝牙、GSM&#x2F;LTE 蜂窝网络、卫星无线电、LIN（Local  Interconnect Network）等。在实际场景中，CAN 并不是唯一的攻击面，可能还存在很多其它的攻击面。</p>
<h2 id="CAN总线特性"><a href="#CAN总线特性" class="headerlink" title="CAN总线特性"></a>CAN总线特性</h2><p>安全性：CAN是低级协议，不支持任何内在的安全功能。在标准的CAN中也没有加密，使得网络数据能被截取。在大多数应用中，应用程序需要部署自己的安全机制，例如认证传入命令或网络上某些设备的存在。若不执行适当的安全措施，其他人可能设法在总线上插入消息。尽管一些安全关键功能（如修改固件，编程键或控制防抱死制动）存在密码，但这些系统并未普遍实施，并且密钥对的数量有限。</p>
<ul>
<li><strong>通信机制：</strong>多主机，即每个节点都有接入总线的能力</li>
<li><strong>寻址机制：</strong>消息区别，不设节点的地址，通过消息的标志符来区别消息。</li>
<li><strong>帧类型：</strong>数据帧、远程帧、错误帧、超载帧、帧间隔</li>
<li><strong>攻击方式：</strong>应用报文模糊攻击、DOS攻击测试、重放攻击</li>
</ul>
<p>由于CAN总线上的数据包没有进行过任何的加密处理，因此这些数据包是能够被截取窃听。由于车载网络使用CAN协议进行通信，所以我们可以联想到车联功能也是通过CAN网络进行数据发送和交换。</p>
<h2 id="CAN总线的工作"><a href="#CAN总线的工作" class="headerlink" title="CAN总线的工作"></a><strong>CAN总线的工作</strong></h2><p>一辆汽车可以有多个节点，能够发送或接收报文，这个报文基本上由一个 ID 组成，它的优先级，也可以包含 CAN 报文，一次可以是 8 个字节或更少。如果两个或两个以上的节点同时开始发送报文，那么以主导 ID 发送的报文将覆盖依次主导 ID 发送的报文，这就是所谓的基于优先级的总线仲裁。ID 数值越小的报文优先级越高，这就是节点判断报文传输先后的依据。来自制动器的报文比来自音频播放器的报文具有更高的优先级。</p>
<ol>
<li>CAN运行在两条线路上：CAN高电平（CANHI）和CAN低电平（CANLO）。</li>
<li>CAN bus 有四种帧类型。</li>
</ol>
<table>
<thead>
<tr>
<th>帧类型</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>数据帧（Data Frame）</td>
<td>包含要传输的节点数据的帧</td>
</tr>
<tr>
<td>远程帧（Remote Frame）</td>
<td>请求传输特定标识符的帧</td>
</tr>
<tr>
<td>错误帧（Remote Frame）</td>
<td>任何检测到错误的节点发送的帧</td>
</tr>
<tr>
<td>重载帧（Overload Frame）</td>
<td>在数据或远程帧之间插入延迟的帧</td>
</tr>
</tbody></table>
<p>CAN有两种类型的消息(帧)格式：标准（基础）帧格式和扩展帧格式。<strong>标准（基础）帧有11位标识符，扩展帧格式有29位标识符</strong>。CAN标准帧格式和CAN扩展帧格式之间的区别是通过使用IDE位进行的，IDE位在11位帧的情况下以显性方式传输，而在29位帧的情况下以隐性方式进行传输。支持扩展帧格式消息的CAN控制器也能够以CAN基本帧格式发送和接收消息。CAN 总线由两根不同的导线组成，由于它是总线，因此这些导线可以连接到多个设备。</p>
<h3 id="标准帧格式"><a href="#标准帧格式" class="headerlink" title="标准帧格式"></a>标准帧格式</h3><p> 说一下主要的4个元素，其他的大家感兴趣可自行去了解：</p>
<ul>
<li><strong>仲裁ID（Arbitration ID）：</strong>仲裁ID是一种广播消息，用来识别正视图通信的设备的ID，其实也代表发送消息的地址。任何的设备都可以发送多个仲裁ID。在总线中同时发送的消息，低仲裁ID的消息拥有优先权。</li>
<li><strong>标识符扩展（IDE）：</strong>标准帧格式该位始终是0。</li>
<li><strong>数据长度码（DLC）：</strong>表示数据的大小，番位是0字节到8字节。</li>
<li><strong>数据（Data）：</strong>总线传输数据本身。一个标准的数据帧可携带最大尺寸为8字节。有些系统中会强制要求8字节，不满8字节则填充为8字节。</li>
</ul>
<p>下面来看看 CAN 数据帧的结构：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/bu7tn39qb3.png"
                      alt="bu7tn39qb3"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/fwp8mkt3cu.png"
                      alt="fwp8mkt3cu"
                ></p>
<h3 id="扩展帧格式"><a href="#扩展帧格式" class="headerlink" title="扩展帧格式"></a>扩展帧格式</h3><p>扩展帧格式与标准帧格式类似，扩展帧格式可以连接在一起，形成更长的ID。拓展帧格式可包含标准帧格式。拓展帧格式的标识符扩展IDE被设置为1。扩展帧有一个18位的标识符，是标准的11位标识符的第二部分。</p>
<h3 id="实车上访问-CAN-总线"><a href="#实车上访问-CAN-总线" class="headerlink" title="实车上访问 CAN 总线"></a><strong>实车上访问 CAN 总线</strong></h3><p>为了访问汽车的 CAN 总线，需要先访问车载自诊断端口，也就是 OBD。虽然可能存在数以百计的其它诊断标准或者端口，但基本上现在所有汽车都使用的 OBD-Ⅱ，这也正是修车修理工用来识别汽车故障的途径，OBD 是最直接访问 CAN 的，找到 OBD-Ⅱ 的方法非常简单，它通常位于乘客座椅或者驾驶员座椅附近，且不用使用螺丝刀就能访问。</p>
<p>这就是 OBD 的具体样子：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/7hwmq6zlnd.png"
                      alt="7hwmq6zlnd"
                ></p>
<p>如果您想知道 OBD 的引脚，下面是 OBD 端口的引脚：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/4ie6pezxot.png"
                      alt="4ie6pezxot"
                ></p>
<p><strong>通过 OBD 访问 CAN 所需的硬件和软件</strong></p>
<p>因为电脑不能直接与 CAN 连接，为了与 CAN 总线交互，需要类似 USB 转 CAN 的工具，通过 USB 连接到 OBD-II 端口，这样就可以发送或接收 CAN 数据包。同时在软件上需要一些能够读取或写入 CAN 数据包以及编码或解码 CAN 数据包的工具。</p>
<p><strong>硬件</strong></p>
<p>连接 OBD-II 所需的硬件可以很容易地在市场上找到，有昂贵以及廉价的硬件设备。高端设备包括 Kvaser 和 EMS，这些设备价格昂贵且矫枉过正，性价比很高的组合是 USB2CAN 和原生的 Linux 系统。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/hu51i7fqty.png"
                      alt="hu51i7fqty"
                ></p>
<p>另外，很多时候会遇到 ELM327，它是一个基于蓝牙的设备，但对于黑客来说是非常糟糕的，原因是它的数据速率比较慢，最后会丢失很多数据包。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/7f5kwghitc.png"
                      alt="7f5kwghitc"
                ></p>
<p>Macchina M2 是一个开源的汽车接口，可以通过 OBD-II 与 CAN 总线通信。Macchina M2 最大的优点是它是模块化的，也就是说可以在 Macchina M2 的基础上增加 WiFi、GSM、LTE、BLE 模块。Macchina M2 有 2 个 CAN 通道。Macchina M2 还具有 LIN，可以通过访问<a class="link"   target="_blank" rel="noopener" href="https://www.macchina.cc/catalog/m2-boards/m2-under-dash" >链接<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>获取更多关于 Macchina M2 的信息。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/e9jazcja12.png"
                      alt="e9jazcja12"
                ></p>
<p>另一个低成本的选择是 CSS 电子公司的 CLX000，它可以记录和流式传输 CAN 数据，数据可以在免费的开源软件 Wireshark 中可视化，一个插件便可以实现逆向功能，CLX000 是可视化和远程信息处理的理想选择。</p>
<p>可以通过访问<a class="link"   target="_blank" rel="noopener" href="https://www.csselectronics.com/screen/page/reverse-engineering-can-bus-messages-with-wireshark/language/en" >链接<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>获取更多关于 CLX000 的信息，在一些博客中也有一些关于 CAN 的文章。</p>
<p><strong>软件</strong></p>
<p>在软件方面，Linux 内核中内置了 SocketCAN、can-utils、vcan，它们的作用是发送和接收 CAN 数据包，对数据进行编码或解码，也可以通过 Wireshark 分析 CAN 数据包。</p>
<p>如果想了解更多关于 CAN 操作的知识，而又不想破坏自己的汽车，<a class="link"   target="_blank" rel="noopener" href="https://github.com/zombieCraig/ICSim" >ICSim<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 将会是首选工具。</p>
<h2 id="CAN模拟环境搭建"><a href="#CAN模拟环境搭建" class="headerlink" title="CAN模拟环境搭建"></a>CAN模拟环境搭建</h2><h3 id="安装ICSim"><a href="#安装ICSim" class="headerlink" title="安装ICSim"></a>安装ICSim</h3><p>安装依赖</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装依赖</span></span><br><span class="line">sudo apt install libsdl2-dev libsdl2-image-dev can-utils maven autoconf -y</span><br><span class="line"><span class="comment"># 下载ICSim</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zombieCraig/ICSim.git</span><br><span class="line"><span class="comment"># 编译安装</span></span><br><span class="line"><span class="built_in">cd</span> ICSim/</span><br><span class="line">sudo make</span><br></pre></td></tr></table></figure></div>

<h3 id="安装socketcand"><a href="#安装socketcand" class="headerlink" title="安装socketcand"></a>安装socketcand</h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载socketcand</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/linux-can/socketcand.git</span><br><span class="line"><span class="built_in">cd</span> socketcand</span><br><span class="line"><span class="comment"># First run to create the &#x27;configure&#x27; script.</span></span><br><span class="line">./autogen.sh</span><br><span class="line"><span class="comment"># Then run the created script with</span></span><br><span class="line">./configure</span><br><span class="line"><span class="comment"># install</span></span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure></div>

<h3 id="安装Kayak"><a href="#安装Kayak" class="headerlink" title="安装Kayak"></a>安装Kayak</h3><p><strong>可选，原作者已于2020年起放弃维护</strong></p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/dschanoeh/Kayak.git</span><br><span class="line"><span class="comment"># 安装jdk</span></span><br><span class="line">sudo apt-get install openjdk-8-jdk</span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line"><span class="built_in">cd</span> Kayak</span><br><span class="line">mvn clean package</span><br></pre></td></tr></table></figure></div>

<h3 id="开始模拟"><a href="#开始模拟" class="headerlink" title="开始模拟"></a>开始模拟</h3><p><strong>准备虚拟 CAN 网络</strong></p>
<p>进入 ICSim 目录，执行有一个名为 <code>setup_vcan.sh</code> 的 shell 脚本：</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="comment"># cat setup_vcan.sh </span></span><br><span class="line"><span class="comment"># 加载 CAN 的内核模块以及虚拟 CAN 的内核模块：</span></span><br><span class="line">sudo modprobe can</span><br><span class="line">sudo modprobe vcan</span><br><span class="line"><span class="comment"># 接下来设置虚拟接口：</span></span><br><span class="line">sudo ip <span class="built_in">link</span> add dev vcan0 <span class="built_in">type</span> vcan</span><br><span class="line">sudo ip <span class="built_in">link</span> <span class="built_in">set</span> up vcan0</span><br></pre></td></tr></table></figure></div>

<p>modprobe 命令是用来加载内核模块，比如 can 和 vcan 模块，最后两行将创建一个 vcan0 接口以便模拟汽车网络。</p>
<div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">└─# ifconfig vcan0</span><br><span class="line">vcan0: flags=193&lt;UP,RUNNING,NOARP&gt;  mtu 72</span><br><span class="line">        unspec 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  txqueuelen 1000  (UNSPEC)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure></div>

<p><strong>运行 ICSim</strong></p>
<p>运行 ICSim 至少需要两个组件，一个仪表盘和一个控制器，用来模拟加速、刹车、控制车门、转向灯等，需要至少 3 个终端窗口或标签来运行仪表盘、控制器和 can-utils。</p>
<p><strong>运行仪表盘和控制器</strong></p>
<div class="code-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">为了运行仪表盘，需要运行一个名为 icsim 的文件，参数为 vcan0，也就是之前创建的接口。</span></span><br><span class="line">./icsim vcan0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">此时仪表盘无法正常工作，这是因为接口 vcn0 上没有流量，为了模拟接口 vcan0 上的流量，这里需要启动控制器。</span></span><br><span class="line">./controls vcan0</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240320200538213.png"
                      alt="image-20240320200538213"
                ></p>
<p><strong>控制器操作仪表盘</strong></p>
<p>vcan0 是一个虚拟的 CAN 接口，ICSim 将通过它来发送和接收 CAN 帧，当启动控制面板时，可以观察到车速表有一些波动，这是因为控制面板模拟了噪声，启动控制面板后，便可以使用键盘来模拟流量。</p>
<table>
<thead>
<tr>
<th align="left">行为</th>
<th align="left">快捷键</th>
</tr>
</thead>
<tbody><tr>
<td align="left">加速</td>
<td align="left">↑</td>
</tr>
<tr>
<td align="left">左右转向</td>
<td align="left">←&#x2F;→</td>
</tr>
<tr>
<td align="left">解锁前左右车门</td>
<td align="left">Right-Shift + A&#x2F;B</td>
</tr>
<tr>
<td align="left">解锁后左右车门</td>
<td align="left">Right-Shift + X&#x2F;Y</td>
</tr>
<tr>
<td align="left">锁定全部车门</td>
<td align="left">Right-Shift + Left-Shift</td>
</tr>
<tr>
<td align="left">解锁全部车门</td>
<td align="left">Left-Shift + Right-Shift</td>
</tr>
</tbody></table>
<h3 id="Savvycan"><a href="#Savvycan" class="headerlink" title="Savvycan"></a>Savvycan</h3><p><a class="link"   target="_blank" rel="noopener" href="https://github.com/collin80/SavvyCAN/releases/" >下载链接<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>Savvycan 也可以用来分析can帧，使用起来也是很简单方便。</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection-&gt;Open Connection Window-&gt;Add New Device Connection</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240322141442922.png"
                      alt="image-20240322141442922"
                ></p>
<p>然后便可以看到 CAN 流量。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240322141806604.png"
                      alt="image-20240322141806604"
                ></p>
<h2 id="CAN总线操作"><a href="#CAN总线操作" class="headerlink" title="CAN总线操作"></a>CAN总线操作</h2><p>虚拟 CAN 接口设置成功后就可以在这个接口中发送或接收 CAN 数据包了，接下来使用 can-utils 中的一个叫做 cangen 的工具来生成虚拟的 CAN 数据包。cangen 可以生成用于测试的 CAN 帧，要使用 cangen 需要指定要生成 CAN 帧的接口，这里 vcan0 是创建的虚拟 CAN 接口：</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="comment"># cangen vcan0</span></span><br></pre></td></tr></table></figure></div>

<p><strong>wireshark</strong></p>
<p>生成 CAN 帧后，有很多工具可以查看 CAN 帧的内容，这里以 Wireshark 举例。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240321151824810.png"
                      alt="image-20240321151824810"
                ></p>
<p><strong>can-utils</strong></p>
<p>另外，可以选择使用 can-utils 提供的工具，比如 cansniffer 和 candump，它们的功能和 Wireshark 差不多。</p>
<p>可以使用 candump 转储或记录 CAN 帧：</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="comment"># candump vcan0                             </span></span><br><span class="line">  vcan0  183   [8]  00 00 00 06 00 00 10 32</span><br><span class="line">  vcan0  143   [4]  6B 6B 00 FF</span><br><span class="line">  vcan0  095   [8]  80 00 07 F4 00 00 00 26</span><br><span class="line">  vcan0  166   [4]  D0 32 00 36</span><br><span class="line">  vcan0  158   [8]  00 00 00 00 00 00 00 37</span><br><span class="line">  vcan0  161   [8]  00 00 05 50 01 08 00 3A</span><br><span class="line">  vcan0  191   [7]  01 00 10 A1 41 00 29</span><br><span class="line">  vcan0  164   [8]  00 00 C0 1A A8 00 00 22</span><br><span class="line">  vcan0  133   [5]  00 00 00 00 89</span><br><span class="line">  vcan0  136   [8]  00 02 00 00 00 00 00 0C</span><br><span class="line">  vcan0  13A   [8]  00 00 00 00 00 00 00 0A</span><br><span class="line">  vcan0  13F   [8]  00 00 00 05 00 00 00 00</span><br><span class="line">  vcan0  17C   [8]  00 00 00 00 10 00 00 03</span><br><span class="line">  vcan0  18E   [3]  00 00 4D</span><br><span class="line">  vcan0  1CF   [6]  80 05 00 00 00 2D</span><br><span class="line">  vcan0  1DC   [4]  02 00 00 2A</span><br><span class="line">  vcan0  183   [8]  00 00 00 0C 00 00 10 0F</span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>

<p>上面正在运行的 cangen 生成 CAN 帧，上面的终端正在运行 candump 记录 CAN 帧，记录的 CAN 帧可以分为四列，第一列是 CAN 接口，第二列是仲裁 ID，第三列是 CAN 数据的大小，第四列是数据本身。</p>
<h2 id="CAN总线威胁"><a href="#CAN总线威胁" class="headerlink" title="CAN总线威胁"></a>CAN总线威胁</h2><p>根据CAN总线的特性，我们则可以了解CAN面临的威胁：</p>
<ol>
<li>CAN总线通信是广播的方式，所以数据是可以被监听和获取的。</li>
<li>CAN总线协议中ID代表报文优先级，协议中没有原始地址信息。也就是说任何人都可以伪造和发送虚假或恶意的报文。</li>
</ol>
<p>另外拒绝服务攻击在CAN总线协议中也是存在的。但是我们主要是分析和逆向CAN总线。</p>
<h3 id="重放攻击"><a href="#重放攻击" class="headerlink" title="重放攻击"></a>重放攻击</h3><p><strong>candump</strong></p>
<p>candump 可以转储 CAN 帧，如果想进行重放攻击，需要先转储 CAN 帧，然后使用 canplayer 对转储的 CAN 帧进行重放，CAN 帧的转储可以使用 -l 参数启动：</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="comment"># candump -l vcan0</span></span><br><span class="line">Disabled standard output <span class="keyword">while</span> logging.</span><br><span class="line">Enabling Logfile <span class="string">&#x27;candump-2024-03-21_155205.log&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>使用 candump 转储 CAN 帧时，会创建一个以 candump 为前缀和日期命令的文件，如果想查看转储文件的内容，可以在 Linux 中使用 cat 命令查看：</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="comment"># cat candump-2024-03-21_155205.log</span></span><br><span class="line">(1711007525.799440) vcan0 1CF<span class="comment">#80050000003C</span></span><br><span class="line">(1711007525.799476) vcan0 244<span class="comment">#00000001A8</span></span><br><span class="line">(1711007525.799479) vcan0 1DC<span class="comment">#02000039</span></span><br><span class="line">(1711007525.799481) vcan0 320<span class="comment">#000030</span></span><br><span class="line">(1711007525.799483) vcan0 324<span class="comment">#7465000000000E38</span></span><br><span class="line">(1711007525.799485) vcan0 183<span class="comment">#0000000900001020</span></span><br><span class="line">(1711007525.799487) vcan0 37C<span class="comment">#FD00FD00097F0038</span></span><br><span class="line">(1711007525.799489) vcan0 039<span class="comment">#002A</span></span><br><span class="line">(1711007525.799491) vcan0 40C<span class="comment">#0000000004000013</span></span><br><span class="line">(1711007525.799492) vcan0 454<span class="comment">#23EF18</span></span><br><span class="line">(1711007525.799494) vcan0 143<span class="comment">#6B6B00E0</span></span><br><span class="line">(1711007525.799496) vcan0 095<span class="comment">#800007F800000013</span></span><br><span class="line">(1711007525.800548) vcan0 1A4<span class="comment">#0000000800000010</span></span><br><span class="line">(1711007525.800566) vcan0 1AA<span class="comment">#7FFF000000006810</span></span><br><span class="line">(1711007525.800570) vcan0 1B0<span class="comment">#000F0000000157</span></span><br><span class="line">(1711007525.800573) vcan0 1D0<span class="comment">#000000000000000A</span></span><br><span class="line">(1711007525.802955) vcan0 166<span class="comment">#D0320027</span></span><br></pre></td></tr></table></figure></div>

<p>括号内的是时间戳，vcan0为我们的虚拟can接口。后面的是ID和数据，ID和数据以#号分割。</p>
<p>candump是监听并记录原始数据，会有很多对我们无用的数据。can-utils工具包中还有一款可以根据仲裁ID进行分组显示，并对变化的数据以红色显示，它就是cansniffer。cansniffer 是用于嗅探 CAN 数据包的工具。cansniffer 的 -c 参数可以通过颜色高亮突出变化的字节，当需要判断执行某些操作是否会导致 CAN 数据变化时使用。</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="comment"># cansniffer -c vcan0</span></span><br><span class="line">00|ms | ID  | data ...     &lt; vcan0 <span class="comment"># l=20 h=100 t=500 slots=1 &gt;</span></span><br><span class="line">99999 | 039 | 00 0C                   ..</span><br><span class="line">01|ms | ID  | data ...     &lt; vcan0 <span class="comment"># l=20 h=100 t=500 slots=33 &gt;</span></span><br><span class="line">00019 | 039 | 00 1B                   ..</span><br><span class="line">00011 | 095 | 80 00 07 F4 00 00 00 17 ........</span><br><span class="line">00010 | 133 | 00 00 00 00 B6          .....</span><br><span class="line">00009 | 136 | 00 02 00 00 00 00 00 39 .......9</span><br><span class="line">00009 | 13A | 00 00 00 00 00 00 00 37 .......7</span><br><span class="line">00010 | 13F | 00 00 00 05 00 00 00 3D .......=</span><br><span class="line">00011 | 143 | 6B 6B 00 E0             kk..</span><br><span class="line">00010 | 158 | 00 00 00 00 00 00 00 28 .......(</span><br><span class="line">00010 | 161 | 00 00 05 50 01 08 00 2B ...P...+</span><br><span class="line">00010 | 164 | 00 00 C0 1A A9 00 00 12 ........</span><br><span class="line">00010 | 166 | D0 32 00 27             .2.<span class="string">&#x27;</span></span><br><span class="line"><span class="string">00010 | 17C | 00 00 00 00 10 00 00 30 .......0</span></span><br><span class="line"><span class="string">00010 | 183 | 00 00 00 13 00 00 10 34 .......4</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure></div>

<p><strong>cansniffer</strong></p>
<p>cansniffer 可以通过仲裁 ID 进行过滤，当需要只显示某一个特定仲裁 ID 的帧时，只需在嗅探的过程中，按减号（-）然后输入  000000，再按 Enter 键清除所有的帧，按加号（+）然后输入仲裁 ID，再按 Enter 键便只显示特定仲裁 ID 的帧。</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-000000</span><br><span class="line">+133</span><br><span class="line">+244</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240321160059927.png"
                      alt="image-20240321160059927"
                ></p>
<p><strong>canplayer</strong></p>
<p>顾名思义，canplayer 是用来重放 CAN 帧的工具。理想情况下，当必须进行重放攻击时，首先需要转储或记录 CAN 帧，然后使用 canplayer 对 CAN 帧进行重放。在进行重放攻击前需要打开 ICSim，这个时候会在 cansnifer 工具中看到 CAN 帧的变化，在使用<code>candump -l vcan0</code>转储 CAN 帧的同时在控制器对仪表盘进行操作，例如：加速、转向，然后停止转储，将会看到创建了一个 candump-XXXXX.log 命名的文件，接下来使用<code>canplayer -I candump-XXXXX.log</code>对转储的 CAN 帧进行重放，将会在仪表盘中看到转储时进行的操作。</p>
<p>想象一个场景，希望对转速表进行欺骗，但是却不知道转速表的读数在哪个仲裁 ID 上工作，这种情况需要先用 candump 的 -l 参数转储 CAN 帧数，然后用 canplayer 重放转储的 CAN 帧，使用 canplayer 重放 CAN 帧时需要通过 -I 参数来接受输入文件：</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">canplayer -I candump-2024-03-21_160543.log</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240321161352222.png"
                      alt="image-20240321161352222"
                ></p>
<p>canplayer 还有一些其它非常好用的参数，可以通过<code>man canplayer</code>获取。</p>
<h3 id="转储-CAN-帧分析"><a href="#转储-CAN-帧分析" class="headerlink" title="转储 CAN 帧分析"></a><strong>转储 CAN 帧分析</strong></h3><p>在真实的汽车中，CAN 总线的噪音可能会大很多，且 CAN 帧出现速度也会快很多，所以如何识别出关键的仲裁 ID 是一个难题，这里列出三种方法：二分法，统计法，观察法，推荐使用统计法。</p>
<p><strong>二分法</strong></p>
<p>将转储的 CAN 帧文件一分为二，然后分别重放观察哪一个文件包含了关键的仲裁 ID，然后对相应的文件再进行操作，依次循环。</p>
<ol>
<li><p>首先通过candump监听数据。</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">candump -l vcan0</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>回到控制器界面，进行开门锁操作，然后在关闭车门锁。</p>
</li>
<li><p>停止监听数据。数据保存到执行<code>mv candump-2020-06-22_140718.log source</code> (文件名根据实际情况修改)</p>
</li>
<li><p>关车门锁操作，执行<code>canplayer -I source</code> 重放数据。确认车门锁是否开启。如果没有，请重复上面的步骤。</p>
</li>
<li><p>输入 <code>wc -l source</code> 命令查看文件行数。笔者这里结果为11407行。</p>
</li>
<li><p>输入 <code>split -l 6000 source c1</code> 将source文件分成两个文件。</p>
</li>
<li><p>使用canplayer重放两个分割后的文件，查看重放的哪个文件打开来车门锁。每次重放前都要执行 <code>canplayer -I source</code>。主要是保证每次重放分割的文件前车门锁是关闭的。</p>
</li>
<li><p>根据第6和7的步骤对包含重放命令的文件进行。这里要注意每次split命令分割的行数减少1倍。例如第二次执行的名为 <code>split -l 3000 c1aa c2</code> 。重放命令为 <code>canplayer -I c2aa</code>和<code>canplayer -I c2ab</code>。这样一直重复知道发现最终的数据包。</p>
</li>
</ol>
<p>经过上面的重复，在13ab的文件中定位到来了ID值和发送的数据。使用 <code>cansend vcan0 19B#00000E000000</code> 进行验证。打开车门锁成功。</p>
<p><strong>统计法</strong></p>
<p>以仲裁 ID 或仲裁 ID 和 CAN 数据为依据，统计出 CAN 帧文件各仲裁 ID 或仲裁 ID 和 CAN 数据出现的次数，根据出现的此处进行判断。对于一些只有在进行操作时才会产生的动作，可以通过选择特定的次数，对其发送的次数进行筛选。</p>
<ol>
<li>使用 <code>candump -l vcan0</code> 捕获数据包。</li>
<li>在控制器界面中操作5次车门锁操作。</li>
<li>停止 candump。获得保存文件，这里为<code>candump-2020-06-22_151059.log</code>。</li>
<li>通过编写好的脚本，运行 <code>python3 can.py candump-2020-06-22_151059.log</code>获得结果</li>
</ol>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*- </span></span><br><span class="line">can_log_file = <span class="built_in">input</span>(<span class="string">&quot;file name:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">can_info</span>:</span><br><span class="line">    ID = <span class="string">&quot;&quot;</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">can_list = []</span><br><span class="line">data_dict = &#123;&#125;</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="built_in">str</span>(can_log_file), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file: </span><br><span class="line">    content = file.readlines()</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> content:</span><br><span class="line">        idx = item.find(<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">        can_ID = item[idx-<span class="number">3</span>:idx]</span><br><span class="line">        can_data = item[idx+<span class="number">1</span>:]</span><br><span class="line">        </span><br><span class="line">        flag = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> elem <span class="keyword">in</span> can_list:</span><br><span class="line">            <span class="keyword">if</span> elem.ID == can_ID:</span><br><span class="line">                elem.count = elem.count + <span class="number">1</span></span><br><span class="line">                data_dict[can_ID].append(can_data)</span><br><span class="line">                flag = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">            ci = can_info()</span><br><span class="line">            ci.ID = can_ID</span><br><span class="line">            ci.count = ci.count + <span class="number">1</span></span><br><span class="line">            data_dict[can_ID] = []</span><br><span class="line">            data_dict[can_ID].append(can_data)</span><br><span class="line">            can_list.append(ci)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> can_list:</span><br><span class="line">        <span class="built_in">print</span>(item.ID + <span class="string">&quot; : &quot;</span> + <span class="built_in">str</span>(item.count))</span><br><span class="line"></span><br><span class="line">    can_id = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;can_id:&quot;</span>))</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> can_list:</span><br><span class="line">        <span class="keyword">if</span> item.ID == can_id:</span><br><span class="line">            <span class="keyword">for</span> elem <span class="keyword">in</span> data_dict[can_id]:</span><br><span class="line">                <span class="built_in">print</span>(elem, end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<p>运行一下：</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="comment"># python3 can_wc.py                          </span></span><br><span class="line">file name:candump-2024-03-21_165147.log</span><br><span class="line">244 : 1046</span><br><span class="line">095 : 1333</span><br><span class="line">166 : 1332</span><br><span class="line">158 : 1332</span><br><span class="line">161 : 1332</span><br><span class="line">191 : 1332</span><br><span class="line">133 : 1332</span><br><span class="line">136 : 1332</span><br><span class="line">13A : 1332</span><br><span class="line">13F : 1332</span><br><span class="line">164 : 1332</span><br><span class="line">17C : 1332</span><br><span class="line">18E : 1332</span><br><span class="line">1CF : 666</span><br><span class="line">039 : 880</span><br><span class="line">1DC : 666</span><br><span class="line">320 : 136</span><br><span class="line">324 : 136</span><br><span class="line">37C : 136</span><br><span class="line">40C : 46</span><br><span class="line">183 : 1332</span><br><span class="line">454 : 46</span><br><span class="line">143 : 1332</span><br><span class="line">1A4 : 666</span><br><span class="line">1AA : 661</span><br><span class="line">1B0 : 661</span><br><span class="line">1D0 : 661</span><br><span class="line">294 : 331</span><br><span class="line">21E : 331</span><br><span class="line">305 : 127</span><br><span class="line">309 : 135</span><br><span class="line">428 : 45</span><br><span class="line">405 : 45</span><br><span class="line">333 : 130</span><br><span class="line">188 : 26</span><br><span class="line">5A1 : 12</span><br><span class="line">19B : 10</span><br><span class="line">can_id:19B</span><br><span class="line">00000B000000</span><br><span class="line">00000F000000</span><br><span class="line">00000B000000</span><br><span class="line">00000F000000</span><br><span class="line">00000B000000</span><br><span class="line">00000F000000</span><br><span class="line">00000B000000</span><br><span class="line">00000F000000</span><br><span class="line">00000B000000</span><br><span class="line">00000F000000</span><br></pre></td></tr></table></figure></div>

<p>观察发现19B，较为可能是开门和关门的can数据帧。找到19B相关的数据帧。</p>
<div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="comment"># cat candump-2024-03-21_165147.log | grep 19B#        </span></span><br><span class="line">(1711011109.292333) vcan0 19B<span class="comment">#00000B000000</span></span><br><span class="line">(1711011110.165507) vcan0 19B<span class="comment">#00000F000000</span></span><br><span class="line">(1711011111.107797) vcan0 19B<span class="comment">#00000B000000</span></span><br><span class="line">(1711011111.878506) vcan0 19B<span class="comment">#00000F000000</span></span><br><span class="line">(1711011112.849585) vcan0 19B<span class="comment">#00000B000000</span></span><br><span class="line">(1711011113.615873) vcan0 19B<span class="comment">#00000F000000</span></span><br><span class="line">(1711011114.435582) vcan0 19B<span class="comment">#00000B000000</span></span><br><span class="line">(1711011115.148119) vcan0 19B<span class="comment">#00000F000000</span></span><br><span class="line">(1711011116.077156) vcan0 19B<span class="comment">#00000B000000</span></span><br><span class="line">(1711011116.881887) vcan0 19B<span class="comment">#00000F000000</span></span><br><span class="line">└─<span class="comment"># cat candump-2024-03-21_165147.log | grep 19B# &gt; 1.log</span></span><br><span class="line">└─<span class="comment"># canplayer -I 1.log </span></span><br></pre></td></tr></table></figure></div>

<p>成功开关车门。</p>
<p><strong>观察法</strong></p>
<p>在控制器界面按下左键，模拟器界面左转向灯闪了一下，观察cansniffer界面数据变化，在左转向灯闪时（也就是按下左键时），看哪一个值变了又变会原值，并保持原值。最终定位ID值为188。现在在进行另外一个例子，在汽车加速过程中，转速表是一直在上升。这就可以通过观察哪一个值是在持续上升的。这里通过控制器界面，按住上方向键，观察哪一个值是在持续增加的。最终定位ID值为244。可以通过 cansend 来进行验证，是否成功。</p>
<h2 id="Savvycan的使用"><a href="#Savvycan的使用" class="headerlink" title="Savvycan的使用"></a>Savvycan的使用</h2><p>有时间再细研究。</p>
<h3 id="重放攻击-1"><a href="#重放攻击-1" class="headerlink" title="重放攻击"></a><strong>重放攻击</strong></h3><p>使用 SavvyCAN 执行重放攻击要容易得多，在 Send Frames 中选择 Playback，可以从文件加载数据或直接从捕获的数据加载数据，还可以从 ID 筛选菜单中选择要重播的 ID。</p>
<h3 id="识别仲裁-ID"><a href="#识别仲裁-ID" class="headerlink" title="识别仲裁 ID"></a><strong>识别仲裁 ID</strong></h3><p>SavvyCAN 提供了许多逆向工具，其中经常使用的是 Sniffer，它能够弹出非活动字节，通过二分法过滤仲裁 ID 便可以快速识别出关键的仲裁 ID。</p>
<h3 id="发送自定义帧"><a href="#发送自定义帧" class="headerlink" title="发送自定义帧"></a><strong>发送自定义帧</strong></h3><p>SavvyCAN 还有一个非常实用的功能，在 Send Frames 中选择 Custom，它能够发送自定义的帧并可以实时修改。</p>
<h3 id="Fuzzing"><a href="#Fuzzing" class="headerlink" title="Fuzzing"></a><strong>Fuzzing</strong></h3><p>SavvyCAN 还有一个非常酷的功能，在 Send Frames 中选择 Fuzzing，它能够非常容易的对 CAN 帧进行 fuzzing。</p>
<h2 id="建议阅读"><a href="#建议阅读" class="headerlink" title="建议阅读"></a>建议阅读</h2><p>zh1chu 师傅写的几篇文章。</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://forum.butian.net/share/2651" >[zh1chu] 汽车CAN总线-01 介绍<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://forum.butian.net/share/2652" >[zh1chu] 汽车CAN总线-02 共计<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://forum.butian.net/share/2653" >[zh1chu] 汽车CAN总线-03 测试方法演示<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<h1 id="TBOX-安全"><a href="#TBOX-安全" class="headerlink" title="TBOX 安全"></a>TBOX 安全</h1><h2 id="TBOX-安全威胁"><a href="#TBOX-安全威胁" class="headerlink" title="TBOX 安全威胁"></a>TBOX 安全威胁</h2><p>TBOX承担着与外部通信的重要工作，其重要性不言而喻。TBOX往往也是攻击者的首先目标，以下是TBOX面临的一些威胁系数较高的安全威胁。</p>
<h3 id="硬件调试接口威胁"><a href="#硬件调试接口威胁" class="headerlink" title="硬件调试接口威胁"></a>硬件调试接口威胁</h3><p>TBOX一般会预留调试接口，若调试接口缺乏健壮的授权访问认证，攻击者就能通过调试接口获取系统的访问控制权，进一步挖掘系统中存在的安全隐患。</p>
<h3 id="固件提取威胁"><a href="#固件提取威胁" class="headerlink" title="固件提取威胁"></a>固件提取威胁</h3><p>固件是安全研究极其重要的内容，固件提取也显得尤为重要。IoT设备通常可以通过多种方式获取固件，如官方网站下载、网络升级捕获、调试接口获取、编程器读取等。由于TBOX相对比较封闭，因此很多常规的方法都无法使用。最直接的方法是从硬件设备上提取，将存储芯片拆卸下来，从提取出的固件中，可以获得私钥、硬编码口令等敏感信息，并发现其中的安全问题。</p>
<h3 id="车联网服务平台威胁"><a href="#车联网服务平台威胁" class="headerlink" title="车联网服务平台威胁"></a>车联网服务平台威胁</h3><p>TBOX中的车联网服务多采用双向认证机制，若TBOX被攻破，攻击者可以伪装成TBOX向云端发起攻击。TBOX多接入专用的APN网络，同网络中的网络设备往往比较脆弱。控制TBOX并接入APN后，会给车企内部网络带来不确定的安全威胁。</p>
<h3 id="公网暴露"><a href="#公网暴露" class="headerlink" title="公网暴露"></a>公网暴露</h3><p>部分TBOX暴露在公网中，存在较高的安全威胁。特别是开放了Telnet等服务的TBOX，如C4MAX-3GNA。使用Shodan搜索C4MAX-3GNA。C4MAX-3GNA开启了Telnet服务，任何人都可以连接且无须认证。连接后，可以修改TBOX的运行参数、追踪车辆行驶路径。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/10/25/%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E4%B8%93%E9%A2%98/image-20240416210758021.png"
                      alt="image-20240416210758021"
                ></p>
<h3 id="CAN总线"><a href="#CAN总线" class="headerlink" title="CAN总线"></a>CAN总线</h3><p>TBOX是车辆CAN总线网络中重要的节点，用于实现远程诊断、远程控制等功能。移动应用程序对车辆的控制（如空调调节、车门开关等）通过TBOX的CAN接口下发给指定的ECU处理。若TBOX的CAN接口被非法控制，甚至会影响到车辆行驶安全。特别是在FOTA(Firmware Over-The-Air)应用场景中，对ECU升级流程进行逆向分析之后，通过替换网关或其他ECU的固件可以实现控制整车ECU。</p>
<h3 id="协议安全"><a href="#协议安全" class="headerlink" title="协议安全"></a>协议安全</h3><p>TBOX中除了常见的HTTP、FTP等协议外，还有一些专有协议，如GB&#x2F;T 32960.3、JT&#x2F;T 808等。按照国家监管要求，电动汽车的数据首先上传到企业平台，然后逐级转发到新能源国家检测平台。通信数据格式采用GB&#x2F;T 32960.3标准。JT&#x2F;T 808标准规定了道路运输车辆卫星定位系统车载终端与监管&#x2F;监控平台之间的通信协议与数据格式。在使用GB&#x2F;T 32960.3、JT&#x2F;T 808或其他私有协议时，若未正确使用，可能造成用户隐私泄露，还会将企业资产暴露在安全威胁之下。</p>
<h1 id="车机安全"><a href="#车机安全" class="headerlink" title="车机安全"></a>车机安全</h1><p>车载信息娱乐系统(In-Vehicle Infotainment, IVI)又称车机、中控屏、导航屏，用于实现人与车之间的信息交互。车机从早期功能简单的CD、DVD、导航发展至今，信息化、智能化程度越来越高。车机是整车当中人机交互接口最多的部件，因而攻击点最多，安全威胁风险系数较高。</p>
<h2 id="车机安全威胁"><a href="#车机安全威胁" class="headerlink" title="车机安全威胁"></a>车机安全威胁</h2><h3 id="不安全的外部接口"><a href="#不安全的外部接口" class="headerlink" title="不安全的外部接口"></a>不安全的外部接口</h3><p>利用外部接口攻击车机，如USB接口、串口、CAN总线等。硬件方面，主板上可能预留有调试接口、UART串口等。通过调试接口进入车机的操作系统做进一步的分析，可以寻找潜在的安全威胁。预留给用户使用的接口通常只有USB接口，采用Android系统的车机的USB接口也常作为调试接口使用。在某车机中多次点击系统版本号可以进入工程模式。在工程模式中开启USB调试，ADB连接之后，发现系统以Root权限运行，可见该车机缺乏基本防护。</p>
<h3 id="不恰当的工程模式"><a href="#不恰当的工程模式" class="headerlink" title="不恰当的工程模式"></a>不恰当的工程模式</h3><p>部分车机的隐藏菜单——工程模式存在三方面问题。第一，多数车机的工程模式入口未应用严格的访问授权机制，未授权用户很容易进入车机的工程模式。第二，工程模式中预制功能的权限过大（如开启ADB调试等），可能将车机暴露在攻击者的视野之下。第三，大部分车机可以在工程模式下导出日志，日志中可能含有敏感信息，如进程信息、车机与服务端通信异常信息等。</p>
<h3 id="隐私问题"><a href="#隐私问题" class="headerlink" title="隐私问题"></a>隐私问题</h3><p>某些车型工程模式中导出的日志包含个人通讯录。导出用户个人通讯录明显不符合《汽车数据安全管理若干规定（试行）》的要求，用户的个人隐私应得到充分的保护和尊重，企业在收集数据时应做到合理合规。</p>
<h3 id="通过通信信道对车辆数据或代码进行篡改、删除等"><a href="#通过通信信道对车辆数据或代码进行篡改、删除等" class="headerlink" title="通过通信信道对车辆数据或代码进行篡改、删除等"></a>通过通信信道对车辆数据或代码进行篡改、删除等</h3><p>Wi-Fi、蓝牙等无线协议存在缺陷，成功利用后可实现任意代码执行，如腾讯科恩实验室发现Tesla Model S使用的Marvell无线芯片驱动存在堆溢出漏洞。另外，如果通信信道中重要数据的传输未进行加密，也容易被监听或遭受中间人攻击。</p>
<h3 id="控制第三方软件"><a href="#控制第三方软件" class="headerlink" title="控制第三方软件"></a>控制第三方软件</h3><p>车机上有着为数不少的第三方软件，如导航软件、音乐软件等。第三方应用程序的安全也会影响车机系统的安全。利用信息娱乐应用攻击车辆系统，可导致供应链级别的攻击风险。</p>
<h3 id="滥用或损害软件更新过程"><a href="#滥用或损害软件更新过程" class="headerlink" title="滥用或损害软件更新过程"></a>滥用或损害软件更新过程</h3><p>在OTA更新过程中引入恶意软件，可以实现对系统的非法接入。</p>
<h1 id="充电桩安全"><a href="#充电桩安全" class="headerlink" title="充电桩安全"></a>充电桩安全</h1><p>随着新能源汽车的高速发展，作为新能源汽车网络重要组成部分的充电桩也得到了快速的发展。各大公共充电基础设施运营商纷纷加快建站抢占市场，各家的安全防范能力参差不齐，而电力作为新能源汽车的主要动力来源，直接关系到大众的出行安全。在研究充电桩安全之前，我们首先了解充电桩的结构，然后分析充电桩存在的安全隐患。</p>
<h2 id="充电桩安全威胁"><a href="#充电桩安全威胁" class="headerlink" title="充电桩安全威胁"></a>充电桩安全威胁</h2><p>充电桩安全风险主要体现在以下几方面：一是硬件调试接口保护不到位，降低了攻击者的分析难度；二是厂商开发对各种服务没有进行严格的保护，可能被攻击者利用作为攻击的入口；三是软件开发部署时缺乏安全方面的考虑，容易被攻击者利用，对充电设置、主站以及运营平台构成安全威胁。充电桩体本身潜在的攻击漏洞如下。</p>
<ul>
<li>针对充电桩调试接口的攻击漏洞：暴露调试接口、易于提取固件、篡改存储介质、获取普通用户权限、权限提升等。</li>
<li>针对开放服务的攻击漏洞：FTP（File Transfer Protocol，文件传输协议）未授权访问、FTP弱口令、SSH（Secure SHell，安全外壳协议）弱口令等。</li>
<li>针对固件的攻击漏洞：获取敏感数据、获取硬编码密码、逆向加密算法、获取敏感API接口、固件降级植入后门等。</li>
<li>针对内存的攻击漏洞：获取内存中的敏感数据（如用户名、密码）、加密Key等。</li>
<li>针对CPU卡的攻击漏洞：通过监听串口数据，获取用户卡片加密密码等。</li>
<li>针对BMS通信协议的攻击漏洞：发送伪造的充电报文，伪装其他用户充电等。</li>
<li>针对通信协议的攻击漏洞：如充电桩与主站之间采用MQTT物联网通信协议，MQTT拥有相对的安全认证体系，但在使用时可能存在配置不当的情况。使用MQTT可能存在的安全威胁有未授权访问、中间人攻击等。</li>
</ul>
<h1 id="OTA-安全"><a href="#OTA-安全" class="headerlink" title="OTA 安全"></a>OTA 安全</h1><p><a class="link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/676247259" >参考链接<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>近年来，汽车远程服务、在线升级（OTA）平台、车辆调度平台等业务服务快速发展，用户的规模逐步扩大，日渐成为网络攻击的重要目标。由于车端用户可通过车联网平台进行信息交互、远程操作，一旦遭受网络攻击控制，可被利用实施对车辆的远程操控，造成严重后果。</p>
<p>当前，联网车辆数量和通信需求不断增长。在“车-云”通信场景下，网络隔离不到位、通信协议存在漏洞隐患、访问接入缺乏安全认证等问题突出。“车-设备”通信场景下，受限于设备性能等因素，通信安全认证机制尚不完善，存在拒绝服务攻击等漏洞隐患，可导致 WiFi、蓝牙、智能钥匙失效。</p>
<p>在 OTA 功能实现过程中，云端、车端、通信链路、升级包等关键环节均存在被攻击和篡改等安全隐患。</p>
<h2 id="数据风险"><a href="#数据风险" class="headerlink" title="数据风险"></a>数据风险</h2><p>汽车 OTA 带来对已售车型大量应用服务的数据井喷，还面临在保证用户个人信息安全的前提下，企业如何实施数据利用共享，OTA 相关数据如何跨境流通等问题。这些安全风险都对企业的合规管理与创新发展提出新的要求。</p>
<p><strong>用户隐私信息泄漏风险</strong></p>
<p>汽车远程升级整个过程中涉及到云端服务器安全、车端安全、车云通信安全，也关系到生产者、用户及汽车软件供应商等其他主体之间的数据收集、数据传输等多个处理环节。在这些过程之中如果存在网络攻击风险，可能导致 OTA 系统遭受破坏，不法分子可以通过 OTA  系统窥探到用户的隐私信息，如车辆位置、行车路线等行为习惯。同时，第三方应用平台可能存在非法获取其他应用和车载端数据的风险。</p>
<p><strong>数据出境合规风险</strong></p>
<p>随着系列政策文件均提出汽车产生的个人信息和重要数据出境管理要求，智  能网联汽车作为重点监管对象，产生的大量数据为数据跨境管理带来新的风险。对跨国企业而言，涉及技术研发的数据免不了出境或远程跨国访问，若分布于各国的数据只能本地存储而无法出境交互，将动摇跨国车企一直以来采取的开发、维护、集中化管理模式，导致车企需重新对一国市场进行单独资源调配，建立和总部一致的技术团队，成本不可估量[18]。因此在车辆售出后， 面对远程升级需要的软件版本号、升级包名称、升级时间等决定功能实现的数据如何合法地出境流动仍然存在管理规定不明晰带来的风险。</p>
<h2 id="功能风险"><a href="#功能风险" class="headerlink" title="功能风险"></a>功能风险</h2><p>当涉及车辆核心功能如动力、制动和电池管理系统等模块的远程升级时，可能对车辆的功能安全带来新的挑战，升级后的系统将车辆与驾驶人暴露在未知的危险中。OTA 功能安全风险可举例为：</p>
<p><strong>车端升级条件判断不当导致的安全风险</strong></p>
<p>车辆远程升级是一个比较长的过程，而且升级过程中车辆大部分功能可能无法正常使用，所以一般都要求车辆在P档、电池电量充足等一定条件下才能进行。如果车辆对于升级条件的判断存在问题，可能导致在非预想的情况下触发升级事件，对车辆和车内人员人身安全造成威胁。</p>
<p><strong>车端升级失败导致的车辆功能不可用</strong></p>
<p>在车辆升级过程中可能出现断电等异常情况导致升级失败的情况，如果没有对升级失败的情况进行妥善的容灾处理，可能导致车辆无法启动，甚至零部件损坏等严重事件。</p>
<p><strong>OTA 升级软件自身缺陷导致的风险</strong></p>
<p>软件更新后未进行充分验证和测试就直接部署到车辆上，软件自身的缺陷可能会使软件运行出现意外行为，导致系统崩溃、触发车辆失控等安全事故。</p>
<p><strong>软件不兼容风险</strong></p>
<p>在车辆升级过程中，升级软件可能引入新的功能和接口，如果车辆硬件不支<br>持或不兼容，可能导致升级后系统无法正常工作，造成行车安全隐患。</p>
<p>为应对上述 OTA 安全风险，总体来说，在云平台端可采用证书，签名和加密机制，负责为 OTA  服务平台提供安全服务，包括密钥证书管理服务，数据加密服务，数字签名服务等，保证升级包不会随意被制作和发布，升级包的内容不会被恶意获取。在通信链路端，可通过可靠的物理链路和安全传输协议来保证网络传输安全。在车端，可通过汽车的功能域隔离，划分不同 ASIL 等级，通过冗余设计保证整车的功能可靠性；车辆终端 OTA  组件对升级包进行合法性验证，适配安全升级流程，通过安全启动来保证可信的软件在 ECU 上加载启动运行。</p>

		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> 车联网安全专题</li>
        <li><strong>Author:</strong> 韩乔落</li>
        <li><strong>Created at
                :</strong> 2023-10-25 15:48:36</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2024-12-13 17:46:47
            </li>
        
        <li>
            <strong>Link:</strong> https://jelasin.github.io/2023/10/25/车联网安全专题/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

		</div>
		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/%E6%99%BA%E8%83%BD%E6%B1%BD%E8%BD%A6%E5%AE%89%E5%85%A8/">#智能汽车安全</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2023/10/30/AI%E5%AE%89%E5%85%A8%E7%A0%94%E4%B9%A0/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">AI安全研习</span>
						<span class="post-nav-item">Prev posts</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2023/10/24/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">密码学笔记</span>
						<span class="post-nav-item">Next posts</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
		<div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
			<div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        Comments
    </div>
    

        
            
    <div id="giscus-container"></div>
    <script data-swup-reload-script defer>
        async function loadGiscus() {
            const giscusConfig = {
                'src': 'https://giscus.app/client.js',
                'data-repo': 'jelasin/jelasin.github.io',
                'data-repo-id': 'R_kgDOKVydDA',
                'data-category': 'Announcements',
                'data-category-id': 'DIC_kwDOKVydDM4CZe2W',
                'data-mapping': 'pathname',
                'data-strict': '0',
                'data-reactions-enabled': '1',
                'data-emit-metadata': '1',
                'data-theme': 'preferred_color_scheme',
                'data-lang': 'zh-CN',
                'data-input-position': 'bottom',
                'data-loading': 'not-lazy',
                'crossorigin': 'anonymous',
                'async': true
            }
            const giscusScript = document.createElement('script');
            for (const key in giscusConfig) {
                giscusScript.setAttribute(key, giscusConfig[key]);
            }
            document.getElementById('giscus-container').appendChild(giscusScript);
        }
        if ('true') {
            let loadGiscusTimeout = setTimeout(() => {
                loadGiscus();
                clearTimeout(loadGiscusTimeout);
            }, 1000);
        } else {
            document.addEventListener('DOMContentLoaded', loadGiscus);
        }
    </script>


        
        
    
</div>

		</div>
		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">On this page</div>
		<div class="page-title">车联网安全专题</div>
		<ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%AF%87"><span class="nav-text">基础篇</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E8%81%94%E6%B1%BD%E8%BD%A6"><span class="nav-text">网联汽车</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#V2X%E9%80%9A%E4%BF%A1"><span class="nav-text">V2X通信</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E8%BE%85%E5%8A%A9%E9%A9%BE%E9%A9%B6%E7%B3%BB%E7%BB%9F%EF%BC%88ADAS%EF%BC%89"><span class="nav-text">高级辅助驾驶系统（ADAS）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TBOX"><span class="nav-text">TBOX</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%A6%E6%9C%BA"><span class="nav-text">车机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%85%E7%94%B5%E6%A1%A9"><span class="nav-text">充电桩</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IVI"><span class="nav-text">IVI</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ECU"><span class="nav-text">ECU</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CAN"><span class="nav-text">CAN</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LIN"><span class="nav-text">LIN</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MOST"><span class="nav-text">MOST</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FlexRay"><span class="nav-text">FlexRay</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ethernet%EF%BC%9A"><span class="nav-text">Ethernet：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ASec"><span class="nav-text">ASec</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GW"><span class="nav-text">GW</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BMS"><span class="nav-text">BMS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%A6%E8%81%94%E7%BD%91%E6%94%BB%E5%87%BB%E9%9D%A2"><span class="nav-text">车联网攻击面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%A6%E8%81%94%E7%BD%91%E5%90%88%E8%A7%84%E8%A6%81%E6%B1%82"><span class="nav-text">车联网合规要求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%A6%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E9%9D%A2%E6%A3%80%E6%B5%8B"><span class="nav-text">车联网安全面检测</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AB%9E%E8%B5%9B%E7%AF%87"><span class="nav-text">竞赛篇</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%BF%E4%B8%8A%E8%B5%9B"><span class="nav-text">线上赛</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#CAN%E6%80%BB%E7%BA%BF%E5%8D%8F%E8%AE%AE-1-%E8%AE%B2"><span class="nav-text">CAN总线协议 1 讲</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ISO-TP%E5%8D%8F%E8%AE%AE-1-%E8%AE%B2"><span class="nav-text">ISO-TP协议 1 讲</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SAE-J1979%E5%8D%8F%E8%AE%AE-1-%E8%AE%B2"><span class="nav-text">SAE J1979协议 1 讲</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UDS%E5%8D%8F%E8%AE%AE-1-%E8%AE%B2"><span class="nav-text">UDS协议 1 讲</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B5%9B%E9%A2%98%EF%BC%9AWDB-2020-Teslaaaaa"><span class="nav-text">赛题：WDB_2020_Teslaaaaa</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E8%A7%88"><span class="nav-text">总览</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90"><span class="nav-text">过程分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96"><span class="nav-text">数据提取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%86%E5%90%91%E5%88%86%E6%9E%90"><span class="nav-text">逆向分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CAN%E6%80%BB%E7%BA%BF%E5%8D%8F%E8%AE%AE-2-%E8%AE%B2"><span class="nav-text">CAN总线协议 2 讲</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CAN-%E6%80%BB%E7%BA%BF%E4%BB%B2%E8%A3%81"><span class="nav-text">CAN 总线仲裁</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ECU-%E5%9B%9E%E5%A4%8D%E5%93%8D%E5%BA%94%E7%A0%81"><span class="nav-text">ECU 回复响应码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ISO-SAE-21434"><span class="nav-text">ISO&#x2F;SAE 21434</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WP29-R155%E5%92%8CR156"><span class="nav-text">WP29 R155和R156</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%BF%E4%B8%8B%E5%AE%9E%E8%BD%A6%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><span class="nav-text">线下实车漏洞挖掘</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#CAN%E6%80%BB%E7%BA%BF%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><span class="nav-text">CAN总线漏洞挖掘</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%A6%E6%9C%BA%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><span class="nav-text">车机漏洞挖掘</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%E7%AF%87"><span class="nav-text">实战篇</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CAN%E9%80%9A%E4%BF%A1%E6%80%BB%E7%BA%BF%E5%AE%89%E5%85%A8"><span class="nav-text">CAN通信总线安全</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#CAN%E6%80%BB%E7%BA%BF%E5%8D%8F%E8%AE%AE-3-%E8%AE%B2"><span class="nav-text">CAN总线协议 3 讲</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CAN%E6%80%BB%E7%BA%BF%E7%89%B9%E6%80%A7"><span class="nav-text">CAN总线特性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CAN%E6%80%BB%E7%BA%BF%E7%9A%84%E5%B7%A5%E4%BD%9C"><span class="nav-text">CAN总线的工作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%87%E5%87%86%E5%B8%A7%E6%A0%BC%E5%BC%8F"><span class="nav-text">标准帧格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A9%E5%B1%95%E5%B8%A7%E6%A0%BC%E5%BC%8F"><span class="nav-text">扩展帧格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E8%BD%A6%E4%B8%8A%E8%AE%BF%E9%97%AE-CAN-%E6%80%BB%E7%BA%BF"><span class="nav-text">实车上访问 CAN 总线</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CAN%E6%A8%A1%E6%8B%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-text">CAN模拟环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85ICSim"><span class="nav-text">安装ICSim</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85socketcand"><span class="nav-text">安装socketcand</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Kayak"><span class="nav-text">安装Kayak</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E5%A7%8B%E6%A8%A1%E6%8B%9F"><span class="nav-text">开始模拟</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Savvycan"><span class="nav-text">Savvycan</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CAN%E6%80%BB%E7%BA%BF%E6%93%8D%E4%BD%9C"><span class="nav-text">CAN总线操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CAN%E6%80%BB%E7%BA%BF%E5%A8%81%E8%83%81"><span class="nav-text">CAN总线威胁</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E6%94%BE%E6%94%BB%E5%87%BB"><span class="nav-text">重放攻击</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BD%AC%E5%82%A8-CAN-%E5%B8%A7%E5%88%86%E6%9E%90"><span class="nav-text">转储 CAN 帧分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Savvycan%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">Savvycan的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E6%94%BE%E6%94%BB%E5%87%BB-1"><span class="nav-text">重放攻击</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%86%E5%88%AB%E4%BB%B2%E8%A3%81-ID"><span class="nav-text">识别仲裁 ID</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%91%E9%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B8%A7"><span class="nav-text">发送自定义帧</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fuzzing"><span class="nav-text">Fuzzing</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BB%BA%E8%AE%AE%E9%98%85%E8%AF%BB"><span class="nav-text">建议阅读</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TBOX-%E5%AE%89%E5%85%A8"><span class="nav-text">TBOX 安全</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#TBOX-%E5%AE%89%E5%85%A8%E5%A8%81%E8%83%81"><span class="nav-text">TBOX 安全威胁</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AC%E4%BB%B6%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3%E5%A8%81%E8%83%81"><span class="nav-text">硬件调试接口威胁</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96%E5%A8%81%E8%83%81"><span class="nav-text">固件提取威胁</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BD%A6%E8%81%94%E7%BD%91%E6%9C%8D%E5%8A%A1%E5%B9%B3%E5%8F%B0%E5%A8%81%E8%83%81"><span class="nav-text">车联网服务平台威胁</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AC%E7%BD%91%E6%9A%B4%E9%9C%B2"><span class="nav-text">公网暴露</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CAN%E6%80%BB%E7%BA%BF"><span class="nav-text">CAN总线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%8F%E8%AE%AE%E5%AE%89%E5%85%A8"><span class="nav-text">协议安全</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BD%A6%E6%9C%BA%E5%AE%89%E5%85%A8"><span class="nav-text">车机安全</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%A6%E6%9C%BA%E5%AE%89%E5%85%A8%E5%A8%81%E8%83%81"><span class="nav-text">车机安全威胁</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E5%A4%96%E9%83%A8%E6%8E%A5%E5%8F%A3"><span class="nav-text">不安全的外部接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E6%81%B0%E5%BD%93%E7%9A%84%E5%B7%A5%E7%A8%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">不恰当的工程模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%90%E7%A7%81%E9%97%AE%E9%A2%98"><span class="nav-text">隐私问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E9%80%9A%E4%BF%A1%E4%BF%A1%E9%81%93%E5%AF%B9%E8%BD%A6%E8%BE%86%E6%95%B0%E6%8D%AE%E6%88%96%E4%BB%A3%E7%A0%81%E8%BF%9B%E8%A1%8C%E7%AF%A1%E6%94%B9%E3%80%81%E5%88%A0%E9%99%A4%E7%AD%89"><span class="nav-text">通过通信信道对车辆数据或代码进行篡改、删除等</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E7%AC%AC%E4%B8%89%E6%96%B9%E8%BD%AF%E4%BB%B6"><span class="nav-text">控制第三方软件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BB%A5%E7%94%A8%E6%88%96%E6%8D%9F%E5%AE%B3%E8%BD%AF%E4%BB%B6%E6%9B%B4%E6%96%B0%E8%BF%87%E7%A8%8B"><span class="nav-text">滥用或损害软件更新过程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%85%E7%94%B5%E6%A1%A9%E5%AE%89%E5%85%A8"><span class="nav-text">充电桩安全</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%85%E7%94%B5%E6%A1%A9%E5%AE%89%E5%85%A8%E5%A8%81%E8%83%81"><span class="nav-text">充电桩安全威胁</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OTA-%E5%AE%89%E5%85%A8"><span class="nav-text">OTA 安全</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%A3%8E%E9%99%A9"><span class="nav-text">数据风险</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E9%A3%8E%E9%99%A9"><span class="nav-text">功能风险</span></a></li></ol></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
            <div class="customize-info my-1">关山初度尘未洗，策马扬鞭再奋蹄。</div>
        
        <div class="text-center">
            &copy;
            
              <span>2023</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-circle-info fa-beat-fade" style="--fa-beat-fade-opacity: 0.67; --fa-beat-fade-scale: 1.075;" ></i>&nbsp;&nbsp;<a href="/">韩乔落</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        61 posts in total
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
		<li class="go-comment">
			<i class="fa-regular fa-comments"></i>
		</li>
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>


<script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/Swup.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupSlideTheme.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupScriptsPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupProgressPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupScrollPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupPreloadPlugin.min.js" ></script>
<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	<script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/imageViewer.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/utils.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/main.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/navbarShrink.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/scrollTopBottom.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/lightDarkSwitch.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/categoryList.js" ></script>


    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/localSearch.js" ></script>



    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/codeBlock.js" ></script>



    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/lazyload.js" ></script>



    <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/runtime.js" ></script>
    <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/odometer.min.js" ></script>
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/assets/odometer-theme-minimal.css">



  <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/Typed.min.js" ></script>
  <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/plugins/typed.js" ></script>







    <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/anime.min.js" ></script>




    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/tocToggle.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/toc.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/plugins/tabs.js" data-swup-reload-script></script>


<script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/moment-with-locales.min.js" data-swup-reload-script></script>
<script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/essays.js" data-swup-reload-script></script>




	
</body>

</html>